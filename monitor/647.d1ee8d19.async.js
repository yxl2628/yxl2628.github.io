(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[647],{81618:function(Ft){"use strict";(function(A,y){Ft.exports=y()})(this,function(){function A(B){var V=[];return B.AMapUI&&V.push(y(B.AMapUI)),B.Loca&&V.push(v(B.Loca)),Promise.all(V)}function y(B){return new Promise(function(V,N){var Y=[];if(B.plugins)for(var H=0;H<B.plugins.length;H+=1)a.AMapUI.plugins.indexOf(B.plugins[H])==-1&&Y.push(B.plugins[H]);if(P.AMapUI===Z.failed)N("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(P.AMapUI===Z.notload){P.AMapUI=Z.loading,a.AMapUI.version=B.version||a.AMapUI.version,H=a.AMapUI.version;var ce=document.body||document.head,at=document.createElement("script");at.type="text/javascript",at.src="https://webapi.amap.com/ui/"+H+"/main.js",at.onerror=function(rt){P.AMapUI=Z.failed,N("\u8BF7\u6C42 AMapUI \u5931\u8D25")},at.onload=function(){if(P.AMapUI=Z.loaded,Y.length)window.AMapUI.loadUI(Y,function(){for(var rt=0,Re=Y.length;rt<Re;rt++){var vt=Y[rt].split("/").slice(-1)[0];window.AMapUI[vt]=arguments[rt]}for(V();L.AMapUI.length;)L.AMapUI.splice(0,1)[0]()});else for(V();L.AMapUI.length;)L.AMapUI.splice(0,1)[0]()},ce.appendChild(at)}else P.AMapUI===Z.loaded?B.version&&B.version!==a.AMapUI.version?N("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Y.length?window.AMapUI.loadUI(Y,function(){for(var rt=0,Re=Y.length;rt<Re;rt++){var vt=Y[rt].split("/").slice(-1)[0];window.AMapUI[vt]=arguments[rt]}V()}):V():B.version&&B.version!==a.AMapUI.version?N("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):L.AMapUI.push(function(rt){rt?N(rt):Y.length?window.AMapUI.loadUI(Y,function(){for(var Re=0,vt=Y.length;Re<vt;Re++){var wt=Y[Re].split("/").slice(-1)[0];window.AMapUI[wt]=arguments[Re]}V()}):V()})})}function v(B){return new Promise(function(V,N){if(a.AMap.version.startsWith("2.0"))N("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(P.Loca===Z.failed)N("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(P.Loca===Z.notload){P.Loca=Z.loading,a.Loca.version=B.version||a.Loca.version;var Y=a.Loca.version,H=a.key,ce=document.body||document.head,at=document.createElement("script");at.type="text/javascript",at.src="https://webapi.amap.com/loca?v="+Y+"&key="+H,at.onerror=function(rt){P.Loca=Z.failed,N("\u8BF7\u6C42 AMapUI \u5931\u8D25")},at.onload=function(){for(P.Loca=Z.loaded,V();L.Loca.length;)L.Loca.splice(0,1)[0]()},ce.appendChild(at)}else P.Loca===Z.loaded?B.version&&B.version!==a.Loca.version?N("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):V():B.version&&B.version!==a.Loca.version?N("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):L.Loca.push(function(rt){rt?N(rt):N()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var Z;(function(B){B.notload="notload",B.loading="loading",B.loaded="loaded",B.failed="failed"})(Z||(Z={}));var a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},P={AMap:Z.notload,AMapUI:Z.notload,Loca:Z.notload},L={AMap:[],AMapUI:[],Loca:[]},O=[],D=function(B){typeof B=="function"&&(P.AMap===Z.loaded?B(window.AMap):O.push(B))};return{load:function(B){return new Promise(function(V,N){if(P.AMap==Z.failed)N("");else if(P.AMap==Z.notload){var Y=B.key,H=B.version,ce=B.plugins;Y?(window.AMap&&location.host!=="lbs.amap.com"&&N("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),a.key=Y,a.AMap.version=H||a.AMap.version,a.AMap.plugins=ce||a.AMap.plugins,P.AMap=Z.loading,H=document.body||document.head,window.___onAPILoaded=function(rt){if(delete window.___onAPILoaded,rt)P.AMap=Z.failed,N(rt);else for(P.AMap=Z.loaded,A(B).then(function(){V(window.AMap)}).catch(N);O.length;)O.splice(0,1)[0]()},ce=document.createElement("script"),ce.type="text/javascript",ce.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+a.AMap.version+"&key="+Y+"&plugin="+a.AMap.plugins.join(","),ce.onerror=function(rt){P.AMap=Z.failed,N(rt)},H.appendChild(ce)):N("\u8BF7\u586B\u5199key")}else if(P.AMap==Z.loaded)if(B.key&&B.key!==a.key)N("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(B.version&&B.version!==a.AMap.version)N("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(Y=[],B.plugins)for(H=0;H<B.plugins.length;H+=1)a.AMap.plugins.indexOf(B.plugins[H])==-1&&Y.push(B.plugins[H]);Y.length?window.AMap.plugin(Y,function(){A(B).then(function(){V(window.AMap)}).catch(N)}):A(B).then(function(){V(window.AMap)}).catch(N)}else if(B.key&&B.key!==a.key)N("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(B.version&&B.version!==a.AMap.version)N("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var at=[];if(B.plugins)for(H=0;H<B.plugins.length;H+=1)a.AMap.plugins.indexOf(B.plugins[H])==-1&&at.push(B.plugins[H]);D(function(){at.length?window.AMap.plugin(at,function(){A(B).then(function(){V(window.AMap)}).catch(N)}):A(B).then(function(){V(window.AMap)}).catch(N)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},P={AMap:Z.notload,AMapUI:Z.notload,Loca:Z.notload},L={AMap:[],AMapUI:[],Loca:[]}}}})},55647:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return Qe}});var v=y(67294),Z=y(59183),a=y(49242),P=function(Te,Le){var Ce={}.toString;return Ce.call(Te)==="[object ".concat(Le,"]")},L=function(Te){return Object.prototype.toString.call(Te).slice(8,-1)},O=function(Te){if(!Te||typeof Te!="object")return Te;var Le;return Array.isArray(Te)?Le=Te.map(function(Ce){return O(Ce)}):(Le={},Object.keys(Te).forEach(function(Ce){return Le[Ce]=O(Te[Ce])})),Le},D=function(Te){if(!Te)return Te;var Le={};for(var Ce in Te)Le[Ce]=Te[Ce];return Le},B=function(){return B=Object.assign||function(Te){for(var Le,Ce=1,Fe=arguments.length;Ce<Fe;Ce++){Le=arguments[Ce];for(var Ke in Le)Object.prototype.hasOwnProperty.call(Le,Ke)&&(Te[Ke]=Le[Ke])}return Te},B.apply(this,arguments)},V=function(Te,Le){var Ce={};for(var Fe in Te)Object.prototype.hasOwnProperty.call(Te,Fe)&&Le.indexOf(Fe)<0&&(Ce[Fe]=Te[Fe]);if(Te!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ke=0,Fe=Object.getOwnPropertySymbols(Te);Ke<Fe.length;Ke++)Le.indexOf(Fe[Ke])<0&&Object.prototype.propertyIsEnumerable.call(Te,Fe[Ke])&&(Ce[Fe[Ke]]=Te[Fe[Ke]]);return Ce},N=function(Te){var Le=Te.source,Ce=V(Te,["source"]),Fe=B(B({},O(Ce)),{source:B({},Le)});return Fe},Y=function(){return Y=Object.assign||function(Te){for(var Le,Ce=1,Fe=arguments.length;Ce<Fe;Ce++){Le=arguments[Ce];for(var Ke in Le)Object.prototype.hasOwnProperty.call(Le,Ke)&&(Te[Ke]=Le[Ke])}return Te},Y.apply(this,arguments)},H=function(Te,Le){var Ce={};for(var Fe in Te)Object.prototype.hasOwnProperty.call(Te,Fe)&&Le.indexOf(Fe)<0&&(Ce[Fe]=Te[Fe]);if(Te!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ke=0,Fe=Object.getOwnPropertySymbols(Te);Ke<Fe.length;Ke++)Le.indexOf(Fe[Ke])<0&&Object.prototype.propertyIsEnumerable.call(Te,Fe[Ke])&&(Ce[Fe[Ke]]=Te[Fe[Ke]]);return Ce};function ce(Te,Le){var Ce=(0,v.useRef)(),Fe=(0,v.useRef)(),Ke=(0,v.useRef)(null),qt=Le.onReady;return(0,v.useEffect)(function(){if(!(!Ce.current||!Fe.current||(0,a.isEqual)(Fe.current,Le))){var ir=!1,Pe=!1,Ne=!1,Xe=Fe.current,kt=Xe.onReady,rr=Xe.map,me=Xe.source,et=H(Xe,["onReady","map","source"]),or=Le.onReady,on=Le.map,vr=Le.source,jr=H(Le,["onReady","map","source"]);if(Pe=!(0,a.isEqual)(rr,on),ir=!(0,a.isEqual)(me,vr),Ne=!(0,a.isEqual)(et,jr),Fe.current=N(Le),Pe&&on){var xr=(0,a.pick)(on,["center","pitch","rotation","zoom","style"]);Ce.current.updateMap(xr)}if(ir&&vr){var Ae=vr.data,De=H(vr,["data"]);Ce.current.loaded?Ce.current.changeData(Ae,De):Ce.current.once("loaded",function(){var ke;(ke=Ce.current)===null||ke===void 0||ke.changeData(Ae,De)})}Ne&&jr&&(Ce.current.loaded?Ce.current.update(jr):Ce.current.once("loaded",function(){var ke;(ke=Ce.current)===null||ke===void 0||ke.update(jr)}))}},[Le]),(0,v.useEffect)(function(){return Ke.current?(Fe.current||(Fe.current=N(Le)),Ce.current=new Te(Ke.current,Y({},Le)),qt&&Ce.current.once("loaded",function(){qt(Ce.current)}),function(){Ce.current&&(Ce.current.destroy(),Ce.current=void 0)}):function(){return null}},[]),{plotRef:Ce,containerRef:Ke}}var at=function(Te,Le){!Te||((0,a.isFunction)(Te)?Te(Le):Te.current=Le)},rt=function(){var Te=function(Le,Ce){return Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Fe,Ke){Fe.__proto__=Ke}||function(Fe,Ke){for(var qt in Ke)Object.prototype.hasOwnProperty.call(Ke,qt)&&(Fe[qt]=Ke[qt])},Te(Le,Ce)};return function(Le,Ce){if(typeof Ce!="function"&&Ce!==null)throw new TypeError("Class extends value "+String(Ce)+" is not a constructor or null");Te(Le,Ce);function Fe(){this.constructor=Le}Le.prototype=Ce===null?Object.create(Ce):(Fe.prototype=Ce.prototype,new Fe)}}(),Re=function(Te){rt(Le,Te);function Le(){var Ce=Te!==null&&Te.apply(this,arguments)||this;return Ce.state={hasError:!1},Ce.renderError=function(Fe){var Ke=Ce.props.errorTemplate;switch(Fe){default:return Ke&&typeof Ke=="function"?Ke(Fe):v.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",Fe.message)}},Ce}return Le.getDerivedStateFromError=function(Ce){return{hasError:!0,error:Ce}},Le.getDerivedStateFromProps=function(Ce,Fe){return Fe.children!==Ce.children?{children:Ce.children,hasError:!1,error:void 0}:null},Le.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):v.createElement(v.Fragment,null,this.props.children)},Le}(v.Component),vt=Re,wt=y(24561),fe=function(Te){var Le=Te.loadingTemplate,Ce=function(){return Le||v.createElement(wt.ZP,{viewBox:"0 0 400 180",width:200,height:90,speed:1},v.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),v.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),v.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),v.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),v.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),v.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),v.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),v.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),v.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),v.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return v.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:"#fff"}},Ce())},$e=fe,re=function(Te,Le){var Ce={};for(var Fe in Te)Object.prototype.hasOwnProperty.call(Te,Fe)&&Le.indexOf(Fe)<0&&(Ce[Fe]=Te[Fe]);if(Te!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ke=0,Fe=Object.getOwnPropertySymbols(Te);Ke<Fe.length;Ke++)Le.indexOf(Fe[Ke])<0&&Object.prototype.propertyIsEnumerable.call(Te,Fe[Ke])&&(Ce[Fe[Ke]]=Te[Fe[Ke]]);return Ce},Ge=(0,v.forwardRef)(function(Te,Le){var Ce=Te.chartRef,Fe=Te.containerStyle,Ke=Fe===void 0?{height:"inherit"}:Fe,qt=Te.className,ir=Te.loading,Pe=Te.loadingTemplate,Ne=Te.errorTemplate,Xe=re(Te,["chartRef","containerStyle","className","loading","loadingTemplate","errorTemplate"]),kt=ce(Z.Choropleth,Xe),rr=kt.plotRef,me=kt.containerRef;return(0,v.useEffect)(function(){at(Ce,rr.current)},[rr.current]),(0,v.useImperativeHandle)(Le,function(){return{getChart:function(){return rr.current}}}),v.createElement(vt,{errorTemplate:Ne},ir&&v.createElement($e,{loadingTemplate:Pe}),v.createElement("div",{className:qt,style:Ke,ref:me}))}),Qe=Ge},46343:function(Ft,A,y){"use strict";y.d(A,{zj:function(){return et},oI:function(){return jr},ni:function(){return Xe},gg:function(){return vr}});var v=y(34155);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Z(xr,Ae,De,ke){function Bt(mt){return mt instanceof De?mt:new De(function(Mr){Mr(mt)})}return new(De||(De=Promise))(function(mt,Mr){function Cr(Ye){try{nt(ke.next(Ye))}catch(M){Mr(M)}}function Nr(Ye){try{nt(ke.throw(Ye))}catch(M){Mr(M)}}function nt(Ye){Ye.done?mt(Ye.value):Bt(Ye.value).then(Cr,Nr)}nt((ke=ke.apply(xr,Ae||[])).next())})}function a(xr,Ae){var De={label:0,sent:function(){if(mt[0]&1)throw mt[1];return mt[1]},trys:[],ops:[]},ke,Bt,mt,Mr;return Mr={next:Cr(0),throw:Cr(1),return:Cr(2)},typeof Symbol=="function"&&(Mr[Symbol.iterator]=function(){return this}),Mr;function Cr(nt){return function(Ye){return Nr([nt,Ye])}}function Nr(nt){if(ke)throw new TypeError("Generator is already executing.");for(;De;)try{if(ke=1,Bt&&(mt=nt[0]&2?Bt.return:nt[0]?Bt.throw||((mt=Bt.return)&&mt.call(Bt),0):Bt.next)&&!(mt=mt.call(Bt,nt[1])).done)return mt;switch(Bt=0,mt&&(nt=[nt[0]&2,mt.value]),nt[0]){case 0:case 1:mt=nt;break;case 4:return De.label++,{value:nt[1],done:!1};case 5:De.label++,Bt=nt[1],nt=[0];continue;case 7:nt=De.ops.pop(),De.trys.pop();continue;default:if(mt=De.trys,!(mt=mt.length>0&&mt[mt.length-1])&&(nt[0]===6||nt[0]===2)){De=0;continue}if(nt[0]===3&&(!mt||nt[1]>mt[0]&&nt[1]<mt[3])){De.label=nt[1];break}if(nt[0]===6&&De.label<mt[1]){De.label=mt[1],mt=nt;break}if(mt&&De.label<mt[2]){De.label=mt[2],De.ops.push(nt);break}mt[2]&&De.ops.pop(),De.trys.pop();continue}nt=Ae.call(xr,De)}catch(Ye){nt=[6,Ye],Bt=0}finally{ke=mt=0}if(nt[0]&5)throw nt[1];return{value:nt[0]?nt[1]:void 0,done:!0}}}function P(xr,Ae){var De=typeof Symbol=="function"&&xr[Symbol.iterator];if(!De)return xr;var ke=De.call(xr),Bt,mt=[],Mr;try{for(;(Ae===void 0||Ae-- >0)&&!(Bt=ke.next()).done;)mt.push(Bt.value)}catch(Cr){Mr={error:Cr}}finally{try{Bt&&!Bt.done&&(De=ke.return)&&De.call(ke)}finally{if(Mr)throw Mr.error}}return mt}function L(){for(var xr=[],Ae=0;Ae<arguments.length;Ae++)xr=xr.concat(P(arguments[Ae]));return xr}function O(xr){return xr&&xr.__esModule&&Object.prototype.hasOwnProperty.call(xr,"default")?xr.default:xr}function D(xr,Ae){return Ae={exports:{}},xr(Ae,Ae.exports),Ae.exports}var B=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=De;function De(ke){return ke&&typeof ke.length=="number"&&ke.length>=0&&ke.length%1==0}xr.exports=Ae.default});O(B);var V=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=function(De){return function(){for(var ke=[],Bt=arguments.length;Bt--;)ke[Bt]=arguments[Bt];var mt=ke.pop();return De.call(this,ke,mt)}},xr.exports=Ae.default});O(V);var N=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.fallback=Bt,Ae.wrap=mt;var De=Ae.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,ke=Ae.hasNextTick=typeof v=="object"&&typeof v.nextTick=="function";function Bt(Cr){setTimeout(Cr,0)}function mt(Cr){return function(Nr){for(var nt=[],Ye=arguments.length-1;Ye-- >0;)nt[Ye]=arguments[Ye+1];return Cr(function(){return Nr.apply(void 0,nt)})}}var Mr;De?Mr=setImmediate:ke?Mr=v.nextTick:Mr=Bt,Ae.default=mt(Mr)});O(N);var Y=N.fallback,H=N.wrap,ce=N.hasSetImmediate,at=N.hasNextTick,rt=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=mt;var De=Bt(V),ke=Bt(N);function Bt(Nr){return Nr&&Nr.__esModule?Nr:{default:Nr}}function mt(Nr){return(0,Re.isAsync)(Nr)?function(){for(var nt=[],Ye=arguments.length;Ye--;)nt[Ye]=arguments[Ye];var M=nt.pop(),W=Nr.apply(this,nt);return Mr(W,M)}:(0,De.default)(function(nt,Ye){var M;try{M=Nr.apply(this,nt)}catch(W){return Ye(W)}if(M&&typeof M.then=="function")return Mr(M,Ye);Ye(null,M)})}function Mr(Nr,nt){return Nr.then(function(Ye){Cr(nt,null,Ye)},function(Ye){Cr(nt,Ye&&Ye.message?Ye:new Error(Ye))})}function Cr(Nr,nt,Ye){try{Nr(nt,Ye)}catch(M){(0,ke.default)(function(W){throw W},M)}}xr.exports=Ae.default});O(rt);var Re=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.isAsyncIterable=Ae.isAsyncGenerator=Ae.isAsync=void 0;var De=ke(rt);function ke(Nr){return Nr&&Nr.__esModule?Nr:{default:Nr}}function Bt(Nr){return Nr[Symbol.toStringTag]==="AsyncFunction"}function mt(Nr){return Nr[Symbol.toStringTag]==="AsyncGenerator"}function Mr(Nr){return typeof Nr[Symbol.asyncIterator]=="function"}function Cr(Nr){if(typeof Nr!="function")throw new Error("expected a function");return Bt(Nr)?(0,De.default)(Nr):Nr}Ae.default=Cr,Ae.isAsync=Bt,Ae.isAsyncGenerator=mt,Ae.isAsyncIterable=Mr});O(Re);var vt=Re.isAsyncIterable,wt=Re.isAsyncGenerator,fe=Re.isAsync,$e=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=De;function De(ke,Bt){if(Bt===void 0&&(Bt=ke.length),!Bt)throw new Error("arity is undefined");function mt(){for(var Mr=this,Cr=[],Nr=arguments.length;Nr--;)Cr[Nr]=arguments[Nr];return typeof Cr[Bt-1]=="function"?ke.apply(this,Cr):new Promise(function(nt,Ye){Cr[Bt-1]=function(M){for(var W=[],ue=arguments.length-1;ue-- >0;)W[ue]=arguments[ue+1];if(M)return Ye(M);nt(W.length>1?W:W[0])},ke.apply(Mr,Cr)})}return Object.defineProperty(mt,"name",{configurable:!0,value:"awaitable("+ke.name+")"}),mt}xr.exports=Ae.default});O($e);var re=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0});var De=mt(B),ke=mt(Re),Bt=mt($e);function mt(Mr){return Mr&&Mr.__esModule?Mr:{default:Mr}}Ae.default=(0,Bt.default)(function(Mr,Cr,Nr){var nt=(0,De.default)(Cr)?[]:{};Mr(Cr,function(Ye,M,W){(0,ke.default)(Ye)(function(ue){for(var X,ie=[],ye=arguments.length-1;ye-- >0;)ie[ye]=arguments[ye+1];ie.length<2&&(X=ie,ie=X[0]),nt[M]=ie,W(ue)})},function(Ye){return Nr(Ye,nt)})},3),xr.exports=Ae.default});O(re);var Ge=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=De;function De(ke){function Bt(){for(var mt=[],Mr=arguments.length;Mr--;)mt[Mr]=arguments[Mr];if(ke!==null){var Cr=ke;ke=null,Cr.apply(this,mt)}}return Object.assign(Bt,ke),Bt}xr.exports=Ae.default});O(Ge);var Qe=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=function(De){return De[Symbol.iterator]&&De[Symbol.iterator]()},xr.exports=Ae.default});O(Qe);var Te=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=Nr;var De=Bt(B),ke=Bt(Qe);function Bt(nt){return nt&&nt.__esModule?nt:{default:nt}}function mt(nt){var Ye=-1,M=nt.length;return function(){return++Ye<M?{value:nt[Ye],key:Ye}:null}}function Mr(nt){var Ye=-1;return function(){var W=nt.next();return W.done?null:(Ye++,{value:W.value,key:Ye})}}function Cr(nt){var Ye=nt?Object.keys(nt):[],M=-1,W=Ye.length;return function(){var X=Ye[++M];return M<W?{value:nt[X],key:X}:null}}function Nr(nt){if((0,De.default)(nt))return mt(nt);var Ye=(0,ke.default)(nt);return Ye?Mr(Ye):Cr(nt)}xr.exports=Ae.default});O(Te);var Le=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=De;function De(ke){return function(){for(var Bt=[],mt=arguments.length;mt--;)Bt[mt]=arguments[mt];if(ke===null)throw new Error("Callback was already called.");var Mr=ke;ke=null,Mr.apply(this,Bt)}}xr.exports=Ae.default});O(Le);var Ce=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0});var De={};Ae.default=De,xr.exports=Ae.default});O(Ce);var Fe=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=Bt;var De=ke(Ce);function ke(mt){return mt&&mt.__esModule?mt:{default:mt}}function Bt(mt,Mr,Cr,Nr){var nt=!1,Ye=!1,M=!1,W=0,ue=0;function X(){W>=Mr||M||nt||(M=!0,mt.next().then(function(J){var ht=J.value,ze=J.done;if(!(Ye||nt)){if(M=!1,ze){nt=!0,W<=0&&Nr(null);return}W++,Cr(ht,ue,ie),ue++,X()}}).catch(ye))}function ie(J,ht){if(W-=1,!Ye){if(J)return ye(J);if(J===!1){nt=!0,Ye=!0;return}if(ht===De.default||nt&&W<=0)return nt=!0,Nr(null);X()}}function ye(J){Ye||(M=!1,nt=!0,Nr(J))}X()}xr.exports=Ae.default});O(Fe);var Ke=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0});var De=Cr(Ge),ke=Cr(Te),Bt=Cr(Le),mt=Cr(Fe),Mr=Cr(Ce);function Cr(Nr){return Nr&&Nr.__esModule?Nr:{default:Nr}}Ae.default=function(Nr){return function(nt,Ye,M){if(M=(0,De.default)(M),Nr<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!nt)return M(null);if((0,Re.isAsyncGenerator)(nt))return(0,mt.default)(nt,Nr,Ye,M);if((0,Re.isAsyncIterable)(nt))return(0,mt.default)(nt[Symbol.asyncIterator](),Nr,Ye,M);var W=(0,ke.default)(nt),ue=!1,X=!1,ie=0,ye=!1;function J(ze,pt){if(!X)if(ie-=1,ze)ue=!0,M(ze);else if(ze===!1)ue=!0,X=!0;else{if(pt===Mr.default||ue&&ie<=0)return ue=!0,M(null);ye||ht()}}function ht(){for(ye=!0;ie<Nr&&!ue;){var ze=W();if(ze===null){ue=!0,ie<=0&&M(null);return}ie+=1,Ye(ze.value,ze.key,(0,Bt.default)(J))}ye=!1}ht()}},xr.exports=Ae.default});O(Ke);var qt=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0});var De=mt(Ke),ke=mt(Re),Bt=mt($e);function mt(Cr){return Cr&&Cr.__esModule?Cr:{default:Cr}}function Mr(Cr,Nr,nt,Ye){return(0,De.default)(Nr)(Cr,(0,ke.default)(nt),Ye)}Ae.default=(0,Bt.default)(Mr,4),xr.exports=Ae.default});O(qt);var ir=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0});var De=Bt(qt),ke=Bt($e);function Bt(Mr){return Mr&&Mr.__esModule?Mr:{default:Mr}}function mt(Mr,Cr,Nr){return(0,De.default)(Mr,1,Cr,Nr)}Ae.default=(0,ke.default)(mt,3),xr.exports=Ae.default});O(ir);var Pe=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=mt;var De=Bt(re),ke=Bt(ir);function Bt(Mr){return Mr&&Mr.__esModule?Mr:{default:Mr}}function mt(Mr,Cr){return(0,De.default)(ke.default,Mr,Cr)}xr.exports=Ae.default}),Ne=O(Pe),Xe=function(){function xr(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];this.args=[],this.tasks=[]}return xr.prototype.call=function(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];return this.args=De,Ne(this.tasks)},xr.prototype.tap=function(Ae,De){var ke=this;this.tasks.push(function(Bt){De.apply(void 0,L(ke.args)),Bt(null,Ae)})},xr}(),kt=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0});var De=nt(B),ke=nt(Ce),Bt=nt(qt),mt=nt(Ge),Mr=nt(Le),Cr=nt(Re),Nr=nt($e);function nt(ue){return ue&&ue.__esModule?ue:{default:ue}}function Ye(ue,X,ie){ie=(0,mt.default)(ie);var ye=0,J=0,ht=ue.length,ze=!1;ht===0&&ie(null);function pt(Me,Ue){Me===!1&&(ze=!0),ze!==!0&&(Me?ie(Me):(++J===ht||Ue===ke.default)&&ie(null))}for(;ye<ht;ye++)X(ue[ye],ye,(0,Mr.default)(pt))}function M(ue,X,ie){return(0,Bt.default)(ue,Infinity,X,ie)}function W(ue,X,ie){var ye=(0,De.default)(ue)?Ye:M;return ye(ue,(0,Cr.default)(X),ie)}Ae.default=(0,Nr.default)(W,3),xr.exports=Ae.default});O(kt);var rr=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.default=mt;var De=Bt(kt),ke=Bt(re);function Bt(Mr){return Mr&&Mr.__esModule?Mr:{default:Mr}}function mt(Mr,Cr){return(0,ke.default)(De.default,Mr,Cr)}xr.exports=Ae.default}),me=O(rr),et=function(){function xr(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];this.tasks=[]}return xr.prototype.promise=function(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];return me(this.tasks)},xr.prototype.tapPromise=function(Ae,De){var ke=this;this.tasks.push(function(Bt){return Z(ke,void 0,void 0,function(){return a(this,function(mt){switch(mt.label){case 0:return[4,De()];case 1:return mt.sent(),Bt(null,Ae),[2]}})})})},xr}(),or=D(function(xr,Ae){Object.defineProperty(Ae,"__esModule",{value:!0});var De=Mr(Ge),ke=Mr(Le),Bt=Mr(Re),mt=Mr($e);function Mr(Nr){return Nr&&Nr.__esModule?Nr:{default:Nr}}function Cr(Nr,nt){if(nt=(0,De.default)(nt),!Array.isArray(Nr))return nt(new Error("First argument to waterfall must be an array of functions"));if(!Nr.length)return nt();var Ye=0;function M(ue){var X=(0,Bt.default)(Nr[Ye++]);X.apply(void 0,ue.concat([(0,ke.default)(W)]))}function W(ue){for(var X=[],ie=arguments.length-1;ie-- >0;)X[ie]=arguments[ie+1];if(ue!==!1){if(ue||Ye===Nr.length)return nt.apply(void 0,[ue].concat(X));M(X)}}M([])}Ae.default=(0,mt.default)(Cr),xr.exports=Ae.default}),on=O(or),vr=function(){function xr(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];this.tasks=[]}return xr.prototype.call=function(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];return on(this.tasks)},xr.prototype.tap=function(Ae,De){this.tasks.length===0?this.tasks.push(function(ke){var Bt=De();ke(Bt?null:!1,Bt)}):this.tasks.push(function(ke,Bt){var mt=De();Bt(mt?null:!1,Ae)})},xr}(),jr=function(){function xr(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];this.tasks=[]}return xr.prototype.call=function(){for(var Ae=arguments,De=[],ke=0;ke<arguments.length;ke++)De[ke]=Ae[ke];return Ne(this.tasks)},xr.prototype.tap=function(Ae,De){this.tasks.push(function(ke){var Bt=De();ke(Bt,Ae)})},xr}()},96846:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(56917),Z=y(88395),a=function(){function P(L){L===void 0&&(L={}),this.matrix=[1,0,0,0,1,0,0,0,1],this.isTransposed=!1,Object.assign(this,L),this.init()}return P.prototype.init=function(){var L=this.start,O=this.end,D={x:(L.x+O.x)/2,y:(L.y+O.y)/2};this.center=D,this.width=Math.abs(O.x-L.x),this.height=Math.abs(O.y-L.y)},P.prototype._swapDim=function(L){var O=this[L];if(O){var D=O.start;O.start=O.end,O.end=D}},P.prototype.getCenter=function(){return this.center},P.prototype.getWidth=function(){return this.width},P.prototype.getHeight=function(){return this.height},P.prototype.convertDim=function(L,O){var D=this[O],B=D.start,V=D.end;return B+L*(V-B)},P.prototype.invertDim=function(L,O){var D=this[O],B=D.start,V=D.end;return(L-B)/(V-B)},P.prototype.convertPoint=function(L){return L},P.prototype.invertPoint=function(L){return L},P.prototype.applyMatrix=function(L,O,D){D===void 0&&(D=0);var B=this.matrix,V=[L,O,D];return Z.transformMat3(V,V,B),V},P.prototype.invertMatrix=function(L,O,D){D===void 0&&(D=0);var B=this.matrix,V=v.default.invert([],B),N=[L,O,D];return Z.transformMat3(N,N,V),N},P.prototype.convert=function(L){var O=this.convertPoint(L),D=O.x,B=O.y,V=this.applyMatrix(D,B,1);return{x:V[0],y:V[1]}},P.prototype.invert=function(L){var O=this.invertMatrix(L.x,L.y,1);return this.invertPoint({x:O[0],y:O[1]})},P.prototype.rotate=function(L){var O=this.matrix,D=this.center;return v.default.translate(O,O,[-D.x,-D.y]),v.default.rotate(O,O,L),v.default.translate(O,O,[D.x,D.y]),this},P.prototype.reflect=function(L){switch(L){case"x":this._swapDim("x");break;case"y":this._swapDim("y");break;default:this._swapDim("y")}return this},P.prototype.scale=function(L,O){var D=this.matrix,B=this.center;return v.default.translate(D,D,[-B.x,-B.y]),v.default.scale(D,D,[L,O]),v.default.translate(D,D,[B.x,B.y]),this},P.prototype.translate=function(L,O){var D=this.matrix;return v.default.translate(D,D,[L,O]),this},P.prototype.transpose=function(){return this.isTransposed=!this.isTransposed,this},P}();A.default=a},88324:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(70655),Z=y(96846),a=y(21069),P=y(53418),L=y(62993),O=function(D){v.__extends(B,D);function B(V){var N=D.call(this,v.__assign({projection:"EPSG3857",zoom:7,mapCenter:[116.400146,39.926588]},V))||this;return N.type="geo",N.isGeo=!0,V.center?N.center=V.center:N.center=N.mapCenter,N._init(),N}return B.prototype._init=function(){var V=this.start,N=this.end;this.center=P.toLngLat(this.center),this.width=Math.abs(N.x-V.x),this.height=Math.abs(N.y-V.y),this.crs=a.getCRS(this.projection)},B.prototype.getZoom=function(){return this.zoom},B.prototype.setZoom=function(V){this.zoom=V},B.prototype.setCenter=function(V){this.center=P.toLngLat(V)},B.prototype.getCenter=function(){return this.center},B.prototype.convertPoint=function(V){var N=[V.x,V.y],Y=this.project(P.toLngLat(N),this.zoom).round(),H=this.getPixelOrigin(),ce=Y.subtract(H);return{x:ce.x,y:ce.y}},B.prototype.invertPoint=function(V){var N=L.toPoint(V),Y=this.getPixelOrigin(),H=N.add(Y),ce=this.unproject(H,this.zoom);return{x:ce.lng,y:ce.lat}},B.prototype.layerPointToLatLng=function(V){var N=this.getPixelOrigin(),Y=V.add(N);return this.unproject(Y,this.zoom)},B.prototype.latLngToLayerPoint=function(V){var N=this.project(P.toLngLat(V),this.zoom).round(),Y=this.getPixelOrigin();return N.subtract(Y)},B.prototype.getPixelOrigin=function(){var V=this.width/2,N=this.height/2;return this.crs.lngLatToPoint(P.toLngLat(this.center),this.zoom).subtract({y:N,x:V})},B.prototype.project=function(V,N){var Y=N===void 0?this.zoom:N;return this.crs.lngLatToPoint(P.toLngLat(V),Y)},B.prototype.unproject=function(V,N){var Y=N===void 0?this.zoom:N;return this.crs.pointToLngLat(L.toPoint(V),Y)},B.prototype.distance=function(V,N){return this.crs.distance(P.toLngLat(V),P.toLngLat(N))},B}(Z.default);A.default=O},83341:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(248),Z=y(23282),a=y(14881),P=y(49242),L=.5/(Math.PI*Z.sphericalMercator.R),O=new a.Transformation(L,.5,-L,.5);A.epsg3857=P.mix({},v.earth,{code:"EPSG:3857",projection:Z.sphericalMercator,transformation:O}),A.epsg900913=P.mix({},A.epsg3857,{code:"EPSG:900913"})},99298:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(248),Z=y(8425),a=y(14881),P=y(49242),L=new a.Transformation(1/180,1,-1/180,.5);A.epsg4326=P.mix({},v.earth,{code:"EPSG:4326",projection:Z.lngLatProjection,transformation:L})},90623:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(7181),Z=y(8425),a=y(14881),P=y(49242),L=new a.Transformation(1,0,-1,0);A.simple=P.mix({},v.CRS,{projection:Z.lngLatProjection,transformation:L,scale:function(O){return Math.pow(2,O)},zoom:function(O){return Math.log(O)/Math.LN2},distance:function(O,D){var B=D.lng-O.lng,V=D.lat-O.lat;return Math.sqrt(B*B+V*V)},infinite:!0})},7181:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(8446),Z=y(53418),a=y(56355),P=y(23282),L=y(14881),O=y(43199),D=.5/(Math.PI*P.sphericalMercator.R),B=new L.Transformation(D,.5,-D,.5);A.CRS={wrapLng:[-180,180],wrapLat:null,projection:P.sphericalMercator,transformation:B,lngLatToPoint:function(V,N){var Y=this.projection.project(V),H=this.scale(N);return this.transformation.transform(Y,H)},pointToLngLat:function(V,N){var Y=this.scale(N),H=this.transformation.untransform(V,Y);return this.projection.unproject(H)},project:function(V){return this.projection.project(V)},unproject:function(V){return this.projection.unproject(V)},zoom:function(V){return Math.log(V/256)/Math.LN2},scale:function(V){return 256*Math.pow(2,V)},getProjectedBounds:function(V){if(this.infinite)return new v.Bounds([[Infinity,Infinity],[Infinity,Infinity]]);var N=this.projection.bounds,Y=this.scale(V),H=this.transformation.transform(N.min,Y),ce=this.transformation.transform(N.max,Y);return new v.Bounds(H,ce)},infinite:!1,wrapLngLat:function(V){var N=Array.isArray(this.wrapLng)?a.wrapNum(V.lng,this.wrapLng,!0):V.lng,Y=Array.isArray(this.wrapLat)?a.wrapNum(V.lat,this.wrapLat,!0):V.lat,H=V.alt;return new Z.LngLat(N,Y,H)},wrapLngLatBounds:function(V){var N=V.getCenter(),Y=this.wrapLngLat(N),H=N.lat-Y.lat,ce=N.lng-Y.lng;if(H===0&&ce===0)return V;var at=V.getSouthWest(),rt=V.getNorthEast(),Re=new Z.LngLat(at.lng-ce,at.lat-H),vt=new Z.LngLat(rt.lng-ce,rt.lat-H);return new O.LngLatBounds(Re,vt)}}},248:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(7181),Z=y(49242);A.earth=Z.mix({},v.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(a,P){var L=Math.PI/180,O=a.lat*L,D=P.lat*L,B=Math.sin((P.lat-a.lat)*L/2),V=Math.sin((P.lng-a.lng)*L/2),N=B*B+Math.cos(O)*Math.cos(D)*V*V,Y=2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N));return this.R*Y}})},21069:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(248),Z=y(83341),a=y(99298),P=y(90623),L={epsg3857:Z.epsg3857,epsg4326:a.epsg4326,simple:P.simple,earth:v.earth,epsg900913:Z.epsg900913};A.getCRS=function(O){return L[O.toLowerCase()]}},8446:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(62993),Z=function(){function P(L,O){if(!!L){var D=O?[L,O]:L;if(Array.isArray(D))for(var B=0,V=D.length;B<V;B+=1)this.extend(D[B])}}return P.prototype.extend=function(L){var O=v.toPoint(L);return!this.min&&!this.max?(this.min=O.clone(),this.max=O.clone()):(this.min.x=Math.min(O.x,this.min.x),this.max.x=Math.max(O.x,this.max.x),this.min.y=Math.min(O.y,this.min.y),this.max.y=Math.max(O.y,this.max.y)),this},P.prototype.getCenter=function(L){return new v.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,L)},P.prototype.getBottomLeft=function(){return new v.Point(this.min.x,this.max.y)},P.prototype.getTopRight=function(){return new v.Point(this.max.x,this.min.y)},P.prototype.getBottomRight=function(){return this.max},P.prototype.getTopLeft=function(){return this.min},P.prototype.getSize=function(){return this.max.subtract(this.min)},P.prototype.contains=function(L){var O,D,B=L;return B instanceof v.Point||typeof B[0]=="number"?B=v.toPoint(B):B=a(B),B instanceof P?(O=B.min,D=B.max):O=D=L,O.x>=this.min.x&&D.x<=this.max.x&&O.y>=this.min.y&&D.y<=this.max.y},P.prototype.intersect=function(L){var O=a(L),D=this.min,B=this.max,V=O.min,N=O.max,Y=N.x>=D.x&&V.x<=B.x,H=N.y>=D.y&&V.y<=B.y;return Y&&H},P.prototype.overlaps=function(L){var O=a(L),D=this.min,B=this.max,V=O.min,N=O.max,Y=N.x>D.x&&V.x<B.x,H=N.y>D.y&&V.y<B.y;return Y&&H},P.prototype.isValid=function(){return!!(this.min&&this.max)},P}();A.Bounds=Z;function a(P,L){return!P||P instanceof Z?P:new Z(P,L)}A.toBounds=a},43199:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(53418),Z=function(){function P(L,O){if(!!L){var D=O?[L,O]:L;if(Array.isArray(D))for(var B=0,V=D.length;B<V;B+=1)this.extend(D[B])}}return P.prototype.extend=function(L){var O=this.southWest,D=this.northEast,B,V;if(L instanceof v.LngLat)B=L,V=L;else if(L instanceof P){if(B=L.southWest,V=L.northEast,!B||!V)return this}else return L&&Array.isArray(L)?Array.isArray(L[0])?this.extend(a(L)):this.extend(v.toLngLat(L)):this;return!O&&!D?(this.southWest=new v.LngLat(B.lng,B.lat),this.northEast=new v.LngLat(V.lng,V.lat)):(O.lat=Math.min(B.lat,O.lat),O.lng=Math.min(B.lng,O.lng),D.lat=Math.max(V.lat,D.lat),D.lng=Math.max(V.lng,D.lng)),this},P.prototype.pad=function(L){var O=this.southWest,D=this.northEast,B=Math.abs(O.lat-D.lat)*L,V=Math.abs(O.lng-D.lng)*L;return new P(new v.LngLat(O.lng-V,O.lat-B),new v.LngLat(D.lng+V,D.lat+B))},P.prototype.getCenter=function(){return new v.LngLat((this.southWest.lng+this.northEast.lng)/2,(this.southWest.lat+this.northEast.lat)/2)},P.prototype.getSouthWest=function(){return this.southWest},P.prototype.getNorthEast=function(){return this.northEast},P.prototype.getNorthWest=function(){return new v.LngLat(this.getWest(),this.getNorth())},P.prototype.getSouthEast=function(){return new v.LngLat(this.getEast(),this.getSouth())},P.prototype.getWest=function(){return this.southWest.lng},P.prototype.getSouth=function(){return this.southWest.lat},P.prototype.getNorth=function(){return this.northEast.lat},P.prototype.getEast=function(){return this.northEast.lng},P.prototype.contains=function(L){var O=L;Array.isArray(O)&&typeof O[0]=="number"||O instanceof v.LngLat||"lat"in O?O=v.toLngLat(O):O=a(O);var D=this.southWest,B=this.northEast,V,N;return O instanceof P?(V=O.getSouthWest(),N=O.getNorthEast()):V=N=O,V.lat>=D.lat&&N.lat<=B.lat&&V.lng>=D.lng&&N.lng<=B.lng},P.prototype.intersects=function(L){var O=a(L),D=this.southWest,B=this.northEast,V=O.getSouthWest(),N=O.getNorthEast(),Y=N.lat>=D.lat&&V.lat<=B.lat,H=N.lng>=D.lng&&V.lng<=B.lng;return Y&&H},P.prototype.overlaps=function(L){var O=a(L),D=this.southWest,B=this.northEast,V=O.getSouthWest(),N=O.getNorthEast(),Y=N.lat>D.lat&&V.lat<B.lat,H=N.lng>D.lng&&V.lng<B.lng;return Y&&H},P.prototype.toBBoxString=function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},P.prototype.equals=function(L,O){if(!L)return!1;var D=a(L);return this.southWest.equals(D.getSouthWest(),O)&&this.northEast.equals(D.getNorthEast(),O)},P.prototype.isValid=function(){return!!(this.southWest&&this.northEast)},P}();A.LngLatBounds=Z;function a(P,L){return P instanceof Z?P:L!==void 0?new Z(P,L):new Z(P)}A.toLngLatBounds=a},53418:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(248),Z=y(56355),a=y(43199),P=function(){function O(D,B,V){if(isNaN(B)||isNaN(D))throw new Error("\u65E0\u6548\u7684\u7ECF\u7EAC\u5EA6\u53C2\u6570: ("+D+",' "+B);this.lat=+B,this.lng=+D,V!==void 0&&(this.alt=+V)}return O.prototype.equals=function(D,B){if(!D)return!1;var V=L(D);if(V===void 0)return!1;var N=Math.max(Math.abs(this.lat-V.lat),Math.abs(this.lng-V.lng));return N<=(B===void 0?1e-9:B)},O.prototype.toString=function(D){return"LngLat("+Z.formatNum(this.lng,D)+", "+Z.formatNum(this.lat,D)+")"},O.prototype.distanceTo=function(D){return v.earth.distance(this,L(D))},O.prototype.wrap=function(){return v.earth.wrapLngLat(this)},O.prototype.toBounds=function(D){var B=180*D/40075017,V=B/Math.cos(Math.PI/180*this.lat);return a.toLngLatBounds([this.lng-V,this.lat-B],[this.lng+V,this.lat+B])},O.prototype.clone=function(){return new O(this.lng,this.lat,this.alt)},O}();A.LngLat=P;function L(O,D,B){if(O instanceof P)return O;if(Array.isArray(O)&&typeof O[0]!="object"){if(O.length===3)return new P(O[0],O[1],O[2]);if(O.length===2)return new P(O[0],O[1])}if(O==null)throw new Error("\u65E0\u6548\u7684\u7ECF\u7EAC\u5EA6\u53C2\u6570: ("+O+", "+D+")");if(typeof O=="object"&&"lat"in O)return new P(O.lng,"lng"in O?O.lat:0,O.alt);if(D===void 0)throw new Error("\u65E0\u6548\u7684\u7ECF\u7EAC\u5EA6\u53C2\u6570: ("+O+", "+D+")");return new P(Number(O),D,B)}A.toLngLat=L},62993:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(56355),Z=function(){function P(L,O,D){this.x=D?Math.round(L):L,this.y=D?Math.round(O):O}return P.prototype.clone=function(){return new P(this.x,this.y)},P.prototype.add=function(L,O,D){return this.clone()._add(a(L,O,D))},P.prototype._add=function(L){return this.x+=L.x,this.y+=L.y,this},P.prototype.subtract=function(L,O,D){return this.clone()._subtract(a(L,O,D))},P.prototype._subtract=function(L){return this.x-=L.x,this.y-=L.y,this},P.prototype.divideBy=function(L){return this.clone()._divideBy(L)},P.prototype._divideBy=function(L){return this.x/=L,this.y/=L,this},P.prototype.multiplyBy=function(L){return this.clone()._multiplyBy(L)},P.prototype._multiplyBy=function(L){return this.x*=L,this.y*=L,this},P.prototype.scaleBy=function(L){return new P(this.x*L.x,this.y*L.y)},P.prototype.unscaleBy=function(L){return new P(this.x/L.x,this.y/L.y)},P.prototype.round=function(){return this.clone()._round()},P.prototype._round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},P.prototype.floor=function(){return this.clone()._floor()},P.prototype._floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},P.prototype.ceil=function(){return this.clone()._ceil()},P.prototype._ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},P.prototype.trunc=function(){return this.clone()._trunc()},P.prototype._trunc=function(){return this.x=v.trunc(this.x),this.y=v.trunc(this.y),this},P.prototype.distanceTo=function(L){var O=a(L),D=O.x-this.x,B=O.y-this.y;return Math.sqrt(D*D+B*B)},P.prototype.equals=function(L,O){var D=a(L),B=Math.max(Math.abs(this.x-D.x),Math.abs(this.y-D.y));return B<=(O===void 0?1e-9:O)},P.prototype.contains=function(L){var O=a(L);return Math.abs(O.x)<=Math.abs(this.x)&&Math.abs(O.y)<=Math.abs(this.y)},P.prototype.toString=function(){return"Point("+v.formatNum(this.x)+", "+v.formatNum(this.y)+")"},P}();A.Point=Z;function a(P,L,O){return P instanceof Z?P:Array.isArray(P)?new Z(P[0],P[1]):P==null?P:typeof P=="object"&&"x"in P&&"y"in P?new Z(P.x,P.y):new Z(P,L,O)}A.toPoint=a},8425:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(53418),Z=y(8446),a=y(62993);A.lngLatProjection={project:function(P){return new a.Point(P.lng,P.lat)},unproject:function(P){return new v.LngLat(P.x,P.y)},bounds:new Z.Bounds([-180,-90],[180,90])}},23282:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(53418),Z=y(8446),a=y(62993);A.sphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(P){var L=Math.PI/180,O=this.MAX_LATITUDE,D=Math.max(Math.min(O,P.lat),-O),B=Math.sin(D*L);return new a.Point(this.R*P.lng*L,this.R*Math.log((1+B)/(1-B))/2)},unproject:function(P){var L=180/Math.PI;return new v.LngLat(P.x*L/this.R,(2*Math.atan(Math.exp(P.y/this.R))-Math.PI/2)*L)},bounds:function(){var P=6378137*Math.PI;return new Z.Bounds([-P,-P],[P,P])}()}},14881:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(62993),Z=function(){function a(P,L,O,D){if(Array.isArray(P)){this.a=P[0],this.b=P[1],this.c=P[2],this.d=P[3];return}this.a=P,this.b=L,this.c=O,this.d=D}return a.prototype.transform=function(P,L){return this._transform(P.clone(),L)},a.prototype._transform=function(P,L){var O=L||1;return P.x=O*(this.a*P.x+this.b),P.y=O*(this.c*P.y+this.d),P},a.prototype.untransform=function(P,L){var O=L||1;return new v.Point((P.x/O-this.b)/this.a,(P.y/O-this.d)/this.c)},a}();A.Transformation=Z},56086:function(Ft,A,y){"use strict";var v;v=!0;var Z=y(88324);A.fG=Z;var a=y(8446);A.YZ=a.Bounds,v=a.toBounds;var P=y(53418);v=P.LngLat,A.WN=P.toLngLat;var L=y(43199);v=L.LngLatBounds,A.Dv=L.toLngLatBounds;var O=y(62993);A.E9=O.Point,v=O.toPoint},56355:function(Ft,A){"use strict";A.__esModule=!0;var y=function(a){return a>0?Math.floor(a):Math.ceil(a)};A.trunc=y;function v(a,P){var L=Math.pow(10,P===void 0?6:P);return Math.round(a*L)/L}A.formatNum=v;function Z(a,P,L){var O=P[1],D=P[0],B=O-D;return a===O&&L?a:((a-D)%B+B)%B+D}A.wrapNum=Z},56917:function(Ft,A,y){"use strict";A.__esModule=!0;var v=y(31502);v.translate=function(Z,a,P){var L=Array(9);return v.fromTranslation(L,P),v.multiply(Z,L,a)},v.rotate=function(Z,a,P){var L=Array(9);return v.fromRotation(L,P),v.multiply(Z,L,a)},v.scale=function(Z,a,P){var L=Array(9);return v.fromScaling(L,P),v.multiply(Z,L,a)},v.transform=function(Z,a){for(var P=[].concat(Z),L=0,O=a.length;L<O;L+=1){var D=a[L];switch(D[0]){case"t":v.translate(P,P,[D[1],D[2]]);break;case"s":v.scale(P,P,[D[1],D[2]]);break;case"r":v.rotate(P,P,D[1]);break;default:break}}return P},A.default=v},74988:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.setMatrixArrayType=a,A.toRadian=L,A.equals=O;var y=A.EPSILON=1e-6,v=A.ARRAY_TYPE=typeof Float32Array!="undefined"?Float32Array:Array,Z=A.RANDOM=Math.random;function a(D){A.ARRAY_TYPE=v=D}var P=Math.PI/180;function L(D){return D*P}function O(D,B){return Math.abs(D-B)<=y*Math.max(1,Math.abs(D),Math.abs(B))}},31502:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.sub=A.mul=void 0,A.create=P,A.fromMat4=L,A.clone=O,A.copy=D,A.fromValues=B,A.set=V,A.identity=N,A.transpose=Y,A.invert=H,A.adjoint=ce,A.determinant=at,A.multiply=rt,A.translate=Re,A.rotate=vt,A.scale=wt,A.fromTranslation=fe,A.fromRotation=$e,A.fromScaling=re,A.fromMat2d=Ge,A.fromQuat=Qe,A.normalFromMat4=Te,A.projection=Le,A.str=Ce,A.frob=Fe,A.add=Ke,A.subtract=qt,A.multiplyScalar=ir,A.multiplyScalarAndAdd=Pe,A.exactEquals=Ne,A.equals=Xe;var v=y(74988),Z=a(v);function a(me){if(me&&me.__esModule)return me;var et={};if(me!=null)for(var or in me)Object.prototype.hasOwnProperty.call(me,or)&&(et[or]=me[or]);return et.default=me,et}function P(){var me=new Z.ARRAY_TYPE(9);return Z.ARRAY_TYPE!=Float32Array&&(me[1]=0,me[2]=0,me[3]=0,me[5]=0,me[6]=0,me[7]=0),me[0]=1,me[4]=1,me[8]=1,me}function L(me,et){return me[0]=et[0],me[1]=et[1],me[2]=et[2],me[3]=et[4],me[4]=et[5],me[5]=et[6],me[6]=et[8],me[7]=et[9],me[8]=et[10],me}function O(me){var et=new Z.ARRAY_TYPE(9);return et[0]=me[0],et[1]=me[1],et[2]=me[2],et[3]=me[3],et[4]=me[4],et[5]=me[5],et[6]=me[6],et[7]=me[7],et[8]=me[8],et}function D(me,et){return me[0]=et[0],me[1]=et[1],me[2]=et[2],me[3]=et[3],me[4]=et[4],me[5]=et[5],me[6]=et[6],me[7]=et[7],me[8]=et[8],me}function B(me,et,or,on,vr,jr,xr,Ae,De){var ke=new Z.ARRAY_TYPE(9);return ke[0]=me,ke[1]=et,ke[2]=or,ke[3]=on,ke[4]=vr,ke[5]=jr,ke[6]=xr,ke[7]=Ae,ke[8]=De,ke}function V(me,et,or,on,vr,jr,xr,Ae,De,ke){return me[0]=et,me[1]=or,me[2]=on,me[3]=vr,me[4]=jr,me[5]=xr,me[6]=Ae,me[7]=De,me[8]=ke,me}function N(me){return me[0]=1,me[1]=0,me[2]=0,me[3]=0,me[4]=1,me[5]=0,me[6]=0,me[7]=0,me[8]=1,me}function Y(me,et){if(me===et){var or=et[1],on=et[2],vr=et[5];me[1]=et[3],me[2]=et[6],me[3]=or,me[5]=et[7],me[6]=on,me[7]=vr}else me[0]=et[0],me[1]=et[3],me[2]=et[6],me[3]=et[1],me[4]=et[4],me[5]=et[7],me[6]=et[2],me[7]=et[5],me[8]=et[8];return me}function H(me,et){var or=et[0],on=et[1],vr=et[2],jr=et[3],xr=et[4],Ae=et[5],De=et[6],ke=et[7],Bt=et[8],mt=Bt*xr-Ae*ke,Mr=-Bt*jr+Ae*De,Cr=ke*jr-xr*De,Nr=or*mt+on*Mr+vr*Cr;return Nr?(Nr=1/Nr,me[0]=mt*Nr,me[1]=(-Bt*on+vr*ke)*Nr,me[2]=(Ae*on-vr*xr)*Nr,me[3]=Mr*Nr,me[4]=(Bt*or-vr*De)*Nr,me[5]=(-Ae*or+vr*jr)*Nr,me[6]=Cr*Nr,me[7]=(-ke*or+on*De)*Nr,me[8]=(xr*or-on*jr)*Nr,me):null}function ce(me,et){var or=et[0],on=et[1],vr=et[2],jr=et[3],xr=et[4],Ae=et[5],De=et[6],ke=et[7],Bt=et[8];return me[0]=xr*Bt-Ae*ke,me[1]=vr*ke-on*Bt,me[2]=on*Ae-vr*xr,me[3]=Ae*De-jr*Bt,me[4]=or*Bt-vr*De,me[5]=vr*jr-or*Ae,me[6]=jr*ke-xr*De,me[7]=on*De-or*ke,me[8]=or*xr-on*jr,me}function at(me){var et=me[0],or=me[1],on=me[2],vr=me[3],jr=me[4],xr=me[5],Ae=me[6],De=me[7],ke=me[8];return et*(ke*jr-xr*De)+or*(-ke*vr+xr*Ae)+on*(De*vr-jr*Ae)}function rt(me,et,or){var on=et[0],vr=et[1],jr=et[2],xr=et[3],Ae=et[4],De=et[5],ke=et[6],Bt=et[7],mt=et[8],Mr=or[0],Cr=or[1],Nr=or[2],nt=or[3],Ye=or[4],M=or[5],W=or[6],ue=or[7],X=or[8];return me[0]=Mr*on+Cr*xr+Nr*ke,me[1]=Mr*vr+Cr*Ae+Nr*Bt,me[2]=Mr*jr+Cr*De+Nr*mt,me[3]=nt*on+Ye*xr+M*ke,me[4]=nt*vr+Ye*Ae+M*Bt,me[5]=nt*jr+Ye*De+M*mt,me[6]=W*on+ue*xr+X*ke,me[7]=W*vr+ue*Ae+X*Bt,me[8]=W*jr+ue*De+X*mt,me}function Re(me,et,or){var on=et[0],vr=et[1],jr=et[2],xr=et[3],Ae=et[4],De=et[5],ke=et[6],Bt=et[7],mt=et[8],Mr=or[0],Cr=or[1];return me[0]=on,me[1]=vr,me[2]=jr,me[3]=xr,me[4]=Ae,me[5]=De,me[6]=Mr*on+Cr*xr+ke,me[7]=Mr*vr+Cr*Ae+Bt,me[8]=Mr*jr+Cr*De+mt,me}function vt(me,et,or){var on=et[0],vr=et[1],jr=et[2],xr=et[3],Ae=et[4],De=et[5],ke=et[6],Bt=et[7],mt=et[8],Mr=Math.sin(or),Cr=Math.cos(or);return me[0]=Cr*on+Mr*xr,me[1]=Cr*vr+Mr*Ae,me[2]=Cr*jr+Mr*De,me[3]=Cr*xr-Mr*on,me[4]=Cr*Ae-Mr*vr,me[5]=Cr*De-Mr*jr,me[6]=ke,me[7]=Bt,me[8]=mt,me}function wt(me,et,or){var on=or[0],vr=or[1];return me[0]=on*et[0],me[1]=on*et[1],me[2]=on*et[2],me[3]=vr*et[3],me[4]=vr*et[4],me[5]=vr*et[5],me[6]=et[6],me[7]=et[7],me[8]=et[8],me}function fe(me,et){return me[0]=1,me[1]=0,me[2]=0,me[3]=0,me[4]=1,me[5]=0,me[6]=et[0],me[7]=et[1],me[8]=1,me}function $e(me,et){var or=Math.sin(et),on=Math.cos(et);return me[0]=on,me[1]=or,me[2]=0,me[3]=-or,me[4]=on,me[5]=0,me[6]=0,me[7]=0,me[8]=1,me}function re(me,et){return me[0]=et[0],me[1]=0,me[2]=0,me[3]=0,me[4]=et[1],me[5]=0,me[6]=0,me[7]=0,me[8]=1,me}function Ge(me,et){return me[0]=et[0],me[1]=et[1],me[2]=0,me[3]=et[2],me[4]=et[3],me[5]=0,me[6]=et[4],me[7]=et[5],me[8]=1,me}function Qe(me,et){var or=et[0],on=et[1],vr=et[2],jr=et[3],xr=or+or,Ae=on+on,De=vr+vr,ke=or*xr,Bt=on*xr,mt=on*Ae,Mr=vr*xr,Cr=vr*Ae,Nr=vr*De,nt=jr*xr,Ye=jr*Ae,M=jr*De;return me[0]=1-mt-Nr,me[3]=Bt-M,me[6]=Mr+Ye,me[1]=Bt+M,me[4]=1-ke-Nr,me[7]=Cr-nt,me[2]=Mr-Ye,me[5]=Cr+nt,me[8]=1-ke-mt,me}function Te(me,et){var or=et[0],on=et[1],vr=et[2],jr=et[3],xr=et[4],Ae=et[5],De=et[6],ke=et[7],Bt=et[8],mt=et[9],Mr=et[10],Cr=et[11],Nr=et[12],nt=et[13],Ye=et[14],M=et[15],W=or*Ae-on*xr,ue=or*De-vr*xr,X=or*ke-jr*xr,ie=on*De-vr*Ae,ye=on*ke-jr*Ae,J=vr*ke-jr*De,ht=Bt*nt-mt*Nr,ze=Bt*Ye-Mr*Nr,pt=Bt*M-Cr*Nr,Me=mt*Ye-Mr*nt,Ue=mt*M-Cr*nt,yt=Mr*M-Cr*Ye,gt=W*yt-ue*Ue+X*Me+ie*pt-ye*ze+J*ht;return gt?(gt=1/gt,me[0]=(Ae*yt-De*Ue+ke*Me)*gt,me[1]=(De*pt-xr*yt-ke*ze)*gt,me[2]=(xr*Ue-Ae*pt+ke*ht)*gt,me[3]=(vr*Ue-on*yt-jr*Me)*gt,me[4]=(or*yt-vr*pt+jr*ze)*gt,me[5]=(on*pt-or*Ue-jr*ht)*gt,me[6]=(nt*J-Ye*ye+M*ie)*gt,me[7]=(Ye*X-Nr*J-M*ue)*gt,me[8]=(Nr*ye-nt*X+M*W)*gt,me):null}function Le(me,et,or){return me[0]=2/et,me[1]=0,me[2]=0,me[3]=0,me[4]=-2/or,me[5]=0,me[6]=-1,me[7]=1,me[8]=1,me}function Ce(me){return"mat3("+me[0]+", "+me[1]+", "+me[2]+", "+me[3]+", "+me[4]+", "+me[5]+", "+me[6]+", "+me[7]+", "+me[8]+")"}function Fe(me){return Math.sqrt(Math.pow(me[0],2)+Math.pow(me[1],2)+Math.pow(me[2],2)+Math.pow(me[3],2)+Math.pow(me[4],2)+Math.pow(me[5],2)+Math.pow(me[6],2)+Math.pow(me[7],2)+Math.pow(me[8],2))}function Ke(me,et,or){return me[0]=et[0]+or[0],me[1]=et[1]+or[1],me[2]=et[2]+or[2],me[3]=et[3]+or[3],me[4]=et[4]+or[4],me[5]=et[5]+or[5],me[6]=et[6]+or[6],me[7]=et[7]+or[7],me[8]=et[8]+or[8],me}function qt(me,et,or){return me[0]=et[0]-or[0],me[1]=et[1]-or[1],me[2]=et[2]-or[2],me[3]=et[3]-or[3],me[4]=et[4]-or[4],me[5]=et[5]-or[5],me[6]=et[6]-or[6],me[7]=et[7]-or[7],me[8]=et[8]-or[8],me}function ir(me,et,or){return me[0]=et[0]*or,me[1]=et[1]*or,me[2]=et[2]*or,me[3]=et[3]*or,me[4]=et[4]*or,me[5]=et[5]*or,me[6]=et[6]*or,me[7]=et[7]*or,me[8]=et[8]*or,me}function Pe(me,et,or,on){return me[0]=et[0]+or[0]*on,me[1]=et[1]+or[1]*on,me[2]=et[2]+or[2]*on,me[3]=et[3]+or[3]*on,me[4]=et[4]+or[4]*on,me[5]=et[5]+or[5]*on,me[6]=et[6]+or[6]*on,me[7]=et[7]+or[7]*on,me[8]=et[8]+or[8]*on,me}function Ne(me,et){return me[0]===et[0]&&me[1]===et[1]&&me[2]===et[2]&&me[3]===et[3]&&me[4]===et[4]&&me[5]===et[5]&&me[6]===et[6]&&me[7]===et[7]&&me[8]===et[8]}function Xe(me,et){var or=me[0],on=me[1],vr=me[2],jr=me[3],xr=me[4],Ae=me[5],De=me[6],ke=me[7],Bt=me[8],mt=et[0],Mr=et[1],Cr=et[2],Nr=et[3],nt=et[4],Ye=et[5],M=et[6],W=et[7],ue=et[8];return Math.abs(or-mt)<=Z.EPSILON*Math.max(1,Math.abs(or),Math.abs(mt))&&Math.abs(on-Mr)<=Z.EPSILON*Math.max(1,Math.abs(on),Math.abs(Mr))&&Math.abs(vr-Cr)<=Z.EPSILON*Math.max(1,Math.abs(vr),Math.abs(Cr))&&Math.abs(jr-Nr)<=Z.EPSILON*Math.max(1,Math.abs(jr),Math.abs(Nr))&&Math.abs(xr-nt)<=Z.EPSILON*Math.max(1,Math.abs(xr),Math.abs(nt))&&Math.abs(Ae-Ye)<=Z.EPSILON*Math.max(1,Math.abs(Ae),Math.abs(Ye))&&Math.abs(De-M)<=Z.EPSILON*Math.max(1,Math.abs(De),Math.abs(M))&&Math.abs(ke-W)<=Z.EPSILON*Math.max(1,Math.abs(ke),Math.abs(W))&&Math.abs(Bt-ue)<=Z.EPSILON*Math.max(1,Math.abs(Bt),Math.abs(ue))}var kt=A.mul=rt,rr=A.sub=qt},88395:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.forEach=A.sqrLen=A.len=A.sqrDist=A.dist=A.div=A.mul=A.sub=void 0,A.create=P,A.clone=L,A.length=O,A.fromValues=D,A.copy=B,A.set=V,A.add=N,A.subtract=Y,A.multiply=H,A.divide=ce,A.ceil=at,A.floor=rt,A.min=Re,A.max=vt,A.round=wt,A.scale=fe,A.scaleAndAdd=$e,A.distance=re,A.squaredDistance=Ge,A.squaredLength=Qe,A.negate=Te,A.inverse=Le,A.normalize=Ce,A.dot=Fe,A.cross=Ke,A.lerp=qt,A.hermite=ir,A.bezier=Pe,A.random=Ne,A.transformMat4=Xe,A.transformMat3=kt,A.transformQuat=rr,A.rotateX=me,A.rotateY=et,A.rotateZ=or,A.angle=on,A.str=vr,A.exactEquals=jr,A.equals=xr;var v=y(74988),Z=a(v);function a(nt){if(nt&&nt.__esModule)return nt;var Ye={};if(nt!=null)for(var M in nt)Object.prototype.hasOwnProperty.call(nt,M)&&(Ye[M]=nt[M]);return Ye.default=nt,Ye}function P(){var nt=new Z.ARRAY_TYPE(3);return Z.ARRAY_TYPE!=Float32Array&&(nt[0]=0,nt[1]=0,nt[2]=0),nt}function L(nt){var Ye=new Z.ARRAY_TYPE(3);return Ye[0]=nt[0],Ye[1]=nt[1],Ye[2]=nt[2],Ye}function O(nt){var Ye=nt[0],M=nt[1],W=nt[2];return Math.sqrt(Ye*Ye+M*M+W*W)}function D(nt,Ye,M){var W=new Z.ARRAY_TYPE(3);return W[0]=nt,W[1]=Ye,W[2]=M,W}function B(nt,Ye){return nt[0]=Ye[0],nt[1]=Ye[1],nt[2]=Ye[2],nt}function V(nt,Ye,M,W){return nt[0]=Ye,nt[1]=M,nt[2]=W,nt}function N(nt,Ye,M){return nt[0]=Ye[0]+M[0],nt[1]=Ye[1]+M[1],nt[2]=Ye[2]+M[2],nt}function Y(nt,Ye,M){return nt[0]=Ye[0]-M[0],nt[1]=Ye[1]-M[1],nt[2]=Ye[2]-M[2],nt}function H(nt,Ye,M){return nt[0]=Ye[0]*M[0],nt[1]=Ye[1]*M[1],nt[2]=Ye[2]*M[2],nt}function ce(nt,Ye,M){return nt[0]=Ye[0]/M[0],nt[1]=Ye[1]/M[1],nt[2]=Ye[2]/M[2],nt}function at(nt,Ye){return nt[0]=Math.ceil(Ye[0]),nt[1]=Math.ceil(Ye[1]),nt[2]=Math.ceil(Ye[2]),nt}function rt(nt,Ye){return nt[0]=Math.floor(Ye[0]),nt[1]=Math.floor(Ye[1]),nt[2]=Math.floor(Ye[2]),nt}function Re(nt,Ye,M){return nt[0]=Math.min(Ye[0],M[0]),nt[1]=Math.min(Ye[1],M[1]),nt[2]=Math.min(Ye[2],M[2]),nt}function vt(nt,Ye,M){return nt[0]=Math.max(Ye[0],M[0]),nt[1]=Math.max(Ye[1],M[1]),nt[2]=Math.max(Ye[2],M[2]),nt}function wt(nt,Ye){return nt[0]=Math.round(Ye[0]),nt[1]=Math.round(Ye[1]),nt[2]=Math.round(Ye[2]),nt}function fe(nt,Ye,M){return nt[0]=Ye[0]*M,nt[1]=Ye[1]*M,nt[2]=Ye[2]*M,nt}function $e(nt,Ye,M,W){return nt[0]=Ye[0]+M[0]*W,nt[1]=Ye[1]+M[1]*W,nt[2]=Ye[2]+M[2]*W,nt}function re(nt,Ye){var M=Ye[0]-nt[0],W=Ye[1]-nt[1],ue=Ye[2]-nt[2];return Math.sqrt(M*M+W*W+ue*ue)}function Ge(nt,Ye){var M=Ye[0]-nt[0],W=Ye[1]-nt[1],ue=Ye[2]-nt[2];return M*M+W*W+ue*ue}function Qe(nt){var Ye=nt[0],M=nt[1],W=nt[2];return Ye*Ye+M*M+W*W}function Te(nt,Ye){return nt[0]=-Ye[0],nt[1]=-Ye[1],nt[2]=-Ye[2],nt}function Le(nt,Ye){return nt[0]=1/Ye[0],nt[1]=1/Ye[1],nt[2]=1/Ye[2],nt}function Ce(nt,Ye){var M=Ye[0],W=Ye[1],ue=Ye[2],X=M*M+W*W+ue*ue;return X>0&&(X=1/Math.sqrt(X),nt[0]=Ye[0]*X,nt[1]=Ye[1]*X,nt[2]=Ye[2]*X),nt}function Fe(nt,Ye){return nt[0]*Ye[0]+nt[1]*Ye[1]+nt[2]*Ye[2]}function Ke(nt,Ye,M){var W=Ye[0],ue=Ye[1],X=Ye[2],ie=M[0],ye=M[1],J=M[2];return nt[0]=ue*J-X*ye,nt[1]=X*ie-W*J,nt[2]=W*ye-ue*ie,nt}function qt(nt,Ye,M,W){var ue=Ye[0],X=Ye[1],ie=Ye[2];return nt[0]=ue+W*(M[0]-ue),nt[1]=X+W*(M[1]-X),nt[2]=ie+W*(M[2]-ie),nt}function ir(nt,Ye,M,W,ue,X){var ie=X*X,ye=ie*(2*X-3)+1,J=ie*(X-2)+X,ht=ie*(X-1),ze=ie*(3-2*X);return nt[0]=Ye[0]*ye+M[0]*J+W[0]*ht+ue[0]*ze,nt[1]=Ye[1]*ye+M[1]*J+W[1]*ht+ue[1]*ze,nt[2]=Ye[2]*ye+M[2]*J+W[2]*ht+ue[2]*ze,nt}function Pe(nt,Ye,M,W,ue,X){var ie=1-X,ye=ie*ie,J=X*X,ht=ye*ie,ze=3*X*ye,pt=3*J*ie,Me=J*X;return nt[0]=Ye[0]*ht+M[0]*ze+W[0]*pt+ue[0]*Me,nt[1]=Ye[1]*ht+M[1]*ze+W[1]*pt+ue[1]*Me,nt[2]=Ye[2]*ht+M[2]*ze+W[2]*pt+ue[2]*Me,nt}function Ne(nt,Ye){Ye=Ye||1;var M=Z.RANDOM()*2*Math.PI,W=Z.RANDOM()*2-1,ue=Math.sqrt(1-W*W)*Ye;return nt[0]=Math.cos(M)*ue,nt[1]=Math.sin(M)*ue,nt[2]=W*Ye,nt}function Xe(nt,Ye,M){var W=Ye[0],ue=Ye[1],X=Ye[2],ie=M[3]*W+M[7]*ue+M[11]*X+M[15];return ie=ie||1,nt[0]=(M[0]*W+M[4]*ue+M[8]*X+M[12])/ie,nt[1]=(M[1]*W+M[5]*ue+M[9]*X+M[13])/ie,nt[2]=(M[2]*W+M[6]*ue+M[10]*X+M[14])/ie,nt}function kt(nt,Ye,M){var W=Ye[0],ue=Ye[1],X=Ye[2];return nt[0]=W*M[0]+ue*M[3]+X*M[6],nt[1]=W*M[1]+ue*M[4]+X*M[7],nt[2]=W*M[2]+ue*M[5]+X*M[8],nt}function rr(nt,Ye,M){var W=M[0],ue=M[1],X=M[2],ie=M[3],ye=Ye[0],J=Ye[1],ht=Ye[2],ze=ue*ht-X*J,pt=X*ye-W*ht,Me=W*J-ue*ye,Ue=ue*Me-X*pt,yt=X*ze-W*Me,gt=W*pt-ue*ze,nr=ie*2;return ze*=nr,pt*=nr,Me*=nr,Ue*=2,yt*=2,gt*=2,nt[0]=ye+ze+Ue,nt[1]=J+pt+yt,nt[2]=ht+Me+gt,nt}function me(nt,Ye,M,W){var ue=[],X=[];return ue[0]=Ye[0]-M[0],ue[1]=Ye[1]-M[1],ue[2]=Ye[2]-M[2],X[0]=ue[0],X[1]=ue[1]*Math.cos(W)-ue[2]*Math.sin(W),X[2]=ue[1]*Math.sin(W)+ue[2]*Math.cos(W),nt[0]=X[0]+M[0],nt[1]=X[1]+M[1],nt[2]=X[2]+M[2],nt}function et(nt,Ye,M,W){var ue=[],X=[];return ue[0]=Ye[0]-M[0],ue[1]=Ye[1]-M[1],ue[2]=Ye[2]-M[2],X[0]=ue[2]*Math.sin(W)+ue[0]*Math.cos(W),X[1]=ue[1],X[2]=ue[2]*Math.cos(W)-ue[0]*Math.sin(W),nt[0]=X[0]+M[0],nt[1]=X[1]+M[1],nt[2]=X[2]+M[2],nt}function or(nt,Ye,M,W){var ue=[],X=[];return ue[0]=Ye[0]-M[0],ue[1]=Ye[1]-M[1],ue[2]=Ye[2]-M[2],X[0]=ue[0]*Math.cos(W)-ue[1]*Math.sin(W),X[1]=ue[0]*Math.sin(W)+ue[1]*Math.cos(W),X[2]=ue[2],nt[0]=X[0]+M[0],nt[1]=X[1]+M[1],nt[2]=X[2]+M[2],nt}function on(nt,Ye){var M=D(nt[0],nt[1],nt[2]),W=D(Ye[0],Ye[1],Ye[2]);Ce(M,M),Ce(W,W);var ue=Fe(M,W);return ue>1?0:ue<-1?Math.PI:Math.acos(ue)}function vr(nt){return"vec3("+nt[0]+", "+nt[1]+", "+nt[2]+")"}function jr(nt,Ye){return nt[0]===Ye[0]&&nt[1]===Ye[1]&&nt[2]===Ye[2]}function xr(nt,Ye){var M=nt[0],W=nt[1],ue=nt[2],X=Ye[0],ie=Ye[1],ye=Ye[2];return Math.abs(M-X)<=Z.EPSILON*Math.max(1,Math.abs(M),Math.abs(X))&&Math.abs(W-ie)<=Z.EPSILON*Math.max(1,Math.abs(W),Math.abs(ie))&&Math.abs(ue-ye)<=Z.EPSILON*Math.max(1,Math.abs(ue),Math.abs(ye))}var Ae=A.sub=Y,De=A.mul=H,ke=A.div=ce,Bt=A.dist=re,mt=A.sqrDist=Ge,Mr=A.len=O,Cr=A.sqrLen=Qe,Nr=A.forEach=function(){var nt=P();return function(Ye,M,W,ue,X,ie){var ye=void 0,J=void 0;for(M||(M=3),W||(W=0),ue?J=Math.min(ue*M+W,Ye.length):J=Ye.length,ye=W;ye<J;ye+=M)nt[0]=Ye[ye],nt[1]=Ye[ye+1],nt[2]=Ye[ye+2],X(nt,nt,ie),Ye[ye]=nt[0],Ye[ye+1]=nt[1],Ye[ye+2]=nt[2];return Ye}}()},66845:function(Ft,A,y){"use strict";y.r(A),y.d(A,{Control:function(){return fe},Layers:function(){return Ge},Logo:function(){return Le},Marker:function(){return me},MarkerLayer:function(){return ke},Popup:function(){return Nr},Scale:function(){return Ke},Zoom:function(){return Pe}});function v(Ye,M){if(!(Ye instanceof M))throw new TypeError("Cannot call a class as a function")}function Z(Ye,M){for(var W=0;W<M.length;W++){var ue=M[W];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(Ye,ue.key,ue)}}function a(Ye,M,W){return M&&Z(Ye.prototype,M),W&&Z(Ye,W),Object.defineProperty(Ye,"prototype",{writable:!1}),Ye}function P(Ye){if(Ye===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ye}function L(Ye,M){return L=Object.setPrototypeOf||function(ue,X){return ue.__proto__=X,ue},L(Ye,M)}function O(Ye,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function");Ye.prototype=Object.create(M&&M.prototype,{constructor:{value:Ye,writable:!0,configurable:!0}}),Object.defineProperty(Ye,"prototype",{writable:!1}),M&&L(Ye,M)}function D(Ye){return D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},D(Ye)}function B(Ye,M){if(M&&(D(M)==="object"||typeof M=="function"))return M;if(M!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P(Ye)}function V(Ye){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(W){return W.__proto__||Object.getPrototypeOf(W)},V(Ye)}function N(Ye,M,W){return M in Ye?Object.defineProperty(Ye,M,{value:W,enumerable:!0,configurable:!0,writable:!0}):Ye[M]=W,Ye}var Y=y(39128),H=y(86049),ce=y(26729);function at(Ye,M){var W=Object.keys(Ye);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(Ye);M&&(ue=ue.filter(function(X){return Object.getOwnPropertyDescriptor(Ye,X).enumerable})),W.push.apply(W,ue)}return W}function rt(Ye){for(var M=1;M<arguments.length;M++){var W=arguments[M]!=null?arguments[M]:{};M%2?at(Object(W),!0).forEach(function(ue){N(Ye,ue,W[ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ye,Object.getOwnPropertyDescriptors(W)):at(Object(W)).forEach(function(ue){Object.defineProperty(Ye,ue,Object.getOwnPropertyDescriptor(W,ue))})}return Ye}function Re(Ye){var M=vt();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function vt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var wt=0,fe=function(Ye){O(W,Ye);var M=Re(W);function W(ue){var X;return v(this,W),X=M.call(this),N(P(X),"controlOption",void 0),N(P(X),"container",void 0),N(P(X),"sceneContainer",void 0),N(P(X),"mapsService",void 0),N(P(X),"renderService",void 0),N(P(X),"layerService",void 0),N(P(X),"controlService",void 0),N(P(X),"isShow",void 0),X.controlOption=rt(rt({},X.getDefault()),ue||{}),X}return a(W,[{key:"getDefault",value:function(){return{position:Y.PositionType.TOPRIGHT,name:"".concat(wt++)}}},{key:"setPosition",value:function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y.PositionType.BOTTOMRIGHT,ie=this.controlService;return ie&&ie.removeControl(this),this.controlOption.position=X,ie&&ie.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(X){this.mapsService=X.get(Y.TYPES.IMapService),this.renderService=X.get(Y.TYPES.IRendererService),this.layerService=X.get(Y.TYPES.ILayerService),this.controlService=X.get(Y.TYPES.IControlService),this.sceneContainer=X,this.isShow=!0,this.container=this.onAdd();var ie=this.container,ye=this.controlOption.position,J=this.controlService.controlCorners[ye];return H.DOM.addClass(ie,"l7-control"),ye.indexOf("bottom")!==-1?J.insertBefore(ie,J.firstChild):J.appendChild(ie),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var X=this.container;H.DOM.addClass(X,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var X=this.container;H.DOM.removeClass(X,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;H.DOM.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(X){if(this.mapsService&&X&&X.screenX>0&&X.screenY>0){var ie=this.mapsService.getContainer();ie!==null&&ie.focus()}}}]),W}(ce.EventEmitter);function $e(Ye){var M=re();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function re(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var Ge=function(Ye){O(W,Ye);var M=$e(W);function W(ue){var X;return v(this,W),X=M.call(this,ue),N(P(X),"layerControlInputs",void 0),N(P(X),"layers",void 0),N(P(X),"lastZIndex",void 0),N(P(X),"handlingClick",void 0),N(P(X),"layersLink",void 0),N(P(X),"baseLayersList",void 0),N(P(X),"separator",void 0),N(P(X),"overlaysList",void 0),N(P(X),"form",void 0),X.layerControlInputs=[],X.layers=[],X.lastZIndex=0,X.handlingClick=!1,X.initLayers(),(0,H.bindAll)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],P(X)),X}return a(W,[{key:"getDefault",value:function(){return{collapsed:!0,position:Y.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var X=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(ie){ie.layer.on("remove",X.onLayerChange),ie.layer.on("add",X.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(X,ie){return this.addLayer(X,ie,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var X=this.renderService.getViewportSize(),ie=X.height;H.DOM.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var ye=ie-(this.container.offsetTop+50);return ye<this.form.clientHeight?(H.DOM.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=ye+"px"):H.DOM.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return H.DOM.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var X=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(ie){ie.layer.off("remove",X.onLayerChange),ie.layer.off("add",X.onLayerChange)}))}},{key:"initLayout",value:function(){var X="l7-control-layers",ie=this.container=H.DOM.create("div",X),ye=this.controlOption.collapsed;ie.setAttribute("aria-haspopup","true");var J=this.form=H.DOM.create("form",X+"-list");ye&&(this.mapsService.on("click",this.collapse),ie.addEventListener("mouseenter",this.expand),ie.addEventListener("mouseleave",this.collapse)),this.layersLink=H.DOM.create("a",X+"-toggle",ie);var ht=this.layersLink;ht.title="Layers",ye||this.expand(),this.baseLayersList=H.DOM.create("div",X+"-base",J),this.separator=H.DOM.create("div",X+"-separator",J),this.overlaysList=H.DOM.create("div",X+"-overlays",J),ie.appendChild(J)}},{key:"initLayers",value:function(){var X=this,ie=this.controlOption,ye=ie.baseLayers,J=ye===void 0?{}:ye,ht=ie.overlayers,ze=ht===void 0?{}:ht;Object.keys(J).forEach(function(pt,Me){X.addLayer(J[pt],pt,!1)}),Object.keys(ze).forEach(function(pt,Me){X.addLayer(ze[pt],pt,!0)})}},{key:"update",value:function(){if(!this.container)return this;H.DOM.empty(this.baseLayersList),H.DOM.empty(this.overlaysList),this.layerControlInputs=[];var X,ie,ye,J,ht=0;for(ye=0;ye<this.layers.length;ye++)J=this.layers[ye],this.addItem(J),ie=ie||J.overlay,X=X||!J.overlay,ht+=J.overlay?0:1;return this.controlOption.hideSingleBase&&(X=X&&ht>1,this.baseLayersList.style.display=X?"":"none"),this.separator.style.display=ie&&X?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var X=this.layerControlInputs,ie,ye,J=this.mapsService.getZoom(),ht=X.length-1;ht>=0;ht--)if(ie=X[ht],ye=this.layerService.getLayer(ie.layerId),ye&&ye.inited){var ze=ye.getMinZoom(),pt=ye.getMaxZoom();ie.disabled=J<ze||J>pt}}},{key:"addLayer",value:function(X,ie,ye){this.mapsService&&(X.on("add",this.onLayerChange),X.on("remove",this.onLayerChange)),this.layers.push({layer:X,name:ie,overlay:ye});var J=this.controlOption,ht=J.sortLayers,ze=J.sortFunction,pt=J.autoZIndex;ht&&this.layers.sort(function(Me,Ue){return ze(Me.layer,Ue.layer,Me.name,Ue.name)}),pt&&X.setZIndex&&(this.lastZIndex++,X.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(X){this.handlingClick||this.update();var ie=this.layerService.getLayer(X.target.layerId),ye=ie!=null&&ie.overlay?X.type==="add"?"overlayadd":"overlayremove":X.type==="add"?"baselayerchange":null;ye&&this.emit(ye,ie)}},{key:"createRadioElement",value:function(X,ie){var ye='<input type="radio" class="l7-control-layers-selector" name="'+X+'"'+(ie?' checked="checked"':"")+"/>",J=document.createElement("div");return J.innerHTML=ye,J.firstChild}},{key:"addItem",value:function(X){var ie=document.createElement("label"),ye=this.layerService.getLayer(X.layer.id),J=ye&&ye.inited&&X.layer.isVisible(),ht;X.overlay?(ht=document.createElement("input"),ht.type="checkbox",ht.className="l7-control-layers-selector",ht.defaultChecked=J):ht=this.createRadioElement("l7-base-layers",J),this.layerControlInputs.push(ht),ht.layerId=X.layer.id,ht.addEventListener("click",this.onInputClick);var ze=document.createElement("span");ze.innerHTML=" "+X.name;var pt=document.createElement("div");ie.appendChild(pt),pt.appendChild(ht),pt.appendChild(ze);var Me=X.overlay?this.overlaysList:this.baseLayersList;return Me.appendChild(ie),this.checkDisabledLayers(),ie}},{key:"onInputClick",value:function(){var X=this.layerControlInputs,ie,ye,J=[],ht=[];this.handlingClick=!0;for(var ze=X.length-1;ze>=0;ze--)ie=X[ze],ye=this.layerService.getLayer(ie.layerId),ie.checked?J.push(ye):ie.checked||ht.push(ye);ht.forEach(function(pt){pt.hide()}),J.forEach(function(pt){pt.show()}),this.handlingClick=!1}}]),W}(fe);function Qe(Ye){var M=Te();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function Te(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var Le=function(Ye){O(W,Ye);var M=Qe(W);function W(){return v(this,W),M.apply(this,arguments)}return a(W,[{key:"getDefault",value:function(){return{position:Y.PositionType.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var X="l7-control-logo",ie=H.DOM.create("div",X),ye=H.DOM.create("a","l7-ctrl-logo");return ye.target="_blank",ye.rel="noopener nofollow",ye.href="https://antv.alipay.com/l7",ye.setAttribute("aria-label","AntV logo"),ye.setAttribute("rel","noopener nofollow"),ie.appendChild(ye),ie}},{key:"onRemove",value:function(){return null}}]),W}(fe);function Ce(Ye){var M=Fe();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function Fe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var Ke=function(Ye){O(W,Ye);var M=Ce(W);function W(ue){var X;return v(this,W),X=M.call(this,ue),N(P(X),"mScale",void 0),N(P(X),"iScale",void 0),(0,H.bindAll)(["update"],P(X)),X}return a(W,[{key:"getDefault",value:function(){return{position:Y.PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var X="l7-control-scale",ie=H.DOM.create("div",X);this.addScales(X+"-line",ie);var ye=this.controlOption.updateWhenIdle;return this.mapsService.on(ye?"moveend":"mapmove",this.update),this.mapsService.on(ye?"zoomend":"zoomchange",this.update),this.update(),ie}},{key:"onRemove",value:function(){var X=this.controlOption.updateWhenIdle;this.mapsService.off(X?"zoomend":"zoomchange",this.update),this.mapsService.off(X?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var X=this.mapsService,ie=this.controlOption.maxWidth,ye=X.getSize()[1]/2,J=X.containerToLngLat([0,ye]),ht=X.containerToLngLat([ie,ye]),ze=(0,H.lnglatDistance)([J.lng,J.lat],[ht.lng,ht.lat]);this.updateScales(ze)}},{key:"updateScales",value:function(X){var ie=this.controlOption,ye=ie.metric,J=ie.imperial;ye&&X&&this.updateMetric(X),J&&X&&this.updateImperial(X)}},{key:"updateMetric",value:function(X){var ie=this.getRoundNum(X),ye=ie<1e3?ie+" m":ie/1e3+" km";this.updateScale(this.mScale,ye,ie/X)}},{key:"updateImperial",value:function(X){var ie=X*3.2808399,ye,J,ht;ie>5280?(ye=ie/5280,J=this.getRoundNum(ye),this.updateScale(this.iScale,J+" mi",J/ye)):(ht=this.getRoundNum(ie),this.updateScale(this.iScale,ht+" ft",ht/ie))}},{key:"updateScale",value:function(X,ie,ye){var J=this.controlOption.maxWidth;X.style.width=Math.round(J*ye)+"px",X.innerHTML=ie}},{key:"getRoundNum",value:function(X){var ie=Math.pow(10,(Math.floor(X)+"").length-1),ye=X/ie;return ye=ye>=10?10:ye>=5?5:ye>=3?3:ye>=2?2:1,ie*ye}},{key:"addScales",value:function(X,ie){var ye=this.controlOption,J=ye.metric,ht=ye.imperial;J&&(this.mScale=H.DOM.create("div",X,ie)),ht&&(this.iScale=H.DOM.create("div",X,ie))}}]),W}(fe);function qt(Ye){var M=ir();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function ir(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var Pe=function(Ye){O(W,Ye);var M=qt(W);function W(ue){var X;return v(this,W),X=M.call(this,ue),N(P(X),"disabled",void 0),N(P(X),"zoomInButton",void 0),N(P(X),"zoomOutButton",void 0),(0,H.bindAll)(["updateDisabled","zoomIn","zoomOut"],P(X)),X}return a(W,[{key:"getDefault",value:function(){return{position:Y.PositionType.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var X="l7-control-zoom",ie=H.DOM.create("div",X+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,X+"-in",ie,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,X+"-out",ie,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),ie}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(X,ie,ye,J,ht){var ze=H.DOM.create("a",ye,J);return ze.innerHTML=X,ze.title=ie,ze.href="javascript:void(0)",ze.addEventListener("click",ht),ze}},{key:"updateDisabled",value:function(){var X=this.mapsService,ie="l7-disabled";H.DOM.removeClass(this.zoomInButton,ie),H.DOM.removeClass(this.zoomOutButton,ie),(this.disabled||X.getZoom()<=X.getMinZoom())&&H.DOM.addClass(this.zoomOutButton,ie),(this.disabled||X.getZoom()>=X.getMaxZoom())&&H.DOM.addClass(this.zoomInButton,ie)}}]),W}(fe);function Ne(Ye,M){var W=Object.keys(Ye);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(Ye);M&&(ue=ue.filter(function(X){return Object.getOwnPropertyDescriptor(Ye,X).enumerable})),W.push.apply(W,ue)}return W}function Xe(Ye){for(var M=1;M<arguments.length;M++){var W=arguments[M]!=null?arguments[M]:{};M%2?Ne(Object(W),!0).forEach(function(ue){N(Ye,ue,W[ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ye,Object.getOwnPropertyDescriptors(W)):Ne(Object(W)).forEach(function(ue){Object.defineProperty(Ye,ue,Object.getOwnPropertyDescriptor(W,ue))})}return Ye}function kt(Ye){var M=rr();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function rr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var me=function(Ye){O(W,Ye);var M=kt(W);function W(ue){var X;return v(this,W),X=M.call(this),N(P(X),"markerOption",void 0),N(P(X),"defaultMarker",void 0),N(P(X),"popup",void 0),N(P(X),"mapsService",void 0),N(P(X),"sceneSerive",void 0),N(P(X),"lngLat",void 0),N(P(X),"scene",void 0),N(P(X),"added",!1),N(P(X),"eventHandle",function(ie){X.emit(ie.type,{target:ie,data:X.markerOption.extData,lngLat:X.lngLat})}),X.markerOption=Xe(Xe({},X.getDefault()),ue),(0,H.bindAll)(["update","onMove","onUp","addDragHandler","onMapClick"],P(X)),X.init(),X}return a(W,[{key:"getDefault",value:function(){return{element:void 0,anchor:H.anchorType.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(X){this.scene=X,this.mapsService=X.get(Y.TYPES.IMapService),this.sceneSerive=X.get(Y.TYPES.ISceneService);var ie=this.markerOption,ye=ie.element,J=ie.draggable;return this.mapsService.getMarkerContainer().appendChild(ye),this.registerMarkerEvent(ye),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var X=this.markerOption.element;return X&&H.DOM.remove(X),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(X){return this.lngLat=X,Array.isArray(X)&&(this.lngLat={lng:X[0],lat:X[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(X){var ie=this;if(!this.added)return this.once("added",function(){ie.setElement(X)}),this;var ye=this.markerOption.element;return ye&&H.DOM.remove(ye),this.markerOption.element=X,this.init(),this.mapsService.getMarkerContainer().appendChild(X),this.registerMarkerEvent(X),this.update(),this}},{key:"openPopup",value:function(){var X=this;if(!this.added)return this.once("added",function(){X.openPopup()}),this;var ie=this.popup;return ie?(ie.isOpen()||ie.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var X=this;this.added||this.once("added",function(){X.closePopup()});var ie=this.popup;return ie&&ie.remove(),this}},{key:"setPopup",value:function(X){return this.popup=X,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var X=this.popup;if(X)X.isOpen()?X.remove():X.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(X){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(X){this.markerOption.extData=X}},{key:"update",value:function(){if(!!this.mapsService){var X=this.markerOption,ie=X.element,ye=X.anchor;this.updatePosition(),H.DOM.setTransform(ie,"".concat(H.anchorTranslate[ye]))}}},{key:"onMapClick",value:function(X){var ie=this.markerOption.element;this.popup&&ie&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!!this.mapsService){var X=this.markerOption,ie=X.element,ye=X.offsets,J=this.lngLat,ht=J.lng,ze=J.lat,pt=this.mapsService.getBounds(),Me=this.mapsService.lngLatToContainer([ht,ze]);if(ie){ie.style.display="block",ie.style.whiteSpace="nowrap";var Ue=this.mapsService.getContainer(),yt=0,gt=0;if(Ue&&(yt=Ue.scrollWidth,gt=Ue.scrollHeight),Math.abs(pt[0][0])>180||Math.abs(pt[1][0])>180){if(Me.x>yt){var nr=this.mapsService.lngLatToContainer([ht-360,ze]);Me.x=nr.x}if(Me.x<0){var pe=this.mapsService.lngLatToContainer([ht+360,ze]);Me.x=pe.x}}(Me.x>yt||Me.x<0||Me.y>gt||Me.y<0)&&(ie.style.display="none"),ie.style.left=Me.x+ye[0]+"px",ie.style.top=Me.y-ye[1]+"px"}}}},{key:"init",value:function(){var X=this,ie=this.markerOption.element,ye=this.markerOption,J=ye.color,ht=ye.anchor;if(!ie){this.defaultMarker=!0,ie=H.DOM.create("div"),this.markerOption.element=ie;var ze=document.createElementNS("http://www.w3.org/2000/svg","svg");ze.setAttributeNS(null,"display","block"),ze.setAttributeNS(null,"height","48px"),ze.setAttributeNS(null,"width","48px"),ze.setAttributeNS(null,"viewBox","0 0 1024 1024");var pt=document.createElementNS("http://www.w3.org/2000/svg","path");pt.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),pt.setAttributeNS(null,"fill",J),ze.appendChild(pt),ie.appendChild(ze)}H.DOM.addClass(ie,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(Me){var Ue,yt,gt=((Ue=X.markerOption)===null||Ue===void 0?void 0:Ue.style)&&((yt=X.markerOption)===null||yt===void 0?void 0:yt.style[Me]);ie&&(ie.style[Me]=gt)}),ie.addEventListener("click",function(Me){X.onMapClick(Me)}),ie.addEventListener("click",this.eventHandle),(0,H.applyAnchorClass)(ie,ht,"marker")}},{key:"registerMarkerEvent",value:function(X){X.addEventListener("mousemove",this.eventHandle),X.addEventListener("click",this.eventHandle),X.addEventListener("mousedown",this.eventHandle),X.addEventListener("mouseup",this.eventHandle),X.addEventListener("dblclick",this.eventHandle),X.addEventListener("contextmenu",this.eventHandle),X.addEventListener("mouseover",this.eventHandle),X.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var X=this.getElement();X.removeEventListener("mousemove",this.eventHandle),X.removeEventListener("click",this.eventHandle),X.removeEventListener("mousedown",this.eventHandle),X.removeEventListener("mouseup",this.eventHandle),X.removeEventListener("dblclick",this.eventHandle),X.removeEventListener("contextmenu",this.eventHandle),X.removeEventListener("mouseover",this.eventHandle),X.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(X){throw new Error("Method not implemented.")}},{key:"onUp",value:function(X){throw new Error("Method not implemented.")}}]),W}(ce.EventEmitter),et=y(82492),or=y.n(et),on=y(69848),vr=y.n(on);function jr(Ye,M){var W=Object.keys(Ye);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(Ye);M&&(ue=ue.filter(function(X){return Object.getOwnPropertyDescriptor(Ye,X).enumerable})),W.push.apply(W,ue)}return W}function xr(Ye){for(var M=1;M<arguments.length;M++){var W=arguments[M]!=null?arguments[M]:{};M%2?jr(Object(W),!0).forEach(function(ue){N(Ye,ue,W[ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ye,Object.getOwnPropertyDescriptors(W)):jr(Object(W)).forEach(function(ue){Object.defineProperty(Ye,ue,Object.getOwnPropertyDescriptor(W,ue))})}return Ye}function Ae(Ye){var M=De();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function De(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var ke=function(Ye){O(W,Ye);var M=Ae(W);function W(ue){var X,ie;return v(this,W),ie=M.call(this),N(P(ie),"markers",[]),N(P(ie),"markerLayerOption",void 0),N(P(ie),"clusterIndex",void 0),N(P(ie),"points",[]),N(P(ie),"clusterMarkers",[]),N(P(ie),"mapsService",void 0),N(P(ie),"scene",void 0),N(P(ie),"zoom",void 0),N(P(ie),"bbox",void 0),ie.markerLayerOption=or()(ie.getDefault(),ue),(0,H.bindAll)(["update"],P(ie)),ie.zoom=((X=ie.markerLayerOption.clusterOption)===null||X===void 0?void 0:X.zoom)||-99,ie}return a(W,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(X){return this.scene=X,this.mapsService=X.get(Y.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(X){var ie=this.markerLayerOption.cluster;if(ie&&(this.addPoint(X,this.markers.length),this.mapsService)){var ye=this.mapsService.getZoom(),J=this.mapsService.getBounds();this.bbox=(0,H.padBounds)(J,.5),this.zoom=Math.floor(ye),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(X)}},{key:"removeMarker",value:function(X){this.markers.indexOf(X);var ie=this.markers.indexOf(X);ie>-1&&this.markers.splice(ie,1)}},{key:"hide",value:function(){this.markers.map(function(X){X.getElement().style.opacity="0"}),this.clusterMarkers.map(function(X){X.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(X){X.getElement().style.opacity="1"}),this.clusterMarkers.map(function(X){X.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var X=this.markerLayerOption.cluster;return X?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var X=this;this.getMarkers().forEach(function(ie){ie.addTo(X.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(X){X.remove()}),this.clusterMarkers.forEach(function(X){X.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(X,ie){var ye=X.getLnglat(),J=ye.lng,ht=ye.lat,ze={geometry:{type:"Point",coordinates:[J,ht]},properties:xr(xr({},X.getExtData()),{},{marker_id:ie})};this.points.push(ze),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var X=this.markerLayerOption.clusterOption,ie=X.radius,ye=X.minZoom,J=ye===void 0?0:ye,ht=X.maxZoom;this.clusterIndex=new(vr())({radius:ie,minZoom:J,maxZoom:ht}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(X,ie){var ye=this,J=X[0].concat(X[1]),ht=this.clusterIndex.getClusters(J,ie);this.clusterMarkers.forEach(function(ze){ze.remove()}),this.clusterMarkers=[],ht.forEach(function(ze){var pt,Me=ye.markerLayerOption.clusterOption,Ue=Me.field,yt=Me.method;if(ze.properties&&(pt=ze.properties)!==null&&pt!==void 0&&pt.cluster_id){var gt,nr=ye.getLeaves((gt=ze.properties)===null||gt===void 0?void 0:gt.cluster_id);if(ze.properties.clusterData=nr,Ue&&yt){var pe=nr==null?void 0:nr.map(function(bn){var Gn=N({},Ue,bn.properties[Ue]);return Gn}),lr=H.Satistics.getColumn(pe,Ue),Ur=H.Satistics.getSatByColumn(yt,lr),Hr="point_"+yt;ze.properties[Hr]=Ur.toFixed(2)}}var un=ye.clusterMarker(ze);ye.clusterMarkers.push(un),un.addTo(ye.scene)})}},{key:"getLeaves",value:function(X){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return X?this.clusterIndex.getLeaves(X,ie,ye):null}},{key:"clusterMarker",value:function(X){var ie=this.markerLayerOption.clusterOption,ye=ie,J=ye.element,ht=J===void 0?this.generateElement.bind(this):J,ze=new me({element:ht(X)}).setLnglat({lng:X.geometry.coordinates[0],lat:X.geometry.coordinates[1]});return ze}},{key:"normalMarker",value:function(X){var ie=X.properties.marker_id;return this.markers[ie]}},{key:"update",value:function(){if(!!this.mapsService){var X=this.mapsService.getZoom(),ie=this.mapsService.getBounds();(!this.bbox||Math.abs(X-this.zoom)>=1||!(0,H.boundsContains)(this.bbox,ie))&&(this.bbox=(0,H.padBounds)(ie,.5),this.zoom=Math.floor(X),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(X){var ie=H.DOM.create("div","l7-marker-cluster"),ye=H.DOM.create("div","",ie),J=H.DOM.create("span","",ye),ht=this.markerLayerOption.clusterOption,ze=ht.field,pt=ht.method;X.properties.point_count=X.properties.point_count||1;var Me=ze&&pt?X.properties["point_"+pt]||X.properties[ze]:X.properties.point_count;return J.textContent=Me,ie}}]),W}(ce.EventEmitter);function Bt(Ye,M){var W=Object.keys(Ye);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(Ye);M&&(ue=ue.filter(function(X){return Object.getOwnPropertyDescriptor(Ye,X).enumerable})),W.push.apply(W,ue)}return W}function mt(Ye){for(var M=1;M<arguments.length;M++){var W=arguments[M]!=null?arguments[M]:{};M%2?Bt(Object(W),!0).forEach(function(ue){N(Ye,ue,W[ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ye,Object.getOwnPropertyDescriptors(W)):Bt(Object(W)).forEach(function(ue){Object.defineProperty(Ye,ue,Object.getOwnPropertyDescriptor(W,ue))})}return Ye}function Mr(Ye){var M=Cr();return function(){var ue=V(Ye),X;if(M){var ie=V(this).constructor;X=Reflect.construct(ue,arguments,ie)}else X=ue.apply(this,arguments);return B(this,X)}}function Cr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Ye){return!1}}var Nr=function(Ye){O(W,Ye);var M=Mr(W);function W(ue){var X;return v(this,W),X=M.call(this),N(P(X),"popupOption",void 0),N(P(X),"mapsService",void 0),N(P(X),"sceneSerive",void 0),N(P(X),"lngLat",void 0),N(P(X),"content",void 0),N(P(X),"closeButton",void 0),N(P(X),"timeoutInstance",void 0),N(P(X),"container",void 0),N(P(X),"tip",void 0),N(P(X),"scene",void 0),X.popupOption=mt(mt({},X.getdefault()),ue),(0,H.bindAll)(["update","onClickClose","remove"],P(X)),X}return a(W,[{key:"addTo",value:function(X){var ie=this;return this.mapsService=X.get(Y.TYPES.IMapService),this.sceneSerive=X.get(Y.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=X,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){ie.mapsService.on("click",ie.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(X){var ie=window.document.createDocumentFragment(),ye=window.document.createElement("body"),J;for(ye.innerHTML=X;J=ye.firstChild,!!J;)ie.appendChild(J);return this.setDOMContent(ie)}},{key:"setLnglat",value:function(X){return this.lngLat=X,Array.isArray(X)&&(this.lngLat={lng:X[0],lat:X[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(X){return this.setDOMContent(window.document.createTextNode(X))}},{key:"setMaxWidth",value:function(X){return this.popupOption.maxWidth=X,this.update(),this}},{key:"setDOMContent",value:function(X){return this.createContent(),this.content.appendChild(X),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&H.DOM.remove(this.content),this.content=H.DOM.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=H.DOM.create("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(X,ie,ye){var J=window.document.createElement(X);return ie!==void 0&&(J.className=ie),ye&&ye.appendChild(J),J}},{key:"removeDom",value:function(X){X.parentNode&&X.parentNode.removeChild(X)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:H.anchorType.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(X){X.stopPropagation&&X.stopPropagation(),this.remove()}},{key:"update",value:function(){var X=this,ie=this.lngLat,ye=this.popupOption,J=ye.className,ht=ye.maxWidth,ze=ye.anchor;if(!(!this.mapsService||!ie||!this.content)){var pt=this.mapsService.getMarkerContainer();if(!this.container&&pt){this.container=this.creatDom("div","l7-popup",pt),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),J&&J.split(" ").forEach(function(Ue){return X.container.classList.add(Ue)});var Me=this.popupOption.stopPropagation;Me&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Ue){X.container.addEventListener(Ue,function(yt){yt.stopPropagation()})}),this.container.style.whiteSpace="nowrap"}ht&&this.container.style.maxWidth!==ht&&(this.container.style.maxWidth=ht),this.updatePosition(),H.DOM.setTransform(this.container,"".concat(H.anchorTranslate[ze])),(0,H.applyAnchorClass)(this.container,ze,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var X=this.lngLat,ie=X.lng,ye=X.lat,J=this.popupOption.offsets,ht=this.mapsService.lngLatToContainer([ie,ye]);this.container.style.left=ht.x+J[0]+"px",this.container.style.top=ht.y-J[1]+"px"}}}]),W}(ce.EventEmitter);function nt(Ye,M){var W=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ue=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(W||ue)&&(M||(M=document),!!M)){var X=M.head||M.getElementsByTagName("head")[0];if(!X){X=M.createElement("head");var ie=M.body||M.getElementsByTagName("body")[0];ie?ie.parentNode.insertBefore(X,ie):M.documentElement.appendChild(X)}var ye=M.createElement("style");return ye.type="text/css",ye.styleSheet?ye.styleSheet.cssText=Ye:ye.appendChild(M.createTextNode(Ye)),X.appendChild(ye),ye}}nt(`.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
}

.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 5px;
}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}

.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-left: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-bottom: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-bottom: none;
  border-left: none;
  border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-bottom: none;
  border-right: none;
  border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-left: none;
  border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  padding: 0;
  font-size: 25px;
  line-height: 20px;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
  display: none;
}

.l7-popup-track-pointer * {
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.l7-map:active .l7-popup-track-pointer {
  display: none;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);
          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);
  border-radius: 4px;
}
.l7-bar a,
.l7-bar a:hover {
  background-color: #fff;
  width: 30px;
  height: 30px;
  font-size: 20px;
  display: block;
  text-align: center;
  text-decoration: none;
  color: #8e9dab;
}
.l7-bar a,
.l7-control-layers-toggle {
  background-position: 50% 50%;
  background-repeat: no-repeat;
  display: block;
}
.l7-bar a:hover {
  background-color: #f4f4f4;
}
.l7-bar a:first-child {
  border-top-left-radius: 2px;
  border-top-right-radius: 2px;
}
.l7-bar a:last-child {
  border-bottom-left-radius: 2px;
  border-bottom-right-radius: 2px;
  border-bottom: none;
}
.l7-bar a.l7-disabled {
  cursor: default;
  background-color: #f4f4f4;
  color: #bbb;
}

/* control positioning */

.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-hide {
  display: none;
}
.l7-control {
  position: relative;
  z-index: 800;
  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control {
  float: left;
  clear: both;
}
.l7-top,
.l7-bottom {
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-top {
  top: 0;
}
.l7-right {
  right: 0;
}
.l7-bottom {
  bottom: 0;
}
.l7-left {
  left: 0;
}
.l7-center {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-bottom.l7-center,
.l7-top.l7-center {
  width: 100%;
}
.l7-right.l7-center,
.l7-left.l7-center {
  height: 100%;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}

.l7-top.l7-center,
.l7-left.l7-center {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}

.l7-bottom.l7-center,
.l7-right.l7-center {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}

.l7-center .l7-control {
  margin-right: 10px;
  margin-bottom: 10px;
}

.l7-control {
  float: left;
  clear: both;
}
.l7-right .l7-control {
  float: right;
}
.l7-top .l7-control {
  margin-top: 10px;
}
.l7-bottom .l7-control {
  margin-bottom: 10px;
}
.l7-left .l7-control {
  margin-left: 10px;
}
.l7-right .l7-control {
  margin-right: 10px;
}

/* attribution and scale controls */

.l7-control-container .l7-control-attribution {
  background: #fff;
  background: rgba(59, 58, 58, 0.7);
  margin: 0;
}
.l7-control-attribution,
.l7-control-scale-line {
  padding: 0 5px;
  color: #333;
}
.l7-control-attribution a {
  text-decoration: none;
}
.l7-control-attribution a:hover {
  text-decoration: underline;
}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
}
.l7-left .l7-control-scale {
  margin-left: 5px;
}
.l7-bottom .l7-control-scale {
  margin-bottom: 5px;
}
.l7-control-scale-line {
  border: 2px solid #000;
  border-top: none;
  color: #000;
  line-height: 1.1;
  padding: 2px 5px 1px;
  font-size: 11px;
  white-space: nowrap;
  overflow: hidden;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;

  background: #fff;
}
.l7-control-scale-line:not(:first-child) {
  border-top: 2px solid #777;
  border-bottom: none;
  margin-top: -2px;
}
.l7-control-scale-line:not(:first-child):not(:last-child) {
  border-bottom: 2px solid #777;
}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  border: 2px solid rgba(0, 0, 0, 0.2);
  background-clip: padding-box;
}
/*logo */

.l7-ctrl-logo {
  background-size: 100% 100%;
  width: 89px;
  height: 16px;
  margin: 0 0 -3px -3px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  background-repeat: no-repeat;
  cursor: pointer;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}

/* layers control */

.l7-control-layers {
  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);
  background: #fff;
  border-radius: 2px;
}
.l7-control-layers-toggle {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
  width: 30px;
  height: 30px;
  background-size: 20px 20px;
}

.l7-touch .l7-control-layers-toggle {
  width: 44px;
  height: 44px;
}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
  display: none;
}
.l7-control-layers-expanded .l7-control-layers-list {
  display: block;
  position: relative;
}
.l7-control-layers-expanded {
  padding: 6px 10px 6px 6px;
  color: #59626b;
  background: #fff;
}
.l7-control-layers-scrollbar {
  overflow-y: scroll;
  overflow-x: hidden;
  padding-right: 5px;
}
.l7-control-layers-selector {
  margin-top: 2px;
  position: relative;
  top: 1px;
}
.l7-control-layers label {
  display: block;
  padding: 8px;
}
.l7-control-layers label input[type='radio'],
.l7-control-layers label input[type='checkbox'] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
  height: 0;
  border-top: 1px solid #d8d8d8;
  margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
}
.amap-logo {
  display: none !important;
}
`)},39128:function(Ft,A,y){"use strict";y.r(A),y.d(A,{AttributeType:function(){return Kc},BasePostProcessingPass:function(){return Js},BlendType:function(){return Df},CameraUniform:function(){return qc},CoordinateSystem:function(){return wa},CoordinateUniform:function(){return vo},InteractionEvent:function(){return Na},MapServiceEvent:function(){return kf},PassType:function(){return Sl},PositionType:function(){return Ic},ScaleTypes:function(){return Hf},SceneEventList:function(){return Qc},StyleScaleType:function(){return Wf},TYPES:function(){return O},container:function(){return ku},createLayerContainer:function(){return Oc},createSceneContainer:function(){return lf},gl:function(){return ua},lazyInject:function(){return Rl},lazyMultiInject:function(){return Du},packCircleVertex:function(){return ns}});var v=y(28660),Z=y(26729),a=y.n(Z),P=y(86700),L=y(84879),O={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")};function D(C,ve){if(!(C instanceof ve))throw new TypeError("Cannot call a class as a function")}function B(C,ve){for(var $=0;$<ve.length;$++){var ee=ve[$];ee.enumerable=ee.enumerable||!1,ee.configurable=!0,"value"in ee&&(ee.writable=!0),Object.defineProperty(C,ee.key,ee)}}function V(C,ve,$){return ve&&B(C.prototype,ve),$&&B(C,$),Object.defineProperty(C,"prototype",{writable:!1}),C}function N(C,ve,$){return ve in C?Object.defineProperty(C,ve,{value:$,enumerable:!0,configurable:!0,writable:!0}):C[ve]=$,C}var Y=y(86049),H=y(31745),ce=y.n(H);function at(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function rt(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?at(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):at(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function Re(C,ve){var $=typeof Symbol!="undefined"&&C[Symbol.iterator]||C["@@iterator"];if(!$){if(Array.isArray(C)||($=vt(C))||ve&&C&&typeof C.length=="number"){$&&(C=$);var ee=0,Ee=function(){};return{s:Ee,n:function(){return ee>=C.length?{done:!0}:{done:!1,value:C[ee++]}},e:function(kr){throw kr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var We=!0,er=!1,hr;return{s:function(){$=$.call(C)},n:function(){var kr=$.next();return We=kr.done,kr},e:function(kr){er=!0,hr=kr},f:function(){try{!We&&$.return!=null&&$.return()}finally{if(er)throw hr}}}}function vt(C,ve){if(!!C){if(typeof C=="string")return wt(C,ve);var $=Object.prototype.toString.call(C).slice(8,-1);if($==="Object"&&C.constructor&&($=C.constructor.name),$==="Map"||$==="Set")return Array.from(C);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return wt(C,ve)}}function wt(C,ve){(ve==null||ve>C.length)&&(ve=C.length);for(var $=0,ee=new Array(ve);$<ve;$++)ee[$]=C[$];return ee}var fe=30;function $e(C){var ve=C.characterSet,$=C.getFontWidth,ee=C.fontHeight,Ee=C.buffer,We=C.maxCanvasWidth,er=C.mapping,hr=er===void 0?{}:er,Kt=C.xOffset,kr=Kt===void 0?0:Kt,wn=C.yOffset,Ai=wn===void 0?0:wn,Hi=0,$i=kr;Array.from(ve).forEach(function(m,u){if(!hr[m]){var _=$(m,u);$i+fe>We&&($i=0,Hi++),hr[m]={x:$i,y:Ai+Hi*fe,width:fe,height:fe,advance:_},$i+=fe}});var R=ee+Ee*2;return{mapping:hr,xOffset:$i,yOffset:Ai+Hi*R,canvasHeight:Qe(Ai+(Hi+1)*R)}}function re(C,ve,$){var ee=0,Ee=0,We=0,er=[],hr={},Kt=Re(C),kr;try{for(Kt.s();!(kr=Kt.n()).done;){var wn=kr.value;if(!hr[wn.id]){var Ai=wn.size;ee+Ai+ve>$&&(Ge(hr,er,Ee),ee=0,Ee=We+Ee+ve,We=0,er=[]),er.push({icon:wn,xOffset:ee}),ee=ee+Ai+ve,We=Math.max(We,Ai)}}}catch($i){Kt.e($i)}finally{Kt.f()}er.length>0&&Ge(hr,er,Ee);var Hi=Qe(We+Ee+ve);return{mapping:hr,canvasHeight:Hi}}function Ge(C,ve,$){var ee=Re(ve),Ee;try{for(ee.s();!(Ee=ee.n()).done;){var We=Ee.value,er=We.icon,hr=We.xOffset;C[er.id]=rt(rt({},er),{},{x:hr,y:$,image:er.image,width:er.width,height:er.height})}}catch(Kt){ee.e(Kt)}finally{ee.f()}}function Qe(C){return Math.pow(2,Math.ceil(Math.log2(C)))}var Te,Le;function Ce(C,ve){var $=typeof Symbol!="undefined"&&C[Symbol.iterator]||C["@@iterator"];if(!$){if(Array.isArray(C)||($=Fe(C))||ve&&C&&typeof C.length=="number"){$&&(C=$);var ee=0,Ee=function(){};return{s:Ee,n:function(){return ee>=C.length?{done:!0}:{done:!1,value:C[ee++]}},e:function(kr){throw kr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var We=!0,er=!1,hr;return{s:function(){$=$.call(C)},n:function(){var kr=$.next();return We=kr.done,kr},e:function(kr){er=!0,hr=kr},f:function(){try{!We&&$.return!=null&&$.return()}finally{if(er)throw hr}}}}function Fe(C,ve){if(!!C){if(typeof C=="string")return Ke(C,ve);var $=Object.prototype.toString.call(C).slice(8,-1);if($==="Object"&&C.constructor&&($=C.constructor.name),$==="Map"||$==="Set")return Array.from(C);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return Ke(C,ve)}}function Ke(C,ve){(ve==null||ve>C.length)&&(ve=C.length);for(var $=0,ee=new Array(ve);$<ve;$++)ee[$]=C[$];return ee}function qt(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function ir(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?qt(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):qt(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}var Pe=Ae(),Ne="sans-serif",Xe="normal",kt=24,rr=3,me=.25,et=8,or=1024,on=1,vr=1,jr=3,xr=null;function Ae(){for(var C=[],ve=32;ve<128;ve++)C.push(String.fromCharCode(ve));return C}function De(C,ve,$,ee){C.font="".concat(ee," ").concat($,"px ").concat(ve),C.fillStyle="black",C.textBaseline="middle"}function ke(C,ve){for(var $=0;$<C.length;$++)ve.data[4*$+3]=C[$]}var Bt=(Te=(0,P.b2)(),Te(Le=function(){function C(){D(this,C),N(this,"fontAtlas",void 0),N(this,"iconFontMap",void 0),N(this,"iconFontGlyphs",{}),N(this,"fontOptions",void 0),N(this,"key",void 0),N(this,"cache",new Y.LRUCache(jr))}return V(C,[{key:"scale",get:function(){return vr}},{key:"canvas",get:function(){var $=this.cache.get(this.key);return $&&$.data}},{key:"mapping",get:function(){var $=this.cache.get(this.key);return $&&$.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Ne,fontWeight:Xe,characterSet:Pe,fontSize:kt,buffer:rr,sdf:!0,cutoff:me,radius:et,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function($){var ee=this;$.forEach(function(Ee){ee.iconFontGlyphs[Ee.name]=Ee.unicode})}},{key:"addIconFont",value:function($,ee){this.iconFontMap.set($,ee)}},{key:"getIconFontKey",value:function($){return this.iconFontMap.get($)||$}},{key:"getGlyph",value:function($){return this.iconFontGlyphs[$]?String.fromCharCode(parseInt(this.iconFontGlyphs[$],16)):""}},{key:"setFontOptions",value:function($){this.fontOptions=ir(ir({},this.fontOptions),$),this.key=this.getKey();var ee=this.getNewChars(this.key,this.fontOptions.characterSet),Ee=this.cache.get(this.key);if(!(Ee&&ee.length===0)){var We=this.generateFontAtlas(this.key,ee,Ee);this.fontAtlas=We,this.cache.set(this.key,We)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function($,ee,Ee){var We=this.fontOptions,er=We.fontFamily,hr=We.fontWeight,Kt=We.fontSize,kr=We.buffer,wn=We.sdf,Ai=We.radius,Hi=We.cutoff,$i=We.iconfont,R=Ee&&Ee.data;R||(R=Y.$window.document.createElement("canvas"),R.width=or);var m=R.getContext("2d");De(m,er,Kt,hr);var u=$e(ir({getFontWidth:function(Qa){return m.measureText(Qa).width},fontHeight:Kt*vr,buffer:kr,characterSet:ee,maxCanvasWidth:or},Ee&&{mapping:Ee.mapping,xOffset:Ee.xOffset,yOffset:Ee.yOffset})),_=u.mapping,b=u.canvasHeight,q=u.xOffset,de=u.yOffset,ct=m.getImageData(0,0,R.width,R.height);if(R.height=b,m.putImageData(ct,0,0),De(m,er,Kt,hr),wn){var st=new(ce())(Kt,kr,Ai,Hi,er,hr),Mt=m.getImageData(0,0,st.size,st.size),Ir=Ce(ee),Gr;try{for(Ir.s();!(Gr=Ir.n()).done;){var xn=Gr.value;if($i){var gn=String.fromCharCode(parseInt(xn.replace("&#x","").replace(";",""),16)),Sn=st.draw(gn);ke(Sn,Mt)}else ke(st.draw(xn),Mt);m.putImageData(Mt,_[xn].x,_[xn].y)}}catch(Wa){Ir.e(Wa)}finally{Ir.f()}}else{var Wn=Ce(ee),bi;try{for(Wn.s();!(bi=Wn.n()).done;){var pa=bi.value;m.fillText(pa,_[pa].x,_[pa].y+Kt*on)}}catch(Wa){Wn.e(Wa)}finally{Wn.f()}}return{xOffset:q,yOffset:de,mapping:_,data:R,width:R.width,height:R.height}}},{key:"getKey",value:function(){return"key";var $,ee,Ee,We,er,hr,Kt,kr}},{key:"getNewChars",value:function($,ee){var Ee=this.cache.get($);if(!Ee)return ee;var We=[],er=Ee.mapping,hr=new Set(Object.keys(er)),Kt=new Set(ee);return Kt.forEach(function(kr){hr.has(kr)||We.push(kr)}),We}}]),C}())||Le);function mt(C){if(C===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C}function Mr(C,ve){return Mr=Object.setPrototypeOf||function(ee,Ee){return ee.__proto__=Ee,ee},Mr(C,ve)}function Cr(C,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(ve&&ve.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),Object.defineProperty(C,"prototype",{writable:!1}),ve&&Mr(C,ve)}function Nr(C){return Nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ve){return typeof ve}:function(ve){return ve&&typeof Symbol=="function"&&ve.constructor===Symbol&&ve!==Symbol.prototype?"symbol":typeof ve},Nr(C)}function nt(C,ve){if(ve&&(Nr(ve)==="object"||typeof ve=="function"))return ve;if(ve!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mt(C)}function Ye(C){return Ye=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)},Ye(C)}var M,W;function ue(C){var ve=X();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function X(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var ie=3,ye=1024,J=64,ht=(M=(0,P.b2)(),M(W=function(C){Cr($,C);var ve=ue($);function $(){var ee;D(this,$);for(var Ee=arguments.length,We=new Array(Ee),er=0;er<Ee;er++)We[er]=arguments[er];return ee=ve.call.apply(ve,[this].concat(We)),N(mt(ee),"canvasHeight",128),N(mt(ee),"texture",void 0),N(mt(ee),"canvas",void 0),N(mt(ee),"iconData",void 0),N(mt(ee),"iconMap",void 0),N(mt(ee),"ctx",void 0),N(mt(ee),"loadingImageCount",0),ee}return V($,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=Y.$window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Ee,We){var er=this,hr=new Image;if(this.loadingImageCount++,this.hasImage(Ee))throw new Error("Image Id already exists");this.iconData.push({id:Ee,size:J}),this.updateIconMap(),this.loadImage(We).then(function(Kt){hr=Kt;var kr=er.iconData.find(function(wn){return wn.id===Ee});kr&&(kr.image=hr,kr.width=hr.width,kr.height=hr.height),er.update()})}},{key:"addImageMini",value:function(Ee,We,er){var hr=this,Kt=er.getSceneConfig().canvas,kr=Kt.createImage();if(this.loadingImageCount++,this.hasImage(Ee))throw new Error("Image Id already exists");this.iconData.push({id:Ee,size:J}),this.updateIconMap(),this.loadImageMini(We,Kt).then(function(wn){kr=wn;var Ai=hr.iconData.find(function(Hi){return Hi.id===Ee});Ai&&(Ai.image=kr,Ai.width=kr.width,Ai.height=kr.height),hr.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Ee){return this.iconMap.hasOwnProperty(Ee)}},{key:"removeImage",value:function(Ee){this.hasImage(Ee)&&(this.iconData=this.iconData.filter(function(We){return We.id!==Ee}),delete this.iconMap[Ee],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(Ee){return new Promise(function(We,er){if(Ee instanceof HTMLImageElement){We(Ee);return}var hr=new Image;hr.crossOrigin="anonymous",hr.onload=function(){We(hr)},hr.onerror=function(){er(new Error("Could not load image at "+Ee))},hr.src=Ee instanceof File?URL.createObjectURL(Ee):Ee})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Ee=this;this.canvas.width=ye,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(We){var er=Ee.iconMap[We],hr=er.x,Kt=er.y,kr=er.image,wn=er.width,Ai=wn===void 0?64:wn,Hi=er.height,$i=Hi===void 0?64:Hi,R=Math.max(Ai,$i),m=R/J,u=$i/m,_=Ai/m;kr&&Ee.ctx.drawImage(kr,hr+(J-_)/2,Kt+(J-u)/2,_,u)})}},{key:"updateIconMap",value:function(){var Ee=re(this.iconData,ie,ye),We=Ee.mapping,er=Ee.canvasHeight;this.iconMap=We,this.canvasHeight=er}},{key:"loadImageMini",value:function(Ee,We){return new Promise(function(er,hr){var Kt=We.createImage();Kt.crossOrigin="anonymous",Kt.onload=function(){er(Kt)},Kt.onerror=function(){hr(new Error("Could not load image at "+Ee))},Kt.src=Ee})}}]),$}(Z.EventEmitter))||W);function ze(C){if(Array.isArray(C))return C}function pt(C,ve){var $=C==null?null:typeof Symbol!="undefined"&&C[Symbol.iterator]||C["@@iterator"];if($!=null){var ee=[],Ee=!0,We=!1,er,hr;try{for($=$.call(C);!(Ee=(er=$.next()).done)&&(ee.push(er.value),!(ve&&ee.length===ve));Ee=!0);}catch(Kt){We=!0,hr=Kt}finally{try{!Ee&&$.return!=null&&$.return()}finally{if(We)throw hr}}return ee}}function Me(C,ve){(ve==null||ve>C.length)&&(ve=C.length);for(var $=0,ee=new Array(ve);$<ve;$++)ee[$]=C[$];return ee}function Ue(C,ve){if(!!C){if(typeof C=="string")return Me(C,ve);var $=Object.prototype.toString.call(C).slice(8,-1);if($==="Object"&&C.constructor&&($=C.constructor.name),$==="Map"||$==="Set")return Array.from(C);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return Me(C,ve)}}function yt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gt(C,ve){return ze(C)||pt(C,ve)||Ue(C,ve)||yt()}var nr=y(85975),pe,lr,Ur=(pe=(0,P.b2)(),pe(lr=function(){function C(){D(this,C),N(this,"viewport",void 0),N(this,"overridedViewProjectionMatrix",void 0),N(this,"jitteredViewProjectionMatrix",void 0),N(this,"jitteredProjectionMatrix",void 0),N(this,"viewMatrixInverse",void 0),N(this,"cameraPosition",void 0)}return V(C,[{key:"init",value:function(){}},{key:"update",value:function($){this.viewport=$,this.viewMatrixInverse=nr.create(),nr.invert(this.viewMatrixInverse,$.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var $=this.viewport.getCenter(),ee=gt($,2),Ee=ee[0],We=ee[1];return[Ee,We]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function($,ee){return this.viewport.projectFlat($,ee)}},{key:"setViewProjectionMatrix",value:function($){this.overridedViewProjectionMatrix=$}},{key:"jitterProjectionMatrix",value:function($,ee){var Ee=nr.fromTranslation(nr.create(),[$,ee,0]);this.jitteredProjectionMatrix=nr.multiply(nr.create(),Ee,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=nr.multiply(nr.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),C}())||lr),Hr,un;function bn(C,ve){var $=typeof Symbol!="undefined"&&C[Symbol.iterator]||C["@@iterator"];if(!$){if(Array.isArray(C)||($=Gn(C))||ve&&C&&typeof C.length=="number"){$&&(C=$);var ee=0,Ee=function(){};return{s:Ee,n:function(){return ee>=C.length?{done:!0}:{done:!1,value:C[ee++]}},e:function(kr){throw kr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var We=!0,er=!1,hr;return{s:function(){$=$.call(C)},n:function(){var kr=$.next();return We=kr.done,kr},e:function(kr){er=!0,hr=kr},f:function(){try{!We&&$.return!=null&&$.return()}finally{if(er)throw hr}}}}function Gn(C,ve){if(!!C){if(typeof C=="string")return li(C,ve);var $=Object.prototype.toString.call(C).slice(8,-1);if($==="Object"&&C.constructor&&($=C.constructor.name),$==="Map"||$==="Set")return Array.from(C);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return li(C,ve)}}function li(C,ve){(ve==null||ve>C.length)&&(ve=C.length);for(var $=0,ee=new Array(ve);$<ve;$++)ee[$]=C[$];return ee}var $r=(Hr=(0,P.b2)(),Hr(un=function(){function C(){D(this,C),N(this,"container",void 0),N(this,"controlCorners",void 0),N(this,"controlContainer",void 0),N(this,"scene",void 0),N(this,"mapsService",void 0),N(this,"controls",[]),N(this,"unAddControls",[])}return V(C,[{key:"init",value:function($,ee){this.container=$.container,this.scene=ee,this.mapsService=ee.get(O.IMapService),this.initControlPos()}},{key:"addControl",value:function($,ee){var Ee=ee.get(O.IMapService);Ee.map?($.addTo(this.scene),this.controls.push($)):this.unAddControls.push($)}},{key:"getControlByName",value:function($){return this.controls.find(function(ee){return ee.controlOption.name===$})}},{key:"removeControl",value:function($){var ee=this.controls.indexOf($);return ee>-1&&this.controls.splice(ee,1),$.remove(),this}},{key:"addControls",value:function(){var $=this;this.unAddControls.forEach(function(ee){ee.addTo($.scene),$.controls.push(ee)}),this.unAddControls=[]}},{key:"destroy",value:function(){var $=bn(this.controls),ee;try{for($.s();!(ee=$.n()).done;){var Ee=ee.value;Ee.remove()}}catch(We){$.e(We)}finally{$.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var $=this.controlCorners={},ee="l7-",Ee=this.controlContainer=Y.DOM.create("div",ee+"control-container",this.container);function We(){var er=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],hr=er.map(function(Kt){return ee+Kt}).join(" ");$[er.join("")]=Y.DOM.create("div",hr,Ee)}We(["top","left"]),We(["top","right"]),We(["bottom","left"]),We(["bottom","right"]),We(["top","center"]),We(["right","center"]),We(["left","center"]),We(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var $ in this.controlCorners)this.controlCorners[$]&&Y.DOM.remove(this.controlCorners[$]);this.controlContainer&&Y.DOM.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),C}())||un),Zt,it,ne=(Zt=(0,P.b2)(),Zt(it=function(){function C(){D(this,C),N(this,"container",void 0),N(this,"scene",void 0),N(this,"mapsService",void 0),N(this,"markers",[]),N(this,"markerLayers",[]),N(this,"unAddMarkers",[]),N(this,"unAddMarkerLayers",[])}return V(C,[{key:"addMarkerLayer",value:function($){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push($),$.addTo(this.scene)):this.unAddMarkerLayers.push($)}},{key:"removeMarkerLayer",value:function($){$.destroy(),this.markerLayers.indexOf($);var ee=this.markerLayers.indexOf($);ee>-1&&this.markerLayers.splice(ee,1)}},{key:"addMarker",value:function($){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push($),$.addTo(this.scene)):this.unAddMarkers.push($)}},{key:"addMarkers",value:function(){var $=this;this.unAddMarkers.forEach(function(ee){ee.addTo($.scene),$.markers.push(ee)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var $=this;this.unAddMarkerLayers.forEach(function(ee){$.markerLayers.push(ee),ee.addTo($.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function($){$.remove(),this.markers.indexOf($);var ee=this.markers.indexOf($);ee>-1&&this.markers.splice(ee,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function($){this.scene=$,this.mapsService=$.get(O.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function($){$.remove()}),this.markers=[],this.markerLayers.forEach(function($){$.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function($){$.destroy()}}]),C}())||it),_e,Oe,je=(_e=(0,P.b2)(),_e(Oe=function(){function C(){D(this,C),N(this,"scene",void 0),N(this,"popup",void 0),N(this,"mapsService",void 0),N(this,"unAddPopup",void 0)}return V(C,[{key:"removePopup",value:function($){$.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function($){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?($.addTo(this.scene),this.popup=$):this.unAddPopup=$}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function($){this.scene=$,this.mapsService=$.get(O.IMapService)}}]),C}())||Oe),dt=y(82492),Ut=y.n(dt),ur={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},lt=ur,Nt,Sr;function fn(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Br(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?fn(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):fn(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}var Jr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Tn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},hi=(Nt=(0,P.b2)(),Nt(Sr=function(){function C(){D(this,C),N(this,"sceneConfigCache",{}),N(this,"layerConfigCache",{})}return V(C,[{key:"getSceneConfig",value:function($){return this.sceneConfigCache[$]}},{key:"getSceneWarninfo",value:function($){return lt[$]}},{key:"setSceneConfig",value:function($,ee){this.sceneConfigCache[$]=Br(Br({},Jr),ee)}},{key:"getLayerConfig",value:function($){return this.layerConfigCache[$]}},{key:"setLayerConfig",value:function($,ee,Ee){this.layerConfigCache[ee]=Br({},Ut()({},this.sceneConfigCache[$],Tn,Ee))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),C}())||Sr);function On(C,ve,$,ee){!$||Object.defineProperty(C,ve,{enumerable:$.enumerable,configurable:$.configurable,writable:$.writable,value:$.initializer?$.initializer.call(ee):void 0})}function Pr(C,ve,$,ee,Ee){var We={};return Object.keys(ee).forEach(function(er){We[er]=ee[er]}),We.enumerable=!!We.enumerable,We.configurable=!!We.configurable,("value"in We||We.initializer)&&(We.writable=!0),We=$.slice().reverse().reduce(function(er,hr){return hr(C,ve,er)||er},We),Ee&&We.initializer!==void 0&&(We.value=We.initializer?We.initializer.call(Ee):void 0,We.initializer=void 0),We.initializer===void 0&&(Object.defineProperty(C,ve,We),We=null),We}var vi=y(98333),Jn=Math.PI/180,ui=512,Da=4003e4;function Yn(C){var ve=C.latitude,$=ve===void 0?0:ve,ee=C.zoom,Ee=ee===void 0?0:ee,We=C.scale,er=C.highPrecision,hr=er===void 0?!1:er,Kt=C.flipY,kr=Kt===void 0?!1:Kt;We=We!==void 0?We:Math.pow(2,Ee);var wn={},Ai=ui*We,Hi=Math.cos($*Jn),$i=Ai/360,R=$i/Hi,m=Ai/Da/Hi;if(wn.pixelsPerMeter=[m,-m,m],wn.metersPerPixel=[1/m,-1/m,1/m],wn.pixelsPerDegree=[$i,-R,m],wn.degreesPerPixel=[1/$i,-1/R,1/m],hr){var u=Jn*Math.tan($*Jn)/Hi,_=$i*u/2,b=Ai/Da*u,q=b/R*m;wn.pixelsPerDegree2=[0,-_,b],wn.pixelsPerMeter2=[q,0,q],kr&&(wn.pixelsPerDegree2[1]=-wn.pixelsPerDegree2[1],wn.pixelsPerMeter2[1]=-wn.pixelsPerMeter2[1])}return kr&&(wn.pixelsPerMeter[1]=-wn.pixelsPerMeter[1],wn.metersPerPixel[1]=-wn.metersPerPixel[1],wn.pixelsPerDegree[1]=-wn.pixelsPerDegree[1],wn.degreesPerPixel[1]=-wn.degreesPerPixel[1]),wn}var wa;(function(C){C[C.LNGLAT=1]="LNGLAT",C[C.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",C[C.VECTOR_TILE=3]="VECTOR_TILE",C[C.IDENTITY=4]="IDENTITY",C[C.P20=5]="P20",C[C.P20_OFFSET=6]="P20_OFFSET",C[C.METER_OFFSET=7]="METER_OFFSET",C[C.P20_2=8]="P20_2"})(wa||(wa={}));var vo={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},Ua,Ka,Ga,ei,eo,ra=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Rn=(Ua=(0,P.b2)(),Ka=(0,P.f3)(O.ICameraService),Ua(Ga=(ei=function(){function C(){D(this,C),N(this,"needRefresh",!0),On(this,"cameraService",eo,this),N(this,"coordinateSystem",void 0),N(this,"viewportCenter",void 0),N(this,"viewportCenterProjection",void 0),N(this,"pixelsPerDegree",void 0),N(this,"pixelsPerDegree2",void 0),N(this,"pixelsPerMeter",void 0)}return V(C,[{key:"refresh",value:function(){var $=this.cameraService.getZoom(),ee=this.cameraService.getZoomScale(),Ee=this.cameraService.getCenter(),We=Yn({latitude:Ee[1],zoom:$}),er=We.pixelsPerMeter,hr=We.pixelsPerDegree;this.viewportCenter=Ee,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=er,this.pixelsPerDegree=hr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===wa.LNGLAT||this.coordinateSystem===wa.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===wa.LNGLAT_OFFSET?this.calculateLnglatOffset(Ee,$):this.coordinateSystem===wa.P20_OFFSET&&this.calculateLnglatOffset(Ee,$,ee,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function($){this.coordinateSystem=$}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function($,ee,Ee,We){var er=Yn({latitude:$[1],zoom:ee,scale:Ee,flipY:We,highPrecision:!0}),hr=er.pixelsPerMeter,Kt=er.pixelsPerDegree,kr=er.pixelsPerDegree2,wn=this.cameraService.getViewMatrix(),Ai=this.cameraService.getProjectionMatrix(),Hi=nr.multiply([],Ai,wn),$i=this.cameraService.projectFlat([Math.fround($[0]),Math.fround($[1])],Math.pow(2,ee));this.viewportCenterProjection=vi.fF([],[$i[0],$i[1],0,1],Hi),wn=this.cameraService.getViewMatrixUncentered()||wn,Hi=nr.multiply([],Ai,wn),Hi=nr.multiply([],Hi,ra),this.cameraService.setViewProjectionMatrix(Hi),this.pixelsPerMeter=hr,this.pixelsPerDegree=Kt,this.pixelsPerDegree2=kr}}]),C}(),eo=Pr(ei.prototype,"cameraService",[Ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ei))||Ga),qa=y(20396),ba=y.n(qa),Na;(function(C){C.Hover="hover",C.Click="click",C.Select="select",C.Active="active",C.Drag="drag"})(Na||(Na={}));var wo,ya,Gt,gs,Qi;function So(C){var ve=ll();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function ll(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var Ss={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},rs=(wo=(0,P.b2)(),ya=(0,P.f3)(O.IMapService),wo(Gt=(gs=function(C){Cr($,C);var ve=So($);function $(){var ee;D(this,$);for(var Ee=arguments.length,We=new Array(Ee),er=0;er<Ee;er++)We[er]=arguments[er];return ee=ve.call.apply(ve,[this].concat(We)),N(mt(ee),"indragging",!1),On(mt(ee),"mapService",Qi,mt(ee)),N(mt(ee),"hammertime",void 0),N(mt(ee),"lastClickTime",0),N(mt(ee),"lastClickXY",[-1,-1]),N(mt(ee),"clickTimer",void 0),N(mt(ee),"$containter",void 0),N(mt(ee),"onDrag",function(hr){var Kt=ee.interactionEvent(hr);Kt.type=Ss[Kt.type],Kt.type==="dragging"?ee.indragging=!0:ee.indragging=!1,ee.emit(Na.Drag,Kt)}),N(mt(ee),"onHammer",function(hr){hr.srcEvent.stopPropagation();var Kt=ee.interactionEvent(hr);ee.emit(Na.Hover,Kt)}),N(mt(ee),"onTouch",function(hr){var Kt=hr.touches[0];ee.onHover({x:Kt.pageX,y:Kt.pageY,type:"touch"})}),N(mt(ee),"onHover",function(hr){var Kt=hr.clientX,kr=hr.clientY,wn=Kt,Ai=kr,Hi=hr.type,$i=ee.mapService.getMapContainer();if($i)if(Y.isMini)wn=wn-$i.left-0,Ai=Ai-$i.top-0;else{var R=$i.getBoundingClientRect(),m=R.top,u=R.left;wn=wn-u-$i.clientLeft,Ai=Ai-m-$i.clientTop}var _=ee.mapService.containerToLngLat([wn,Ai]);if(Hi==="click"){if(!Y.isMini&&"ontouchstart"in document.documentElement)return;ee.isDoubleTap(wn,Ai,_);return}if(Hi==="touch"){ee.isDoubleTap(wn,Ai,_);return}Hi!=="click"&&Hi!=="dblclick"&&ee.emit(Na.Hover,{x:wn,y:Ai,lngLat:_,type:Hi,target:hr})}),ee}return V($,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Na.Hover)}},{key:"triggerHover",value:function(Ee){var We=Ee.x,er=Ee.y;this.emit(Na.Hover,{x:We,y:er})}},{key:"triggerSelect",value:function(Ee){this.emit(Na.Select,{featureId:Ee})}},{key:"triggerActive",value:function(Ee){this.emit(Na.Active,{featureId:Ee})}},{key:"handleMiniEvent",value:function(Ee){this.onHover({clientX:Ee.touches[0].pageX,clientY:Ee.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var Ee=this.mapService.getMapContainer();if(Ee)if(Y.isMini)Y.$window.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var We=new(ba()).Manager(Ee);We.add(new(ba()).Tap({event:"dblclick",taps:2})),We.add(new(ba()).Tap({event:"click"})),We.add(new(ba()).Pan({threshold:0,pointers:0})),We.add(new(ba()).Press({})),We.on("dblclick click",this.onHammer),We.on("panstart panmove panend pancancel",this.onDrag),Ee.addEventListener("mousemove",this.onHover),Ee.addEventListener("mousedown",this.onHover,!0),Ee.addEventListener("mouseup",this.onHover),Ee.addEventListener("contextmenu",this.onHover),this.hammertime=We}}},{key:"removeEventListenerOnMap",value:function(){if(Y.isMini)Y.$window.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var Ee=this.mapService.getMapContainer();Ee&&(Ee.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Ee.removeEventListener("mousedown",this.onHover),Ee.removeEventListener("mouseup",this.onHover),Ee.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(Ee){var We=Ee.type,er=Ee.pointerType,hr,Kt;er==="touch"?(Kt=Math.floor(Ee.pointers[0].clientY),hr=Math.floor(Ee.pointers[0].clientX)):(Kt=Math.floor(Ee.srcEvent.y),hr=Math.floor(Ee.srcEvent.x));var kr=this.mapService.getMapContainer();if(kr){var wn=kr.getBoundingClientRect(),Ai=wn.top,Hi=wn.left;hr-=Hi,Kt-=Ai}var $i=this.mapService.containerToLngLat([hr,Kt]);return{x:hr,y:Kt,lngLat:$i,type:We,target:Ee.srcEvent}}},{key:"isDoubleTap",value:function(Ee,We,er){var hr=this,Kt=new Date().getTime(),kr="click";Kt-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Ee)<10&&Math.abs(this.lastClickXY[1]-We)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),kr="dblclick",this.emit(Na.Hover,{x:Ee,y:We,lngLat:er,type:kr})):(this.lastClickTime=Kt,this.lastClickXY=[Ee,We],this.clickTimer=setTimeout(function(){kr="click",hr.emit(Na.Hover,{x:Ee,y:We,lngLat:er,type:kr})},400))}}]),$}(a()),Qi=Pr(gs.prototype,"mapService",[ya],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gs))||Gt);function ls(C,ve,$,ee,Ee,We,er){try{var hr=C[We](er),Kt=hr.value}catch(kr){$(kr);return}hr.done?ve(Kt):Promise.resolve(Kt).then(ee,Ee)}function Ia(C){return function(){var ve=this,$=arguments;return new Promise(function(ee,Ee){var We=C.apply(ve,$);function er(Kt){ls(We,ee,Ee,er,hr,"next",Kt)}function hr(Kt){ls(We,ee,Ee,er,hr,"throw",Kt)}er(void 0)})}}var Ms=y(74360),uo=y.n(Ms),Qs=0;function Ao(C){if(Y.isMini)return null;var ve=C;if(typeof C=="string"&&(ve=document.getElementById(C)),ve){var $=document.createElement("div");return $.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,$.id="l7-scene-".concat(Qs++),$.classList.add("l7-scene"),ve.appendChild($),$}return null}function Ts(C){var ve,$,ee=!0;return C==null||(ve=C.target)===null||ve===void 0||($=ve.path)===null||$===void 0||$.map(function(Ee){if(Ee!=null&&Ee.classList){var We;Ee==null||(We=Ee.classList)===null||We===void 0||We.forEach(function(er){(er==="l7-marker"||er==="l7-popup")&&(ee=!1)})}}),ee}var ua;(function(C){C[C.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",C[C.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",C[C.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",C[C.POINTS=0]="POINTS",C[C.LINES=1]="LINES",C[C.LINE_LOOP=2]="LINE_LOOP",C[C.LINE_STRIP=3]="LINE_STRIP",C[C.TRIANGLES=4]="TRIANGLES",C[C.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",C[C.TRIANGLE_FAN=6]="TRIANGLE_FAN",C[C.ZERO=0]="ZERO",C[C.ONE=1]="ONE",C[C.SRC_COLOR=768]="SRC_COLOR",C[C.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",C[C.SRC_ALPHA=770]="SRC_ALPHA",C[C.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",C[C.DST_ALPHA=772]="DST_ALPHA",C[C.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",C[C.DST_COLOR=774]="DST_COLOR",C[C.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",C[C.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",C[C.FUNC_ADD=32774]="FUNC_ADD",C[C.BLEND_EQUATION=32777]="BLEND_EQUATION",C[C.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",C[C.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",C[C.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",C[C.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",C[C.MAX_EXT=32776]="MAX_EXT",C[C.MIN_EXT=32775]="MIN_EXT",C[C.BLEND_DST_RGB=32968]="BLEND_DST_RGB",C[C.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",C[C.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",C[C.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",C[C.CONSTANT_COLOR=32769]="CONSTANT_COLOR",C[C.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",C[C.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",C[C.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",C[C.BLEND_COLOR=32773]="BLEND_COLOR",C[C.ARRAY_BUFFER=34962]="ARRAY_BUFFER",C[C.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",C[C.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",C[C.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",C[C.STREAM_DRAW=35040]="STREAM_DRAW",C[C.STATIC_DRAW=35044]="STATIC_DRAW",C[C.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",C[C.BUFFER_SIZE=34660]="BUFFER_SIZE",C[C.BUFFER_USAGE=34661]="BUFFER_USAGE",C[C.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",C[C.FRONT=1028]="FRONT",C[C.BACK=1029]="BACK",C[C.FRONT_AND_BACK=1032]="FRONT_AND_BACK",C[C.CULL_FACE=2884]="CULL_FACE",C[C.BLEND=3042]="BLEND",C[C.DITHER=3024]="DITHER",C[C.STENCIL_TEST=2960]="STENCIL_TEST",C[C.DEPTH_TEST=2929]="DEPTH_TEST",C[C.SCISSOR_TEST=3089]="SCISSOR_TEST",C[C.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",C[C.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",C[C.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",C[C.NO_ERROR=0]="NO_ERROR",C[C.INVALID_ENUM=1280]="INVALID_ENUM",C[C.INVALID_VALUE=1281]="INVALID_VALUE",C[C.INVALID_OPERATION=1282]="INVALID_OPERATION",C[C.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",C[C.CW=2304]="CW",C[C.CCW=2305]="CCW",C[C.LINE_WIDTH=2849]="LINE_WIDTH",C[C.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",C[C.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",C[C.CULL_FACE_MODE=2885]="CULL_FACE_MODE",C[C.FRONT_FACE=2886]="FRONT_FACE",C[C.DEPTH_RANGE=2928]="DEPTH_RANGE",C[C.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",C[C.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",C[C.DEPTH_FUNC=2932]="DEPTH_FUNC",C[C.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",C[C.STENCIL_FUNC=2962]="STENCIL_FUNC",C[C.STENCIL_FAIL=2964]="STENCIL_FAIL",C[C.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",C[C.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",C[C.STENCIL_REF=2967]="STENCIL_REF",C[C.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",C[C.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",C[C.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",C[C.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",C[C.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",C[C.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",C[C.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",C[C.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",C[C.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",C[C.VIEWPORT=2978]="VIEWPORT",C[C.SCISSOR_BOX=3088]="SCISSOR_BOX",C[C.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",C[C.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",C[C.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",C[C.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",C[C.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",C[C.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",C[C.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",C[C.RED_BITS=3410]="RED_BITS",C[C.GREEN_BITS=3411]="GREEN_BITS",C[C.BLUE_BITS=3412]="BLUE_BITS",C[C.ALPHA_BITS=3413]="ALPHA_BITS",C[C.DEPTH_BITS=3414]="DEPTH_BITS",C[C.STENCIL_BITS=3415]="STENCIL_BITS",C[C.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",C[C.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",C[C.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",C[C.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",C[C.SAMPLES=32937]="SAMPLES",C[C.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",C[C.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",C[C.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",C[C.DONT_CARE=4352]="DONT_CARE",C[C.FASTEST=4353]="FASTEST",C[C.NICEST=4354]="NICEST",C[C.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",C[C.BYTE=5120]="BYTE",C[C.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",C[C.SHORT=5122]="SHORT",C[C.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",C[C.INT=5124]="INT",C[C.UNSIGNED_INT=5125]="UNSIGNED_INT",C[C.FLOAT=5126]="FLOAT",C[C.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",C[C.ALPHA=6406]="ALPHA",C[C.RGB=6407]="RGB",C[C.RGBA=6408]="RGBA",C[C.LUMINANCE=6409]="LUMINANCE",C[C.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",C[C.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",C[C.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",C[C.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",C[C.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",C[C.VERTEX_SHADER=35633]="VERTEX_SHADER",C[C.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",C[C.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",C[C.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",C[C.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",C[C.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",C[C.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",C[C.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",C[C.SHADER_TYPE=35663]="SHADER_TYPE",C[C.DELETE_STATUS=35712]="DELETE_STATUS",C[C.LINK_STATUS=35714]="LINK_STATUS",C[C.VALIDATE_STATUS=35715]="VALIDATE_STATUS",C[C.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",C[C.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",C[C.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",C[C.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",C[C.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",C[C.NEVER=512]="NEVER",C[C.LESS=513]="LESS",C[C.EQUAL=514]="EQUAL",C[C.LEQUAL=515]="LEQUAL",C[C.GREATER=516]="GREATER",C[C.NOTEQUAL=517]="NOTEQUAL",C[C.GEQUAL=518]="GEQUAL",C[C.ALWAYS=519]="ALWAYS",C[C.KEEP=7680]="KEEP",C[C.REPLACE=7681]="REPLACE",C[C.INCR=7682]="INCR",C[C.DECR=7683]="DECR",C[C.INVERT=5386]="INVERT",C[C.INCR_WRAP=34055]="INCR_WRAP",C[C.DECR_WRAP=34056]="DECR_WRAP",C[C.VENDOR=7936]="VENDOR",C[C.RENDERER=7937]="RENDERER",C[C.VERSION=7938]="VERSION",C[C.NEAREST=9728]="NEAREST",C[C.LINEAR=9729]="LINEAR",C[C.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",C[C.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",C[C.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",C[C.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",C[C.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",C[C.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",C[C.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",C[C.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",C[C.TEXTURE_2D=3553]="TEXTURE_2D",C[C.TEXTURE=5890]="TEXTURE",C[C.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",C[C.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",C[C.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",C[C.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",C[C.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",C[C.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",C[C.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",C[C.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",C[C.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",C[C.TEXTURE0=33984]="TEXTURE0",C[C.TEXTURE1=33985]="TEXTURE1",C[C.TEXTURE2=33986]="TEXTURE2",C[C.TEXTURE3=33987]="TEXTURE3",C[C.TEXTURE4=33988]="TEXTURE4",C[C.TEXTURE5=33989]="TEXTURE5",C[C.TEXTURE6=33990]="TEXTURE6",C[C.TEXTURE7=33991]="TEXTURE7",C[C.TEXTURE8=33992]="TEXTURE8",C[C.TEXTURE9=33993]="TEXTURE9",C[C.TEXTURE10=33994]="TEXTURE10",C[C.TEXTURE11=33995]="TEXTURE11",C[C.TEXTURE12=33996]="TEXTURE12",C[C.TEXTURE13=33997]="TEXTURE13",C[C.TEXTURE14=33998]="TEXTURE14",C[C.TEXTURE15=33999]="TEXTURE15",C[C.TEXTURE16=34e3]="TEXTURE16",C[C.TEXTURE17=34001]="TEXTURE17",C[C.TEXTURE18=34002]="TEXTURE18",C[C.TEXTURE19=34003]="TEXTURE19",C[C.TEXTURE20=34004]="TEXTURE20",C[C.TEXTURE21=34005]="TEXTURE21",C[C.TEXTURE22=34006]="TEXTURE22",C[C.TEXTURE23=34007]="TEXTURE23",C[C.TEXTURE24=34008]="TEXTURE24",C[C.TEXTURE25=34009]="TEXTURE25",C[C.TEXTURE26=34010]="TEXTURE26",C[C.TEXTURE27=34011]="TEXTURE27",C[C.TEXTURE28=34012]="TEXTURE28",C[C.TEXTURE29=34013]="TEXTURE29",C[C.TEXTURE30=34014]="TEXTURE30",C[C.TEXTURE31=34015]="TEXTURE31",C[C.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",C[C.REPEAT=10497]="REPEAT",C[C.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",C[C.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",C[C.FLOAT_VEC2=35664]="FLOAT_VEC2",C[C.FLOAT_VEC3=35665]="FLOAT_VEC3",C[C.FLOAT_VEC4=35666]="FLOAT_VEC4",C[C.INT_VEC2=35667]="INT_VEC2",C[C.INT_VEC3=35668]="INT_VEC3",C[C.INT_VEC4=35669]="INT_VEC4",C[C.BOOL=35670]="BOOL",C[C.BOOL_VEC2=35671]="BOOL_VEC2",C[C.BOOL_VEC3=35672]="BOOL_VEC3",C[C.BOOL_VEC4=35673]="BOOL_VEC4",C[C.FLOAT_MAT2=35674]="FLOAT_MAT2",C[C.FLOAT_MAT3=35675]="FLOAT_MAT3",C[C.FLOAT_MAT4=35676]="FLOAT_MAT4",C[C.SAMPLER_2D=35678]="SAMPLER_2D",C[C.SAMPLER_CUBE=35680]="SAMPLER_CUBE",C[C.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",C[C.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",C[C.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",C[C.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",C[C.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",C[C.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",C[C.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",C[C.COMPILE_STATUS=35713]="COMPILE_STATUS",C[C.LOW_FLOAT=36336]="LOW_FLOAT",C[C.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",C[C.HIGH_FLOAT=36338]="HIGH_FLOAT",C[C.LOW_INT=36339]="LOW_INT",C[C.MEDIUM_INT=36340]="MEDIUM_INT",C[C.HIGH_INT=36341]="HIGH_INT",C[C.FRAMEBUFFER=36160]="FRAMEBUFFER",C[C.RENDERBUFFER=36161]="RENDERBUFFER",C[C.RGBA4=32854]="RGBA4",C[C.RGB5_A1=32855]="RGB5_A1",C[C.RGB565=36194]="RGB565",C[C.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",C[C.STENCIL_INDEX=6401]="STENCIL_INDEX",C[C.STENCIL_INDEX8=36168]="STENCIL_INDEX8",C[C.DEPTH_STENCIL=34041]="DEPTH_STENCIL",C[C.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",C[C.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",C[C.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",C[C.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",C[C.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",C[C.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",C[C.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",C[C.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",C[C.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",C[C.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",C[C.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",C[C.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",C[C.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",C[C.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",C[C.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",C[C.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",C[C.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",C[C.NONE=0]="NONE",C[C.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",C[C.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",C[C.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",C[C.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",C[C.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",C[C.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",C[C.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",C[C.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",C[C.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",C[C.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",C[C.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",C[C.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",C[C.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",C[C.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(ua||(ua={}));var cs,Ds,Ro,Eu,ec,Gs,ft,St,_r,Or,$n,Gi,to;function Je(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function It(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?Je(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):Je(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}var Ot=(cs=(0,P.b2)(),Ds=(0,P.f3)(O.IMapService),Ro=(0,P.f3)(O.IRendererService),Eu=(0,P.f3)(O.IGlobalConfigService),ec=(0,P.f3)(O.IInteractionService),Gs=(0,P.f3)(O.ILayerService),cs(ft=(St=function(){function C(){var ve=this;D(this,C),On(this,"mapService",_r,this),On(this,"rendererService",Or,this),On(this,"configService",$n,this),On(this,"interactionService",Gi,this),On(this,"layerService",to,this),N(this,"pickingFBO",void 0),N(this,"width",0),N(this,"height",0),N(this,"alreadyInPicking",!1),N(this,"pickBufferScale",1),N(this,"lastPickTime",new Date().getTime()),N(this,"pickFromPickingFBO",function($,ee){var Ee,We=ee.x,er=ee.y,hr=ee.lngLat,Kt=ee.type,kr=ee.target,wn=!1,Ai=ve.rendererService,Hi=Ai.getViewportSize,$i=Ai.readPixels,R=Ai.getContainer,m=ve.getContainerSize(R()),u=m.width,_=m.height;u*=Y.DOM.DPR,_*=Y.DOM.DPR;var b=$.getLayerConfig(),q=b.enableHighlight,de=b.enableSelect,ct=We*Y.DOM.DPR,st=er*Y.DOM.DPR;if(ct>u-1*Y.DOM.DPR||ct<0||st>_-1*Y.DOM.DPR||st<0)return!1;var Mt;if(Mt=$i({x:Math.floor(ct/ve.pickBufferScale),y:Math.floor((_-(er+1)*Y.DOM.DPR)/ve.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:ve.pickingFBO}),Mt[0]!==0||Mt[1]!==0||Mt[2]!==0){var Ir=(0,Y.decodePickingColor)(Mt),Gr=$.getSource().getFeatureById(Ir);Ir!==$.getCurrentPickId()&&Kt==="mousemove"&&(Kt="mouseenter");var xn={x:We,y:er,type:Kt,lngLat:hr,featureId:Ir,feature:Gr,target:kr};Gr&&(wn=!0,$.setCurrentPickId(Ir),ve.triggerHoverOnLayer($,xn))}else{var gn={x:We,y:er,lngLat:hr,type:$.getCurrentPickId()!==null&&Kt==="mousemove"?"mouseout":"un"+Kt,featureId:null,target:kr,feature:null};ve.triggerHoverOnLayer($,It(It({},gn),{},{type:"unpick"})),ve.triggerHoverOnLayer($,gn),$.setCurrentPickId(null)}if(q&&ve.highlightPickedFeature($,Mt),de&&Kt==="click"&&((Ee=Mt)===null||Ee===void 0?void 0:Ee.toString())!==[0,0,0,0].toString()){var Sn=(0,Y.decodePickingColor)(Mt);$.getCurrentSelectedId()===null||Sn!==$.getCurrentSelectedId()?(ve.selectFeature($,Mt),$.setCurrentSelectedId(Sn)):(ve.selectFeature($,new Uint8Array([0,0,0,0])),$.setCurrentSelectedId(null))}return wn})}return V(C,[{key:"init",value:function($){var ee=this.rendererService,Ee=ee.createTexture2D,We=ee.createFramebuffer,er=ee.getViewportSize,hr=ee.getContainer,Kt=this.getContainerSize(hr()),kr=Kt.width,wn=Kt.height;kr*=Y.DOM.DPR,wn*=Y.DOM.DPR,this.pickBufferScale=this.configService.getSceneConfig($).pickBufferScale||1,this.pickingFBO=We({color:Ee({width:Math.round(kr/this.pickBufferScale),height:Math.round(wn/this.pickBufferScale),wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})}),this.interactionService.on(Na.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var ve=Ia(uo().mark(function ee(Ee,We,er){var hr=this,Kt,kr,wn,Ai;return uo().wrap(function($i){for(;;)switch($i.prev=$i.next){case 0:Kt=this.rendererService,kr=Kt.useFramebuffer,wn=Kt.clear,Ai=Kt.getContainer,this.resizePickingFBO(),kr(this.pickingFBO,function(){wn({framebuffer:hr.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ee.hooks.beforePickingEncode.call(),Ee.renderModels(),Ee.hooks.afterPickingEncode.call();var R=hr.pickBox(Ee,We);er(R)});case 3:case"end":return $i.stop()}},ee,this)}));function $(ee,Ee,We){return ve.apply(this,arguments)}return $}()},{key:"pickBox",value:function($,ee){var Ee=this,We=ee.map(function(gn){var Sn=gn<0?0:gn;return Math.floor(Sn*Y.DOM.DPR/Ee.pickBufferScale)}),er=gt(We,4),hr=er[0],Kt=er[1],kr=er[2],wn=er[3],Ai=this.rendererService,Hi=Ai.getViewportSize,$i=Ai.readPixels,R=Ai.getContainer,m=this.getContainerSize(R()),u=m.width,_=m.height;if(u*=Y.DOM.DPR,_*=Y.DOM.DPR,hr>(u-1)*Y.DOM.DPR/this.pickBufferScale||kr<0||Kt>(_-1)*Y.DOM.DPR/this.pickBufferScale||wn<0)return[];var b,q=Math.min(u/this.pickBufferScale,kr)-hr,de=Math.min(_/this.pickBufferScale,wn)-Kt;b=$i({x:hr,y:Math.floor(_/this.pickBufferScale-(wn+1)),width:q,height:de,data:new Uint8Array(q*de*4),framebuffer:this.pickingFBO});for(var ct=[],st={},Mt=0;Mt<b.length/4;Mt=Mt+1){var Ir=b.slice(Mt*4,Mt*4+4),Gr=(0,Y.decodePickingColor)(Ir);if(Gr!==-1&&!st[Gr]){var xn=$.getSource().getFeatureById(Gr);ct.push(It(It({},xn),{},{pickedFeatureIdx:Gr})),st[Gr]=!0}}return ct}},{key:"handleCursor",value:function($,ee){var Ee=$.getLayerConfig(),We=Ee.cursor,er=We===void 0?"":We,hr=Ee.cursorEnabled;if(hr){var Kt=this.mapService.version,kr=Kt==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),wn=kr==null?void 0:kr.style.getPropertyValue("cursor");ee==="unmousemove"&&wn!==""?kr==null||kr.style.setProperty("cursor",""):ee==="mousemove"&&(kr==null||kr.style.setProperty("cursor",er))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function($){return $.getContext?{width:$.width/Y.DOM.DPR,height:$.height/Y.DOM.DPR}:$.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var ve=Ia(uo().mark(function ee(Ee){var We;return uo().wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())){hr.next=2;break}return hr.abrupt("return");case 2:if(this.alreadyInPicking=!0,We=new Date().getTime(),!(We-this.lastPickTime>10||Ee.type==="contextmenu"||Ee.type==="click")){hr.next=7;break}return hr.next=7,this.pickingLayers(Ee);case 7:this.lastPickTime=We,this.layerService.renderLayers(),this.alreadyInPicking=!1;case 10:case"end":return hr.stop()}},ee,this)}));function $(ee){return ve.apply(this,arguments)}return $}()},{key:"resizePickingFBO",value:function(){var $=this.rendererService.getContainer,ee=this.getContainerSize($()),Ee=ee.width,We=ee.height;Ee*=Y.DOM.DPR,We*=Y.DOM.DPR,(this.width!==Ee||this.height!==We)&&(this.pickingFBO.resize({width:Math.round(Ee/this.pickBufferScale),height:Math.round(We/this.pickBufferScale)}),this.width=Ee,this.height=We)}},{key:"pickingLayers",value:function(){var ve=Ia(uo().mark(function ee(Ee){var We=this,er,hr,Kt,kr,wn;return uo().wrap(function(Hi){for(;;)switch(Hi.prev=Hi.next){case 0:er=this.rendererService,hr=er.getViewportSize,Kt=er.useFramebuffer,kr=er.clear,wn=er.getContainer,this.resizePickingFBO(),Kt(this.pickingFBO,function(){var $i=We.layerService.getRenderList();$i.filter(function(R){return R.needPick(Ee.type)}).reverse().some(function(R){kr({framebuffer:We.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),R.hooks.beforePickingEncode.call(),R.masks.length>0&&R.masks.map(function(u){u.hooks.beforeRenderData.call(),u.hooks.beforeRender.call(),u.render(),u.hooks.afterRender.call()}),R.renderModels(!0),R.hooks.afterPickingEncode.call();var m=We.pickFromPickingFBO(R,Ee);return We.layerService.pickedLayerId=m?+R.id:-1,m&&!R.getLayerConfig().enablePropagation})});case 3:case"end":return Hi.stop()}},ee,this)}));function $(ee){return ve.apply(this,arguments)}return $}()},{key:"triggerHoverOnLayer",value:function($,ee){Ts(ee)&&(this.handleCursor($,ee.type),$.emit(ee.type,ee))}},{key:"highlightPickedFeature",value:function($,ee){var Ee=gt(ee,3),We=Ee[0],er=Ee[1],hr=Ee[2];$.hooks.beforeHighlight.call([We,er,hr])}},{key:"selectFeature",value:function($,ee){var Ee=gt(ee,3),We=Ee[0],er=Ee[1],hr=Ee[2];$.hooks.beforeSelect.call([We,er,hr])}}]),C}(),_r=Pr(St.prototype,"mapService",[Ds],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Or=Pr(St.prototype,"rendererService",[Ro],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$n=Pr(St.prototype,"configService",[Eu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gi=Pr(St.prototype,"interactionService",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Pr(St.prototype,"layerService",[Gs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St))||ft),Xt=function(){function C(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;D(this,C),N(this,"autoStart",void 0),N(this,"startTime",0),N(this,"oldTime",0),N(this,"running",!1),N(this,"elapsedTime",0),this.autoStart=ve}return V(C,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var $=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var ee=(typeof performance=="undefined"?Date:performance).now();$=(ee-this.oldTime)/1e3,this.oldTime=ee,this.elapsedTime+=$}return $}}]),C}(),Dr,Lr,_n,Un,mn,mi,Oa,Fn,ci;function ia(C,ve){var $=typeof Symbol!="undefined"&&C[Symbol.iterator]||C["@@iterator"];if(!$){if(Array.isArray(C)||($=_a(C))||ve&&C&&typeof C.length=="number"){$&&(C=$);var ee=0,Ee=function(){};return{s:Ee,n:function(){return ee>=C.length?{done:!0}:{done:!1,value:C[ee++]}},e:function(kr){throw kr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var We=!0,er=!1,hr;return{s:function(){$=$.call(C)},n:function(){var kr=$.next();return We=kr.done,kr},e:function(kr){er=!0,hr=kr},f:function(){try{!We&&$.return!=null&&$.return()}finally{if(er)throw hr}}}}function _a(C,ve){if(!!C){if(typeof C=="string")return ao(C,ve);var $=Object.prototype.toString.call(C).slice(8,-1);if($==="Object"&&C.constructor&&($=C.constructor.name),$==="Map"||$==="Set")return Array.from(C);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return ao(C,ve)}}function ao(C,ve){(ve==null||ve>C.length)&&(ve=C.length);for(var $=0,ee=new Array(ve);$<ve;$++)ee[$]=C[$];return ee}var Yo=(Dr=(0,P.b2)(),Lr=(0,P.f3)(O.IRendererService),_n=(0,P.f3)(O.IMapService),Un=(0,P.f3)(O.IGlobalConfigService),Dr(mn=(mi=function(){function C(){D(this,C),N(this,"pickedLayerId",-1),N(this,"clock",new Xt),N(this,"alreadyInRendering",!1),N(this,"layers",[]),N(this,"layerList",[]),N(this,"layerRenderID",void 0),N(this,"sceneInited",!1),N(this,"animateInstanceCount",0),N(this,"shaderPicking",!0),N(this,"enableRender",!0),On(this,"renderService",Oa,this),On(this,"mapService",Fn,this),On(this,"configService",ci,this)}return V(C,[{key:"add",value:function($){this.sceneInited&&$.init(),this.layers.push($),this.updateLayerRenderList()}},{key:"addMask",value:function($){this.sceneInited&&$.init()}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function($){$.inited||$.init()}),this.updateLayerRenderList()}},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function($){return this.layers.find(function(ee){return ee.id===$})}},{key:"getLayerByName",value:function($){return this.layers.find(function(ee){return ee.name===$})}},{key:"cleanRemove",value:function($,ee){if(ee){var Ee=ee.layerChildren.indexOf($);Ee>-1&&ee.layerChildren.splice(Ee,1)}else{var We=this.layers.indexOf($);We>-1&&this.layers.splice(We,1)}this.updateLayerRenderList(),this.renderLayers()}},{key:"remove",value:function($,ee){if(ee){var Ee=ee.layerChildren.indexOf($);Ee>-1&&ee.layerChildren.splice(Ee,1)}else{var We=this.layers.indexOf($);We>-1&&this.layers.splice(We,1)}this.updateLayerRenderList(),$.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"setEnableRender",value:function($){this.enableRender=$}},{key:"renderLayers",value:function(){var ve=Ia(uo().mark(function ee(){var Ee,We,er;return uo().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){Kt.next=2;break}return Kt.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),Ee=ia(this.layerList),Kt.prev=5,Ee.s();case 7:if((We=Ee.n()).done){Kt.next=21;break}if(er=We.value,er.hooks.beforeRenderData.call(),er.hooks.beforeRender.call(),!er.isLayerGroup&&er.masks.length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),er.masks.map(function(kr){kr.hooks.beforeRenderData.call(),kr.hooks.beforeRender.call(),kr.render(),kr.hooks.afterRender.call()})),!er.getLayerConfig().enableMultiPassRenderer){Kt.next=17;break}return Kt.next=15,er.renderMultiPass();case 15:Kt.next=18;break;case 17:er.render();case 18:er.hooks.afterRender.call();case 19:Kt.next=7;break;case 21:Kt.next=26;break;case 23:Kt.prev=23,Kt.t0=Kt.catch(5),Ee.e(Kt.t0);case 26:return Kt.prev=26,Ee.f(),Kt.finish(26);case 29:this.alreadyInRendering=!1;case 30:case"end":return Kt.stop()}},ee,this,[[5,23,26,29]])}));function $(){return ve.apply(this,arguments)}return $}()},{key:"updateLayerRenderList",value:function(){var $=this;this.layerList=[],this.layers.filter(function(ee){return ee.inited}).filter(function(ee){return ee.isVisible()}).sort(function(ee,Ee){return ee.zIndex-Ee.zIndex}).forEach(function(ee){ee.isLayerGroup?ee.layerChildren.filter(function(Ee){return Ee.inited}).filter(function(Ee){return Ee.isVisible()}).sort(function(Ee,We){return Ee.zIndex-We.zIndex}).forEach(function(Ee){$.layerList.push(Ee)}):$.layerList.push(ee)})}},{key:"destroy",value:function(){this.layers.forEach(function($){$.destroy()}),this.layers=[],this.layerList=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var $=(0,Y.rgb2arr)(this.mapService.bgColor);this.renderService.clear({color:$,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=Y.$window.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){Y.$window.cancelAnimationFrame(this.layerRenderID)}}]),C}(),Oa=Pr(mi.prototype,"renderService",[Lr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fn=Pr(mi.prototype,"mapService",[_n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ci=Pr(mi.prototype,"configService",[Un],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mi))||mn);function Vo(C,ve){if(C==null)return{};var $={},ee=Object.keys(C),Ee,We;for(We=0;We<ee.length;We++)Ee=ee[We],!(ve.indexOf(Ee)>=0)&&($[Ee]=C[Ee]);return $}function Bo(C,ve){if(C==null)return{};var $=Vo(C,ve),ee,Ee;if(Object.getOwnPropertySymbols){var We=Object.getOwnPropertySymbols(C);for(Ee=0;Ee<We.length;Ee++)ee=We[Ee],!(ve.indexOf(ee)>=0)&&(!Object.prototype.propertyIsEnumerable.call(C,ee)||($[ee]=C[ee]))}return $}function mo(C){if(Array.isArray(C))return Me(C)}function Do(C){if(typeof Symbol!="undefined"&&C[Symbol.iterator]!=null||C["@@iterator"]!=null)return Array.from(C)}function ps(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g(C){return mo(C)||Do(C)||Ue(C)||ps()}var U=y(14293),he=y.n(U),te=function(){function C(ve){var $=this;D(this,C),N(this,"name",void 0),N(this,"type",void 0),N(this,"scale",void 0),N(this,"descriptor",void 0),N(this,"featureBufferLayout",[]),N(this,"needRescale",!1),N(this,"needRemapping",!1),N(this,"needRegenerateVertices",!1),N(this,"featureRange",{startIndex:0,endIndex:Infinity}),N(this,"vertexAttribute",void 0),N(this,"defaultCallback",function(ee){if(ee.length===0){var Ee;return((Ee=$.scale)===null||Ee===void 0?void 0:Ee.defaultValues)||[]}return ee.map(function(We,er){var hr,Kt=(hr=$.scale)===null||hr===void 0?void 0:hr.scalers[er].func,kr=Kt(We);return kr})}),this.setProps(ve)}return V(C,[{key:"setProps",value:function($){Object.assign(this,$)}},{key:"mapping",value:function($){var ee;if((ee=this.scale)!==null&&ee!==void 0&&ee.callback){var Ee,We=(Ee=this.scale)===null||Ee===void 0?void 0:Ee.callback.apply(Ee,g($));if(!he()(We))return[We]}return this.defaultCallback($)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),C}(),tt=["buffer","update","name"],Pt=["buffer","update","name"],fr,Fr,zr,En,Dn,na;function ka(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function ha(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?ka(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):ka(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function Fa(C){return new Promise(function(ve){return setTimeout(ve,C)})}var Mo=(fr={},N(fr,ua.FLOAT,4),N(fr,ua.UNSIGNED_BYTE,1),N(fr,ua.UNSIGNED_SHORT,2),fr),Po=(Fr=(0,P.b2)(),zr=(0,P.f3)(O.IRendererService),Fr(En=(Dn=function(){function C(){D(this,C),N(this,"attributesAndIndices",void 0),On(this,"rendererService",na,this),N(this,"attributes",[]),N(this,"triangulation",void 0),N(this,"featureLayout",{sizePerElement:0,elements:[]})}return V(C,[{key:"registerStyleAttribute",value:function($){var ee=this.getLayerStyleAttribute($.name||"");return ee?ee.setProps($):(ee=new te($),this.attributes.push(ee)),ee}},{key:"updateStyleAttribute",value:function($,ee,Ee){var We=this.getLayerStyleAttribute($);We||(We=this.registerStyleAttribute(ha(ha({},ee),{},{name:$})));var er=ee.scale;er&&We&&(We.scale=er,We.needRescale=!0,We.needRemapping=!0,We.needRegenerateVertices=!0,Ee&&Ee.featureRange&&(We.featureRange=Ee.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function($){return this.attributes.find(function(ee){return ee.name===$})}},{key:"getLayerAttributeScale",value:function($){var ee,Ee=this.getLayerStyleAttribute($),We=Ee==null||(ee=Ee.scale)===null||ee===void 0?void 0:ee.scalers;return We&&We[0]?We[0].func:null}},{key:"updateAttributeByFeatureRange",value:function($,ee){var Ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,We=arguments.length>3?arguments[3]:void 0,er=this.attributes.find(function(de){return de.name===$});if(er&&er.descriptor){var hr=er.descriptor,Kt=hr.update,kr=hr.buffer,wn=hr.size,Ai=wn===void 0?0:wn,Hi=Mo[kr.type||ua.FLOAT];if(Kt){var $i=this.featureLayout,R=$i.elements,m=$i.sizePerElement,u=R.slice(Ee,We);if(!u.length)return;var _=u[0].offset,b=_*Ai*Hi,q=u.map(function(de,ct){for(var st=de.featureIdx,Mt=de.vertices,Ir=de.normals,Gr=Mt.length/m,xn=[],gn=0;gn<Gr;gn++){var Sn=Ir?Ir.slice(gn*3,gn*3+3):[];xn.push.apply(xn,g(Kt(ee[st],st,Mt.slice(gn*m,gn*m+m),ct,Sn)))}return xn}).reduce(function(de,ct){return de.push.apply(de,g(ct)),de},[]);er.vertexAttribute.updateBuffer({data:q,offset:b})}}}},{key:"createAttributesAndIndices",value:function($,ee,Ee){var We=this;this.featureLayout={sizePerElement:0,elements:[]},ee&&(this.triangulation=ee);var er=this.attributes.map(function(b){return b.resetDescriptor(),b.descriptor}),hr=0,Kt=[],kr=[],wn=[],Ai=3;$.forEach(function(b,q){var de=We.triangulation(b,Ee),ct=de.indices,st=de.vertices,Mt=de.normals,Ir=de.size,Gr=de.indexes;ct.forEach(function(Wn){kr.push(Wn+hr)}),Ai=Ir;var xn=st.length/Ir;We.featureLayout.sizePerElement=Ai,We.featureLayout.elements.push({featureIdx:q,vertices:st,normals:Mt,offset:hr}),hr+=xn;for(var gn=function(bi){var pa=(Mt==null?void 0:Mt.slice(bi*3,bi*3+3))||[],Wa=st.slice(bi*Ir,bi*Ir+Ir),Qa=0;Gr&&Gr[bi]!==void 0&&(Qa=Gr[bi]),er.forEach(function(ro,Ko){if(ro&&ro.update){var sa;(sa=ro.buffer.data).push.apply(sa,g(ro.update(b,q,Wa,bi,pa,Qa)))}})},Sn=0;Sn<xn;Sn++)gn(Sn)});var Hi=this.rendererService,$i=Hi.createAttribute,R=Hi.createBuffer,m=Hi.createElements,u={};er.forEach(function(b,q){if(b){var de=b.buffer,ct=b.update,st=b.name,Mt=Bo(b,tt),Ir=$i(ha({buffer:R(de)},Mt));u[b.name||""]=Ir,We.attributes[q].vertexAttribute=Ir}});var _=m({data:kr,type:ua.UNSIGNED_INT,count:kr.length});return this.attributesAndIndices={attributes:u,elements:_},this.attributesAndIndices}},{key:"createAttributes",value:function($,ee){var Ee=this;this.featureLayout={sizePerElement:0,elements:[]},ee&&(this.triangulation=ee);var We=this.attributes.map(function($i){return $i.resetDescriptor(),$i.descriptor}),er=0,hr=[],Kt=3;$.forEach(function($i,R){var m=Ee.triangulation($i),u=m.indices,_=m.vertices,b=m.normals,q=m.size,de=m.indexes;u.forEach(function(Ir){hr.push(Ir+er)}),Kt=q;var ct=_.length/q;Ee.featureLayout.sizePerElement=Kt,Ee.featureLayout.elements.push({featureIdx:R,vertices:_,normals:b,offset:er}),er+=ct;for(var st=function(Gr){var xn=(b==null?void 0:b.slice(Gr*3,Gr*3+3))||[],gn=_.slice(Gr*q,Gr*q+q),Sn=0;de&&de[Gr]!==void 0&&(Sn=de[Gr]),We.forEach(function(Wn,bi){if(Wn&&Wn.update){var pa;(pa=Wn.buffer.data).push.apply(pa,g(Wn.update($i,R,gn,Gr,xn,Sn)))}})},Mt=0;Mt<ct;Mt++)st(Mt)});var kr=this.rendererService,wn=kr.createAttribute,Ai=kr.createBuffer,Hi={};return We.forEach(function($i,R){if($i){var m=$i.buffer,u=$i.update,_=$i.name,b=Bo($i,Pt),q=wn(ha({buffer:Ai(m)},b));Hi[$i.name||""]=q,Ee.attributes[R].vertexAttribute=q}}),{attributes:Hi}}},{key:"clearAllAttributes",value:function(){var $;this.attributes.forEach(function(ee){ee.vertexAttribute&&ee.vertexAttribute.destroy()}),($=this.attributesAndIndices)===null||$===void 0||$.elements.destroy(),this.attributes=[]}}]),C}(),na=Pr(Dn.prototype,"rendererService",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn))||En),go=y(46343),fu=y(67709),yo=y.n(fu),Zu,tc,ws,Nc,$u,Ku,xl,qo,rc,Ec,Va,qu,ys,ss,bl,El,To,Ps,hf,ju,zc,Uc,Bf,Jc,vu,Ul,Qu,Cu,Zl,nc,ic,Gu,pf;function Cc(C){var ve=ef();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function ef(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var ko=(Zu=(0,P.b2)(),tc=(0,P.f3)(O.SceneID),ws=(0,P.f3)(O.IIconService),Nc=(0,P.f3)(O.IFontService),$u=(0,P.f3)(O.IControlService),Ku=(0,P.f3)(O.IGlobalConfigService),xl=(0,P.f3)(O.IMapService),qo=(0,P.f3)(O.ICoordinateSystemService),rc=(0,P.f3)(O.IRendererService),Ec=(0,P.f3)(O.ILayerService),Va=(0,P.f3)(O.ICameraService),qu=(0,P.f3)(O.IInteractionService),ys=(0,P.f3)(O.IPickingService),ss=(0,P.f3)(O.IShaderModuleService),bl=(0,P.f3)(O.IMarkerService),El=(0,P.f3)(O.IPopupService),Zu(To=(Ps=function(C){Cr($,C);var ve=Cc($);function $(){var ee;return D(this,$),ee=ve.call(this),N(mt(ee),"destroyed",!1),N(mt(ee),"loaded",!1),N(mt(ee),"loadFont",!1),N(mt(ee),"fontFamily",""),On(mt(ee),"id",hf,mt(ee)),On(mt(ee),"iconService",ju,mt(ee)),On(mt(ee),"fontService",zc,mt(ee)),On(mt(ee),"controlService",Uc,mt(ee)),On(mt(ee),"configService",Bf,mt(ee)),On(mt(ee),"map",Jc,mt(ee)),On(mt(ee),"coordinateSystemService",vu,mt(ee)),On(mt(ee),"rendererService",Ul,mt(ee)),On(mt(ee),"layerService",Qu,mt(ee)),On(mt(ee),"cameraService",Cu,mt(ee)),On(mt(ee),"interactionService",Zl,mt(ee)),On(mt(ee),"pickingService",nc,mt(ee)),On(mt(ee),"shaderModuleService",ic,mt(ee)),On(mt(ee),"markerService",Gu,mt(ee)),On(mt(ee),"popupService",pf,mt(ee)),N(mt(ee),"inited",!1),N(mt(ee),"initPromise",void 0),N(mt(ee),"rendering",!1),N(mt(ee),"$container",void 0),N(mt(ee),"canvas",void 0),N(mt(ee),"markerContainer",void 0),N(mt(ee),"hooks",void 0),N(mt(ee),"handleWindowResized",function(){ee.emit("resize"),ee.$container&&(ee.initContainer(),Y.DOM.triggerResize(),ee.coordinateSystemService.needRefresh=!0,ee.render())}),N(mt(ee),"handleMapCameraChanged",function(Ee){ee.cameraService.update(Ee),ee.render()}),ee.hooks={init:new go.zj},ee}return V($,[{key:"init",value:function(Ee){var We=this;this.configService.setSceneConfig(this.id,Ee),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return We.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",Ia(uo().mark(function er(){return uo().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:return Kt.next=2,new Promise(function(kr){We.map.onCameraChanged(function(wn){We.cameraService.init(),We.cameraService.update(wn),We.map.version!=="GAODE2.x"&&kr()}),We.map.version!=="GAODE2.x"?We.map.init():kr()});case 2:if(!(We.map.version==="GAODE2.x"&&We.map.initViewPort)){Kt.next=6;break}return Kt.next=5,We.map.init();case 5:We.map.initViewPort();case 6:We.map.onCameraChanged(We.handleMapCameraChanged),We.map.addMarkerContainer(),We.markerService.addMarkers(),We.markerService.addMarkerLayers(),We.popupService.initPopup(),We.interactionService.init(),We.interactionService.on(Na.Drag,We.addSceneEvent.bind(We));case 13:case"end":return Kt.stop()}},er)}))),this.hooks.init.tapPromise("initRenderer",Ia(uo().mark(function er(){var hr,Kt;return uo().wrap(function(wn){for(;;)switch(wn.prev=wn.next){case 0:if(hr=Ao(We.configService.getSceneConfig(We.id).id||""),We.$container=hr,!hr){wn.next=11;break}return We.canvas=Y.DOM.create("canvas","",hr),We.setCanvas(),wn.next=7,We.rendererService.init(We.canvas,We.configService.getSceneConfig(We.id));case 7:yo()(We.$container,We.handleWindowResized),Y.$window.matchMedia&&((Kt=Y.$window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||Kt===void 0||Kt.addListener(We.handleWindowResized)),wn.next=12;break;case 11:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:We.pickingService.init(We.id);case 13:case"end":return wn.stop()}},er)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"initMiniScene",value:function(Ee){var We=this;this.configService.setSceneConfig(this.id,Ee),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return We.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",Ia(uo().mark(function er(){return uo().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:return Kt.next=2,new Promise(function(kr){We.map.onCameraChanged(function(wn){We.cameraService.init(),We.cameraService.update(wn),We.map.version!=="GAODE2.x"&&kr()}),We.map.initMiniMap()});case 2:We.map.onCameraChanged(We.handleMapCameraChanged),We.interactionService.init(),We.interactionService.on(Na.Drag,We.addSceneEvent.bind(We));case 5:case"end":return Kt.stop()}},er)}))),this.hooks.init.tapPromise("initRenderer",Ia(uo().mark(function er(){var hr;return uo().wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:if(hr=Ee.canvas,We.$container=hr||null,!We.$container){kr.next=7;break}return kr.next=5,We.rendererService.init(Ee.canvas,We.configService.getSceneConfig(We.id));case 5:kr.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:We.pickingService.init(We.id);case 9:case"end":return kr.stop()}},er)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Ee){this.layerService.sceneService=this,this.layerService.add(Ee),this.render()}},{key:"addMask",value:function(Ee){this.layerService.sceneService=this,this.layerService.addMask(Ee),this.render()}},{key:"render",value:function(){var ee=Ia(uo().mark(function We(){return uo().wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if(!(this.rendering||this.destroyed)){hr.next=2;break}return hr.abrupt("return");case 2:if(this.rendering=!0,this.inited){hr.next=23;break}return hr.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!(this.loadFont&&document.fonts)){hr.next=18;break}return hr.prev=8,hr.next=11,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 11:hr.next=18;break;case 13:hr.prev=13,hr.t0=hr.catch(8),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(hr.t0);case 18:this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 23:this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this.rendering=!1;case 26:case"end":return hr.stop()}},We,this,[[8,13]])}));function Ee(){return ee.apply(this,arguments)}return Ee}()},{key:"addFontFace",value:function(Ee,We){this.fontFamily=Ee;var er=document.createElement("style");er.type="text/css",er.innerText=`
        @font-face{
            font-family: '`.concat(Ee,`';
            src: url('`).concat(We,`') format('woff2'),
            url('`).concat(We,`') format('woff'),
            url('`).concat(We,`') format('truetype');
        }`),document.getElementsByTagName("head")[0].appendChild(er),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Ee){var We,er=(We=this.$container)===null||We===void 0?void 0:We.getElementsByTagName("canvas")[0];this.render();var hr=Ee==="jpg"?er==null?void 0:er.toDataURL("image/jpeg"):er==null?void 0:er.toDataURL("image/png");return hr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var Ee=this.$container.parentElement;Ee!==null&&(this.markerContainer=Y.DOM.create("div","l7-marker-container",Ee))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var Ee=this,We,er;if(!this.inited){this.destroyed=!0;return}if(this.emit("destroy"),this.pickingService.destroy(),this.layerService.destroy(),setTimeout(function(){var Kt;(Kt=Ee.$container)===null||Kt===void 0||Kt.removeChild(Ee.canvas),Ee.canvas=null,Ee.rendererService.destroy()}),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),(We=this.$container)===null||We===void 0||(er=We.parentNode)===null||er===void 0||er.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,(0,fu.unbind)(this.$container,this.handleWindowResized),Y.$window.matchMedia){var hr;(hr=Y.$window.matchMedia("screen and (min-resolution: 2dppx)"))===null||hr===void 0||hr.removeListener(this.handleWindowResized)}}},{key:"initContainer",value:function(){var Ee,We,er=Y.DOM.DPR,hr=((Ee=this.$container)===null||Ee===void 0?void 0:Ee.clientWidth)||400,Kt=((We=this.$container)===null||We===void 0?void 0:We.clientHeight)||300,kr=this.canvas;kr&&(kr.width=hr*er,kr.height=Kt*er),this.rendererService.viewport({x:0,y:0,width:er*hr,height:er*Kt})}},{key:"setCanvas",value:function(){var Ee,We,er=Y.DOM.DPR,hr=((Ee=this.$container)===null||Ee===void 0?void 0:Ee.clientWidth)||400,Kt=((We=this.$container)===null||We===void 0?void 0:We.clientHeight)||300,kr=this.canvas;kr.width=hr*er,kr.height=Kt*er,kr.style.width="100%",kr.style.height="100%"}},{key:"addSceneEvent",value:function(Ee){this.emit(Ee.type,Ee)}}]),$}(Z.EventEmitter),hf=Pr(Ps.prototype,"id",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ju=Pr(Ps.prototype,"iconService",[ws],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zc=Pr(Ps.prototype,"fontService",[Nc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uc=Pr(Ps.prototype,"controlService",[$u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bf=Pr(Ps.prototype,"configService",[Ku],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jc=Pr(Ps.prototype,"map",[xl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vu=Pr(Ps.prototype,"coordinateSystemService",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ul=Pr(Ps.prototype,"rendererService",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qu=Pr(Ps.prototype,"layerService",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cu=Pr(Ps.prototype,"cameraService",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zl=Pr(Ps.prototype,"interactionService",[qu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc=Pr(Ps.prototype,"pickingService",[ys],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ic=Pr(Ps.prototype,"shaderModuleService",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gu=Pr(Ps.prototype,"markerService",[bl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pf=Pr(Ps.prototype,"popupService",[El],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ps))||To),Zc=y(44908),Su=y.n(Zc);function jl(C){var ve=0;switch(C){case"vec2":case"ivec2":ve=2;break;case"vec3":case"ivec3":ve=3;break;case"vec4":case"ivec4":case"mat2":ve=4;break;case"mat3":ve=9;break;case"mat4":ve=16;break;default:}return ve}var cl=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function tf(C){var ve={};return C=C.replace(cl,function($,ee,Ee){var We=Ee.split(":"),er=We[0].trim(),hr="";switch(We.length>1&&(hr=We[1].trim()),ee){case"bool":hr=hr==="true";break;case"float":case"int":hr=Number(hr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":hr?hr=hr.replace("[","").replace("]","").split(",").reduce(function(Kt,kr){return Kt.push(Number(kr.trim())),Kt},[]):hr=new Array(jl(ee)).fill(0);break;default:}return ve[er]=hr,"uniform ".concat(ee," ").concat(er,`;
`)}),{content:C,uniforms:ve}}var Gl,fl;function jc(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Vl(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?jc(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):jc(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}var Cl="#define PI 3.14159265359",Nf=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,rf=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,le=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Ve=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // TODO: \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,_t=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,ut=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,Wt=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom));
  }
  return pixel * 2.0;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,hn=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Mi=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,da=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,oa=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,za=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,Xo=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,Sc=/precision\s+(high|low|medium)p\s+float/,hl=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,df=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,yh=(Gl=(0,P.b2)(),Gl(fl=function(){function C(){D(this,C),N(this,"moduleCache",{}),N(this,"rawContentCache",{})}return V(C,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Cl,fs:Cl}),this.registerModule("decode",{vs:Nf,fs:""}),this.registerModule("projection",{vs:Wt,fs:""}),this.registerModule("project",{vs:ut,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:hn}),this.registerModule("lighting",{vs:le,fs:""}),this.registerModule("light",{vs:rf,fs:""}),this.registerModule("picking",{vs:_t,fs:Ve}),this.registerModule("styleMapping",{vs:Mi,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:Xo,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:da,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:oa,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:za,fs:""})}},{key:"registerModule",value:function($,ee){if(!this.rawContentCache[$]){var Ee=ee.vs,We=ee.fs,er=ee.uniforms,hr=tf(Ee),Kt=hr.content,kr=hr.uniforms,wn=tf(We),Ai=wn.content,Hi=wn.uniforms;this.rawContentCache[$]={fs:Ai,uniforms:Vl(Vl(Vl({},kr),Hi),er),vs:Kt}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function($){var ee=this;if(this.moduleCache[$])return this.moduleCache[$];var Ee=this.rawContentCache[$].vs,We=this.rawContentCache[$].fs,er=this.processModule(Ee,[],"vs"),hr=er.content,Kt=er.includeList,kr=this.processModule(We,[],"fs"),wn=kr.content,Ai=kr.includeList,Hi=wn,$i=Su()(Kt.concat(Ai).concat($)).reduce(function(R,m){return Vl(Vl({},R),ee.rawContentCache[m].uniforms)},{});return Sc.test(wn)||(Hi=hl+wn),this.moduleCache[$]={fs:Hi.trim(),uniforms:$i,vs:hr.trim()},this.moduleCache[$]}},{key:"processModule",value:function($,ee,Ee){var We=this,er=$.replace(df,function(hr,Kt){var kr=Kt.split(" "),wn=kr[0].replace(/"/g,"");if(ee.indexOf(wn)>-1)return"";var Ai=We.rawContentCache[wn][Ee];ee.push(wn);var Hi=We.processModule(Ai,ee,Ee),$i=Hi.content;return $i});return{content:er,includeList:ee}}}]),C}())||fl);function ih(C,ve){for(;!Object.prototype.hasOwnProperty.call(C,ve)&&(C=Ye(C),C!==null););return C}function Hl(){return typeof Reflect!="undefined"&&Reflect.get?Hl=Reflect.get:Hl=function(ve,$,ee){var Ee=ih(ve,$);if(!!Ee){var We=Object.getOwnPropertyDescriptor(Ee,$);return We.get?We.get.call(arguments.length<3?ve:ee):We.value}},Hl.apply(this,arguments)}var Sl;(function(C){C.Normal="normal",C.PostProcessing="post-processing"})(Sl||(Sl={}));var ac,Vs,Gc=(ac=(0,P.b2)(),ac(Vs=function(){function C(){D(this,C),N(this,"shaderModuleService",void 0),N(this,"rendererService",void 0),N(this,"cameraService",void 0),N(this,"mapService",void 0),N(this,"interactionService",void 0),N(this,"layerService",void 0),N(this,"config",void 0)}return V(C,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Sl.Normal}},{key:"init",value:function($,ee){this.config=ee,this.rendererService=$.getContainer().get(O.IRendererService),this.cameraService=$.getContainer().get(O.ICameraService),this.mapService=$.getContainer().get(O.IMapService),this.interactionService=$.getContainer().get(O.IInteractionService),this.layerService=$.getContainer().get(O.ILayerService),this.shaderModuleService=$.getContainer().get(O.IShaderModuleService)}},{key:"render",value:function($){}}]),C}())||Vs),vf,Hs;function zi(C){var ve=ks();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function ks(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var Vc=(vf=(0,P.b2)(),vf(Hs=function(C){Cr($,C);var ve=zi($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Ee,We){Hl(Ye($.prototype),"init",this).call(this,Ee,We)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),$}(Gc))||Hs),nf,Ws,Vu,mf,_i;function gf(C,ve){var $=typeof Symbol!="undefined"&&C[Symbol.iterator]||C["@@iterator"];if(!$){if(Array.isArray(C)||($=$f(C))||ve&&C&&typeof C.length=="number"){$&&(C=$);var ee=0,Ee=function(){};return{s:Ee,n:function(){return ee>=C.length?{done:!0}:{done:!1,value:C[ee++]}},e:function(kr){throw kr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var We=!0,er=!1,hr;return{s:function(){$=$.call(C)},n:function(){var kr=$.next();return We=kr.done,kr},e:function(kr){er=!0,hr=kr},f:function(){try{!We&&$.return!=null&&$.return()}finally{if(er)throw hr}}}}function $f(C,ve){if(!!C){if(typeof C=="string")return Al(C,ve);var $=Object.prototype.toString.call(C).slice(8,-1);if($==="Object"&&C.constructor&&($=C.constructor.name),$==="Map"||$==="Set")return Array.from(C);if($==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return Al(C,ve)}}function Al(C,ve){(ve==null||ve>C.length)&&(ve=C.length);for(var $=0,ee=new Array(ve);$<ve;$++)ee[$]=C[$];return ee}var _s=(nf=(0,P.b2)(),Ws=(0,P.f3)(O.IPostProcessor),nf(Vu=(mf=function(){function C(){D(this,C),N(this,"passes",[]),On(this,"postProcessor",_i,this),N(this,"layer",void 0),N(this,"renderFlag",void 0),N(this,"width",0),N(this,"height",0)}return V(C,[{key:"setLayer",value:function($){this.layer=$}},{key:"setRenderFlag",value:function($){this.renderFlag=$}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var ve=Ia(uo().mark(function ee(){var Ee,We,er;return uo().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:Ee=gf(this.passes),Kt.prev=1,Ee.s();case 3:if((We=Ee.n()).done){Kt.next=9;break}return er=We.value,Kt.next=7,er.render(this.layer);case 7:Kt.next=3;break;case 9:Kt.next=14;break;case 11:Kt.prev=11,Kt.t0=Kt.catch(1),Ee.e(Kt.t0);case 14:return Kt.prev=14,Ee.f(),Kt.finish(14);case 17:return Kt.next=19,this.postProcessor.render(this.layer);case 19:case"end":return Kt.stop()}},ee,this,[[1,11,14,17]])}));function $(){return ve.apply(this,arguments)}return $}()},{key:"resize",value:function($,ee){(this.width!==$||this.height!==ee)&&(this.postProcessor.resize($,ee),this.width=$,this.height=ee)}},{key:"add",value:function($,ee){$.getType()===Sl.PostProcessing?this.postProcessor.add($,this.layer,ee):($.init(this.layer,ee),this.passes.push($))}},{key:"insert",value:function($,ee,Ee){$.init(this.layer,ee),this.passes.splice(Ee,0,$)}},{key:"destroy",value:function(){this.passes.length=0}}]),C}(),_i=Pr(mf.prototype,"postProcessor",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mf))||Vu),Au,yf;function Tl(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Ru(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?Tl(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):Tl(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function Ac(C){var ve=ah();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function ah(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var zf=(Au=(0,P.b2)(),Au(yf=function(C){Cr($,C);var ve=Ac($);function $(){var ee;D(this,$);for(var Ee=arguments.length,We=new Array(Ee),er=0;er<Ee;er++)We[er]=arguments[er];return ee=ve.call.apply(ve,[this].concat(We)),N(mt(ee),"pickingFBO",void 0),N(mt(ee),"layer",void 0),N(mt(ee),"width",0),N(mt(ee),"height",0),N(mt(ee),"alreadyInRendering",!1),N(mt(ee),"pickFromPickingFBO",function(hr){var Kt=hr.x,kr=hr.y,wn=hr.lngLat,Ai=hr.type;if(!(!ee.layer.isVisible()||!ee.layer.needPick(Ai))){var Hi=ee.rendererService,$i=Hi.getViewportSize,R=Hi.readPixels,m=Hi.useFramebuffer,u=$i(),_=u.width,b=u.height,q=ee.layer.getLayerConfig(),de=q.enableHighlight,ct=q.enableSelect,st=Kt*Y.DOM.DPR,Mt=kr*Y.DOM.DPR;if(!(st>_||st<0||Mt>b||Mt<0)){var Ir;m(ee.pickingFBO,function(){var Gr;if(Ir=R({x:Math.round(st),y:Math.round(b-(kr+1)*Y.DOM.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:ee.pickingFBO}),Ir[0]!==0||Ir[1]!==0||Ir[2]!==0){var xn=(0,Y.decodePickingColor)(Ir),gn=ee.layer.getSource().getFeatureById(xn),Sn={x:Kt,y:kr,type:Ai,lngLat:wn,featureId:xn,feature:gn};gn&&(ee.layer.setCurrentPickId(xn),ee.triggerHoverOnLayer(Sn))}else{var Wn={x:Kt,y:kr,lngLat:wn,type:ee.layer.getCurrentPickId()===null?"un"+Ai:"mouseout",featureId:null,feature:null};ee.triggerHoverOnLayer(Ru(Ru({},Wn),{},{type:"unpick"})),ee.triggerHoverOnLayer(Wn),ee.layer.setCurrentPickId(null)}de&&ee.highlightPickedFeature(Ir),ct&&Ai==="click"&&((Gr=Ir)===null||Gr===void 0?void 0:Gr.toString())!==[0,0,0,0].toString()&&ee.selectFeature(Ir)})}}}),ee}return V($,[{key:"getType",value:function(){return Sl.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Ee,We){Hl(Ye($.prototype),"init",this).call(this,Ee,We),this.layer=Ee;var er=this.rendererService,hr=er.createTexture2D,Kt=er.createFramebuffer,kr=er.getViewportSize,wn=kr(),Ai=wn.width,Hi=wn.height;this.pickingFBO=Kt({color:hr({width:Ai,height:Hi,wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})}),this.interactionService.on(Na.Hover,this.pickFromPickingFBO),this.interactionService.on(Na.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Na.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Ee){var We=this;if(!this.alreadyInRendering){var er=this.rendererService,hr=er.getViewportSize,Kt=er.useFramebuffer,kr=er.clear,wn=hr(),Ai=wn.width,Hi=wn.height;this.alreadyInRendering=!0,(this.width!==Ai||this.height!==Hi)&&(this.pickingFBO.resize({width:Ai,height:Hi}),this.width=Ai,this.height=Hi),Kt(this.pickingFBO,function(){kr({framebuffer:We.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var $i=We.layer.multiPassRenderer.getRenderFlag();We.layer.multiPassRenderer.setRenderFlag(!1),Ee.hooks.beforePickingEncode.call(),Ee.render(),Ee.hooks.afterPickingEncode.call(),We.layer.multiPassRenderer.setRenderFlag($i),We.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(Ee){this.layer.emit(Ee.type,Ee)}},{key:"highlightPickedFeature",value:function(Ee){var We=gt(Ee,3),er=We[0],hr=We[1],Kt=We[2];this.layer.hooks.beforeHighlight.call([er,hr,Kt]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Ee){var We=gt(Ee,3),er=We[0],hr=We[1],Kt=We[2];this.layer.hooks.beforeSelect.call([er,hr,Kt]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Ee){var We=Ee.featureId,er=(0,Y.encodePickingColor)(We);this.selectFeature(new Uint8Array(er))}},{key:"highlightFeatureHandle",value:function(Ee){var We=Ee.featureId,er=(0,Y.encodePickingColor)(We);this.highlightPickedFeature(new Uint8Array(er))}}]),$}(Gc))||yf),Uf=y(11700),oh=y.n(Uf),wl=y(68929),pl=y.n(wl),fo,Ju,Ml,Xs,oc;function Hc(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Tu(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?Hc(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):Hc(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}var Hu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Js=(fo=(0,P.b2)(),Ju=(0,P.f3)(O.IShaderModuleService),fo(Ml=(Xs=function(){function C(){D(this,C),On(this,"shaderModuleService",oc,this),N(this,"rendererService",void 0),N(this,"config",void 0),N(this,"quad",Hu),N(this,"enabled",!0),N(this,"renderToScreen",!1),N(this,"model",void 0),N(this,"name",void 0),N(this,"optionsToUpdate",{})}return V(C,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function($){this.name=$}},{key:"getType",value:function(){return Sl.PostProcessing}},{key:"init",value:function($,ee){this.config=ee,this.rendererService=$.getContainer().get(O.IRendererService),this.shaderModuleService=$.getContainer().get(O.IShaderModuleService);var Ee=this.rendererService,We=Ee.createAttribute,er=Ee.createBuffer,hr=Ee.createModel,Kt=this.setupShaders(),kr=Kt.vs,wn=Kt.fs,Ai=Kt.uniforms;this.model=hr({vs:kr,fs:wn,attributes:{a_Position:We({buffer:er({data:[-4,-4,4,-4,0,4],type:ua.FLOAT}),size:2})},uniforms:Tu(Tu({u_Texture:null},Ai),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function($,ee){var Ee=this,We=$.multiPassRenderer.getPostProcessor(),er=this.rendererService,hr=er.useFramebuffer,Kt=er.getViewportSize,kr=er.clear,wn=Kt(),Ai=wn.width,Hi=wn.height;hr(this.renderToScreen?null:We.getWriteFBO(),function(){kr({framebuffer:We.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var $i=Tu({u_BloomFinal:0,u_Texture:We.getReadFBO(),u_ViewportSize:[Ai,Hi]},Ee.convertOptionsToUniforms(Ee.optionsToUpdate));ee&&($i.u_BloomFinal=1,$i.u_Texture2=ee),Ee.model.draw({uniforms:$i})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function($){this.enabled=$}},{key:"setRenderToScreen",value:function($){this.renderToScreen=$}},{key:"updateOptions",value:function($){this.optionsToUpdate=Tu(Tu({},this.optionsToUpdate),$)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function($){var ee={};return Object.keys($).forEach(function(Ee){he()($[Ee])||(ee["u_".concat(oh()(pl()(Ee)))]=$[Ee])}),ee}}]),C}(),oc=Pr(Xs.prototype,"shaderModuleService",[Ju],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xs))||Ml),la,Vi;function wf(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function wu(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?wf(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):wf(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function Wl(C){var ve=mu();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function mu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var Pl=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,Zf=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,sc=(la=(0,P.b2)(),la(Vi=function(C){Cr($,C);var ve=Wl($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Zf,fs:Pl});var Ee=this.shaderModuleService.getModule("blur-pass"),We=Ee.vs,er=Ee.fs,hr=Ee.uniforms,Kt=this.rendererService.getViewportSize(),kr=Kt.width,wn=Kt.height;return{vs:We,fs:er,uniforms:wu(wu({},hr),{},{u_ViewportSize:[kr,wn]})}}},{key:"convertOptionsToUniforms",value:function(Ee){var We={};return he()(Ee.bloomRadius)||(We.u_radius=Ee.bloomRadius),he()(Ee.bloomIntensity)||(We.u_intensity=Ee.bloomIntensity),he()(Ee.bloomBaseRadio)||(We.u_baseRadio=Ee.bloomBaseRadio),We}}]),$}(Js))||Vi),$o,fs;function _f(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function uc(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?_f(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):_f(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function lc(C){var ve=Ll();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function Ll(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var au=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Tc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,cc=($o=(0,P.b2)(),$o(fs=function(C){Cr($,C);var ve=lc($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Tc,fs:au});var Ee=this.shaderModuleService.getModule("blur-pass"),We=Ee.vs,er=Ee.fs,hr=Ee.uniforms,Kt=this.rendererService.getViewportSize(),kr=Kt.width,wn=Kt.height;return{vs:We,fs:er,uniforms:uc(uc({},hr),{},{u_ViewportSize:[kr,wn]})}}},{key:"convertOptionsToUniforms",value:function(Ee){var We={};return he()(Ee.blurRadius)||(We.u_BlurDir=[Ee.blurRadius,0]),We}}]),$}(Js))||fs),xf,fc;function Xl(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Mf(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?Xl(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):Xl(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function af(C){var ve=Yl();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function Yl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var of=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,$l=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Kl=(xf=(0,P.b2)(),xf(fc=function(C){Cr($,C);var ve=af($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:$l,fs:of});var Ee=this.shaderModuleService.getModule("blur-pass"),We=Ee.vs,er=Ee.fs,hr=Ee.uniforms,Kt=this.rendererService.getViewportSize(),kr=Kt.width,wn=Kt.height;return{vs:We,fs:er,uniforms:Mf(Mf({},hr),{},{u_ViewportSize:[kr,wn]})}}},{key:"convertOptionsToUniforms",value:function(Ee){var We={};return he()(Ee.blurRadius)||(We.u_BlurDir=[0,Ee.blurRadius]),We}}]),$}(Js))||fc),hc,gu;function el(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Wc(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?el(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):el(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function sf(C){var ve=sh();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function sh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var Pf=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,n=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,o=(hc=(0,P.b2)(),hc(gu=function(C){Cr($,C);var ve=sf($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:n,fs:Pf});var Ee=this.shaderModuleService.getModule("colorhalftone-pass"),We=Ee.vs,er=Ee.fs,hr=Ee.uniforms,Kt=this.rendererService.getViewportSize(),kr=Kt.width,wn=Kt.height;return{vs:We,fs:er,uniforms:Wc(Wc({},hr),{},{u_ViewportSize:[kr,wn]})}}}]),$}(Js))||gu),i,l;function w(C){var ve=z();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function z(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var j=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,ae=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Se=(i=(0,P.b2)(),i(l=function(C){Cr($,C);var ve=w($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:ae,fs:j}),this.shaderModuleService.getModule("copy-pass")}}]),$}(Js))||l),He,xt;function Et(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Tt(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?Et(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):Et(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function Jt(C){var ve=Yt();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function Yt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var gr=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Vt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,mr=(He=(0,P.b2)(),He(xt=function(C){Cr($,C);var ve=Jt($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Vt,fs:gr});var Ee=this.shaderModuleService.getModule("hexagonalpixelate-pass"),We=Ee.vs,er=Ee.fs,hr=Ee.uniforms,Kt=this.rendererService.getViewportSize(),kr=Kt.width,wn=Kt.height;return{vs:We,fs:er,uniforms:Tt(Tt({},hr),{},{u_ViewportSize:[kr,wn]})}}}]),$}(Js))||xt),Ar,Xr;function cn(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function nn(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?cn(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):cn(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function pn(C){var ve=Bn();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function Bn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var Zn=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Vn=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Si=(Ar=(0,P.b2)(),Ar(Xr=function(C){Cr($,C);var ve=pn($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:Vn,fs:Zn});var Ee=this.shaderModuleService.getModule("ink-pass"),We=Ee.vs,er=Ee.fs,hr=Ee.uniforms,Kt=this.rendererService.getViewportSize(),kr=Kt.width,wn=Kt.height;return{vs:We,fs:er,uniforms:nn(nn({},hr),{},{u_ViewportSize:[kr,wn]})}}}]),$}(Js))||Xr),Zi,ca;function ma(C){var ve=Co();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function Co(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var Pi=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Ha=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ma=(Zi=(0,P.b2)(),Zi(ca=function(C){Cr($,C);var ve=ma($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:Ha,fs:Pi}),this.shaderModuleService.getModule("noise-pass")}}]),$}(Js))||ca),Ba,Ea;function oo(C){var ve=Pa();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var Aa=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,eu=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,As=(Ba=(0,P.b2)(),Ba(Ea=function(C){Cr($,C);var ve=oo($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Aa,fs:eu}),this.shaderModuleService.getModule("sepia-pass")}}]),$}(Js))||Ea),tu,Ls,Ho,xs,zs,yu,Xc=(tu=(0,P.b2)(),Ls=(0,P.f3)(O.IRendererService),Ho=(0,P.zY)(),tu(xs=(zs=function(){function C(){D(this,C),On(this,"rendererService",yu,this),N(this,"passes",[]),N(this,"readFBO",void 0),N(this,"writeFBO",void 0)}return V(C,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var $=this.rendererService,ee=$.getViewportSize,Ee=$.createTexture2D,We=ee(),er=We.width,hr=We.height;return Ee({x:0,y:0,width:er,height:hr,copy:!0})}},{key:"getReadFBOTex",value:function(){var $=this,ee=this.rendererService.useFramebuffer;return new Promise(function(Ee,We){ee($.readFBO,Ia(uo().mark(function er(){return uo().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:Ee($.getCurrentFBOTex());case 1:case"end":return Kt.stop()}},er)})))})}},{key:"renderBloomPass",value:function(){var ve=Ia(uo().mark(function ee(Ee,We){var er,hr;return uo().wrap(function(kr){for(;;)switch(kr.prev=kr.next){case 0:return kr.next=2,this.getReadFBOTex();case 2:er=kr.sent,hr=0;case 4:if(!(hr<4)){kr.next=11;break}return kr.next=7,We.render(Ee,er);case 7:this.swap(),hr++,kr.next=4;break;case 11:case"end":return kr.stop()}},ee,this)}));function $(ee,Ee){return ve.apply(this,arguments)}return $}()},{key:"render",value:function(){var ve=Ia(uo().mark(function ee(Ee){var We,er;return uo().wrap(function(Kt){for(;;)switch(Kt.prev=Kt.next){case 0:We=0;case 1:if(!(We<this.passes.length)){Kt.next=15;break}if(er=this.passes[We],er.setRenderToScreen(this.isLastEnabledPass(We)),er.getName()!=="bloom"){Kt.next=9;break}return Kt.next=7,this.renderBloomPass(Ee,er);case 7:Kt.next=12;break;case 9:return Kt.next=11,er.render(Ee);case 11:We!==this.passes.length-1&&this.swap();case 12:We++,Kt.next=1;break;case 15:case"end":return Kt.stop()}},ee,this)}));function $(ee){return ve.apply(this,arguments)}return $}()},{key:"resize",value:function($,ee){this.readFBO.resize({width:$,height:ee}),this.writeFBO.resize({width:$,height:ee})}},{key:"add",value:function($,ee,Ee){$.init(ee,Ee),this.passes.push($)}},{key:"insert",value:function($,ee,Ee,We){$.init(Ee,We),this.passes.splice(ee,0,$)}},{key:"getPostProcessingPassByName",value:function($){return this.passes.find(function(ee){return ee.getName()===$})}},{key:"init",value:function(){var $=this.rendererService,ee=$.createFramebuffer,Ee=$.createTexture2D;this.readFBO=ee({color:Ee({width:1,height:1,wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})}),this.writeFBO=ee({color:Ee({width:1,height:1,wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function($){for(var ee=$+1;ee<this.passes.length;ee++)if(this.passes[ee].isEnabled())return!1;return!0}},{key:"swap",value:function(){var $=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=$}}]),C}(),yu=Pr(zs.prototype,"rendererService",[Ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pr(zs.prototype,"init",[Ho],Object.getOwnPropertyDescriptor(zs.prototype,"init"),zs.prototype),zs))||xs),ou,su;function Fs(C){var ve=uf();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function uf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var tl=(ou=(0,P.b2)(),ou(su=function(C){Cr($,C);var ve=Fs($);function $(){return D(this,$),ve.apply(this,arguments)}return V($,[{key:"getType",value:function(){return Sl.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Ee,We){Hl(Ye($.prototype),"init",this).call(this,Ee,We)}},{key:"render",value:function(Ee){var We=this.rendererService,er=We.useFramebuffer,hr=We.clear,Kt=Ee.multiPassRenderer.getPostProcessor().getReadFBO();er(Kt,function(){hr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Kt}),Ee.multiPassRenderer.setRenderFlag(!1),Ee.models.forEach(function(kr){kr.draw({uniforms:Ee.layerModel.getUninforms()})}),Ee.multiPassRenderer.setRenderFlag(!0)})}}]),$}(Gc))||su),Ol,wc,Mc,Us,Yc;function Il(C,ve){var $=Object.keys(C);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(C);ve&&(ee=ee.filter(function(Ee){return Object.getOwnPropertyDescriptor(C,Ee).enumerable})),$.push.apply($,ee)}return $}function Bs(C){for(var ve=1;ve<arguments.length;ve++){var $=arguments[ve]!=null?arguments[ve]:{};ve%2?Il(Object($),!0).forEach(function(ee){N(C,ee,$[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors($)):Il(Object($)).forEach(function(ee){Object.defineProperty(C,ee,Object.getOwnPropertyDescriptor($,ee))})}return C}function pc(C){var ve=dc();return function(){var ee=Ye(C),Ee;if(ve){var We=Ye(this).constructor;Ee=Reflect.construct(ee,arguments,We)}else Ee=ee.apply(this,arguments);return nt(this,Ee)}}function dc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(C){return!1}}var ql=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,Uo=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,rl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function uu(C,ve){for(var $=0,ee=1/ve,Ee=C;Ee>0;)$=$+ee*(Ee%ve),Ee=Math.floor(Ee/ve),ee=ee/ve;return $}var vc=1,jf=(Ol=(0,P.b2)(),wc=(0,P.f3)(O.IShaderModuleService),Ol(Mc=(Us=function(C){Cr($,C);var ve=pc($);function $(){var ee;D(this,$);for(var Ee=arguments.length,We=new Array(Ee),er=0;er<Ee;er++)We[er]=arguments[er];return ee=ve.call.apply(ve,[this].concat(We)),On(mt(ee),"shaderModuleService",Yc,mt(ee)),N(mt(ee),"haltonSequence",[]),N(mt(ee),"accumulatingId",0),N(mt(ee),"frame",0),N(mt(ee),"timer",void 0),N(mt(ee),"sampleRenderTarget",void 0),N(mt(ee),"prevRenderTarget",void 0),N(mt(ee),"outputRenderTarget",void 0),N(mt(ee),"copyRenderTarget",void 0),N(mt(ee),"blendModel",void 0),N(mt(ee),"outputModel",void 0),N(mt(ee),"copyModel",void 0),ee}return V($,[{key:"getType",value:function(){return Sl.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Ee,We){Hl(Ye($.prototype),"init",this).call(this,Ee,We);var er=this.rendererService,hr=er.createFramebuffer,Kt=er.createTexture2D;this.sampleRenderTarget=hr({color:Kt({width:1,height:1,wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})}),this.prevRenderTarget=hr({color:Kt({width:1,height:1,wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})}),this.outputRenderTarget=hr({color:Kt({width:1,height:1,wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})}),this.copyRenderTarget=hr({color:Kt({width:1,height:1,wrapS:ua.CLAMP_TO_EDGE,wrapT:ua.CLAMP_TO_EDGE})});for(var kr=0;kr<30;kr++)this.haltonSequence.push([uu(kr,2),uu(kr,3)]);this.blendModel=this.createTriangleModel("blend-pass",ql),this.outputModel=this.createTriangleModel("copy-pass",Uo,{blend:{enable:!0,func:{srcRGB:ua.ONE,dstRGB:ua.ONE_MINUS_SRC_ALPHA,srcAlpha:ua.ONE,dstAlpha:ua.ONE_MINUS_SRC_ALPHA},equation:{rgb:ua.FUNC_ADD,alpha:ua.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Uo)}},{key:"render",value:function(Ee){var We=this,er=this.rendererService,hr=er.clear,Kt=er.getViewportSize,kr=er.useFramebuffer,wn=Kt(),Ai=wn.width,Hi=wn.height;this.sampleRenderTarget.resize({width:Ai,height:Hi}),this.prevRenderTarget.resize({width:Ai,height:Hi}),this.outputRenderTarget.resize({width:Ai,height:Hi}),this.copyRenderTarget.resize({width:Ai,height:Hi}),this.resetFrame(),this.stopAccumulating();var $i=Ee.multiPassRenderer.getPostProcessor().getReadFBO();kr($i,function(){hr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:$i}),Ee.multiPassRenderer.setRenderFlag(!1),Ee.render(),Ee.multiPassRenderer.setRenderFlag(!0)});var R=function m(u){!We.accumulatingId||u!==We.accumulatingId||We.isFinished()||(We.doRender(Ee),Y.$window.requestAnimationFrame(function(){m(u)}))};this.accumulatingId=vc++,this.timer=Y.$window.setTimeout(function(){R(We.accumulatingId)},50)}},{key:"doRender",value:function(Ee){var We=this,er=this.rendererService,hr=er.clear,Kt=er.getViewportSize,kr=er.useFramebuffer,wn=Kt(),Ai=wn.width,Hi=wn.height,$i=Ee.getLayerConfig(),R=$i.jitterScale,m=R===void 0?1:R,u=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((u[0]*2-1)/Ai*m,(u[1]*2-1)/Hi*m),Ee.multiPassRenderer.setRenderFlag(!1),Ee.hooks.beforeRender.call(),kr(this.sampleRenderTarget,function(){hr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:We.sampleRenderTarget}),Ee.render()}),Ee.hooks.afterRender.call(),Ee.multiPassRenderer.setRenderFlag(!0);var _=Ee.getLayerConfig();kr(this.outputRenderTarget,function(){We.blendModel.draw({uniforms:{u_opacity:_.opacity||1,u_MixRatio:We.frame===0?1:.9,u_Diffuse1:We.sampleRenderTarget,u_Diffuse2:We.frame===0?Ee.multiPassRenderer.getPostProcessor().getReadFBO():We.prevRenderTarget}})}),this.frame===0&&hr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(kr(this.copyRenderTarget,function(){We.outputModel.draw({uniforms:{u_Texture:We.outputRenderTarget}})}),kr(Ee.multiPassRenderer.getPostProcessor().getReadFBO(),function(){We.copyModel.draw({uniforms:{u_Texture:We.copyRenderTarget}})}),Ee.multiPassRenderer.getPostProcessor().render(Ee));var b=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=b,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,Y.$window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Ee,We,er){this.shaderModuleService.registerModule(Ee,{vs:rl,fs:We});var hr=this.shaderModuleService.getModule(Ee),Kt=hr.vs,kr=hr.fs,wn=hr.uniforms,Ai=this.rendererService,Hi=Ai.createAttribute,$i=Ai.createBuffer,R=Ai.createModel;return R(Bs({vs:Kt,fs:kr,attributes:{a_Position:Hi({buffer:$i({data:[-4,-4,4,-4,0,4],type:ua.FLOAT}),size:2})},uniforms:Bs({},wn),depth:{enable:!1},count:3},er))}}]),$}(Gc),Yc=Pr(Us.prototype,"shaderModuleService",[wc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us))||Mc),Pc=new P.W2;Pc.bind(O.IGlobalConfigService).to(hi).inSingletonScope(),(0,P.GW)((0,P.b2)(),Z.EventEmitter),Pc.bind(O.IEventEmitter).to(Z.EventEmitter);var Lf=(0,L.Z)(Pc,!1),Rl=function(ve){var $=Lf.lazyInject(ve);return function(ee,Ee,We){$.call(this,ee,Ee),We&&(We.initializer=function(){return ee[Ee]})}},Du=function(ve){var $=Lf.lazyMultiInject(ve);return function(ee,Ee,We){$.call(this,ee,Ee),We&&(We.initializer=function(){return ee[Ee]})}},ku=Pc,Lc=0;function lf(){var C=new P.W2;return C.parent=Pc,C.bind(O.SceneID).toConstantValue("".concat(Lc++)),C.bind(O.IShaderModuleService).to(yh).inSingletonScope(),C.bind(O.ILayerService).to(Yo).inSingletonScope(),C.bind(O.ISceneService).to(ko).inSingletonScope(),C.bind(O.ICameraService).to(Ur).inSingletonScope(),C.bind(O.ICoordinateSystemService).to(Rn).inSingletonScope(),C.bind(O.IInteractionService).to(rs).inSingletonScope(),C.bind(O.IPickingService).to(Ot).inSingletonScope(),C.bind(O.IControlService).to($r).inSingletonScope(),C.bind(O.IMarkerService).to(ne).inSingletonScope(),C.bind(O.IIconService).to(ht).inSingletonScope(),C.bind(O.IFontService).to(Bt).inSingletonScope(),C.bind(O.IPopupService).to(je).inSingletonScope(),C.bind(O.INormalPass).to(Vc).whenTargetNamed("clear"),C.bind(O.INormalPass).to(zf).whenTargetNamed("pixelPicking"),C.bind(O.INormalPass).to(tl).whenTargetNamed("render"),C.bind(O.INormalPass).to(jf).whenTargetNamed("taa"),C.bind(O.IFactoryNormalPass).toFactory(function(ve){return function($){return ve.container.getNamed(O.INormalPass,$)}}),C.bind(O.IPostProcessingPass).to(Se).whenTargetNamed("copy"),C.bind(O.IPostProcessingPass).to(sc).whenTargetNamed("bloom"),C.bind(O.IPostProcessingPass).to(cc).whenTargetNamed("blurH"),C.bind(O.IPostProcessingPass).to(Kl).whenTargetNamed("blurV"),C.bind(O.IPostProcessingPass).to(Ma).whenTargetNamed("noise"),C.bind(O.IPostProcessingPass).to(As).whenTargetNamed("sepia"),C.bind(O.IPostProcessingPass).to(o).whenTargetNamed("colorHalftone"),C.bind(O.IPostProcessingPass).to(mr).whenTargetNamed("hexagonalPixelate"),C.bind(O.IPostProcessingPass).to(Si).whenTargetNamed("ink"),C.bind(O.IFactoryPostProcessingPass).toFactory(function(ve){return function($){var ee=ve.container.getNamed(O.IPostProcessingPass,$);return ee.setName($),ee}}),C}function Oc(C){var ve=new P.W2;return ve.parent=C,ve.bind(O.IStyleAttributeService).to(Po).inSingletonScope(),ve.bind(O.IMultiPassRenderer).to(_s).inSingletonScope(),ve.bind(O.IPostProcessor).to(Xc).inSingletonScope(),ve}var hu=y(74691),bf=y.n(hu),Gf=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Kf(C){return Gf.indexOf(C)}var Ef=2,Cf=4,_h=64,$c=128,Of=256,If=512,Rf=8192,dl=16384,uh=32768,xh=null,qf=131072,Vf=262144,bh=524288,gp=1048576,lh=2097152,Gh=4194304,Ph=8388608,ch=16777216,Fu=null;function Dl(C,ve){return C=bf()(Math.floor(C),0,255),ve=bf()(Math.floor(ve),0,255),256*C+ve}function ns(C){var ve=C.color,$=C.radius,ee=C.tileX,Ee=C.tileY,We=C.shape,er=C.opacity,hr=C.stroke,Kt=C.strokeWidth,kr=C.strokeOpacity,wn=[],Ai=[],Hi=[],$i=[Dl(ve[0],ve[1]),Dl(ve[2],ve[3])],R=[Dl(hr[0],hr[1]),Dl(hr[2],hr[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m){var u=gt(m,2),_=u[0],b=u[1];wn.push([].concat($i,[(_+1)*Ph+(b+1)*lh+Kf(We)*qf+$,(ee+512)*bh+(Ee+512)*_h])),Ai.push([].concat(R,[Kt,kr])),Hi.push([er,0,0,0])}),{packedBuffer:wn,packedBuffer2:Ai,packedBuffer3:Hi}}function Qf(C,ve){if(C===0&&!ve)return 0;if(C===1&&ve)return 4294967295;var $=ve?1:0,ee=Math.floor(C*127);return ee*Fu+$*ch+ee*qf+$*xh+ee*If+$*Of+ee*Ef+$}var Df;(function(C){C.normal="normal",C.additive="additive",C.subtractive="subtractive",C.min="min",C.max="max",C.none="none"})(Df||(Df={}));var Hf;(function(C){C.LINEAR="linear",C.POWER="power",C.LOG="log",C.IDENTITY="identity",C.TIME="time",C.QUANTILE="quantile",C.QUANTIZE="quantize",C.THRESHOLD="threshold",C.CAT="cat"})(Hf||(Hf={}));var Wf;(function(C){C.CONSTANT="constant",C.VARIABLE="variable"})(Wf||(Wf={}));var Kc;(function(C){C[C.Attribute=0]="Attribute",C[C.InstancedAttribute=1]="InstancedAttribute",C[C.Uniform=2]="Uniform"})(Kc||(Kc={}));var kf=["mapload","mapchange","mapAfterFrameChange"],qc={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},Qc=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],Ic;(function(C){C.TOPRIGHT="topright",C.TOPLEFT="topleft",C.BOTTOMRIGHT="bottomright",C.BOTTOMLEFT="bottomleft",C.TOPCENTER="topcenter",C.BOTTOMCENTER="bottomcenter",C.LEFTCENTER="leftcenter",C.RIGHTCENTER="rightcenter"})(Ic||(Ic={}))},74360:function(Ft,A,y){Ft.exports=y(17445)},46090:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return M}});function v(W,ue,X,ie,ye,J,ht){try{var ze=W[J](ht),pt=ze.value}catch(Me){X(Me);return}ze.done?ue(pt):Promise.resolve(pt).then(ie,ye)}function Z(W){return function(){var ue=this,X=arguments;return new Promise(function(ie,ye){var J=W.apply(ue,X);function ht(pt){v(J,ie,ye,ht,ze,"next",pt)}function ze(pt){v(J,ie,ye,ht,ze,"throw",pt)}ht(void 0)})}}var a=y(83221),P=y(32840),L=y(8842),O=y(20637),D=y(23845),B=y(49651),V=y(58115),N=y(89866),Y=y(47634),H=y(51747),ce=y(52353),at=y.n(ce),rt=y(13218),Re=y.n(rt),vt=y(23560),wt=y.n(vt),fe=y(47507),$e=y.n(fe),re=y(46343),Ge=y(39128),Qe=y(96090),Te=y(86049),Le=y(26729),Ce=y(9868),Fe=y(47037),Ke=y.n(Fe),qt=y(81763),ir=y.n(qt),Pe=1024;function Ne(W,ue,X,ie,ye){ue.updateStyleAttribute(W,X,ie,ye)}function Xe(W,ue){W.opacity&&kt("opacity",ue,W.opacity),W.strokeWidth&&kt("strokeWidth",ue,W.strokeWidth),W.strokeOpacity&&kt("strokeOpacity",ue,W.strokeOpacity),W.stroke&&me("stroke",ue,W.stroke),W.offsets&&rr("offsets",ue,W.offsets),W.textOffset&&rr("textOffset",ue,W.textOffset),W.thetaOffset&&kt("thetaOffset",ue,W.thetaOffset)}function kt(W,ue,X){Ke()(X)?Ne(W,ue,X,function(ie){return ie}):ir()(X)?Ne(W,ue,[X],void 0):Array.isArray(X)&&X.length===2?Ke()(X[0])&&wt()(X[1])||Ke()(X[0])&&Array.isArray(X[1])&&ir()(X[1][0])&&ir()(X[1][1])?Ne(W,ue,X[0],X[1]):Ne(W,ue,[1],void 0):Ne(W,ue,[1],void 0)}function rr(W,ue,X){Ke()(X)?Ne(W,ue,X,function(ie){return ie}):Array.isArray(X)&&X.length===2&&Ke()(X[0])&&wt()(X[1])?Ne(W,ue,X[0],X[1]):Array.isArray(X)&&X.length===2&&ir()(X[0])&&ir()(X[1])?Ne(W,ue,X,void 0):Ne(W,ue,[0,0],void 0)}function me(W,ue,X){Ke()(X)?Ne(W,ue,X,void 0):Array.isArray(X)&&X.length===2&&(Ke()(X[0])&&wt()(X[1])||Ke()(X[0])&&Array.isArray(X[1])&&X[1].length>0)?Ne(W,ue,X[0],X[1]):Ne(W,ue,"#fff",void 0)}var et=y(32271),or=[["circle","cylinder"],["square","cylinder"],["triangle","cylinder"],["pentagon","cylinder"],["hexagon","cylinder"],["octogon","cylinder"],["hexagram","cylinder"],["rhombus","cylinder"],["vesica","cylinder"]];function on(W,ue,X){if(typeof ue=="string"&&typeof X=="string"&&ue!==X){if(W.type==="PointLayer"){W.dataState.dataSourceNeedUpdate=!0;return}or.map(function(ie){if(ie.includes(ue)&&ie.includes(X)){W.dataState.dataSourceNeedUpdate=!0;return}})}}var vr=["passes"],jr=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber"],xr,Ae,De;function ke(W,ue){var X=typeof Symbol!="undefined"&&W[Symbol.iterator]||W["@@iterator"];if(!X){if(Array.isArray(W)||(X=Bt(W))||ue&&W&&typeof W.length=="number"){X&&(W=X);var ie=0,ye=function(){};return{s:ye,n:function(){return ie>=W.length?{done:!0}:{done:!1,value:W[ie++]}},e:function(Me){throw Me},f:ye}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var J=!0,ht=!1,ze;return{s:function(){X=X.call(W)},n:function(){var Me=X.next();return J=Me.done,Me},e:function(Me){ht=!0,ze=Me},f:function(){try{!J&&X.return!=null&&X.return()}finally{if(ht)throw ze}}}}function Bt(W,ue){if(!!W){if(typeof W=="string")return mt(W,ue);var X=Object.prototype.toString.call(W).slice(8,-1);if(X==="Object"&&W.constructor&&(X=W.constructor.name),X==="Map"||X==="Set")return Array.from(W);if(X==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(X))return mt(W,ue)}}function mt(W,ue){(ue==null||ue>W.length)&&(ue=W.length);for(var X=0,ie=new Array(ue);X<ue;X++)ie[X]=W[X];return ie}function Mr(W,ue){var X=Object.keys(W);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(W);ue&&(ie=ie.filter(function(ye){return Object.getOwnPropertyDescriptor(W,ye).enumerable})),X.push.apply(X,ie)}return X}function Cr(W){for(var ue=1;ue<arguments.length;ue++){var X=arguments[ue]!=null?arguments[ue]:{};ue%2?Mr(Object(X),!0).forEach(function(ie){(0,Y.Z)(W,ie,X[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(X)):Mr(Object(X)).forEach(function(ie){Object.defineProperty(W,ie,Object.getOwnPropertyDescriptor(X,ie))})}return W}function Nr(W){var ue=nt();return function(){var ie=(0,N.Z)(W),ye;if(ue){var J=(0,N.Z)(this).constructor;ye=Reflect.construct(ie,arguments,J)}else ye=ie.apply(this,arguments);return(0,V.Z)(this,ye)}}function nt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(W){return!1}}var Ye=0,M=(xr=(0,Ge.lazyInject)(Ge.TYPES.IGlobalConfigService),Ae=function(W){(0,B.Z)(X,W);var ue=Nr(X);function X(){var ie,ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,L.Z)(this,X),ie=ue.call(this),(0,Y.Z)((0,D.Z)(ie),"id","".concat(Ye++)),(0,Y.Z)((0,D.Z)(ie),"name","".concat(Ye)),(0,Y.Z)((0,D.Z)(ie),"type",void 0),(0,Y.Z)((0,D.Z)(ie),"visible",!0),(0,Y.Z)((0,D.Z)(ie),"zIndex",0),(0,Y.Z)((0,D.Z)(ie),"minZoom",void 0),(0,Y.Z)((0,D.Z)(ie),"maxZoom",void 0),(0,Y.Z)((0,D.Z)(ie),"inited",!1),(0,Y.Z)((0,D.Z)(ie),"layerModelNeedUpdate",!1),(0,Y.Z)((0,D.Z)(ie),"pickedFeatureID",null),(0,Y.Z)((0,D.Z)(ie),"selectedFeatureID",null),(0,Y.Z)((0,D.Z)(ie),"styleNeedUpdate",!1),(0,Y.Z)((0,D.Z)(ie),"rendering",void 0),(0,Y.Z)((0,D.Z)(ie),"clusterZoom",0),(0,Y.Z)((0,D.Z)(ie),"layerType",void 0),(0,Y.Z)((0,D.Z)(ie),"isLayerGroup",!1),(0,Y.Z)((0,D.Z)(ie),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,Y.Z)((0,D.Z)(ie),"hooks",{init:new re.oI,afterInit:new re.oI,beforeRender:new re.oI,beforeRenderData:new re.gg,afterRender:new re.ni,beforePickingEncode:new re.ni,afterPickingEncode:new re.ni,beforeHighlight:new re.ni(["pickedColor"]),afterHighlight:new re.ni,beforeSelect:new re.ni(["pickedColor"]),afterSelect:new re.ni,beforeDestroy:new re.ni,afterDestroy:new re.ni}),(0,Y.Z)((0,D.Z)(ie),"models",[]),(0,Y.Z)((0,D.Z)(ie),"multiPassRenderer",void 0),(0,Y.Z)((0,D.Z)(ie),"plugins",void 0),(0,Y.Z)((0,D.Z)(ie),"sourceOption",void 0),(0,Y.Z)((0,D.Z)(ie),"layerModel",void 0),(0,Y.Z)((0,D.Z)(ie),"shapeOption",void 0),(0,Y.Z)((0,D.Z)(ie),"sceneContainer",void 0),(0,Y.Z)((0,D.Z)(ie),"layerChildren",[]),(0,Y.Z)((0,D.Z)(ie),"masks",[]),(0,P.Z)((0,D.Z)(ie),"configService",De,(0,D.Z)(ie)),(0,Y.Z)((0,D.Z)(ie),"shaderModuleService",void 0),(0,Y.Z)((0,D.Z)(ie),"cameraService",void 0),(0,Y.Z)((0,D.Z)(ie),"coordinateService",void 0),(0,Y.Z)((0,D.Z)(ie),"iconService",void 0),(0,Y.Z)((0,D.Z)(ie),"fontService",void 0),(0,Y.Z)((0,D.Z)(ie),"pickingService",void 0),(0,Y.Z)((0,D.Z)(ie),"rendererService",void 0),(0,Y.Z)((0,D.Z)(ie),"layerService",void 0),(0,Y.Z)((0,D.Z)(ie),"interactionService",void 0),(0,Y.Z)((0,D.Z)(ie),"mapService",void 0),(0,Y.Z)((0,D.Z)(ie),"styleAttributeService",void 0),(0,Y.Z)((0,D.Z)(ie),"layerSource",void 0),(0,Y.Z)((0,D.Z)(ie),"postProcessingPassFactory",void 0),(0,Y.Z)((0,D.Z)(ie),"normalPassFactory",void 0),(0,Y.Z)((0,D.Z)(ie),"animateOptions",{enable:!1}),(0,Y.Z)((0,D.Z)(ie),"container",void 0),(0,Y.Z)((0,D.Z)(ie),"encodedData",void 0),(0,Y.Z)((0,D.Z)(ie),"configSchema",void 0),(0,Y.Z)((0,D.Z)(ie),"currentPickId",null),(0,Y.Z)((0,D.Z)(ie),"rawConfig",void 0),(0,Y.Z)((0,D.Z)(ie),"needUpdateConfig",void 0),(0,Y.Z)((0,D.Z)(ie),"pendingStyleAttributes",[]),(0,Y.Z)((0,D.Z)(ie),"scaleOptions",{}),(0,Y.Z)((0,D.Z)(ie),"animateStartTime",void 0),(0,Y.Z)((0,D.Z)(ie),"aniamateStatus",!1),(0,Y.Z)((0,D.Z)(ie),"bottomColor","rgba(0, 0, 0, 0)"),(0,Y.Z)((0,D.Z)(ie),"isDestroied",!1),(0,Y.Z)((0,D.Z)(ie),"sourceEvent",function(){ie.dataState.dataSourceNeedUpdate=!0;var J=ie.getLayerConfig(),ht=J.autoFit,ze=J.fitBoundsOptions;ht&&ie.fitBounds(ze),ie.reRender()}),ie.name=ye.name||ie.id,ie.zIndex=ye.zIndex||0,ie.rawConfig=ye,ie}return(0,O.Z)(X,[{key:"addMaskLayer",value:function(ye){this.masks.push(ye)}},{key:"removeMaskLayer",value:function(ye){var J=this.masks.indexOf(ye);J>-1&&this.masks.splice(J,1),ye.destroy()}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(ye){if(!this.inited)this.needUpdateConfig=Cr(Cr({},this.needUpdateConfig),ye);else{var J=this.container.get(Ge.TYPES.SceneID);Xe(ye,this),this.configService.setLayerConfig(J,this.id,Cr(Cr(Cr({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),ye)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(ye,J){this.container=ye,this.sceneContainer=J}},{key:"getContainer",value:function(){return this.container}},{key:"setBottomColor",value:function(ye){this.bottomColor=ye}},{key:"getBottomColor",value:function(){return this.bottomColor}},{key:"addPlugin",value:function(ye){return this.plugins.push(ye),this}},{key:"init",value:function(){var ye=this,J=this.container.get(Ge.TYPES.SceneID);this.configService.setLayerConfig(J,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Ge.TYPES.IIconService),this.fontService=this.container.get(Ge.TYPES.IFontService),this.rendererService=this.container.get(Ge.TYPES.IRendererService),this.layerService=this.container.get(Ge.TYPES.ILayerService),this.interactionService=this.container.get(Ge.TYPES.IInteractionService),this.pickingService=this.container.get(Ge.TYPES.IPickingService),this.mapService=this.container.get(Ge.TYPES.IMapService);var ht=this.getLayerConfig(),ze=ht.enableMultiPassRenderer,pt=ht.passes;ze&&pt!==null&&pt!==void 0&&pt.length&&pt.length>0&&this.mapService.on("mapAfterFrameChange",function(){ye.renderLayers()}),this.cameraService=this.container.get(Ge.TYPES.ICameraService),this.coordinateService=this.container.get(Ge.TYPES.ICoordinateSystemService),this.shaderModuleService=this.container.get(Ge.TYPES.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Ge.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Ge.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(Ge.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(Ge.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(gt){var nr=gt.attributeName,pe=gt.attributeField,lr=gt.attributeValues,Ur=gt.updateOptions;ye.styleAttributeService.updateStyleAttribute(nr,{scale:Cr({field:pe},ye.splitValuesAndCallbackInAttribute(lr,ye.getLayerConfig()[nr]))},Ur)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Ge.TYPES.ILayerPlugin);var Me=ke(this.plugins),Ue;try{for(Me.s();!(Ue=Me.n()).done;){var yt=Ue.value;yt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(gt){Me.e(gt)}finally{Me.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(Cr(Cr({},this.getDefaultConfig()),this.rawConfig));var ye=this.getLayerConfig(),J=ye.animateOption;J!=null&&J.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(ye,J,ht){return this.updateStyleAttribute("color",ye,J,ht),this}},{key:"texture",value:function(ye,J,ht){return this.updateStyleAttribute("texture",ye,J,ht),this}},{key:"rotate",value:function(ye,J,ht){return this.updateStyleAttribute("rotate",ye,J,ht),this}},{key:"size",value:function(ye,J,ht){return this.updateStyleAttribute("size",ye,J,ht),this}},{key:"filter",value:function(ye,J,ht){return this.updateStyleAttribute("filter",ye,J,ht),this}},{key:"shape",value:function(ye,J,ht){var ze,pt,Me,Ue=(ze=this.styleAttributeService)===null||ze===void 0||(pt=ze.getLayerStyleAttribute("shape"))===null||pt===void 0||(Me=pt.scale)===null||Me===void 0?void 0:Me.field,yt=ye;return this.shapeOption={field:ye,values:J},this.updateStyleAttribute("shape",ye,J,ht),on(this,Ue,yt),this}},{key:"label",value:function(ye,J,ht){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:ye,attributeValues:J,updateOptions:ht}),this}},{key:"animate",value:function(ye){var J={};return Re()(ye)?(J.enable=!0,J=Cr(Cr({},J),ye)):J.enable=ye,this.updateLayerConfig({animateOption:J}),this}},{key:"source",value:function(ye,J){return ye!=null&&ye.data?(this.setSource(ye),this):(this.sourceOption={data:ye,options:J},this.clusterZoom=0,this)}},{key:"setData",value:function(ye,J){var ht=this;return this.inited?this.layerSource.setData(ye,J):this.on("inited",function(){var ze=ht.getSource();ze?ht.layerSource.setData(ye,J):(ht.source(new Qe.default(ye,J)),ht.sourceEvent())}),this}},{key:"style",value:function(ye){var J=this,ht=this.getLayerConfig(),ze=ye.passes,pt=(0,a.Z)(ye,vr);return ze&&(0,et.E)(ze).forEach(function(Me){var Ue=J.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(Me[0]);Ue&&Ue.updateOptions(Me[1])}),this.rawConfig=Cr(Cr({},this.rawConfig),pt),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),ht&&ht.mask===!0&&ye.mask===!1&&(this.clearModels(),this.models=this.layerModel.buildModels()),this}},{key:"scale",value:function(ye,J){return Re()(ye)?this.scaleOptions=Cr(Cr({},this.scaleOptions),ye):this.scaleOptions[ye]=J,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.getEncodedData().length!==0&&this.renderModels(),this}},{key:"renderMultiPass",value:function(){var ie=Z($e().mark(function J(){return $e().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(this.getEncodedData().length===0){ze.next=7;break}if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){ze.next=6;break}return ze.next=4,this.multiPassRenderer.render();case 4:ze.next=7;break;case 6:this.multiPassRenderer?this.renderModels():this.renderModels();case 7:case"end":return ze.stop()}},J,this)}));function ye(){return ie.apply(this,arguments)}return ye}()},{key:"active",value:function(ye){var J={};return J.enableHighlight=Re()(ye)?!0:ye,Re()(ye)?(J.enableHighlight=!0,ye.color&&(J.highlightColor=ye.color),ye.mix&&(J.activeMix=ye.mix)):J.enableHighlight=!!ye,this.updateLayerConfig(J),this}},{key:"setActive",value:function(ye,J){var ht=this;if(Re()(ye)){var ze=ye.x,pt=ze===void 0?0:ze,Me=ye.y,Ue=Me===void 0?0:Me;this.updateLayerConfig({highlightColor:Re()(J)?J.color:this.getLayerConfig().highlightColor,activeMix:Re()(J)?J.mix:this.getLayerConfig().activeMix}),this.pick({x:pt,y:Ue})}else this.updateLayerConfig({pickedFeatureID:ye,highlightColor:Re()(J)?J.color:this.getLayerConfig().highlightColor,activeMix:Re()(J)?J.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call((0,Te.encodePickingColor)(ye)).then(function(){setTimeout(function(){ht.reRender()},1)})}},{key:"select",value:function(ye){var J={};return J.enableSelect=Re()(ye)?!0:ye,Re()(ye)?(J.enableSelect=!0,ye.color&&(J.selectColor=ye.color),ye.mix&&(J.selectMix=ye.mix)):J.enableSelect=!!ye,this.updateLayerConfig(J),this}},{key:"setSelect",value:function(ye,J){var ht=this;if(Re()(ye)){var ze=ye.x,pt=ze===void 0?0:ze,Me=ye.y,Ue=Me===void 0?0:Me;this.updateLayerConfig({selectColor:Re()(J)?J.color:this.getLayerConfig().selectColor,selectMix:Re()(J)?J.mix:this.getLayerConfig().selectMix}),this.pick({x:pt,y:Ue})}else this.updateLayerConfig({pickedFeatureID:ye,selectColor:Re()(J)?J.color:this.getLayerConfig().selectColor,selectMix:Re()(J)?J.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call((0,Te.encodePickingColor)(ye)).then(function(){setTimeout(function(){ht.reRender()},1)})}},{key:"setBlend",value:function(ye){return this.updateLayerConfig({blend:ye}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(ye){return this.zIndex=ye,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(ye){this.currentPickId=ye}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(ye){this.selectedFeatureID=ye}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var ye=this.mapService.getZoom(),J=this.getLayerConfig(),ht=J.visible,ze=J.minZoom,pt=ze===void 0?-Infinity:ze,Me=J.maxZoom,Ue=Me===void 0?Infinity:Me;return!!ht&&ye>=pt&&ye<=Ue}},{key:"setMultiPass",value:function(ye,J){if(this.updateLayerConfig({enableMultiPassRenderer:ye}),J&&this.updateLayerConfig({passes:J}),ye){var ht=this.getLayerConfig(),ze=ht.passes,pt=ze===void 0?[]:ze;this.multiPassRenderer=(0,et.N)(this,pt,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var Me=this.rendererService.getViewportSize(),Ue=Me.width,yt=Me.height;this.multiPassRenderer.resize(Ue,yt)}return this}},{key:"setMinZoom",value:function(ye){return this.updateLayerConfig({minZoom:ye}),this}},{key:"getMinZoom",value:function(){var ye=this.getLayerConfig(),J=ye.minZoom;return J}},{key:"getMaxZoom",value:function(){var ye=this.getLayerConfig(),J=ye.maxZoom;return J}},{key:"get",value:function(ye){var J=this.getLayerConfig();return J[ye]}},{key:"setMaxZoom",value:function(ye){return this.updateLayerConfig({maxZoom:ye}),this}},{key:"setAutoFit",value:function(ye){return this.updateLayerConfig({autoFit:ye}),this}},{key:"fitBounds",value:function(ye){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var J=this.getSource(),ht=J.extent,ze=ht.some(function(pt){return Math.abs(pt)===Infinity});return ze?this:(this.mapService.fitBounds([[ht[0],ht[1]],[ht[2],ht[3]]],ye),this)}},{key:"destroy",value:function(){var ye;this.isDestroied||(this.layerChildren.map(function(J){return J.destroy()}),this.layerChildren=[],this.masks.map(function(J){return J.destroy()}),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(ye=this.layerModel)===null||ye===void 0||ye.clearModels(),this.models=[],this.layerService.cleanRemove(this),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroied=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(ye){return ye.destroy()}),this.layerModel.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(ye){return ye.needRescale||ye.needRemapping||ye.needRegenerateVertices}).length}},{key:"setSource",value:function(ye){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=ye,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var J=this.mapService.getZoom();this.layerSource.updateClusterData(J)}this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(ye){this.encodedData=ye}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(ye){return this.styleAttributeService.getLayerAttributeScale(ye)}},{key:"getLegendItems",value:function(ye){var J=this.styleAttributeService.getLayerAttributeScale(ye);if(!J)return[];if(J.invertExtent){var ht=J.range().map(function(Me){return(0,Y.Z)({value:J.invertExtent(Me)},ye,Me)});return ht}else if(J.ticks){var ze=J.ticks().map(function(Me){return(0,Y.Z)({value:Me},ye,J(Me))});return ze}else if(J!=null&&J.domain){var pt=J.domain().filter(function(Me){return!at()(Me)}).map(function(Me){return(0,Y.Z)({value:Me},ye,J(Me))});return pt}return[]}},{key:"pick",value:function(ye){var J=ye.x,ht=ye.y;this.interactionService.triggerHover({x:J,y:ht})}},{key:"boxSelect",value:function(ye,J){this.pickingService.boxPickLayer(this,ye,J)}},{key:"buildLayerModel",value:function(ye){var J=ye.moduleName,ht=ye.vertexShader,ze=ye.fragmentShader,pt=ye.triangulation,Me=ye.segmentNumber,Ue=(0,a.Z)(ye,jr);this.shaderModuleService.registerModule(J,{vs:ht,fs:ze});var yt=this.shaderModuleService.getModule(J),gt=yt.vs,nr=yt.fs,pe=yt.uniforms,lr=this.rendererService.createModel,Ur=this.styleAttributeService.createAttributesAndIndices(this.encodedData,pt,Me),Hr=Ur.attributes,un=Ur.elements;return lr(Cr({attributes:Hr,uniforms:pe,fs:nr,vs:gt,elements:un,blend:Ce.y[Ge.BlendType.normal]},Ue))}},{key:"createAttrubutes",value:function(ye){var J=ye.triangulation,ht=this.styleAttributeService.createAttributes(this.encodedData,J),ze=ht.attributes;return ze}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(ye){var J=this.getLayerConfig(),ht=J.enableHighlight,ze=ht===void 0?!0:ht,pt=J.enableSelect,Me=pt===void 0?!0:pt,Ue=this.eventNames().indexOf(ye)!==-1||this.eventNames().indexOf("un"+ye)!==-1;return(ye==="click"||ye==="dblclick")&&Me&&(Ue=!0),ye==="mousemove"&&(ze||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Ue=!0),this.isVisible()&&Ue}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderMulPass",value:function(){var ie=Z($e().mark(function J(ht){return $e().wrap(function(pt){for(;;)switch(pt.prev=pt.next){case 0:return pt.next=2,ht.render();case 2:case"end":return pt.stop()}},J)}));function ye(J){return ie.apply(this,arguments)}return ye}()},{key:"renderModels",value:function(ye){var J=this;return this.getEncodedData().length>0&&(this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.layerModel.renderUpdate&&this.layerModel.renderUpdate(),this.models.forEach(function(ht){ht.draw({uniforms:J.layerModel.getUninforms()},ye)})),this}},{key:"updateStyleAttribute",value:function(ye,J,ht,ze){this.inited?this.styleAttributeService.updateStyleAttribute(ye,{scale:Cr({field:J},this.splitValuesAndCallbackInAttribute(ht,this.getLayerConfig()[J]))},ze):this.pendingStyleAttributes.push({attributeName:ye,attributeField:J,attributeValues:ht,updateOptions:ze})}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(ye){console.warn("empty fn")}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&(this.layerService.updateLayerRenderList(),this.layerService.renderLayers())}},{key:"splitValuesAndCallbackInAttribute",value:function(ye,J){return{values:wt()(ye)?void 0:ye||J,callback:wt()(ye)?ye:void 0}}}]),X}(Le.EventEmitter),De=(0,H.Z)(Ae.prototype,"configService",[xr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ae)},98422:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return Qe}});var v=y(17553),Z=y(32840),a=y(8842),P=y(20637),L=y(47634),O=y(51747),D=y(47037),B=y.n(D),V=y(81763),N=y.n(V),Y=y(18446),H=y.n(Y),ce=y(39128),at=y(86049),rt=y(2650),Re=y(9868),vt,wt,fe;function $e(Te,Le){var Ce=typeof Symbol!="undefined"&&Te[Symbol.iterator]||Te["@@iterator"];if(!Ce){if(Array.isArray(Te)||(Ce=re(Te))||Le&&Te&&typeof Te.length=="number"){Ce&&(Te=Ce);var Fe=0,Ke=function(){};return{s:Ke,n:function(){return Fe>=Te.length?{done:!0}:{done:!1,value:Te[Fe++]}},e:function(Xe){throw Xe},f:Ke}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var qt=!0,ir=!1,Pe;return{s:function(){Ce=Ce.call(Te)},n:function(){var Xe=Ce.next();return qt=Xe.done,Xe},e:function(Xe){ir=!0,Pe=Xe},f:function(){try{!qt&&Ce.return!=null&&Ce.return()}finally{if(ir)throw Pe}}}}function re(Te,Le){if(!!Te){if(typeof Te=="string")return Ge(Te,Le);var Ce=Object.prototype.toString.call(Te).slice(8,-1);if(Ce==="Object"&&Te.constructor&&(Ce=Te.constructor.name),Ce==="Map"||Ce==="Set")return Array.from(Te);if(Ce==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ce))return Ge(Te,Le)}}function Ge(Te,Le){(Le==null||Le>Te.length)&&(Le=Te.length);for(var Ce=0,Fe=new Array(Le);Ce<Le;Ce++)Fe[Ce]=Te[Ce];return Fe}var Qe=(vt=(0,ce.lazyInject)(ce.TYPES.IGlobalConfigService),wt=function(){function Te(Le){(0,a.Z)(this,Te),(0,L.Z)(this,"triangulation",void 0),(0,L.Z)(this,"createTexture2D",void 0),(0,L.Z)(this,"layer",void 0),(0,L.Z)(this,"dataTexture",void 0),(0,L.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,L.Z)(this,"rowCount",void 0),(0,L.Z)(this,"cacheStyleProperties",void 0),(0,L.Z)(this,"cellLength",void 0),(0,L.Z)(this,"cellProperties",void 0),(0,L.Z)(this,"cellTypeLayout",void 0),(0,L.Z)(this,"stylePropertyesExist",void 0),(0,L.Z)(this,"dataTextureTest",void 0),(0,Z.Z)(this,"configService",fe,this),(0,L.Z)(this,"shaderModuleService",void 0),(0,L.Z)(this,"rendererService",void 0),(0,L.Z)(this,"iconService",void 0),(0,L.Z)(this,"fontService",void 0),(0,L.Z)(this,"styleAttributeService",void 0),(0,L.Z)(this,"mapService",void 0),(0,L.Z)(this,"cameraService",void 0),(0,L.Z)(this,"layerService",void 0),this.layer=Le,this.rendererService=Le.getContainer().get(ce.TYPES.IRendererService),this.shaderModuleService=Le.getContainer().get(ce.TYPES.IShaderModuleService),this.styleAttributeService=Le.getContainer().get(ce.TYPES.IStyleAttributeService),this.mapService=Le.getContainer().get(ce.TYPES.IMapService),this.iconService=Le.getContainer().get(ce.TYPES.IIconService),this.fontService=Le.getContainer().get(ce.TYPES.IFontService),this.cameraService=Le.getContainer().get(ce.TYPES.ICameraService),this.layerService=Le.getContainer().get(ce.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var Ce=this.rendererService.createTexture2D;this.createTexture2D=Ce,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertyesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:ce.gl.NEAREST,min:ce.gl.NEAREST,width:1,height:1}))}return(0,P.Z)(Te,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertyesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertyesExist.hasOpacity,this.stylePropertyesExist.hasStrokeOpacity,this.stylePropertyesExist.hasStrokeWidth,this.stylePropertyesExist.hasStroke,this.stylePropertyesExist.hasOffsets,this.stylePropertyesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(Ce){var Fe=!1;return H()(Ce.thetaOffset,this.cacheStyleProperties.thetaOffset)||(Fe=!0,this.cacheStyleProperties.thetaOffset=Ce.thetaOffset),H()(Ce.opacity,this.cacheStyleProperties.opacity)||(Fe=!0,this.cacheStyleProperties.opacity=Ce.opacity),H()(Ce.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(Fe=!0,this.cacheStyleProperties.strokeOpacity=Ce.strokeOpacity),H()(Ce.strokeWidth,this.cacheStyleProperties.strokeWidth)||(Fe=!0,this.cacheStyleProperties.strokeWidth=Ce.strokeWidth),H()(Ce.stroke,this.cacheStyleProperties.stroke)||(Fe=!0,this.cacheStyleProperties.stroke=Ce.stroke),H()(Ce.offsets,this.cacheStyleProperties.offsets)||(Fe=!0,this.cacheStyleProperties.offsets=Ce.offsets),this.dataTexture===void 0&&(Fe=!0),Fe}},{key:"judgeStyleAttributes",value:function(Ce){this.clearLastCalRes(),Ce.opacity!==void 0&&!N()(Ce.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertyesExist.hasOpacity=1,this.cellLength+=1),Ce.strokeOpacity!==void 0&&!N()(Ce.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertyesExist.hasStrokeOpacity=1,this.cellLength+=1),Ce.strokeWidth!==void 0&&!N()(Ce.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertyesExist.hasStrokeWidth=1,this.cellLength+=1),Ce.stroke!==void 0&&!this.isStaticColor(Ce.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertyesExist.hasStroke=1,this.cellLength+=4),Ce.offsets!==void 0&&!this.isOffsetStatic(Ce.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertyesExist.hasOffsets=1,this.cellLength+=2),Ce.thetaOffset!==void 0&&!N()(Ce.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertyesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(Ce){return B()(Ce)?!!(0,rt.ZP)(Ce):!1}},{key:"getStrokeColor",value:function(Ce){if(this.isStaticColor(Ce)){var Fe=(0,at.rgb2arr)(Ce);return Fe[0]=Fe[0]?Fe[0]:0,Fe[1]=Fe[1]?Fe[1]:0,Fe[2]=Fe[2]?Fe[2]:0,Fe[3]=Fe[3]?Fe[3]:0,Fe}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(Ce){return!!(Array.isArray(Ce)&&Ce.length===2&&N()(Ce[0])&&N()(Ce[1]))}},{key:"patchMod",value:function(Ce,Fe){for(var Ke=0;Ke<Fe;Ke++)Ce.push(-1)}},{key:"patchData",value:function(Ce,Fe,Ke){var qt=$e(Ke),ir;try{for(qt.s();!(ir=qt.n()).done;){var Pe=ir.value,Ne=Pe.attr,Xe=Pe.count,kt=Fe[Ne];kt!==void 0?Ne==="stroke"?Ce.push.apply(Ce,(0,v.Z)((0,at.rgb2arr)(kt))):Ne==="offsets"?this.isOffsetStatic(kt)?Ce.push(-kt[0],kt[1]):Ce.push(0,0):Ce.push(N()(kt)?kt:1):this.patchMod(Ce,Xe)}}catch(rr){qt.e(rr)}finally{qt.f()}}},{key:"calDataFrame",value:function(Ce,Fe,Ke){for(var qt=Fe.length,ir=Math.ceil(qt*Ce/this.DATA_TEXTURE_WIDTH),Pe=ir*this.DATA_TEXTURE_WIDTH,Ne=[],Xe=0;Xe<qt;Xe++){var kt=Fe[Xe];this.patchData(Ne,kt,Ke)}for(var rr=Ne.length;rr<Pe;rr++)Ne.push(-1);return{data:Ne,width:this.DATA_TEXTURE_WIDTH,height:ir}}},{key:"getBlend",value:function(){var Ce=this.layer.getLayerConfig(),Fe=Ce.blend,Ke=Fe===void 0?"normal":Fe;return Re.y[ce.BlendType[Ke]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(Ce){return[Ce.enable?0:1,Ce.duration||4,Ce.interval||.2,Ce.trailLength||.1]}},{key:"startModelAnimate",value:function(){var Ce=this.layer.getLayerConfig(),Fe=Ce.animateOption;Fe.enable&&this.layer.setAnimateStartTime()}}]),Te}(),fe=(0,O.Z)(wt.prototype,"configService",[vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt)},42184:function(Ft,A,y){"use strict";y.d(A,{S:function(){return vr},Rs:function(){return Cr},zO:function(){return Ye},$4:function(){return nt},sN:function(){return Ae},NM:function(){return jr},oX:function(){return on},xH:function(){return xr},Xz:function(){return Mr},iC:function(){return Nr},us:function(){return De},qZ:function(){return ht},NW:function(){return J},Qr:function(){return ke},T3:function(){return Bt}});var v=y(17553),Z=y(86049),a=y(9187),P=y.n(a),L=y(90440),O=y(12962),D=y(8842),B=y(20637),V=y(47634),N=y(31437),Y=N.Ue(),H=N.Ue(),ce=N.Ue(),at=N.Ue(),rt=N.Ue();function Re(ze,pt,Me,Ue,yt){N.IH(ze,Me,Ue),N.Fv(ze,ze),pt=N.al(-ze[1],ze[0]);var gt=N.al(-Me[1],Me[0]);return[yt/N.AK(pt,gt),pt]}function vt(ze,pt){return N.t8(ze,-pt[1],pt[0])}function wt(ze,pt,Me){return N.lu(ze,pt,Me),N.Fv(ze,ze),ze}function fe(ze,pt){return ze[0]===pt[0]&&ze[1]===pt[1]}function $e(ze){for(var pt=new Map,Me=0;Me<ze.length;Me++){var Ue=ze[0].toString()+"-"+ze[1].toString();pt.get(Ue)?(ze.splice(Me,1),Me++):pt.set(Ue,Ue)}return ze}var re=function(){function ze(){var pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,D.Z)(this,ze),(0,V.Z)(this,"complex",void 0),(0,V.Z)(this,"join",void 0),(0,V.Z)(this,"cap",void 0),(0,V.Z)(this,"miterLimit",void 0),(0,V.Z)(this,"thickness",void 0),(0,V.Z)(this,"normal",void 0),(0,V.Z)(this,"lastFlip",-1),(0,V.Z)(this,"miter",N.al(0,0)),(0,V.Z)(this,"started",!1),(0,V.Z)(this,"dash",!1),(0,V.Z)(this,"totalDistance",0),(0,V.Z)(this,"currentIndex",0),this.join=pt.join||"miter",this.cap=pt.cap||"butt",this.miterLimit=pt.miterLimit||10,this.thickness=pt.thickness||1,this.dash=pt.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,B.Z)(ze,[{key:"extrude_gaode2",value:function(Me,Ue){var yt=this.complex;if(Me.length<=1)return yt;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var gt=Me.length,nr=yt.startIndex,pe=1;pe<gt;pe++){var lr,Ur,Hr,un=Me[pe-1];un.push((lr=Ue[pe-1][2])!==null&&lr!==void 0?lr:0);var bn=Ue[pe-1],Gn=Me[pe];Gn.push((Ur=Ue[pe][2])!==null&&Ur!==void 0?Ur:0);var li=Ue[pe],$r=pe<Me.length-1?[].concat((0,v.Z)(Me[pe+1]),[(Hr=Ue[pe+1][2])!==null&&Hr!==void 0?Hr:0]):null,Zt=pe<Ue.length-1?Ue[pe+1]:null,it=this.segment_gaode2(yt,nr,un,Gn,$r,bn,li,Zt);nr+=it}if(this.dash)for(var ne=0;ne<yt.positions.length/6;ne++)yt.positions[ne*6+5]=this.totalDistance;return yt.startIndex=yt.positions.length/6,yt}},{key:"simpleExtrude_gaode2",value:function(Me,Ue){var yt=this.complex;if(Me.length<=1)return yt;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var gt=Me.length,nr=yt.startIndex,pe=1;pe<gt;pe++){var lr,Ur,Hr,un=Me[pe-1];un.push((lr=Ue[pe-1][2])!==null&&lr!==void 0?lr:0);var bn=Ue[pe-1],Gn=Me[pe];Gn.push((Ur=Ue[pe][2])!==null&&Ur!==void 0?Ur:0);var li=Ue[pe],$r=pe<Me.length-1?[].concat((0,v.Z)(Me[pe+1]),[(Hr=Ue[pe+1][2])!==null&&Hr!==void 0?Hr:0]):null,Zt=pe<Ue.length-1?Ue[pe+1]:null,it=this.simpleSegment(yt,nr,un,Gn,$r,bn,li,Zt);nr+=it}if(this.dash)for(var ne=0;ne<yt.positions.length/6;ne++)yt.positions[ne*6+5]=this.totalDistance;return yt.startIndex=yt.positions.length/6,yt}},{key:"extrude",value:function(Me){var Ue=this.complex;if(Me.length<=1)return Ue;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var yt=Me.length,gt=Ue.startIndex,nr=1;nr<yt;nr++){var pe=Me[nr-1],lr=Me[nr],Ur=nr<Me.length-1?Me[nr+1]:null,Hr=this.segment(Ue,gt,pe,lr,Ur);gt+=Hr}if(this.dash)for(var un=0;un<Ue.positions.length/6;un++)Ue.positions[un*6+5]=this.totalDistance;return Ue.startIndex=Ue.positions.length/6,Ue}},{key:"simpleExtrude",value:function(Me){var Ue=this.complex;if(Me.length<=1)return Ue;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var yt=Me.length,gt=Ue.startIndex,nr=1;nr<yt;nr++){var pe=Me[nr-1],lr=Me[nr],Ur=nr<Me.length-1?Me[nr+1]:null,Hr=this.simpleSegment(Ue,gt,pe,lr,Ur);gt+=Hr}if(this.dash)for(var un=0;un<Ue.positions.length/6;un++)Ue.positions[un*6+5]=this.totalDistance;return Ue.startIndex=Ue.positions.length/6,Ue}},{key:"segment_gaode2",value:function(Me,Ue,yt,gt,nr,pe,lr,Ur){var Hr=0,un=Me.indices,bn=Me.positions,Gn=Me.normals,li=this.cap==="square",$r=this.join==="bevel",Zt=(0,Z.aProjectFlat)([lr[0],lr[1]]),it=(0,Z.aProjectFlat)([pe[0],pe[1]]);wt(ce,gt,yt);var ne=0;if(this.dash&&(ne=this.lineSegmentDistance(Zt,it),this.totalDistance+=ne),this.normal||(this.normal=N.Ue(),vt(this.normal,ce)),!this.started)if(this.started=!0,li){var _e=N.Ue(),Oe=N.Ue();N.IH(_e,this.normal,ce),N.IH(Oe,this.normal,ce),Gn.push(Oe[0],Oe[1],0),Gn.push(_e[0],_e[1],0),bn.push(yt[0],yt[1],yt[2]|0,this.totalDistance-ne,-this.thickness,yt[2]|0),this.complex.indexes.push(this.currentIndex),bn.push(yt[0],yt[1],yt[2]|0,this.totalDistance-ne,this.thickness,yt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(bn,Gn,yt,this.normal,this.thickness,this.totalDistance-ne);if(un.push(Ue+0,Ue+1,Ue+2),nr){fe(gt,nr)&&N.IH(nr,gt,N.Fv(nr,N.$X(nr,gt,yt))),wt(at,nr,gt);var Ut=Re(rt,N.Ue(),ce,at,this.thickness),ur=(0,O.Z)(Ut,2),lt=ur[0],Nt=ur[1],Sr=N.AK(rt,this.normal)<0?-1:1,fn=$r;if(!fn&&this.join==="miter"){var Br=lt;Br>this.miterLimit&&(fn=!0)}fn?(Gn.push(this.normal[0],this.normal[1],0),Gn.push(Nt[0],Nt[1],0),bn.push(gt[0],gt[1],gt[2]|0,this.totalDistance,-this.thickness*Sr,gt[2]|0),this.complex.indexes.push(this.currentIndex),bn.push(gt[0],gt[1],gt[2]|0,this.totalDistance,this.thickness*Sr,gt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,un.push.apply(un,(0,v.Z)(this.lastFlip!==-Sr?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),un.push(Ue+2,Ue+3,Ue+4),vt(Y,at),N.JG(this.normal,Y),Gn.push(this.normal[0],this.normal[1],0),bn.push(gt[0],gt[1],gt[2]|0,this.totalDistance,-this.thickness*Sr,gt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,Hr+=3):(this.extrusions(bn,Gn,gt,Nt,lt,this.totalDistance),un.push.apply(un,(0,v.Z)(this.lastFlip===1?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),Sr=-1,N.JG(this.normal,Nt),Hr+=2),this.lastFlip=Sr}else{if(vt(this.normal,ce),li){var je=N.Ue(),dt=N.Ue();N.lu(dt,ce,this.normal),N.IH(je,ce,this.normal),Gn.push(dt[0],dt[1],0),Gn.push(je[0],je[1],0),bn.push(gt[0],gt[1],gt[2]|0,this.totalDistance,this.thickness,gt[2]|0),this.complex.indexes.push(this.currentIndex),bn.push(gt[0],gt[1],gt[2]|0,this.totalDistance,this.thickness,gt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(bn,Gn,gt,this.normal,this.thickness,this.totalDistance);un.push.apply(un,(0,v.Z)(this.lastFlip===1?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),Hr+=2}return Hr}},{key:"simpleSegment",value:function(Me,Ue,yt,gt,nr){var pe=0,lr=Me.indices,Ur=Me.positions,Hr=Me.normals,un=(0,Z.aProjectFlat)([gt[0],gt[1]]),bn=(0,Z.aProjectFlat)([yt[0],yt[1]]);wt(ce,un,bn);var Gn=0;if(this.dash&&(Gn=this.lineSegmentDistance(un,bn),this.totalDistance+=Gn),this.normal||(this.normal=N.Ue(),vt(this.normal,ce)),this.started||(this.started=!0,this.extrusions(Ur,Hr,yt,this.normal,this.thickness,this.totalDistance-Gn)),lr.push(Ue+0,Ue+1,Ue+2),!nr)vt(this.normal,ce),this.extrusions(Ur,Hr,gt,this.normal,this.thickness,this.totalDistance),lr.push.apply(lr,(0,v.Z)(this.lastFlip===1?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),pe+=2;else{var li=(0,Z.aProjectFlat)([nr[0],nr[1]]);fe(un,li)&&N.IH(li,un,N.Fv(li,N.$X(li,un,bn))),wt(at,li,un);var $r=Re(rt,N.Ue(),ce,at,this.thickness),Zt=(0,O.Z)($r,2),it=Zt[0],ne=Zt[1],_e=N.AK(rt,this.normal)<0?-1:1;this.extrusions(Ur,Hr,gt,ne,it,this.totalDistance),lr.push.apply(lr,(0,v.Z)(this.lastFlip===1?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),_e=-1,N.JG(this.normal,ne),pe+=2,this.lastFlip=_e}return pe}},{key:"segment",value:function(Me,Ue,yt,gt,nr){var pe=0,lr=Me.indices,Ur=Me.positions,Hr=Me.normals,un=this.cap==="square",bn=this.join==="bevel",Gn=(0,Z.aProjectFlat)([gt[0],gt[1]]),li=(0,Z.aProjectFlat)([yt[0],yt[1]]);wt(ce,Gn,li);var $r=0;if(this.dash&&($r=this.lineSegmentDistance(Gn,li),this.totalDistance+=$r),this.normal||(this.normal=N.Ue(),vt(this.normal,ce)),!this.started)if(this.started=!0,un){var Zt=N.Ue(),it=N.Ue();N.IH(Zt,this.normal,ce),N.IH(it,this.normal,ce),Hr.push(it[0],it[1],0),Hr.push(Zt[0],Zt[1],0),Ur.push(yt[0],yt[1],yt[2]|0,this.totalDistance-$r,-this.thickness,yt[2]|0),this.complex.indexes.push(this.currentIndex),Ur.push(yt[0],yt[1],yt[2]|0,this.totalDistance-$r,this.thickness,yt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(Ur,Hr,yt,this.normal,this.thickness,this.totalDistance-$r);if(lr.push(Ue+0,Ue+1,Ue+2),nr){var Oe=(0,Z.aProjectFlat)([nr[0],nr[1]]);fe(Gn,Oe)&&N.IH(Oe,Gn,N.Fv(Oe,N.$X(Oe,Gn,li))),wt(at,Oe,Gn);var je=Re(rt,N.Ue(),ce,at,this.thickness),dt=(0,O.Z)(je,2),Ut=dt[0],ur=dt[1],lt=N.AK(rt,this.normal)<0?-1:1,Nt=bn;if(!Nt&&this.join==="miter"){var Sr=Ut;Sr>this.miterLimit&&(Nt=!0)}Nt?(Hr.push(this.normal[0],this.normal[1],0),Hr.push(ur[0],ur[1],0),Ur.push(gt[0],gt[1],gt[2]|0,this.totalDistance,-this.thickness*lt,gt[2]|0),this.complex.indexes.push(this.currentIndex),Ur.push(gt[0],gt[1],gt[2]|0,this.totalDistance,this.thickness*lt,gt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,lr.push.apply(lr,(0,v.Z)(this.lastFlip!==-lt?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),lr.push(Ue+2,Ue+3,Ue+4),vt(Y,at),N.JG(this.normal,Y),Hr.push(this.normal[0],this.normal[1],0),Ur.push(gt[0],gt[1],gt[2]|0,this.totalDistance,-this.thickness*lt,gt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,pe+=3):(this.extrusions(Ur,Hr,gt,ur,Ut,this.totalDistance),lr.push.apply(lr,(0,v.Z)(this.lastFlip===1?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),lt=-1,N.JG(this.normal,ur),pe+=2),this.lastFlip=lt}else{if(vt(this.normal,ce),un){var ne=N.Ue(),_e=N.Ue();N.lu(_e,ce,this.normal),N.IH(ne,ce,this.normal),Hr.push(_e[0],_e[1],0),Hr.push(ne[0],ne[1],0),Ur.push(gt[0],gt[1],gt[2]|0,this.totalDistance,this.thickness,gt[2]|0),this.complex.indexes.push(this.currentIndex),Ur.push(gt[0],gt[1],gt[2]|0,this.totalDistance,this.thickness,gt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(Ur,Hr,gt,this.normal,this.thickness,this.totalDistance);lr.push.apply(lr,(0,v.Z)(this.lastFlip===1?[Ue,Ue+2,Ue+3]:[Ue+2,Ue+1,Ue+3])),pe+=2}return pe}},{key:"extrusions",value:function(Me,Ue,yt,gt,nr,pe){Ue.push(gt[0],gt[1],0),Ue.push(gt[0],gt[1],0),Me.push(yt[0],yt[1],yt[2]|0,pe,-nr,yt[2]|0),this.complex.indexes.push(this.currentIndex),Me.push(yt[0],yt[1],yt[2]|0,pe,nr,yt[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(Me,Ue){var yt=Ue[0]-Me[0],gt=Ue[1]-Me[1];return Math.sqrt(yt*yt+gt*gt)}}]),ze}(),Ge=y(1140),Qe=y(77160);function Te(ze){var pt=ze[0][0],Me=ze[0][ze[0].length-1];pt[0]===Me[0]&&pt[1]===Me[1]&&(ze[0]=ze[0].slice(0,ze[0].length-1));for(var Ue=ze[0].length,yt=P().flatten(ze),gt=yt.vertices,nr=yt.dimensions,pe=[],lr=[],Ur=0;Ur<gt.length/nr;Ur++)nr===2?pe.push(gt[Ur*2],gt[Ur*2+1],1):pe.push(gt[Ur*3],gt[Ur*3+1],1);var Hr=P()(yt.vertices,yt.holes,yt.dimensions);lr.push.apply(lr,(0,v.Z)(Hr));for(var un=function(li){var $r=yt.vertices.slice(li*nr,(li+1)*nr),Zt=yt.vertices.slice((li+1)*nr,(li+2)*nr);Zt.length===0&&(Zt=yt.vertices.slice(0,nr));var it=pe.length/3;pe.push($r[0],$r[1],1,Zt[0],Zt[1],1,$r[0],$r[1],0,Zt[0],Zt[1],0),lr.push.apply(lr,(0,v.Z)([0,2,1,2,3,1].map(function(ne){return ne+it})))},bn=0;bn<Ue;bn++)un(bn);return{positions:pe,index:lr}}function Le(ze){var pt=P().flatten(ze),Me=P()(pt.vertices,pt.holes,pt.dimensions);return{positions:pt.vertices,index:Me}}function Ce(ze){var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Me=ze[0][0],Ue=ze[0][ze[0].length-1];Me[0]===Ue[0]&&Me[1]===Ue[1]&&(ze[0]=ze[0].slice(0,ze[0].length-1));for(var yt=ze[0].length,gt=P().flatten(ze),nr=gt.vertices,pe=gt.dimensions,lr=[],Ur=[],Hr=[],un=0;un<nr.length/pe;un++)pe===2?lr.push(nr[un*2],nr[un*2+1],1,-1,-1):lr.push(nr[un*3],nr[un*3+1],1,-1,-1),Hr.push(0,0,1);var bn=P()(gt.vertices,gt.holes,gt.dimensions);Ur.push.apply(Ur,(0,v.Z)(bn));for(var Gn=function(Zt){var it=gt.vertices.slice(Zt*pe,(Zt+1)*pe),ne=gt.vertices.slice((Zt+1)*pe,(Zt+2)*pe);ne.length===0&&(ne=gt.vertices.slice(0,pe));var _e=lr.length/5;lr.push(it[0],it[1],1,0,0,ne[0],ne[1],1,.1,0,it[0],it[1],0,0,.8,ne[0],ne[1],0,.1,.8);var Oe=Fe([ne[0],ne[1],1],[it[0],it[1],0],[it[0],it[1],1],pt);Hr.push.apply(Hr,(0,v.Z)(Oe).concat((0,v.Z)(Oe),(0,v.Z)(Oe),(0,v.Z)(Oe))),Ur.push.apply(Ur,(0,v.Z)([1,2,0,3,2,1].map(function(je){return je+_e})))},li=0;li<yt;li++)Gn(li);return{positions:lr,index:Ur,normals:Hr}}function Fe(ze,pt,Me){var Ue=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,yt=Qe.create(),gt=Qe.create(),nr=Qe.create();Ue&&(ze=(0,Z.lngLatToMeters)(ze),pt=(0,Z.lngLatToMeters)(pt),Me=(0,Z.lngLatToMeters)(Me));var pe=Qe.fromValues.apply(Qe,(0,v.Z)(ze)),lr=Qe.fromValues.apply(Qe,(0,v.Z)(pt)),Ur=Qe.fromValues.apply(Qe,(0,v.Z)(Me));Qe.sub(yt,Ur,lr),Qe.sub(gt,pe,lr),Qe.cross(nr,yt,gt);var Hr=Qe.create();return Qe.normalize(Hr,nr),Hr}var Ke,qt;(function(ze){ze.CYLINDER="cylinder",ze.SQUARECOLUMN="squareColumn",ze.TRIANGLECOLUMN="triangleColumn",ze.HEXAGONCOLUMN="hexagonColumn",ze.PENTAGONCOLUMN="pentagonColumn"})(qt||(qt={}));var ir;(function(ze){ze.CIRCLE="circle",ze.SQUARE="square",ze.TRIANGLE="triangle",ze.HEXAGON="hexagon",ze.PENTAGON="pentagon"})(ir||(ir={}));function Pe(ze){for(var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Me=Math.PI*2/ze,Ue=[],yt=0;yt<ze;yt++)Ue.push(Me*yt+pt*Math.PI/12);var gt=Ue.map(function(nr){var pe=Math.sin(nr+Math.PI/4),lr=Math.cos(nr+Math.PI/4);return[pe,lr,0]});return gt}function Ne(){return Pe(30)}function Xe(){return Pe(4)}function kt(){return Pe(3)}function rr(){return Pe(6,1)}function me(){return Pe(5)}var et=(Ke={},(0,V.Z)(Ke,ir.CIRCLE,Ne),(0,V.Z)(Ke,ir.HEXAGON,rr),(0,V.Z)(Ke,ir.TRIANGLE,kt),(0,V.Z)(Ke,ir.SQUARE,Xe),(0,V.Z)(Ke,ir.PENTAGON,me),(0,V.Z)(Ke,qt.CYLINDER,Ne),(0,V.Z)(Ke,qt.HEXAGONCOLUMN,rr),(0,V.Z)(Ke,qt.TRIANGLECOLUMN,kt),(0,V.Z)(Ke,qt.SQUARECOLUMN,Xe),(0,V.Z)(Ke,qt.PENTAGONCOLUMN,me),Ke),or={};function on(ze){var pt=(0,Ge.S)(ze.coordinates);return{vertices:[].concat((0,v.Z)(pt),(0,v.Z)(pt),(0,v.Z)(pt),(0,v.Z)(pt)),indices:[0,1,2,2,3,0],size:pt.length}}function vr(ze){var pt=(0,Ge.S)(ze.coordinates),Me=(0,L.rq)(pt);return{vertices:[].concat((0,v.Z)(Me),(0,v.Z)(Me),(0,v.Z)(Me),(0,v.Z)(Me)),indices:[0,1,2,2,3,0],size:Me.length}}function jr(ze){var pt=ze.shape,Me=M(pt,!1),Ue=Me.positions,yt=Me.index,gt=Me.normals;return{vertices:Ue,indices:yt,normals:gt,size:5}}function xr(ze){var pt=(0,Ge.S)(ze.coordinates);return{vertices:(0,v.Z)(pt),indices:[0],size:pt.length}}function Ae(ze){var pt=ze.coordinates,Me=ze.originCoordinates,Ue=ze.version,yt=new re({dash:!0,join:"bevel"});if(Ue==="GAODE2.x"){var gt=pt;Array.isArray(gt[0][0])||(gt=[pt]);var nr=Me;Array.isArray(nr[0][0])||(nr=[Me]);for(var pe=0;pe<gt.length;pe++){var lr=gt[pe],Ur=nr[pe];yt.extrude_gaode2(lr,Ur)}}else{var Hr=pt;Hr[0]&&!Array.isArray(Hr[0][0])&&(Hr=[pt]),Hr.forEach(function(bn){yt.extrude(bn)})}var un=yt.complex;return{vertices:un.positions,indices:un.indices,normals:un.normals,indexes:un.indexes,size:6}}function De(ze){var pt=ze.coordinates,Me=ze.originCoordinates,Ue=ze.version,yt=new re({dash:!0,join:"bevel"});if(Ue==="GAODE2.x"){var gt=pt;Array.isArray(gt[0][0])||(gt=[pt]);var nr=Me;Array.isArray(nr[0][0])||(nr=[Me]);for(var pe=0;pe<gt.length;pe++){var lr=gt[pe],Ur=nr[pe];yt.simpleExtrude_gaode2(lr,Ur)}}else{var Hr=pt;Hr[0]&&!Array.isArray(Hr[0][0])&&(Hr=[pt]),Hr.forEach(function(bn){yt.simpleExtrude(bn)})}var un=yt.complex;return{vertices:un.positions,indices:un.indices,normals:un.normals,size:6}}function ke(ze){var pt=ze.coordinates,Me=P().flatten(pt),Ue=Me.vertices,yt=Me.dimensions,gt=Me.holes;return{indices:P()(Ue,gt,yt),vertices:Ue,size:yt}}function Bt(ze){var pt=ze.coordinates,Me=P().flatten(pt),Ue=Me.vertices,yt=Me.dimensions,gt=Me.holes;return{indices:P()(Ue,gt,yt),vertices:mt(Ue),size:yt+4}}function mt(ze){for(var pt=[],Me=(0,Ge.R)(ze),Ue=Me.center,yt=Me.radius,gt=0;gt<ze.length;gt+=2){var nr=ze[gt],pe=ze[gt+1];pt.push.apply(pt,[nr,pe,0].concat((0,v.Z)(Ue),[yt]))}return pt}function Mr(ze){var pt=ze.coordinates,Me=Ce(pt,!0),Ue=Me.positions,yt=Me.index,gt=Me.normals;return{vertices:Ue,indices:yt,normals:gt,size:5}}function Cr(ze){var pt=ze.shape,Me=ie(pt),Ue=Me.positions,yt=Me.index;return{vertices:Ue,indices:yt,size:3}}function Nr(ze){var pt=ze.coordinates,Me=[].concat((0,v.Z)(pt[0]),[0,0,1,pt[1][0],pt[0][1],0,1,1],(0,v.Z)(pt[1]),[0,1,0],(0,v.Z)(pt[0]),[0,0,1],(0,v.Z)(pt[1]),[0,1,0,pt[0][0],pt[1][1],0,0,0]),Ue=[0,1,2,3,4,5];return{vertices:Me,indices:Ue,size:5}}function nt(ze,pt){for(var Me=pt||30,Ue=ze.coordinates,yt=[],gt=[],nr=function(Ur){yt.push(Ur,1,Ur,Ue[0][0],Ue[0][1],Ue[1][0],Ue[1][1],Ur,-1,Ur,Ue[0][0],Ue[0][1],Ue[1][0],Ue[1][1]),Ur!==Me-1&&gt.push.apply(gt,(0,v.Z)([0,1,2,1,3,2].map(function(Hr){return Ur*2+Hr})))},pe=0;pe<Me;pe++)nr(pe);return{vertices:yt,indices:gt,size:7}}function Ye(ze){var pt=ze.coordinates;pt.length===2&&pt.push(0);var Me=ze.size,Ue=ye(-1,1),yt=ye(1,1),gt=ye(-1,-1),nr=ye(1,-1),pe=[].concat((0,v.Z)(pt),(0,v.Z)(Ue),(0,v.Z)(pt),(0,v.Z)(gt),(0,v.Z)(pt),(0,v.Z)(nr),(0,v.Z)(pt),(0,v.Z)(yt)),lr=[0,1,2,3,0,2];return{vertices:pe,indices:lr,size:5}}function M(ze){var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(or&&or[ze])return or[ze];var Me=et[ze]?et[ze]():et.cylinder(),Ue=Ce([Me],pt);return or[ze]=Ue,Ue}function W(ze,pt){for(var Me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,Ue=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,yt=new Float32Array(ze.length/Me*3),gt,nr,pe,lr=vec3.create(),Ur=vec3.create(),Hr=vec3.create(),un=0,bn=pt.length;un<bn;un+=3){gt=pt[un+0]*3,nr=pt[un+1]*3,pe=pt[un+2]*3;var Gn=[ze[gt],ze[gt+1]],li=[ze[nr],ze[nr+1]],$r=[ze[pe],ze[pe+1]];Ue&&(Gn=lngLatToMeters(Gn),li=lngLatToMeters(li),$r=lngLatToMeters($r));var Zt=Gn,it=_slicedToArray(Zt,2),ne=it[0],_e=it[1],Oe=vec3.fromValues(ne,_e,ze[gt+2]),je=li,dt=_slicedToArray(je,2),Ut=dt[0],ur=dt[1],lt=vec3.fromValues(Ut,ur,ze[nr+2]),Nt=$r,Sr=_slicedToArray(Nt,2),fn=Sr[0],Br=Sr[1],Jr=vec3.fromValues(fn,Br,ze[pe+2]);vec3.sub(lr,Jr,lt),vec3.sub(Ur,Oe,lt),vec3.cross(Hr,lr,Ur),yt[gt]+=lr[0],yt[gt+1]+=lr[1],yt[gt+2]+=lr[2],yt[nr]+=lr[0],yt[nr+1]+=lr[1],yt[nr+2]+=lr[2],yt[pe]+=lr[0],yt[pe+1]+=lr[1],yt[pe+2]+=lr[2]}return ue(yt),yt}function ue(ze){for(var pt=0,Me=ze.length;pt<Me;pt+=3){var Ue=vec3.fromValues(ze[pt],ze[pt+1],ze[pt+2]),yt=vec3.create();vec3.normalize(yt,Ue),ze.set(yt,pt)}}function X(ze){var pt=ze[0][0],Me=ze[0][ze[0].length-1];return pt[0]===Me[0]&&pt[1]===Me[1]}function ie(ze){var pt=["cylinder","triangleColumn","hexagonColumn","squareColumn"],Me=et[ze]?et[ze]():et.circle(),Ue=pt.indexOf(ze)===-1?Le([Me]):Te([Me]);return Ue}function ye(ze,pt){var Me=(ze+1)/2,Ue=(pt+1)/2;return[Me,Ue]}function J(){var ze=(0,L.j7)(L.Y5,{segments:L.r1}),pt=ze.positionsArr,Me=ze.indicesArr,Ue=ze.normalArr;return{vertices:pt,indices:Me,size:5,normals:Ue}}function ht(){var ze=(0,L.j7)(L.Y5+L.XJ,{segments:L.r1}),pt=ze.positionsArr,Me=ze.indicesArr,Ue=ze.normalArr;return{vertices:pt,indices:Me,size:5,normals:Ue}}},90440:function(Ft,A,y){"use strict";y.d(A,{Y5:function(){return P},r1:function(){return L},XJ:function(){return O},rq:function(){return B},j7:function(){return V}});var v=y(17553),Z=y(85975),a=y(77160),P=100,L=36,O=40;function D(N){return N/180*Math.acos(-1)}function B(N){var Y=D(N[0])+Math.PI/2,H=D(N[1]),ce=P+Math.random()*.4,at=ce*Math.cos(H)*Math.cos(Y),rt=ce*Math.cos(H)*Math.sin(Y),Re=ce*Math.sin(H);return[rt,Re,at]}function V(N,Y){var H=Z.create(),ce=Z.create(),at=a.fromValues(0,1,0),rt=a.fromValues(0,0,0);Y=Y||{},N=typeof N!="undefined"?N:1;for(var Re=typeof Y.segments!="undefined"?Y.segments:32,vt=2+Re,wt=2*vt,fe=[],$e=[],re=[],Ge=[],Qe=[],Te=[],Le=0;Le<=vt;Le++){for(var Ce=Le/vt,Fe=Ce*Math.PI,Ke=0;Ke<=wt;Ke++){var qt=Ke/wt,ir=qt*Math.PI*2;Z.identity(ce),Z.rotateZ(ce,ce,-Fe),Z.identity(H),Z.rotateY(H,H,ir),a.transformMat4(rt,at,ce),a.transformMat4(rt,rt,H),a.scale(rt,rt,-N),re.push(rt.slice()),Ge.push.apply(Ge,(0,v.Z)(rt.slice())),a.normalize(rt,rt),Qe.push.apply(Qe,(0,v.Z)(rt.slice())),Te.push([qt,1-Ce]),Ge.push(qt,1-Ce)}if(Le>0)for(var Pe=re.length,Ne=Pe-2*(wt+1);Ne+wt+2<Pe;Ne++)fe.push([Ne,Ne+1,Ne+wt+1]),$e.push(Ne,Ne+1,Ne+wt+1),fe.push([Ne+wt+1,Ne+1,Ne+wt+2]),$e.push(Ne+wt+1,Ne+1,Ne+wt+2)}return{cells:fe,positions:re,uvs:Te,positionsArr:Ge,indicesArr:$e,normalArr:Qe}}},28675:function(Ft,A,y){"use strict";y.r(A),y.d(A,{BaseLayer:function(){return V.Z},CanvasLayer:function(){return re},CityBuildingLayer:function(){return Pe},EarthLayer:function(){return of},GeometryLayer:function(){return Cr},HeatmapLayer:function(){return lt},ImageLayer:function(){return vi},ImageTileLayer:function(){return Gt},LineLayer:function(){return Fr},MaskLayer:function(){return $l.Z},PointLayer:function(){return ac},PolygonLayer:function(){return Xs},RasterLayer:function(){return Wl},WindLayer:function(){return Bn}});var v=y(39128),Z=y(8842),a=y(20637),P=y(23845),L=y(49651),O=y(58115),D=y(89866),B=y(47634),V=y(46090),N=y(12962),Y=y(98422),H;(function(f){f[f.solid=0]="solid",f[f.dash=1]="dash"})(H||(H={}));var ce;(function(f){f.ALWAYS="always",f.DRAGEND="dragend"})(ce||(ce={}));function at(f){var F=rt();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function rt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Re=function(f){(0,L.Z)(x,f);var F=at(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"updateMode",ce.ALWAYS),(0,B.Z)((0,P.Z)(p),"canvas",void 0),(0,B.Z)((0,P.Z)(p),"ctx",void 0),(0,B.Z)((0,P.Z)(p),"prevSize",void 0),(0,B.Z)((0,P.Z)(p),"renderUpdate",function(){var Q=p.layer.getLayerConfig(),oe=Q.zIndex,xe=oe===void 0?10:oe,Be=Q.update,qe=Be===void 0?ce.ALWAYS:Be,zt=Q.animateOption,Ht=zt===void 0?{enable:!1,duration:20}:zt;+p.canvas.style.zIndex===xe&&(p.canvas.style.zIndex=xe+""),p.updateMode!==qe&&(p.updateMode=qe,p.unBindListener(),p.bindListener()),p.updateMode===ce.ALWAYS&&Ht.enable&&p.renderCanvas()}),(0,B.Z)((0,P.Z)(p),"unBindListener",function(){p.mapService.off("mapchange",p.renderCanvas),p.mapService.off("zoomstart",p.clearCanvas),p.mapService.off("zoomend",p.renderCanvas),p.mapService.off("movestart",p.clearCanvas),p.mapService.off("moveend",p.renderCanvas)}),(0,B.Z)((0,P.Z)(p),"bindListener",function(){p.updateMode===ce.ALWAYS?p.mapService.on("mapchange",p.renderCanvas):(p.mapService.on("zoomstart",p.clearCanvas),p.mapService.on("zoomend",p.renderCanvas),p.mapService.on("movestart",p.clearCanvas),p.mapService.on("moveend",p.renderCanvas))}),(0,B.Z)((0,P.Z)(p),"clearCanvas",function(){if(p.ctx){var Q=p.rendererService.getViewportSize(),oe=Q.width,xe=Q.height;p.ctx.clearRect(0,0,oe,xe)}}),(0,B.Z)((0,P.Z)(p),"renderCanvas",function(){var Q=p.rendererService.getViewportSize(),oe=Q.width,xe=Q.height;if(p.prevSize[0]!==oe||p.prevSize[1]!==xe){p.prevSize=[oe,xe];var Be=p.mapService.getSize(),qe=(0,N.Z)(Be,2),zt=qe[0],Ht=qe[1];p.canvas.width=oe,p.canvas.height=xe,p.canvas.style.width=zt+"px",p.canvas.style.height=Ht+"px"}var Tr=p.layer.getLayerConfig(),en=Tr.drawingOnCanvas;p.ctx&&en({canvas:p.canvas,ctx:p.ctx,mapService:p.mapService,size:[oe,xe]})}),p}return(0,a.Z)(x,[{key:"clearModels",value:function(){this.canvas&&(document.removeChild(this.canvas),this.canvas=null),this.unBindListener()}},{key:"initModels",value:function(){var h=this.layer.getLayerConfig(),S=h.update,k=S===void 0?ce.ALWAYS:S;return this.updateMode=k,this.initCanvas(),this.renderCanvas(),this.bindListener(),this.mapService.getContainer(),[]}},{key:"initCanvas",value:function(){var h,S=this.layer.getLayerConfig(),k=S.zIndex,Q=this.mapService.getSize(),oe=(0,N.Z)(Q,2),xe=oe[0],Be=oe[1],qe=this.rendererService.getViewportSize(),zt=qe.width,Ht=qe.height;this.prevSize=[zt,Ht];var Tr=document.createElement("canvas");this.canvas=Tr,Tr.width=zt,Tr.height=Ht,Tr.style.pointerEvents="none",Tr.style.width=xe+"px",Tr.style.height=Be+"px",Tr.style.position="absolute",Tr.style.top="0",Tr.style.left="0",Tr.style.zIndex=k+"",(h=this.mapService.getContainer())===null||h===void 0||h.appendChild(Tr);var en=Tr.getContext("2d");this.ctx=en}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){}}]),x}(Y.Z),vt={canvas:Re},wt=vt;function fe(f){var F=$e();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function $e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var re=function(f){(0,L.Z)(x,f);var F=fe(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","CanvasLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new wt[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={canvas:{}};return S[h]}},{key:"getModelType",value:function(){return"canvas"}}]),x}(V.Z),Ge=y(86049),Qe=y(42184);function Te(f){var F=Le();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Le(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Ce=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

uniform float u_circleSweep;
uniform float u_cityMinSize;
uniform vec3 u_circleSweepColor;
uniform float u_circleSweepSpeed;

varying float v_worldDis;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }


  if(u_circleSweep > 0.0 && v_worldDis < u_cityMinSize) {
    float r = fract(((v_worldDis/u_cityMinSize) - u_time * u_circleSweepSpeed) * 2.0);
    gl_FragColor.rgb += r * r * u_circleSweepColor;
  }
   
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Fe=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;
uniform mat4 u_Mvp;

uniform float u_circleSweep;
uniform vec2 u_cityCenter;

varying float v_worldDis;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"


void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

   v_texCoord = a_Uv;

  if(u_circleSweep > 0.0) {
     vec2 lnglatscale = vec2(0.0);
    if(u_CoordinateSystem != COORDINATE_SYSTEM_P20_2) {
      lnglatscale = (a_Position.xy - u_cityCenter) * vec2(0.0, 0.135);
    }
    v_worldDis = length(a_Position.xy + lnglatscale - u_cityCenter);
  }
 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Ke=function(f){(0,L.Z)(x,f);var F=Te(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"cityCenter",void 0),(0,B.Z)((0,P.Z)(p),"cityMinSize",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.baseColor,oe=Q===void 0?"rgb(16,16,16)":Q,xe=h.brightColor,Be=xe===void 0?"rgb(255,176,38)":xe,qe=h.windowColor,zt=qe===void 0?"rgb(30,60,89)":qe,Ht=h.time,Tr=Ht===void 0?0:Ht,en=h.sweep,An=en===void 0?{enable:!1,sweepRadius:1,sweepColor:"rgb(255, 255, 255)",sweepSpeed:.4,sweepCenter:this.cityCenter}:en;return{u_cityCenter:An.sweepCenter||this.cityCenter,u_cityMinSize:this.cityMinSize*An.sweepRadius,u_circleSweep:An.enable?1:0,u_circleSweepColor:(0,Ge.rgb2arr)(An.sweepColor).slice(0,3),u_circleSweepSpeed:An.sweepSpeed,u_opacity:k,u_baseColor:(0,Ge.rgb2arr)(oe),u_brightColor:(0,Ge.rgb2arr)(Be),u_windowColor:(0,Ge.rgb2arr)(zt),u_time:this.layer.getLayerAnimateTime()||Tr}}},{key:"calCityGeo",value:function(){var h=(0,N.Z)(this.layer.getSource().extent,4),S=h[0],k=h[1],Q=h[2],oe=h[3];if(this.mapService.version==="GAODE2.x"){this.cityCenter=this.mapService.lngLatToCoord([(Q+S)/2,(oe+k)/2]);var xe=this.mapService.lngLatToCoord([Q,oe]),Be=this.mapService.lngLatToCoord([S,k]);this.cityMinSize=Math.sqrt(Math.pow(xe[0]-Be[0],2)+Math.pow(xe[1]-Be[1],2))/4}else{var qe=Q-S,zt=oe-k;this.cityCenter=[(Q+S)/2,(oe+k)/2],this.cityMinSize=Math.sqrt(Math.pow(qe,2)+Math.pow(zt,2))/4}}},{key:"initModels",value:function(){return this.calCityGeo(),this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Fe,fragmentShader:Ce,triangulation:Qe.Xz,cull:{enable:!0,face:v.gl.BACK}})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k,Q,oe,xe){return xe}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?10:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){var xe=S.size;return[Q[3],Q[4]]}}})}}]),x}(Y.Z);function qt(f){var F=ir();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ir(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Pe=function(f){(0,L.Z)(x,f);var F=qt(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","PolygonLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){this.layerModel=new Ke(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(h){this.updateLayerConfig({time:h})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),x}(V.Z),Ne=y(17553),Xe=y(84859);function kt(f){var F=rr();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function rr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var me=`
uniform sampler2D u_texture;
uniform float u_mapFlag;
uniform float u_opacity;

varying vec3 v_Color;
varying vec2 v_uv;
varying float v_clip;

#pragma include "picking"
void main() {
  // gl_FragColor = vec4(v_Color, u_opacity);
  if(u_mapFlag > 0.0) {
    gl_FragColor = texture2D(u_texture, vec2(v_uv.x, 1.0 - v_uv.y));
    gl_FragColor.a *= u_opacity;
  } else {
    // gl_FragColor = vec4(v_uv, 0.0, u_opacity);
    gl_FragColor = vec4(v_Color, u_opacity);
  }
  gl_FragColor.a *= v_clip;
  gl_FragColor = filterColor(gl_FragColor);
}
`,et=`precision highp float;
uniform mat4 u_ModelMatrix;

uniform mat4 u_Mvp;
uniform float u_opacity;
uniform float u_terrainClipHeight;

attribute vec3 a_Position;
attribute vec2 a_Uv;
attribute vec3 a_Color;

varying vec3 v_Color;
varying vec2 v_uv;
varying float v_clip;

#pragma include "projection"
#pragma include "picking"
void main() {
   v_Color = a_Color;
   v_uv = a_Uv;
  
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   v_clip = 1.0;
   if(a_Position.z < u_terrainClipHeight) {
      v_clip = 0.0;
   }
  
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));

   // float x = 1.0;
   // float y = 0.0;
   // float z = 0.0;
   // mat3 translateMatrix = mat3(
   //    1.0, 0.0, 0.0 
   //    0.0, 1.0, 0.0
   //    -project_pos.x,    -project_pos.y,  1.0
   // );
   //  mat4 translateMatrix = mat4(
   //    1.0, 0.0, 0.0, 0.0 ,
   //    0.0, 1.0, 0.0, 0.0,
   //    0.0, 0.0, 1.0, 0.0,
   //    1.0, 0.0, 0.0, 1.0
   // );

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));
   }

   setPickingColor(a_PickingColor);
}
`,or=function(f){(0,L.Z)(x,f);var F=kt(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"mapTexture",void 0),(0,B.Z)((0,P.Z)(p),"positions",void 0),(0,B.Z)((0,P.Z)(p),"indices",void 0),(0,B.Z)((0,P.Z)(p),"planeGeometryTriangulation",function(){var Q,oe=p.layer.getLayerConfig(),xe=oe.width,Be=xe===void 0?1:xe,qe=oe.height,zt=qe===void 0?1:qe,Ht=oe.widthSegments,Tr=Ht===void 0?1:Ht,en=oe.heightSegments,An=en===void 0?1:en,Hn=oe.center,si=Hn===void 0?[120,30]:Hn,ni=oe.terrainTexture,di=(Q=p).initPlane.apply(Q,[Be,zt,Tr,An].concat((0,Ne.Z)(si))),qi=di.indices,ta=di.positions;return p.positions=ta,p.indices=qi,ni&&p.loadTerrainTexture(),{vertices:ta,indices:qi,size:5}}),(0,B.Z)((0,P.Z)(p),"planeGeometryUpdateTriangulation",function(){return{vertices:p.positions,indices:p.indices,size:5}}),p}return(0,a.Z)(x,[{key:"initPlane",value:function(){for(var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,oe=arguments.length>4&&arguments[4]!==void 0?arguments[4]:120,xe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,Be=h/2,qe=S/2,zt=Math.floor(k),Ht=Math.floor(Q),Tr=zt+1,en=Ht+1,An=h/zt,Hn=S/Ht,si=[],ni=[],di=0;di<en;di++)for(var qi=di*Hn-qe,ta=0;ta<Tr;ta++){var Xi=ta*An-Be;if(this.mapService.version===Xe.G["GAODE2.x"]){var Ja=this.mapService.lngLatToCoord([Xi+oe,-qi+xe]),po=(0,N.Z)(Ja,2),zo=po[0],Ta=po[1];ni.push(zo,Ta,0)}else ni.push(Xi+oe,-qi+xe,0);ni.push(ta/zt),ni.push(1-di/Ht)}for(var Io=0;Io<Ht;Io++)for(var co=0;co<zt;co++){var qs=co+Tr*Io,yl=co+Tr*(Io+1),bc=co+1+Tr*(Io+1),Fc=co+1+Tr*Io;si.push(qs,yl,Fc),si.push(yl,bc,Fc)}return{indices:si,positions:ni}}},{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.mapTexture,Q=h.terrainClipHeight,oe=Q===void 0?0:Q,xe=h.terrainTexture;if(this.mapTexture!==k){var Be;this.mapTexture=k,(Be=this.texture)===null||Be===void 0||Be.destroy(),this.updateTexture(k)}return{u_opacity:S||1,u_mapFlag:k?1:0,u_terrainClipHeight:xe?oe:-1,u_texture:this.texture}}},{key:"clearModels",value:function(){var h;(h=this.texture)===null||h===void 0||h.destroy()}},{key:"initModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=h.mapTexture;this.mapTexture=xe;var Be=this.rendererService.createTexture2D;return this.texture=Be({height:0,width:0}),this.updateTexture(xe),[this.layer.buildLayerModel({moduleName:"geometry_plane",vertexShader:et,fragmentShader:me,triangulation:this.planeGeometryTriangulation,primitive:v.gl.TRIANGLES,depth:{enable:!0},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe),cull:{enable:!0,face:v.gl.BACK}})]}},{key:"getImageData",value:function(h){var S=document.createElement("canvas"),k=S.getContext("2d"),Q=h.width,oe=h.height;S.width=Q,S.height=oe,k.drawImage(h,0,0,Q,oe);var xe=k.getImageData(0,0,Q,oe);return xe}},{key:"loadTerrainTexture",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.mask,Q=k===void 0?!1:k,oe=S.maskInside,xe=oe===void 0?!0:oe,Be=S.widthSegments,qe=Be===void 0?1:Be,zt=S.heightSegments,Ht=zt===void 0?1:zt,Tr=S.terrainTexture,en=S.rgb2height,An=en===void 0?function(si,ni,di){return si+ni+di}:en,Hn=new Image;Hn.crossOrigin="anonymous",Hn.onload=function(){for(var si=Hn.width,ni=Hn.height,di=h.getImageData(Hn).data,qi=Math.floor(qe),ta=Math.floor(Ht),Xi=qi+1,Ja=ta+1,po=si/qi,zo=ni/ta,Ta=0;Ta<Ja;Ta++)for(var Io=Math.floor(Ta*zo),co=Io*si,qs=0;qs<Xi;qs++){var yl=Math.floor(qs*po),bc=(co+yl)*4,Fc=di[bc],Yf=di[bc+1],zl=di[bc+2],zh=(Ta*Xi+qs)*5+2;h.positions[zh]=An(Fc,Yf,zl)}h.layer.models=[h.layer.buildLayerModel({moduleName:"geometry_plane",vertexShader:et,fragmentShader:me,triangulation:h.planeGeometryUpdateTriangulation,primitive:v.gl.TRIANGLES,depth:{enable:!0},blend:h.getBlend(),stencil:(0,Ge.getMask)(Q,xe),cull:{enable:!0,face:v.gl.BACK}})],h.layerService.renderLayers()},Hn.src=Tr}},{key:"buildModels",value:function(){return this.initModels()}},{key:"updateTexture",value:function(h){var S=this,k=this.rendererService.createTexture2D;if(h){var Q=new Image;Q.crossOrigin="anonymous",Q.onload=function(){S.texture=k({data:Q,width:Q.width,height:Q.height,wrapS:v.gl.CLAMP_TO_EDGE,wrapT:v.gl.CLAMP_TO_EDGE}),S.layerService.updateLayerRenderList(),S.layerService.renderLayers()},Q.src=h}else this.texture=k({width:0,height:0})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}}]),x}(Y.Z);function on(f){var F=vr();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function vr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var jr=`
uniform sampler2D u_texture;
uniform float u_mapFlag;
uniform float u_opacity;

varying vec3 v_Color;
varying float v_d;

#pragma include "picking"
void main() {

  if(v_d < 0.0) {
    discard;
  }

  if(u_mapFlag > 0.0) {
    gl_FragColor = texture2D(u_texture, gl_PointCoord);
    gl_FragColor.a *= u_opacity;
  } else {
    gl_FragColor = vec4(v_Color, u_opacity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,xr=`precision highp float;

attribute vec3 a_Position;
attribute vec3 a_Color;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity;
uniform float u_Scale;
varying vec3 v_Color;
varying float v_d;

#pragma include "projection"
#pragma include "picking"
void main() {
   v_Color = a_Color;
  
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   v_d = a_Position.z;

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));
   }

   gl_PointSize = pow((u_Zoom - 1.0), 2.0) * u_Scale;

   setPickingColor(a_PickingColor);
}
`,Ae;(function(f){f.UP="up",f.DOWN="down"})(Ae||(Ae={}));var De=function(f){(0,L.Z)(x,f);var F=on(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"mapTexture",void 0),(0,B.Z)((0,P.Z)(p),"positions",void 0),(0,B.Z)((0,P.Z)(p),"indices",void 0),(0,B.Z)((0,P.Z)(p),"timer",void 0),(0,B.Z)((0,P.Z)(p),"spriteTop",void 0),(0,B.Z)((0,P.Z)(p),"spriteUpdate",void 0),(0,B.Z)((0,P.Z)(p),"spriteAnimate",void 0),(0,B.Z)((0,P.Z)(p),"planeGeometryUpdateTriangulation",function(){for(var Q=p.spriteUpdate,oe=-1e5,xe=p.spriteTop,Be=0;Be<p.positions.length;Be+=5)p.spriteAnimate===Ae.UP?(p.positions[Be+2]+=Q,p.positions[Be+2]>xe&&(p.positions[Be+2]=oe)):(p.positions[Be+2]-=Q,p.positions[Be+2]<oe&&(p.positions[Be+2]=xe));return{vertices:p.positions,indices:p.indices,size:5}}),(0,B.Z)((0,P.Z)(p),"updateModel",function(){var Q=p.layer.createAttrubutes({triangulation:p.planeGeometryUpdateTriangulation});p.layer.models.map(function(oe){oe.updateAttributes(Q)}),p.layer.renderLayers(),p.timer=requestAnimationFrame(p.updateModel)}),(0,B.Z)((0,P.Z)(p),"planeGeometryTriangulation",function(){var Q,oe=p.layer.getLayerConfig(),xe=oe.center,Be=xe===void 0?[120,30]:xe,qe=oe.spriteCount,zt=qe===void 0?100:qe,Ht=oe.spriteRadius,Tr=Ht===void 0?10:Ht,en=(Q=p).initSprite.apply(Q,[Tr,zt].concat((0,Ne.Z)(Be))),An=en.indices,Hn=en.positions;return p.positions=Hn,p.indices=An,{vertices:Hn,indices:An,size:5}}),p}return(0,a.Z)(x,[{key:"initSprite",value:function(){for(var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:120,Q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:30,oe=[],xe=[],Be=this.mapService,qe=this.spriteAnimate===Ae.UP?-this.spriteTop:this.spriteTop,zt=0;zt<S;zt++){var Ht=Math.random()*qe;xe.push.apply(xe,(0,Ne.Z)(en(Ht)))}for(var Tr=0;Tr<S;Tr++)oe.push(Tr);function en(An){var Hn=h*Math.random(),si=h*Math.random(),ni=-h/2+Hn,di=-h/2+si;if(Be.version===Xe.G["GAODE2.x"]){var qi=Be.lngLatToCoord([ni+k,-di+Q]),ta=(0,N.Z)(qi,2),Xi=ta[0],Ja=ta[1];return[Xi,Ja,An,0,0]}else return[ni+k,-di+Q,An,0,0]}return{indices:oe,positions:xe}}},{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.mapTexture,Q=h.spriteScale,oe=Q===void 0?1:Q;if(this.mapTexture!==k){var xe;this.mapTexture=k,(xe=this.texture)===null||xe===void 0||xe.destroy(),this.updateTexture(k)}return{u_opacity:S||1,u_mapFlag:k?1:0,u_texture:this.texture,u_Scale:oe}}},{key:"clearModels",value:function(){var h;cancelAnimationFrame(this.timer),(h=this.texture)===null||h===void 0||h.destroy()}},{key:"initModels",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.mapTexture,Q=S.spriteTop,oe=Q===void 0?5e6:Q,xe=S.spriteUpdate,Be=xe===void 0?1e4:xe,qe=S.spriteAnimate,zt=qe===void 0?Ae.DOWN:qe;this.mapTexture=k,this.spriteTop=oe,this.spriteUpdate=Be,zt==="up"?this.spriteAnimate=Ae.UP:this.spriteAnimate=Ae.DOWN;var Ht=this.rendererService.createTexture2D;return this.texture=Ht({height:0,width:0}),this.updateTexture(k),setTimeout(function(){h.updateModel()},100),[this.layer.buildLayerModel({moduleName:"geometry_sprite",vertexShader:xr,fragmentShader:jr,triangulation:this.planeGeometryTriangulation,primitive:v.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"updateTexture",value:function(h){var S=this,k=this.rendererService.createTexture2D;if(h){var Q=new Image;Q.crossOrigin="anonymous",Q.onload=function(){S.texture=k({data:Q,width:Q.width,height:Q.height,wrapS:v.gl.CLAMP_TO_EDGE,wrapT:v.gl.CLAMP_TO_EDGE}),S.layerService.updateLayerRenderList(),S.layerService.renderLayers()},Q.src=h}else this.texture=k({width:0,height:0})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){return""}}]),x}(Y.Z),ke={plane:or,sprite:De},Bt=ke;function mt(f){var F=Mr();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Mr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Cr=function(f){(0,L.Z)(x,f);var F=mt(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","GeometryLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new Bt[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={plane:{},sprite:{}};return S[h]}},{key:"getModelType",value:function(){var h,S=this.styleAttributeService.getLayerStyleAttribute("shape"),k=S==null||(h=S.scale)===null||h===void 0?void 0:h.field;return k==="plane"?"plane":k==="sprite"?"sprite":"plane"}}]),x}(V.Z);function Nr(f){var F=nt();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function nt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Ye=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
uniform mat4 u_Mvp;\r
varying vec4 v_color;\r
\r
uniform vec2 u_SceneCenterMKT;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  // gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\r
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807\r
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));\r
    gl_Position = u_Mvp * (project_pos);\r
  } else {\r
     vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
    gl_Position = project_common_position_to_clipspace(project_pos);\r
  }\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,M=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,W=function(f){(0,L.Z)(x,f);var F=Nr(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.coverage,Q=h.angle;return{u_opacity:S||1,u_coverage:k||.9,u_angle:Q||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Ye,fragmentShader:M,triangulation:Qe.Rs,depth:{enable:!1},primitive:v.gl.TRIANGLES,blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:v.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k){var Q=S.version==="GAODE2.x"?S.originCoordinates:S.coordinates;return[Q[0],Q[1],0]}}})}}]),x}(Y.Z);function ue(f){var F=X();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function X(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var ie=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"


void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
  // vec2 lnglat = (a_Pos.xy + offset); 
  // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  // gl_Position = project_common_position_to_clipspace(project_pos);
  // float lightWeight = calc_lighting(project_pos);
  // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 lnglat = (a_Pos.xy + offset); 
    // vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));

    // float lightWeight = calc_lighting(project_pos);
    // v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    // gl_Position = u_Mvp * vec4(lnglat , a_Position.z * a_Size, 1.0);
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u7ECF\u7EAC\u5EA6
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807
    vec4 project_pos = project_position(vec4(customLnglat, a_Position.z * a_Size, 1.0));

    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    gl_Position = u_Mvp * vec4(customLnglat , a_Position.z * a_Size, 1.0);
  } else {
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
    vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
    
    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
    
    gl_Position = project_common_position_to_clipspace(project_pos);
  }



  setPickingColor(a_PickingColor);
}
`,ye=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,J=function(f){(0,L.Z)(x,f);var F=ue(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.coverage,Q=h.angle;return{u_opacity:S||1,u_coverage:k||1,u_angle:Q||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:ie,fragmentShader:ye,triangulation:Qe.NM,depth:{enable:!0},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size;return Array.isArray(xe)?[xe[0]]:[xe]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k,Q,oe,xe){return xe}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:v.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k){var Q=S.version==="GAODE2.x"?S.originCoordinates:S.coordinates;return[Q[0],Q[1],0]}}})}}]),x}(Y.Z),ht=y(85975),ze=y(86700),pt=y(28660);function Me(f,F){for(var x=[],p=[],h=[],S=f+1,k=F+1,Q=f/2,oe=F/2,xe=0;xe<k;xe++)for(var Be=xe-oe,qe=0;qe<S;qe++){var zt=qe-Q;p.push(zt/Q,-Be/oe,0),h.push(qe/f),h.push(1-xe/F)}for(var Ht=0;Ht<F;Ht++)for(var Tr=0;Tr<f;Tr++){var en=Tr+S*Ht,An=Tr+S*(Ht+1),Hn=Tr+1+S*(Ht+1),si=Tr+1+S*Ht;x.push(en,An,si),x.push(An,Hn,si)}return{vertices:p,indices:x,uvs:h}}var Ue,yt;function gt(f,F){var x=Object.keys(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(f);F&&(p=p.filter(function(h){return Object.getOwnPropertyDescriptor(f,h).enumerable})),x.push.apply(x,p)}return x}function nr(f){for(var F=1;F<arguments.length;F++){var x=arguments[F]!=null?arguments[F]:{};F%2?gt(Object(x),!0).forEach(function(p){(0,B.Z)(f,p,x[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(x)):gt(Object(x)).forEach(function(p){Object.defineProperty(f,p,Object.getOwnPropertyDescriptor(x,p))})}return f}function pe(f){var F=lr();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function lr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Ur=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,Hr=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;


vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9
	vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0.0, 1.0, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);
 
}
`,un=`uniform sampler2D u_texture;        // \u70ED\u529B\u5F3A\u5EA6\u56FE
uniform sampler2D u_colorTexture;   // \u6839\u636E\u5F3A\u5EA6\u5206\u5E03\u7684\u8272\u5E26
uniform float u_opacity;
varying vec2 v_texCoord;

float getBlurIndusty() {
    float h = 2.0/512.0;
    vec2 vUv = v_texCoord;
    float i11 = texture2D( u_texture, vec2( vUv.x - 1.0 * h, vUv.y + 1.0 * h) ).r;
    float i12 = texture2D( u_texture, vec2( vUv.x - 0.0 * h, vUv.y + 1.0 * h) ).r;
    float i13 = texture2D( u_texture, vec2( vUv.x + 1.0 * h, vUv.y + 1.0 * h) ).r;

    float i21 = texture2D( u_texture, vec2( vUv.x - 1.0 * h, vUv.y) ).r;
    float i22 = texture2D( u_texture, vec2( vUv.x , vUv.y) ).r;
    float i23 = texture2D( u_texture, vec2( vUv.x + 1.0 * h, vUv.y) ).r;

    float i31 = texture2D( u_texture, vec2( vUv.x - 1.0 * h, vUv.y-1.0*h) ).r;
    float i32 = texture2D( u_texture, vec2( vUv.x - 0.0 * h, vUv.y-1.0*h) ).r;
    float i33 = texture2D( u_texture, vec2( vUv.x + 1.0 * h, vUv.y-1.0*h) ).r;

    return(
        i11 + 
        i12 + 
        i13 + 
        i21 + 
        i21 + 
        i22 + 
        i23 + 
        i31 + 
        i32 + 
        i33
        )/9.0;
}


void main(){
    // float intensity = texture2D(u_texture, v_texCoord).r;
    float intensity = getBlurIndusty();
    vec4 color = texture2D(u_colorTexture, vec2(intensity, 0.0));

    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,bn=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;

void main() {
  v_texCoord = a_Uv;

  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Gn=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,li=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
        gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
        gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
}
`,$r=(Ue=(0,ze.b2)(),Ue(yt=function(f){(0,L.Z)(x,f);var F=pe(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"colorTexture",void 0),(0,B.Z)((0,P.Z)(p),"heatmapFramerBuffer",void 0),(0,B.Z)((0,P.Z)(p),"intensityModel",void 0),(0,B.Z)((0,P.Z)(p),"colorModel",void 0),(0,B.Z)((0,P.Z)(p),"shapeType",void 0),p}return(0,a.Z)(x,[{key:"render",value:function(){var h=this,S=this.rendererService,k=S.clear,Q=S.useFramebuffer;Q(this.heatmapFramerBuffer,function(){k({color:[0,0,0,0],depth:1,stencil:0,framebuffer:h.heatmapFramerBuffer}),h.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var h,S=this.rendererService,k=S.createFramebuffer,Q=S.clear,oe=S.getViewportSize,xe=S.createTexture2D,Be=S.useFramebuffer,qe=this.styleAttributeService.getLayerStyleAttribute("shape"),zt=(qe==null||(h=qe.scale)===null||h===void 0?void 0:h.field)||"heatmap";this.shapeType=zt,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=zt==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Ht=oe(),Tr=Ht.width,en=Ht.height;return this.heatmapFramerBuffer=k({color:xe({width:Math.floor(Tr/4),height:Math.floor(en/4),wrapS:v.gl.CLAMP_TO_EDGE,wrapT:v.gl.CLAMP_TO_EDGE,min:v.gl.LINEAR,mag:v.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:v.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return[Be]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:li,fragmentShader:Gn,triangulation:Qe.zO,depth:{enable:!1},cull:{enable:!0,face:(0,Ge.getCullFace)(this.mapService.version)},blend:{enable:!0,func:{srcRGB:v.gl.ONE,srcAlpha:1,dstRGB:v.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;this.shaderModuleService.registerModule("heatmapColor",{vs:bn,fs:un});var xe=this.shaderModuleService.getModule("heatmapColor"),Be=xe.vs,qe=xe.fs,zt=xe.uniforms,Ht=this.rendererService,Tr=Ht.createAttribute,en=Ht.createElements,An=Ht.createBuffer,Hn=Ht.createModel;return Hn({vs:Be,fs:qe,attributes:{a_Position:Tr({buffer:An({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:v.gl.FLOAT}),size:3}),a_Uv:Tr({buffer:An({data:[0,1,1,1,0,0,1,0],type:v.gl.FLOAT}),size:2})},uniforms:nr({},zt),depth:{enable:!1},blend:this.getBlend(),count:6,elements:en({data:[0,2,1,2,3,1],type:v.gl.UNSIGNED_INT,count:6}),stencil:(0,Ge.getMask)(k,oe)})}},{key:"drawIntensityMode",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.intensity,Q=k===void 0?10:k,oe=h.radius,xe=oe===void 0?5:oe;this.intensityModel.draw({uniforms:{u_opacity:S||1,u_radius:xe,u_intensity:Q}})}},{key:"drawColorMode",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity;this.colorModel.draw({uniforms:{u_opacity:S||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=ht.create();ht.invert(k,this.cameraService.getViewProjectionMatrixUncentered()),this.colorModel.draw({uniforms:{u_opacity:S||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:(0,Ne.Z)(k)}})}},{key:"build3dHeatMap",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=this.rendererService.getViewportSize,Be=xe(),qe=Be.width,zt=Be.height,Ht=Me(qe/4,zt/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Hr,fs:Ur});var Tr=this.shaderModuleService.getModule("heatmap3dColor"),en=Tr.vs,An=Tr.fs,Hn=Tr.uniforms,si=this.rendererService,ni=si.createAttribute,di=si.createElements,qi=si.createBuffer,ta=si.createModel;return ta({vs:en,fs:An,attributes:{a_Position:ni({buffer:qi({data:Ht.vertices,type:v.gl.FLOAT}),size:3}),a_Uv:ni({buffer:qi({data:Ht.uvs,type:v.gl.FLOAT}),size:2})},primitive:v.gl.TRIANGLES,uniforms:nr({},Hn),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:v.gl.SRC_ALPHA,srcAlpha:1,dstRGB:v.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:di({data:Ht.indices,type:v.gl.UNSIGNED_INT,count:Ht.indices.length}),stencil:(0,Ge.getMask)(k,oe)})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var h=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var S=this.layer.getLayerConfig(),k=S.rampColors,Q=(0,Ge.generateColorRamp)(k);this.colorTexture=h({data:new Uint8Array(Q.data),width:Q.width,height:Q.height,wrapS:v.gl.CLAMP_TO_EDGE,wrapT:v.gl.CLAMP_TO_EDGE,min:v.gl.NEAREST,mag:v.gl.NEAREST,flipY:!1})}}]),x}(Y.Z))||yt);function Zt(f){var F=it();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function it(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var ne=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,_e=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
 
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy, 0., 1.0));
    // gl_Position = u_Mvp * (vec4(a_Pos.xy + offset, 0., 1.0));
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT;
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));
    gl_Position = u_Mvp * vec4(project_pos.xy, 0.0, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Oe=function(f){(0,L.Z)(x,f);var F=Zt(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.coverage,Q=h.angle;return{u_opacity:S||1,u_coverage:k||.9,u_angle:Q||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:_e,fragmentShader:ne,triangulation:Qe.Rs,depth:{enable:!1},primitive:v.gl.TRIANGLES,blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:v.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k){var Q=S.version==="GAODE2.x"?S.originCoordinates:S.coordinates;return[Q[0],Q[1],0]}}})}}]),x}(Y.Z),je={heatmap:$r,heatmap3d:$r,grid:W,grid3d:J,hexagon:Oe},dt=je;function Ut(f){var F=ur();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ur(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var lt=function(f){(0,L.Z)(x,f);var F=Ut(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","HeatMapLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new dt[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var h=this,S=this.getModelType();return S==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(k){return k.draw({uniforms:h.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var h,S=this.styleAttributeService.getLayerStyleAttribute("shape"),k=this.getLayerConfig(),Q=k.shape3d,oe=this.getSource(),xe=oe.data.type,Be=(S==null||(h=S.scale)===null||h===void 0?void 0:h.field)||"heatmap";return Be==="heatmap"||Be==="heatmap3d"?"heatmap":xe==="hexagon"?(Q==null?void 0:Q.indexOf(Be))===-1?"hexagon":"grid3d":xe==="grid"?(Q==null?void 0:Q.indexOf(Be))===-1?"grid":"grid3d":"heatmap"}}]),x}(V.Z);function Nt(f){var F=Sr();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Sr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var fn=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Br=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Jr=function(f){(0,L.Z)(x,f);var F=Nt(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity;return{u_opacity:S||1,u_texture:this.texture}}},{key:"initModels",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.mask,Q=k===void 0?!1:k,oe=S.maskInside,xe=oe===void 0?!0:oe,Be=this.layer.getSource(),qe=this.rendererService.createTexture2D;if(this.texture=qe({height:0,width:0}),Ge.isMini){var zt=this.layerService.sceneService.getSceneConfig().canvas,Ht=zt.createImage();Ht.crossOrigin="anonymous",Ht.src=Be.data.originData,Ht.onload=function(){h.texture=qe({data:Ht,width:Ht.width,height:Ht.height}),h.layerService.updateLayerRenderList(),h.layerService.renderLayers()}}else Be.data.images.then(function(Tr){h.texture=qe({data:Tr[0],width:Tr[0].width,height:Tr[0].height}),h.layerService.updateLayerRenderList(),h.layerService.renderLayers()});return[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Br,fragmentShader:fn,triangulation:Qe.iC,primitive:v.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:(0,Ge.getMask)(Q,xe)})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}}]),x}(Y.Z),Tn={image:Jr},hi=Tn;function On(f){var F=Pr();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Pr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var vi=function(f){(0,L.Z)(x,f);var F=On(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","ImageLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new hi[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={image:{}};return S[h]}},{key:"getModelType",value:function(){return"image"}}]),x}(V.Z);function Jn(f){var F=ui();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ui(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Da=function(f){(0,L.Z)(x,f);var F=Jn(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"isLayerGroup",!0),p}return(0,a.Z)(x,[{key:"addChild",value:function(h){this.layerChildren.push(h)}},{key:"removeChild",value:function(h){var S=this.layerChildren.indexOf(h);S>-1&&this.layerChildren.splice(S,1),h.destroy()}},{key:"clearChild",value:function(){this.layerChildren.forEach(function(h){h.destroy()}),this.layerChildren=[]}}]),x}(V.Z),Yn=y(56086),wa=180/Math.PI,vo=/\{([zxy])\}/g,Ua=function(){function f(F,x,p,h){(0,Z.Z)(this,f),(0,B.Z)(this,"tile",void 0),(0,B.Z)(this,"name",void 0),(0,B.Z)(this,"imageLayer",void 0),this.name=F,this.tile=F.split("_").map(function(Ht){return Number(Ht)});var S={x:this.tile[0],y:this.tile[1],z:this.tile[2]},k=this.getTileURL(S,x),Q=this.tileLnglatBounds(this.tile),oe=Q.getWest(),xe=Q.getSouth(),Be=Q.getEast(),qe=Q.getNorth(),zt=new vi({zIndex:-999});zt.source(k,{parser:{type:"image",extent:[oe,xe,Be,qe]}}),zt.setContainer(p,h),zt.init(),this.imageLayer=zt}return(0,a.Z)(f,[{key:"destroy",value:function(){this.imageLayer.clearModels(),this.imageLayer.destroy()}},{key:"getTileURL",value:function(x,p){return x.s||(x.s=String.fromCharCode(97+Math.floor(Math.random()*3))),vo.lastIndex=0,p.replace(vo,function(h,S){return x[S]})}},{key:"tileLnglatBounds",value:function(x){var p=this.tile2lng(x[0]+1,x[2]),h=this.tile2lng(x[0],x[2]),S=this.tile2lat(x[1]+1,x[2]),k=this.tile2lat(x[1],x[2]);return(0,Yn.Dv)([h,k],[p,S])}},{key:"tile2lng",value:function(x,p){return x/Math.pow(2,p)*360-180}},{key:"tile2lat",value:function(x,p){var h=Math.PI-2*Math.PI*x/Math.pow(2,p);return wa*Math.atan(.5*(Math.exp(h)-Math.exp(-h)))}}]),f}(),Ka=function(){function f(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return""};(0,Z.Z)(this,f),(0,B.Z)(this,"limit",void 0),(0,B.Z)(this,"order",void 0),(0,B.Z)(this,"cache",void 0),(0,B.Z)(this,"destroy",void 0),this.limit=F,this.destroy=x,this.order=[],this.clear()}return(0,a.Z)(f,[{key:"clear",value:function(){var x=this;this.order.forEach(function(p){x.delete(p)}),this.cache={},this.order=[]}},{key:"get",value:function(x){var p=this.cache[x];return p&&(this.deleteOrder(x),this.appendOrder(x)),p}},{key:"set",value:function(x,p){this.cache[x]?(this.delete(x),this.cache[x]=p,this.appendOrder(x)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[x]=p,this.appendOrder(x))}},{key:"delete",value:function(x){var p=this.cache[x];p&&(this.deleteCache(x),this.deleteOrder(x),this.destroy(p,x))}},{key:"deleteCache",value:function(x){delete this.cache[x]}},{key:"deleteOrder",value:function(x){var p=this.order.findIndex(function(h){return h===x});p>=0&&this.order.splice(p,1)}},{key:"appendOrder",value:function(x){this.order.push(x)}}]),f}(),Ga=function(){function f(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,x=arguments.length>1?arguments[1]:void 0;(0,Z.Z)(this,f),(0,B.Z)(this,"cache",void 0),this.cache=new Ka(F,x)}return(0,a.Z)(f,[{key:"getTile",value:function(x){return this.cache.get(x)}},{key:"setTile",value:function(x,p){this.cache.set(p,x)}},{key:"destory",value:function(){this.cache.clear()}},{key:"setNeedUpdate",value:function(){var x=this;this.cache.order.forEach(function(p){var h=x.cache.get(p);h.needUpdate=!0})}}]),f}(),ei=30,eo=function(){function f(F){(0,Z.Z)(this,f),(0,B.Z)(this,"tileList",{}),(0,B.Z)(this,"tileCache",void 0),(0,B.Z)(this,"updateTileList",void 0),(0,B.Z)(this,"tileZoom",void 0),(0,B.Z)(this,"noPruneRange",void 0),(0,B.Z)(this,"url",void 0),(0,B.Z)(this,"resolution",void 0),(0,B.Z)(this,"maxSourceZoom",void 0),(0,B.Z)(this,"crstype",void 0),(0,B.Z)(this,"currentCrs",void 0),(0,B.Z)(this,"layerService",void 0),(0,B.Z)(this,"layer",void 0),this.layerService=F.layerService,this.layer=F.layer,this.url=F.url,this.resolution=F.resolution==="low"?-1:0,this.maxSourceZoom=F.maxSourceZoom,this.crstype=F.crstype,this.currentCrs=new Yn.fG.default({start:{x:0,y:0},end:{x:0,y:0},projection:this.crstype}).crs,this.destroyTile=this.destroyTile.bind(this),this.tileCache=new Ga(ei,this.destroyTile),this.updateTileList=[],this.removeTiles=this.removeTiles.bind(this)}return(0,a.Z)(f,[{key:"calCurrentTiles",value:function(x){var p=this,h=x.NE,S=x.SW,k=x.tileCenter,Q=x.currentZoom,oe=x.minSourceZoom,xe=x.minZoom,Be=x.maxZoom;if(!(Q>=this.maxSourceZoom)){var qe=Math.floor(Q)+this.resolution;if(this.tileZoom=qe>this.maxSourceZoom?this.maxSourceZoom:qe,Q<xe||Q>=Be||Q<oe){this.removeTiles();return}this.updateTileList=[];var zt=this.currentCrs.lngLatToPoint((0,Yn.WN)(k.lng,k.lat),this.tileZoom),Ht=zt.divideBy(256).floor(),Tr=this.getPixelBounds(h,S,k,this.tileZoom,this.currentCrs),en=this.pxBoundsToTileRange(Tr),An=4;if(this.noPruneRange=new Yn.YZ(en.getBottomLeft().subtract([An,-An]),en.getTopRight().add([An,-An])),!(isFinite(en.min.x)&&isFinite(en.min.y)&&isFinite(en.max.x)&&isFinite(en.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Hn=en.min.y;Hn<=en.max.y;Hn++)for(var si=en.min.x;si<=en.max.x;si++){var ni=[si,Hn,this.tileZoom],di=this.tileList[ni.join("_")];di?di.current=!0:(this.tileList[ni.join("_")]={current:!0,coords:ni},this.updateTileList.push(ni))}this.updateTileList.sort(function(qi,ta){var Xi=qi,Ja=ta,po=Math.pow(Xi[0]*1-Ht.x,2)+Math.pow(Xi[1]*1-Ht.y,2),zo=Math.pow(Ja[0]*1-Ht.x,2)+Math.pow(Ja[1]*1-Ht.y,2);return po-zo}),this.pruneTiles(),this.updateTileList.forEach(function(qi){var ta=qi.join("_");p.tileList[ta].current&&p.requestTile(ta)})}}},{key:"pxBoundsToTileRange",value:function(x){return new Yn.YZ(x.min.divideBy(256).floor(),x.max.divideBy(256).ceil().subtract([1,1]))}},{key:"getPixelBounds",value:function(x,p,h,S,k){var Q=S,oe=k.lngLatToPoint((0,Yn.WN)(x.lng,x.lat),Q),xe=k.lngLatToPoint((0,Yn.WN)(p.lng,p.lat),Q),Be=k.lngLatToPoint((0,Yn.WN)(h.lng,h.lat),Q),qe=Be.y-oe.y,zt=xe.y-Be.y,Ht,Tr;if(h.lng-x.lng>0||h.lng-p.lng<0){var en=Math.pow(2,Q)*256/360*(180-x.lng)+Math.pow(2,Q)*256/360*(p.lng+180);h.lng-x.lng>0?(Ht=Math.pow(2,Q)*256/360*(h.lng-x.lng),Tr=en-Ht):(Tr=Math.pow(2,Q)*256/360*(p.lng-h.lng),Ht=en-Tr)}else Ht=Math.pow(2,Q)*256/360*(h.lng-p.lng),Tr=Math.pow(2,Q)*256/360*(x.lng-h.lng);var An=new Yn.YZ(Be.subtract(Ht,qe),Be.add(Tr,zt));return An}},{key:"pruneTiles",value:function(){var x=this;Object.keys(this.tileList).map(function(p){var h=x.tileList[p].coords;(h[2]!==x.tileZoom||!x.noPruneRange.contains(new Yn.E9(h[0],h[1])))&&(x.tileList[p].current=!1)}),Object.keys(this.tileList).map(function(p){var h=x.tileList[p];h.retain=h.current}),Object.keys(this.tileList).map(function(p){var h=x.tileList[p];if(h.current&&!h.active){var S=p.split("_").map(function(Be){return Number(Be)}),k=(0,N.Z)(S,3),Q=k[0],oe=k[1],xe=k[2];x.retainParent(Q,oe,xe,xe-5)||x.retainChildren(Q,oe,xe,xe+2)}}),this.removeOutTiles()}},{key:"requestTile",value:function(x){var p=this.tileList[x];if(!!p){var h=this.tileCache.getTile(x);if(h)h.imageLayer.show(),p.current=!0,p.retain=!0,p.active=!0,this.pruneTiles();else{var S=(0,v.createLayerContainer)(this.layer.sceneContainer);h=new Ua(x,this.url,S,this.layer.sceneContainer),h.name=x,p.current=!0,p.retain=!0,p.active=!0,this.layer.addChild(h.imageLayer),this.tileCache.setTile(h,x),this.pruneTiles(),this.layerService.updateLayerRenderList(),this.layerService.renderLayers()}}}},{key:"retainParent",value:function(x,p,h,S){var k=Math.floor(x/2),Q=Math.floor(p/2),oe=h-1,xe=this.tileList[[k,Q,oe].join("_")];return xe&&xe.active?(xe.retain=!0,!0):(xe&&xe.loaded&&(xe.retain=!0),oe>S?this.retainParent(k,Q,oe,S):!1)}},{key:"retainChildren",value:function(x,p,h,S){for(var k=2*x;k<2*x+2;k++)for(var Q=2*p;Q<2*p+2;Q++){var oe=[k,Q,h+1].join("_"),xe=this.tileList[oe];if(xe&&xe.active){xe.retain=!0;continue}else xe&&xe.loaded&&(xe.retain=!0);h+1<S&&this.retainChildren(k,Q,h+1,S)}}},{key:"destroyTile",value:function(x){this.layer.removeChild(x.imageLayer),this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),x=null}},{key:"removeOutTiles",value:function(){for(var x in this.tileList)if(!this.tileList[x].retain){var p=this.tileCache.getTile(x);p&&p.imageLayer.hide(),delete this.tileList[x]}}},{key:"removeTiles",value:function(){this.layer.clearChild(),this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this.tileList={},this.tileCache.destory()}}]),f}();function ra(f){var F=Rn();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Rn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var qa=function(f){(0,L.Z)(x,f);var F=ra(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"tileLayer",void 0),(0,B.Z)((0,P.Z)(p),"timestamp",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){return{}}},{key:"tile",value:function(){var h=this.mapService.getBounds(),S=(0,N.Z)(h,2),k=S[0],Q=S[1],oe={lng:Q[0],lat:Q[1]},xe={lng:k[0],lat:k[1]};this.tileLayer.calCurrentTiles({NE:oe,SW:xe,tileCenter:this.mapService.getCenter(),currentZoom:this.mapService.getZoom(),minSourceZoom:this.mapService.getMinZoom(),minZoom:this.mapService.getMinZoom(),maxZoom:this.mapService.getMaxZoom()})}},{key:"initModels",value:function(){var h=this;this.layer.zIndex=-999;var S=this.layer.getLayerConfig(),k=S.resolution,Q=k===void 0?"low":k,oe=S.maxSourceZoom,xe=oe===void 0?17:oe,Be=this.layer.getSource();return Be.data.tileurl&&(this.tileLayer=new eo({url:Be.data.tileurl,layerService:this.layerService,layer:this.layer,resolution:Q,maxSourceZoom:xe,crstype:"epsg3857"}),this.tile(),this.mapService.on("mapchange",function(qe){h.timestamp&&(clearTimeout(h.timestamp),h.timestamp=null),h.timestamp=setTimeout(function(){h.mapService.getZoom()>=2&&h.tile()},500)})),[]}},{key:"clearModels",value:function(){this.tileLayer.removeTiles()}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){}}]),x}(Y.Z),ba={imageTile:qa},Na=ba;function wo(f){var F=ya();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ya(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Gt=function(f){(0,L.Z)(x,f);var F=wo(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","ImageTileLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new Na[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={imageTile:{}};return S[h]}},{key:"getModelType",value:function(){return"imageTile"}}]),x}(Da),gs=y(81763),Qi=y.n(gs);function So(f){var F=ll();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ll(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Ss=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  }
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,rs=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  

   styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,ls=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_aimate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_aimate.x == Animate) {
      time = u_time / u_aimate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_aimate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_aimate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
  // gl_FragColor = filterColor(gl_FragColor);
}`,Ia=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Ms=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,uo=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Qs={solid:0,dash:1},Ao=function(f){(0,L.Z)(x,f);var F=So(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"updateTexture",function(){var Q=p.rendererService.createTexture2D;if(p.texture){p.texture.update({data:p.iconService.getCanvas()}),p.layer.render();return}p.texture=Q({data:p.iconService.getCanvas(),mag:v.gl.NEAREST,min:v.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:p.iconService.canvasHeight||128})}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.sourceColor,Q=h.targetColor,oe=h.textureBlend,xe=oe===void 0?"normal":oe,Be=h.lineType,qe=Be===void 0?"solid":Be,zt=h.dashArray,Ht=zt===void 0?[10,5]:zt,Tr=h.forward,en=Tr===void 0?!0:Tr,An=h.lineTexture,Hn=An===void 0?!1:An,si=h.iconStep,ni=si===void 0?100:si,di=h.segmentNumber,qi=di===void 0?30:di,ta=h.thetaOffset,Xi=ta===void 0?.314:ta;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:S,thetaOffset:Xi})){this.judgeStyleAttributes({opacity:S,thetaOffset:Xi});var Ja=this.layer.getEncodedData(),po=this.calDataFrame(this.cellLength,Ja,this.cellProperties),zo=po.data,Ta=po.width,Io=po.height;this.rowCount=Io,this.dataTexture=this.cellLength>0&&zo.length>0?this.createTexture2D({flipY:!0,data:zo,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:Ta,height:Io}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}Ht.length===2&&Ht.push(0,0);var co=0,qs=[0,0,0,0],yl=[0,0,0,0];return k&&Q&&(qs=(0,Ge.rgb2arr)(k),yl=(0,Ge.rgb2arr)(Q),co=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:Qi()(Xi)?Xi:0,u_opacity:Qi()(S)?S:1,u_textureBlend:xe==="normal"?0:1,segmentNumber:qi,u_line_type:Qs[qe||"solid"],u_dash_array:Ht,u_blur:.9,u_lineDir:en?1:-1,u_texture:this.texture,u_line_texture:Hn?1:0,u_icon_step:ni,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:co,u_sourceColor:qs,u_targetColor:yl}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption;return{u_aimate:this.animateOption2Array(S),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var h=this.layer.getLayerConfig(),S=h.sourceColor,k=h.targetColor,Q=h.lineType;return Q==="dash"?{frag:Ss,vert:rs,type:"dash"}:S&&k?{frag:Ms,vert:uo,type:"linear"}:{frag:ls,vert:Ia,type:"normal"}}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.segmentNumber,k=S===void 0?30:S,Q=h.mask,oe=Q===void 0?!1:Q,xe=h.maskInside,Be=xe===void 0?!0:xe,qe=this.getShaders(),zt=qe.frag,Ht=qe.vert,Tr=qe.type;return[this.layer.buildLayerModel({moduleName:"arc2dline"+Tr,vertexShader:Ht,fragmentShader:zt,triangulation:Qe.$4,depth:{enable:!1},blend:this.getBlend(),segmentNumber:k,stencil:(0,Ge.getMask)(oe,Be)})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?1:Be;return Array.isArray(qe)?[qe[0]]:[qe]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:v.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:4,update:function(k,Q,oe,xe){return[oe[3],oe[4],oe[5],oe[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.iconService.getIconMap(),qe=k.texture,zt=Be[qe]||{x:0,y:0},Ht=zt.x,Tr=zt.y;return[Ht,Tr]}}})}}]),x}(Y.Z),Ts=y(90440);function ua(f){var F=cs();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function cs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Ds=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);

      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_aimate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_aimate.x == Animate) {
      time = u_time / u_aimate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_aimate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_aimate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Ro=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // TODO: + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // TODO: \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Eu=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;


uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);

      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_aimate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,ec=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // TODO: + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // TODO: \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Gs={solid:0,dash:1},ft=function(f){(0,L.Z)(x,f);var F=ua(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"updateTexture",function(){var Q=p.rendererService.createTexture2D;if(p.texture){p.texture.update({data:p.iconService.getCanvas()}),p.layer.render();return}p.texture=Q({data:p.iconService.getCanvas(),mag:v.gl.NEAREST,min:v.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:p.iconService.canvasHeight||128})}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.sourceColor,Q=h.targetColor,oe=h.textureBlend,xe=oe===void 0?"normal":oe,Be=h.lineType,qe=Be===void 0?"solid":Be,zt=h.dashArray,Ht=zt===void 0?[10,5]:zt,Tr=h.lineTexture,en=Tr===void 0?!1:Tr,An=h.iconStep,Hn=An===void 0?100:An,si=h.segmentNumber,ni=si===void 0?30:si,di=h.globalArcHeight,qi=di===void 0?10:di;Ht.length===2&&Ht.push(0,0);var ta=0,Xi=[0,0,0,0],Ja=[0,0,0,0];if(k&&Q&&(Xi=(0,Ge.rgb2arr)(k),Ja=(0,Ge.rgb2arr)(Q),ta=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:S})){this.judgeStyleAttributes({opacity:S});var po=this.layer.getEncodedData(),zo=this.calDataFrame(this.cellLength,po,this.cellProperties),Ta=zo.data,Io=zo.width,co=zo.height;this.rowCount=co,this.dataTexture=this.cellLength>0&&Ta.length>0?this.createTexture2D({flipY:!0,data:Ta,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:Io,height:co}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Ts.Y5,u_global_height:qi,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(S)?S:1,u_textureBlend:xe==="normal"?0:1,segmentNumber:ni,u_line_type:Gs[qe]||0,u_dash_array:Ht,u_texture:this.texture,u_line_texture:en?1:0,u_icon_step:Hn,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:ta,u_sourceColor:Xi,u_targetColor:Ja}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption;return{u_aimate:this.animateOption2Array(S),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var h=this.layer.getLayerConfig(),S=h.sourceColor,k=h.targetColor,Q=h.lineType;return S&&k?{frag:Eu,vert:ec,type:"linear"}:{frag:Ds,vert:Ro,type:"normal"}}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.segmentNumber,k=S===void 0?30:S,Q=h.mask,oe=Q===void 0?!1:Q,xe=h.maskInside,Be=xe===void 0?!0:xe,qe=this.getShaders(),zt=qe.frag,Ht=qe.vert,Tr=qe.type;return[this.layer.buildLayerModel({moduleName:"arc3Dline"+Tr,vertexShader:Ht,fragmentShader:zt,triangulation:Qe.$4,blend:this.getBlend(),segmentNumber:k,stencil:(0,Ge.getMask)(oe,Be)})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?1:Be;return Array.isArray(qe)?[qe[0]]:[qe]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:v.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:4,update:function(k,Q,oe,xe){return[oe[3],oe[4],oe[5],oe[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.iconService.getIconMap(),qe=k.texture,zt=Be[qe]||{x:0,y:0},Ht=zt.x,Tr=zt.y;return[Ht,Tr]}}})}}]),x}(Y.Z);function St(f){var F=_r();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function _r(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Or=`#define LineTypeSolid 0.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
// varying vec2 v_normal;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float segmentNumber;
varying float v_distance_ratio;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }
  
 
  gl_FragColor.a *= u_opacity;

  if(u_aimate.x == Animate) {
      float animateSpeed = u_time / u_aimate.y; // \u8FD0\u52A8\u901F\u5EA6
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }
}`,$n=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;

uniform float u_lineDir: 1.0;

// \u504F\u79FB\u91CF
uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = u_thetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  v_distance_ratio = segmentIndex / segmentNumber;
  
  if(u_aimate.x == Animate && u_lineDir != 1.0) {
      v_distance_ratio = 1.0 - v_distance_ratio;
  }

  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
}
`,Gi=function(f){(0,L.Z)(x,f);var F=St(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.sourceColor,Q=h.targetColor,oe=h.forward,xe=oe===void 0?!0:oe,Be=h.segmentNumber,qe=Be===void 0?30:Be,zt=h.thetaOffset,Ht=zt===void 0?.314:zt,Tr=0,en=[0,0,0,0],An=[0,0,0,0];return k&&Q&&(en=(0,Ge.rgb2arr)(k),An=(0,Ge.rgb2arr)(Q),Tr=1),{u_thetaOffset:Ht,u_opacity:Qi()(S)?S:1,segmentNumber:qe,u_blur:.9,u_lineDir:xe?1:-1,u_linearColor:Tr,u_sourceColor:en,u_targetColor:An}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption;return{u_aimate:this.animateOption2Array(S),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.segmentNumber,k=S===void 0?30:S;return[this.layer.buildLayerModel({moduleName:"arc2dminiline",vertexShader:$n,fragmentShader:Or,triangulation:Qe.$4,depth:{enable:!1},blend:this.getBlend(),segmentNumber:k})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:v.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:4,update:function(S,k,Q,oe){return[Q[3],Q[4],Q[5],Q[6]]}}})}}]),x}(Y.Z);function to(f){var F=Je();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Je(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var It=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
      float alpha =1.0 - fract( mod(1.0- smoothstep(0.0, 1.0, v_distance_ratio), u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_aimate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,Ot=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
// varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*8.0;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,Xt={solid:0,dash:1},Dr=function(f){(0,L.Z)(x,f);var F=to(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"updateTexture",function(){var Q=p.rendererService.createTexture2D;if(p.texture){p.texture.update({data:p.iconService.getCanvas()}),p.layer.render();return}p.texture=Q({data:p.iconService.getCanvas(),mag:v.gl.NEAREST,min:v.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:p.iconService.canvasHeight||128})}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.sourceColor,Q=h.targetColor,oe=h.textureBlend,xe=oe===void 0?"normal":oe,Be=h.lineType,qe=Be===void 0?"solid":Be,zt=h.dashArray,Ht=zt===void 0?[10,5]:zt,Tr=h.lineTexture,en=Tr===void 0?!1:Tr,An=h.iconStep,Hn=An===void 0?100:An,si=h.segmentNumber,ni=si===void 0?30:si;Ht.length===2&&Ht.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var di=0,qi=[0,0,0,0],ta=[0,0,0,0];if(k&&Q&&(qi=(0,Ge.rgb2arr)(k),ta=(0,Ge.rgb2arr)(Q),di=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:S})){this.judgeStyleAttributes({opacity:S});var Xi=this.layer.getEncodedData(),Ja=this.calDataFrame(this.cellLength,Xi,this.cellProperties),po=Ja.data,zo=Ja.width,Ta=Ja.height;this.rowCount=Ta,this.dataTexture=this.cellLength>0&&po.length>0?this.createTexture2D({flipY:!0,data:po,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:zo,height:Ta}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(S)?S:1,u_textureBlend:xe==="normal"?0:1,segmentNumber:ni,u_line_type:Xt[qe]||0,u_dash_array:Ht,u_texture:this.texture,u_line_texture:en?1:0,u_icon_step:Hn,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:di,u_sourceColor:qi,u_targetColor:ta}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption;return{u_aimate:this.animateOption2Array(S),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"greatcircleline",vertexShader:Ot,fragmentShader:It,triangulation:Qe.$4,depth:{enable:!1},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?1:Be;return Array.isArray(qe)?[qe[0]]:[qe]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:v.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:4,update:function(k,Q,oe,xe){return[oe[3],oe[4],oe[5],oe[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.iconService.getIconMap(),qe=k.texture,zt=Be[qe]||{x:0,y:0},Ht=zt.x,Tr=zt.y;return[Ht,Tr]}}})}}]),x}(Y.Z);function Lr(f){var F=_n();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function _n(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Un=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 // dash line
 
  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  }
  gl_FragColor.a *=flag;

  gl_FragColor = filterColor(gl_FragColor);
}
`,mn=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,mi=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_blur : 0.99;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Oa=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Fn=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,ci={solid:0,dash:1},ia=function(f){(0,L.Z)(x,f);var F=Lr(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"updateTexture",function(){var Q=p.rendererService.createTexture2D;if(p.texture){p.texture.update({data:p.iconService.getCanvas()}),p.layer.render();return}p.texture=Q({data:p.iconService.getCanvas(),mag:v.gl.NEAREST,min:v.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:p.iconService.canvasHeight||128})}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.sourceColor,Q=h.targetColor,oe=h.textureBlend,xe=oe===void 0?"normal":oe,Be=h.lineType,qe=Be===void 0?"solid":Be,zt=h.dashArray,Ht=zt===void 0?[10,5,0,0]:zt,Tr=h.lineTexture,en=Tr===void 0?!1:Tr,An=h.iconStep,Hn=An===void 0?100:An,si=h.vertexHeightScale,ni=si===void 0?20:si,di=h.borderWidth,qi=di===void 0?0:di,ta=h.borderColor,Xi=ta===void 0?"#ccc":ta,Ja=h.raisingHeight,po=Ja===void 0?0:Ja,zo=h.heightfixed,Ta=zo===void 0?!1:zo,Io=h.arrow,co=Io===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:Io;Ht.length===2&&Ht.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var qs=0,yl=[0,0,0,0],bc=[0,0,0,0];if(k&&Q&&(yl=(0,Ge.rgb2arr)(k),bc=(0,Ge.rgb2arr)(Q),qs=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:S})){this.judgeStyleAttributes({opacity:S});var Fc=this.layer.getEncodedData(),Yf=this.calDataFrame(this.cellLength,Fc,this.cellProperties),zl=Yf.data,zh=Yf.width,Bp=Yf.height;this.rowCount=Bp,this.dataTexture=this.cellLength>0&&zl.length>0?this.createTexture2D({flipY:!0,data:zl,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:zh,height:Bp}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(S)?S:1,u_textureBlend:xe==="normal"?0:1,u_line_type:ci[qe],u_dash_array:Ht,u_texture:this.texture,u_line_texture:en?1:0,u_icon_step:Hn,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:qi,u_borderColor:(0,Ge.rgb2arr)(Xi),u_linearColor:qs,u_sourceColor:yl,u_targetColor:bc,u_heightfixed:Number(Ta),u_vertexScale:ni,u_raisingHeight:Number(po),u_arrow:Number(co.enable),u_arrowHeight:co.arrowHeight||3,u_arrowWidth:co.arrowWidth||2,u_tailWidth:co.tailWidth===void 0?1:co.tailWidth}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption;return{u_aimate:this.animateOption2Array(S),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=h.depth,Be=xe===void 0?!1:xe,qe=this.getShaders(),zt=qe.frag,Ht=qe.vert,Tr=qe.type;return[this.layer.buildLayerModel({moduleName:"line_"+Tr,vertexShader:Ht,fragmentShader:zt,triangulation:Qe.sN,primitive:v.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:Be},stencil:(0,Ge.getMask)(k,oe)})]}},{key:"getShaders",value:function(){var h=this.layer.getLayerConfig(),S=h.sourceColor,k=h.targetColor,Q=h.lineType;return Q==="dash"?{frag:Un,vert:mn,type:"dash"}:S&&k?{frag:Fn,vert:Oa,type:"linear"}:{frag:mi,vert:Oa,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:v.AttributeType.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe,Be,qe){return qe===void 0?[oe[3],10]:[oe[3],qe]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:v.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){return[oe[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?1:Be;return Array.isArray(qe)?[qe[0],qe[1]]:[qe,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(k,Q,oe,xe,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:v.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){return[oe[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.iconService.getIconMap(),qe=k.texture,zt=Be[qe]||{x:0,y:0},Ht=zt.x,Tr=zt.y;return[Ht,Tr]}}})}}]),x}(Y.Z);function _a(f){var F=ao();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ao(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Yo=`

uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,Vo=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,Bo=`
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;


// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_color = a_Color;  

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  }
}
`,mo=function(f){(0,L.Z)(x,f);var F=_a(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.sourceColor,Q=h.targetColor,oe=h.vertexHeightScale,xe=oe===void 0?20:oe,Be=0,qe=[0,0,0,0],zt=[0,0,0,0];if(k&&Q&&(qe=(0,Ge.rgb2arr)(k),zt=(0,Ge.rgb2arr)(Q),Be=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:S})){this.judgeStyleAttributes({opacity:S});var Ht=this.layer.getEncodedData(),Tr=this.calDataFrame(this.cellLength,Ht,this.cellProperties),en=Tr.data,An=Tr.width,Hn=Tr.height;this.rowCount=Hn,this.dataTexture=this.cellLength>0&&en.length>0?this.createTexture2D({flipY:!0,data:en,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:An,height:Hn}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(S)?S:1,u_linearColor:Be,u_sourceColor:qe,u_targetColor:zt,u_vertexScale:xe}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption;return{u_aimate:this.animateOption2Array(S),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"getShaders",value:function(){var h=this.layer.getLayerConfig(),S=h.sourceColor,k=h.targetColor;return S&&k?{frag:Yo,vert:Bo,type:"linear"}:{frag:Vo,vert:Bo,type:"normal"}}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=this.getShaders(),Be=xe.frag,qe=xe.vert,zt=xe.type;return[this.layer.buildLayerModel({moduleName:"simpleline"+zt,vertexShader:qe,fragmentShader:Be,triangulation:Qe.us,primitive:v.gl.LINES,blend:this.getBlend(),depth:{enable:!1},stencil:(0,Ge.getMask)(k,oe)})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:v.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){return[Q[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:v.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){return[Q[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return Array.isArray(Be)?[Be[0],Be[1]]:[Be,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k,Q,oe,xe){return xe}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:v.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){return[Q[4]]}}})}}]),x}(Y.Z);function Do(f){var F=ps();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ps(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var g=`#define LineTypeSolid 0.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;

varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;

varying vec2 v_iconMapUV;
varying float v_blur;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = styleMappingMat[3].a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_aimate.x == Animate) {
      animateSpeed = u_time / u_aimate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);

    
  
  
}
`,U=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

varying vec4 v_color;
varying float v_blur;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "light"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_aimate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);

  // v_lightWeight = lightWeight;
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);
  // v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,he=function(f){(0,L.Z)(x,f);var F=Do(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"updateTexture",function(){var Q=p.rendererService.createTexture2D;if(p.texture){p.texture.update({data:p.iconService.getCanvas()}),p.layer.render();return}p.texture=Q({data:p.iconService.getCanvas(),mag:v.gl.NEAREST,min:v.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:p.iconService.canvasHeight||128})}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.sourceColor,Q=h.targetColor,oe=h.textureBlend,xe=oe===void 0?"normal":oe,Be=h.heightfixed,qe=Be===void 0?!1:Be,zt=h.lineTexture,Ht=zt===void 0?!1:zt,Tr=h.iconStep,en=Tr===void 0?100:Tr,An=h.iconStepCount,Hn=An===void 0?1:An;this.rendererService.getDirty()&&this.texture.bind();var si=0,ni=[0,0,0,0],di=[0,0,0,0];if(k&&Q&&(ni=(0,Ge.rgb2arr)(k),di=(0,Ge.rgb2arr)(Q),si=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:S})){this.judgeStyleAttributes({opacity:S});var qi=this.layer.getEncodedData(),ta=this.calDataFrame(this.cellLength,qi,this.cellProperties),Xi=ta.data,Ja=ta.width,po=ta.height;this.rowCount=po,this.dataTexture=this.cellLength>0&&Xi.length>0?this.createTexture2D({flipY:!0,data:Xi,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:Ja,height:po}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_heightfixed:Number(qe),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(S)?S:1,u_textureBlend:xe==="normal"?0:1,u_texture:this.texture,u_line_texture:Ht?1:0,u_iconStepCount:Hn,u_icon_step:en,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:si,u_sourceColor:ni,u_targetColor:di}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption;return{u_aimate:this.animateOption2Array(S),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"linewall",vertexShader:U,fragmentShader:g,triangulation:Qe.sN,primitive:v.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:v.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){return[oe[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:v.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){return[oe[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?1:Be;return Array.isArray(qe)?[qe[0],qe[1]]:[qe,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(k,Q,oe,xe,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:v.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){return[oe[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.iconService.getIconMap(),qe=k.texture,zt=Be[qe]||{x:0,y:0},Ht=zt.x,Tr=zt.y;return[Ht,Tr]}}})}}]),x}(Y.Z),te={arc:Ao,arcmini:Gi,arc3d:ft,greatcircle:Dr,wall:he,line:ia,simple:mo},tt=te;function Pt(f){var F=fr();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function fr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Fr=function(f){(0,L.Z)(x,f);var F=Pt(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","LineLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new tt[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={line:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},arcmini:{blend:"additive"},greatcircle:{blend:"additive"}};return S[h]}},{key:"getModelType",value:function(){var h,S=this.styleAttributeService.getLayerStyleAttribute("shape"),k=S==null||(h=S.scale)===null||h===void 0?void 0:h.field;return k||"line"}}]),x}(V.Z),zr=y(1140);function En(f){var F=Dn();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Dn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var na=`varying vec4 v_color;
uniform float u_opacity: 1.0;

varying float v_z;
varying float v_lightWeight;
uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v_z);
    gl_FragColor.rgb *= v_lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_z): v_z;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, v_lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,ka=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

varying float v_z;
varying float v_lightWeight;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  v_z = a_Position.z;

 

  // vec2 offset = project_pixel(size.xy);
  // vec2 offset = (size.xy);

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    // offset = project_pixel(offset);
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z) * u_r, 1.0);
  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  // float lightWeight = u_lightEnable > 0.0 ? calc_lighting(pos): 1.0;
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }
  
  if(u_globel > 0.0) {
    // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
    //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
    float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
    float xRadian = getXRadian(a_Pos.y, r);
    float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
    float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
    mat4 mx = mat4(
      1,0,0,0,  
      0,xcos,-xsin,0,  
      0,xsin,xcos,0,  
      0,0,0,1);

    //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
    float yRadian = getYRadian(a_Pos.x, a_Pos.z);
    float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
    float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
    mat4 my = mat4(
      ycos,0,-ysin,0,  
      0,1,0,0,  
      ysin,0,ycos,0,  
      0,0,0,1);

    gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  }

  setPickingColor(a_PickingColor);
}
`,ha=function(f){(0,L.Z)(x,f);var F=En(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"raiseCount",0),(0,B.Z)((0,P.Z)(p),"raiserepeat",0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption,k=S===void 0?{enable:!1,speed:.01,repeat:!1}:S,Q=h.opacity,oe=Q===void 0?1:Q,xe=h.sourceColor,Be=h.targetColor,qe=h.pickLight,zt=qe===void 0?!1:qe,Ht=h.heightfixed,Tr=Ht===void 0?!1:Ht,en=h.opacityLinear,An=en===void 0?{enable:!1,dir:"up"}:en,Hn=h.lightEnable,si=Hn===void 0?!0:Hn;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:oe})){this.judgeStyleAttributes({opacity:oe});var ni=this.layer.getEncodedData(),di=this.calDataFrame(this.cellLength,ni,this.cellProperties),qi=di.data,ta=di.width,Xi=di.height;this.rowCount=Xi,this.dataTexture=this.cellLength>0&&qi.length>0?this.createTexture2D({flipY:!0,data:qi,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:ta,height:Xi}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}var Ja=0,po=[0,0,0,0],zo=[0,0,0,0];if(xe&&Be&&(po=(0,Ge.rgb2arr)(xe),zo=(0,Ge.rgb2arr)(Be),Ja=1),this.raiseCount<1&&this.raiserepeat>0&&k.enable){var Ta=k.speed,Io=Ta===void 0?.01:Ta,co=k.repeat,qs=co===void 0?!1:co;this.raiseCount+=Io,this.raiseCount>=1&&(this.raiserepeat>1?(this.raiseCount=0,this.raiserepeat--):this.raiseCount=1)}return{u_pickLight:Number(zt),u_heightfixed:Number(Tr),u_r:k.enable&&this.raiserepeat>0?this.raiseCount:1,u_globel:this.mapService.version==="GLOBEL"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(oe)?oe:1,u_linearColor:Ja,u_sourceColor:po,u_targetColor:zo,u_opacitylinear:Number(An.enable),u_opacitylinear_dir:An.dir==="up"?1:0,u_lightEnable:Number(si)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.depth,k=S===void 0?!0:S,Q=h.animateOption.repeat,oe=Q===void 0?1:Q;return this.raiserepeat=oe,[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:ka,fragmentShader:na,triangulation:Qe.NM,blend:this.getBlend(),cull:{enable:!0,face:(0,Ge.getCullFace)(this.mapService.version)},depth:{enable:k}})]}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this.mapService.version==="GLOBEL";this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(k,Q,oe,xe){var Be=k.size;if(Be){var qe=[];return Array.isArray(Be)&&(qe=Be.length===2?[Be[0],Be[0],Be[1]]:Be),Array.isArray(Be)||(qe=[Be,Be,Be]),qe}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(k,Q,oe,xe,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:v.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(k,Q){var oe=(0,zr.S)(k.coordinates);return h?(0,Ts.rq)([oe[0],oe[1]]):[oe[0],oe[1],0]}}})}}]),x}(Y.Z),Fa=y(77160);function Mo(f){var F=Po();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Po(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var go=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

 gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
  
  // TODO: \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // TODO: \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,fu=`
uniform float u_globel;
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(u_globel > 0.0) {
    // TODO: \u5730\u7403\u6A21\u5F0F\u4E0B\u907F\u514D\u591A\u4F59\u7247\u5143\u7ED8\u5236\uFF0C\u540C\u65F6\u4E5F\u80FD\u907F\u514D\u6709\u7528\u7247\u5143\u5728\u900F\u660E\u4E14\u91CD\u53E0\u7684\u60C5\u51B5\u4E0B\u65E0\u6CD5\u5199\u5165
    // \u4ED8\u51FA\u7684\u4EE3\u4EF7\u662F\u8FB9\u7F18\u4F1A\u6709\u4E00\u4E9B\u952F\u9F7F
    if(outer_df > antialiasblur + 0.018) discard;
  }
  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,yo=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_globel;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // TODO: billboard
  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  if(u_globel > 0.0) {
    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Zu=function(f){(0,L.Z)(x,f);var F=Mo(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"meter2coord",1),(0,B.Z)((0,P.Z)(p),"isMeter",!1),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.strokeOpacity,oe=Q===void 0?1:Q,xe=h.strokeWidth,Be=xe===void 0?0:xe,qe=h.stroke,zt=qe===void 0?"rgba(0,0,0,0)":qe,Ht=h.offsets,Tr=Ht===void 0?[0,0]:Ht,en=h.blend,An=h.blur,Hn=An===void 0?0:An;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k,strokeOpacity:oe,strokeWidth:Be,stroke:zt,offsets:Tr})){this.judgeStyleAttributes({opacity:k,strokeOpacity:oe,strokeWidth:Be,stroke:zt,offsets:Tr});var si=this.layer.getEncodedData(),ni=this.calDataFrame(this.cellLength,si,this.cellProperties),di=ni.data,qi=ni.width,ta=ni.height;this.rowCount=ta,this.dataTexture=this.cellLength>0&&di.length>0?this.createTexture2D({flipY:!0,data:di,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:qi,height:ta}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_isMeter:Number(this.isMeter),u_blur:Hn,u_additive:en==="additive"?1:0,u_globel:this.mapService.version===Xe.G.GLOBEL?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(k)?k:1,u_stroke_opacity:Qi()(oe)?oe:1,u_stroke_width:Qi()(Be)?Be:0,u_stroke_color:this.getStrokeColor(zt),u_offsets:this.isOffsetStatic(Tr)?Tr:[0,0]}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption,k=S===void 0?{enable:!1}:S;return{u_aimate:this.animateOption2Array(k),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Qe.oX)}},{key:"initModels",value:function(){var h=this.layer.getLayerConfig(),S=h.unit,k=S===void 0?"l7size":S,Q=this.mapService.version;return k==="meter"&&Q!==Xe.G.L7MAP&&Q!==Xe.G.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),this.buildModels()}},{key:"calMeter2Coord",value:function(){var h=(0,N.Z)(this.layer.getSource().extent,4),S=h[0],k=h[1],Q=h[2],oe=h[3],xe=[(S+Q)/2,(k+oe)/2],Be=this.mapService.version;if(Be===Xe.G.MAPBOX&&window.mapboxgl.MercatorCoordinate){var qe=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:xe[0],lat:xe[1]},0),zt=1,Ht=zt*qe.meterInMercatorCoordinateUnits(),Tr=new window.mapboxgl.MercatorCoordinate(qe.x-Ht,qe.y,qe.z),en=Tr.toLngLat();this.meter2coord=xe[0]-en.lng;return}var An=this.mapService.meterToCoord(xe,[S,k]),Hn=this.mapService.meterToCoord(xe,[Q===S?Q+.1:Q,oe===k?k+.1:oe]);this.meter2coord=(An+Hn)/2,Boolean(this.meter2coord)||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=h.animateOption,Be=xe===void 0?{enable:!1}:xe,qe=this.getShaders(Be),zt=qe.frag,Ht=qe.vert,Tr=qe.type,en=this.mapService.version==="GLOBEL";return[this.layer.buildLayerModel({moduleName:"pointfill_"+Tr,vertexShader:Ht,fragmentShader:zt,triangulation:en?Qe.S:Qe.oX,depth:{enable:en},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe),cull:{enable:!0,face:(0,Ge.getCullFace)(this.mapService.version)}})]}},{key:"getShaders",value:function(h){if(h.enable)switch(h.type){case"wave":return{frag:go,vert:yo,type:"wave"};default:return{frag:go,vert:yo,type:"wave"}}else return{frag:fu,vert:yo,type:"normal"}}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"animateOption2Array",value:function(h){return[h.enable?0:1,h.speed||1,h.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var h=this,S=this.mapService.version==="GLOBEL";this.styleAttributeService.registerStyleAttribute({name:"extrude",type:v.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(Q,oe,xe,Be){var qe;if(S){var zt=(0,N.Z)(xe,3),Ht=zt[0],Tr=zt[1],en=zt[2],An=Fa.fromValues(0,0,1),Hn=Fa.fromValues(Ht,0,en),si=Ht>=0?Fa.angle(An,Hn):Math.PI*2-Fa.angle(An,Hn),ni=Math.PI*2-Math.asin(Tr/100),di=ht.create();ht.rotateY(di,di,si),ht.rotateX(di,di,ni);var qi=Fa.fromValues(1,1,0);Fa.transformMat4(qi,qi,di),Fa.normalize(qi,qi);var ta=Fa.fromValues(-1,1,0);Fa.transformMat4(ta,ta,di),Fa.normalize(ta,ta);var Xi=Fa.fromValues(-1,-1,0);Fa.transformMat4(Xi,Xi,di),Fa.normalize(Xi,Xi);var Ja=Fa.fromValues(1,-1,0);Fa.transformMat4(Ja,Ja,di),Fa.normalize(Ja,Ja),qe=[].concat((0,Ne.Z)(qi),(0,Ne.Z)(ta),(0,Ne.Z)(Xi),(0,Ne.Z)(Ja))}else qe=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var po=Be%4*3;return[qe[po],qe[po+1],qe[po+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(Q,oe,xe,Be){var qe=Q.size,zt=qe===void 0?5:qe;return Array.isArray(zt)?[zt[0]*h.meter2coord]:[zt*h.meter2coord]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:v.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(Q,oe,xe,Be){var qe=Q.shape,zt=qe===void 0?2:qe,Ht=h.layer.getLayerConfig().shape2d,Tr=Ht.indexOf(zt);return[Tr]}}})}}]),x}(Y.Z);function tc(f){var F=ws();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ws(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Nc=`uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  float opacity = styleMappingMat[0][0];

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,$u=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform float u_isMeter;

varying float v_radius;
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_opacity : 1;
uniform vec2 u_offsets;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;

  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // radius(16-bit)
  v_radius = a_Size;

  // TODO: billboard
  // anti-alias
  

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,Ku=function(f){(0,L.Z)(x,f);var F=tc(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"meter2coord",1),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"isMeter",!1),(0,B.Z)((0,P.Z)(p),"radian",0),(0,B.Z)((0,P.Z)(p),"updateTexture",function(){var Q=p.rendererService.createTexture2D;if(p.texture){p.texture.update({data:p.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),p.layer.renderLayers();return}p.texture=Q({data:p.iconService.getCanvas(),mag:v.gl.LINEAR,min:v.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:p.iconService.canvasHeight||128,mipmap:!0})}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.strokeOpacity,oe=Q===void 0?1:Q,xe=h.strokeWidth,Be=xe===void 0?0:xe,qe=h.stroke,zt=qe===void 0?"rgba(0,0,0,0)":qe,Ht=h.offsets,Tr=Ht===void 0?[0,0]:Ht,en=h.blend,An=h.rotation;this.rendererService.getDirty()&&this.texture.bind();var Hn=1;if((this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(Hn=-1),this.radian=An!==void 0?Hn*Math.PI*An/180:Hn*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k,strokeOpacity:oe,strokeWidth:Be,stroke:zt,offsets:Tr})){this.judgeStyleAttributes({opacity:k,strokeOpacity:oe,strokeWidth:Be,stroke:zt,offsets:Tr});var si=this.layer.getEncodedData(),ni=this.calDataFrame(this.cellLength,si,this.cellProperties),di=ni.data,qi=ni.width,ta=ni.height;this.rowCount=ta,this.dataTexture=this.cellLength>0&&di.length>0?this.createTexture2D({flipY:!0,data:di,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:qi,height:ta}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_isMeter:Number(this.isMeter),u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_additive:en==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:Qi()(k)?k:1,u_offsets:this.isOffsetStatic(Tr)?Tr:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Qe.oX)}},{key:"initModels",value:function(){this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture);var h=this.layer.getLayerConfig(),S=h.unit,k=S===void 0?"l7size":S,Q=this.mapService.version;return k==="meter"&&Q!==Xe.G.L7MAP&&Q!==Xe.G.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),this.buildModels()}},{key:"calMeter2Coord",value:function(){var h=(0,N.Z)(this.layer.getSource().extent,4),S=h[0],k=h[1],Q=h[2],oe=h[3],xe=[(S+Q)/2,(k+oe)/2],Be=this.mapService.version;if(Be===Xe.G.MAPBOX&&window.mapboxgl.MercatorCoordinate){var qe=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:xe[0],lat:xe[1]},0),zt=1,Ht=zt*qe.meterInMercatorCoordinateUnits(),Tr=new window.mapboxgl.MercatorCoordinate(qe.x-Ht,qe.y,qe.z),en=Tr.toLngLat();this.meter2coord=xe[0]-en.lng;return}var An=this.mapService.meterToCoord(xe,[S,k]),Hn=this.mapService.meterToCoord(xe,[Q===S?Q+.1:Q,oe===k?k+.1:oe]);this.meter2coord=(An+Hn)/2,Boolean(this.meter2coord)||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=this.getShaders(),Be=xe.frag,qe=xe.vert,zt=xe.type;return[this.layer.buildLayerModel({moduleName:"pointfill_"+zt,vertexShader:qe,fragmentShader:Be,triangulation:Qe.oX,depth:{enable:!1},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe),cull:{enable:!0,face:(0,Ge.getCullFace)(this.mapService.version)}})]}},{key:"getShaders",value:function(){return{frag:Nc,vert:$u,type:"normal"}}},{key:"clearModels",value:function(){var h,S;this.iconService.off("imageUpdate",this.updateTexture),(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:v.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.rotate,qe=Be===void 0?0:Be;return Array.isArray(qe)?[qe[0]]:[qe]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.iconService.getIconMap(),qe=k.shape,zt=Be[qe]||{x:0,y:0},Ht=zt.x,Tr=zt.y;return[Ht,Tr]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:v.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(k,Q,oe,xe){var Be=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],qe=xe%4*3;return[Be[qe],Be[qe+1],Be[qe+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?5:Be;return Array.isArray(qe)?[qe[0]*h.meter2coord]:[qe*h.meter2coord]}}})}}]),x}(Y.Z);function xl(f){var F=qo();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function qo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var rc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,Ec=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;

uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  //  vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Va=function(f){(0,L.Z)(x,f);var F=xl(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity;return{u_opacity:S||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var h=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){h.updateTexture(),h.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Ec,fragmentShader:rc,triangulation:Qe.xH,primitive:v.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.size;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.fontService.mapping,qe=k.shape,zt=h.fontService.getGlyph(qe),Ht=Be[zt],Tr=Ht.x,en=Ht.y;return[Tr,en]}}})}},{key:"updateTexture",value:function(){var h=this.rendererService.createTexture2D,S=this.fontService.canvas;this.texture=h({data:S,mag:v.gl.LINEAR,min:v.gl.LINEAR,width:S.width,height:S.height})}},{key:"initIconFontGlyphs",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.fontWeight,Q=k===void 0?"normal":k,oe=S.fontFamily,xe=oe===void 0?"sans-serif":oe,Be=this.layer.getEncodedData(),qe=[];Be.forEach(function(zt){var Ht=zt.shape,Tr=Ht===void 0?"":Ht;Tr=Tr.toString();var en=h.fontService.getGlyph(Tr);qe.indexOf(en)===-1&&qe.push(en)}),this.fontService.setFontOptions({characterSet:qe,fontWeight:Q,fontFamily:xe,fontSize:48})}}]),x}(Y.Z);function qu(f){var F=ys();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function ys(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var ss=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,bl=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;

uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  //  vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);

  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
    }
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,El=function(f){(0,L.Z)(x,f);var F=qu(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"updateTexture",function(){var Q=p.rendererService.createTexture2D;if(p.texture){p.texture.update({data:p.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),p.layer.renderLayers();return}p.texture=Q({data:p.iconService.getCanvas(),mag:v.gl.LINEAR,min:v.gl.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:p.iconService.canvasHeight||128,mipmap:!0})}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=h.offsets,Q=k===void 0?[0,0]:k;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:S,offsets:Q})){this.judgeStyleAttributes({opacity:S,offsets:Q});var oe=this.layer.getEncodedData(),xe=this.calDataFrame(this.cellLength,oe,this.cellProperties),Be=xe.data,qe=xe.width,zt=xe.height;this.rowCount=zt,this.dataTexture=this.cellLength>0&&Be.length>0?this.createTexture2D({flipY:!0,data:Be,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:qe,height:zt}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:Qi()(S)?S:1,u_offsets:this.isOffsetStatic(Q)?Q:[0,0]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:bl,fragmentShader:ss,triangulation:Qe.xH,primitive:v.gl.POINTS,depth:{enable:!1},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?5:Be;return Array.isArray(qe)?[qe[0]]:[qe]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(k,Q,oe,xe){var Be=h.iconService.getIconMap(),qe=k.shape,zt=Be[qe]||{x:0,y:0},Ht=zt.x,Tr=zt.y;return[Ht,Tr]}}})}}]),x}(Y.Z);function To(f){var F=Ps();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Ps(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var hf=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  float opacity = styleMappingMat[0][0];

  gl_FragColor = v_color;
  // gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor.a =gl_FragColor.a * opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ju=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  // vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);
  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\
  // 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 offset = project_pixel((u_offsets));
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    // vec2 offset = project_pixel(u_offsets);
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function zc(f){var F=f.coordinates;return{vertices:(0,Ne.Z)(F),indices:[0],size:F.length}}var Uc=function(f){(0,L.Z)(x,f);var F=To(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.offsets,oe=Q===void 0?[0,0]:Q;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k,offsets:oe})){this.judgeStyleAttributes({opacity:k,offsets:oe});var xe=this.layer.getEncodedData(),Be=this.calDataFrame(this.cellLength,xe,this.cellProperties),qe=Be.data,zt=Be.width,Ht=Be.height;this.rowCount=Ht,this.dataTexture=this.cellLength>0&&qe.length>0?this.createTexture2D({flipY:!0,data:qe,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:zt,height:Ht}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(k)?k:1,u_offsets:this.isOffsetStatic(oe)?oe:[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:ju,fragmentShader:hf,triangulation:zc,depth:{enable:!1},primitive:v.gl.POINTS,blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:v.BlendType.additive}}}]),x}(Y.Z);function Bf(f){var F=Jc();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Jc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var vu=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  styleMappingMat[2].ba;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }



  gl_FragColor.a *= radar_v;
}
`,Ul=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform float u_speed: 1.0;
uniform float u_time;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_globel;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - a_Extrude.x - a_Extrude.y
    0.0, 0.0, 0.0, 0.0  // 
  );

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  styleMappingMat[2].ba = rotateMatrix * a_Extrude.xy;

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> empty -> empty ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;


  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // TODO: billboard
  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  v_data = vec4(extrude.x, extrude.y, antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  if(u_globel > 0.0) {
    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);
  }

  setPickingColor(a_PickingColor);
}
`,Qu=function(f){(0,L.Z)(x,f);var F=Bf(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"meter2coord",1),(0,B.Z)((0,P.Z)(p),"isMeter",!1),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.strokeOpacity,oe=Q===void 0?1:Q,xe=h.strokeWidth,Be=xe===void 0?0:xe,qe=h.stroke,zt=qe===void 0?"rgba(0,0,0,0)":qe,Ht=h.offsets,Tr=Ht===void 0?[0,0]:Ht,en=h.blend,An=h.speed,Hn=An===void 0?1:An;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k,strokeOpacity:oe,strokeWidth:Be,stroke:zt,offsets:Tr})){this.judgeStyleAttributes({opacity:k,strokeOpacity:oe,strokeWidth:Be,stroke:zt,offsets:Tr});var si=this.layer.getEncodedData(),ni=this.calDataFrame(this.cellLength,si,this.cellProperties),di=ni.data,qi=ni.width,ta=ni.height;this.rowCount=ta,this.dataTexture=this.cellLength>0&&di.length>0?this.createTexture2D({flipY:!0,data:di,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:qi,height:ta}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_isMeter:Number(this.isMeter),u_speed:Hn,u_additive:en==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(k)?k:1,u_offsets:this.isOffsetStatic(Tr)?Tr:[0,0]}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption,k=S===void 0?{enable:!1}:S;return{u_aimate:this.animateOption2Array(k),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Qe.oX)}},{key:"initModels",value:function(){var h=this.layer.getLayerConfig(),S=h.unit,k=S===void 0?"l7size":S,Q=this.mapService.version;return k==="meter"&&Q!==Xe.G.L7MAP&&Q!==Xe.G.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),this.buildModels()}},{key:"calMeter2Coord",value:function(){var h=(0,N.Z)(this.layer.getSource().extent,4),S=h[0],k=h[1],Q=h[2],oe=h[3],xe=[(S+Q)/2,(k+oe)/2],Be=this.mapService.version;if(Be===Xe.G.MAPBOX&&window.mapboxgl.MercatorCoordinate){var qe=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:xe[0],lat:xe[1]},0),zt=1,Ht=zt*qe.meterInMercatorCoordinateUnits(),Tr=new window.mapboxgl.MercatorCoordinate(qe.x-Ht,qe.y,qe.z),en=Tr.toLngLat();this.meter2coord=xe[0]-en.lng;return}var An=this.mapService.meterToCoord(xe,[S,k]),Hn=this.mapService.meterToCoord(xe,[Q===S?Q+.1:Q,oe===k?k+.1:oe]);this.meter2coord=(An+Hn)/2,Boolean(this.meter2coord)||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=this.getShaders(),Be=xe.frag,qe=xe.vert,zt=xe.type;return[this.layer.buildLayerModel({moduleName:"pointfill_"+zt,vertexShader:qe,fragmentShader:Be,triangulation:Qe.oX,depth:{enable:!1},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe),cull:{enable:!0,face:(0,Ge.getCullFace)(this.mapService.version)}})]}},{key:"getShaders",value:function(){return{frag:vu,vert:Ul,type:"radar"}}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"animateOption2Array",value:function(h){return[h.enable?0:1,h.speed||1,h.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:v.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(k,Q,oe,xe){var Be;Be=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var qe=xe%4*3;return[Be[qe],Be[qe+1],Be[qe+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.size,qe=Be===void 0?5:Be;return Array.isArray(qe)?[qe[0]*h.meter2coord]:[qe*h.meter2coord]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:v.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(k,Q,oe,xe){var Be=k.shape,qe=Be===void 0?2:Be,zt=h.layer.getLayerConfig().shape2d,Ht=zt.indexOf(qe);return[Ht]}}})}}]),x}(Y.Z);function Cu(f){var F=Zl();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Zl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var nc=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);

  

  
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,ic=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  // vec2 offset = project_pixel(u_offsets);
  vec2 offset = project_pixel(textrueOffsets);
  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\
  // 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // vec2 offset = project_pixel((u_offsets));
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    // vec2 offset = project_pixel(u_offsets);
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Gu(f){var F=f.coordinates;return{vertices:(0,Ne.Z)(F),indices:[0],size:F.length}}var pf=function(f){(0,L.Z)(x,f);var F=Cu(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.offsets,oe=Q===void 0?[0,0]:Q,xe=h.blend,Be=h.strokeOpacity,qe=Be===void 0?1:Be,zt=h.strokeWidth,Ht=zt===void 0?0:zt,Tr=h.stroke,en=Tr===void 0?"#fff":Tr;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k,offsets:oe})){this.judgeStyleAttributes({opacity:k,offsets:oe});var An=this.layer.getEncodedData(),Hn=this.calDataFrame(this.cellLength,An,this.cellProperties),si=Hn.data,ni=Hn.width,di=Hn.height;this.rowCount=di,this.dataTexture=this.cellLength>0&&si.length>0?this.createTexture2D({flipY:!0,data:si,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:ni,height:di}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_additive:xe==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(k)?k:1,u_offsets:this.isOffsetStatic(oe)?oe:[0,0],u_stroke_opacity:Qi()(qe)?qe:1,u_stroke_width:Qi()(Ht)?Ht:0,u_stroke_color:this.getStrokeColor(en)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"simplepoint",vertexShader:ic,fragmentShader:nc,triangulation:Gu,depth:{enable:!1},primitive:v.gl.POINTS,blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:v.BlendType.additive}}}]),x}(Y.Z),Cc=y(98333);function ef(f,F){var x=typeof Symbol!="undefined"&&f[Symbol.iterator]||f["@@iterator"];if(!x){if(Array.isArray(f)||(x=ko(f))||F&&f&&typeof f.length=="number"){x&&(f=x);var p=0,h=function(){};return{s:h,n:function(){return p>=f.length?{done:!0}:{done:!1,value:f[p++]}},e:function(xe){throw xe},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,k=!1,Q;return{s:function(){x=x.call(f)},n:function(){var xe=x.next();return S=xe.done,xe},e:function(xe){k=!0,Q=xe},f:function(){try{!S&&x.return!=null&&x.return()}finally{if(k)throw Q}}}}function ko(f,F){if(!!f){if(typeof f=="string")return Zc(f,F);var x=Object.prototype.toString.call(f).slice(8,-1);if(x==="Object"&&f.constructor&&(x=f.constructor.name),x==="Map"||x==="Set")return Array.from(f);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return Zc(f,F)}}function Zc(f,F){(F==null||F>f.length)&&(F=f.length);for(var x=0,p=new Array(F);x<F;x++)p[x]=f[x];return p}var Su=function(){function f(F,x,p){(0,Z.Z)(this,f),(0,B.Z)(this,"boxCells",[]),(0,B.Z)(this,"xCellCount",void 0),(0,B.Z)(this,"yCellCount",void 0),(0,B.Z)(this,"boxKeys",void 0),(0,B.Z)(this,"bboxes",void 0),(0,B.Z)(this,"width",void 0),(0,B.Z)(this,"height",void 0),(0,B.Z)(this,"xScale",void 0),(0,B.Z)(this,"yScale",void 0),(0,B.Z)(this,"boxUid",void 0);var h=this.boxCells;this.xCellCount=Math.ceil(F/p),this.yCellCount=Math.ceil(x/p);for(var S=0;S<this.xCellCount*this.yCellCount;S++)h.push([]);this.boxKeys=[],this.bboxes=[],this.width=F,this.height=x,this.xScale=this.xCellCount/F,this.yScale=this.yCellCount/x,this.boxUid=0}return(0,a.Z)(f,[{key:"insert",value:function(x,p,h,S,k){this.forEachCell(p,h,S,k,this.insertBoxCell,this.boxUid++),this.boxKeys.push(x),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(S),this.bboxes.push(k)}},{key:"query",value:function(x,p,h,S,k){return this.queryHitTest(x,p,h,S,!1,k)}},{key:"hitTest",value:function(x,p,h,S,k){return this.queryHitTest(x,p,h,S,!0,k)}},{key:"insertBoxCell",value:function(x,p,h,S,k,Q){this.boxCells[k].push(Q)}},{key:"queryHitTest",value:function(x,p,h,S,k,Q){if(h<0||x>this.width||S<0||p>this.height)return k?!1:[];var oe=[];if(x<=0&&p<=0&&this.width<=h&&this.height<=S){if(k)return!0;for(var xe=0;xe<this.boxKeys.length;xe++)oe.push({key:this.boxKeys[xe],x1:this.bboxes[xe*4],y1:this.bboxes[xe*4+1],x2:this.bboxes[xe*4+2],y2:this.bboxes[xe*4+3]});return Q?oe.filter(Q):oe}var Be={hitTest:k,seenUids:{box:{},circle:{}}};return this.forEachCell(x,p,h,S,this.queryCell,oe,Be,Q),k?oe.length>0:oe}},{key:"queryCell",value:function(x,p,h,S,k,Q,oe,xe){var Be=oe.seenUids,qe=this.boxCells[k];if(qe!==null){var zt=this.bboxes,Ht=ef(qe),Tr;try{for(Ht.s();!(Tr=Ht.n()).done;){var en=Tr.value;if(!Be.box[en]){Be.box[en]=!0;var An=en*4;if(x<=zt[An+2]&&p<=zt[An+3]&&h>=zt[An+0]&&S>=zt[An+1]&&(!xe||xe(this.boxKeys[en]))){if(oe.hitTest)return Q.push(!0),!0;Q.push({key:this.boxKeys[en],x1:zt[An],y1:zt[An+1],x2:zt[An+2],y2:zt[An+3]})}}}}catch(Hn){Ht.e(Hn)}finally{Ht.f()}}return!1}},{key:"forEachCell",value:function(x,p,h,S,k,Q,oe,xe){for(var Be=this.convertToXCellCoord(x),qe=this.convertToYCellCoord(p),zt=this.convertToXCellCoord(h),Ht=this.convertToYCellCoord(S),Tr=Be;Tr<=zt;Tr++)for(var en=qe;en<=Ht;en++){var An=this.xCellCount*en+Tr;if(k.call(this,x,p,h,S,An,Q,oe,xe))return}}},{key:"convertToXCellCoord",value:function(x){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(x*this.xScale)))}},{key:"convertToYCellCoord",value:function(x){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(x*this.yScale)))}}]),f}(),jl=Su,cl=function(){function f(F,x){(0,Z.Z)(this,f),(0,B.Z)(this,"width",void 0),(0,B.Z)(this,"height",void 0),(0,B.Z)(this,"grid",void 0),(0,B.Z)(this,"viewportPadding",100),(0,B.Z)(this,"screenRightBoundary",void 0),(0,B.Z)(this,"screenBottomBoundary",void 0),(0,B.Z)(this,"gridRightBoundary",void 0),(0,B.Z)(this,"gridBottomBoundary",void 0),this.width=F,this.height=x,this.viewportPadding=Math.max(F,x),this.grid=new jl(F+this.viewportPadding,x+this.viewportPadding,25),this.screenRightBoundary=F+this.viewportPadding,this.screenBottomBoundary=x+this.viewportPadding,this.gridRightBoundary=F+2*this.viewportPadding,this.gridBottomBoundary=x+2*this.viewportPadding}return(0,a.Z)(f,[{key:"placeCollisionBox",value:function(x){var p=x.x1+x.anchorPointX+this.viewportPadding,h=x.y1+x.anchorPointY+this.viewportPadding,S=x.x2+x.anchorPointX+this.viewportPadding,k=x.y2+x.anchorPointY+this.viewportPadding;return!this.isInsideGrid(p,h,S,k)||this.grid.hitTest(p,h,S,k)?{box:[]}:{box:[p,h,S,k]}}},{key:"insertCollisionBox",value:function(x,p){var h={featureIndex:p};this.grid.insert(h,x[0],x[1],x[2],x[3])}},{key:"project",value:function(x,p,h){var S=Cc.al(p,h,0,1),k=Cc.Ue(),Q=ht.fromValues.apply(ht,(0,Ne.Z)(x));return Cc.fF(k,S,Q),{x:(k[0]/k[3]+1)/2*this.width+this.viewportPadding,y:(-k[1]/k[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(x,p,h,S){return h>=0&&x<this.gridRightBoundary&&S>=0&&p<this.gridBottomBoundary}}]),f}();function tf(f,F){var x=typeof Symbol!="undefined"&&f[Symbol.iterator]||f["@@iterator"];if(!x){if(Array.isArray(f)||(x=Gl(f))||F&&f&&typeof f.length=="number"){x&&(f=x);var p=0,h=function(){};return{s:h,n:function(){return p>=f.length?{done:!0}:{done:!1,value:f[p++]}},e:function(xe){throw xe},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,k=!1,Q;return{s:function(){x=x.call(f)},n:function(){var xe=x.next();return S=xe.done,xe},e:function(xe){k=!0,Q=xe},f:function(){try{!S&&x.return!=null&&x.return()}finally{if(k)throw Q}}}}function Gl(f,F){if(!!f){if(typeof f=="string")return fl(f,F);var x=Object.prototype.toString.call(f).slice(8,-1);if(x==="Object"&&f.constructor&&(x=f.constructor.name),x==="Map"||x==="Set")return Array.from(f);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return fl(f,F)}}function fl(f,F){(F==null||F>f.length)&&(F=f.length);for(var x=0,p=new Array(F);x<F;x++)p[x]=f[x];return p}function jc(f){var F=.5,x=.5;switch(f){case"right":case"top-right":case"bottom-right":F=1;break;case"left":case"top-left":case"bottom-left":F=0;break;default:F=.5}switch(f){case"bottom":case"bottom-right":case"bottom-left":x=1;break;case"top":case"top-right":case"top-left":x=0;break;default:x=.5}return{horizontalAlign:F,verticalAlign:x}}function Vl(f,F,x,p,h){if(!!h){var S=f[p],k=S.glyph;if(k)for(var Q=F[k].advance*S.scale,oe=(f[p].x+Q)*h,xe=x;xe<=p;xe++)f[xe].x-=oe}}function Cl(f,F,x,p,h,S,k){var Q=(F-x)*h,oe=(-p*k+.5)*S,xe=tf(f),Be;try{for(xe.s();!(Be=xe.n()).done;){var qe=Be.value;qe.x+=Q,qe.y+=oe}}catch(zt){xe.e(zt)}finally{xe.f()}}function Nf(f,F,x,p,h,S,k){var Q=-8,oe=0,xe=Q,Be=0,qe=f.positionedGlyphs,zt=S==="right"?1:S==="left"?0:.5,Ht=qe.length;x.forEach(function(si){if(si.split("").forEach(function(di){var qi=F[di],ta=0;qi&&(qe.push({glyph:di,x:oe,y:xe+ta,vertical:!1,scale:1,metrics:qi}),oe+=qi.advance+k)}),qe.length!==Ht){var ni=oe-k;Be=Math.max(ni,Be),Vl(qe,F,Ht,qe.length-1,zt)}oe=0,xe-=p+5});var Tr=jc(h),en=Tr.horizontalAlign,An=Tr.verticalAlign;Cl(qe,zt,en,An,Be,p,x.length);var Hn=xe-Q;f.top+=-An*Hn,f.bottom=f.top-Hn,f.left+=-en*Be,f.right=f.left+Be}function rf(f,F,x,p,h,S,k){var Q=-8,oe=0,xe=Q,Be=0,qe=f.positionedGlyphs,zt=S==="right"?1:S==="left"?0:.5,Ht=qe.length;x.forEach(function(si){var ni=F[si],di=0;if(ni&&(qe.push({glyph:si,x:ni.advance/2,y:xe+di,vertical:!1,scale:1,metrics:ni}),oe+=ni.advance+k),qe.length!==Ht){var qi=oe-k;Be=Math.max(qi,Be),Vl(qe,F,Ht,qe.length-1,zt)}oe=0,xe-=p+5});var Tr=jc(h),en=Tr.horizontalAlign,An=Tr.verticalAlign;Cl(qe,zt,en,An,Be,p,x.length);var Hn=xe-Q;f.top+=-An*Hn,f.bottom=f.top-Hn,f.left+=-en*Be,f.right=f.left+Be}function le(f,F,x,p,h,S){var k=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],Q=arguments.length>7?arguments[7]:void 0,oe=f.split(`
`),xe=[],Be={positionedGlyphs:xe,top:k[1],bottom:k[1],left:k[0],right:k[0],lineCount:oe.length,text:f};return Q?rf(Be,F,oe,x,p,h,S):Nf(Be,F,oe,x,p,h,S),xe.length?Be:!1}function Ve(f){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],x=arguments.length>2?arguments[2]:void 0,p=f.positionedGlyphs,h=p===void 0?[]:p,S=[],k=tf(h),Q;try{for(k.s();!(Q=k.n()).done;){var oe=Q.value,xe=oe.metrics,Be=4,qe=xe.advance*oe.scale/2,zt=x?[oe.x+qe,oe.y]:[0,0],Ht=x?[0,0]:[oe.x+qe+F[0],oe.y+F[1]],Tr=(0-Be)*oe.scale-qe+Ht[0],en=(0-Be)*oe.scale+Ht[1],An=Tr+xe.width*oe.scale,Hn=en+xe.height*oe.scale,si={x:Tr,y:en},ni={x:An,y:en},di={x:Tr,y:Hn},qi={x:An,y:Hn};S.push({tl:si,tr:ni,bl:di,br:qi,tex:xe,glyphOffset:zt})}}catch(ta){k.e(ta)}finally{k.f()}return S}function _t(f,F){var x=typeof Symbol!="undefined"&&f[Symbol.iterator]||f["@@iterator"];if(!x){if(Array.isArray(f)||(x=ut(f))||F&&f&&typeof f.length=="number"){x&&(f=x);var p=0,h=function(){};return{s:h,n:function(){return p>=f.length?{done:!0}:{done:!1,value:f[p++]}},e:function(xe){throw xe},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,k=!1,Q;return{s:function(){x=x.call(f)},n:function(){var xe=x.next();return S=xe.done,xe},e:function(xe){k=!0,Q=xe},f:function(){try{!S&&x.return!=null&&x.return()}finally{if(k)throw Q}}}}function ut(f,F){if(!!f){if(typeof f=="string")return Wt(f,F);var x=Object.prototype.toString.call(f).slice(8,-1);if(x==="Object"&&f.constructor&&(x=f.constructor.name),x==="Map"||x==="Set")return Array.from(f);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return Wt(f,F)}}function Wt(f,F){(F==null||F>f.length)&&(F=f.length);for(var x=0,p=new Array(F);x<F;x++)p[x]=f[x];return p}function hn(f){var F=Mi();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Mi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var da=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,oa=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function za(f){var F=this,x=f.id,p=[],h=[];if(!F.glyphInfoMap||!F.glyphInfoMap[x])return{vertices:[],indices:[],size:7};var S=F.glyphInfoMap[x].centroid,k=S.length===2?[S[0],S[1],0]:S;return F.glyphInfoMap[x].glyphQuads.forEach(function(Q,oe){p.push.apply(p,(0,Ne.Z)(k).concat([Q.tex.x,Q.tex.y+Q.tex.height,Q.tl.x,Q.tl.y],(0,Ne.Z)(k),[Q.tex.x+Q.tex.width,Q.tex.y+Q.tex.height,Q.tr.x,Q.tr.y],(0,Ne.Z)(k),[Q.tex.x+Q.tex.width,Q.tex.y,Q.br.x,Q.br.y],(0,Ne.Z)(k),[Q.tex.x,Q.tex.y,Q.bl.x,Q.bl.y])),h.push(0+oe*4,1+oe*4,2+oe*4,2+oe*4,3+oe*4,0+oe*4)}),{vertices:p,indices:h,size:7}}var Xo=function(f){(0,L.Z)(x,f);var F=hn(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"glyphInfo",void 0),(0,B.Z)((0,P.Z)(p),"glyphInfoMap",{}),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"currentZoom",-1),(0,B.Z)((0,P.Z)(p),"extent",void 0),(0,B.Z)((0,P.Z)(p),"textureHeight",0),(0,B.Z)((0,P.Z)(p),"textCount",0),(0,B.Z)((0,P.Z)(p),"preTextStyle",{}),(0,B.Z)((0,P.Z)(p),"buildModels",function(){var Q=p.layer.getLayerConfig(),oe=Q.mask,xe=oe===void 0?!1:oe,Be=Q.maskInside,qe=Be===void 0?!0:Be;return p.initGlyph(),p.updateTexture(),p.filterGlyphs(),p.reBuildModel(),[p.layer.buildLayerModel({moduleName:"pointText",vertexShader:oa,fragmentShader:da,triangulation:za.bind((0,P.Z)(p)),depth:{enable:!1},blend:p.getBlend(),stencil:(0,Ge.getMask)(xe,qe)})]}),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.stroke,oe=Q===void 0?"#fff":Q,xe=h.strokeWidth,Be=xe===void 0?0:xe,qe=h.textAnchor,zt=qe===void 0?"center":qe,Ht=h.textAllowOverlap,Tr=Ht===void 0?!1:Ht,en=h.halo,An=en===void 0?.5:en,Hn=h.gamma,si=Hn===void 0?2:Hn,ni=h.raisingHeight,di=ni===void 0?0:ni,qi=this.fontService,ta=qi.canvas,Xi=qi.mapping;if(Object.keys(Xi).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Xi).length),this.preTextStyle={textAnchor:zt,textAllowOverlap:Tr},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k,strokeWidth:Be,stroke:oe})){this.judgeStyleAttributes({opacity:k,strokeWidth:Be,stroke:oe});var Ja=this.layer.getEncodedData(),po=this.calDataFrame(this.cellLength,Ja,this.cellProperties),zo=po.data,Ta=po.width,Io=po.height;this.rowCount=Io,this.dataTexture=this.cellLength>0&&zo.length>0?this.createTexture2D({flipY:!0,data:zo,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:Ta,height:Io}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(di),u_opacity:Qi()(k)?k:1,u_stroke_width:Qi()(Be)?Be:0,u_stroke_color:this.getStrokeColor(oe),u_sdf_map:this.texture,u_halo_blur:An,u_gamma_scale:si,u_sdf_map_size:[ta.width,ta.height]}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var h=this.layer.getLayerConfig(),S=h.textAnchor,k=S===void 0?"center":S,Q=h.textAllowOverlap,oe=Q===void 0?!0:Q;return this.preTextStyle={textAnchor:k,textAllowOverlap:oe},this.buildModels()}},{key:"needUpdate",value:function(){var h=this.layer.getLayerConfig(),S=h.textAllowOverlap,k=S===void 0?!1:S,Q=this.mapService.getZoom(),oe=this.mapService.getBounds(),xe=(0,Ge.boundsContains)(this.extent,oe);return!k&&(Math.abs(this.currentZoom-Q)>1||!xe)||k!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy(),this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:v.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.rotate,Be=xe===void 0?0:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:v.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[5],Q[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?12:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:v.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}},{key:"textExtent",value:function(){var h=this.mapService.getBounds();return(0,Ge.padBounds)(h,.5)}},{key:"initTextFont",value:function(){var h=this.layer.getLayerConfig(),S=h.fontWeight,k=S===void 0?"400":S,Q=h.fontFamily,oe=Q===void 0?"sans-serif":Q,xe=this.layer.getEncodedData(),Be=[];xe.forEach(function(qe){var zt=qe.shape,Ht=zt===void 0?"":zt;Ht=Ht.toString();var Tr=_t(Ht),en;try{for(Tr.s();!(en=Tr.n()).done;){var An=en.value;Be.indexOf(An)===-1&&Be.push(An)}}catch(Hn){Tr.e(Hn)}finally{Tr.f()}}),this.fontService.setFontOptions({characterSet:Be,fontWeight:k,fontFamily:oe,iconfont:!1})}},{key:"initIconFontTex",value:function(){var h=this.layer.getLayerConfig(),S=h.fontWeight,k=S===void 0?"400":S,Q=h.fontFamily,oe=Q===void 0?"sans-serif":Q,xe=this.layer.getEncodedData(),Be=[];xe.forEach(function(qe){var zt=qe.shape,Ht=zt===void 0?"":zt;Ht="".concat(Ht),Be.indexOf(Ht)===-1&&Be.push(Ht)}),this.fontService.setFontOptions({characterSet:Be,fontWeight:k,fontFamily:oe,iconfont:!0})}},{key:"generateGlyphLayout",value:function(h){var S=this,k=this.fontService.mapping,Q=this.layer.getLayerConfig(),oe=Q.spacing,xe=oe===void 0?2:oe,Be=Q.textAnchor,qe=Be===void 0?"center":Be,zt=this.layer.getEncodedData();this.glyphInfo=zt.map(function(Ht){var Tr=Ht.shape,en=Tr===void 0?"":Tr,An=Ht.id,Hn=Ht.size,si=Hn===void 0?1:Hn,ni=Ht.textOffset,di=ni===void 0?[0,0]:ni,qi=le(en.toString(),k,si,qe,"left",xe,di,h),ta=Ve(qi,di,!1);return Ht.shaping=qi,Ht.glyphQuads=ta,Ht.centroid=(0,zr.S)(Ht.coordinates),Ht.originCentroid=Ht.version==="GAODE2.x"?(0,zr.S)(Ht.originCoordinates):Ht.originCentroid=Ht.centroid,S.glyphInfoMap[An]={shaping:qi,glyphQuads:ta,centroid:(0,zr.S)(Ht.coordinates)},Ht})}},{key:"filterGlyphs",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.padding,Q=k===void 0?[4,4]:k,oe=S.textAllowOverlap,xe=oe===void 0?!1:oe;if(!xe){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Be=this.rendererService.getViewportSize(),qe=Be.width,zt=Be.height,Ht=new cl(qe,zt),Tr=this.glyphInfo.filter(function(en){var An=en.shaping,Hn=en.id,si=Hn===void 0?0:Hn,ni=en.version==="GAODE2.x"?en.originCentroid:en.centroid,di=en.size,qi=di/24,ta=h.mapService.lngLatToContainer(ni),Xi=Ht.placeCollisionBox({x1:An.left*qi-Q[0],x2:An.right*qi+Q[0],y1:An.top*qi-Q[1],y2:An.bottom*qi+Q[1],anchorPointX:ta.x,anchorPointY:ta.y}),Ja=Xi.box;return Ja&&Ja.length?(Ht.insertCollisionBox(Ja,si),!0):!1});Tr.forEach(function(en){h.glyphInfoMap[en.id]=en})}}},{key:"initGlyph",value:function(){var h=this.layer.getLayerConfig(),S=h.iconfont,k=S===void 0?!1:S;k?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(k)}},{key:"updateTexture",value:function(){var h=this.rendererService.createTexture2D,S=this.fontService.canvas;this.textureHeight=S.height,this.texture&&this.texture.destroy(),this.texture=h({data:S,mag:v.gl.LINEAR,min:v.gl.LINEAR,width:S.width,height:S.height})}},{key:"reBuildModel",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:oa,fragmentShader:da,triangulation:za.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}}]),x}(Y.Z),Sc={fillImage:Ku,fill:Zu,radar:Qu,image:El,normal:Uc,simplePoint:pf,extrude:ha,text:Xo,icon:Va},hl=Sc;function df(f,F){var x=typeof Symbol!="undefined"&&f[Symbol.iterator]||f["@@iterator"];if(!x){if(Array.isArray(f)||(x=yh(f))||F&&f&&typeof f.length=="number"){x&&(f=x);var p=0,h=function(){};return{s:h,n:function(){return p>=f.length?{done:!0}:{done:!1,value:f[p++]}},e:function(xe){throw xe},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,k=!1,Q;return{s:function(){x=x.call(f)},n:function(){var xe=x.next();return S=xe.done,xe},e:function(xe){k=!0,Q=xe},f:function(){try{!S&&x.return!=null&&x.return()}finally{if(k)throw Q}}}}function yh(f,F){if(!!f){if(typeof f=="string")return ih(f,F);var x=Object.prototype.toString.call(f).slice(8,-1);if(x==="Object"&&f.constructor&&(x=f.constructor.name),x==="Map"||x==="Set")return Array.from(f);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return ih(f,F)}}function ih(f,F){(F==null||F>f.length)&&(F=f.length);for(var x=0,p=new Array(F);x<F;x++)p[x]=f[x];return p}function Hl(f){var F=Sl();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Sl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var ac=function(f){(0,L.Z)(x,f);var F=Hl(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","PointLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new hl[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var h=this.shapeOption,S=h.field,k=h.values,Q=this.getLayerConfig(),oe=Q.shape2d,xe=Q.shape3d,Be=this.iconService.getIconMap();if(S&&(oe==null?void 0:oe.indexOf(S))!==-1)return"fill";if(k&&k instanceof Array){var qe=df(k),zt;try{for(qe.s();!(zt=qe.n()).done;){var Ht=zt.value;if(typeof Ht=="string"&&Be.hasOwnProperty(Ht))return"image"}}catch(Tr){qe.e(Tr)}finally{qe.f()}}}return"normal"}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return S[h]}},{key:"getModelType",value:function(){var h=["fillImage","fill","radar","image","normal","simplePoint","extrude","text","icon"];if(this.layerType&&h.includes(this.layerType))return this.layerType;var S=this.getEncodedData(),k=this.getLayerConfig(),Q=k.shape2d,oe=k.shape3d,xe=this.iconService.getIconMap(),Be=S.find(function(zt){return zt.hasOwnProperty("shape")});if(Be){var qe=Be.shape;return qe==="dot"?"normal":qe==="simple"?"simplePoint":qe==="radar"?"radar":qe==="fillImage"?"fillImage":(Q==null?void 0:Q.indexOf(qe))!==-1?"fill":(oe==null?void 0:oe.indexOf(qe))!==-1?"extrude":xe.hasOwnProperty(qe)?"image":this.fontService.getGlyph(qe)!==""?"icon":"text"}else return this.getModelTypeWillEmptyData()}}]),x}(V.Z);function Vs(f){var F=Gc();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Gc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var vf=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];  
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  if(isSide < 1.0 && u_linearColor == 1.0) {
    vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
    linearColor.rgb *= lightWeight;
    gl_FragColor = linearColor;
  } else {
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Hs=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,zi=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
// varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float lightWeight = styleMappingMat[3][1];
  float topU = styleMappingMat[2][2];
  float topV = styleMappingMat[2][3];

  float sidey = styleMappingMat[3][0];
  if(isSide < 1.0) {
    gl_FragColor = mix(u_targetColor, u_sourceColor, sidey);
    gl_FragColor.rgb *= lightWeight;
  } else {
    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ks=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[2][2] = a_uvs[0];
  styleMappingMat[2][3] = 1.0 - a_uvs[1];
  styleMappingMat[3][0] = a_uvs[2];


  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,Vc=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  if(isSide < 1.0 && u_linearColor == 1.0) {
    vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
    linearColor.rgb *= lightWeight;
    gl_FragColor = linearColor;
  } else {
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,nf=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,Ws=function(f){(0,L.Z)(x,f);var F=Vs(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.heightfixed,oe=Q===void 0?!1:Q,xe=h.raisingHeight,Be=xe===void 0?0:xe,qe=h.sourceColor,zt=h.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k})){this.judgeStyleAttributes({opacity:k});var Ht=this.layer.getEncodedData(),Tr=this.calDataFrame(this.cellLength,Ht,this.cellProperties),en=Tr.data,An=Tr.width,Hn=Tr.height;this.rowCount=Hn,this.dataTexture=this.cellLength>0&&en.length>0?this.createTexture2D({flipY:!0,data:en,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:An,height:Hn}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}var si=0,ni=[1,1,1,1],di=[1,1,1,1];return qe&&zt&&(ni=(0,Ge.rgb2arr)(qe),di=(0,Ge.rgb2arr)(zt),si=1),{u_heightfixed:Number(oe),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(Be),u_opacity:Qi()(k)?k:1,u_linearColor:si,u_sourceColor:ni,u_targetColor:di,u_texture:this.texture}}},{key:"initModels",value:function(){return this.loadTexture(),this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=this.getShaders(),Be=xe.frag,qe=xe.vert,zt=xe.type;return[this.layer.buildLayerModel({moduleName:zt,vertexShader:qe,fragmentShader:Be,triangulation:Qe.Xz,stencil:(0,Ge.getMask)(k,oe),cull:{enable:!0,face:v.gl.BACK}})]}},{key:"getShaders",value:function(){var h=this.layer.getLayerConfig(),S=h.pickLight,k=h.mapTexture;return k?{frag:zi,vert:ks,type:"polygonExtrudeTexture"}:S?{frag:Vc,vert:nf,type:"polygonExtrude"}:{frag:vf,vert:Hs,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var h,S;(h=this.dataTexture)===null||h===void 0||h.destroy(),(S=this.texture)===null||S===void 0||S.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this.layer.getSource().extent,S=(0,N.Z)(h,4),k=S[0],Q=S[1],oe=S[2],xe=S[3],Be=oe-k,qe=xe-Q;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:v.AttributeType.Attribute,descriptor:{name:"a_uvs",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(Ht,Tr,en,An,Hn){var si=en[0],ni=en[1];return[(si-k)/Be,(ni-Q)/qe,en[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(Ht,Tr,en,An,Hn){return Hn}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(Ht,Tr,en,An){var Hn=Ht.size,si=Hn===void 0?10:Hn;return Array.isArray(si)?[si[0]]:[si]}}})}},{key:"loadTexture",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.mapTexture,Q=this.rendererService.createTexture2D;if(this.texture=Q({height:0,width:0}),k){var oe=new Image;oe.crossOrigin="",oe.src=k,oe.onload=function(){h.texture=Q({data:oe,width:oe.width,height:oe.height,wrapS:v.gl.CLAMP_TO_EDGE,wrapT:v.gl.CLAMP_TO_EDGE,min:v.gl.LINEAR,mag:v.gl.LINEAR}),h.layerService.updateLayerRenderList(),h.layerService.renderLayers()}}}}]),x}(Y.Z);function Vu(f){var F=mf();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var _i=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,gf=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,$f=`attribute vec4 a_Color;
attribute vec3 a_Position;



uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,Al=`attribute vec4 a_Color;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,_s=function(f){(0,L.Z)(x,f);var F=Vu(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.opacityLinear,oe=Q===void 0?{enable:!1,dir:"in"}:Q;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k})){this.judgeStyleAttributes({opacity:k});var xe=this.layer.getEncodedData(),Be=this.calDataFrame(this.cellLength,xe,this.cellProperties),qe=Be.data,zt=Be.width,Ht=Be.height;this.rowCount=Ht,this.dataTexture=this.cellLength>0&&qe.length>0?this.createTexture2D({flipY:!0,data:qe,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:zt,height:Ht}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(k)?k:1,u_opacitylinear:Number(oe.enable),u_dir:oe.dir==="in"?1:0}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.opacityLinear,k=S===void 0?{enable:!1,dir:"in"}:S,Q=h.mask,oe=Q===void 0?!1:Q,xe=h.maskInside,Be=xe===void 0?!0:xe;return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:k.enable?$f:Al,fragmentShader:k.enable?gf:_i,triangulation:k.enable?Qe.T3:Qe.Qr,blend:this.getBlend(),depth:{enable:!1},cull:{enable:!0,face:v.gl.BACK},stencil:(0,Ge.getMask)(oe,Be)})]}},{key:"clearModels",value:function(){var h;(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this.layer.getLayerConfig(),S=h.opacityLinear,k=S===void 0?{enable:!1,dir:"in"}:S;k.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:v.AttributeType.Attribute,descriptor:{name:"a_linear",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(oe,xe,Be,qe,zt){return[Be[3],Be[4],Be[5]]}}})}}]),x}(Y.Z);function Au(f){var F=yf();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function yf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Tl=`
uniform float u_time;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = styleMappingMat[0][0];
  gl_FragColor = vec4(col, opacity);

  // gl_FragColor = v_Color;
  
}
`,Ru=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  v_uv = a_uv;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,Ac=function(f){(0,L.Z)(x,f);var F=Au(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture1",void 0),(0,B.Z)((0,P.Z)(p),"texture2",void 0),(0,B.Z)((0,P.Z)(p),"texture3",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.watercolor,oe=Q===void 0?"#6D99A8":Q,xe=h.watercolor2,Be=xe===void 0?"#0F121C":xe;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k})){this.judgeStyleAttributes({opacity:k});var qe=this.layer.getEncodedData(),zt=this.calDataFrame(this.cellLength,qe,this.cellProperties),Ht=zt.data,Tr=zt.width,en=zt.height;this.rowCount=en,this.dataTexture=this.cellLength>0&&Ht.length>0?this.createTexture2D({flipY:!0,data:Ht,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:Tr,height:en}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:(0,Ge.rgb2arr)(oe),u_watercolor2:(0,Ge.rgb2arr)(Be),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:Qi()(k)?k:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.loadTexture(),this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"polygon_ocean",vertexShader:Ru,fragmentShader:Tl,triangulation:Qe.Qr,depth:{enable:!1},stencil:(0,Ge.getMask)(k,oe)})]}},{key:"clearModels",value:function(){var h,S,k,Q;(h=this.texture1)===null||h===void 0||h.destroy(),(S=this.texture2)===null||S===void 0||S.destroy(),(k=this.texture3)===null||k===void 0||k.destroy(),(Q=this.dataTexture)===null||Q===void 0||Q.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this.layer.getSource().extent,S=(0,N.Z)(h,4),k=S[0],Q=S[1],oe=S[2],xe=S[3],Be=oe-k,qe=xe-Q;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:v.AttributeType.Attribute,descriptor:{name:"a_uv",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(Ht,Tr,en,An,Hn){var si=(0,N.Z)(en,2),ni=si[0],di=si[1];return[(ni-k)/Be,(di-Q)/qe]}}})}},{key:"loadTexture",value:function(){var h=this,S=this.rendererService.createTexture2D,k={height:0,width:0};this.texture1=S(k),this.texture2=S(k),this.texture3=S(k),Q(function(xe){h.texture1=oe(xe[0]),h.texture2=oe(xe[1]),h.texture3=oe(xe[2]),h.layerService.updateLayerRenderList(),h.layerService.renderLayers()});function Q(xe){var Be=0,qe=[],zt=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];zt.map(function(Ht){var Tr=new Image;Tr.crossOrigin="",Tr.src=Ht,qe.push(Tr),Tr.onload=function(){Be++,Be===3&&xe(qe)}})}function oe(xe){return S({data:xe,width:xe.width,height:xe.height,wrapS:v.gl.MIRRORED_REPEAT,wrapT:v.gl.MIRRORED_REPEAT,min:v.gl.LINEAR,mag:v.gl.LINEAR})}}}]),x}(Y.Z);function ah(f){var F=zf();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function zf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Uf=`
uniform sampler2D u_texture;
uniform float u_time;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

  float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

  float water(vec3 p) {
    float t = u_time * u_speed;
    p.z += t * 2.; p.x += t * 2.;
    vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
    p.z += t * 3.; p.x += t * 0.52;
    vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
    p.z += t * 4.; p.x += t * 0.8;
    vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
    c1 += c2 - c3;
    float z = (c1.x + c1.y + c1.z) / 3.;
    return p.y + z / 4.;
  }

  float map(vec3 p) {
    float d = 100.0;
    d = water(p);
    return d;
  }

  float intersect(vec3 ro, vec3 rd) {
    float d = 0.0;
    for (int i = 0; i <= 100; i++) {
      float h = map(ro + rd * d);
      if (h < 0.1) return  d;
      d += h;
    }
    return 0.0;
  }
  
  vec3 norm(vec3 p) {
    float eps = .1;
    return normalize(vec3(
      map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
      map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
      map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
    ));
  } 

  float calSpc() {
    vec3 l1 = normalize(vec3(1, 1, 1));
    vec3 ro = vec3(-3, 20, -8);
    vec3 rc = vec3(0, 0, 0);
    vec3 ww = normalize(rc - ro);
    vec3 uu = normalize(cross(vec3(0,1,0), ww));
    vec3 vv = normalize(cross(rc - ro, uu));
    vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
    float d = intersect(ro, rd);
    vec3 p = ro + rd * d;
    vec3 n = norm(p);
    float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
    return spc;
  }

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,oh=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  v_uv = a_uv;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,wl=function(f){(0,L.Z)(x,f);var F=ah(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.speed,oe=Q===void 0?.5:Q;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:k})){this.judgeStyleAttributes({opacity:k});var xe=this.layer.getEncodedData(),Be=this.calDataFrame(this.cellLength,xe,this.cellProperties),qe=Be.data,zt=Be.width,Ht=Be.height;this.rowCount=Ht,this.dataTexture=this.cellLength>0&&qe.length>0?this.createTexture2D({flipY:!0,data:qe,format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:zt,height:Ht}):this.createTexture2D({flipY:!0,data:[1],format:v.gl.LUMINANCE,type:v.gl.FLOAT,width:1,height:1})}return{u_texture:this.texture,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_speed:oe,u_opacity:Qi()(k)?k:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.loadTexture(),this.buildModels()}},{key:"buildModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q;return[this.layer.buildLayerModel({moduleName:"polygon_water",vertexShader:oh,fragmentShader:Uf,triangulation:Qe.Qr,depth:{enable:!1},stencil:(0,Ge.getMask)(k,oe)})]}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.dataTexture)===null||S===void 0||S.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this.layer.getSource().extent,S=(0,N.Z)(h,4),k=S[0],Q=S[1],oe=S[2],xe=S[3],Be=oe-k,qe=xe-Q;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:v.AttributeType.Attribute,descriptor:{name:"a_uv",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(Ht,Tr,en,An,Hn){var si=(0,N.Z)(en,2),ni=si[0],di=si[1];return[(ni-k)/Be,(di-Q)/qe]}}})}},{key:"loadTexture",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.waterTexture,Q=this.rendererService.createTexture2D;this.texture=Q({height:0,width:0});var oe=new Image;oe.crossOrigin="",k?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),oe.src=k):oe.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",oe.onload=function(){h.texture=Q({data:oe,width:oe.width,height:oe.height,wrapS:v.gl.MIRRORED_REPEAT,wrapT:v.gl.MIRRORED_REPEAT,min:v.gl.LINEAR,mag:v.gl.LINEAR}),h.layerService.updateLayerRenderList(),h.layerService.renderLayers()}}}]),x}(Y.Z),pl={fill:_s,line:ia,extrude:Ws,text:Xo,point_fill:Zu,point_image:El,point_normal:Uc,point_extrude:ha,water:wl,ocean:Ac},fo=pl;function Ju(f){var F=Ml();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Ml(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Xs=function(f){(0,L.Z)(x,f);var F=Ju(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","PolygonLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new fo[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var h,S=this.styleAttributeService.getLayerStyleAttribute("shape"),k=S==null||(h=S.scale)===null||h===void 0?void 0:h.field;return k==="fill"?"fill":k==="extrude"?"extrude":k==="water"?"water":k==="ocean"?"ocean":k==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var h=this.getEncodedData(),S=this.getLayerConfig(),k=S.shape2d,Q=S.shape3d,oe=this.iconService.getIconMap(),xe=h.find(function(qe){return qe.hasOwnProperty("shape")});if(xe){var Be=xe.shape;return Be==="dot"?"point_normal":(k==null?void 0:k.indexOf(Be))!==-1?"point_fill":(Q==null?void 0:Q.indexOf(Be))!==-1?"point_extrude":oe.hasOwnProperty(Be)?"point_image":"text"}else return"fill"}}]),x}(V.Z);function oc(f){var F=Hc();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Hc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Tu=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,Hu=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Js=function(f){(0,L.Z)(x,f);var F=oc(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"colorTexture",void 0),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S,Q=h.clampLow,oe=Q===void 0?!0:Q,xe=h.clampHigh,Be=xe===void 0?!0:xe,qe=h.noDataValue,zt=qe===void 0?-9999999:qe,Ht=h.domain,Tr=Ht===void 0?[0,1]:Ht;return this.updateColorTexure(),{u_opacity:k||1,u_texture:this.texture,u_domain:Tr,u_clampLow:oe,u_clampHigh:typeof Be!="undefined"?Be:oe,u_noDataValue:zt,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var h=this.layer.getLayerConfig(),S=h.mask,k=S===void 0?!1:S,Q=h.maskInside,oe=Q===void 0?!0:Q,xe=this.layer.getSource(),Be=this.rendererService.createTexture2D,qe=xe.data.dataArray[0];this.texture=Be({data:qe.data,width:qe.width,height:qe.height,format:v.gl.LUMINANCE,type:v.gl.FLOAT});var zt=this.layer.getLayerConfig(),Ht=zt.rampColors,Tr=(0,Ge.generateColorRamp)(Ht);return this.colorTexture=Be({data:Tr.data,width:Tr.width,height:Tr.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:Hu,fragmentShader:Tu,triangulation:Qe.iC,primitive:v.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:(0,Ge.getMask)(k,oe)})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}},{key:"updateColorTexure",value:function(){var h=this.rendererService.createTexture2D,S=this.layer.getLayerConfig(),k=S.rampColors,Q=(0,Ge.generateColorRamp)(k);this.colorTexture=h({data:Q.data,width:Q.width,height:Q.height,flipY:!1})}}]),x}(Y.Z),la={raster:Js,raster3d:Js},Vi=la;function wf(f){var F=wu();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function wu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Wl=function(f){(0,L.Z)(x,f);var F=wf(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","RasterLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new Vi[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={raster:{},raster3d:{}};return S[h]}},{key:"getModelType",value:function(){return"raster"}}]),x}(V.Z);function mu(f){var F=Pl();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Pl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Zf=`
uniform float u_opacity;
uniform vec3 u_CameraPosition;

varying vec3 vVertexNormal;
varying float v_offset;
varying vec4 v_Color;
void main() {
    
    
    // float intensity = pow(0.5 + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);
    float intensity = pow(v_offset + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);
    // TODO: \u53BB\u9664\u80CC\u9762
    if(intensity > 1.0) intensity = 0.0;

    gl_FragColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);
}
`,sc=`
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
attribute vec4 a_Color;
uniform vec3 u_CameraPosition;
varying float v_CamreaDistance;

uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_ViewMatrix;

varying vec3 vVertexNormal;
varying vec4 v_Color;
varying float v_offset;

void main() {
    float EARTH_RADIUS = 100.0;
    
    v_Color = a_Color;

    v_offset = min(((length(u_CameraPosition) - EARTH_RADIUS)/600.0) * 0.5 + 0.4, 1.0);
    vVertexNormal = a_Normal;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,$o=function(f){(0,L.Z)(x,f);var F=mu(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S;return{u_opacity:Qi()(k)?k:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(){return this.layer.zIndex=-997,[this.layer.buildLayerModel({moduleName:"earthAtmoSphere",vertexShader:sc,fragmentShader:Zf,triangulation:Qe.NW,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k,Q,oe,xe){return xe}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}}]),x}(Y.Z);function fs(f){var F=_f();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function _f(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var uc=`
uniform sampler2D u_texture;

varying vec2 v_texCoord;
varying float v_lightWeight;


void main() {

    vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
    color.xyz = color.xyz * v_lightWeight;
    gl_FragColor = color;
}
`,lc=`// attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
varying vec2 v_texCoord;

// attribute vec2 a_Extrude;
// attribute float a_Size;
// attribute float a_Shape;

uniform vec3 u_CameraPosition;
uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform float u_ambientRatio : 0.5;
uniform float u_diffuseRatio : 0.3;
uniform float u_specularRatio : 0.2;
uniform vec3 u_sunLight: [1.0, -10.5, 12.0];



float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;

    // cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(u_sunLight);

    vec3 halfDir = normalize(viewDir+lightDir);
    // lambert
    float lambert = dot(worldNormal, lightDir);
    // specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
    //sum to light weight
    float lightWeight = u_ambientRatio + u_diffuseRatio * lambert + u_specularRatio * specular;

    return lightWeight;
}

varying float v_lightWeight;
void main() {

    v_texCoord = a_Uv;

    float lightWeight = calc_lighting(vec4(a_Position, 1.0));
    v_lightWeight = lightWeight;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,Ll=function(f){(0,L.Z)(x,f);var F=fs(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"earthTime",3.4),(0,B.Z)((0,P.Z)(p),"sunX",1e3),(0,B.Z)((0,P.Z)(p),"sunY",1e3),(0,B.Z)((0,P.Z)(p),"sunZ",1e3),(0,B.Z)((0,P.Z)(p),"sunRadius",Math.sqrt(p.sunX*p.sunX+p.sunY*p.sunY+p.sunZ*p.sunZ)),p}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.animateOption,k=h.globelOtions;return S!=null&&S.enable&&(this.mapService.rotateY({reg:.002}),this.earthTime+=.02,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY)),{u_ambientRatio:(k==null?void 0:k.ambientRatio)||.6,u_diffuseRatio:(k==null?void 0:k.diffuseRatio)||.4,u_specularRatio:(k==null?void 0:k.specularRatio)||.1,u_sunLight:[this.sunX,this.sunY,this.sunZ],u_texture:this.texture}}},{key:"setEarthTime",value:function(h){this.earthTime=h,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY),this.layerService.renderLayers()}},{key:"initModels",value:function(){var h=this,S=this.layer.getLayerConfig(),k=S.globelOtions;(k==null?void 0:k.earthTime)!==void 0&&this.setEarthTime(k.earthTime);var Q=this.layer.getSource(),oe=this.rendererService.createTexture2D;return this.texture=oe({height:0,width:0}),Q.data.images.then(function(xe){h.texture=oe({data:xe[0],width:xe[0].width,height:xe[0].height}),h.layerService.updateLayerRenderList(),h.layerService.renderLayers()}),this.buildModels()}},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(){return this.layer.zIndex=-998,[this.layer.buildLayerModel({moduleName:"baseEarth",vertexShader:lc,fragmentShader:uc,triangulation:Qe.NW,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k,Q,oe,xe){return xe}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}}]),x}(Y.Z);function au(f){var F=Tc();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Tc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var cc=`
uniform float u_opacity;
uniform vec3 u_CameraPosition;
varying vec3 vVertexNormal;

varying vec4 v_Color;
void main() {


    float intensity =  - dot(normalize(vVertexNormal), normalize(u_CameraPosition));
    // TODO: \u53BB\u9664\u80CC\u9762
    if(intensity > 1.0) intensity = 0.0;

    gl_FragColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);
}
`,xf=`
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
attribute vec4 a_Color;
uniform vec3 u_CameraPosition;
uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_ViewMatrix;

varying vec3 vVertexNormal;
varying vec4 v_Color;

void main() {
    v_Color = a_Color;

    vVertexNormal = a_Normal;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,fc=function(f){(0,L.Z)(x,f);var F=au(x);function x(){return(0,Z.Z)(this,x),F.apply(this,arguments)}return(0,a.Z)(x,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity,k=S===void 0?1:S;return{u_opacity:Qi()(k)?k:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(){return this.layer.zIndex=-999,[this.layer.buildLayerModel({moduleName:"earthBloomSphere",vertexShader:xf,fragmentShader:cc,triangulation:Qe.qZ,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:v.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(S,k,Q,oe){var xe=S.size,Be=xe===void 0?1:xe;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:v.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:v.gl.STATIC_DRAW,data:[],type:v.gl.FLOAT},size:3,update:function(S,k,Q,oe,xe){return xe}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}}]),x}(Y.Z);function Xl(f){var F=Mf();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var af={base:Ll,atomSphere:$o,bloomSphere:fc},Yl=["base","atomSphere","bloomSphere"],of=function(f){(0,L.Z)(x,f);var F=Xl(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","EarthLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new af[h](this),this.models=this.layerModel.initModels()}},{key:"setEarthTime",value:function(h){this.layerModel&&this.layerModel.setEarthTime?this.layerModel.setEarthTime(h):console.error("\u8BF7\u5728 scene loaded \u4E4B\u540E\u6267\u884C\u8BE5\u65B9\u6CD5\uFF01")}},{key:"getModelType",value:function(){var h,S=this.styleAttributeService.getLayerStyleAttribute("shape"),k=(S==null||(h=S.scale)===null||h===void 0?void 0:h.field)||"base";return Yl.indexOf(k)<0&&(k="base"),k}}]),x}(V.Z),$l=y(27630);function Kl(f,F,x){var p=hc(f,f.VERTEX_SHADER,F),h=hc(f,f.FRAGMENT_SHADER,x);if(!p||!h)return null;var S=f.createProgram();if(!S)return null;f.attachShader(S,p),f.attachShader(S,h),f.linkProgram(S);var k=f.getProgramParameter(S,f.LINK_STATUS);if(!k){var Q=f.getProgramInfoLog(S);return console.warn("Failed to link program: "+Q),f.deleteProgram(S),f.deleteShader(h),f.deleteShader(p),null}for(var oe=f.getProgramParameter(S,f.ACTIVE_ATTRIBUTES),xe=0;xe<oe;xe++){var Be=f.getActiveAttrib(S,xe);S[Be.name]=f.getAttribLocation(S,Be.name)}for(var qe=f.getProgramParameter(S,f.ACTIVE_UNIFORMS),zt=0;zt<qe;zt++){var Ht=f.getActiveUniform(S,zt);S[Ht.name]=f.getUniformLocation(S,Ht.name)}return S.vertexShader=p,S.fragmentShader=h,S}function hc(f,F,x){var p=f.createShader(F);if(p==null)return console.warn("unable to create shader"),null;f.shaderSource(p,x),f.compileShader(p);var h=f.getShaderParameter(p,f.COMPILE_STATUS);if(!h){var S=f.getShaderInfoLog(p);return console.warn("Failed to compile shader: "+S),f.deleteShader(p),null}return p}function gu(f,F,x,p,h){var S=f.createTexture();return f.bindTexture(f.TEXTURE_2D,S),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,F),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,F),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,p,h,0,f.RGBA,f.UNSIGNED_BYTE,x),f.bindTexture(f.TEXTURE_2D,null),S}function el(f,F,x){var p=f.createTexture();return f.bindTexture(f.TEXTURE_2D,p),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,F),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,F),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,x),f.bindTexture(f.TEXTURE_2D,null),p}function Wc(f,F,x){f.activeTexture(f.TEXTURE0+x),f.bindTexture(f.TEXTURE_2D,F)}function sf(f,F){var x=f.createBuffer();return f.bindBuffer(f.ARRAY_BUFFER,x),f.bufferData(f.ARRAY_BUFFER,F,f.STATIC_DRAW),x}function sh(f,F,x,p,h){var S=f.createBuffer();S||console.warn("failed create vertex buffer"),f.bindBuffer(f.ARRAY_BUFFER,S),f.bufferData(f.ARRAY_BUFFER,x,f.STATIC_DRAW);var k=f.getAttribLocation(h,F);return f.vertexAttribPointer(k,p,f.FLOAT,!1,0,0),f.enableVertexAttribArray(k),f.bindBuffer(f.ARRAY_BUFFER,null),{buffer:S,attr:k,count:p}}function Pf(f,F){var x=f.createBuffer();return x||console.warn("failed create vertex buffer"),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,x),f.bufferData(f.ELEMENT_ARRAY_BUFFER,F,f.STATIC_DRAW),x}function n(f,F,x,p,h){var S=f.getUniformLocation(p,F);return S<0&&console.warn("\u65E0\u6CD5\u83B7\u53D6 uniform \u53D8\u91CF\u7684\u5B58\u50A8\u4F4D\u7F6E"),o(f,S,x,h),S}function o(f,F,x,p){switch(p){case"float":f.uniform1f(F,x);break;case"vec2":f.uniform2fv(F,x);break;case"vec3":f.uniform3fv(F,x);break;case"vec4":f.uniform4fv(F,x);break;case"bool":f.uniform1i(F,x);break;case"sampler2d":break;case"mat4":f.uniformMatrix4fv(F,!1,x);break}}function i(f){var F=f.drawingBufferWidth,x=f.drawingBufferHeight,p=F,h=x,S=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,S);var k=f.createRenderbuffer();f.bindRenderbuffer(f.RENDERBUFFER,k),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,p,h),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,k);var Q=f.createTexture(),oe=1024;return S.texture=Q,S.width=p,S.height=h,f.bindTexture(f.TEXTURE_2D,Q),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,p,h,0,f.RGBA,f.UNSIGNED_BYTE,null),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,Q,0),f.bindTexture(f.TEXTURE_2D,null),f.bindFramebuffer(f.FRAMEBUFFER,null),{FRAMEBUFFER:S,OFFER_SCREEN_WIDTH:p,OFFER_SCREEN_HEIGHT:h}}var l=`
 precision mediump float;
 
 attribute float a_index;
 
 uniform sampler2D u_particles;
 uniform float u_particles_res;
 
 varying vec2 v_particle_pos;
 
 void main() {
     vec4 color = texture2D(u_particles, vec2(
         fract(a_index / u_particles_res),
         floor(a_index / u_particles_res) / u_particles_res)
     );
                
     // decode current particle position from the pixel's RGBA value
     v_particle_pos = vec2( color.r / 255.0 + color.b, color.g / 255.0 + color.a);
                         
     gl_PointSize = 1.0;
     gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, 1.0 - 2.0 * v_particle_pos.y, 0, 1);
 }`,w=`
 precision mediump float;
 
 uniform sampler2D u_wind;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform sampler2D u_color_ramp;
 
 varying vec2 v_particle_pos;
 
 void main() {
     vec2 velocity = mix(u_wind_min, u_wind_max, texture2D(u_wind, v_particle_pos).rg);
     float speed_t = length(velocity) / length(u_wind_max);
     
     // color ramp is encoded in a 16x16 texture    
     vec2 ramp_pos = vec2( fract(16.0 * speed_t), floor(16.0 * speed_t) / 16.0);  
 
     gl_FragColor = texture2D(u_color_ramp, ramp_pos);
 }`,z=`
 precision mediump float;
 
 attribute vec2 a_pos;
 
 varying vec2 v_tex_pos;
 
 void main() {
     v_tex_pos = a_pos;
     gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);
     // framebuffer \u59CB\u7EC8\u7528\u94FA\u6EE1\u5C4F\u5E55\u7684 texture
 }`,j=`
 precision highp float;
 
 uniform sampler2D u_particles;
 uniform sampler2D u_wind;
 uniform vec2 u_wind_res;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform float u_rand_seed;
 uniform float u_speed_factor;
 uniform float u_drop_rate;
 uniform float u_drop_rate_bump;
 
 varying vec2 v_tex_pos;
 
 // pseudo-random generator
 const vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);
 float rand(const vec2 co) {
 float t = dot(rand_constants.xy, co);
     return fract(sin(t) * (rand_constants.z + t));
 }
     
 // wind speed lookup; use manual bilinear filtering based on 4 adjacent pixels for smooth interpolation
 vec2 lookup_wind(const vec2 uv) {
     // return texture2D(u_wind, uv).rg; // lower-res hardware filtering
     vec2 px = 1.0 / u_wind_res;
     vec2 vc = (floor(uv * u_wind_res)) * px;
     vec2 f = fract(uv * u_wind_res);
     vec2 tl = texture2D(u_wind, vc).rg;
     vec2 tr = texture2D(u_wind, vc + vec2(px.x, 0)).rg;
     vec2 bl = texture2D(u_wind, vc + vec2(0, px.y)).rg;
     vec2 br = texture2D(u_wind, vc + px).rg;
     return mix(mix(tl, tr, f.x), mix(bl, br, f.x), f.y);
 }
 
 void main() {
     vec4 color = texture2D(u_particles, v_tex_pos);
     vec2 pos = vec2(
         color.r / 255.0 + color.b,
         color.g / 255.0 + color.a); // decode particle position from pixel RGBA
     vec2 velocity = mix(u_wind_min, u_wind_max, lookup_wind(pos));
     float speed_t = length(velocity) / length(u_wind_max);
                 
     // take EPSG:4236 distortion into account for calculating where the particle moved
     float distortion = cos(radians(pos.y * 180.0 - 90.0));
     vec2 offset = vec2(velocity.x / distortion, -velocity.y) * 0.0001 * u_speed_factor;
 
     // update particle position, wrapping around the date line
     pos = fract(1.0 + pos + offset);
     
     // a random seed to use for the particle drop
     vec2 seed = (pos + v_tex_pos) * u_rand_seed;
     
     // drop rate is a chance a particle will restart at random position, to avoid degeneration
     float drop_rate = u_drop_rate + speed_t * u_drop_rate_bump;
     float drop = step(1.0 - drop_rate, rand(seed));
     
     vec2 random_pos = vec2(
         rand(seed + 1.3),
         rand(seed + 2.1));
         pos = mix(pos, random_pos, drop);
         
     // encode the new particle position back into RGBA
     gl_FragColor = vec4(
         fract(pos * 255.0),
         floor(pos * 255.0) / 255.0);
 }`,ae=`
     precision mediump float;
     
     attribute vec2 a_pos;
     
     varying vec2 v_tex_pos;
     
     void main() {
         v_tex_pos = a_pos;
         gl_Position = vec4(1.0 - 2.0 * a_pos, 0.0, 1.0);
         gl_PointSize = 100.0;
 }`,Se=`
 precision mediump float;
 
 uniform sampler2D u_screen;
 uniform float u_opacity;
 varying vec2 v_tex_pos;
 
 void main() {
     vec4 color = texture2D(u_screen, 1.0 - v_tex_pos);
     
     // a hack to guarantee opacity fade out even with a value close to 1.0
     gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);
 }`;function He(f){var F=document.createElement("canvas"),x=F.getContext("2d");F.width=256,F.height=1;for(var p=x.createLinearGradient(0,0,256,0),h=0,S=Object.keys(f);h<S.length;h++){var k=S[h];p.addColorStop(+k,f[+k])}return x.fillStyle=p,x.fillRect(0,0,256,1),F=null,new Uint8Array(x.getImageData(0,0,256,1).data)}function xt(f,F,x,p){f.bindBuffer(f.ARRAY_BUFFER,F),f.enableVertexAttribArray(x),f.vertexAttribPointer(x,p,f.FLOAT,!1,0,0)}function Et(f,F,x){f.bindFramebuffer(f.FRAMEBUFFER,F),x&&f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,x,0)}var Tt=function(){function f(F){(0,Z.Z)(this,f),(0,B.Z)(this,"width",512),(0,B.Z)(this,"height",512),(0,B.Z)(this,"pixels",void 0),(0,B.Z)(this,"fadeOpacity",void 0),(0,B.Z)(this,"speedFactor",void 0),(0,B.Z)(this,"dropRate",void 0),(0,B.Z)(this,"dropRateBump",void 0),(0,B.Z)(this,"gl",void 0),(0,B.Z)(this,"drawProgram",void 0),(0,B.Z)(this,"fullScreenProgram",void 0),(0,B.Z)(this,"updateProgram",void 0),(0,B.Z)(this,"rampColors",void 0),(0,B.Z)(this,"numParticles",65536),(0,B.Z)(this,"numParticlesSize",void 0),(0,B.Z)(this,"particleStateResolution",void 0),(0,B.Z)(this,"quadBuffer",void 0),(0,B.Z)(this,"particleIndexBuffer",void 0),(0,B.Z)(this,"framebuffer",void 0),(0,B.Z)(this,"colorRampTexture",void 0),(0,B.Z)(this,"backgroundTexture",void 0),(0,B.Z)(this,"screenTexture",void 0),(0,B.Z)(this,"particleStateTexture0",void 0),(0,B.Z)(this,"particleStateTexture1",void 0),(0,B.Z)(this,"windTexture",void 0),(0,B.Z)(this,"windData",void 0),this.gl=F.glContext,this.width=F.imageWidth,this.height=F.imageHeight,this.fadeOpacity=F.fadeOpacity,this.speedFactor=F.speedFactor,this.dropRate=F.dropRate,this.dropRateBump=F.dropRateBump,this.rampColors=F.rampColors,this.init()}return(0,a.Z)(f,[{key:"init",value:function(){var x=this.gl;this.fadeOpacity=.996,this.speedFactor=.25,this.dropRate=.003,this.dropRateBump=.01,this.drawProgram=Kl(x,l,w),this.fullScreenProgram=Kl(x,ae,Se),this.updateProgram=Kl(x,z,j),this.quadBuffer=sf(x,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),this.framebuffer=x.createFramebuffer(),this.colorRampTexture=gu(this.gl,this.gl.LINEAR,He(this.rampColors),16,16);var p=new Uint8Array(this.width*this.height*4);this.backgroundTexture=gu(x,x.NEAREST,p,this.width,this.height),this.screenTexture=gu(x,x.NEAREST,p,this.width,this.height);var h=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=h*h;for(var S=new Uint8Array(this.numParticlesSize*4),k=0;k<S.length;k++)S[k]=Math.floor(Math.random()*256);this.particleStateTexture0=gu(x,x.NEAREST,S,h,h),this.particleStateTexture1=gu(x,x.NEAREST,S,h,h);for(var Q=new Float32Array(this.numParticlesSize),oe=0;oe<this.numParticlesSize;oe++)Q[oe]=oe;this.particleIndexBuffer=sf(x,Q)}},{key:"setWind",value:function(x){this.windData=x,this.windTexture=el(this.gl,this.gl.LINEAR,x.image)}},{key:"updateParticelNum",value:function(x){var p=this.gl;if(x!==this.numParticles){this.numParticles=x;var h=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=h*h;for(var S=new Uint8Array(this.numParticlesSize*4),k=0;k<S.length;k++)S[k]=Math.floor(Math.random()*256);this.particleStateTexture0=gu(p,p.NEAREST,S,h,h),this.particleStateTexture1=gu(p,p.NEAREST,S,h,h);for(var Q=new Float32Array(this.numParticlesSize),oe=0;oe<this.numParticlesSize;oe++)Q[oe]=oe;this.particleIndexBuffer=sf(p,Q)}}},{key:"updateWindDir",value:function(x,p,h,S){this.windData.uMin=x,this.windData.uMax=p,this.windData.vMin=h,this.windData.vMax=S}},{key:"updateColorRampTexture",value:function(x){if(this.isColorChanged(x)){this.rampColors=x;var p=this.gl;p.deleteTexture(this.colorRampTexture),this.colorRampTexture=gu(p,p.LINEAR,He(x),16,16)}}},{key:"isColorChanged",value:function(x){for(var p=Object.keys(x),h=0,S=p;h<S.length;h++){var k=S[h],Q=Number(k);if(!this.rampColors[Q]||this.rampColors[Q]&&this.rampColors[Q]!==x[Q])return!0}return!1}},{key:"reSize",value:function(x,p){if(x!==this.width||p!==this.height){var h=this.gl;h.deleteTexture(this.backgroundTexture),h.deleteTexture(this.screenTexture),this.width=x,this.height=p;var S=new Uint8Array(x*p*4);this.backgroundTexture=gu(h,h.NEAREST,S,x,p),this.screenTexture=gu(h,h.NEAREST,S,x,p)}}},{key:"draw",value:function(){var x;if((x=this.windData)!==null&&x!==void 0&&x.image){var p=this.gl;return Wc(p,this.windTexture,0),Wc(p,this.particleStateTexture0,1),this.drawScreen(),this.updateParticles(),{d:this.pixels,w:this.width,h:this.height}}else return{d:new Uint8Array([0,0,0,0]),w:1,h:1}}},{key:"drawScreen",value:function(){var x=this.gl;Et(x,this.framebuffer,this.screenTexture),x.viewport(0,0,this.width,this.height),this.drawFullTexture(this.backgroundTexture,this.fadeOpacity),this.drawParticles(),x.disable(x.BLEND),this.pixels=new Uint8Array(4*this.width*this.height),x.readPixels(0,0,this.width,this.height,x.RGBA,x.UNSIGNED_BYTE,this.pixels),Et(x,null,null),x.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);var p=this.backgroundTexture;this.backgroundTexture=this.screenTexture,this.screenTexture=p}},{key:"drawFullTexture",value:function(x,p){var h=this.gl,S=this.fullScreenProgram;h.useProgram(S),h.bindBuffer(h.ARRAY_BUFFER,this.quadBuffer),h.vertexAttribPointer(S.a_pos,2,h.FLOAT,!1,0,0),h.enableVertexAttribArray(S.a_pos),h.bindBuffer(h.ARRAY_BUFFER,null),Wc(h,x,2),h.uniform1i(S.u_screen,2),h.uniform1f(S.u_opacity,p),h.drawArrays(h.TRIANGLES,0,6)}},{key:"drawParticles",value:function(){var x=this.gl,p=this.drawProgram;x.useProgram(p),xt(x,this.particleIndexBuffer,p.a_index,1),Wc(x,this.colorRampTexture,2),x.uniform1i(p.u_wind,0),x.uniform1i(p.u_particles,1),x.uniform1i(p.u_color_ramp,2),x.uniform1f(p.u_particles_res,this.particleStateResolution),x.uniform2f(p.u_wind_min,this.windData.uMin,this.windData.vMin),x.uniform2f(p.u_wind_max,this.windData.uMax,this.windData.vMax),x.drawArrays(x.POINTS,0,this.numParticlesSize)}},{key:"updateParticles",value:function(){var x=this.gl;Et(x,this.framebuffer,this.particleStateTexture1),x.viewport(0,0,this.particleStateResolution,this.particleStateResolution);var p=this.updateProgram;x.useProgram(p),xt(x,this.quadBuffer,p.a_pos,2),x.uniform1i(p.u_wind,0),x.uniform1i(p.u_particles,1),x.uniform1f(p.u_rand_seed,Math.random()),x.uniform2f(p.u_wind_res,this.windData.image.width*2,this.windData.image.height*2),x.uniform2f(p.u_wind_min,this.windData.uMin,this.windData.vMin),x.uniform2f(p.u_wind_max,this.windData.uMax,this.windData.vMax),x.uniform1f(p.u_speed_factor,this.speedFactor),x.uniform1f(p.u_drop_rate,this.dropRate),x.uniform1f(p.u_drop_rate_bump,this.dropRateBump),x.drawArrays(x.TRIANGLES,0,6);var h=this.particleStateTexture0;this.particleStateTexture0=this.particleStateTexture1,this.particleStateTexture1=h,Et(x,null,null)}},{key:"destroy",value:function(){this.gl.deleteBuffer(this.quadBuffer),this.gl.deleteBuffer(this.particleIndexBuffer),this.gl.deleteFramebuffer(this.framebuffer),this.gl.deleteShader(this.drawProgram.vertexShader),this.gl.deleteShader(this.drawProgram.fragmentShader),this.gl.deleteProgram(this.drawProgram),this.gl.deleteShader(this.fullScreenProgram.vertexShader),this.gl.deleteShader(this.fullScreenProgram.fragmentShader),this.gl.deleteProgram(this.fullScreenProgram),this.gl.deleteShader(this.updateProgram.vertexShader),this.gl.deleteShader(this.updateProgram.fragmentShader),this.gl.deleteProgram(this.updateProgram),this.gl.deleteTexture(this.colorRampTexture),this.gl.deleteTexture(this.backgroundTexture),this.gl.deleteTexture(this.screenTexture),this.gl.deleteTexture(this.particleStateTexture0),this.gl.deleteTexture(this.particleStateTexture1),this.gl.deleteTexture(this.windTexture)}}]),f}();function Jt(f){var F=Yt();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function Yt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var gr=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Vt=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,mr={0:"#3288bd",.1:"#66c2a5",.2:"#abdda4",.3:"#e6f598",.4:"#fee08b",.5:"#fdae61",.6:"#f46d43",1:"#d53e4f"},Ar=function(f){(0,L.Z)(x,f);var F=Jt(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"texture",void 0),(0,B.Z)((0,P.Z)(p),"colorModel",void 0),(0,B.Z)((0,P.Z)(p),"wind",void 0),(0,B.Z)((0,P.Z)(p),"imageCoords",void 0),(0,B.Z)((0,P.Z)(p),"sizeScale",.5),(0,B.Z)((0,P.Z)(p),"frequency",new Ge.FrequencyController(7.2)),p}return(0,a.Z)(x,[{key:"render",value:function(){var h=this;this.frequency.run(function(){h.drawWind()}),this.drawColorMode()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var h=this,S=this.rendererService.createTexture2D,k=this.layer.getSource();this.texture=S({height:0,width:0});var Q=this.rendererService.getGLContext();return this.imageCoords=k.data.dataArray[0].coordinates,k.data.images.then(function(oe){var xe=h.layer.getLayerConfig(),Be=xe.uMin,qe=Be===void 0?-21.32:Be,zt=xe.uMax,Ht=zt===void 0?26.8:zt,Tr=xe.vMin,en=Tr===void 0?-21.57:Tr,An=xe.vMax,Hn=An===void 0?21.42:An,si=xe.fadeOpacity,ni=si===void 0?.996:si,di=xe.speedFactor,qi=di===void 0?.25:di,ta=xe.dropRate,Xi=ta===void 0?.003:ta,Ja=xe.dropRateBump,po=Ja===void 0?.01:Ja,zo=xe.rampColors,Ta=zo===void 0?mr:zo,Io=xe.sizeScale,co=Io===void 0?.5:Io;h.sizeScale=co;var qs=h.getWindSize(),yl=qs.imageWidth,bc=qs.imageHeight,Fc={glContext:Q,imageWidth:yl,imageHeight:bc,fadeOpacity:ni,speedFactor:qi,dropRate:Xi,dropRateBump:po,rampColors:Ta};h.wind=new Tt(Fc),h.wind.setWind({uMin:qe,uMax:Ht,vMin:en,vMax:Hn,image:oe[0]}),h.texture=S({data:oe[0],width:oe[0].width,height:oe[0].height}),h.layerService.updateLayerRenderList(),h.layerService.renderLayers()}),this.colorModel=this.layer.buildLayerModel({moduleName:"WindLayer",vertexShader:Vt,fragmentShader:gr,triangulation:Qe.iC,primitive:v.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()}),[this.colorModel]}},{key:"getWindSize",value:function(){var h=this.mapService.lngLatToPixel(this.imageCoords[0]),S=this.mapService.lngLatToPixel(this.imageCoords[1]),k=Math.floor((S.x-h.x)*this.sizeScale),Q=Math.floor((h.y-S.y)*this.sizeScale);return{imageWidth:k,imageHeight:Q}}},{key:"buildModels",value:function(){return this.initModels()}},{key:"clearModels",value:function(){var h,S;(h=this.texture)===null||h===void 0||h.destroy(),(S=this.wind)===null||S===void 0||S.destroy()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:v.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:2,update:function(S,k,Q,oe){return[Q[3],Q[4]]}}})}},{key:"drawWind",value:function(){if(this.wind){var h=this.layer.getLayerConfig(),S=h.uMin,k=S===void 0?-21.32:S,Q=h.uMax,oe=Q===void 0?26.8:Q,xe=h.vMin,Be=xe===void 0?-21.57:xe,qe=h.vMax,zt=qe===void 0?21.42:qe,Ht=h.numParticles,Tr=Ht===void 0?65535:Ht,en=h.fadeOpacity,An=en===void 0?.996:en,Hn=h.speedFactor,si=Hn===void 0?.25:Hn,ni=h.dropRate,di=ni===void 0?.003:ni,qi=h.dropRateBump,ta=qi===void 0?.01:qi,Xi=h.rampColors,Ja=Xi===void 0?mr:Xi,po=h.sizeScale,zo=po===void 0?.5:po;if(typeof zo=="number"&&zo!==this.sizeScale){this.sizeScale=zo;var Ta=this.getWindSize(),Io=Ta.imageWidth,co=Ta.imageHeight;this.wind.reSize(Io,co)}this.wind.updateWindDir(k,oe,Be,zt),this.wind.updateParticelNum(Tr),this.wind.updateColorRampTexture(Ja),this.wind.fadeOpacity=An,this.wind.speedFactor=si,this.wind.dropRate=di,this.wind.dropRateBump=ta;var qs=this.wind.draw(),yl=qs.d,bc=qs.w,Fc=qs.h;this.rendererService.setBaseState(),this.texture.update({data:yl,width:bc,height:Fc})}}},{key:"drawColorMode",value:function(){var h=this.layer.getLayerConfig(),S=h.opacity;this.colorModel.draw({uniforms:{u_opacity:S||1,u_texture:this.texture}})}}]),x}(Y.Z),Xr={wind:Ar},cn=Xr;function nn(f){var F=pn();return function(){var p=(0,D.Z)(f),h;if(F){var S=(0,D.Z)(this).constructor;h=Reflect.construct(p,arguments,S)}else h=p.apply(this,arguments);return(0,O.Z)(this,h)}}function pn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(f){return!1}}var Bn=function(f){(0,L.Z)(x,f);var F=nn(x);function x(){var p;(0,Z.Z)(this,x);for(var h=arguments.length,S=new Array(h),k=0;k<h;k++)S[k]=arguments[k];return p=F.call.apply(F,[this].concat(S)),(0,B.Z)((0,P.Z)(p),"type","WindLayer"),p}return(0,a.Z)(x,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new cn[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){return this.layerModel&&this.layerModel.render(),this}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var h=this.getModelType(),S={wind:{}};return S[h]}},{key:"getModelType",value:function(){return"wind"}}]),x}(V.Z),Zn=y(32840),Vn=y(51747),Si=y(50361),Zi=y.n(Si),ca,ma,Co,Pi,Ha,Ma,Ba,Ea,oo;function Pa(f,F){var x=Object.keys(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(f);F&&(p=p.filter(function(h){return Object.getOwnPropertyDescriptor(f,h).enumerable})),x.push.apply(x,p)}return x}function Aa(f){for(var F=1;F<arguments.length;F++){var x=arguments[F]!=null?arguments[F]:{};F%2?Pa(Object(x),!0).forEach(function(p){(0,B.Z)(f,p,x[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(x)):Pa(Object(x)).forEach(function(p){Object.defineProperty(f,p,Object.getOwnPropertyDescriptor(x,p))})}return f}var eu=(ca=(0,ze.b2)(),ma=(0,ze.f3)(v.TYPES.IGlobalConfigService),Co=(0,ze.f3)(v.TYPES.IMapService),Pi=(0,ze.f3)(v.TYPES.IFontService),ca(Ha=(Ma=function(){function f(){(0,Z.Z)(this,f),(0,Zn.Z)(this,"configService",Ba,this),(0,Zn.Z)(this,"mapService",Ea,this),(0,Zn.Z)(this,"fontService",oo,this)}return(0,a.Z)(f,[{key:"apply",value:function(x,p){var h=this,S=p.styleAttributeService;x.hooks.init.tap("DataMappingPlugin",function(){h.generateMaping(x,{styleAttributeService:S})}),x.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return x.dataState.dataMappingNeedUpdate=!1,h.generateMaping(x,{styleAttributeService:S}),!0}),x.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!x.layerModelNeedUpdate){var k=x.getBottomColor(),Q=S.getLayerStyleAttributes()||[],oe=S.getLayerStyleAttribute("filter"),xe=x.getSource().data.dataArray,Be=Q.filter(function(zt){return zt.needRemapping}),qe=xe;oe!=null&&oe.needRemapping&&oe!==null&&oe!==void 0&&oe.scale&&(qe=xe.filter(function(zt){return h.applyAttributeMapping(oe,zt,k)[0]})),Be.length&&(oe!=null&&oe.needRemapping?(x.setEncodedData(h.mapping(Q,qe,void 0,k,x)),oe.needRemapping=!1):x.setEncodedData(h.mapping(Be,qe,x.getEncodedData(),k,x)),x.emit("remapping",null))}})}},{key:"generateMaping",value:function(x,p){var h=this,S=p.styleAttributeService,k=x.getBottomColor(),Q=S.getLayerStyleAttributes()||[],oe=S.getLayerStyleAttribute("filter"),xe=x.getSource().data.dataArray,Be=xe;oe!=null&&oe.scale&&(Be=xe.filter(function(qe){return h.applyAttributeMapping(oe,qe,k)[0]})),x.setEncodedData(this.mapping(Q,Be,void 0,k,x)),x.emit("dataUpdate",null)}},{key:"getArrowPoints",value:function(x,p){var h=[p[0]-x[0],p[1]-x[1]],S=(0,Ge.normalize)(h),k=[x[0]+S[0]*1e-4,x[1]+S[1]*1e-4];return k}},{key:"mapping",value:function(x,p,h,S,k){var Q=this,oe=k==null?void 0:k.getLayerConfig(),xe=oe.arrow,Be=xe===void 0?{enable:!1}:xe,qe=p.map(function(zt,Ht){var Tr=h?h[Ht]:{},en=Aa({id:zt._id,coordinates:zt.coordinates},Tr);if(x.filter(function(si){return si.scale!==void 0}).forEach(function(si){var ni=Q.applyAttributeMapping(si,zt,S);si.needRemapping=!1,si.name==="color"&&(ni=ni.map(function(di){return(0,Ge.rgb2arr)(di)})),en[si.name]=Array.isArray(ni)&&ni.length===1?ni[0]:ni,si.name==="shape"&&(en.shape=Q.fontService.getIconFontKey(en[si.name]))}),en.shape==="line"&&Be.enable){var An=en.coordinates,Hn=Q.getArrowPoints(An[0],An[1]);en.coordinates.splice(1,0,Hn,Hn)}return en});return this.adjustData2Amap2Coordinates(qe),this.adjustData2SimpleCoordinates(qe),qe}},{key:"adjustData2Amap2Coordinates",value:function(x){var p=this;x.length>0&&this.mapService.version===Xe.G["GAODE2.x"]&&(typeof x[0].coordinates[0]=="number"?x.filter(function(h){return!h.originCoordinates}).map(function(h){h.version=Xe.G["GAODE2.x"],h.originCoordinates=Zi()(h.coordinates),h.coordinates=p.mapService.lngLatToCoord(h.coordinates)}):x.filter(function(h){return!h.originCoordinates}).map(function(h){h.version=Xe.G["GAODE2.x"],h.originCoordinates=Zi()(h.coordinates),h.coordinates=p.mapService.lngLatToCoords(h.coordinates)}))}},{key:"adjustData2SimpleCoordinates",value:function(x){var p=this;x.length>0&&this.mapService.version===Xe.G.SIMPLE&&x.map(function(h){h.simpleCoordinate||(h.coordinates=p.unProjectCoordinates(h.coordinates),h.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(x){var p=this;if(typeof x[0]=="number")return this.mapService.simpleMapCoord.unproject(x);if(x[0]&&x[0][0]instanceof Array){var h=[];return x.map(function(k){var Q=[];k.map(function(oe){Q.push(p.mapService.simpleMapCoord.unproject(oe))}),h.push(Q)}),h}else{var S=[];return x.map(function(k){S.push(p.mapService.simpleMapCoord.unproject(k))}),S}}},{key:"applyAttributeMapping",value:function(x,p,h){var S;if(!x.scale)return[];var k=(x==null||(S=x.scale)===null||S===void 0?void 0:S.scalers)||[],Q=[];k.forEach(function(xe){var Be,qe=xe.field;(p.hasOwnProperty(qe)||((Be=x.scale)===null||Be===void 0?void 0:Be.type)==="variable")&&Q.push(p[qe])});var oe=x.mapping?x.mapping(Q):[];return x.name==="color"&&!(0,Ge.isColor)(oe[0])?[h]:oe}}]),f}(),Ba=(0,Vn.Z)(Ma.prototype,"configService",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ea=(0,Vn.Z)(Ma.prototype,"mapService",[Co],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=(0,Vn.Z)(Ma.prototype,"fontService",[Pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ma))||Ha),As=y(96090),tu,Ls,Ho=(tu=(0,ze.b2)(),tu(Ls=function(){function f(){(0,Z.Z)(this,f),(0,B.Z)(this,"mapService",void 0)}return(0,a.Z)(f,[{key:"apply",value:function(x){var p=this;this.mapService=x.getContainer().get(v.TYPES.IMapService),x.hooks.init.tap("DataSourcePlugin",function(){var h=x.getSource();if(!h){var S=x.sourceOption||{data:As.DEFAULT_DATA,options:As.DEFAULT_PARSER},k=S.data,Q=S.options;x.setSource(new As.default(k,Q))}p.updateClusterData(x)}),x.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var h=p.updateClusterData(x),S=x.dataState.dataSourceNeedUpdate;return x.dataState.dataSourceNeedUpdate=!1,h||S})}},{key:"updateClusterData",value:function(x){var p=x.getSource(),h=p.cluster,S=p.clusterOptions,k=S.zoom,Q=k===void 0?0:k,oe=S.maxZoom,xe=oe===void 0?16:oe,Be=this.mapService.getZoom()-1,qe=x.dataState.dataSourceNeedUpdate;return h&&(qe||Math.abs(x.clusterZoom-Be)>=1)?(Q!==Math.floor(Be)&&p.updateClusterData(Math.floor(Be)),x.clusterZoom=Be,!0):!1}}]),f}())||Ls),xs=y(44908),zs=y.n(xs),yu=y(47037),Xc=y.n(yu),ou=y(14293),su=y.n(ou);function Fs(f,F){return f<F?-1:f>F?1:f>=F?0:NaN}function uf(f){return f.length===1&&(f=tl(f)),{left:function(F,x,p,h){for(p==null&&(p=0),h==null&&(h=F.length);p<h;){var S=p+h>>>1;f(F[S],x)<0?p=S+1:h=S}return p},right:function(F,x,p,h){for(p==null&&(p=0),h==null&&(h=F.length);p<h;){var S=p+h>>>1;f(F[S],x)>0?h=S:p=S+1}return p}}}function tl(f){return function(F,x){return Fs(f(F),x)}}var Ol=uf(Fs),wc=Ol.right,Mc=Ol.left,Us=wc;function Yc(f,F){var x=f.length,p=-1,h,S,k;if(F==null){for(;++p<x;)if((h=f[p])!=null&&h>=h)for(S=k=h;++p<x;)(h=f[p])!=null&&(S>h&&(S=h),k<h&&(k=h))}else for(;++p<x;)if((h=F(f[p],p,f))!=null&&h>=h)for(S=k=h;++p<x;)(h=F(f[p],p,f))!=null&&(S>h&&(S=h),k<h&&(k=h));return[S,k]}var Il=Array.prototype,Bs=Il.slice,pc=Il.map,dc=Math.sqrt(50),ql=Math.sqrt(10),Uo=Math.sqrt(2);function rl(f,F,x){var p,h=-1,S,k,Q;if(F=+F,f=+f,x=+x,f===F&&x>0)return[f];if((p=F<f)&&(S=f,f=F,F=S),(Q=uu(f,F,x))===0||!isFinite(Q))return[];if(Q>0)for(f=Math.ceil(f/Q),F=Math.floor(F/Q),k=new Array(S=Math.ceil(F-f+1));++h<S;)k[h]=(f+h)*Q;else for(f=Math.floor(f*Q),F=Math.ceil(F*Q),k=new Array(S=Math.ceil(f-F+1));++h<S;)k[h]=(f-h)/Q;return p&&k.reverse(),k}function uu(f,F,x){var p=(F-f)/Math.max(0,x),h=Math.floor(Math.log(p)/Math.LN10),S=p/Math.pow(10,h);return h>=0?(S>=dc?10:S>=ql?5:S>=Uo?2:1)*Math.pow(10,h):-Math.pow(10,-h)/(S>=dc?10:S>=ql?5:S>=Uo?2:1)}function vc(f,F,x){var p=Math.abs(F-f)/Math.max(0,x),h=Math.pow(10,Math.floor(Math.log(p)/Math.LN10)),S=p/h;return S>=dc?h*=10:S>=ql?h*=5:S>=Uo&&(h*=2),F<f?-h:h}function jf(){var f=identity,F=extent,x=sturges;function p(h){var S,k=h.length,Q,oe=new Array(k);for(S=0;S<k;++S)oe[S]=f(h[S],S,h);var xe=F(oe),Be=xe[0],qe=xe[1],zt=x(oe,Be,qe);Array.isArray(zt)||(zt=tickStep(Be,qe,zt),zt=range(Math.ceil(Be/zt)*zt,qe,zt));for(var Ht=zt.length;zt[0]<=Be;)zt.shift(),--Ht;for(;zt[Ht-1]>qe;)zt.pop(),--Ht;var Tr=new Array(Ht+1),en;for(S=0;S<=Ht;++S)en=Tr[S]=[],en.x0=S>0?zt[S-1]:Be,en.x1=S<Ht?zt[S]:qe;for(S=0;S<k;++S)Q=oe[S],Be<=Q&&Q<=qe&&Tr[bisect(zt,Q,0,Ht)].push(h[S]);return Tr}return p.value=function(h){return arguments.length?(f=typeof h=="function"?h:constant(h),p):f},p.domain=function(h){return arguments.length?(F=typeof h=="function"?h:constant([h[0],h[1]]),p):F},p.thresholds=function(h){return arguments.length?(x=typeof h=="function"?h:Array.isArray(h)?constant(slice.call(h)):constant(h),p):x},p}function Pc(f,F,x){return f=map.call(f,number).sort(ascending),Math.ceil((x-F)/(2*(quantile(f,.75)-quantile(f,.25))*Math.pow(f.length,-1/3)))}function Lf(f){return f===null?NaN:+f}function Rl(f,F,x){if(x==null&&(x=Lf),!!(p=f.length)){if((F=+F)<=0||p<2)return+x(f[0],0,f);if(F>=1)return+x(f[p-1],p-1,f);var p,h=(p-1)*F,S=Math.floor(h),k=+x(f[S],S,f),Q=+x(f[S+1],S+1,f);return k+(Q-k)*(h-S)}}var Du="$";function ku(){}ku.prototype=Lc.prototype={constructor:ku,has:function(f){return Du+f in this},get:function(f){return this[Du+f]},set:function(f,F){return this[Du+f]=F,this},remove:function(f){var F=Du+f;return F in this&&delete this[F]},clear:function(){for(var f in this)f[0]===Du&&delete this[f]},keys:function(){var f=[];for(var F in this)F[0]===Du&&f.push(F.slice(1));return f},values:function(){var f=[];for(var F in this)F[0]===Du&&f.push(this[F]);return f},entries:function(){var f=[];for(var F in this)F[0]===Du&&f.push({key:F.slice(1),value:this[F]});return f},size:function(){var f=0;for(var F in this)F[0]===Du&&++f;return f},empty:function(){for(var f in this)if(f[0]===Du)return!1;return!0},each:function(f){for(var F in this)F[0]===Du&&f(this[F],F.slice(1),this)}};function Lc(f,F){var x=new ku;if(f instanceof ku)f.each(function(Q,oe){x.set(oe,Q)});else if(Array.isArray(f)){var p=-1,h=f.length,S;if(F==null)for(;++p<h;)x.set(p,f[p]);else for(;++p<h;)x.set(F(S=f[p],p,f),S)}else if(f)for(var k in f)x.set(k,f[k]);return x}var lf=Lc;function Oc(){var f=[],F=[],x,p,h;function S(Q,oe,xe,Be){if(oe>=f.length)return x!=null&&Q.sort(x),p!=null?p(Q):Q;for(var qe=-1,zt=Q.length,Ht=f[oe++],Tr,en,An=map(),Hn,si=xe();++qe<zt;)(Hn=An.get(Tr=Ht(en=Q[qe])+""))?Hn.push(en):An.set(Tr,[en]);return An.each(function(ni,di){Be(si,di,S(ni,oe,xe,Be))}),si}function k(Q,oe){if(++oe>f.length)return Q;var xe,Be=F[oe-1];return p!=null&&oe>=f.length?xe=Q.entries():(xe=[],Q.each(function(qe,zt){xe.push({key:zt,values:k(qe,oe)})})),Be!=null?xe.sort(function(qe,zt){return Be(qe.key,zt.key)}):xe}return h={object:function(Q){return S(Q,0,hu,bf)},map:function(Q){return S(Q,0,Gf,Kf)},entries:function(Q){return k(S(Q,0,Gf,Kf),0)},key:function(Q){return f.push(Q),h},sortKeys:function(Q){return F[f.length-1]=Q,h},sortValues:function(Q){return x=Q,h},rollup:function(Q){return p=Q,h}}}function hu(){return{}}function bf(f,F,x){f[F]=x}function Gf(){return map()}function Kf(f,F,x){f.set(F,x)}function Ef(){}var Cf=lf.prototype;Ef.prototype=_h.prototype={constructor:Ef,has:Cf.has,add:function(f){return f+="",this[Du+f]=f,this},remove:Cf.remove,clear:Cf.clear,values:Cf.keys,size:Cf.size,empty:Cf.empty,each:Cf.each};function _h(f,F){var x=new Ef;if(f instanceof Ef)f.each(function(S){x.add(S)});else if(f){var p=-1,h=f.length;if(F==null)for(;++p<h;)x.add(f[p]);else for(;++p<h;)x.add(F(f[p],p,f))}return x}var $c=null,Of=Array.prototype,If=Of.map,Rf=Of.slice;function dl(f,F){switch(arguments.length){case 0:break;case 1:this.range(f);break;default:this.range(F).domain(f);break}return this}function uh(f,F){switch(arguments.length){case 0:break;case 1:this.interpolator(f);break;default:this.interpolator(F).domain(f);break}return this}var xh={name:"implicit"};function qf(){var f=lf(),F=[],x=[],p=xh;function h(S){var k=S+"",Q=f.get(k);if(!Q){if(p!==xh)return p;f.set(k,Q=F.push(S))}return x[(Q-1)%x.length]}return h.domain=function(S){if(!arguments.length)return F.slice();F=[],f=lf();for(var k=-1,Q=S.length,oe,xe;++k<Q;)f.has(xe=(oe=S[k])+"")||f.set(xe,F.push(oe));return h},h.range=function(S){return arguments.length?(x=Rf.call(S),h):x.slice()},h.unknown=function(S){return arguments.length?(p=S,h):p},h.copy=function(){return qf(F,x).unknown(p)},dl.apply(h,arguments),h}function Vf(){var f=ordinal().unknown(void 0),F=f.domain,x=f.range,p=[0,1],h,S,k=!1,Q=0,oe=0,xe=.5;delete f.unknown;function Be(){var qe=F().length,zt=p[1]<p[0],Ht=p[zt-0],Tr=p[1-zt];h=(Tr-Ht)/Math.max(1,qe-Q+oe*2),k&&(h=Math.floor(h)),Ht+=(Tr-Ht-h*(qe-Q))*xe,S=h*(1-Q),k&&(Ht=Math.round(Ht),S=Math.round(S));var en=sequence(qe).map(function(An){return Ht+h*An});return x(zt?en.reverse():en)}return f.domain=function(qe){return arguments.length?(F(qe),Be()):F()},f.range=function(qe){return arguments.length?(p=[+qe[0],+qe[1]],Be()):p.slice()},f.rangeRound=function(qe){return p=[+qe[0],+qe[1]],k=!0,Be()},f.bandwidth=function(){return S},f.step=function(){return h},f.round=function(qe){return arguments.length?(k=!!qe,Be()):k},f.padding=function(qe){return arguments.length?(Q=Math.min(1,oe=+qe),Be()):Q},f.paddingInner=function(qe){return arguments.length?(Q=Math.min(1,qe),Be()):Q},f.paddingOuter=function(qe){return arguments.length?(oe=+qe,Be()):oe},f.align=function(qe){return arguments.length?(xe=Math.max(0,Math.min(1,qe)),Be()):xe},f.copy=function(){return Vf(F(),p).round(k).paddingInner(Q).paddingOuter(oe).align(xe)},initRange.apply(Be(),arguments)}function bh(f){var F=f.copy;return f.padding=f.paddingOuter,delete f.paddingInner,delete f.paddingOuter,f.copy=function(){return bh(F())},f}function gp(){return bh(Vf.apply(null,arguments).paddingInner(1))}var lh=y(26257),Gh=y(73626);function Ph(f,F){return f=+f,F=+F,function(x){return Math.round(f*(1-x)+F*x)}}function ch(f){return function(){return f}}function Fu(f){return+f}var Dl=[0,1];function ns(f){return f}function Qf(f,F){return(F-=f=+f)?function(x){return(x-f)/F}:ch(isNaN(F)?NaN:.5)}function Df(f){var F=f[0],x=f[f.length-1],p;return F>x&&(p=F,F=x,x=p),function(h){return Math.max(F,Math.min(x,h))}}function Hf(f,F,x){var p=f[0],h=f[1],S=F[0],k=F[1];return h<p?(p=Qf(h,p),S=x(k,S)):(p=Qf(p,h),S=x(S,k)),function(Q){return S(p(Q))}}function Wf(f,F,x){var p=Math.min(f.length,F.length)-1,h=new Array(p),S=new Array(p),k=-1;for(f[p]<f[0]&&(f=f.slice().reverse(),F=F.slice().reverse());++k<p;)h[k]=Qf(f[k],f[k+1]),S[k]=x(F[k],F[k+1]);return function(Q){var oe=Us(f,Q,1,p)-1;return S[oe](h[oe](Q))}}function Kc(f,F){return F.domain(f.domain()).range(f.range()).interpolate(f.interpolate()).clamp(f.clamp()).unknown(f.unknown())}function kf(){var f=Dl,F=Dl,x=lh.Z,p,h,S,k=ns,Q,oe,xe;function Be(){return Q=Math.min(f.length,F.length)>2?Wf:Hf,oe=xe=null,qe}function qe(zt){return isNaN(zt=+zt)?S:(oe||(oe=Q(f.map(p),F,x)))(p(k(zt)))}return qe.invert=function(zt){return k(h((xe||(xe=Q(F,f.map(p),Gh.Z)))(zt)))},qe.domain=function(zt){return arguments.length?(f=If.call(zt,Fu),k===ns||(k=Df(f)),Be()):f.slice()},qe.range=function(zt){return arguments.length?(F=Rf.call(zt),Be()):F.slice()},qe.rangeRound=function(zt){return F=Rf.call(zt),x=Ph,Be()},qe.clamp=function(zt){return arguments.length?(k=zt?Df(f):ns,qe):k!==ns},qe.interpolate=function(zt){return arguments.length?(x=zt,Be()):x},qe.unknown=function(zt){return arguments.length?(S=zt,qe):S},function(zt,Ht){return p=zt,h=Ht,Be()}}function qc(f,F){return kf()(f,F)}var Qc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ic(f){if(!(F=Qc.exec(f)))throw new Error("invalid format: "+f);var F;return new C({fill:F[1],align:F[2],sign:F[3],symbol:F[4],zero:F[5],width:F[6],comma:F[7],precision:F[8]&&F[8].slice(1),trim:F[9],type:F[10]})}Ic.prototype=C.prototype;function C(f){this.fill=f.fill===void 0?" ":f.fill+"",this.align=f.align===void 0?">":f.align+"",this.sign=f.sign===void 0?"-":f.sign+"",this.symbol=f.symbol===void 0?"":f.symbol+"",this.zero=!!f.zero,this.width=f.width===void 0?void 0:+f.width,this.comma=!!f.comma,this.precision=f.precision===void 0?void 0:+f.precision,this.trim=!!f.trim,this.type=f.type===void 0?"":f.type+""}C.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ve(f){return Math.abs(f=Math.round(f))>=1e21?f.toLocaleString("en").replace(/,/g,""):f.toString(10)}function $(f,F){if((x=(f=F?f.toExponential(F-1):f.toExponential()).indexOf("e"))<0)return null;var x,p=f.slice(0,x);return[p.length>1?p[0]+p.slice(2):p,+f.slice(x+1)]}function ee(f){return f=$(Math.abs(f)),f?f[1]:NaN}function Ee(f,F){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ee(F)/3)))*3-ee(Math.abs(f)))}function We(f,F){return function(x,p){for(var h=x.length,S=[],k=0,Q=f[0],oe=0;h>0&&Q>0&&(oe+Q+1>p&&(Q=Math.max(1,p-oe)),S.push(x.substring(h-=Q,h+Q)),!((oe+=Q+1)>p));)Q=f[k=(k+1)%f.length];return S.reverse().join(F)}}function er(f){return function(F){return F.replace(/[0-9]/g,function(x){return f[+x]})}}function hr(f){e:for(var F=f.length,x=1,p=-1,h;x<F;++x)switch(f[x]){case".":p=h=x;break;case"0":p===0&&(p=x),h=x;break;default:if(!+f[x])break e;p>0&&(p=0);break}return p>0?f.slice(0,p)+f.slice(h+1):f}var Kt;function kr(f,F){var x=$(f,F);if(!x)return f+"";var p=x[0],h=x[1],S=h-(Kt=Math.max(-8,Math.min(8,Math.floor(h/3)))*3)+1,k=p.length;return S===k?p:S>k?p+new Array(S-k+1).join("0"):S>0?p.slice(0,S)+"."+p.slice(S):"0."+new Array(1-S).join("0")+$(f,Math.max(0,F+S-1))[0]}function wn(f,F){var x=$(f,F);if(!x)return f+"";var p=x[0],h=x[1];return h<0?"0."+new Array(-h).join("0")+p:p.length>h+1?p.slice(0,h+1)+"."+p.slice(h+1):p+new Array(h-p.length+2).join("0")}var Ai={"%":function(f,F){return(f*100).toFixed(F)},b:function(f){return Math.round(f).toString(2)},c:function(f){return f+""},d:ve,e:function(f,F){return f.toExponential(F)},f:function(f,F){return f.toFixed(F)},g:function(f,F){return f.toPrecision(F)},o:function(f){return Math.round(f).toString(8)},p:function(f,F){return wn(f*100,F)},r:wn,s:kr,X:function(f){return Math.round(f).toString(16).toUpperCase()},x:function(f){return Math.round(f).toString(16)}};function Hi(f){return f}var $i=Array.prototype.map,R=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function m(f){var F=f.grouping===void 0||f.thousands===void 0?Hi:We($i.call(f.grouping,Number),f.thousands+""),x=f.currency===void 0?"":f.currency[0]+"",p=f.currency===void 0?"":f.currency[1]+"",h=f.decimal===void 0?".":f.decimal+"",S=f.numerals===void 0?Hi:er($i.call(f.numerals,String)),k=f.percent===void 0?"%":f.percent+"",Q=f.minus===void 0?"-":f.minus+"",oe=f.nan===void 0?"NaN":f.nan+"";function xe(qe){qe=Ic(qe);var zt=qe.fill,Ht=qe.align,Tr=qe.sign,en=qe.symbol,An=qe.zero,Hn=qe.width,si=qe.comma,ni=qe.precision,di=qe.trim,qi=qe.type;qi==="n"?(si=!0,qi="g"):Ai[qi]||(ni===void 0&&(ni=12),di=!0,qi="g"),(An||zt==="0"&&Ht==="=")&&(An=!0,zt="0",Ht="=");var ta=en==="$"?x:en==="#"&&/[boxX]/.test(qi)?"0"+qi.toLowerCase():"",Xi=en==="$"?p:/[%p]/.test(qi)?k:"",Ja=Ai[qi],po=/[defgprs%]/.test(qi);ni=ni===void 0?6:/[gprs]/.test(qi)?Math.max(1,Math.min(21,ni)):Math.max(0,Math.min(20,ni));function zo(Ta){var Io=ta,co=Xi,qs,yl,bc;if(qi==="c")co=Ja(Ta)+co,Ta="";else{Ta=+Ta;var Fc=Ta<0||1/Ta<0;if(Ta=isNaN(Ta)?oe:Ja(Math.abs(Ta),ni),di&&(Ta=hr(Ta)),Fc&&+Ta==0&&Tr!=="+"&&(Fc=!1),Io=(Fc?Tr==="("?Tr:Q:Tr==="-"||Tr==="("?"":Tr)+Io,co=(qi==="s"?R[8+Kt/3]:"")+co+(Fc&&Tr==="("?")":""),po){for(qs=-1,yl=Ta.length;++qs<yl;)if(bc=Ta.charCodeAt(qs),48>bc||bc>57){co=(bc===46?h+Ta.slice(qs+1):Ta.slice(qs))+co,Ta=Ta.slice(0,qs);break}}}si&&!An&&(Ta=F(Ta,Infinity));var Yf=Io.length+Ta.length+co.length,zl=Yf<Hn?new Array(Hn-Yf+1).join(zt):"";switch(si&&An&&(Ta=F(zl+Ta,zl.length?Hn-co.length:Infinity),zl=""),Ht){case"<":Ta=Io+Ta+co+zl;break;case"=":Ta=Io+zl+Ta+co;break;case"^":Ta=zl.slice(0,Yf=zl.length>>1)+Io+Ta+co+zl.slice(Yf);break;default:Ta=zl+Io+Ta+co;break}return S(Ta)}return zo.toString=function(){return qe+""},zo}function Be(qe,zt){var Ht=xe((qe=Ic(qe),qe.type="f",qe)),Tr=Math.max(-8,Math.min(8,Math.floor(ee(zt)/3)))*3,en=Math.pow(10,-Tr),An=R[8+Tr/3];return function(Hn){return Ht(en*Hn)+An}}return{format:xe,formatPrefix:Be}}var u,_,b;q({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function q(f){return u=m(f),_=u.format,b=u.formatPrefix,u}function de(f,F){return f=Math.abs(f),F=Math.abs(F)-f,Math.max(0,ee(F)-ee(f))+1}function ct(f){return Math.max(0,-ee(Math.abs(f)))}function st(f,F,x,p){var h=vc(f,F,x),S;switch(p=Ic(p==null?",f":p),p.type){case"s":{var k=Math.max(Math.abs(f),Math.abs(F));return p.precision==null&&!isNaN(S=Ee(h,k))&&(p.precision=S),b(p,k)}case"":case"e":case"g":case"p":case"r":{p.precision==null&&!isNaN(S=de(h,Math.max(Math.abs(f),Math.abs(F))))&&(p.precision=S-(p.type==="e"));break}case"f":case"%":{p.precision==null&&!isNaN(S=ct(h))&&(p.precision=S-(p.type==="%")*2);break}}return _(p)}function Mt(f){var F=f.domain;return f.ticks=function(x){var p=F();return rl(p[0],p[p.length-1],x==null?10:x)},f.tickFormat=function(x,p){var h=F();return st(h[0],h[h.length-1],x==null?10:x,p)},f.nice=function(x){x==null&&(x=10);var p=F(),h=0,S=p.length-1,k=p[h],Q=p[S],oe;return Q<k&&(oe=k,k=Q,Q=oe,oe=h,h=S,S=oe),oe=uu(k,Q,x),oe>0?(k=Math.floor(k/oe)*oe,Q=Math.ceil(Q/oe)*oe,oe=uu(k,Q,x)):oe<0&&(k=Math.ceil(k*oe)/oe,Q=Math.floor(Q*oe)/oe,oe=uu(k,Q,x)),oe>0?(p[h]=Math.floor(k/oe)*oe,p[S]=Math.ceil(Q/oe)*oe,F(p)):oe<0&&(p[h]=Math.ceil(k*oe)/oe,p[S]=Math.floor(Q*oe)/oe,F(p)),f},f}function Ir(){var f=qc(ns,ns);return f.copy=function(){return Kc(f,Ir())},dl.apply(f,arguments),Mt(f)}function Gr(f){var F;function x(p){return isNaN(p=+p)?F:p}return x.invert=x,x.domain=x.range=function(p){return arguments.length?(f=If.call(p,Fu),x):f.slice()},x.unknown=function(p){return arguments.length?(F=p,x):F},x.copy=function(){return Gr(f).unknown(F)},f=arguments.length?If.call(f,Fu):[0,1],Mt(x)}function xn(f,F){f=f.slice();var x=0,p=f.length-1,h=f[x],S=f[p],k;return S<h&&(k=x,x=p,p=k,k=h,h=S,S=k),f[x]=F.floor(h),f[p]=F.ceil(S),f}function gn(f){return Math.log(f)}function Sn(f){return Math.exp(f)}function Wn(f){return-Math.log(-f)}function bi(f){return-Math.exp(-f)}function pa(f){return isFinite(f)?+("1e"+f):f<0?0:f}function Wa(f){return f===10?pa:f===Math.E?Math.exp:function(F){return Math.pow(f,F)}}function Qa(f){return f===Math.E?Math.log:f===10&&Math.log10||f===2&&Math.log2||(f=Math.log(f),function(F){return Math.log(F)/f})}function ro(f){return function(F){return-f(-F)}}function Ko(f){var F=f(gn,Sn),x=F.domain,p=10,h,S;function k(){return h=Qa(p),S=Wa(p),x()[0]<0?(h=ro(h),S=ro(S),f(Wn,bi)):f(gn,Sn),F}return F.base=function(Q){return arguments.length?(p=+Q,k()):p},F.domain=function(Q){return arguments.length?(x(Q),k()):x()},F.ticks=function(Q){var oe=x(),xe=oe[0],Be=oe[oe.length-1],qe;(qe=Be<xe)&&(zt=xe,xe=Be,Be=zt);var zt=h(xe),Ht=h(Be),Tr,en,An,Hn=Q==null?10:+Q,si=[];if(!(p%1)&&Ht-zt<Hn){if(zt=Math.round(zt)-1,Ht=Math.round(Ht)+1,xe>0){for(;zt<Ht;++zt)for(en=1,Tr=S(zt);en<p;++en)if(An=Tr*en,!(An<xe)){if(An>Be)break;si.push(An)}}else for(;zt<Ht;++zt)for(en=p-1,Tr=S(zt);en>=1;--en)if(An=Tr*en,!(An<xe)){if(An>Be)break;si.push(An)}}else si=rl(zt,Ht,Math.min(Ht-zt,Hn)).map(S);return qe?si.reverse():si},F.tickFormat=function(Q,oe){if(oe==null&&(oe=p===10?".0e":","),typeof oe!="function"&&(oe=_(oe)),Q===Infinity)return oe;Q==null&&(Q=10);var xe=Math.max(1,p*Q/F.ticks().length);return function(Be){var qe=Be/S(Math.round(h(Be)));return qe*p<p-.5&&(qe*=p),qe<=xe?oe(Be):""}},F.nice=function(){return x(xn(x(),{floor:function(Q){return S(Math.floor(h(Q)))},ceil:function(Q){return S(Math.ceil(h(Q)))}}))},F}function sa(){var f=Ko(kf()).domain([1,10]);return f.copy=function(){return Kc(f,sa()).base(f.base())},dl.apply(f,arguments),f}function _o(f){return function(F){return Math.sign(F)*Math.log1p(Math.abs(F/f))}}function xa(f){return function(F){return Math.sign(F)*Math.expm1(Math.abs(F))*f}}function xo(f){var F=1,x=f(_o(F),xa(F));return x.constant=function(p){return arguments.length?f(_o(F=+p),xa(F)):F},linearish(x)}function ds(){var f=xo(transformer());return f.copy=function(){return copy(f,ds()).constant(f.constant())},initRange.apply(f,arguments)}function ru(f){return function(F){return F<0?-Math.pow(-F,f):Math.pow(F,f)}}function Rc(f){return f<0?-Math.sqrt(-f):Math.sqrt(f)}function mc(f){return f<0?-f*f:f*f}function vl(f){var F=f(ns,ns),x=1;function p(){return x===1?f(ns,ns):x===.5?f(Rc,mc):f(ru(x),ru(1/x))}return F.exponent=function(h){return arguments.length?(x=+h,p()):x},Mt(F)}function Jf(){var f=vl(kf());return f.copy=function(){return Kc(f,Jf()).exponent(f.exponent())},dl.apply(f,arguments),f}function Vh(){return Jf.apply(null,arguments).exponent(.5)}function Lh(){var f=[],F=[],x=[],p;function h(){var k=0,Q=Math.max(1,F.length);for(x=new Array(Q-1);++k<Q;)x[k-1]=Rl(f,k/Q);return S}function S(k){return isNaN(k=+k)?p:F[Us(x,k)]}return S.invertExtent=function(k){var Q=F.indexOf(k);return Q<0?[NaN,NaN]:[Q>0?x[Q-1]:f[0],Q<x.length?x[Q]:f[f.length-1]]},S.domain=function(k){if(!arguments.length)return f.slice();f=[];for(var Q=0,oe=k.length,xe;Q<oe;++Q)xe=k[Q],xe!=null&&!isNaN(xe=+xe)&&f.push(xe);return f.sort(Fs),h()},S.range=function(k){return arguments.length?(F=Rf.call(k),h()):F.slice()},S.unknown=function(k){return arguments.length?(p=k,S):p},S.quantiles=function(){return x.slice()},S.copy=function(){return Lh().domain(f).range(F).unknown(p)},dl.apply(S,arguments)}function fh(){var f=0,F=1,x=1,p=[.5],h=[0,1],S;function k(oe){return oe<=oe?h[Us(p,oe,0,x)]:S}function Q(){var oe=-1;for(p=new Array(x);++oe<x;)p[oe]=((oe+1)*F-(oe-x)*f)/(x+1);return k}return k.domain=function(oe){return arguments.length?(f=+oe[0],F=+oe[1],Q()):[f,F]},k.range=function(oe){return arguments.length?(x=(h=Rf.call(oe)).length-1,Q()):h.slice()},k.invertExtent=function(oe){var xe=h.indexOf(oe);return xe<0?[NaN,NaN]:xe<1?[f,p[0]]:xe>=x?[p[x-1],F]:[p[xe-1],p[xe]]},k.unknown=function(oe){return arguments.length&&(S=oe),k},k.thresholds=function(){return p.slice()},k.copy=function(){return fh().domain([f,F]).range(h).unknown(S)},dl.apply(Mt(k),arguments)}function eh(){var f=[.5],F=[0,1],x,p=1;function h(S){return S<=S?F[Us(f,S,0,p)]:x}return h.domain=function(S){return arguments.length?(f=Rf.call(S),p=Math.min(f.length,F.length-1),h):f.slice()},h.range=function(S){return arguments.length?(F=Rf.call(S),p=Math.min(f.length,F.length-1),h):F.slice()},h.invertExtent=function(S){var k=F.indexOf(S);return[f[k-1],f[k]]},h.unknown=function(S){return arguments.length?(x=S,h):x},h.copy=function(){return eh().domain(f).range(F).unknown(x)},dl.apply(h,arguments)}var Eh=new Date,Ns=new Date;function ki(f,F,x,p){function h(S){return f(S=arguments.length===0?new Date:new Date(+S)),S}return h.floor=function(S){return f(S=new Date(+S)),S},h.ceil=function(S){return f(S=new Date(S-1)),F(S,1),f(S),S},h.round=function(S){var k=h(S),Q=h.ceil(S);return S-k<Q-S?k:Q},h.offset=function(S,k){return F(S=new Date(+S),k==null?1:Math.floor(k)),S},h.range=function(S,k,Q){var oe=[],xe;if(S=h.ceil(S),Q=Q==null?1:Math.floor(Q),!(S<k)||!(Q>0))return oe;do oe.push(xe=new Date(+S)),F(S,Q),f(S);while(xe<S&&S<k);return oe},h.filter=function(S){return ki(function(k){if(k>=k)for(;f(k),!S(k);)k.setTime(k-1)},function(k,Q){if(k>=k)if(Q<0)for(;++Q<=0;)for(;F(k,-1),!S(k););else for(;--Q>=0;)for(;F(k,1),!S(k););})},x&&(h.count=function(S,k){return Eh.setTime(+S),Ns.setTime(+k),f(Eh),f(Ns),Math.floor(x(Eh,Ns))},h.every=function(S){return S=Math.floor(S),!isFinite(S)||!(S>0)?null:S>1?h.filter(p?function(k){return p(k)%S==0}:function(k){return h.count(0,k)%S==0}):h}),h}var Oh=ki(function(f){f.setMonth(0,1),f.setHours(0,0,0,0)},function(f,F){f.setFullYear(f.getFullYear()+F)},function(f,F){return F.getFullYear()-f.getFullYear()},function(f){return f.getFullYear()});Oh.every=function(f){return!isFinite(f=Math.floor(f))||!(f>0)?null:ki(function(F){F.setFullYear(Math.floor(F.getFullYear()/f)*f),F.setMonth(0,1),F.setHours(0,0,0,0)},function(F,x){F.setFullYear(F.getFullYear()+x*f)})};var Dc=Oh,Ys=Oh.range,gc=ki(function(f){f.setDate(1),f.setHours(0,0,0,0)},function(f,F){f.setMonth(f.getMonth()+F)},function(f,F){return F.getMonth()-f.getMonth()+(F.getFullYear()-f.getFullYear())*12},function(f){return f.getMonth()}),Hh=gc,ge=gc.range,Lt=1e3,sr=6e4,an=36e5,Pn=864e5,rn=6048e5;function yn(f){return ki(function(F){F.setDate(F.getDate()-(F.getDay()+7-f)%7),F.setHours(0,0,0,0)},function(F,x){F.setDate(F.getDate()+x*7)},function(F,x){return(x-F-(x.getTimezoneOffset()-F.getTimezoneOffset())*sr)/rn})}var In=yn(0),jn=yn(1),Kn=yn(2),ti=yn(3),ii=yn(4),Ei=yn(5),Xn=yn(6),ai=In.range,Vr=jn.range,dn=Kn.range,ri=ti.range,xi=ii.range,Nn=Ei.range,fi=Xn.range,Li=ki(function(f){f.setHours(0,0,0,0)},function(f,F){f.setDate(f.getDate()+F)},function(f,F){return(F-f-(F.getTimezoneOffset()-f.getTimezoneOffset())*sr)/Pn},function(f){return f.getDate()-1}),ga=Li,Cn=Li.range,Mn=ki(function(f){f.setTime(f-f.getMilliseconds()-f.getSeconds()*Lt-f.getMinutes()*sr)},function(f,F){f.setTime(+f+F*an)},function(f,F){return(F-f)/an},function(f){return f.getHours()}),Ki=Mn,Ti=Mn.range,qn=ki(function(f){f.setTime(f-f.getMilliseconds()-f.getSeconds()*Lt)},function(f,F){f.setTime(+f+F*sr)},function(f,F){return(F-f)/sr},function(f){return f.getMinutes()}),Oi=qn,Ri=qn.range,no=ki(function(f){f.setTime(f-f.getMilliseconds())},function(f,F){f.setTime(+f+F*Lt)},function(f,F){return(F-f)/Lt},function(f){return f.getUTCSeconds()}),io=no,Ii=no.range,Di=ki(function(){},function(f,F){f.setTime(+f+F)},function(f,F){return F-f});Di.every=function(f){return f=Math.floor(f),!isFinite(f)||!(f>0)?null:f>1?ki(function(F){F.setTime(Math.floor(F/f)*f)},function(F,x){F.setTime(+F+x*f)},function(F,x){return(x-F)/f}):Di};var Xa=Di,lo=Di.range;function bo(f){return ki(function(F){F.setUTCDate(F.getUTCDate()-(F.getUTCDay()+7-f)%7),F.setUTCHours(0,0,0,0)},function(F,x){F.setUTCDate(F.getUTCDate()+x*7)},function(F,x){return(x-F)/rn})}var nu=bo(0),$s=bo(1),Lo=bo(2),ml=bo(3),bs=bo(4),nl=bo(5),Mu=bo(6),il=nu.range,al=$s.range,kl=Lo.range,_u=ml.range,ho=bs.range,Bu=nl.range,is=Mu.range,Nu=ki(function(f){f.setUTCHours(0,0,0,0)},function(f,F){f.setUTCDate(f.getUTCDate()+F)},function(f,F){return(F-f)/Pn},function(f){return f.getUTCDate()-1}),Za=Nu,Zo=Nu.range,as=ki(function(f){f.setUTCMonth(0,1),f.setUTCHours(0,0,0,0)},function(f,F){f.setUTCFullYear(f.getUTCFullYear()+F)},function(f,F){return F.getUTCFullYear()-f.getUTCFullYear()},function(f){return f.getUTCFullYear()});as.every=function(f){return!isFinite(f=Math.floor(f))||!(f>0)?null:ki(function(F){F.setUTCFullYear(Math.floor(F.getUTCFullYear()/f)*f),F.setUTCMonth(0,1),F.setUTCHours(0,0,0,0)},function(F,x){F.setUTCFullYear(F.getUTCFullYear()+x*f)})};var Os=as,Ks=as.range;function $t(f){if(0<=f.y&&f.y<100){var F=new Date(-1,f.m,f.d,f.H,f.M,f.S,f.L);return F.setFullYear(f.y),F}return new Date(f.y,f.m,f.d,f.H,f.M,f.S,f.L)}function sn(f){if(0<=f.y&&f.y<100){var F=new Date(Date.UTC(-1,f.m,f.d,f.H,f.M,f.S,f.L));return F.setUTCFullYear(f.y),F}return new Date(Date.UTC(f.y,f.m,f.d,f.H,f.M,f.S,f.L))}function Kr(f,F,x){return{y:f,m:F,d:x,H:0,M:0,S:0,L:0}}function Ci(f){var F=f.dateTime,x=f.date,p=f.time,h=f.periods,S=f.days,k=f.shortDays,Q=f.months,oe=f.shortMonths,xe=Er(h),Be=ar(h),qe=Er(S),zt=ar(S),Ht=Er(k),Tr=ar(k),en=Er(Q),An=ar(Q),Hn=Er(oe),si=ar(oe),ni={a:Fc,A:Yf,b:zl,B:zh,c:null,d:us,e:us,f:yp,g:Ih,G:Kp,H:Sf,I:yc,j:Ff,L:cf,m:ff,M:Ch,p:Bp,q:rd,Q:cr,s:Zr,S:Wh,u:$p,U:sl,V:Sh,w:Op,W:Xh,x:null,X:null,y:jp,Y:Rh,Z:qp,"%":br},di={a:od,A:Lp,b:sd,B:dh,c:null,d:Gp,e:Gp,f:t,g:ot,G:Qt,H:Fl,I:Uh,j:Ip,L:e,m:r,M:s,p:Np,q:Xp,Q:cr,s:Zr,S:d,u:E,U:I,V:se,w:be,W:we,x:null,X:null,y:Ze,Y:bt,Z:tr,"%":br},qi={a:zo,A:Ta,b:Io,B:co,c:qs,d:pi,e:pi,f:Ya,g:zn,G:qr,H:Ui,I:Ui,j:aa,L:ji,m:Bi,M:Ji,p:po,q:gi,Q:ol,s:os,S:ea,u:Rt,U:pr,V:jt,w:Rr,W:Wr,x:yl,X:bc,y:zn,Y:qr,Z:yi,"%":Es};ni.x=ta(x,ni),ni.X=ta(p,ni),ni.c=ta(F,ni),di.x=ta(x,di),di.X=ta(p,di),di.c=ta(F,di);function ta(ja,Cs){return function(iu){var Yi=[],nh=-1,Uu=0,vh=ja.length,mh,vp,ld;for(iu instanceof Date||(iu=new Date(+iu));++nh<vh;)ja.charCodeAt(nh)===37&&(Yi.push(ja.slice(Uu,nh)),(vp=No[mh=ja.charAt(++nh)])!=null?mh=ja.charAt(++nh):vp=mh==="e"?" ":"0",(ld=Cs[mh])&&(mh=ld(iu,vp)),Yi.push(mh),Uu=nh+1);return Yi.push(ja.slice(Uu,nh)),Yi.join("")}}function Xi(ja,Cs){return function(iu){var Yi=Kr(1900,void 0,1),nh=Ja(Yi,ja,iu+="",0),Uu,vh;if(nh!=iu.length)return null;if("Q"in Yi)return new Date(Yi.Q);if("s"in Yi)return new Date(Yi.s*1e3+("L"in Yi?Yi.L:0));if(Cs&&!("Z"in Yi)&&(Yi.Z=0),"p"in Yi&&(Yi.H=Yi.H%12+Yi.p*12),Yi.m===void 0&&(Yi.m="q"in Yi?Yi.q:0),"V"in Yi){if(Yi.V<1||Yi.V>53)return null;"w"in Yi||(Yi.w=1),"Z"in Yi?(Uu=sn(Kr(Yi.y,0,1)),vh=Uu.getUTCDay(),Uu=vh>4||vh===0?$s.ceil(Uu):$s(Uu),Uu=Za.offset(Uu,(Yi.V-1)*7),Yi.y=Uu.getUTCFullYear(),Yi.m=Uu.getUTCMonth(),Yi.d=Uu.getUTCDate()+(Yi.w+6)%7):(Uu=$t(Kr(Yi.y,0,1)),vh=Uu.getDay(),Uu=vh>4||vh===0?jn.ceil(Uu):jn(Uu),Uu=ga.offset(Uu,(Yi.V-1)*7),Yi.y=Uu.getFullYear(),Yi.m=Uu.getMonth(),Yi.d=Uu.getDate()+(Yi.w+6)%7)}else("W"in Yi||"U"in Yi)&&("w"in Yi||(Yi.w="u"in Yi?Yi.u%7:"W"in Yi?1:0),vh="Z"in Yi?sn(Kr(Yi.y,0,1)).getUTCDay():$t(Kr(Yi.y,0,1)).getDay(),Yi.m=0,Yi.d="W"in Yi?(Yi.w+6)%7+Yi.W*7-(vh+5)%7:Yi.w+Yi.U*7-(vh+6)%7);return"Z"in Yi?(Yi.H+=Yi.Z/100|0,Yi.M+=Yi.Z%100,sn(Yi)):$t(Yi)}}function Ja(ja,Cs,iu,Yi){for(var nh=0,Uu=Cs.length,vh=iu.length,mh,vp;nh<Uu;){if(Yi>=vh)return-1;if(mh=Cs.charCodeAt(nh++),mh===37){if(mh=Cs.charAt(nh++),vp=qi[mh in No?Cs.charAt(nh++):mh],!vp||(Yi=vp(ja,iu,Yi))<0)return-1}else if(mh!=iu.charCodeAt(Yi++))return-1}return Yi}function po(ja,Cs,iu){var Yi=xe.exec(Cs.slice(iu));return Yi?(ja.p=Be[Yi[0].toLowerCase()],iu+Yi[0].length):-1}function zo(ja,Cs,iu){var Yi=Ht.exec(Cs.slice(iu));return Yi?(ja.w=Tr[Yi[0].toLowerCase()],iu+Yi[0].length):-1}function Ta(ja,Cs,iu){var Yi=qe.exec(Cs.slice(iu));return Yi?(ja.w=zt[Yi[0].toLowerCase()],iu+Yi[0].length):-1}function Io(ja,Cs,iu){var Yi=Hn.exec(Cs.slice(iu));return Yi?(ja.m=si[Yi[0].toLowerCase()],iu+Yi[0].length):-1}function co(ja,Cs,iu){var Yi=en.exec(Cs.slice(iu));return Yi?(ja.m=An[Yi[0].toLowerCase()],iu+Yi[0].length):-1}function qs(ja,Cs,iu){return Ja(ja,F,Cs,iu)}function yl(ja,Cs,iu){return Ja(ja,x,Cs,iu)}function bc(ja,Cs,iu){return Ja(ja,p,Cs,iu)}function Fc(ja){return k[ja.getDay()]}function Yf(ja){return S[ja.getDay()]}function zl(ja){return oe[ja.getMonth()]}function zh(ja){return Q[ja.getMonth()]}function Bp(ja){return h[+(ja.getHours()>=12)]}function rd(ja){return 1+~~(ja.getMonth()/3)}function od(ja){return k[ja.getUTCDay()]}function Lp(ja){return S[ja.getUTCDay()]}function sd(ja){return oe[ja.getUTCMonth()]}function dh(ja){return Q[ja.getUTCMonth()]}function Np(ja){return h[+(ja.getUTCHours()>=12)]}function Xp(ja){return 1+~~(ja.getUTCMonth()/3)}return{format:function(ja){var Cs=ta(ja+="",ni);return Cs.toString=function(){return ja},Cs},parse:function(ja){var Cs=Xi(ja+="",!1);return Cs.toString=function(){return ja},Cs},utcFormat:function(ja){var Cs=ta(ja+="",di);return Cs.toString=function(){return ja},Cs},utcParse:function(ja){var Cs=Xi(ja+="",!0);return Cs.toString=function(){return ja},Cs}}}var No={"-":"",_:" ","0":"0"},Dt=/^\s*\d+/,Ct=/^%/,yr=/[\\^$*+?|[\]().{}]/g;function wr(f,F,x){var p=f<0?"-":"",h=(p?-f:f)+"",S=h.length;return p+(S<x?new Array(x-S+1).join(F)+h:h)}function tn(f){return f.replace(yr,"\\$&")}function Er(f){return new RegExp("^(?:"+f.map(tn).join("|")+")","i")}function ar(f){for(var F={},x=-1,p=f.length;++x<p;)F[f[x].toLowerCase()]=x;return F}function Rr(f,F,x){var p=Dt.exec(F.slice(x,x+1));return p?(f.w=+p[0],x+p[0].length):-1}function Rt(f,F,x){var p=Dt.exec(F.slice(x,x+1));return p?(f.u=+p[0],x+p[0].length):-1}function pr(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.U=+p[0],x+p[0].length):-1}function jt(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.V=+p[0],x+p[0].length):-1}function Wr(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.W=+p[0],x+p[0].length):-1}function qr(f,F,x){var p=Dt.exec(F.slice(x,x+4));return p?(f.y=+p[0],x+p[0].length):-1}function zn(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.y=+p[0]+(+p[0]>68?1900:2e3),x+p[0].length):-1}function yi(f,F,x){var p=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(F.slice(x,x+6));return p?(f.Z=p[1]?0:-(p[2]+(p[3]||"00")),x+p[0].length):-1}function gi(f,F,x){var p=Dt.exec(F.slice(x,x+1));return p?(f.q=p[0]*3-3,x+p[0].length):-1}function Bi(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.m=p[0]-1,x+p[0].length):-1}function pi(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.d=+p[0],x+p[0].length):-1}function aa(f,F,x){var p=Dt.exec(F.slice(x,x+3));return p?(f.m=0,f.d=+p[0],x+p[0].length):-1}function Ui(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.H=+p[0],x+p[0].length):-1}function Ji(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.M=+p[0],x+p[0].length):-1}function ea(f,F,x){var p=Dt.exec(F.slice(x,x+2));return p?(f.S=+p[0],x+p[0].length):-1}function ji(f,F,x){var p=Dt.exec(F.slice(x,x+3));return p?(f.L=+p[0],x+p[0].length):-1}function Ya(f,F,x){var p=Dt.exec(F.slice(x,x+6));return p?(f.L=Math.floor(p[0]/1e3),x+p[0].length):-1}function Es(f,F,x){var p=Ct.exec(F.slice(x,x+1));return p?x+p[0].length:-1}function ol(f,F,x){var p=Dt.exec(F.slice(x));return p?(f.Q=+p[0],x+p[0].length):-1}function os(f,F,x){var p=Dt.exec(F.slice(x));return p?(f.s=+p[0],x+p[0].length):-1}function us(f,F){return wr(f.getDate(),F,2)}function Sf(f,F){return wr(f.getHours(),F,2)}function yc(f,F){return wr(f.getHours()%12||12,F,2)}function Ff(f,F){return wr(1+ga.count(Dc(f),f),F,3)}function cf(f,F){return wr(f.getMilliseconds(),F,3)}function yp(f,F){return cf(f,F)+"000"}function ff(f,F){return wr(f.getMonth()+1,F,2)}function Ch(f,F){return wr(f.getMinutes(),F,2)}function Wh(f,F){return wr(f.getSeconds(),F,2)}function $p(f){var F=f.getDay();return F===0?7:F}function sl(f,F){return wr(In.count(Dc(f)-1,f),F,2)}function rp(f){var F=f.getDay();return F>=4||F===0?ii(f):ii.ceil(f)}function Sh(f,F){return f=rp(f),wr(ii.count(Dc(f),f)+(Dc(f).getDay()===4),F,2)}function Op(f){return f.getDay()}function Xh(f,F){return wr(jn.count(Dc(f)-1,f),F,2)}function jp(f,F){return wr(f.getFullYear()%100,F,2)}function Ih(f,F){return f=rp(f),wr(f.getFullYear()%100,F,2)}function Rh(f,F){return wr(f.getFullYear()%1e4,F,4)}function Kp(f,F){var x=f.getDay();return f=x>=4||x===0?ii(f):ii.ceil(f),wr(f.getFullYear()%1e4,F,4)}function qp(f){var F=f.getTimezoneOffset();return(F>0?"-":(F*=-1,"+"))+wr(F/60|0,"0",2)+wr(F%60,"0",2)}function Gp(f,F){return wr(f.getUTCDate(),F,2)}function Fl(f,F){return wr(f.getUTCHours(),F,2)}function Uh(f,F){return wr(f.getUTCHours()%12||12,F,2)}function Ip(f,F){return wr(1+Za.count(Os(f),f),F,3)}function e(f,F){return wr(f.getUTCMilliseconds(),F,3)}function t(f,F){return e(f,F)+"000"}function r(f,F){return wr(f.getUTCMonth()+1,F,2)}function s(f,F){return wr(f.getUTCMinutes(),F,2)}function d(f,F){return wr(f.getUTCSeconds(),F,2)}function E(f){var F=f.getUTCDay();return F===0?7:F}function I(f,F){return wr(nu.count(Os(f)-1,f),F,2)}function G(f){var F=f.getUTCDay();return F>=4||F===0?bs(f):bs.ceil(f)}function se(f,F){return f=G(f),wr(bs.count(Os(f),f)+(Os(f).getUTCDay()===4),F,2)}function be(f){return f.getUTCDay()}function we(f,F){return wr($s.count(Os(f)-1,f),F,2)}function Ze(f,F){return wr(f.getUTCFullYear()%100,F,2)}function ot(f,F){return f=G(f),wr(f.getUTCFullYear()%100,F,2)}function bt(f,F){return wr(f.getUTCFullYear()%1e4,F,4)}function Qt(f,F){var x=f.getUTCDay();return f=x>=4||x===0?bs(f):bs.ceil(f),wr(f.getUTCFullYear()%1e4,F,4)}function tr(){return"+0000"}function br(){return"%"}function cr(f){return+f}function Zr(f){return Math.floor(+f/1e3)}var Yr,ln,vn,Ln,oi;wi({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function wi(f){return Yr=Ci(f),ln=Yr.format,vn=Yr.parse,Ln=Yr.utcFormat,oi=Yr.utcParse,Yr}var va=1e3,Fi=va*60,Ca=Fi*60,Ni=Ca*24,Oo=Ni*7,$a=Ni*30,Wi=Ni*365;function jo(f){return new Date(f)}function Eo(f){return f instanceof Date?+f:+new Date(+f)}function Qo(f,F,x,p,h,S,k,Q,oe){var xe=qc(ns,ns),Be=xe.invert,qe=xe.domain,zt=oe(".%L"),Ht=oe(":%S"),Tr=oe("%I:%M"),en=oe("%I %p"),An=oe("%a %d"),Hn=oe("%b %d"),si=oe("%B"),ni=oe("%Y"),di=[[k,1,va],[k,5,5*va],[k,15,15*va],[k,30,30*va],[S,1,Fi],[S,5,5*Fi],[S,15,15*Fi],[S,30,30*Fi],[h,1,Ca],[h,3,3*Ca],[h,6,6*Ca],[h,12,12*Ca],[p,1,Ni],[p,2,2*Ni],[x,1,Oo],[F,1,$a],[F,3,3*$a],[f,1,Wi]];function qi(Xi){return(k(Xi)<Xi?zt:S(Xi)<Xi?Ht:h(Xi)<Xi?Tr:p(Xi)<Xi?en:F(Xi)<Xi?x(Xi)<Xi?An:Hn:f(Xi)<Xi?si:ni)(Xi)}function ta(Xi,Ja,po,zo){if(Xi==null&&(Xi=10),typeof Xi=="number"){var Ta=Math.abs(po-Ja)/Xi,Io=uf(function(co){return co[2]}).right(di,Ta);Io===di.length?(zo=vc(Ja/Wi,po/Wi,Xi),Xi=f):Io?(Io=di[Ta/di[Io-1][2]<di[Io][2]/Ta?Io-1:Io],zo=Io[1],Xi=Io[0]):(zo=Math.max(vc(Ja,po,Xi),1),Xi=Q)}return zo==null?Xi:Xi.every(zo)}return xe.invert=function(Xi){return new Date(Be(Xi))},xe.domain=function(Xi){return arguments.length?qe(If.call(Xi,Eo)):qe().map(jo)},xe.ticks=function(Xi,Ja){var po=qe(),zo=po[0],Ta=po[po.length-1],Io=Ta<zo,co;return Io&&(co=zo,zo=Ta,Ta=co),co=ta(Xi,zo,Ta,Ja),co=co?co.range(zo,Ta+1):[],Io?co.reverse():co},xe.tickFormat=function(Xi,Ja){return Ja==null?qi:oe(Ja)},xe.nice=function(Xi,Ja){var po=qe();return(Xi=ta(Xi,po[0],po[po.length-1],Ja))?qe(xn(po,Xi)):xe},xe.copy=function(){return Kc(xe,Qo(f,F,x,p,h,S,k,Q,oe))},xe}function Ra(){return dl.apply(Qo(Dc,Hh,In,ga,Ki,Oi,io,Xa,ln).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function vs(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Is(){var f=0,F=1,x,p,h,S,k=identity,Q=!1,oe;function xe(Be){return isNaN(Be=+Be)?oe:k(h===0?.5:(Be=(S(Be)-x)*h,Q?Math.max(0,Math.min(1,Be)):Be))}return xe.domain=function(Be){return arguments.length?(x=S(f=+Be[0]),p=S(F=+Be[1]),h=x===p?0:1/(p-x),xe):[f,F]},xe.clamp=function(Be){return arguments.length?(Q=!!Be,xe):Q},xe.interpolator=function(Be){return arguments.length?(k=Be,xe):k},xe.unknown=function(Be){return arguments.length?(oe=Be,xe):oe},function(Be){return S=Be,x=Be(f),p=Be(F),h=x===p?0:1/(p-x),xe}}function lu(f,F){return F.domain(f.domain()).interpolator(f.interpolator()).clamp(f.clamp()).unknown(f.unknown())}function pu(){var f=linearish(Is()(identity));return f.copy=function(){return lu(f,pu())},initInterpolator.apply(f,arguments)}function cu(){var f=loggish(Is()).domain([1,10]);return f.copy=function(){return lu(f,cu()).base(f.base())},initInterpolator.apply(f,arguments)}function xu(){var f=symlogish(Is());return f.copy=function(){return lu(f,xu()).constant(f.constant())},initInterpolator.apply(f,arguments)}function ul(){var f=powish(Is());return f.copy=function(){return lu(f,ul()).exponent(f.exponent())},initInterpolator.apply(f,arguments)}function Wu(){return ul.apply(null,arguments).exponent(.5)}function gl(){var f=[],F=identity;function x(p){if(!isNaN(p=+p))return F((bisect(f,p)-1)/(f.length-1))}return x.domain=function(p){if(!arguments.length)return f.slice();f=[];for(var h=0,S=p.length,k;h<S;++h)k=p[h],k!=null&&!isNaN(k=+k)&&f.push(k);return f.sort(ascending),x},x.interpolator=function(p){return arguments.length?(F=p,x):F},x.copy=function(){return gl(F).domain(f)},initInterpolator.apply(x,arguments)}function Xu(){var f=0,F=.5,x=1,p,h,S,k,Q,oe=identity,xe,Be=!1,qe;function zt(Ht){return isNaN(Ht=+Ht)?qe:(Ht=.5+((Ht=+xe(Ht))-h)*(Ht<h?k:Q),oe(Be?Math.max(0,Math.min(1,Ht)):Ht))}return zt.domain=function(Ht){return arguments.length?(p=xe(f=+Ht[0]),h=xe(F=+Ht[1]),S=xe(x=+Ht[2]),k=p===h?0:.5/(h-p),Q=h===S?0:.5/(S-h),zt):[f,F,x]},zt.clamp=function(Ht){return arguments.length?(Be=!!Ht,zt):Be},zt.interpolator=function(Ht){return arguments.length?(oe=Ht,zt):oe},zt.unknown=function(Ht){return arguments.length?(qe=Ht,zt):qe},function(Ht){return xe=Ht,p=Ht(f),h=Ht(F),S=Ht(x),k=p===h?0:.5/(h-p),Q=h===S?0:.5/(S-h),zt}}function _c(){var f=linearish(Xu()(identity));return f.copy=function(){return copy(f,_c())},initInterpolator.apply(f,arguments)}function zu(){var f=loggish(Xu()).domain([.1,1,10]);return f.copy=function(){return copy(f,zu()).base(f.base())},initInterpolator.apply(f,arguments)}function Bl(){var f=symlogish(Xu());return f.copy=function(){return copy(f,Bl()).constant(f.constant())},initInterpolator.apply(f,arguments)}function Go(){var f=powish(Xu());return f.copy=function(){return copy(f,Go()).exponent(f.exponent())},initInterpolator.apply(f,arguments)}function Zs(){return Go.apply(null,arguments).exponent(.5)}var Wo,Jo,kc,Nl,js,Pu,xc=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,hs=(Wo={},(0,B.Z)(Wo,v.ScaleTypes.LINEAR,Ir),(0,B.Z)(Wo,v.ScaleTypes.POWER,Jf),(0,B.Z)(Wo,v.ScaleTypes.LOG,sa),(0,B.Z)(Wo,v.ScaleTypes.IDENTITY,Gr),(0,B.Z)(Wo,v.ScaleTypes.TIME,Ra),(0,B.Z)(Wo,v.ScaleTypes.QUANTILE,Lh),(0,B.Z)(Wo,v.ScaleTypes.QUANTIZE,fh),(0,B.Z)(Wo,v.ScaleTypes.THRESHOLD,eh),(0,B.Z)(Wo,v.ScaleTypes.CAT,qf),Wo),hh=(Jo=(0,ze.b2)(),kc=(0,ze.f3)(v.TYPES.IGlobalConfigService),Jo(Nl=(js=function(){function f(){(0,Z.Z)(this,f),(0,Zn.Z)(this,"configService",Pu,this),(0,B.Z)(this,"scaleCache",{}),(0,B.Z)(this,"scaleOptions",{})}return(0,a.Z)(f,[{key:"apply",value:function(x,p){var h=this,S=p.styleAttributeService;x.hooks.init.tap("FeatureScalePlugin",function(){h.scaleOptions=x.getScaleOptions();var k=S.getLayerStyleAttributes(),Q=x.getSource().data.dataArray;Q.length!==0&&h.caculateScalesForAttributes(k||[],Q)}),x.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){h.scaleOptions=x.getScaleOptions();var k=S.getLayerStyleAttributes(),Q=x.getSource().data.dataArray;return h.caculateScalesForAttributes(k||[],Q),x.layerModelNeedUpdate=!0,!0}),x.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!x.layerModelNeedUpdate){h.scaleOptions=x.getScaleOptions();var k=S.getLayerStyleAttributes();if(k){var Q=x.getSource().data.dataArray;if(Q.length===0)return;var oe=k.filter(function(xe){return xe.needRescale});oe.length&&h.caculateScalesForAttributes(oe,Q)}}})}},{key:"isNumber",value:function(x){return!isNaN(parseFloat(x))&&isFinite(x)}},{key:"caculateScalesForAttributes",value:function(x,p){var h=this;this.scaleCache={},x.forEach(function(S){if(S.scale){var k=S.scale,Q=S.name;k.names=h.parseFields(S.scale.field||[]);var oe=[];k.names.forEach(function(xe){oe.push(h.getOrCreateScale(xe,S,p))}),oe.some(function(xe){return xe.type===v.StyleScaleType.VARIABLE})?(k.type=v.StyleScaleType.VARIABLE,oe.forEach(function(xe){if(!k.callback){var Be;if(k.values&&k.values!=="text"){var qe;if(((qe=xe.option)===null||qe===void 0?void 0:qe.type)==="linear"&&k.values.length>2){var zt=xe.scale.ticks(k.values.length);Q==="color"&&xe.scale.domain(zt)}xe.scale.range(k.values)}else((Be=xe.option)===null||Be===void 0?void 0:Be.type)==="cat"&&xe.scale.range(xe.option.domain)}})):(k.type=v.StyleScaleType.CONSTANT,k.defaultValues=oe.map(function(xe,Be){return xe.scale(k.names[Be])})),k.scalers=oe.map(function(xe){return{field:xe.field,func:xe.scale,option:xe.option}}),S.needRescale=!1}})}},{key:"getOrCreateScale",value:function(x,p,h){var S,k=[x,p.name].join("_"),Q=(S=p.scale)===null||S===void 0?void 0:S.values,oe=this.createScale(x,p.name,Q,h);return oe}},{key:"parseFields",value:function(x){return Array.isArray(x)?x:Xc()(x)?x.split("*"):[x]}},{key:"createScale",value:function(x,p,h,S){var k,Q,oe=this.scaleOptions[p]&&((k=this.scaleOptions[p])===null||k===void 0?void 0:k.field)===x?this.scaleOptions[p]:this.scaleOptions[x],xe={field:x,scale:void 0,type:v.StyleScaleType.VARIABLE,option:oe};if(!S||!S.length)return oe&&oe.type?xe.scale=this.createDefaultScale(oe):(xe.scale=qf([x]),xe.type=v.StyleScaleType.CONSTANT),xe;var Be=(Q=S.find(function(Ht){return!su()(Ht[x])}))===null||Q===void 0?void 0:Q[x];if(this.isNumber(x)||su()(Be)&&!oe)xe.scale=qf([x]),xe.type=v.StyleScaleType.CONSTANT;else{var qe=oe&&oe.type||this.getDefaultType(Be);h==="text"&&(qe=v.ScaleTypes.CAT);var zt=this.createDefaultScaleConfig(qe,x,S);Object.assign(zt,oe),xe.scale=this.createDefaultScale(zt),xe.option=zt}return xe}},{key:"getDefaultType",value:function(x){var p=v.ScaleTypes.LINEAR;return typeof x=="string"&&(p=xc.test(x)?v.ScaleTypes.TIME:v.ScaleTypes.CAT),p}},{key:"createDefaultScaleConfig",value:function(x,p,h){var S={type:x},k=(h==null?void 0:h.map(function(Q){return Q[p]}))||[];return x!==v.ScaleTypes.CAT&&x!==v.ScaleTypes.QUANTILE?S.domain=Yc(k):x===v.ScaleTypes.CAT?S.domain=zs()(k):x===v.ScaleTypes.QUANTILE&&(S.domain=k),S}},{key:"createDefaultScale",value:function(x){var p=x.type,h=x.domain,S=hs[p]();return h&&S.domain(h),S}}]),f}(),Pu=(0,Vn.Z)(js.prototype,"configService",[kc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),js))||Nl),Af,th,Lu,ph,Tf,Yh,Zh;function $h(f,F){var x=Object.keys(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(f);F&&(p=p.filter(function(h){return Object.getOwnPropertyDescriptor(f,h).enumerable})),x.push.apply(x,p)}return x}function Ah(f){for(var F=1;F<arguments.length;F++){var x=arguments[F]!=null?arguments[F]:{};F%2?$h(Object(x),!0).forEach(function(p){(0,B.Z)(f,p,x[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(x)):$h(Object(x)).forEach(function(p){Object.defineProperty(f,p,Object.getOwnPropertyDescriptor(x,p))})}return f}var np=(Af=(0,ze.b2)(),th=(0,ze.f3)(v.TYPES.ICameraService),Lu=(0,ze.f3)(v.TYPES.IRendererService),Af(ph=(Tf=function(){function f(){(0,Z.Z)(this,f),(0,Zn.Z)(this,"cameraService",Yh,this),(0,Zn.Z)(this,"rendererService",Zh,this)}return(0,a.Z)(f,[{key:"apply",value:function(x){x.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){x.models.forEach(function(p){p.addUniforms(Ah({},x.layerModel.getAnimateUniforms()))})})}}]),f}(),Yh=(0,Vn.Z)(Tf.prototype,"cameraService",[th],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zh=(0,Vn.Z)(Tf.prototype,"rendererService",[Lu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tf))||ph),ip,Kh,ap=(ip=(0,ze.b2)(),ip(Kh=function(){function f(){(0,Z.Z)(this,f)}return(0,a.Z)(f,[{key:"apply",value:function(x){x.hooks.init.tap("LayerModelPlugin",function(){x.prepareBuildModel(),x.buildModels(),x.styleNeedUpdate=!1}),x.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return x.prepareBuildModel(),x.clearModels(),x.buildModels(),x.layerModelNeedUpdate=!1,!1})}}]),f}())||Kh),_p,xp,Th=(_p=(0,ze.b2)(),_p(xp=function(){function f(){(0,Z.Z)(this,f)}return(0,a.Z)(f,[{key:"apply",value:function(x){x.hooks.afterInit.tap("LayerStylePlugin",function(){x.updateLayerConfig({});var p=x.getLayerConfig(),h=p.autoFit,S=p.fitBoundsOptions;h&&setTimeout(function(){x.fitBounds(S)},100)})}}]),f}())||xp),bp=y(83221),jh,Dh,qh=["type"];function Ep(f,F){var x=Object.keys(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(f);F&&(p=p.filter(function(h){return Object.getOwnPropertyDescriptor(f,h).enumerable})),x.push.apply(x,p)}return x}function kh(f){for(var F=1;F<arguments.length;F++){var x=arguments[F]!=null?arguments[F]:{};F%2?Ep(Object(x),!0).forEach(function(p){(0,B.Z)(f,p,x[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(x)):Ep(Object(x)).forEach(function(p){Object.defineProperty(f,p,Object.getOwnPropertyDescriptor(x,p))})}return f}var op={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},sp={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},wh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Cp={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},Qh=null;function Sp(f){var F={u_DirectionalLights:new Array(3).fill(kh({},wh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(kh({},Cp)),u_NumOfSpotLights:0};return(!f||!f.length)&&(f=[sp]),f.forEach(function(x,p){var h=x.type,S=h===void 0?"directional":h,k=(0,bp.Z)(x,qh),Q=op[S].lights,oe=op[S].num,xe=F[oe];F[Q][xe]=kh(kh({},F[Q][xe]),k),F[oe]++}),F}var Ap=(jh=(0,ze.b2)(),jh(Dh=function(){function f(){(0,Z.Z)(this,f)}return(0,a.Z)(f,[{key:"apply",value:function(x){x.hooks.beforeRender.tap("LightingPlugin",function(){var p=x.getLayerConfig(),h=p.enableLighting;h&&x.models.forEach(function(S){return S.addUniforms(kh({},Sp()))})})}}]),f}())||Dh),up=y(32271),lp,Jh,cp,Fh,ep,fp=(lp=(0,ze.b2)(),Jh=(0,ze.f3)(v.TYPES.IGlobalConfigService),lp(cp=(Fh=function(){function f(){(0,Z.Z)(this,f),(0,Zn.Z)(this,"configService",ep,this),(0,B.Z)(this,"enabled",void 0)}return(0,a.Z)(f,[{key:"apply",value:function(x,p){var h=this,S=p.rendererService,k=p.postProcessingPassFactory,Q=p.normalPassFactory;x.hooks.init.tap("MultiPassRendererPlugin",function(){var oe=x.getLayerConfig(),xe=oe.enableMultiPassRenderer,Be=oe.passes,qe=Be===void 0?[]:Be;h.enabled=!!xe&&x.getLayerConfig().enableMultiPassRenderer!==!1,h.enabled&&(x.multiPassRenderer=(0,up.N)(x,qe,k,Q),x.multiPassRenderer.setRenderFlag(!0))}),x.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(h.enabled){var oe=S.getViewportSize(),xe=oe.width,Be=oe.height;x.multiPassRenderer.resize(xe,Be)}})}}]),f}(),ep=(0,Vn.Z)(Fh.prototype,"configService",[Jh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fh))||cp),hp,Vp,Bh={NONE:0,ENCODE:1,HIGHLIGHT:2},Qp=(hp=(0,ze.b2)(),hp(Vp=function(){function f(){(0,Z.Z)(this,f)}return(0,a.Z)(f,[{key:"apply",value:function(x,p){var h=p.rendererService,S=p.styleAttributeService;x.hooks.init.tap("PixelPickingPlugin",function(){var k=!0;S.registerStyleAttribute({name:"pickingColor",type:v.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:v.gl.FLOAT},size:3,update:function(oe,xe){var Be=oe.id;return k?(0,Ge.encodePickingColor)(Be):[0,0,0]}}})}),x.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var k=x.getLayerConfig(),Q=k.enablePicking;Q&&x.isVisible()&&x.models.forEach(function(oe){return oe.addUniforms({u_PickingStage:Bh.ENCODE})})}),x.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var k=x.getLayerConfig(),Q=k.enablePicking;Q&&x.isVisible()&&x.models.forEach(function(oe){return oe.addUniforms({u_PickingStage:Bh.HIGHLIGHT})})}),x.hooks.beforeHighlight.tap("PixelPickingPlugin",function(k){var Q=x.getLayerConfig(),oe=Q.highlightColor,xe=Q.activeMix,Be=xe===void 0?0:xe,qe=typeof oe=="string"?(0,Ge.rgb2arr)(oe):oe||[1,0,0,1];x.updateLayerConfig({pickedFeatureID:(0,Ge.decodePickingColor)(new Uint8Array(k))}),x.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:Bh.HIGHLIGHT,u_PickingColor:k,u_HighlightColor:qe.map(function(Ht){return Ht*255}),u_activeMix:Be})})}),x.hooks.beforeSelect.tap("PixelPickingPlugin",function(k){var Q=x.getLayerConfig(),oe=Q.selectColor,xe=Q.selectMix,Be=xe===void 0?0:xe,qe=typeof oe=="string"?(0,Ge.rgb2arr)(oe):oe||[1,0,0,1];x.updateLayerConfig({pickedFeatureID:(0,Ge.decodePickingColor)(new Uint8Array(k))}),x.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:Bh.HIGHLIGHT,u_PickingColor:k,u_HighlightColor:qe.map(function(Ht){return Ht*255}),u_activeMix:Be,u_CurrentSelectedId:k,u_SelectColor:qe.map(function(Ht){return Ht*255}),u_EnableSelect:1})})})}}]),f}())||Vp),Tp,Jp,pp=(Tp=(0,ze.b2)(),Tp(Jp=function(){function f(){(0,Z.Z)(this,f)}return(0,a.Z)(f,[{key:"apply",value:function(x,p){var h=this,S=p.styleAttributeService;x.hooks.init.tap("RegisterStyleAttributePlugin",function(){h.registerBuiltinAttributes(S)})}},{key:"registerBuiltinAttributes",value:function(x){x.registerStyleAttribute({name:"position",type:v.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:v.gl.FLOAT},size:3,update:function(h,S,k){return k.length===2?[k[0],k[1],0]:[k[0],k[1],k[2]]}}}),x.registerStyleAttribute({name:"filter",type:v.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(h,S){var k=h.filter;return k?[1]:[0]}}}),x.registerStyleAttribute({name:"color",type:v.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:4,update:function(h,S){var k=h.color;return!k||!k.length?[1,1,1,1]:k}}}),x.registerStyleAttribute({name:"vertexId",type:v.AttributeType.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:v.gl.DYNAMIC_DRAW,data:[],type:v.gl.FLOAT},size:1,update:function(h,S,k,Q){return[S]}}})}}]),f}())||Jp),Ou,rh,ed,Nh,Rp,Hp,Mh,Xf,wp,dp,Mp,Dp=(Ou=(0,ze.b2)(),rh=(0,ze.f3)(v.TYPES.ICameraService),ed=(0,ze.f3)(v.TYPES.ICoordinateSystemService),Nh=(0,ze.f3)(v.TYPES.IRendererService),Rp=(0,ze.f3)(v.TYPES.IMapService),Ou(Hp=(Mh=function(){function f(){(0,Z.Z)(this,f),(0,Zn.Z)(this,"cameraService",Xf,this),(0,Zn.Z)(this,"coordinateSystemService",wp,this),(0,Zn.Z)(this,"rendererService",dp,this),(0,Zn.Z)(this,"mapService",Mp,this)}return(0,a.Z)(f,[{key:"apply",value:function(x){var p=this,h=this.mapService.version,S=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k=[0,0];x.hooks.beforeRender.tap("ShaderUniformPlugin",function(){p.coordinateSystemService.refresh(),h==="GAODE2.x"&&(S=p.mapService.map.customCoords.getMVPMatrix(),k=p.mapService.getCustomCoordCenter());var Q=p.rendererService.getViewportSize(),oe=Q.width,xe=Q.height;x.models.forEach(function(Be){var qe;Be.addUniforms((qe={},(0,B.Z)(qe,v.CameraUniform.ProjectionMatrix,p.cameraService.getProjectionMatrix()),(0,B.Z)(qe,v.CameraUniform.ViewMatrix,p.cameraService.getViewMatrix()),(0,B.Z)(qe,v.CameraUniform.ViewProjectionMatrix,p.cameraService.getViewProjectionMatrix()),(0,B.Z)(qe,v.CameraUniform.Zoom,p.cameraService.getZoom()),(0,B.Z)(qe,v.CameraUniform.ZoomScale,p.cameraService.getZoomScale()),(0,B.Z)(qe,v.CameraUniform.FocalDistance,p.cameraService.getFocalDistance()),(0,B.Z)(qe,v.CameraUniform.CameraPosition,p.cameraService.getCameraPosition()),(0,B.Z)(qe,v.CoordinateUniform.CoordinateSystem,p.coordinateSystemService.getCoordinateSystem()),(0,B.Z)(qe,v.CoordinateUniform.ViewportCenter,p.coordinateSystemService.getViewportCenter()),(0,B.Z)(qe,v.CoordinateUniform.ViewportCenterProjection,p.coordinateSystemService.getViewportCenterProjection()),(0,B.Z)(qe,v.CoordinateUniform.PixelsPerDegree,p.coordinateSystemService.getPixelsPerDegree()),(0,B.Z)(qe,v.CoordinateUniform.PixelsPerDegree2,p.coordinateSystemService.getPixelsPerDegree2()),(0,B.Z)(qe,v.CoordinateUniform.PixelsPerMeter,p.coordinateSystemService.getPixelsPerMeter()),(0,B.Z)(qe,v.CoordinateUniform.Mvp,S),(0,B.Z)(qe,"u_SceneCenterMKT",k),(0,B.Z)(qe,"u_ViewportSize",[oe,xe]),(0,B.Z)(qe,"u_ModelMatrix",p.cameraService.getModelMatrix()),(0,B.Z)(qe,"u_DevicePixelRatio",Ge.$window.devicePixelRatio),(0,B.Z)(qe,"u_PickingBuffer",x.getLayerConfig().pickingBuffer||0),(0,B.Z)(qe,"u_shaderPick",Number(x.getShaderPickStat())),qe))})})}}]),f}(),Xf=(0,Vn.Z)(Mh.prototype,"cameraService",[rh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wp=(0,Vn.Z)(Mh.prototype,"coordinateSystemService",[ed],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dp=(0,Vn.Z)(Mh.prototype,"rendererService",[Nh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mp=(0,Vn.Z)(Mh.prototype,"mapService",[Rp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mh))||Hp),kp,Fp,Pp=(kp=(0,ze.b2)(),kp(Fp=function(){function f(){(0,Z.Z)(this,f)}return(0,a.Z)(f,[{key:"apply",value:function(x){x.hooks.beforeRender.tap("UpdateModelPlugin",function(){x.layerModel&&x.layerModel.needUpdate()})}}]),f}())||Fp),Wp,tp,td=(Wp=(0,ze.b2)(),Wp(tp=function(){function f(){(0,Z.Z)(this,f)}return(0,a.Z)(f,[{key:"apply",value:function(x,p){var h=this,S=p.styleAttributeService;x.hooks.init.tap("UpdateStyleAttributePlugin",function(){h.initStyleAttribute(x,{styleAttributeService:S})}),x.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){x.layerModelNeedUpdate||h.updateStyleAtrribute(x,{styleAttributeService:S})})}},{key:"updateStyleAtrribute",value:function(x,p){var h=p.styleAttributeService,S=h.getLayerStyleAttributes()||[],k=h.getLayerStyleAttribute("filter"),Q=h.getLayerStyleAttribute("shape");if(k&&k.needRegenerateVertices){x.layerModelNeedUpdate=!0,S.forEach(function(oe){return oe.needRegenerateVertices=!1});return}S.filter(function(oe){return oe.needRegenerateVertices}).forEach(function(oe){h.updateAttributeByFeatureRange(oe.name,x.getEncodedData(),oe.featureRange.startIndex,oe.featureRange.endIndex),oe.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(x,p){var h=p.styleAttributeService,S=h.getLayerStyleAttributes()||[];S.filter(function(k){return k.needRegenerateVertices}).forEach(function(k){h.updateAttributeByFeatureRange(k.name,x.getEncodedData(),k.featureRange.startIndex,k.featureRange.endIndex),k.needRegenerateVertices=!1})}}]),f}())||tp);v.container.bind(v.TYPES.ILayerPlugin).to(Ho).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(pp).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(hh).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(eu).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(Th).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(td).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(Pp).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(fp).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(Dp).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(np).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(Ap).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(Qp).inRequestScope(),v.container.bind(v.TYPES.ILayerPlugin).to(ap).inRequestScope()},27630:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return Qe}});var v=y(8842),Z=y(20637),a=y(23845),P=y(49651),L=y(58115),O=y(89866),D=y(47634),B=y(46090),V=y(81763),N=y.n(V),Y=y(39128),H=y(98422),ce=y(42184);function at(Te){var Le=rt();return function(){var Fe=(0,O.Z)(Te),Ke;if(Le){var qt=(0,O.Z)(this).constructor;Ke=Reflect.construct(Fe,arguments,qt)}else Ke=Fe.apply(this,arguments);return(0,L.Z)(this,Ke)}}function rt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Te){return!1}}var Re=`uniform float u_opacity;
varying vec4 v_Color;

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
}
`,vt=`attribute vec4 a_Color;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;

#pragma include "projection"

void main() {

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,wt=function(Te){(0,P.Z)(Ce,Te);var Le=at(Ce);function Ce(){return(0,v.Z)(this,Ce),Le.apply(this,arguments)}return(0,Z.Z)(Ce,[{key:"getUninforms",value:function(){var Ke=this.layer.getLayerConfig(),qt=Ke.opacity,ir=qt===void 0?0:qt;return{u_opacity:N()(ir)?ir:0}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"mask",vertexShader:vt,fragmentShader:Re,triangulation:ce.Qr,blend:this.getBlend(),depth:{enable:!1},stencil:{enable:!0,mask:255,func:{cmp:Y.gl.ALWAYS,ref:1,mask:255},opFront:{fail:Y.gl.REPLACE,zfail:Y.gl.REPLACE,zpass:Y.gl.REPLACE}}})]}},{key:"clearModels",value:function(){var Ke;(Ke=this.dataTexture)===null||Ke===void 0||Ke.destroy(),this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),Ce}(H.Z),fe={fill:wt},$e=fe;function re(Te){var Le=Ge();return function(){var Fe=(0,O.Z)(Te),Ke;if(Le){var qt=(0,O.Z)(this).constructor;Ke=Reflect.construct(Fe,arguments,qt)}else Ke=Fe.apply(this,arguments);return(0,L.Z)(this,Ke)}}function Ge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Te){return!1}}var Qe=function(Te){(0,P.Z)(Ce,Te);var Le=re(Ce);function Ce(){var Fe;(0,v.Z)(this,Ce);for(var Ke=arguments.length,qt=new Array(Ke),ir=0;ir<Ke;ir++)qt[ir]=arguments[ir];return Fe=Le.call.apply(Le,[this].concat(qt)),(0,D.Z)((0,a.Z)(Fe),"type","MaskLayer"),Fe}return(0,Z.Z)(Ce,[{key:"buildModels",value:function(){var Ke=this.getModelType();this.layerModel=new $e[Ke](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"fill"}}]),Ce}(B.Z)},9868:function(Ft,A,y){"use strict";y.d(A,{y:function(){return P}});var v=y(47634),Z=y(39128),a,P=(a={},(0,v.Z)(a,Z.BlendType.additive,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE,srcAlpha:1,dstAlpha:1}}),(0,v.Z)(a,Z.BlendType.none,{enable:!1}),(0,v.Z)(a,Z.BlendType.normal,{enable:!0,func:{srcRGB:Z.gl.SRC_ALPHA,dstRGB:Z.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,v.Z)(a,Z.BlendType.subtractive,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE,srcAlpha:Z.gl.ZERO,dstAlpha:Z.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:Z.gl.FUNC_SUBTRACT,alpha:Z.gl.FUNC_SUBTRACT}}),(0,v.Z)(a,Z.BlendType.max,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE},equation:{rgb:Z.gl.MAX_EXT}}),(0,v.Z)(a,Z.BlendType.min,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE},equation:{rgb:Z.gl.MIN_EXT}}),a)},1140:function(Ft,A,y){"use strict";y.d(A,{S:function(){return a},R:function(){return P}});var v=y(81763),Z=y.n(v);function a(L){if(Z()(L[0]))return L;if(Z()(L[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Z()(L[0][0][0])){var O=L,D=0,B=0,V=0;return O.forEach(function(N){N.forEach(function(Y){D+=Y[0],B+=Y[1],V++})}),[D/V,B/V,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function P(L){for(var O=L[0],D=L[1],B=L[0],V=L[1],N=0,Y=0,H=0,ce=0;ce<L.length;ce+=2){var at=L[ce],rt=L[ce+1];at&&rt&&(O=Math.max(at,O),D=Math.max(rt,D),B=Math.min(at,B),V=Math.min(rt,V),N+=at,Y+=rt,H++)}return{center:[N/H,Y/H],radius:Math.sqrt(Math.pow(O-B,2)+Math.pow(D-V,2))/2}}},32271:function(Ft,A,y){"use strict";y.d(A,{E:function(){return Z},N:function(){return a}});var v=y(12962);function Z(P){return P.map(function(L){return typeof L=="string"&&(L=[L,{}]),L})}function a(P,L,O,D){var B=P.multiPassRenderer,V=P.getLayerConfig(),N=V.enablePicking,Y=V.enableTAA;return Y?B.add(D("taa")):B.add(D("render")),Z(L).forEach(function(H){var ce=(0,v.Z)(H,2),at=ce[0],rt=ce[1];B.add(O(at),rt)}),B.add(O("copy")),B}},51747:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return v}});function v(Z,a,P,L,O){var D={};return Object.keys(L).forEach(function(B){D[B]=L[B]}),D.enumerable=!!D.enumerable,D.configurable=!!D.configurable,("value"in D||D.initializer)&&(D.writable=!0),D=P.slice().reverse().reduce(function(B,V){return V(Z,a,B)||B},D),O&&D.initializer!==void 0&&(D.value=D.initializer?D.initializer.call(O):void 0,D.initializer=void 0),D.initializer===void 0&&(Object.defineProperty(Z,a,D),D=null),D}},4117:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return v}});function v(Z,a){(a==null||a>Z.length)&&(a=Z.length);for(var P=0,L=new Array(a);P<a;P++)L[P]=Z[P];return L}},23845:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return v}});function v(Z){if(Z===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Z}},8842:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return v}});function v(Z,a){if(!(Z instanceof a))throw new TypeError("Cannot call a class as a function")}},20637:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return Z}});function v(a,P){for(var L=0;L<P.length;L++){var O=P[L];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(a,O.key,O)}}function Z(a,P,L){return P&&v(a.prototype,P),L&&v(a,L),Object.defineProperty(a,"prototype",{writable:!1}),a}},47634:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return v}});function v(Z,a,P){return a in Z?Object.defineProperty(Z,a,{value:P,enumerable:!0,configurable:!0,writable:!0}):Z[a]=P,Z}},89866:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return v}});function v(Z){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)},v(Z)}},49651:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return Z}});function v(a,P){return v=Object.setPrototypeOf||function(O,D){return O.__proto__=D,O},v(a,P)}function Z(a,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(P&&P.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),P&&v(a,P)}},32840:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return v}});function v(Z,a,P,L){!P||Object.defineProperty(Z,a,{enumerable:P.enumerable,configurable:P.configurable,writable:P.writable,value:P.initializer?P.initializer.call(L):void 0})}},83221:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return Z}});function v(a,P){if(a==null)return{};var L={},O=Object.keys(a),D,B;for(B=0;B<O.length;B++)D=O[B],!(P.indexOf(D)>=0)&&(L[D]=a[D]);return L}function Z(a,P){if(a==null)return{};var L=v(a,P),O,D;if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(a);for(D=0;D<B.length;D++)O=B[D],!(P.indexOf(O)>=0)&&(!Object.prototype.propertyIsEnumerable.call(a,O)||(L[O]=a[O]))}return L}},58115:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return a}});function v(P){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},v(P)}var Z=y(23845);function a(P,L){if(L&&(v(L)==="object"||typeof L=="function"))return L;if(L!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(0,Z.Z)(P)}},12962:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return L}});function v(O){if(Array.isArray(O))return O}function Z(O,D){var B=O==null?null:typeof Symbol!="undefined"&&O[Symbol.iterator]||O["@@iterator"];if(B!=null){var V=[],N=!0,Y=!1,H,ce;try{for(B=B.call(O);!(N=(H=B.next()).done)&&(V.push(H.value),!(D&&V.length===D));N=!0);}catch(at){Y=!0,ce=at}finally{try{!N&&B.return!=null&&B.return()}finally{if(Y)throw ce}}return V}}var a=y(57367);function P(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L(O,D){return v(O)||Z(O,D)||(0,a.Z)(O,D)||P()}},17553:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return O}});var v=y(4117);function Z(D){if(Array.isArray(D))return(0,v.Z)(D)}function a(D){if(typeof Symbol!="undefined"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}var P=y(57367);function L(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O(D){return Z(D)||a(D)||(0,P.Z)(D)||L()}},57367:function(Ft,A,y){"use strict";y.d(A,{Z:function(){return Z}});var v=y(4117);function Z(a,P){if(!!a){if(typeof a=="string")return(0,v.Z)(a,P);var L=Object.prototype.toString.call(a).slice(8,-1);if(L==="Object"&&a.constructor&&(L=a.constructor.name),L==="Map"||L==="Set")return Array.from(a);if(L==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L))return(0,v.Z)(a,P)}}},47507:function(Ft,A,y){Ft.exports=y(17445)},97671:function(Ft,A,y){"use strict";y.r(A),y.d(A,{Earth:function(){return oo},GaodeMap:function(){return it},GaodeMapV2:function(){return Ga},Map:function(){return Gh},Mapbox:function(){return $i},Version:function(){return Cr.G}});function v(R,m){if(!(R instanceof m))throw new TypeError("Cannot call a class as a function")}function Z(R,m){for(var u=0;u<m.length;u++){var _=m[u];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(R,_.key,_)}}function a(R,m,u){return m&&Z(R.prototype,m),u&&Z(R,u),Object.defineProperty(R,"prototype",{writable:!1}),R}function P(R,m){return P=Object.setPrototypeOf||function(_,b){return _.__proto__=b,_},P(R,m)}function L(R,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(m&&m.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),Object.defineProperty(R,"prototype",{writable:!1}),m&&P(R,m)}function O(R){return O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},O(R)}function D(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function B(R,m){if(m&&(O(m)==="object"||typeof m=="function"))return m;if(m!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D(R)}function V(R){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},V(R)}function N(R,m,u,_){!u||Object.defineProperty(R,m,{enumerable:u.enumerable,configurable:u.configurable,writable:u.writable,value:u.initializer?u.initializer.call(_):void 0})}function Y(R,m,u){return m in R?Object.defineProperty(R,m,{value:u,enumerable:!0,configurable:!0,writable:!0}):R[m]=u,R}function H(R,m,u,_,b){var q={};return Object.keys(_).forEach(function(de){q[de]=_[de]}),q.enumerable=!!q.enumerable,q.configurable=!!q.configurable,("value"in q||q.initializer)&&(q.writable=!0),q=u.slice().reverse().reduce(function(de,ct){return ct(R,m,de)||de},q),b&&q.initializer!==void 0&&(q.value=q.initializer?q.initializer.call(b):void 0,q.initializer=void 0),q.initializer===void 0&&(Object.defineProperty(R,m,q),q=null),q}var ce=y(39128),at,rt,Re;function vt(R,m){var u=Object.keys(R);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(R);m&&(_=_.filter(function(b){return Object.getOwnPropertyDescriptor(R,b).enumerable})),u.push.apply(u,_)}return u}function wt(R){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?vt(Object(u),!0).forEach(function(_){Y(R,_,u[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(u)):vt(Object(u)).forEach(function(_){Object.defineProperty(R,_,Object.getOwnPropertyDescriptor(u,_))})}return R}var fe=(at=(0,ce.lazyInject)(ce.TYPES.IGlobalConfigService),rt=function(){function R(m){v(this,R),N(this,"configService",Re,this),Y(this,"config",void 0),this.config=m}return a(R,[{key:"setContainer",value:function(u,_,b,q){u.bind(ce.TYPES.MapConfig).toConstantValue(wt(wt({},this.config),{},{id:_,canvas:b,hasBaseMap:q})),u.bind(ce.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),R}(),Re=H(rt.prototype,"configService",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rt);function $e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}function re(R,m,u){return $e()?re=Reflect.construct:re=function(b,q,de){var ct=[null];ct.push.apply(ct,q);var st=Function.bind.apply(b,ct),Mt=new st;return de&&P(Mt,de.prototype),Mt},re.apply(null,arguments)}function Ge(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}function Qe(R){if(Array.isArray(R))return Ge(R)}function Te(R){if(typeof Symbol!="undefined"&&R[Symbol.iterator]!=null||R["@@iterator"]!=null)return Array.from(R)}function Le(R,m){if(!!R){if(typeof R=="string")return Ge(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return Ge(R,m)}}function Ce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fe(R){return Qe(R)||Te(R)||Le(R)||Ce()}function Ke(R,m){if(R==null)return{};var u={},_=Object.keys(R),b,q;for(q=0;q<_.length;q++)b=_[q],!(m.indexOf(b)>=0)&&(u[b]=R[b]);return u}function qt(R,m){if(R==null)return{};var u=Ke(R,m),_,b;if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(R);for(b=0;b<q.length;b++)_=q[b],!(m.indexOf(_)>=0)&&(!Object.prototype.propertyIsEnumerable.call(R,_)||(u[_]=R[_]))}return u}function ir(R,m,u,_,b,q,de){try{var ct=R[q](de),st=ct.value}catch(Mt){u(Mt);return}ct.done?m(st):Promise.resolve(st).then(_,b)}function Pe(R){return function(){var m=this,u=arguments;return new Promise(function(_,b){var q=R.apply(m,u);function de(st){ir(q,_,b,de,ct,"next",st)}function ct(st){ir(q,_,b,de,ct,"throw",st)}de(void 0)})}}function Ne(R){if(Array.isArray(R))return R}function Xe(R,m){var u=R==null?null:typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(u!=null){var _=[],b=!0,q=!1,de,ct;try{for(u=u.call(R);!(b=(de=u.next()).done)&&(_.push(de.value),!(m&&_.length===m));b=!0);}catch(st){q=!0,ct=st}finally{try{!b&&u.return!=null&&u.return()}finally{if(q)throw ct}}return _}}function kt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rr(R,m){return Ne(R)||Xe(R,m)||Le(R,m)||kt()}var me=y(71035),et=y.n(me),or=y(81618),on=y.n(or),vr=y(86049),jr=y(85975),xr=y(77160),Ae=y(86700),De=y(28660),ke=function(){function R(m){v(this,R),Y(this,"size",1e4),this.size=m||1e4}return a(R,[{key:"setSize",value:function(u){this.size=u}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(u){return(180+u)/360*this.size}},{key:"mercatorYfromLat",value:function(u){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(u){return u/this.size*360-180}},{key:"latFromMercatorY",value:function(u){var _=180-(1-u/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(_*Math.PI/180))-90}},{key:"project",value:function(u){var _=this.mercatorXfromLng(u[0]),b=this.mercatorYfromLat(u[1]);return[_,b]}},{key:"unproject",value:function(u){var _=this.lngFromMercatorX(u[0]),b=this.latFromMercatorY(u[1]);return[_,b]}}]),R}();function Bt(R,m){var u=Object.keys(R);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(R);m&&(_=_.filter(function(b){return Object.getOwnPropertyDescriptor(R,b).enumerable})),u.push.apply(u,_)}return u}function mt(R){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?Bt(Object(u),!0).forEach(function(_){Y(R,_,u[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(u)):Bt(Object(u)).forEach(function(_){Object.defineProperty(R,_,Object.getOwnPropertyDescriptor(u,_))})}return R}function Mr(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m={top:0,right:0,bottom:0,left:0};if(typeof R=="number")return{top:R,right:R,bottom:R,left:R};if(Array.isArray(R)){if(R.length===4)return{top:R[0],right:R[1],bottom:R[2],left:R[3]};if(R.length===2)return{top:R[0],right:R[1],bottom:R[0],left:R[1]}}return mt(mt({},m),R)}var Cr=y(84859),Nr={dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},nt=Math.PI/180,Ye=function(){function R(){v(this,R),Y(this,"projectionMatrix",jr.create()),Y(this,"viewMatrix",jr.create()),Y(this,"viewProjectionMatrix",jr.create()),Y(this,"ViewProjectionMatrixUncentered",jr.create()),Y(this,"viewUncenteredMatrix",jr.create()),Y(this,"zoom",void 0),Y(this,"center",void 0)}return a(R,[{key:"syncWithMapCamera",value:function(u){var _=u.zoom,b=_===void 0?1:_,q=u.pitch,de=q===void 0?0:q,ct=u.bearing,st=ct===void 0?0:ct,Mt=u.center,Ir=Mt===void 0?[0,0]:Mt,Gr=u.offsetOrigin,xn=Gr===void 0?[0,0]:Gr,gn=u.cameraHeight,Sn=gn===void 0?1:gn,Wn=u.aspect,bi=Wn===void 0?1:Wn,pa=u.near,Wa=pa===void 0?.1:pa,Qa=u.far,ro=Qa===void 0?1e3:Qa,Ko=u.fov,sa=Ko===void 0?0:Ko;this.zoom=b,this.center=Ir;var _o=de*nt,xa=(360-st)*nt;jr.perspective(this.projectionMatrix,sa,bi,Wa,ro);var xo=xr.fromValues(Sn*Math.sin(_o)*Math.sin(xa),-Sn*Math.sin(_o)*Math.cos(xa),Sn*Math.cos(_o)),ds=xr.fromValues(-Math.cos(_o)*Math.sin(xa),Math.cos(_o)*Math.cos(xa),Math.sin(_o));jr.lookAt(this.viewMatrix,xo,xr.fromValues(0,0,0),ds),this.viewUncenteredMatrix=jr.clone(this.viewMatrix),jr.translate(this.viewMatrix,this.viewMatrix,xr.fromValues(-xn[0],xn[1],0)),jr.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),jr.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var u=rr(this.center,2),_=u[0],b=u[1];return[_,b]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(u,_){var b=85.0511287798,q=Math.max(Math.min(b,u[1]),-b),de=256<<20,ct=Math.PI/180,st=u[0]*ct,Mt=q*ct;Mt=Math.log(Math.tan(Math.PI/4+Mt/2));var Ir=.5/Math.PI,Gr=.5,xn=-.5/Math.PI;return ct=.5,st=de*(Ir*st+Gr)-215440491,Mt=-(de*(xn*Mt+ct)-106744817),[st,Mt]}}]),R}(),M=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],W,ue,X,ie,ye,J,ht,ze,pt,Me,Ue;function yt(R,m){var u=Object.keys(R);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(R);m&&(_=_.filter(function(b){return Object.getOwnPropertyDescriptor(R,b).enumerable})),u.push.apply(u,_)}return u}function gt(R){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?yt(Object(u),!0).forEach(function(_){Y(R,_,u[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(u)):yt(Object(u)).forEach(function(_){Object.defineProperty(R,_,Object.getOwnPropertyDescriptor(u,_))})}return R}function nr(R,m){var u=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(u||_)&&(m||(m=document),!!m)){var b=m.head||m.getElementsByTagName("head")[0];if(!b){b=m.createElement("head");var q=m.body||m.getElementsByTagName("body")[0];q?q.parentNode.insertBefore(b,q):m.documentElement.appendChild(b)}var de=m.createElement("style");return de.type="text/css",de.styleSheet?de.styleSheet.cssText=R:de.appendChild(m.createTextNode(R)),b.appendChild(de),de}}nr(`.amap-logo{
 display: none !important;
}
`);var pe=0;window.forceWebGL=!0;var lr="15cd8a57710d40c9b7c0e3cc120f1200",Ur="1.4.15",Hr="amap-script",un=!1,bn=[],Gn=12,li=(W=(0,Ae.b2)(),ue=(0,Ae.f3)(ce.TYPES.IGlobalConfigService),X=(0,Ae.f3)(ce.TYPES.MapConfig),ie=(0,Ae.f3)(ce.TYPES.ICoordinateSystemService),ye=(0,Ae.f3)(ce.TYPES.IEventEmitter),W(J=(ht=function(){function R(){var m=this;v(this,R),Y(this,"version",Cr.G["GAODE1.x"]),Y(this,"simpleMapCoord",new ke),Y(this,"map",void 0),Y(this,"bgColor","rgba(0, 0, 0, 0)"),N(this,"configService",ze,this),N(this,"config",pt,this),N(this,"coordinateSystemService",Me,this),N(this,"eventEmitter",Ue,this),Y(this,"markerContainer",void 0),Y(this,"$mapContainer",void 0),Y(this,"viewport",void 0),Y(this,"cameraChangedCallback",void 0),Y(this,"handleCameraChanged",function(u){var _=u.camera,b=_.fov,q=_.near,de=_.far,ct=_.height,st=_.pitch,Mt=_.rotation,Ir=_.aspect,Gr=_.position,xn=m.getCenter(),gn=xn.lng,Sn=xn.lat;if(m.emit("mapchange"),m.cameraChangedCallback){m.viewport.syncWithMapCamera({aspect:Ir,bearing:360-Mt,far:de,fov:b,cameraHeight:ct,near:q,pitch:st,zoom:m.map.getZoom()-1,center:[gn,Sn],offsetOrigin:[Gr.x,Gr.y]});var Wn=m.config.offsetZoom,bi=Wn===void 0?Gn:Wn;m.viewport.getZoom()>bi?m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.P20_OFFSET):m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.P20),m.cameraChangedCallback(m.viewport)}})}return a(R,[{key:"setBgColor",value:function(u){this.bgColor=u}},{key:"addMarkerContainer",value:function(){var u=this.map.getContainer();if(u!==null){var _=u.getElementsByClassName("amap-maps")[0];this.markerContainer=vr.DOM.create("div","l7-marker-container",_)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(u,_){ce.MapServiceEvent.indexOf(u)!==-1?this.eventEmitter.on(u,_):this.map.on(u,_)}},{key:"off",value:function(u,_){ce.MapServiceEvent.indexOf(u)!==-1?this.eventEmitter.off(u,_):this.map.off(u,_)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var u;return(u=this.map.getContainer())===null||u===void 0?void 0:u.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var u=this.map.getSize();return[u.getWidth(),u.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(u){return this.map.setZoom(u+1)}},{key:"getCenter",value:function(u){if(u!=null&&u.padding){var _=this.getCenter(),b=this.getSize(),q=rr(b,2),de=q[0],ct=q[1],st=Mr(u.padding),Mt=this.lngLatToPixel([_.lng,_.lat]),Ir=[(st.right-st.left)/2,(st.bottom-st.top)/2],Gr=this.pixelToLngLat([Mt.x-Ir[0],Mt.y-Ir[1]]);return Gr}var xn=this.map.getCenter();return{lng:xn.getLng(),lat:xn.getLat()}}},{key:"setCenter",value:function(u,_){if(_!=null&&_.padding){var b=Mr(_.padding),q=this.lngLatToPixel(u),de=[(b.right-b.left)/2,(b.bottom-b.top)/2],ct=this.pixelToLngLat([q.x+de[0],q.y+de[1]]);this.map.setCenter([ct.lng,ct.lat])}else this.map.setCenter(u)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var u=this.map.getBounds().toBounds(),_=u.getNorthEast(),b=u.getSouthWest(),q=this.getCenter(),de=q.lng>_.getLng()||q.lng<b.getLng()?180-_.getLng():_.getLng(),ct=q.lng<b.getLng()?b.getLng()-180:b.getLng();return[[ct,b.getLat()],[de,_.getLat()]]}},{key:"getMinZoom",value:function(){var u=this.map.get("zooms");return u[0]-1}},{key:"getMaxZoom",value:function(){var u=this.map.get("zooms");return u[1]-1}},{key:"setRotation",value:function(u){return this.map.setRotation(u)}},{key:"setPitch",value:function(u){return this.map.setPitch(u)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(u){this.map.panTo(u)}},{key:"panBy",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(u,_)}},{key:"fitBounds",value:function(u){this.map.setBounds(new AMap.Bounds([u[0][0],u[0][1],u[1][0],u[1][1]]))}},{key:"setZoomAndCenter",value:function(u,_){this.map.setZoomAndCenter(u+1,_)}},{key:"setMapStyle",value:function(u){this.map.setMapStyle(this.getMapStyle(u))}},{key:"setMapStatus",value:function(u){this.map.setStatus(u)}},{key:"pixelToLngLat",value:function(u){var _=this.map.pixelToLngLat(new AMap.Pixel(u[0],u[1]));return{lng:_.getLng(),lat:_.getLat()}}},{key:"lngLatToPixel",value:function(u){var _=this.map.lnglatToPixel(new AMap.LngLat(u[0],u[1]));return{x:_.getX(),y:_.getY()}}},{key:"containerToLngLat",value:function(u){var _=new AMap.Pixel(u[0],u[1]),b=this.map.containerToLngLat(_);return{lng:b==null?void 0:b.getLng(),lat:b==null?void 0:b.getLat()}}},{key:"lngLatToContainer",value:function(u){var _=new AMap.LngLat(u[0],u[1]),b=this.map.lngLatToContainer(_);return{x:b.getX(),y:b.getY()}}},{key:"lngLatToCoord",value:function(u){var _=this.map.lngLatToGeodeticCoord(u),b=_.x,q=_.y;return[b,-q]}},{key:"lngLatToMercator",value:function(u,_){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(u,_,b){var q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],de=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},ct=this.viewport.projectFlat(u),st=jr.create();return jr.translate(st,st,xr.fromValues(ct[0],ct[1],_)),jr.scale(st,st,xr.fromValues(q[0],q[1],q[2])),jr.rotateX(st,st,b[0]),jr.rotateY(st,st,b[1]),jr.rotateZ(st,st,b[2]),st}},{key:"init",value:function(){var m=Pe(et().mark(function _(){var b=this,q,de,ct,st,Mt,Ir,Gr,xn,gn,Sn,Wn,bi,pa,Wa;return et().wrap(function(ro){for(;;)switch(ro.prev=ro.next){case 0:return q=this.config,de=q.id,ct=q.style,st=ct===void 0?"light":ct,Mt=q.minZoom,Ir=Mt===void 0?0:Mt,Gr=q.maxZoom,xn=Gr===void 0?18:Gr,gn=q.token,Sn=gn===void 0?lr:gn,Wn=q.mapInstance,bi=q.plugin,pa=bi===void 0?[]:bi,Wa=qt(q,M),ro.next=3,new Promise(function(Ko){var sa=function(){if(Wn)b.map=Wn,b.$mapContainer=b.map.getContainer(),setTimeout(function(){b.map.on("camerachange",b.handleCameraChanged),Ko()},30);else{b.$mapContainer=b.creatAmapContainer(de);var xa=gt({mapStyle:b.getMapStyle(st),zooms:[Ir,xn],viewMode:"3D"},Wa);xa.zoom&&(xa.zoom+=1);var xo=new AMap.Map(b.$mapContainer,xa);xo.on("camerachange",b.handleCameraChanged),xo.on("camerachange",function(){setTimeout(function(){return b.handleAfterMapChange()})}),b.map=xo,setTimeout(function(){Ko()},10)}};!un&&!Wn?(Sn===lr&&console.warn(b.configService.getSceneWarninfo("MapToken")),un=!0,pa.push("Map3D"),on().load({key:Sn,version:Ur,plugins:pa}).then(function(_o){sa(),bn.length&&(bn.forEach(function(xa){return xa()}),bn=[])}).catch(function(_o){throw new Error(_o)})):un&&window.AMap||Wn?sa():bn.push(sa)});case 3:this.viewport=new Ye;case 4:case"end":return ro.stop()}},_,this)}));function u(){return m.apply(this,arguments)}return u}()},{key:"meterToCoord",value:function(u,_){var b=AMap.GeometryUtil.distance(re(AMap.LngLat,Fe(u)),re(AMap.LngLat,Fe(_))),q=this.lngLatToCoord(u),de=rr(q,2),ct=de[0],st=de[1],Mt=this.lngLatToCoord(_),Ir=rr(Mt,2),Gr=Ir[0],xn=Ir[1],gn=Math.sqrt(Math.pow(ct-Gr,2)+Math.pow(st-xn,2));return gn/b}},{key:"exportMap",value:function(u){var _,b=(_=this.getContainer())===null||_===void 0?void 0:_.getElementsByClassName("amap-layer")[0],q=u==="jpg"?b==null?void 0:b.toDataURL("image/jpeg"):b==null?void 0:b.toDataURL("image/png");return q}},{key:"emit",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).emit.apply(_,[u].concat(q))}},{key:"once",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).once.apply(_,[u].concat(q))}},{key:"destroy",value:function(){var u,_;this.map.destroy(),(u=this.$mapContainer)===null||u===void 0||(_=u.parentNode)===null||_===void 0||_.removeChild(this.$mapContainer),delete window.initAMap;var b=document.getElementById(Hr);b&&document.head.removeChild(b)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(u){this.cameraChangedCallback=u}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"getMapStyle",value:function(u){return Nr[u]?Nr[u]:u}},{key:"creatAmapContainer",value:function(u){var _=u;typeof u=="string"&&(_=document.getElementById(u));var b=document.createElement("div");return b.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,b.id="l7_amap_div"+pe++,_.appendChild(b),b}}]),R}(),ze=H(ht.prototype,"configService",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=H(ht.prototype,"config",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=H(ht.prototype,"coordinateSystemService",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ue=H(ht.prototype,"eventEmitter",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht))||J);function $r(R){var m=Zt();return function(){var _=V(R),b;if(m){var q=V(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return B(this,b)}}function Zt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var it=function(R){L(u,R);var m=$r(u);function u(){return v(this,u),m.apply(this,arguments)}return a(u,[{key:"getServiceConstructor",value:function(){return li}}]),u}(fe),ne={dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},_e=function(){function R(){v(this,R),Y(this,"projectionMatrix",jr.create()),Y(this,"viewMatrix",jr.create()),Y(this,"viewProjectionMatrix",jr.create()),Y(this,"ViewProjectionMatrixUncentered",jr.create()),Y(this,"viewUncenteredMatrix",jr.create()),Y(this,"zoom",void 0),Y(this,"center",void 0)}return a(R,[{key:"syncWithMapCamera",value:function(u){var _=u.zoom,b=_===void 0?1:_,q=u.center,de=q===void 0?[0,0]:q,ct=u.offsetOrigin,st=ct===void 0?[0,0]:ct,Mt=u.cameraPosition,Ir=Mt===void 0?[0,0,0]:Mt,Gr=u.up,xn=Gr===void 0?[0,1,0]:Gr,gn=u.lookAt,Sn=gn===void 0?[0,0,0]:gn,Wn=u.aspect,bi=Wn===void 0?1:Wn,pa=u.near,Wa=pa===void 0?.1:pa,Qa=u.far,ro=Qa===void 0?1e3:Qa,Ko=u.fov,sa=Ko===void 0?45:Ko;this.zoom=b,this.center=de,jr.perspective(this.projectionMatrix,sa/180*Math.PI,bi,Wa,ro);var _o=xr.fromValues.apply(xr,Fe(Ir)),xa=xr.fromValues.apply(xr,Fe(Sn)),xo=xr.fromValues.apply(xr,Fe(xn));jr.lookAt(this.viewMatrix,_o,xa,xo),this.viewUncenteredMatrix=jr.clone(this.viewMatrix),jr.translate(this.viewMatrix,this.viewMatrix,xr.fromValues(-st[0],st[1],0)),jr.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),jr.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var u=rr(this.center,2),_=u[0],b=u[1];return[_,b]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(u,_){var b=85.0511287798,q=Math.max(Math.min(b,u[1]),-b),de=256<<20,ct=Math.PI/180,st=u[0]*ct,Mt=q*ct;Mt=Math.log(Math.tan(Math.PI/4+Mt/2));var Ir=.5/Math.PI,Gr=.5,xn=-.5/Math.PI;return ct=.5,st=de*(Ir*st+Gr)-215440491,Mt=-(de*(xn*Mt+ct)-106744817),[st,Mt]}}]),R}(),Oe=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],je,dt,Ut,ur,lt,Nt,Sr,fn,Br,Jr,Tn;function hi(R,m){var u=Object.keys(R);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(R);m&&(_=_.filter(function(b){return Object.getOwnPropertyDescriptor(R,b).enumerable})),u.push.apply(u,_)}return u}function On(R){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?hi(Object(u),!0).forEach(function(_){Y(R,_,u[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(u)):hi(Object(u)).forEach(function(_){Object.defineProperty(R,_,Object.getOwnPropertyDescriptor(u,_))})}return R}function Pr(R,m){var u=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(u||_)&&(m||(m=document),!!m)){var b=m.head||m.getElementsByTagName("head")[0];if(!b){b=m.createElement("head");var q=m.body||m.getElementsByTagName("body")[0];q?q.parentNode.insertBefore(b,q):m.documentElement.appendChild(b)}var de=m.createElement("style");return de.type="text/css",de.styleSheet?de.styleSheet.cssText=R:de.appendChild(m.createTextNode(R)),b.appendChild(de),de}}Pr(`.amap-logo{
 display: none !important;
}
`);var vi=0;window.forceWebGL=!0;var Jn="ff533602d57df6f8ab3b0fea226ae52f",ui="2.0",Da="amap-script",Yn=!1,wa=[],vo=(je=(0,Ae.b2)(),dt=(0,Ae.f3)(ce.TYPES.IGlobalConfigService),Ut=(0,Ae.f3)(ce.TYPES.MapConfig),ur=(0,Ae.f3)(ce.TYPES.ICoordinateSystemService),lt=(0,Ae.f3)(ce.TYPES.IEventEmitter),je(Nt=(Sr=function(){function R(){var m=this;v(this,R),Y(this,"version",Cr.G["GAODE2.x"]),Y(this,"simpleMapCoord",new ke),Y(this,"map",void 0),Y(this,"sceneCenter",void 0),Y(this,"sceneCenterMKT",void 0),Y(this,"bgColor","rgba(0, 0, 0, 0)"),N(this,"configService",fn,this),N(this,"config",Br,this),N(this,"coordinateSystemService",Jr,this),N(this,"eventEmitter",Tn,this),Y(this,"markerContainer",void 0),Y(this,"$mapContainer",void 0),Y(this,"viewport",void 0),Y(this,"cameraChangedCallback",void 0),Y(this,"handleViewChanged",function(u){var _=m.map.customCoords.getCameraParams(),b=_.fov,q=_.near,de=_.far,ct=_.aspect,st=_.position,Mt=_.lookAt,Ir=_.up;m.emit("mapchange");var Gr=u.zoom,xn=m.map.customCoords.getCenter();m.cameraChangedCallback&&(m.viewport.syncWithMapCamera({aspect:ct,far:de,fov:b,cameraPosition:st,lookAt:Mt,up:Ir,near:q,zoom:Gr-1,center:xn,offsetOrigin:[st[0],st[1]]}),m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.P20_2),m.cameraChangedCallback(m.viewport))})}return a(R,[{key:"setBgColor",value:function(u){this.bgColor=u}},{key:"setCustomCoordCenter",value:function(u){var _;this.sceneCenter=u,this.sceneCenterMKT=(_=this.map.getProjection()).project.apply(_,Fe(this.sceneCenter))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoord",value:function(u){var _=this.map.getProjection(),b=_.project;return this.sceneCenter||(this.map.customCoords.setCenter(u),this.setCustomCoordCenter(u)),this._sub(b(u[0],u[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(u){var _=this;return u.map(function(b){return typeof b[0]=="number"?_.lngLatToCoord(b):b.map(function(q){return _.lngLatToCoord(q)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var u=this.map.getContainer();if(u!==null){var _=u.getElementsByClassName("amap-maps")[0];_.style.zIndex="auto",this.markerContainer=vr.DOM.create("div","l7-marker-container2",_)}}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(u,_){ce.MapServiceEvent.indexOf(u)!==-1?this.eventEmitter.on(u,_):this.map.on(u,_)}},{key:"off",value:function(u,_){ce.MapServiceEvent.indexOf(u)!==-1?this.eventEmitter.off(u,_):this.map.off(u,_)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var u;return(u=this.map.getContainer())===null||u===void 0?void 0:u.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var u=this.map.getSize();return[u.getWidth(),u.getHeight()]}},{key:"getType",value:function(){return"amap2"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(u){return this.map.setZoom(u+1)}},{key:"getCenter",value:function(u){if(u!=null&&u.padding){var _=this.getCenter(),b=this.getSize(),q=rr(b,2),de=q[0],ct=q[1],st=Mr(u.padding),Mt=this.lngLatToPixel([_.lng,_.lat]),Ir=[(st.right-st.left)/2,(st.bottom-st.top)/2],Gr=this.pixelToLngLat([Mt.x-Ir[0],Mt.y-Ir[1]]);return Gr}var xn=this.map.getCenter();return{lng:xn.getLng(),lat:xn.getLat()}}},{key:"setCenter",value:function(u,_){if(_!=null&&_.padding){var b=Mr(_.padding),q=this.lngLatToPixel(u),de=[(b.right-b.left)/2,(b.bottom-b.top)/2],ct=this.pixelToLngLat([q.x+de[0],q.y+de[1]]);this.map.setCenter([ct.lng,ct.lat])}else this.map.setCenter(u)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var u=this.map.getBounds(),_=u.getNorthEast(),b=u.getSouthWest(),q=this.getCenter(),de=q.lng>_.getLng()||q.lng<b.getLng()?180-_.getLng():_.getLng(),ct=q.lng<b.getLng()?b.getLng()-180:b.getLng();return[[ct,b.getLat()],[de,_.getLat()]]}},{key:"getMinZoom",value:function(){var u=this.map.getZooms();return u[0]-1}},{key:"getMaxZoom",value:function(){var u=this.map.getZooms();return u[1]-1}},{key:"setRotation",value:function(u){return this.map.setRotation(u)}},{key:"setPitch",value:function(u){return this.map.setPitch(u)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(u){this.map.panTo(u)}},{key:"panBy",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(u,_)}},{key:"fitBounds",value:function(u){this.map.setBounds(new AMap.Bounds([u[0][0],u[0][1],u[1][0],u[1][1]]))}},{key:"setZoomAndCenter",value:function(u,_){this.map.setZoomAndCenter(u+1,_)}},{key:"setMapStyle",value:function(u){this.map.setMapStyle(this.getMapStyle(u))}},{key:"setMapStatus",value:function(u){this.map.setStatus(u)}},{key:"pixelToLngLat",value:function(u){var _=this.map.pixelToLngLat(new AMap.Pixel(u[0],u[1]));return{lng:_.getLng(),lat:_.getLat()}}},{key:"lngLatToPixel",value:function(u){var _=this.map.lnglatToPixel(new AMap.LngLat(u[0],u[1]));return{x:_.getX(),y:_.getY()}}},{key:"containerToLngLat",value:function(u){var _=new AMap.Pixel(u[0],u[1]),b=this.map.containerToLngLat(_);return{lng:b==null?void 0:b.getLng(),lat:b==null?void 0:b.getLat()}}},{key:"lngLatToContainer",value:function(u){var _=new AMap.LngLat(u[0],u[1]),b=this.map.lngLatToContainer(_);return{x:b.getX(),y:b.getY()}}},{key:"lngLatToMercator",value:function(u,_){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(u,_,b){var q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],de=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},ct=this.map.customCoords.lngLatToCoord(u),st=jr.create();return jr.translate(st,st,xr.fromValues(ct[0],ct[1],_)),jr.scale(st,st,xr.fromValues(q[0],q[1],q[2])),jr.rotateX(st,st,b[0]),jr.rotateY(st,st,b[1]),jr.rotateZ(st,st,b[2]),st}},{key:"init",value:function(){var m=Pe(et().mark(function _(){var b=this,q,de,ct,st,Mt,Ir,Gr,xn,gn,Sn,Wn,bi,pa,Wa,Qa,ro;return et().wrap(function(sa){for(;;)switch(sa.prev=sa.next){case 0:return q=this.config,de=q.id,ct=q.style,st=ct===void 0?"light":ct,Mt=q.minZoom,Ir=Mt===void 0?0:Mt,Gr=q.maxZoom,xn=Gr===void 0?18:Gr,gn=q.token,Sn=gn===void 0?Jn:gn,Wn=q.mapInstance,bi=q.plugin,pa=bi===void 0?[]:bi,Wa=q.version,Qa=Wa===void 0?ui:Wa,ro=qt(q,Oe),sa.next=3,new Promise(function(_o){var xa=function(){if(Wn){var ds;b.map=Wn,b.$mapContainer=b.map.getContainer();var ru=b.map.getCenter();(ds=b.map.customCoords)===null||ds===void 0||ds.setCenter([ru.lng,ru.lat]),b.setCustomCoordCenter([ru.lng,ru.lat]),setTimeout(function(){b.map.on("viewchange",b.handleViewChanged),_o()},30)}else{b.$mapContainer=b.creatAmapContainer(de);var Rc=On({mapStyle:b.getMapStyle(st),zooms:[Ir,xn],viewMode:"3D"},ro);Rc.zoom&&(Rc.zoom+=1);var mc=new AMap.Map(b.$mapContainer,Rc);b.map=mc;var vl=mc.getCenter();mc.customCoords.setCenter([vl.lng,vl.lat]),b.setCustomCoordCenter([vl.lng,vl.lat]),mc.on("viewchange",b.handleViewChanged),setTimeout(function(){_o()},10)}};b.viewport=new _e,!Yn&&!Wn?(Sn===Jn&&console.warn(b.configService.getSceneWarninfo("MapToken")),Yn=!0,pa.push("Map3D"),on().load({key:Sn,version:Qa,plugins:pa}).then(function(xo){xa(),wa.length&&(wa.forEach(function(ds){return ds()}),wa=[])}).catch(function(xo){throw new Error(xo)})):Yn&&window.AMap||Wn?xa():wa.push(xa)});case 3:case"end":return sa.stop()}},_,this)}));function u(){return m.apply(this,arguments)}return u}()},{key:"meterToCoord",value:function(u,_){var b=AMap.GeometryUtil.distance(re(AMap.LngLat,Fe(u)),re(AMap.LngLat,Fe(_))),q=this.lngLatToCoord(u),de=rr(q,2),ct=de[0],st=de[1],Mt=this.lngLatToCoord(_),Ir=rr(Mt,2),Gr=Ir[0],xn=Ir[1],gn=Math.sqrt(Math.pow(ct-Gr,2)+Math.pow(st-xn,2));return gn/b}},{key:"exportMap",value:function(u){var _,b=(_=this.getContainer())===null||_===void 0?void 0:_.getElementsByClassName("amap-layer")[0],q=u==="jpg"?b==null?void 0:b.toDataURL("image/jpeg"):b==null?void 0:b.toDataURL("image/png");return q}},{key:"emit",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).emit.apply(_,[u].concat(q))}},{key:"once",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).once.apply(_,[u].concat(q))}},{key:"destroy",value:function(){var u,_;this.map.destroy(),(u=this.$mapContainer)===null||u===void 0||(_=u.parentNode)===null||_===void 0||_.removeChild(this.$mapContainer),delete window.initAMap;var b=document.getElementById(Da);b&&document.head.removeChild(b)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(u){this.cameraChangedCallback=u}},{key:"initViewPort",value:function(){var u,_=(u=this.map.customCoords)===null||u===void 0?void 0:u.getCameraParams(),b=_.fov,q=_.near,de=_.far,ct=_.aspect,st=_.position,Mt=_.lookAt,Ir=_.up;this.emit("mapchange");var Gr=this.map.customCoords.getCenter(),xn=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:ct,far:de,fov:b,cameraPosition:st,lookAt:Mt,near:q,up:Ir,zoom:xn-1,center:Gr,offsetOrigin:[st[0],st[1]]}),this.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(u,_){var b=[0,0];return b[0]=u[0]-_[0],b[1]=u[1]-_[1],b}},{key:"getMapStyle",value:function(u){return ne[u]?ne[u]:u}},{key:"creatAmapContainer",value:function(u){var _=u;typeof u=="string"&&(_=document.getElementById(u));var b=document.createElement("div");return b.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,b.id="l7_amap_div"+vi++,_.appendChild(b),b}}]),R}(),fn=H(Sr.prototype,"configService",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Br=H(Sr.prototype,"config",[Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jr=H(Sr.prototype,"coordinateSystemService",[ur],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tn=H(Sr.prototype,"eventEmitter",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sr))||Nt);function Ua(R){var m=Ka();return function(){var _=V(R),b;if(m){var q=V(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return B(this,b)}}function Ka(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var Ga=function(R){L(u,R);var m=Ua(u);function u(){return v(this,u),m.apply(this,arguments)}return a(u,[{key:"getServiceConstructor",value:function(){return vo}}]),u}(fe);function ei(R,m){if(!(R instanceof m))throw new TypeError("Cannot call a class as a function")}function eo(R,m){for(var u=0;u<m.length;u++){var _=m[u];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(R,_.key,_)}}function ra(R,m,u){return m&&eo(R.prototype,m),u&&eo(R,u),Object.defineProperty(R,"prototype",{writable:!1}),R}function Rn(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function qa(R,m){return qa=Object.setPrototypeOf||function(_,b){return _.__proto__=b,_},qa(R,m)}function ba(R,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(m&&m.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),Object.defineProperty(R,"prototype",{writable:!1}),m&&qa(R,m)}function Na(R){return Na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},Na(R)}function wo(R,m){if(m&&(Na(m)==="object"||typeof m=="function"))return m;if(m!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rn(R)}function ya(R){return ya=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},ya(R)}function Gt(R,m,u){return m in R?Object.defineProperty(R,m,{value:u,enumerable:!0,configurable:!0,writable:!0}):R[m]=u,R}var gs=y(82492),Qi=y.n(gs),So=y(26729),ll=y(99874),Ss=y.n(ll);function rs(R,m){var u=typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(!u){if(Array.isArray(R)||(u=ls(R))||m&&R&&typeof R.length=="number"){u&&(R=u);var _=0,b=function(){};return{s:b,n:function(){return _>=R.length?{done:!0}:{done:!1,value:R[_++]}},e:function(Mt){throw Mt},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,de=!1,ct;return{s:function(){u=u.call(R)},n:function(){var Mt=u.next();return q=Mt.done,Mt},e:function(Mt){de=!0,ct=Mt},f:function(){try{!q&&u.return!=null&&u.return()}finally{if(de)throw ct}}}}function ls(R,m){if(!!R){if(typeof R=="string")return Ia(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return Ia(R,m)}}function Ia(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}var Ms;function uo(R,m,u){var _=u-m,b=((R-m)%_+_)%_+m;return b===m?u:b}function Qs(R,m,u){return Math.min(u,Math.max(m,R))}function Ao(R,m,u){return R*(1-u)+m*u}function Ts(R,m,u,_){var b=new(Ss())(R,m,u,_);return function(q){return b.solve(q)}}var ua=Ts(.25,.1,.25,1);function cs(){return vr.isMini||!vr.$window.matchMedia?!1:(Ms==null&&(Ms=vr.$window.matchMedia("(prefers-reduced-motion: reduce)")),Ms.matches)}function Ds(R,m){var u={},_=rs(m),b;try{for(_.s();!(b=_.n()).done;){var q=b.value;q in R&&(u[q]=R[q])}}catch(de){_.e(de)}finally{_.f()}return u}var Ro=vr.isMini?Date.now.bind(Date):vr.$window.performance&&vr.$window.performance.now?vr.$window.performance.now.bind(vr.$window.performance):Date.now.bind(Date),Eu=vr.$window.requestAnimationFrame||vr.$window.mozRequestAnimationFrame||vr.$window.webkitRequestAnimationFrame||vr.$window.msRequestAnimationFrame,ec=vr.$window.cancelAnimationFrame||vr.$window.mozCancelAnimationFrame||vr.$window.webkitCancelAnimationFrame||vr.$window.msCancelAnimationFrame;function Gs(R){var m=Eu(R);return{cancel:function(){return ec(m)}}}var ft=63710088e-1,St=function(){function R(m,u){if(ei(this,R),Gt(this,"lng",void 0),Gt(this,"lat",void 0),isNaN(m)||isNaN(u))throw new Error("Invalid LngLat object: (".concat(m,", ").concat(u,")"));if(this.lng=+m,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return ra(R,[{key:"wrap",value:function(){return new R(uo(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(u){var _=Math.PI/180,b=this.lat*_,q=u.lat*_,de=Math.sin(b)*Math.sin(q)+Math.cos(b)*Math.cos(q)*Math.cos((u.lng-this.lng)*_),ct=ft*Math.acos(Math.min(de,1));return ct}}],[{key:"convert",value:function(u){if(u instanceof R)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new R(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&Na(u)==="object"&&u!==null){var _="lng"in u?u.lng:u.lon;return new R(Number(_),Number(u.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),R}(),_r=function(){function R(m,u){ei(this,R),Gt(this,"ne",void 0),Gt(this,"sw",void 0),m&&(u?this.setSouthWest(m).setNorthEast(u):m.length===4?this.setSouthWest([m[0],m[1]]).setNorthEast([m[2],m[3]]):this.setSouthWest(m[0]).setNorthEast(m[1]))}return ra(R,[{key:"setNorthEast",value:function(u){return this.ne=u instanceof St?new St(u.lng,u.lat):St.convert(u),this}},{key:"setSouthWest",value:function(u){return this.sw=u instanceof St?new St(u.lng,u.lat):St.convert(u),this}},{key:"extend",value:function(u){var _=this.sw,b=this.ne,q,de;if(u instanceof St)q=u,de=u;else if(u instanceof R){if(q=u.sw,de=u.ne,!q||!de)return this}else{if(Array.isArray(u))if(u.length===4||u.every(Array.isArray)){var ct=u;return this.extend(R.convert(ct))}else{var st=u;return this.extend(St.convert(st))}return this}return!_&&!b?(this.sw=new St(q.lng,q.lat),this.ne=new St(de.lng,de.lat)):(_.lng=Math.min(q.lng,_.lng),_.lat=Math.min(q.lat,_.lat),b.lng=Math.max(de.lng,b.lng),b.lat=Math.max(de.lat,b.lat)),this}},{key:"getCenter",value:function(){return new St((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new St(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new St(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(u){var _=St.convert(u),b=_.lng,q=_.lat,de=this.sw.lat<=q&&q<=this.ne.lat,ct=this.sw.lng<=b&&b<=this.ne.lng;return this.sw.lng>this.ne.lng&&(ct=this.sw.lng>=b&&b>=this.ne.lng),de&&ct}}],[{key:"convert",value:function(u){return u instanceof R?u:new R(u)}}]),R}(),Or=function(){function R(m,u){ei(this,R),Gt(this,"x",void 0),Gt(this,"y",void 0),this.x=m,this.y=u}return ra(R,[{key:"clone",value:function(){return new R(this.x,this.y)}},{key:"_add",value:function(u){return this.x+=u.x,this.y+=u.y,this}},{key:"add",value:function(u){return this.clone()._add(u)}},{key:"_sub",value:function(u){return this.x-=u.x,this.y-=u.y,this}},{key:"sub",value:function(u){return this.clone()._sub(u)}},{key:"_multByPoint",value:function(u){return this.x*=u.x,this.y*=u.y,this}},{key:"multByPoint",value:function(u){return this.clone()._multByPoint(u)}},{key:"_divByPoint",value:function(u){return this.x/=u.x,this.y/=u.y,this}},{key:"divByPoint",value:function(u){return this.clone()._divByPoint(u)}},{key:"_mult",value:function(u){return this.x*=u,this.y*=u,this}},{key:"mult",value:function(u){return this.clone()._mult(u)}},{key:"_div",value:function(u){return this.x/=u,this.y/=u,this}},{key:"div",value:function(u){return this.clone()._div(u)}},{key:"_rotate",value:function(u){var _=Math.cos(u),b=Math.sin(u),q=_*this.x-b*this.y,de=b*this.x+_*this.y;return this.x=q,this.y=de,this}},{key:"rotate",value:function(u){return this.clone()._rotate(u)}},{key:"_rotateAround",value:function(u,_){var b=Math.cos(u),q=Math.sin(u),de=_.x+b*(this.x-_.x)-q*(this.y-_.y),ct=_.y+q*(this.x-_.x)+b*(this.y-_.y);return this.x=de,this.y=ct,this}},{key:"roateAround",value:function(u,_){return this.clone()._rotateAround(u,_)}},{key:"_matMult",value:function(u){var _=u[0]*this.x+u[1]*this.y,b=u[2]*this.x+u[3]*this.y;return this.x=_,this.y=b,this}},{key:"matMult",value:function(u){return this.clone()._matMult(u)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var u=this.y;return this.y=this.x,this.x=-u,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(u){return this.x===u.x&&this.y===u.y}},{key:"dist",value:function(u){return Math.sqrt(this.distSqr(u))}},{key:"distSqr",value:function(u){var _=u.x-this.x,b=u.y-this.y;return _*_+b*b}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(u){return Math.atan2(this.y-u.y,this.x-u.x)}},{key:"angleWith",value:function(u){return this.angleWithSep(u.x,u.y)}},{key:"angleWithSep",value:function(u,_){return Math.atan2(this.x*_-this.y*u,this.x*u+this.y*_)}}],[{key:"convert",value:function(u){return u instanceof R?u:Array.isArray(u)?new R(u[0],u[1]):u}}]),R}(),$n=y(49685);function Gi(){var R=new $n.WT(4);return $n.WT!=Float32Array&&(R[1]=0,R[2]=0),R[0]=1,R[3]=1,R}function to(R){var m=new glMatrix.ARRAY_TYPE(4);return m[0]=R[0],m[1]=R[1],m[2]=R[2],m[3]=R[3],m}function Je(R,m){return R[0]=m[0],R[1]=m[1],R[2]=m[2],R[3]=m[3],R}function It(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=1,R}function Ot(R,m,u,_){var b=new glMatrix.ARRAY_TYPE(4);return b[0]=R,b[1]=m,b[2]=u,b[3]=_,b}function Xt(R,m,u,_,b){return R[0]=m,R[1]=u,R[2]=_,R[3]=b,R}function Dr(R,m){if(R===m){var u=m[1];R[1]=m[2],R[2]=u}else R[0]=m[0],R[1]=m[2],R[2]=m[1],R[3]=m[3];return R}function Lr(R,m){var u=m[0],_=m[1],b=m[2],q=m[3],de=u*q-b*_;return de?(de=1/de,R[0]=q*de,R[1]=-_*de,R[2]=-b*de,R[3]=u*de,R):null}function _n(R,m){var u=m[0];return R[0]=m[3],R[1]=-m[1],R[2]=-m[2],R[3]=u,R}function Un(R){return R[0]*R[3]-R[2]*R[1]}function mn(R,m,u){var _=m[0],b=m[1],q=m[2],de=m[3],ct=u[0],st=u[1],Mt=u[2],Ir=u[3];return R[0]=_*ct+q*st,R[1]=b*ct+de*st,R[2]=_*Mt+q*Ir,R[3]=b*Mt+de*Ir,R}function mi(R,m,u){var _=m[0],b=m[1],q=m[2],de=m[3],ct=Math.sin(u),st=Math.cos(u);return R[0]=_*st+q*ct,R[1]=b*st+de*ct,R[2]=_*-ct+q*st,R[3]=b*-ct+de*st,R}function Oa(R,m,u){var _=m[0],b=m[1],q=m[2],de=m[3],ct=u[0],st=u[1];return R[0]=_*ct,R[1]=b*ct,R[2]=q*st,R[3]=de*st,R}function Fn(R,m){var u=Math.sin(m),_=Math.cos(m);return R[0]=_,R[1]=u,R[2]=-u,R[3]=_,R}function ci(R,m){return R[0]=m[0],R[1]=0,R[2]=0,R[3]=m[1],R}function ia(R){return"mat2("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+")"}function _a(R){return Math.hypot(R[0],R[1],R[2],R[3])}function ao(R,m,u,_){return R[2]=_[2]/_[0],u[0]=_[0],u[1]=_[1],u[3]=_[3]-R[2]*u[1],[R,m,u]}function Yo(R,m,u){return R[0]=m[0]+u[0],R[1]=m[1]+u[1],R[2]=m[2]+u[2],R[3]=m[3]+u[3],R}function Vo(R,m,u){return R[0]=m[0]-u[0],R[1]=m[1]-u[1],R[2]=m[2]-u[2],R[3]=m[3]-u[3],R}function Bo(R,m){return R[0]===m[0]&&R[1]===m[1]&&R[2]===m[2]&&R[3]===m[3]}function mo(R,m){var u=R[0],_=R[1],b=R[2],q=R[3],de=m[0],ct=m[1],st=m[2],Mt=m[3];return Math.abs(u-de)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(de))&&Math.abs(_-ct)<=glMatrix.EPSILON*Math.max(1,Math.abs(_),Math.abs(ct))&&Math.abs(b-st)<=glMatrix.EPSILON*Math.max(1,Math.abs(b),Math.abs(st))&&Math.abs(q-Mt)<=glMatrix.EPSILON*Math.max(1,Math.abs(q),Math.abs(Mt))}function Do(R,m,u){return R[0]=m[0]*u,R[1]=m[1]*u,R[2]=m[2]*u,R[3]=m[3]*u,R}function ps(R,m,u,_){return R[0]=m[0]+u[0]*_,R[1]=m[1]+u[1]*_,R[2]=m[2]+u[2]*_,R[3]=m[3]+u[3]*_,R}var g=null,U=null,he=y(98333),te=function(){function R(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(ei(this,R),Gt(this,"top",void 0),Gt(this,"bottom",void 0),Gt(this,"left",void 0),Gt(this,"right",void 0),isNaN(m)||m<0||isNaN(u)||u<0||isNaN(_)||_<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=m,this.bottom=u,this.left=_,this.right=b}return ra(R,[{key:"interpolate",value:function(u,_,b){return _.top!=null&&u.top!=null&&(this.top=Ao(u.top,_.top,b)),_.bottom!=null&&u.bottom!=null&&(this.bottom=Ao(u.bottom,_.bottom,b)),_.left!=null&&u.left!=null&&(this.left=Ao(u.left,_.left,b)),_.right!=null&&u.right!=null&&(this.right=Ao(u.right,_.right,b)),this}},{key:"getCenter",value:function(u,_){var b=Qs((this.left+u-this.right)/2,0,u),q=Qs((this.top+_-this.bottom)/2,0,_);return new Or(b,q)}},{key:"equals",value:function(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}},{key:"clone",value:function(){return new R(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),R}(),tt=2*Math.PI*ft;function Pt(R){return tt*Math.cos(R*Math.PI/180)}function fr(R){return(180+R)/360}function Fr(R){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+R*Math.PI/360)))/360}function zr(R,m){return R/Pt(m)}function En(R){return R*360-180}function Dn(R){var m=180-R*360;return 360/Math.PI*Math.atan(Math.exp(m*Math.PI/180))-90}function na(R,m){return R*Pt(Dn(m))}function ka(R){return 1/Math.cos(R*Math.PI/180)}var ha=function(){function R(m,u){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;ei(this,R),Gt(this,"x",void 0),Gt(this,"y",void 0),Gt(this,"z",void 0),this.x=+m,this.y=+u,this.z=+_}return ra(R,[{key:"toLngLat",value:function(){return new St(En(this.x),Dn(this.y))}},{key:"toAltitude",value:function(){return na(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/tt*ka(Dn(this.y))}}],[{key:"fromLngLat",value:function(u){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=St.convert(u);return new R(fr(b.lng),Fr(b.lat),zr(_,b.lat))}}]),R}();function Fa(R,m){var u=typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(!u){if(Array.isArray(R)||(u=Mo(R))||m&&R&&typeof R.length=="number"){u&&(R=u);var _=0,b=function(){};return{s:b,n:function(){return _>=R.length?{done:!0}:{done:!1,value:R[_++]}},e:function(Mt){throw Mt},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,de=!1,ct;return{s:function(){u=u.call(R)},n:function(){var Mt=u.next();return q=Mt.done,Mt},e:function(Mt){de=!0,ct=Mt},f:function(){try{!q&&u.return!=null&&u.return()}finally{if(de)throw ct}}}}function Mo(R,m){if(!!R){if(typeof R=="string")return Po(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return Po(R,m)}}function Po(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}var go=8192,fu=function(){function R(m,u,_,b,q){ei(this,R),Gt(this,"tileSize",void 0),Gt(this,"tileZoom",void 0),Gt(this,"lngRange",void 0),Gt(this,"latRange",void 0),Gt(this,"maxValidLatitude",void 0),Gt(this,"scale",void 0),Gt(this,"width",void 0),Gt(this,"height",void 0),Gt(this,"angle",void 0),Gt(this,"rotationMatrix",void 0),Gt(this,"pixelsToGLUnits",void 0),Gt(this,"cameraToCenterDistance",void 0),Gt(this,"mercatorMatrix",void 0),Gt(this,"projMatrix",void 0),Gt(this,"invProjMatrix",void 0),Gt(this,"alignedProjMatrix",void 0),Gt(this,"pixelMatrix",void 0),Gt(this,"pixelMatrixInverse",void 0),Gt(this,"glCoordMatrix",void 0),Gt(this,"labelPlaneMatrix",void 0),Gt(this,"_fov",void 0),Gt(this,"_pitch",void 0),Gt(this,"_zoom",void 0),Gt(this,"_renderWorldCopies",void 0),Gt(this,"_minZoom",void 0),Gt(this,"_maxZoom",void 0),Gt(this,"_minPitch",void 0),Gt(this,"_maxPitch",void 0),Gt(this,"_center",void 0),Gt(this,"zoomFraction",void 0),Gt(this,"unmodified",void 0),Gt(this,"edgeInsets",void 0),Gt(this,"constraining",void 0),Gt(this,"posMatrixCache",void 0),Gt(this,"alignedPosMatrixCache",void 0),this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=q===void 0?!0:q,this._minZoom=m||0,this._maxZoom=u||22,this._minPitch=_==null?0:_,this._maxPitch=b==null?60:b,this.setMaxBounds(),this.width=0,this.height=0,this._center=new St(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new te,this.posMatrixCache={},this.alignedPosMatrixCache={}}return ra(R,[{key:"minZoom",get:function(){return this._minZoom},set:function(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}},{key:"minPitch",get:function(){return this._minPitch},set:function(u){this._minPitch!==u&&(this._minPitch=u,this._pitch=Math.max(this._pitch,u))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(u){this._maxPitch!==u&&(this._maxPitch=u,this._pitch=Math.min(this._pitch,u))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Or(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(u){var _=-uo(u,-180,180)*Math.PI/180;this.angle!==_&&(this.unmodified=!1,this.angle=_,this.calcMatrices(),this.rotationMatrix=Gi(),mi(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(u){var _=Qs(u,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==_&&(this.unmodified=!1,this._pitch=_,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this.unmodified=!1,this._fov=u/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(u){var _=Math.min(Math.max(u,this._minZoom),this._maxZoom);this._zoom!==_&&(this.unmodified=!1,this._zoom=_,this.scale=this.zoomScale(_),this.tileZoom=Math.floor(_),this.zoomFraction=_-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this.unmodified=!1,this._center=u,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(u){this.edgeInsets.equals(u)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,u,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}},{key:"clone",value:function(){var u=new R(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return u.tileSize=this.tileSize,u.latRange=this.latRange,u.width=this.width,u.height=this.height,u.center=this._center,u.zoom=this.zoom,u.angle=this.angle,u.fov=this._fov,u.pitch=this._pitch,u.unmodified=this.unmodified,u.edgeInsets=this.edgeInsets.clone(),u.calcMatrices(),u}},{key:"isPaddingEqual",value:function(u){return this.edgeInsets.equals(u)}},{key:"interpolatePadding",value:function(u,_,b){this.unmodified=!1,this.edgeInsets.interpolate(u,_,b),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(u){var _=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,_)}},{key:"resize",value:function(u,_){this.width=u,this.height=_,this.pixelsToGLUnits=[2/u,-2/_],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(u){return Math.pow(2,u)}},{key:"scaleZoom",value:function(u){return Math.log(u)/Math.LN2}},{key:"project",value:function(u){var _=Qs(u.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Or(fr(u.lng)*this.worldSize,Fr(_)*this.worldSize)}},{key:"unproject",value:function(u){return new ha(u.x/this.worldSize,u.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(u,_){var b=this.pointCoordinate(_),q=this.pointCoordinate(this.centerPoint),de=this.locationCoordinate(u),ct=new ha(de.x-(b.x-q.x),de.y-(b.y-q.y));this.center=this.coordinateLocation(ct),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(u){var _=0,b=new Float64Array([u.x,u.y,0,1]),q=new Float64Array([u.x,u.y,1,1]);he.fF(b,b,this.pixelMatrixInverse),he.fF(q,q,this.pixelMatrixInverse);var de=b[3],ct=q[3],st=b[0]/de,Mt=q[0]/ct,Ir=b[1]/de,Gr=q[1]/ct,xn=b[2]/de,gn=q[2]/ct,Sn=xn===gn?0:(_-xn)/(gn-xn);return new ha(Ao(st,Mt,Sn)/this.worldSize,Ao(Ir,Gr,Sn)/this.worldSize)}},{key:"getBounds",value:function(){return new _r().extend(this.pointLocation(new Or(0,0))).extend(this.pointLocation(new Or(this.width,0))).extend(this.pointLocation(new Or(this.width,this.height))).extend(this.pointLocation(new Or(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new _r([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(u){u?(this.lngRange=[u.getWest(),u.getEast()],this.latRange=[u.getSouth(),u.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var u=this.pointCoordinate(new Or(0,0)),_=new Float32Array([u.x*this.worldSize,u.y*this.worldSize,0,1]),b=he.fF(_,_,this.pixelMatrix);return b[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var u=this._pitch,_=Math.tan(u)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Or(0,_))}},{key:"getCameraQueryGeometry",value:function(u){var _=this.getCameraPoint();if(u.length===1)return[u[0],_];var b=_.x,q=_.y,de=_.x,ct=_.y,st=Fa(u),Mt;try{for(st.s();!(Mt=st.n()).done;){var Ir=Mt.value;b=Math.min(b,Ir.x),q=Math.min(q,Ir.y),de=Math.max(de,Ir.x),ct=Math.max(ct,Ir.y)}}catch(Gr){st.e(Gr)}finally{st.f()}return[new Or(b,q),new Or(de,q),new Or(de,ct),new Or(b,ct),new Or(b,q)]}},{key:"coordinatePoint",value:function(u){var _=he.al(u.x*this.worldSize,u.y*this.worldSize,0,1);return he.fF(_,_,this.pixelMatrix),new Or(_[0]/_[3],_[1]/_[3])}},{key:"locationPoint",value:function(u){return this.coordinatePoint(this.locationCoordinate(u))}},{key:"pointLocation",value:function(u){return this.coordinateLocation(this.pointCoordinate(u))}},{key:"locationCoordinate",value:function(u){return ha.fromLngLat(u)}},{key:"coordinateLocation",value:function(u){return u.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var u=-90,_=90,b=-180,q=180,de,ct,st,Mt,Ir=this.size,Gr=this.unmodified;if(this.latRange){var xn=this.latRange;u=Fr(xn[1])*this.worldSize,_=Fr(xn[0])*this.worldSize,de=_-u<Ir.y?Ir.y/(_-u):0}if(this.lngRange){var gn=this.lngRange;b=fr(gn[0])*this.worldSize,q=fr(gn[1])*this.worldSize,ct=q-b<Ir.x?Ir.x/(q-b):0}var Sn=this.point,Wn=Math.max(ct||0,de||0);if(Wn){this.center=this.unproject(new Or(ct?(q+b)/2:Sn.x,de?(_+u)/2:Sn.y)),vr.isMini?this.zoom=Math.max(this.zoom,Math.max(-1,this.minZoom)):this.zoom+=this.scaleZoom(Wn),this.unmodified=Gr,this.constraining=!1;return}if(this.latRange){var bi=Sn.y,pa=Ir.y/2;bi-pa<u&&(Mt=u+pa),bi+pa>_&&(Mt=_-pa)}if(this.lngRange){var Wa=Sn.x,Qa=Ir.x/2;Wa-Qa<b&&(st=b+Qa),Wa+Qa>q&&(st=q-Qa)}(st!==void 0||Mt!==void 0)&&(this.center=this.unproject(new Or(st!==void 0?st:Sn.x,Mt!==void 0?Mt:Sn.y))),this.unmodified=Gr,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(!!this.height){var u=this._fov/2,_=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(u)*this.height;var b=Math.PI/2+this._pitch,q=this._fov*(.5+_.y/this.height),de=Math.sin(q)*this.cameraToCenterDistance/Math.sin(Qs(Math.PI-b-q,.01,Math.PI-.01)),ct=this.point,st=ct.x,Mt=ct.y,Ir=Math.cos(Math.PI/2-this._pitch)*de+this.cameraToCenterDistance,Gr=Ir*1.01,xn=this.height/50,gn=new Float64Array(16);jr.perspective(gn,this._fov,this.width/this.height,xn,Gr),gn[8]=-_.x*2/this.width,gn[9]=_.y*2/this.height,jr.scale(gn,gn,[1,-1,1]),jr.translate(gn,gn,[0,0,-this.cameraToCenterDistance]),jr.rotateX(gn,gn,this._pitch),jr.rotateZ(gn,gn,this.angle),jr.translate(gn,gn,[-st,-Mt,0]),this.mercatorMatrix=jr.scale([],gn,[this.worldSize,this.worldSize,this.worldSize]),jr.scale(gn,gn,[1,1,zr(1,this.center.lat)*this.worldSize,1]),this.projMatrix=gn,this.invProjMatrix=jr.invert([],this.projMatrix);var Sn=this.width%2/2,Wn=this.height%2/2,bi=Math.cos(this.angle),pa=Math.sin(this.angle),Wa=st-Math.round(st)+bi*Sn+pa*Wn,Qa=Mt-Math.round(Mt)+bi*Wn+pa*Sn,ro=new Float64Array(gn);if(jr.translate(ro,ro,[Wa>.5?Wa-1:Wa,Qa>.5?Qa-1:Qa,0]),this.alignedProjMatrix=ro,gn=jr.create(),jr.scale(gn,gn,[this.width/2,-this.height/2,1]),jr.translate(gn,gn,[1,-1,0]),this.labelPlaneMatrix=gn,gn=jr.create(),jr.scale(gn,gn,[1,-1,1]),jr.translate(gn,gn,[-1,-1,0]),jr.scale(gn,gn,[2/this.width,2/this.height,1]),this.glCoordMatrix=gn,this.pixelMatrix=jr.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),gn=jr.invert(new Float64Array(16),this.pixelMatrix),!gn)throw new Error("failed to invert matrix");this.pixelMatrixInverse=gn,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),R}(),yo=ra(function R(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ei(this,R),Gt(this,"type",void 0),Qi()(this,u),this.type=m});function Zu(R){var m=tc();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function tc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var ws=function(R){ba(u,R);var m=Zu(u);function u(_){var b;ei(this,u),b=m.call(this),Gt(Rn(b),"transform",void 0),Gt(Rn(b),"options",void 0),Gt(Rn(b),"moving",void 0),Gt(Rn(b),"zooming",void 0),Gt(Rn(b),"rotating",void 0),Gt(Rn(b),"pitching",void 0),Gt(Rn(b),"padding",void 0),Gt(Rn(b),"bearingSnap",void 0),Gt(Rn(b),"easeEndTimeoutID",void 0),Gt(Rn(b),"easeStart",void 0),Gt(Rn(b),"easeOptions",void 0),Gt(Rn(b),"easeId",void 0),Gt(Rn(b),"onEaseFrame",void 0),Gt(Rn(b),"onEaseEnd",void 0),Gt(Rn(b),"easeFrameId",void 0),Gt(Rn(b),"pitchEnabled",void 0),Gt(Rn(b),"rotateEnabled",void 0),Gt(Rn(b),"renderFrameCallback",function(){var Ir=Math.min((Ro()-b.easeStart)/b.easeOptions.duration,1);b.onEaseFrame(b.easeOptions.easing(Ir)),Ir<1?b.easeFrameId=b.requestRenderFrame(b.renderFrameCallback):b.stop()}),b.options=_;var q=_.minZoom,de=_.maxZoom,ct=_.minPitch,st=_.maxPitch,Mt=_.renderWorldCopies;return b.moving=!1,b.zooming=!1,b.bearingSnap=_.bearingSnap,b.pitchEnabled=_.pitchEnabled,b.rotateEnabled=_.rotateEnabled,b.transform=new fu(q,de,ct,st,Mt),b}return ra(u,[{key:"requestRenderFrame",value:function(b){return 0}},{key:"cancelRenderFrame",value:function(b){}},{key:"getCenter",value:function(){var b=this.transform.center,q=b.lng,de=b.lat;return new St(q,de)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(b,q){return this.jumpTo({center:b},q)}},{key:"setPitch",value:function(b,q){return this.jumpTo({pitch:b},q),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(b,q,de){return this.easeTo(Qi()({center:b},q),de)}},{key:"zoomOut",value:function(b,q){return this.zoomTo(this.getZoom()-1,b,q),this}},{key:"setBearing",value:function(b,q){return this.jumpTo({bearing:b},q),this}},{key:"setZoom",value:function(b,q){return this.jumpTo({zoom:b},q),this}},{key:"zoomIn",value:function(b,q){return this.zoomTo(this.getZoom()+1,b,q),this}},{key:"zoomTo",value:function(b,q,de){return this.easeTo(Qi()({zoom:b},q),de)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(b,q){return this.jumpTo({padding:b},q),this}},{key:"rotateTo",value:function(b,q,de){return this.easeTo(Qi()({bearing:b},q),de)}},{key:"resetNorth",value:function(b,q){return this.rotateTo(0,Qi()({duration:1e3},b),q),this}},{key:"resetNorthPitch",value:function(b,q){return this.easeTo(Qi()({bearing:0,pitch:0,duration:1e3},b),q),this}},{key:"fitBounds",value:function(b,q,de){return this.fitInternal(this.cameraForBounds(b,q),q,de)}},{key:"cameraForBounds",value:function(b,q){return b=_r.convert(b),this.cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),0,q)}},{key:"snapToNorth",value:function(b,q){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(b,q):this}},{key:"jumpTo",value:function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=arguments.length>1?arguments[1]:void 0;this.stop();var de=this.transform,ct=!1,st=!1,Mt=!1;return b.zoom&&de.zoom!==+b.zoom&&(ct=!0,de.zoom=+b.zoom),b.center!==void 0&&(de.center=St.convert(b.center)),b.bearing&&de.bearing!==+b.bearing&&(st=!0,de.bearing=+b.bearing),b.pitch&&de.pitch!==+b.pitch&&(Mt=!0,de.pitch=+b.pitch),b.padding!=null&&!de.isPaddingEqual(b.padding)&&(de.padding=b.padding),this.emit("movestart",new yo("movestart",q)),this.emit("move",new yo("move",q)),ct&&(this.emit("zoomstart",new yo("zoomstart",q)),this.emit("zoom",new yo("zoom",q)),this.emit("zoomend",new yo("zoomend",q))),st&&(this.emit("rotatestart",new yo("rotatestart",q)),this.emit("rotate",new yo("rotate",q)),this.emit("rotateend",new yo("rotateend",q))),Mt&&(this.emit("pitchstart",new yo("pitchstart",q)),this.emit("pitch",new yo("pitch",q)),this.emit("pitchend",new yo("pitchend",q))),this.emit("moveend",new yo("moveend",q))}},{key:"easeTo",value:function(){var b=this,q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},de=arguments.length>1?arguments[1]:void 0;q=Qi()({offset:[0,0],duration:500,easing:ua},q),(q.animate===!1||!q.essential&&cs())&&(q.duration=0);var ct=this.transform,st=this.getZoom(),Mt=this.getBearing(),Ir=this.getPitch(),Gr=this.getPadding(),xn=q.zoom?+q.zoom:st,gn=q.bearing?this.normalizeBearing(q.bearing,Mt):Mt,Sn=q.pitch?+q.pitch:Ir,Wn=q.padding?q.padding:ct.padding,bi=Or.convert(q.offset),pa=ct.centerPoint.add(bi),Wa=ct.pointLocation(pa),Qa=St.convert(q.center||Wa);this.normalizeCenter(Qa);var ro=ct.project(Wa),Ko=ct.project(Qa).sub(ro),sa=ct.zoomScale(xn-st),_o,xa;q.around&&(_o=St.convert(q.around),xa=ct.locationPoint(_o));var xo={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||xn!==st,this.rotating=this.rotating||Mt!==gn,this.pitching=this.pitching||Sn!==Ir,this.padding=!ct.isPaddingEqual(Wn),this.easeId=q.easeId,this.prepareEase(de,q.noMoveStart,xo),clearTimeout(this.easeEndTimeoutID),this.ease(function(ds){if(b.zooming&&(ct.zoom=Ao(st,xn,ds)),b.rotating&&b.rotateEnabled&&(ct.bearing=Ao(Mt,gn,ds)),b.pitching&&b.pitchEnabled&&(ct.pitch=Ao(Ir,Sn,ds)),b.padding&&(ct.interpolatePadding(Gr,Wn,ds),pa=ct.centerPoint.add(bi)),_o)ct.setLocationAtPoint(_o,xa);else{var ru=ct.zoomScale(ct.zoom-st),Rc=xn>st?Math.min(2,sa):Math.max(.5,sa),mc=Math.pow(Rc,1-ds),vl=ct.unproject(ro.add(Ko.mult(ds*mc)).mult(ru));ct.setLocationAtPoint(ct.renderWorldCopies?vl.wrap():vl,pa)}b.fireMoveEvents(de)},function(ds){b.afterEase(de,ds)},q),this}},{key:"flyTo",value:function(){var b=this,q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},de=arguments.length>1?arguments[1]:void 0;if(!q.essential&&cs()){var ct=Ds(q,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ct,de)}this.stop(),q=Qi()({offset:[0,0],speed:1.2,curve:1.42,easing:ua},q);var st=this.transform,Mt=this.getZoom(),Ir=this.getBearing(),Gr=this.getPitch(),xn=this.getPadding(),gn=q.zoom?Qs(+q.zoom,st.minZoom,st.maxZoom):Mt,Sn=q.bearing?this.normalizeBearing(q.bearing,Ir):Ir,Wn=q.pitch?+q.pitch:Gr,bi="padding"in q?q.padding:st.padding,pa=st.zoomScale(gn-Mt),Wa=Or.convert(q.offset),Qa=st.centerPoint.add(Wa),ro=st.pointLocation(Qa),Ko=St.convert(q.center||ro);this.normalizeCenter(Ko);var sa=st.project(ro),_o=st.project(Ko).sub(sa),xa=q.curve,xo=Math.max(st.width,st.height),ds=xo/pa,ru=_o.mag();if("minZoom"in q){var Rc=Qs(Math.min(q.minZoom,Mt,gn),st.minZoom,st.maxZoom),mc=xo/st.zoomScale(Rc-Mt);xa=Math.sqrt(mc/ru*2)}var vl=xa*xa;function Jf(Ys){var gc=(ds*ds-xo*xo+(Ys?-1:1)*vl*vl*ru*ru)/(2*(Ys?ds:xo)*vl*ru);return Math.log(Math.sqrt(gc*gc+1)-gc)}function Vh(Ys){return(Math.exp(Ys)-Math.exp(-Ys))/2}function Lh(Ys){return(Math.exp(Ys)+Math.exp(-Ys))/2}function fh(Ys){return Vh(Ys)/Lh(Ys)}var eh=Jf(0),Eh=function(gc){return Lh(eh)/Lh(eh+xa*gc)},Ns=function(gc){return xo*((Lh(eh)*fh(eh+xa*gc)-Vh(eh))/vl)/ru},ki=(Jf(1)-eh)/xa;if(Math.abs(ru)<1e-6||!isFinite(ki)){if(Math.abs(xo-ds)<1e-6)return this.easeTo(q,de);var Oh=ds<xo?-1:1;ki=Math.abs(Math.log(ds/xo))/xa,Ns=function(){return 0},Eh=function(gc){return Math.exp(Oh*xa*gc)}}if("duration"in q)q.duration=+q.duration;else{var Dc="screenSpeed"in q?+q.screenSpeed/xa:+q.speed;q.duration=1e3*ki/Dc}return q.maxDuration&&q.duration>q.maxDuration&&(q.duration=0),this.zooming=!0,this.rotating=Ir!==Sn,this.pitching=Wn!==Gr,this.padding=!st.isPaddingEqual(bi),this.prepareEase(de,!1),this.ease(function(Ys){var gc=Ys*ki,Hh=1/Eh(gc);st.zoom=Ys===1?gn:Mt+st.scaleZoom(Hh),b.rotating&&(st.bearing=Ao(Ir,Sn,Ys)),b.pitching&&(st.pitch=Ao(Gr,Wn,Ys)),b.padding&&(st.interpolatePadding(xn,bi,Ys),Qa=st.centerPoint.add(Wa));var ge=Ys===1?Ko:st.unproject(sa.add(_o.mult(Ns(gc))).mult(Hh));st.setLocationAtPoint(st.renderWorldCopies?ge.wrap():ge,Qa),b.fireMoveEvents(de)},function(){return b.afterEase(de)},q),this}},{key:"fitScreenCoordinates",value:function(b,q,de,ct,st){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Or.convert(b)),this.transform.pointLocation(Or.convert(q)),de,ct),ct,st)}},{key:"stop",value:function(b,q){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var de=this.onEaseEnd;delete this.onEaseEnd,de.call(this,q)}return this}},{key:"normalizeBearing",value:function(b,q){b=uo(b,-180,180);var de=Math.abs(b-q);return Math.abs(b-360-q)<de&&(b-=360),Math.abs(b+360-q)<de&&(b+=360),b}},{key:"normalizeCenter",value:function(b){var q=this.transform;if(!(!q.renderWorldCopies||q.lngRange)){var de=b.lng-q.center.lng;b.lng+=de>180?-360:de<-180?360:0}}},{key:"fireMoveEvents",value:function(b){this.emit("move",new yo("move",b)),this.zooming&&this.emit("zoom",new yo("zoom",b)),this.rotating&&this.emit("rotate",new yo("rotate",b)),this.pitching&&this.emit("rotate",new yo("pitch",b))}},{key:"prepareEase",value:function(b){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!q&&!de.moving&&this.emit("movestart",new yo("movestart",b)),this.zooming&&!de.zooming&&this.emit("zoomstart",new yo("zoomstart",b)),this.rotating&&!de.rotating&&this.emit("rotatestart",new yo("rotatestart",b)),this.pitching&&!de.pitching&&this.emit("pitchstart",new yo("pitchstart",b))}},{key:"afterEase",value:function(b,q){if(!(this.easeId&&q&&this.easeId===q)){delete this.easeId;var de=this.zooming,ct=this.rotating,st=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,de&&this.emit("zoomend",new yo("zoomend",b)),ct&&this.emit("rotateend",new yo("rotateend",b)),st&&this.emit("pitchend",new yo("pitchend",b)),this.emit("moveend",new yo("moveend",b))}}},{key:"ease",value:function(b,q,de){de.animate===!1||de.duration===0?(b(1),q()):(this.easeStart=Ro(),this.easeOptions=de,this.onEaseFrame=b,this.onEaseEnd=q,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(b,q,de,ct){var st={top:0,bottom:0,right:0,left:0};if(ct=Qi()({padding:st,offset:[0,0],maxZoom:this.transform.maxZoom},ct),typeof ct.padding=="number"){var Mt=ct.padding;ct.padding={top:Mt,bottom:Mt,right:Mt,left:Mt}}ct.padding=Qi()(st,ct.padding);var Ir=this.transform,Gr=Ir.padding,xn=Ir.project(St.convert(b)),gn=Ir.project(St.convert(q)),Sn=xn.rotate(-de*Math.PI/180),Wn=gn.rotate(-de*Math.PI/180),bi=new Or(Math.max(Sn.x,Wn.x),Math.max(Sn.y,Wn.y)),pa=new Or(Math.min(Sn.x,Wn.x),Math.min(Sn.y,Wn.y)),Wa=bi.sub(pa),Qa=(Ir.width-(Gr.left+Gr.right+ct.padding.left+ct.padding.right))/Wa.x,ro=(Ir.height-(Gr.top+Gr.bottom+ct.padding.top+ct.padding.bottom))/Wa.y;if(!(ro<0||Qa<0)){var Ko=Math.min(Ir.scaleZoom(Ir.scale*Math.min(Qa,ro)),ct.maxZoom),sa=Or.convert(ct.offset),_o=(ct.padding.left-ct.padding.right)/2,xa=(ct.padding.top-ct.padding.bottom)/2,xo=new Or(sa.x+_o,sa.y+xa),ds=xo.mult(Ir.scale/Ir.zoomScale(Ko)),ru=Ir.unproject(xn.add(gn).div(2).sub(ds));return{center:ru,zoom:Ko,bearing:de}}}},{key:"fitInternal",value:function(b,q,de){return b?(q=Qi()(b,q),delete q.padding,q.linear?this.easeTo(q,de):this.flyTo(q,de)):this}}]),u}(So.EventEmitter);function Nc(R){if(Array.isArray(R))return R}function $u(R,m){var u=R==null?null:typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(u!=null){var _=[],b=!0,q=!1,de,ct;try{for(u=u.call(R);!(b=(de=u.next()).done)&&(_.push(de.value),!(m&&_.length===m));b=!0);}catch(st){q=!0,ct=st}finally{try{!b&&u.return!=null&&u.return()}finally{if(q)throw ct}}return _}}function Ku(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}function xl(R,m){if(!!R){if(typeof R=="string")return Ku(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return Ku(R,m)}}function qo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rc(R,m){return Nc(R)||$u(R,m)||xl(R,m)||qo()}function Ec(R,m){var u=typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(!u){if(Array.isArray(R)||(u=Va(R))||m&&R&&typeof R.length=="number"){u&&(R=u);var _=0,b=function(){};return{s:b,n:function(){return _>=R.length?{done:!0}:{done:!1,value:R[_++]}},e:function(Mt){throw Mt},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,de=!1,ct;return{s:function(){u=u.call(R)},n:function(){var Mt=u.next();return q=Mt.done,Mt},e:function(Mt){de=!0,ct=Mt},f:function(){try{!q&&u.return!=null&&u.return()}finally{if(de)throw ct}}}}function Va(R,m){if(!!R){if(typeof R=="string")return qu(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return qu(R,m)}}function qu(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}var ys={},ss=ys;ys.create=function(R,m,u){var _=vr.$window.document.createElement(R);return m!==void 0&&(_.className=m),u&&u.appendChild(_),_},ys.createNS=function(R,m){var u=vr.$window.document.createElementNS(R,m);return u};var bl=vr.$window.document&&vr.$window.document.documentElement.style;function El(R){if(!bl)return R[0];var m=Ec(R),u;try{for(m.s();!(u=m.n()).done;){var _=u.value;if(_ in bl)return _}}catch(b){m.e(b)}finally{m.f()}return R[0]}var To=El(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Ps;ys.disableDrag=function(){bl&&To&&(Ps=bl[To],bl[To]="none")},ys.enableDrag=function(){bl&&To&&(bl[To]=Ps)};var hf=El(["transform","WebkitTransform"]);ys.setTransform=function(R,m){R.style[hf]=m};var ju=!1;try{var zc=Object.defineProperty({},"passive",{get:function(){ju=!0}});vr.$window.addEventListener("test",zc,zc),vr.$window.removeEventListener("test",zc,zc)}catch(R){ju=!1}ys.addEventListener=function(R,m,u){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in _&&ju?R.addEventListener(m,u,_):R.addEventListener(m,u,_.capture)},ys.removeEventListener=function(R,m,u){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in _&&ju?R.removeEventListener(m,u,_):R.removeEventListener(m,u,_.capture)};var Uc=function R(m){m.preventDefault(),m.stopPropagation(),vr.$window.removeEventListener("click",R,!0)};ys.suppressClick=function(){vr.isMini||(vr.$window.addEventListener("click",Uc,!0),setTimeout(function(){vr.$window.removeEventListener("click",Uc,!0)},0))},ys.mousePos=function(R,m){if(vr.isMini)return new Or(m.clientX-R.left-0,m.clientY-R.top-0);var u=R.getBoundingClientRect();return new Or(m.clientX-u.left-R.clientLeft,m.clientY-u.top-R.clientTop)},ys.touchPos=function(R,m){if(vr.isMini){var ct=[],st=Ec(m),Mt;try{for(st.s();!(Mt=st.n()).done;){var Ir=Mt.value;ct.push(new Or(Ir.clientX-R.left,Ir.clientY-R.top))}}catch(Gr){st.e(Gr)}finally{st.f()}return ct}else{var u=R.getBoundingClientRect(),_=[],b=Ec(m),q;try{for(b.s();!(q=b.n()).done;){var de=q.value;_.push(new Or(de.clientX-u.left-R.clientLeft,de.clientY-u.top-R.clientTop))}}catch(Gr){b.e(Gr)}finally{b.f()}return _}},ys.mouseButton=function(R){return vr.isMini&&typeof vr.$window.InstallTrigger!="undefined"&&R.button===2&&R.ctrlKey&&vr.$window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:R.button},ys.remove=function(R){R.parentNode&&R.parentNode.removeChild(R)};function Bf(R){var m=Jc();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function Jc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var vu=function(R){ba(u,R);var m=Bf(u);function u(_,b,q){var de,ct=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};ei(this,u);var st=ss.mousePos(b.getCanvasContainer(),q),Mt=b.unproject(st);return de=m.call(this,_,Qi()({point:st,lngLat:Mt,originalEvent:q},ct)),Gt(Rn(de),"type",void 0),Gt(Rn(de),"target",void 0),Gt(Rn(de),"originalEvent",void 0),Gt(Rn(de),"point",void 0),Gt(Rn(de),"lngLat",void 0),Gt(Rn(de),"defaultPrevented",void 0),de.defaultPrevented=!1,de.target=b,de}return ra(u,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),u}(yo);function Ul(R){var m=Qu();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function Qu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var Cu=function(R){ba(u,R);var m=Ul(u);function u(_,b,q){var de;ei(this,u);var ct=_==="touchend"?q.changedTouches:q.touches,st=ss.touchPos(b.getCanvasContainer(),ct),Mt=st.map(function(xn){return b.unproject(xn)}),Ir=st.reduce(function(xn,gn,Sn,Wn){return xn.add(gn.div(Wn.length))},new Or(0,0)),Gr=b.unproject(Ir);return de=m.call(this,_,{points:st,point:Ir,lngLats:Mt,lngLat:Gr,originalEvent:q}),Gt(Rn(de),"type",void 0),Gt(Rn(de),"target",void 0),Gt(Rn(de),"originalEvent",void 0),Gt(Rn(de),"lngLat",void 0),Gt(Rn(de),"point",void 0),Gt(Rn(de),"points",void 0),Gt(Rn(de),"lngLats",void 0),Gt(Rn(de),"defaultPrevented",void 0),de.defaultPrevented=!1,de}return ra(u,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),u}(yo);function Zl(R){var m=nc();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function nc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var ic=function(R){ba(u,R);var m=Zl(u);function u(_,b,q){var de;return ei(this,u),de=m.call(this,_,{originalEvent:q}),Gt(Rn(de),"type",void 0),Gt(Rn(de),"originalEvent",void 0),Gt(Rn(de),"defaultPrevented",void 0),Gt(Rn(de),"target",void 0),de.defaultPrevented=!1,de}return ra(u,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),u}(yo),Gu=function(){function R(m){ei(this,R),Gt(this,"map",void 0),Gt(this,"delayContextMenu",void 0),Gt(this,"contextMenuEvent",void 0),this.map=m}return ra(R,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(u){this.map.emit(u.type,new vu(u.type,this.map,u))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new vu("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(u){this.delayContextMenu?this.contextMenuEvent=u:this.map.emit(u.type,new vu(u.type,this.map,u)),this.map.listeners("contextmenu")&&u.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),R}(),pf=function(){function R(m,u){ei(this,R),Gt(this,"map",void 0),Gt(this,"el",void 0),Gt(this,"container",void 0),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"startPos",void 0),Gt(this,"lastPos",void 0),Gt(this,"box",void 0),Gt(this,"clickTolerance",void 0),this.map=m,this.el=m.getCanvasContainer(),this.container=m.getContainer(),this.clickTolerance=u.clickTolerance||1}return ra(R,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"mousedown",value:function(u,_){!this.isEnabled()||!(u.shiftKey&&u.button===0)||(ss.disableDrag(),this.startPos=this.lastPos=_,this.active=!0)}},{key:"mousemoveWindow",value:function(u,_){if(!!this.active){var b=_;if(!(this.lastPos.equals(b)||!this.box&&b.dist(this.startPos)<this.clickTolerance)){var q=this.startPos;this.lastPos=b,this.box||(this.box=ss.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",u));var de=Math.min(q.x,b.x),ct=Math.max(q.x,b.x),st=Math.min(q.y,b.y),Mt=Math.max(q.y,b.y);ss.setTransform(this.box,"translate(".concat(de,"px,").concat(st,"px)")),this.box&&(this.box.style.width="".concat(ct-de,"px"),this.box.style.height="".concat(Mt-st,"px"))}}}},{key:"mouseupWindow",value:function(u,_){var b=this;if(!!this.active&&u.button===0){var q=this.startPos,de=_;if(this.reset(),ss.suppressClick(),q.x===de.x&&q.y===de.y)this.fireEvent("boxzoomcancel",u);else return this.map.emit("boxzoomend",new yo("boxzoomend",{originalEvent:u})),{cameraAnimation:function(st){return st.fitScreenCoordinates(q,de,b.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(u){!this.active||u.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",u))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(ss.remove(this.box),this.box=null),ss.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(u,_){return this.map.emit(u,new yo(u,{originalEvent:_}))}}]),R}(),Cc=pf,ef=function(){function R(){ei(this,R),Gt(this,"enabled",void 0),Gt(this,"active",void 0),this.reset()}return ra(R,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(u,_){return u.preventDefault(),{cameraAnimation:function(q){q.easeTo({duration:300,zoom:q.getZoom()+(u.shiftKey?-1:1),around:q.unproject(_)},{originalEvent:u})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),R}();function ko(R){var m=Zc();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function Zc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var Su=function(R){ba(u,R);var m=ko(u);function u(){var _;ei(this,u);for(var b=arguments.length,q=new Array(b),de=0;de<b;de++)q[de]=arguments[de];return _=m.call.apply(m,[this].concat(q)),Gt(Rn(_),"type","renderFrame"),Gt(Rn(_),"timeStamp",void 0),_}return ra(u)}(yo);function jl(R,m){var u=typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(!u){if(Array.isArray(R)||(u=cl(R))||m&&R&&typeof R.length=="number"){u&&(R=u);var _=0,b=function(){};return{s:b,n:function(){return _>=R.length?{done:!0}:{done:!1,value:R[_++]}},e:function(Mt){throw Mt},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,de=!1,ct;return{s:function(){u=u.call(R)},n:function(){var Mt=u.next();return q=Mt.done,Mt},e:function(Mt){de=!0,ct=Mt},f:function(){try{!q&&u.return!=null&&u.return()}finally{if(de)throw ct}}}}function cl(R,m){if(!!R){if(typeof R=="string")return tf(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return tf(R,m)}}function tf(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}var Gl={linearity:.3,easing:Ts(0,0,.3,1)},fl=Qi()({deceleration:2500,maxSpeed:1400},Gl),jc=Qi()({deceleration:20,maxSpeed:1400},Gl),Vl=Qi()({deceleration:1e3,maxSpeed:360},Gl),Cl=Qi()({deceleration:1e3,maxSpeed:90},Gl),Nf=function(){function R(m){ei(this,R),Gt(this,"map",void 0),Gt(this,"inertiaBuffer",void 0),this.map=m,this.clear()}return ra(R,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(u){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:Ro(),settings:u})}},{key:"drainInertiaBuffer",value:function(){for(var u=this.inertiaBuffer,_=Ro(),b=160;u.length>0&&_-u[0].time>b;)u.shift()}},{key:"onMoveEnd",value:function(u){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var _={zoom:0,bearing:0,pitch:0,pan:new Or(0,0),pinchAround:void 0,around:void 0},b=jl(this.inertiaBuffer),q;try{for(b.s();!(q=b.n()).done;){var de=q.value.settings;_.zoom+=de.zoomDelta||0,_.bearing+=de.bearingDelta||0,_.pitch+=de.pitchDelta||0,de.panDelta&&_.pan._add(de.panDelta),de.around&&(_.around=de.around),de.pinchAround&&(_.pinchAround=de.pinchAround)}}catch(Wn){b.e(Wn)}finally{b.f()}var ct=this.inertiaBuffer[this.inertiaBuffer.length-1],st=ct.time-this.inertiaBuffer[0].time,Mt={};if(_.pan.mag()){var Ir=le(_.pan.mag(),st,Qi()({},fl,u||{}));Mt.offset=_.pan.mult(Ir.amount/_.pan.mag()),Mt.center=this.map.transform.center,rf(Mt,Ir)}if(_.zoom){var Gr=le(_.zoom,st,jc);Mt.zoom=this.map.transform.zoom+Gr.amount,rf(Mt,Gr)}if(_.bearing){var xn=le(_.bearing,st,Vl);Mt.bearing=this.map.transform.bearing+Qs(xn.amount,-179,179),rf(Mt,xn)}if(_.pitch){var gn=le(_.pitch,st,Cl);Mt.pitch=this.map.transform.pitch+gn.amount,rf(Mt,gn)}if(Mt.zoom||Mt.bearing){var Sn=_.pinchAround===void 0?_.around:_.pinchAround;Mt.around=Sn?this.map.unproject(Sn):this.map.getCenter()}return this.clear(),Qi()(Mt,{noMoveStart:!0})}}}]),R}();function rf(R,m){(!R.duration||R.duration<m.duration)&&(R.duration=m.duration,R.easing=m.easing)}function le(R,m,u){var _=u.maxSpeed,b=u.linearity,q=u.deceleration,de=Qs(R*b/(m/1e3),-_,_),ct=Math.abs(de)/(q*b);return{easing:u.easing,duration:ct*1e3,amount:de*(ct/2)}}var Ve={panStep:100,bearingStep:15,pitchStep:10},_t=function(){function R(){ei(this,R),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"panStep",void 0),Gt(this,"bearingStep",void 0),Gt(this,"pitchStep",void 0);var m=Ve;this.panStep=m.panStep,this.bearingStep=m.bearingStep,this.pitchStep=m.pitchStep}return ra(R,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(u){var _=this;if(!(u.altKey||u.ctrlKey||u.metaKey)){var b=0,q=0,de=0,ct=0,st=0;switch(u.keyCode){case 61:case 107:case 171:case 187:b=1;break;case 189:case 109:case 173:b=-1;break;case 37:u.shiftKey?q=-1:(u.preventDefault(),ct=-1);break;case 39:u.shiftKey?q=1:(u.preventDefault(),ct=1);break;case 38:u.shiftKey?de=1:(u.preventDefault(),st=-1);break;case 40:u.shiftKey?de=-1:(u.preventDefault(),st=1);break;default:return}return{cameraAnimation:function(Ir){var Gr=Ir.getZoom();Ir.easeTo({duration:300,easeId:"keyboardHandler",easing:ut,zoom:b?Math.round(Gr)+b*(u.shiftKey?2:1):Gr,bearing:Ir.getBearing()+q*_.bearingStep,pitch:Ir.getPitch()+de*_.pitchStep,offset:[-ct*_.panStep,-st*_.panStep],center:Ir.getCenter()},{originalEvent:u})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),R}();function ut(R){return R*(2-R)}var Wt=_t,hn=function(){function R(m,u){ei(this,R),Gt(this,"mousedownPos",void 0),Gt(this,"clickTolerance",void 0),Gt(this,"map",void 0),this.map=m,this.clickTolerance=u.clickTolerance}return ra(R,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(u){return this.firePreventable(new ic(u.type,this.map,u))}},{key:"mousedown",value:function(u,_){return this.mousedownPos=_,this.firePreventable(new vu(u.type,this.map,u))}},{key:"mouseup",value:function(u){this.map.emit(u.type,new vu(u.type,this.map,u))}},{key:"click",value:function(u,_){this.mousedownPos&&this.mousedownPos.dist(_)>=this.clickTolerance||this.map.emit(u.type,new vu(u.type,this.map,u))}},{key:"dblclick",value:function(u){return this.firePreventable(new vu(u.type,this.map,u))}},{key:"mouseover",value:function(u){this.map.emit(u.type,new vu(u.type,this.map,u))}},{key:"mouseout",value:function(u){this.map.emit(u.type,new vu(u.type,this.map,u))}},{key:"touchstart",value:function(u){return this.firePreventable(new Cu(u.type,this.map,u))}},{key:"touchmove",value:function(u){this.map.emit(u.type,new Cu(u.type,this.map,u))}},{key:"touchend",value:function(u){this.map.emit(u.type,new Cu(u.type,this.map,u))}},{key:"touchcancel",value:function(u){this.map.emit(u.type,new Cu(u.type,this.map,u))}},{key:"firePreventable",value:function(u){if(this.map.emit(u.type,u),u.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),R}();function Mi(R,m){for(;!Object.prototype.hasOwnProperty.call(R,m)&&(R=ya(R),R!==null););return R}function da(){return typeof Reflect!="undefined"&&Reflect.get?da=Reflect.get:da=function(m,u,_){var b=Mi(m,u);if(!!b){var q=Object.getOwnPropertyDescriptor(b,u);return q.get?q.get.call(arguments.length<3?m:_):q.value}},da.apply(this,arguments)}var oa,za=0,Xo=2,Sc=(oa={},Gt(oa,za,1),Gt(oa,Xo,2),oa);function hl(R,m){var u=Sc[m];return R.buttons===void 0||(R.buttons&u)!==u}var df=function(){function R(m){ei(this,R),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"lastPoint",void 0),Gt(this,"eventButton",void 0),Gt(this,"moved",void 0),Gt(this,"clickTolerance",void 0),this.reset(),this.clickTolerance=m.clickTolerance||1}return ra(R,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(u,_){if(!this.lastPoint){var b=ss.mouseButton(u);!this.correctButton(u,b)||(this.lastPoint=_,this.eventButton=b)}}},{key:"mousemoveWindow",value:function(u,_){var b=this.lastPoint;if(!!b){if(u.preventDefault(),hl(u,this.eventButton)){this.reset();return}if(!(!this.moved&&_.dist(b)<this.clickTolerance))return this.moved=!0,this.lastPoint=_,this.move(b,_)}}},{key:"mouseupWindow",value:function(u){if(!!this.lastPoint){var _=ss.mouseButton(u);_===this.eventButton&&(this.moved&&ss.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(u,_){return!1}},{key:"move",value:function(u,_){}}]),R}();function yh(R){var m=ih();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function ih(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var Hl=function(R){ba(u,R);var m=yh(u);function u(){return ei(this,u),m.apply(this,arguments)}return ra(u,[{key:"mousedown",value:function(b,q){da(ya(u.prototype),"mousedown",this).call(this,b,q),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(b,q){return{around:q,panDelta:q.sub(b)}}},{key:"correctButton",value:function(b,q){return q===za&&!b.ctrlKey}}]),u}(df);function Sl(R){var m=ac();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function ac(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var Vs=function(R){ba(u,R);var m=Sl(u);function u(){return ei(this,u),m.apply(this,arguments)}return ra(u,[{key:"correctButton",value:function(b,q){return q===za&&b.ctrlKey||q===Xo}},{key:"move",value:function(b,q){var de=-.5,ct=(q.y-b.y)*de;if(ct)return this.active=!0,{pitchDelta:ct}}},{key:"contextmenu",value:function(b){b.preventDefault()}}]),u}(df);function Gc(R){var m=vf();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function vf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var Hs=function(R){ba(u,R);var m=Gc(u);function u(){return ei(this,u),m.apply(this,arguments)}return ra(u,[{key:"contextmenu",value:function(b){b.preventDefault()}},{key:"correctButton",value:function(b,q){return q===za&&b.ctrlKey||q===Xo}},{key:"move",value:function(b,q){var de=.8,ct=(q.x-b.x)*de;if(ct)return this.active=!0,{bearingDelta:ct}}}]),u}(df),zi=4.000244140625,ks=1/100,Vc=1/450,nf=2,Ws=function(){function R(m,u){var _=this;ei(this,R),Gt(this,"map",void 0),Gt(this,"el",void 0),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"zooming",void 0),Gt(this,"aroundCenter",void 0),Gt(this,"around",void 0),Gt(this,"aroundPoint",void 0),Gt(this,"type",void 0),Gt(this,"lastValue",void 0),Gt(this,"timeout",void 0),Gt(this,"finishTimeout",void 0),Gt(this,"lastWheelEvent",void 0),Gt(this,"lastWheelEventTime",void 0),Gt(this,"startZoom",void 0),Gt(this,"targetZoom",void 0),Gt(this,"delta",void 0),Gt(this,"easing",void 0),Gt(this,"prevEase",void 0),Gt(this,"frameId",void 0),Gt(this,"handler",void 0),Gt(this,"defaultZoomRate",void 0),Gt(this,"wheelZoomRate",void 0),Gt(this,"onScrollFrame",function(){if(!!_.frameId&&(_.frameId=null,!!_.isActive())){var b=_.map.transform;if(_.delta!==0){var q=_.type==="wheel"&&Math.abs(_.delta)>zi?_.wheelZoomRate:_.defaultZoomRate,de=nf/(1+Math.exp(-Math.abs(_.delta*q)));_.delta<0&&de!==0&&(de=1/de);var ct=typeof _.targetZoom=="number"?b.zoomScale(_.targetZoom):b.scale;_.targetZoom=Math.min(b.maxZoom,Math.max(b.minZoom,b.scaleZoom(ct*de))),_.type==="wheel"&&(_.startZoom=b.zoom,_.easing=_.smoothOutEasing(200)),_.delta=0}var st=typeof _.targetZoom=="number"?_.targetZoom:b.zoom,Mt=_.startZoom,Ir=_.easing,Gr=!1,xn;if(_.type==="wheel"&&Mt&&Ir){var gn=Math.min((Ro()-_.lastWheelEventTime)/200,1),Sn=Ir(gn);xn=Ao(Mt,st,Sn),gn<1?_.frameId||(_.frameId=!0):Gr=!0}else xn=st,Gr=!0;return _.active=!0,Gr&&(_.active=!1,_.finishTimeout=setTimeout(function(){_.zooming=!1,_.handler.triggerRenderFrame(),delete _.targetZoom,delete _.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Gr,zoomDelta:xn-b.zoom,around:_.aroundPoint,originalEvent:_.lastWheelEvent}}}),this.map=m,this.el=m.getCanvasContainer(),this.handler=u,this.delta=0,this.defaultZoomRate=ks,this.wheelZoomRate=Vc}return ra(R,[{key:"setZoomRate",value:function(u){this.defaultZoomRate=u}},{key:"setWheelZoomRate",value:function(u){this.wheelZoomRate=u}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(u){this.isEnabled()||(this.enabled=!0,this.aroundCenter=u&&u.around==="center")}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"wheel",value:function(u){if(!!this.isEnabled()){var _=u.deltaMode===window.WheelEvent.DOM_DELTA_LINE?u.deltaY*40:u.deltaY,b=Ro(),q=b-(this.lastWheelEventTime||0);this.lastWheelEventTime=b,_!==0&&_%zi==0?this.type="wheel":_!==0&&Math.abs(_)<4?this.type="trackpad":q>400?(this.type=null,this.lastValue=_,this.timeout=setTimeout(this.onTimeout,40,u)):this.type||(this.type=Math.abs(q*_)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,_+=this.lastValue)),u.shiftKey&&_&&(_=_/4),this.type&&(this.lastWheelEvent=u,this.delta-=_,this.active||this.start(u)),u.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(u){this.type="wheel",this.delta-=this.lastValue,!this.active&&this.start&&this.start(u)}},{key:"start",value:function(u){if(!!this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var _=ss.mousePos(this.el,u);this.around=St.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(_)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(u){var _=ua;if(this.prevEase){var b=this.prevEase,q=(Ro()-b.start)/b.duration,de=b.easing(q+.01)-b.easing(q),ct=.27/Math.sqrt(de*de+1e-4)*.01,st=Math.sqrt(.27*.27-ct*ct);_=Ts(ct,st,.25,1)}return this.prevEase={start:Ro(),duration:u,easing:_},_}}]),R}(),Vu=Ws,mf=function(){function R(m,u){ei(this,R),Gt(this,"clickZoom",void 0),Gt(this,"tapZoom",void 0),this.clickZoom=m,this.tapZoom=u}return ra(R,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),R}(),_i=function(){function R(m,u,_){ei(this,R),Gt(this,"inertiaOptions",void 0),Gt(this,"el",void 0),Gt(this,"mousePan",void 0),Gt(this,"touchPan",void 0),this.el=m,this.mousePan=u,this.touchPan=_}return ra(R,[{key:"enable",value:function(u){this.inertiaOptions=u||{},this.mousePan.enable(),this.touchPan.enable(),vr.isMini||this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),vr.isMini||this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),R}(),gf=function(){function R(m,u,_){ei(this,R),Gt(this,"mouseRotate",void 0),Gt(this,"mousePitch",void 0),Gt(this,"pitchWithRotate",void 0),this.pitchWithRotate=m.pitchWithRotate,this.mouseRotate=u,this.mousePitch=_}return ra(R,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),R}(),$f=function(){function R(m,u,_,b){ei(this,R),Gt(this,"el",void 0),Gt(this,"touchZoom",void 0),Gt(this,"touchRotate",void 0),Gt(this,"tapDragZoom",void 0),Gt(this,"rotationDisabled",void 0),Gt(this,"enabled",void 0),this.el=m,this.touchZoom=u,this.touchRotate=_,this.tapDragZoom=b,this.rotationDisabled=!1,this.enabled=!0}return ra(R,[{key:"enable",value:function(u){this.touchZoom.enable(u),this.rotationDisabled||this.touchRotate.enable(u),this.tapDragZoom.enable(),vr.isMini||this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),vr.isMini||this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),R}();function Al(R,m){for(var u={},_=0;_<R.length;_++)u[R[_].identifier]=m[_];return u}function _s(R,m){var u=typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(!u){if(Array.isArray(R)||(u=Au(R))||m&&R&&typeof R.length=="number"){u&&(R=u);var _=0,b=function(){};return{s:b,n:function(){return _>=R.length?{done:!0}:{done:!1,value:R[_++]}},e:function(Mt){throw Mt},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,de=!1,ct;return{s:function(){u=u.call(R)},n:function(){var Mt=u.next();return q=Mt.done,Mt},e:function(Mt){de=!0,ct=Mt},f:function(){try{!q&&u.return!=null&&u.return()}finally{if(de)throw ct}}}}function Au(R,m){if(!!R){if(typeof R=="string")return yf(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return yf(R,m)}}function yf(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}function Tl(R){var m=new Or(0,0),u=_s(R),_;try{for(u.s();!(_=u.n()).done;){var b=_.value;m._add(b)}}catch(q){u.e(q)}finally{u.f()}return m.div(R.length)}var Ru=500,Ac=500,ah=30,zf=function(){function R(m){ei(this,R),Gt(this,"numTouches",void 0),Gt(this,"centroid",void 0),Gt(this,"startTime",void 0),Gt(this,"aborted",void 0),Gt(this,"touches",void 0),this.reset(),this.numTouches=m.numTouches}return ra(R,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(u,_,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=u.timeStamp),b.length===this.numTouches&&(this.centroid=Tl(_),this.touches=Al(b,_)))}},{key:"touchmove",value:function(u,_,b){if(!(this.aborted||!this.centroid)){var q=Al(b,_);for(var de in this.touches)if(this.touches[de]){var ct=this.touches[de],st=q[de];(!st||st.dist(ct)>ah)&&(this.aborted=!0)}}}},{key:"touchend",value:function(u,_,b){if((!this.centroid||u.timeStamp-this.startTime>Ac)&&(this.aborted=!0),b.length===0){var q=!this.aborted&&this.centroid;if(this.reset(),q)return q}}}]),R}(),Uf=function(){function R(m){ei(this,R),Gt(this,"singleTap",void 0),Gt(this,"numTaps",void 0),Gt(this,"lastTime",void 0),Gt(this,"lastTap",void 0),Gt(this,"count",void 0),this.singleTap=new zf(m),this.numTaps=m.numTaps,this.reset()}return ra(R,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(u,_,b){this.singleTap.touchstart(u,_,b)}},{key:"touchmove",value:function(u,_,b){this.singleTap.touchmove(u,_,b)}},{key:"touchend",value:function(u,_,b){var q=this.singleTap.touchend(u,_,b);if(q){var de=u.timeStamp-this.lastTime<Ru,ct=!this.lastTap||this.lastTap.dist(q)<ah;if((!de||!ct)&&this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=q,this.count===this.numTaps)return this.reset(),q}}}]),R}(),oh=function(){function R(){ei(this,R),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"swipePoint",void 0),Gt(this,"swipeTouch",void 0),Gt(this,"tapTime",void 0),Gt(this,"tap",void 0),this.tap=new Uf({numTouches:1,numTaps:1}),this.reset()}return ra(R,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(u,_,b){this.swipePoint||(this.tapTime&&u.timeStamp-this.tapTime>Ru&&this.reset(),this.tapTime?b.length>0&&(this.swipePoint=_[0],this.swipeTouch=b[0].identifier):this.tap.touchstart(u,_,b))}},{key:"touchmove",value:function(u,_,b){if(!this.tapTime)this.tap.touchmove(u,_,b);else if(this.swipePoint){if(b[0].identifier!==this.swipeTouch)return;var q=_[0],de=q.y-this.swipePoint.y;return this.swipePoint=q,u.preventDefault(),this.active=!0,{zoomDelta:de/128}}}},{key:"touchend",value:function(u,_,b){if(this.tapTime)this.swipePoint&&b.length===0&&this.reset();else{var q=this.tap.touchend(u,_,b);q&&(this.tapTime=u.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),R}(),wl=function(){function R(){ei(this,R),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"zoomIn",void 0),Gt(this,"zoomOut",void 0),this.zoomIn=new Uf({numTouches:1,numTaps:2}),this.zoomOut=new Uf({numTouches:2,numTaps:1}),this.reset()}return ra(R,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(u,_,b){this.zoomIn.touchstart(u,_,b),this.zoomOut.touchstart(u,_,b)}},{key:"touchmove",value:function(u,_,b){this.zoomIn.touchmove(u,_,b),this.zoomOut.touchmove(u,_,b)}},{key:"touchend",value:function(u,_,b){var q=this,de=this.zoomIn.touchend(u,_,b),ct=this.zoomOut.touchend(u,_,b);if(de)return this.active=!0,u.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(Mt){return Mt.easeTo({duration:300,zoom:Mt.getZoom()+1,around:Mt.unproject(de)},{originalEvent:u})}};if(ct)return this.active=!0,u.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(Mt){return Mt.easeTo({duration:300,zoom:Mt.getZoom()-1,around:Mt.unproject(ct)},{originalEvent:u})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),R}(),pl=function(){function R(m){ei(this,R),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"touches",void 0),Gt(this,"minTouches",void 0),Gt(this,"clickTolerance",void 0),Gt(this,"sum",void 0),this.minTouches=1,this.clickTolerance=m.clickTolerance||1,this.reset()}return ra(R,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Or(0,0)}},{key:"touchstart",value:function(u,_,b){return this.calculateTransform(u,_,b)}},{key:"touchmove",value:function(u,_,b){if(!!this.active)return u.preventDefault(),this.calculateTransform(u,_,b)}},{key:"touchend",value:function(u,_,b){this.calculateTransform(u,_,b),this.active&&b.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(u,_,b){b.length>0&&(this.active=!0);var q=Al(b,_),de=new Or(0,0),ct=new Or(0,0),st=0;for(var Mt in q)if(q[Mt]){var Ir=q[Mt],Gr=this.touches[Mt];Gr&&(de._add(Ir),ct._add(Ir.sub(Gr)),st++,q[Mt]=Ir)}if(this.touches=q,!(st<this.minTouches||!ct.mag())){var xn=ct.div(st);if(this.sum._add(xn),!(this.sum.mag()<this.clickTolerance)){var gn=de.div(st);return{around:gn,panDelta:xn}}}}}]),R}(),fo=function(){function R(){ei(this,R),Gt(this,"enabled",void 0),Gt(this,"active",void 0),Gt(this,"firstTwoTouches",void 0),Gt(this,"vector",void 0),Gt(this,"startVector",void 0),Gt(this,"aroundCenter",void 0),this.reset()}return ra(R,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(u){}},{key:"move",value:function(u,_,b){}},{key:"touchstart",value:function(u,_,b){this.firstTwoTouches||b.length<2||(this.firstTwoTouches=[b[0].identifier,b[1].identifier],this.start([_[0],_[1]]))}},{key:"touchmove",value:function(u,_,b){if(!!this.firstTwoTouches){u.preventDefault();var q=rc(this.firstTwoTouches,2),de=q[0],ct=q[1],st=Ju(b,_,de),Mt=Ju(b,_,ct);if(!(!st||!Mt)){var Ir=this.aroundCenter?null:st.add(Mt).div(2);return this.move([st,Mt],Ir,u)}}}},{key:"touchend",value:function(u,_,b){if(!!this.firstTwoTouches){var q=rc(this.firstTwoTouches,2),de=q[0],ct=q[1],st=Ju(b,_,de),Mt=Ju(b,_,ct);st&&Mt||(this.active&&ss.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(u){this.enabled=!0,this.aroundCenter=!!u&&u.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),R}();function Ju(R,m,u){for(var _=0;_<R.length;_++)if(R[_].identifier===u)return m[_]}function Ml(R){var m=Xs();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function Xs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}function oc(R){return Math.abs(R.y)>Math.abs(R.x)}var Hc=100,Tu=function(R){ba(u,R);var m=Ml(u);function u(){var _;ei(this,u);for(var b=arguments.length,q=new Array(b),de=0;de<b;de++)q[de]=arguments[de];return _=m.call.apply(m,[this].concat(q)),Gt(Rn(_),"valid",void 0),Gt(Rn(_),"firstMove",void 0),Gt(Rn(_),"lastPoints",void 0),_}return ra(u,[{key:"reset",value:function(){da(ya(u.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(b){this.lastPoints=b,oc(b[0].sub(b[1]))&&(this.valid=!1)}},{key:"move",value:function(b,q,de){var ct=b[0].sub(this.lastPoints[0]),st=b[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(ct,st,de.timeStamp),!!this.valid){this.lastPoints=b,this.active=!0;var Mt=(ct.y+st.y)/2,Ir=-.5;return{pitchDelta:Mt*Ir}}}},{key:"gestureBeginsVertically",value:function(b,q,de){if(this.valid!==void 0)return this.valid;var ct=2,st=b.mag()>=ct,Mt=q.mag()>=ct;if(!(!st&&!Mt)){if(!st||!Mt)return this.firstMove===void 0&&(this.firstMove=de),de-this.firstMove<Hc?void 0:!1;var Ir=b.y>0==q.y>0;return oc(b)&&oc(q)&&Ir}}}]),u}(fo);function Hu(R){var m=Js();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function Js(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var la=25;function Vi(R,m){return R.angleWith(m)*180/Math.PI}var wf=function(R){ba(u,R);var m=Hu(u);function u(){var _;ei(this,u);for(var b=arguments.length,q=new Array(b),de=0;de<b;de++)q[de]=arguments[de];return _=m.call.apply(m,[this].concat(q)),Gt(Rn(_),"minDiameter",void 0),_}return ra(u,[{key:"reset",value:function(){da(ya(u.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(b){this.startVector=this.vector=b[0].sub(b[1]),this.minDiameter=b[0].dist(b[1])}},{key:"move",value:function(b,q){var de=this.vector;if(this.vector=b[0].sub(b[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:Vi(this.vector,de),pinchAround:q}}},{key:"isBelowThreshold",value:function(b){this.minDiameter=Math.min(this.minDiameter,b.mag());var q=Math.PI*this.minDiameter,de=la/q*360,ct=Vi(b,this.startVector);return Math.abs(ct)<de}}]),u}(fo);function wu(R){var m=Wl();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function Wl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var mu=.1;function Pl(R,m){return Math.log(R/m)/Math.LN2}var Zf=function(R){ba(u,R);var m=wu(u);function u(){var _;ei(this,u);for(var b=arguments.length,q=new Array(b),de=0;de<b;de++)q[de]=arguments[de];return _=m.call.apply(m,[this].concat(q)),Gt(Rn(_),"distance",void 0),Gt(Rn(_),"startDistance",void 0),_}return ra(u,[{key:"reset",value:function(){da(ya(u.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(b){this.startDistance=this.distance=b[0].dist(b[1])}},{key:"move",value:function(b,q){var de=this.distance;if(this.distance=b[0].dist(b[1]),!(!this.active&&Math.abs(Pl(this.distance,this.startDistance))<mu))return this.active=!0,{zoomDelta:Pl(this.distance,de),pinchAround:q}}}]),u}(fo);function sc(R,m){var u=typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(!u){if(Array.isArray(R)||(u=$o(R))||m&&R&&typeof R.length=="number"){u&&(R=u);var _=0,b=function(){};return{s:b,n:function(){return _>=R.length?{done:!0}:{done:!1,value:R[_++]}},e:function(Mt){throw Mt},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,de=!1,ct;return{s:function(){u=u.call(R)},n:function(){var Mt=u.next();return q=Mt.done,Mt},e:function(Mt){de=!0,ct=Mt},f:function(){try{!q&&u.return!=null&&u.return()}finally{if(de)throw ct}}}}function $o(R,m){if(!!R){if(typeof R=="string")return fs(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return fs(R,m)}}function fs(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}var _f=function(m){return m.zoom||m.drag||m.pitch||m.rotate};function uc(R){return R.panDelta&&R.panDelta.mag()||R.zoomDelta||R.bearingDelta||R.pitchDelta}var lc=function(){function R(m,u){var _=this;ei(this,R),Gt(this,"map",void 0),Gt(this,"el",void 0),Gt(this,"handlers",void 0),Gt(this,"eventsInProgress",void 0),Gt(this,"frameId",void 0),Gt(this,"inertia",void 0),Gt(this,"bearingSnap",void 0),Gt(this,"handlersById",void 0),Gt(this,"updatingCamera",void 0),Gt(this,"changes",void 0),Gt(this,"previousActiveHandlers",void 0),Gt(this,"bearingChanged",void 0),Gt(this,"rotateEnabled",void 0),Gt(this,"pitchEnabled",void 0),Gt(this,"listeners",void 0),Gt(this,"handleWindowEvent",function(Gr){_.handleEvent(Gr,"".concat(Gr.type,"Window"))}),Gt(this,"handleEvent",function(Gr,xn){if(Gr.type==="blur"){_.stop();return}_.updatingCamera=!0;var gn=Gr.type==="renderFrame"?void 0:Gr,Sn={needsRenderFrame:!1},Wn={},bi={},pa=Gr.touches?_.getMapTouches(Gr.touches):void 0,Wa=pa?ss.touchPos(_.el,pa):ss.mousePos(_.el,Gr),Qa=sc(_.handlers),ro;try{for(Qa.s();!(ro=Qa.n()).done;){var Ko=ro.value,sa=Ko.handlerName,_o=Ko.handler,xa=Ko.allowed;if(!!_o.isEnabled()){var xo=void 0;if(_.blockedByActive(bi,xa,sa))_o.reset();else{var ds=xn||Gr.type;_o&&_o[ds]&&(xo=_o[ds](Gr,Wa,pa),_.mergeIHandlerResult(Sn,Wn,xo,sa,gn),xo&&xo.needsRenderFrame&&_.triggerRenderFrame())}(xo||_o.isActive())&&(bi[sa]=_o)}}}catch(vl){Qa.e(vl)}finally{Qa.f()}var ru={};for(var Rc in _.previousActiveHandlers)bi[Rc]||(ru[Rc]=gn);_.previousActiveHandlers=bi,(Object.keys(ru).length||uc(Sn))&&(_.changes.push([Sn,Wn,ru]),_.triggerRenderFrame()),(Object.keys(bi).length||uc(Sn))&&_.map.stop(!0),_.updatingCamera=!1;var mc=Sn.cameraAnimation;mc&&(_.inertia.clear(),_.fireEvents({},{}),_.changes=[],mc(_.map))}),this.map=m,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new Nf(m),this.bearingSnap=u.bearingSnap,this.rotateEnabled=u.rotateEnabled,this.pitchEnabled=u.pitchEnabled,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(u);var b=this.el;if(this.listeners=[],vr.isMini)vr.$window.document.addEventListener("touchstart",function(Gr){_.handleEvent(Gr)},{}),vr.$window.document.addEventListener("touchmove",function(Gr){_.handleEvent(Gr)},{}),vr.$window.document.addEventListener("touchend",function(Gr){_.handleEvent(Gr)},{}),vr.$window.document.addEventListener("touchcancel",function(Gr){_.handleEvent(Gr)},{});else{this.listeners=[[b,"touchstart",{passive:!1}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[window,"blur",void 0]];var q=sc(this.listeners),de;try{for(q.s();!(de=q.n()).done;){var ct=rc(de.value,3),st=ct[0],Mt=ct[1],Ir=ct[2];ss.addEventListener(st,Mt,st===window.document?this.handleWindowEvent:this.handleEvent,Ir)}}catch(Gr){q.e(Gr)}finally{q.f()}}}return ra(R,[{key:"destroy",value:function(){var u=sc(this.listeners),_;try{for(u.s();!(_=u.n()).done;){var b=rc(_.value,3),q=b[0],de=b[1],ct=b[2];ss.removeEventListener(q,de,q===window.document?this.handleWindowEvent:this.handleEvent,ct)}}catch(st){u.e(st)}finally{u.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var u=sc(this.handlers),_;try{for(u.s();!(_=u.n()).done;){var b=_.value.handler;b.reset()}}catch(q){u.e(q)}finally{u.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var u=sc(this.handlers),_;try{for(u.s();!(_=u.n()).done;){var b=_.value.handler;if(b.isActive())return!0}}catch(q){u.e(q)}finally{u.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(_f(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(u,_,b,q,de){if(!!b){Qi()(u,b);var ct={handlerName:q,originalEvent:b.originalEvent||de};b.zoomDelta!==void 0&&(_.zoom=ct),b.panDelta!==void 0&&(_.drag=ct),b.pitchDelta!==void 0&&(_.pitch=ct),b.bearingDelta!==void 0&&(_.rotate=ct)}}},{key:"triggerRenderFrame",value:function(){var u=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(_){delete u.frameId,u.handleEvent(new Su("renderFrame",{timeStamp:_})),u.applyChanges()}))}},{key:"addDefaultHandlers",value:function(u){var _=this.map,b=_.getCanvasContainer();this.add("mapEvent",new hn(_,u));var q=_.boxZoom=new Cc(_,u);this.add("boxZoom",q);var de=new wl,ct=new ef;_.doubleClickZoom=new mf(ct,de),this.add("tapZoom",de),this.add("clickZoom",ct);var st=new oh;this.add("tapDragZoom",st);var Mt=_.touchPitch=new Tu;this.add("touchPitch",Mt);var Ir=new Vs(u),Gr=new Hs(u);_.dragRotate=new gf(u,Ir,Gr),this.add("mouseRotate",Ir,["mousePitch"]),this.add("mousePitch",Gr,["mouseRotate"]);var xn=new Hl(u),gn=new pl(u);_.dragPan=new _i(b,xn,gn),this.add("mousePan",xn),this.add("touchPan",gn,["touchZoom","touchRotate"]);var Sn=new wf,Wn=new Zf;_.touchZoomRotate=new $f(b,Wn,Sn,st),this.add("touchRotate",Sn,["touchPan","touchZoom"]),this.add("touchZoom",Wn,["touchPan","touchRotate"]);var bi=_.scrollZoom=new Vu(_,this);this.add("scrollZoom",bi,["mousePan"]);var pa=_.keyboard=new Wt;this.add("keyboard",pa),this.add("blockableMapEvent",new Gu(_));for(var Wa=0,Qa=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Wa<Qa.length;Wa++){var ro=Qa[Wa];u.interactive&&u[ro]&&_[ro].enable(u[ro])}}},{key:"add",value:function(u,_,b){this.handlers.push({handlerName:u,handler:_,allowed:b}),this.handlersById[u]=_}},{key:"blockedByActive",value:function(u,_,b){for(var q in u)if(q!==b&&(!_||_.indexOf(q)<0))return!0;return!1}},{key:"getMapTouches",value:function(u){var _=[],b=sc(u),q;try{for(b.s();!(q=b.n()).done;){var de=q.value,ct=de.target;(vr.isMini||this.el.contains(ct))&&_.push(de)}}catch(st){b.e(st)}finally{b.f()}return _}},{key:"applyChanges",value:function(){var u={},_={},b={},q=sc(this.changes),de;try{for(q.s();!(de=q.n()).done;){var ct=rc(de.value,3),st=ct[0],Mt=ct[1],Ir=ct[2];st.panDelta&&(u.panDelta=(u.panDelta||new Or(0,0))._add(st.panDelta)),st.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+st.zoomDelta),st.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+st.bearingDelta),st.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+st.pitchDelta),st.around!==void 0&&(u.around=st.around),st.pinchAround!==void 0&&(u.pinchAround=st.pinchAround),st.noInertia&&(u.noInertia=st.noInertia),Qi()(_,Mt),Qi()(b,Ir)}}catch(Gr){q.e(Gr)}finally{q.f()}this.updateMapTransform(u,_,b),this.changes=[]}},{key:"updateMapTransform",value:function(u,_,b){var q=this.map,de=q.transform;if(!uc(u))return this.fireEvents(_,b);var ct=u.panDelta,st=u.zoomDelta,Mt=u.bearingDelta,Ir=u.pitchDelta,Gr=u.pinchAround,xn=u.around;Gr!==void 0&&(xn=Gr),q.stop(!0),xn=xn||q.transform.centerPoint;var gn=de.pointLocation(ct?xn.sub(ct):xn);Mt&&this.rotateEnabled&&(de.bearing+=Mt),Ir&&this.pitchEnabled&&(de.pitch+=Ir),st&&(de.zoom+=st),de.setLocationAtPoint(gn,xn),this.map.update(),u.noInertia||this.inertia.record(u),this.fireEvents(_,b)}},{key:"fireEvents",value:function(u,_){var b=this,q=_f(this.eventsInProgress),de=_f(u),ct={};for(var st in u)if(u[st]){var Mt=u[st].originalEvent;this.eventsInProgress[st]||(ct["".concat(st,"start")]=Mt),this.eventsInProgress[st]=u[st]}!q&&de&&this.fireEvent("movestart",de.originalEvent);for(var Ir in ct)ct[Ir]&&this.fireEvent(Ir,ct[Ir]);u.rotate&&(this.bearingChanged=!0),de&&this.fireEvent("move",de.originalEvent);for(var Gr in u)if(u[Gr]){var xn=u[Gr].originalEvent;this.fireEvent(Gr,xn)}var gn={},Sn;for(var Wn in this.eventsInProgress)if(this.eventsInProgress[Wn]){var bi=this.eventsInProgress[Wn],pa=bi.handlerName,Wa=bi.originalEvent;this.handlersById[pa].isActive()||(delete this.eventsInProgress[Wn],Sn=_[pa]||Wa,gn["".concat(Wn,"end")]=Sn)}for(var Qa in gn)gn[Qa]&&this.fireEvent(Qa,gn[Qa]);var ro=_f(this.eventsInProgress);if((q||de)&&!ro){this.updatingCamera=!0;var Ko=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),sa=function(xa){return xa!==0&&-b.bearingSnap<xa&&xa<b.bearingSnap};Ko?(sa(Ko.bearing||this.map.getBearing())&&(Ko.bearing=0),this.map.easeTo(Ko,{originalEvent:Sn})):(this.map.emit("moveend",new yo("moveend",{originalEvent:Sn})),sa(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(u,_){this.map.emit(u,new yo(u,_?{originalEvent:_}:{}))}}]),R}(),Ll=lc,au=y(23493),Tc=y.n(au),cc=function(){function R(m){var u=this;ei(this,R),Gt(this,"map",void 0),Gt(this,"updateHash",void 0),Gt(this,"hashName",void 0),Gt(this,"onHashChange",function(){var _=u.getCurrentHash();if(_.length>=3&&!_.some(function(q){return isNaN(+q)})){var b=u.map.dragRotate.isEnabled()&&u.map.touchZoomRotate.isEnabled()?+(_[3]||0):u.map.getBearing();return u.map.jumpTo({center:[+_[2],+_[1]],zoom:+_[0],bearing:b,pitch:+(_[4]||0)}),!0}return!1}),Gt(this,"getCurrentHash",function(){var _=window.location.hash.replace("#","");if(u.hashName){var b;return _.split("&").map(function(q){return q.split("=")}).forEach(function(q){q[0]===u.hashName&&(b=q)}),(b&&b[1]||"").split("/")}return _.split("/")}),Gt(this,"updateHashUnthrottled",function(){var _=u.getHashString();try{window.history.replaceState(window.history.state,"",_)}catch(b){}}),this.hashName=m&&encodeURIComponent(m),this.updateHash=Tc()(this.updateHashUnthrottled,30*1e3/100)}return ra(R,[{key:"addTo",value:function(u){return this.map=u,vr.$window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return vr.$window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(u){var _=this.map.getCenter(),b=Math.round(this.map.getZoom()*100)/100,q=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),de=Math.pow(10,q),ct=Math.round(_.lng*de)/de,st=Math.round(_.lat*de)/de,Mt=this.map.getBearing(),Ir=this.map.getPitch(),Gr="";if(u?Gr+="/".concat(ct,"/").concat(st,"/").concat(b):Gr+="".concat(b,"/").concat(st,"/").concat(ct),(Mt||Ir)&&(Gr+="/".concat(Math.round(Mt*10)/10)),Ir&&(Gr+="/".concat(Math.round(Ir))),this.hashName){var xn=this.hashName,gn=!1,Sn=window.location.hash.slice(1).split("&").map(function(Wn){var bi=Wn.split("=")[0];return bi===xn?(gn=!0,"".concat(bi,"=").concat(Gr)):Wn}).filter(function(Wn){return Wn});return gn||Sn.push("".concat(xn,"=").concat(Gr)),"#".concat(Sn.join("&"))}return"#".concat(Gr)}}]),R}(),xf=cc,fc=null,Xl=[],Mf=30,af=1e3/Mf,Yl=vr.$window.performance,of={create:"create",load:"load",fullLoad:"fullLoad"},$l={mark:function(m){Yl.mark(m)},frame:function(m){var u=m;if(fc!=null){var _=u-fc;Xl.push(_)}fc=u},clearMetrics:function(){fc=null,Xl=[],Yl.clearMeasures("loadTime"),Yl.clearMeasures("fullLoadTime");for(var m in of)Yl.clearMarks(of[m])},getPerformanceMetrics:function(){var m=Yl.measure("loadTime",of.create,of.load).duration,u=Yl.measure("fullLoadTime",of.create,of.fullLoad).duration,_=Xl.length,b=Xl.reduce(function(st,Mt){return st+Mt},0)/_/1e3,q=1/b,de=Xl.filter(function(st){return st>af}).reduce(function(st,Mt){return st+(Mt-af)/af},0),ct=de/(_+de)*100;return{loadTime:m,fullLoadTime:u,fps:q,percentDroppedFrames:ct}}};function Kl(R,m){var u=typeof Symbol!="undefined"&&R[Symbol.iterator]||R["@@iterator"];if(!u){if(Array.isArray(R)||(u=hc(R))||m&&R&&typeof R.length=="number"){u&&(R=u);var _=0,b=function(){};return{s:b,n:function(){return _>=R.length?{done:!0}:{done:!1,value:R[_++]}},e:function(Mt){throw Mt},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,de=!1,ct;return{s:function(){u=u.call(R)},n:function(){var Mt=u.next();return q=Mt.done,Mt},e:function(Mt){de=!0,ct=Mt},f:function(){try{!q&&u.return!=null&&u.return()}finally{if(de)throw ct}}}}function hc(R,m){if(!!R){if(typeof R=="string")return gu(R,m);var u=Object.prototype.toString.call(R).slice(8,-1);if(u==="Object"&&R.constructor&&(u=R.constructor.name),u==="Map"||u==="Set")return Array.from(R);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return gu(R,m)}}function gu(R,m){(m==null||m>R.length)&&(m=R.length);for(var u=0,_=new Array(m);u<m;u++)_[u]=R[u];return _}var el=function(){function R(){ei(this,R),Gt(this,"queue",void 0),Gt(this,"id",void 0),Gt(this,"cleared",void 0),Gt(this,"currentlyRunning",void 0),this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return ra(R,[{key:"add",value:function(u){var _=++this.id,b=this.queue;return b.push({callback:u,id:_,cancelled:!1}),_}},{key:"remove",value:function(u){var _=this.currentlyRunning,b=_?this.queue.concat(_):this.queue,q=Kl(b),de;try{for(q.s();!(de=q.n()).done;){var ct=de.value;if(ct.id===u){ct.cancelled=!0;return}}}catch(st){q.e(st)}finally{q.f()}}},{key:"run",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,_=this.currentlyRunning=this.queue;this.queue=[];var b=Kl(_),q;try{for(b.s();!(q=b.n()).done;){var de=q.value;if(!de.cancelled&&(de.callback(u),this.cleared))break}}catch(ct){b.e(ct)}finally{b.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),R}(),Wc=el;function sf(R){var m=sh();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function sh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}function Pf(R,m){var u=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(u||_)&&(m||(m=document),!!m)){var b=m.head||m.getElementsByTagName("head")[0];if(!b){b=m.createElement("head");var q=m.body||m.getElementsByTagName("body")[0];q?q.parentNode.insertBefore(b,q):m.documentElement.appendChild(b)}var de=m.createElement("style");return de.type="text/css",de.styleSheet?de.styleSheet.cssText=R:de.appendChild(m.createTextNode(R)),b.appendChild(de),de}}Pf(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var n=-2,o=22,i=0,l=60,w={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:n,maxZoom:o,minPitch:i,maxPitch:l,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0,pitchEnabled:!0,rotateEnabled:!0},z=function(R){ba(u,R);var m=sf(u);function u(_){var b;if(ei(this,u),b=m.call(this,Qi()({},w,_)),Gt(Rn(b),"doubleClickZoom",void 0),Gt(Rn(b),"dragRotate",void 0),Gt(Rn(b),"dragPan",void 0),Gt(Rn(b),"touchZoomRotate",void 0),Gt(Rn(b),"scrollZoom",void 0),Gt(Rn(b),"keyboard",void 0),Gt(Rn(b),"touchPitch",void 0),Gt(Rn(b),"boxZoom",void 0),Gt(Rn(b),"handlers",void 0),Gt(Rn(b),"container",void 0),Gt(Rn(b),"canvas",void 0),Gt(Rn(b),"canvasContainer",void 0),Gt(Rn(b),"renderTaskQueue",new Wc),Gt(Rn(b),"frame",void 0),Gt(Rn(b),"trackResize",!0),Gt(Rn(b),"hash",void 0),Gt(Rn(b),"onWindowOnline",function(){b.update()}),Gt(Rn(b),"onWindowResize",function(de){b.trackResize&&b.resize({originalEvent:de}).update()}),vr.isMini?b.initMiniContainer():b.initContainer(),b.resize(),b.handlers=new Ll(Rn(b),b.options),typeof window!="undefined"&&(window.addEventListener("online",b.onWindowOnline,!1),window.addEventListener("resize",b.onWindowResize,!1),window.addEventListener("orientationchange",b.onWindowResize,!1)),!vr.isMini){var q=typeof _.hash=="string"&&_.hash||void 0;_.hash&&(b.hash=new xf(q).addTo(Rn(b)))}return(!b.hash||!b.hash.onHashChange())&&(b.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(b.resize(),b.fitBounds(_.bounds,Qi()({},_.fitBoundsOptions,{duration:0})))),b}return ra(u,[{key:"resize",value:function(b){var q=this.containerDimensions(),de=q[0],ct=q[1];if(this.transform.resize(de,ct),vr.isMini)return this;var st=!this.moving;return st&&(this.stop(),this.emit("movestart",new vr.$window.Event("movestart",b)),this.emit("move",new vr.$window.Event("move",b))),this.emit("resize",new vr.$window.Event("resize",b)),st&&this.emit("moveend",new vr.$window.Event("moveend",b)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(b){return this.transform.locationPoint(St.convert(b))}},{key:"unproject",value:function(b){return this.transform.pointLocation(Or.convert(b))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(b){this.transform.setMaxBounds(_r.convert(b))}},{key:"setStyle",value:function(b){}},{key:"setMinZoom",value:function(b){if(b=b==null?n:b,b>=n&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between ".concat(n," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(b){if(b=b==null?o:b,b>=this.transform.minZoom)return this.transform.maxZoom=b,this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(b){if(b=b==null?i:b,b<i)throw new Error("minPitch must be greater than or equal to ".concat(i));if(b>=i&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between ".concat(i," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(b){if(b=b==null?l:b,b>l)throw new Error("maxPitch must be less than or equal to ".concat(l));if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(b){this.transform.renderWorldCopies=!!b}},{key:"remove",value:function(){this.container.removeChild(this.canvasContainer),this.canvasContainer=null,this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(b){return this.update(),this.renderTaskQueue.add(b)}},{key:"cancelRenderFrame",value:function(b){return this.renderTaskQueue.remove(b)}},{key:"triggerRepaint",value:function(){var b=this;this.frame||(this.frame=Gs(function(q){$l.frame(q),b.frame=null,b.update(q)}))}},{key:"update",value:function(b){var q=this;this.frame||(this.frame=Gs(function(de){$l.frame(de),q.frame=null,q.renderTaskQueue.run(b)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var b=this.container;b.classList.add("l7-map");var q=this.canvasContainer=vr.DOM.create("div","l7-canvas-container",b);this.options.interactive&&q.classList.add("l7-interactive")}},{key:"initMiniContainer",value:function(){this.container=this.options.canvas,this.canvasContainer=this.container}},{key:"containerDimensions",value:function(){var b=0,q=0;return this.container&&(vr.isMini?(b=this.container.width/vr.$window.devicePixelRatio,q=this.container.height/vr.$window.devicePixelRatio):(b=this.container.clientWidth,q=this.container.clientHeight)),[b,q]}}]),u}(ws);function j(R){var m=ae();return function(){var _=ya(R),b;if(m){var q=ya(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return wo(this,b)}}function ae(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}function Se(R,m){var u=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(u||_)&&(m||(m=document),!!m)){var b=m.head||m.getElementsByTagName("head")[0];if(!b){b=m.createElement("head");var q=m.body||m.getElementsByTagName("body")[0];q?q.parentNode.insertBefore(b,q):m.documentElement.appendChild(b)}var de=m.createElement("style");return de.type="text/css",de.styleSheet?de.styleSheet.cssText=R:de.appendChild(m.createTextNode(R)),b.appendChild(de),de}}Se(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var He=-2,xt=22,Et=0,Tt=60,Jt={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:He,maxZoom:xt,minPitch:Et,maxPitch:Tt,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0,pitchEnabled:!0,rotateEnabled:!0},Yt=function(R){ba(u,R);var m=j(u);function u(_){var b;return ei(this,u),b=m.call(this,Qi()({},Jt,_)),Gt(Rn(b),"doubleClickZoom",void 0),Gt(Rn(b),"dragRotate",void 0),Gt(Rn(b),"dragPan",void 0),Gt(Rn(b),"touchZoomRotate",void 0),Gt(Rn(b),"scrollZoom",void 0),Gt(Rn(b),"keyboard",void 0),Gt(Rn(b),"touchPitch",void 0),Gt(Rn(b),"boxZoom",void 0),Gt(Rn(b),"handlers",void 0),Gt(Rn(b),"container",void 0),Gt(Rn(b),"canvas",void 0),Gt(Rn(b),"canvasContainer",void 0),Gt(Rn(b),"renderTaskQueue",new Wc),Gt(Rn(b),"frame",void 0),Gt(Rn(b),"trackResize",!0),Gt(Rn(b),"onWindowOnline",function(){b.update()}),Gt(Rn(b),"onWindowResize",function(q){b.trackResize&&b.resize({originalEvent:q}).update()}),b.initContainer(),b.resize(),b.handlers=new Ll(Rn(b),b.options),typeof window!="undefined"&&(window.addEventListener("online",b.onWindowOnline,!1),window.addEventListener("resize",b.onWindowResize,!1),window.addEventListener("orientationchange",b.onWindowResize,!1)),b}return ra(u,[{key:"resize",value:function(b){var q=this.containerDimensions(),de=q[0],ct=q[1];this.transform.resize(de,ct);var st=!this.moving;return st&&(this.stop(),this.emit("movestart",new Event("movestart",b)),this.emit("move",new Event("move",b))),this.emit("resize",new Event("resize",b)),st&&this.emit("moveend",new Event("moveend",b)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(b){return this.transform.locationPoint(St.convert(b))}},{key:"unproject",value:function(b){return this.transform.pointLocation(Or.convert(b))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(b){this.transform.setMaxBounds(_r.convert(b))}},{key:"setStyle",value:function(b){}},{key:"setMinZoom",value:function(b){if(b=b==null?He:b,b>=He&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between ".concat(He," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(b){if(b=b==null?xt:b,b>=this.transform.minZoom)return this.transform.maxZoom=b,this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(b){if(b=b==null?Et:b,b<Et)throw new Error("minPitch must be greater than or equal to ".concat(Et));if(b>=Et&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between ".concat(Et," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(b){if(b=b==null?Tt:b,b>Tt)throw new Error("maxPitch must be less than or equal to ".concat(Tt));if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(b){this.transform.renderWorldCopies=!!b}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(b){return this.update(),this.renderTaskQueue.add(b)}},{key:"cancelRenderFrame",value:function(b){return this.renderTaskQueue.remove(b)}},{key:"triggerRepaint",value:function(){var b=this;this.frame||(this.frame=Gs(function(q){$l.frame(q),b.frame=null,b.update(q)}))}},{key:"update",value:function(b){var q=this;this.frame||(this.frame=Gs(function(de){$l.frame(de),q.frame=null,q.renderTaskQueue.run(b)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var b=this.container;b.classList.add("l7-map");var q=this.canvasContainer=vr.DOM.create("div","l7-canvas-container",b);this.options.interactive&&q.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var b=0,q=0;return this.container&&(b=this.container.clientWidth||400,q=this.container.clientHeight||300),[b,q]}},{key:"resizeCanvas",value:function(b,q){var de=vr.DOM.DPR||1;this.canvas.width=de*b,this.canvas.height=de*q,this.canvas.style.width="".concat(b,"px"),this.canvas.style.height="".concat(q,"px")}}]),u}(ws),gr=function(){function R(){v(this,R),Y(this,"xzReg",-Math.PI*.6),Y(this,"yReg",Math.PI*.2),Y(this,"earthCameraRadius",200),Y(this,"earthCameraZoom",1),Y(this,"cameraPosition",xr.create()),Y(this,"viewport",void 0),Y(this,"projectionMatrix",jr.create()),Y(this,"modelMatrix",jr.create()),Y(this,"viewMatrix",jr.create()),Y(this,"viewProjectionMatrix",jr.create()),Y(this,"ViewProjectionMatrixUncentered",jr.create()),Y(this,"viewUncenteredMatrix",jr.create())}return a(R,[{key:"syncWithMapCamera",value:function(u){var _=u.viewportHeight,b=_===void 0?1:_,q=u.viewportWidth,de=q===void 0?1:q,ct=de/b,st=.1,Mt=1e4,Ir=20;jr.perspective(this.projectionMatrix,Ir,ct,st,Mt);var Gr=this.earthCameraRadius*Math.cos(this.xzReg),xn=this.earthCameraRadius*Math.sin(this.xzReg),gn=this.earthCameraRadius*Math.sin(this.yReg);this.cameraPosition=xr.fromValues(Gr,gn,xn),xr.normalize(this.cameraPosition,this.cameraPosition),xr.multiply(this.cameraPosition,this.cameraPosition,xr.fromValues(this.earthCameraRadius,this.earthCameraRadius,this.earthCameraRadius)),xr.scale(this.cameraPosition,this.cameraPosition,this.earthCameraZoom);var Sn=xr.create();xr.cross(Sn,this.cameraPosition,xr.fromValues(0,1,0));var Wn=xr.fromValues(0,1,0);xr.cross(Wn,Sn,this.cameraPosition);var bi=xr.fromValues(0,0,0);jr.lookAt(this.viewMatrix,this.cameraPosition,bi,Wn),this.viewUncenteredMatrix=jr.clone(this.viewMatrix),jr.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),jr.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"rotateY",value:function(u){this.xzReg+=u*Math.min(this.earthCameraZoom*this.earthCameraZoom,1)}},{key:"rotateX",value:function(u){this.yReg+=u*Math.min(this.earthCameraZoom*this.earthCameraZoom,1)}},{key:"scaleZoom",value:function(u){this.earthCameraZoom+=u,this.earthCameraZoom=Math.max(this.earthCameraZoom,.6)}},{key:"getZoom",value:function(){return 4}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[0,0]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return this.modelMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(u,_){return this.viewport.projectFlat(u,_)}}]),R}(),Vt={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},mr=["id","attributionControl","style","rotation","mapInstance"],Ar,Xr,cn,nn,pn,Bn,Zn,Vn,Si,Zi,ca;function ma(R,m){var u=Object.keys(R);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(R);m&&(_=_.filter(function(b){return Object.getOwnPropertyDescriptor(R,b).enumerable})),u.push.apply(u,_)}return u}function Co(R){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?ma(Object(u),!0).forEach(function(_){Y(R,_,u[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(u)):ma(Object(u)).forEach(function(_){Object.defineProperty(R,_,Object.getOwnPropertyDescriptor(u,_))})}return R}var Pi={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Ha=12,Ma=(Ar=(0,Ae.b2)(),Xr=(0,Ae.f3)(ce.TYPES.MapConfig),cn=(0,Ae.f3)(ce.TYPES.IGlobalConfigService),nn=(0,Ae.f3)(ce.TYPES.ICoordinateSystemService),pn=(0,Ae.f3)(ce.TYPES.IEventEmitter),Ar(Bn=(Zn=function(){function R(){var m=this;v(this,R),Y(this,"version",Cr.G.GLOBEL),Y(this,"map",void 0),Y(this,"simpleMapCoord",new ke),Y(this,"dragging",!1),Y(this,"bgColor","#000"),N(this,"config",Vn,this),N(this,"configService",Si,this),N(this,"coordinateSystemService",Zi,this),N(this,"eventEmitter",ca,this),Y(this,"viewport",void 0),Y(this,"markerContainer",void 0),Y(this,"cameraChangedCallback",void 0),Y(this,"$mapContainer",void 0),Y(this,"handleCameraChanging",void 0),Y(this,"handleCameraTimer",void 0),Y(this,"handleCameraChanged",function(u){m.emit("mapchange");var _=2e3;m.handleCameraChanging=!0,m.handleCameraTimer&&clearTimeout(m.handleCameraTimer),m.handleCameraTimer=setTimeout(function(){m.handleCameraChanging=!1},_);var b=.02;u.type&&u.originalEvent&&(u.originalEvent.type==="wheel"&&m.viewport.scaleZoom(.01*Math.sign(u.originalEvent.wheelDelta)*-1),Math.abs(u.originalEvent.movementX)>Math.abs(u.originalEvent.movementY)?u.originalEvent.movementX>0?m.viewport.rotateY(b):u.originalEvent.movementX<0&&m.viewport.rotateY(-b):u.originalEvent.movementY>0?m.viewport.rotateX(b):u.originalEvent.movementY<0&&m.viewport.rotateX(-b));var q=m.config.offsetCoordinate,de=q===void 0?!0:q;m.viewport.syncWithMapCamera({viewportHeight:m.map.transform.height,viewportWidth:m.map.transform.width}),m.viewport.getZoom()>Ha&&de?m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT_OFFSET):m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT),m.cameraChangedCallback(m.viewport)})}return a(R,[{key:"setBgColor",value:function(u){this.bgColor=u}},{key:"addMarkerContainer",value:function(){var u=this.map.getCanvasContainer();this.markerContainer=vr.DOM.create("div","l7-marker-container",u),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(u,_){ce.MapServiceEvent.indexOf(u)!==-1?this.eventEmitter.on(u,_):this.map.on(Pi[u]||u,_)}},{key:"off",value:function(u,_){this.map.off(Pi[u]||u,_),this.eventEmitter.off(u,_)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var u=this.map.transform;return[u.width,u.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(u){return this.map.setZoom(u)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(u){this.map.setCenter(u)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(u){this.map.setBearing(u)}},{key:"zoomIn",value:function(u,_){this.map.zoomIn(u,_)}},{key:"zoomOut",value:function(u,_){this.map.zoomOut(u,_)}},{key:"setPitch",value:function(u){return this.map.setPitch(u)}},{key:"panTo",value:function(u){this.map.panTo(u)}},{key:"panBy",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([u,_])}},{key:"fitBounds",value:function(u,_){this.map.fitBounds(u,_)}},{key:"setMaxZoom",value:function(u){this.map.setMaxZoom(u)}},{key:"setMinZoom",value:function(u){this.map.setMinZoom(u)}},{key:"setMapStatus",value:function(u){u.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),u.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),u.dragEnable===!1&&this.map.dragPan.disable(),u.dragEnable===!0&&this.map.dragPan.enable(),u.rotateEnable===!1&&this.map.dragRotate.disable(),u.dragEnable===!0&&this.map.dragRotate.enable(),u.keyboardEnable===!1&&this.map.keyboard.disable(),u.keyboardEnable===!0&&this.map.keyboard.enable(),u.zoomEnable===!1&&this.map.scrollZoom.disable(),u.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(u,_){this.map.flyTo({zoom:u,center:_})}},{key:"setMapStyle",value:function(u){this.map.setStyle(this.getMapStyle(u))}},{key:"pixelToLngLat",value:function(u){return this.map.unproject(u)}},{key:"lngLatToPixel",value:function(u){return this.map.project(u)}},{key:"containerToLngLat",value:function(u){return this.map.unproject(u)}},{key:"lngLatToContainer",value:function(u){return this.map.project(u)}},{key:"lngLatToMercator",value:function(u,_){throw new Error("not implement")}},{key:"getModelMatrix",value:function(u,_,b){var q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],de=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var m=Pe(et().mark(function _(){var b,q,de,ct,st,Mt,Ir,Gr,xn,gn,Sn;return et().wrap(function(bi){for(;;)switch(bi.prev=bi.next){case 0:b=this.config,q=b.id,de=q===void 0?"map":q,ct=b.attributionControl,st=ct===void 0?!1:ct,Mt=b.style,Ir=Mt===void 0?"light":Mt,Gr=b.rotation,xn=Gr===void 0?0:Gr,gn=b.mapInstance,Sn=qt(b,mr),this.viewport=new gr,this.$mapContainer=this.creatAmapContainer(de),this.map=new Yt(Co({container:this.$mapContainer,style:this.getMapStyle(Ir),bearing:xn},Sn)),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged({});case 7:case"end":return bi.stop()}},_,this)}));function u(){return m.apply(this,arguments)}return u}()},{key:"destroy",value:function(){var u,_;(u=this.$mapContainer)===null||u===void 0||(_=u.parentNode)===null||_===void 0||_.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).emit.apply(_,[u].concat(q))}},{key:"once",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).once.apply(_,[u].concat(q))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(u){var _=this.map.getCanvas(),b=u==="jpg"?_==null?void 0:_.toDataURL("image/jpeg"):_==null?void 0:_.toDataURL("image/png");return b}},{key:"onCameraChanged",value:function(u){this.cameraChangedCallback=u}},{key:"rotateY",value:function(u){var _=u||{},b=_.force,q=b===void 0?!1:b,de=_.reg,ct=de===void 0?.01:de;this.handleCameraChanging&&!q||this.viewport&&(this.viewport.rotateY(ct),this.viewport.syncWithMapCamera({viewportHeight:this.map.transform.height,viewportWidth:this.map.transform.width}),this.cameraChangedCallback(this.viewport))}},{key:"creatAmapContainer",value:function(u){var _=u;return typeof u=="string"&&(_=document.getElementById(u)),_}},{key:"getMapStyle",value:function(u){return typeof u!="string"?u:Vt[u]?Vt[u]:u}}]),R}(),Vn=H(Zn.prototype,"config",[Xr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=H(Zn.prototype,"configService",[cn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zi=H(Zn.prototype,"coordinateSystemService",[nn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ca=H(Zn.prototype,"eventEmitter",[pn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zn))||Bn);function Ba(R){var m=Ea();return function(){var _=V(R),b;if(m){var q=V(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return B(this,b)}}function Ea(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var oo=function(R){L(u,R);var m=Ba(u);function u(){return v(this,u),m.apply(this,arguments)}return a(u,[{key:"getServiceConstructor",value:function(){return Ma}}]),u}(fe),Pa=y(6610),Aa=y(5991),eu=y(46070),As=y(77608),tu=y(10379),Ls=y(63349),Ho=y(28481);function xs(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function zs(R,m){var u=he.fF([],m,R);return he.bA(u,u,1/u[3]),u}function yu(R,m){var u=R%m;return u<0?m+u:u}function Xc(R,m,u){return u*m+(1-u)*R}var ou=y(31437);function su(R,m){if(!R)throw new Error(m||"viewport-mercator-project: assertion failed.")}var Fs=Math.PI,uf=Fs/4,tl=Fs/180,Ol=180/Fs,wc=512,Mc=4003e4,Us=1.5;function Yc(R){return Math.pow(2,R)}function Il(R){return Math.log2(R)}function Bs(R,m){var u=(0,Ho.Z)(R,2),_=u[0],b=u[1];su(Number.isFinite(_)&&Number.isFinite(m)),su(Number.isFinite(b)&&b>=-90&&b<=90,"invalid latitude"),m*=wc;var q=_*tl,de=b*tl,ct=m*(q+Fs)/(2*Fs),st=m*(Fs-Math.log(Math.tan(uf+de*.5)))/(2*Fs);return[ct,st]}function pc(R,m){var u=(0,Ho.Z)(R,2),_=u[0],b=u[1];m*=wc;var q=_/m*(2*Fs)-Fs,de=2*(Math.atan(Math.exp(Fs-b/m*(2*Fs)))-uf);return[q*Ol,de*Ol]}function dc(R){var m=R.latitude;assert(Number.isFinite(m));var u=Math.cos(m*tl);return Il(Mc*u)-9}function ql(R){var m=R.latitude,u=R.longitude,_=R.zoom,b=R.scale,q=R.highPrecision,de=q===void 0?!1:q;b=b!==void 0?b:Yc(_),su(Number.isFinite(m)&&Number.isFinite(u)&&Number.isFinite(b));var ct={},st=wc*b,Mt=Math.cos(m*tl),Ir=st/360,Gr=Ir/Mt,xn=st/Mc/Mt;if(ct.pixelsPerMeter=[xn,-xn,xn],ct.metersPerPixel=[1/xn,-1/xn,1/xn],ct.pixelsPerDegree=[Ir,-Gr,xn],ct.degreesPerPixel=[1/Ir,-1/Gr,1/xn],de){var gn=tl*Math.tan(m*tl)/Mt,Sn=Ir*gn/2,Wn=st/Mc*gn,bi=Wn/Gr*xn;ct.pixelsPerDegree2=[0,-Sn,Wn],ct.pixelsPerMeter2=[bi,0,bi]}return ct}function Uo(R,m){var u=_slicedToArray(R,3),_=u[0],b=u[1],q=u[2],de=_slicedToArray(m,3),ct=de[0],st=de[1],Mt=de[2],Ir=1,Gr=ql({longitude:_,latitude:b,scale:Ir,highPrecision:!0}),xn=Gr.pixelsPerMeter,gn=Gr.pixelsPerMeter2,Sn=Bs(R,Ir);Sn[0]+=ct*(xn[0]+gn[0]*st),Sn[1]+=st*(xn[1]+gn[1]*st);var Wn=pc(Sn,Ir),bi=(q||0)+(Mt||0);return Number.isFinite(q)||Number.isFinite(Mt)?[Wn[0],Wn[1],bi]:Wn}function rl(R){var m=R.height,u=R.pitch,_=R.bearing,b=R.altitude,q=R.center,de=q===void 0?null:q,ct=R.flipY,st=ct===void 0?!1:ct,Mt=xs();return jr.translate(Mt,Mt,[0,0,-b]),jr.scale(Mt,Mt,[1,1,1/m]),jr.rotateX(Mt,Mt,-u*tl),jr.rotateZ(Mt,Mt,_*tl),st&&jr.scale(Mt,Mt,[1,-1,1]),de&&jr.translate(Mt,Mt,xr.negate([],de)),Mt}function uu(R){var m=R.width,u=R.height,_=R.altitude,b=_===void 0?Us:_,q=R.pitch,de=q===void 0?0:q,ct=R.nearZMultiplier,st=ct===void 0?1:ct,Mt=R.farZMultiplier,Ir=Mt===void 0?1:Mt,Gr=de*tl,xn=Math.atan(.5/b),gn=Math.sin(xn)*b/Math.sin(Math.PI/2-Gr-xn),Sn=Math.cos(Math.PI/2-Gr)*gn+b;return{fov:2*Math.atan(u/2/b),aspect:m/u,focalDistance:b,near:st,far:Sn*Ir}}function vc(R){var m=R.width,u=R.height,_=R.pitch,b=R.altitude,q=R.nearZMultiplier,de=R.farZMultiplier,ct=uu({width:m,height:u,altitude:b,pitch:_,nearZMultiplier:q,farZMultiplier:de}),st=ct.fov,Mt=ct.aspect,Ir=ct.near,Gr=ct.far,xn=jr.perspective([],st,Mt,Ir,Gr);return xn}function jf(R,m){var u=(0,Ho.Z)(R,3),_=u[0],b=u[1],q=u[2],de=q===void 0?0:q;return su(Number.isFinite(_)&&Number.isFinite(b)&&Number.isFinite(de)),zs(m,[_,b,de,1])}function Pc(R,m){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,_=(0,Ho.Z)(R,3),b=_[0],q=_[1],de=_[2];if(su(Number.isFinite(b)&&Number.isFinite(q),"invalid pixel coordinate"),Number.isFinite(de)){var ct=zs(m,[b,q,de,1]);return ct}var st=zs(m,[b,q,0,1]),Mt=zs(m,[b,q,1,1]),Ir=st[2],Gr=Mt[2],xn=Ir===Gr?0:((u||0)-Ir)/(Gr-Ir);return ou.t7([],st,Mt,xn)}var Lf=xs(),Rl=function(){function R(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=m.width,_=m.height,b=m.viewMatrix,q=b===void 0?Lf:b,de=m.projectionMatrix,ct=de===void 0?Lf:de;(0,Pa.Z)(this,R),this.width=u||1,this.height=_||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=q,this.projectionMatrix=ct;var st=xs();jr.multiply(st,st,this.projectionMatrix),jr.multiply(st,st,this.viewMatrix),this.viewProjectionMatrix=st;var Mt=xs();jr.scale(Mt,Mt,[this.width/2,-this.height/2,1]),jr.translate(Mt,Mt,[1,-1,0]),jr.multiply(Mt,Mt,this.viewProjectionMatrix);var Ir=jr.invert(xs(),Mt);if(!Ir)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=Mt,this.pixelUnprojectionMatrix=Ir,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,Aa.Z)(R,[{key:"equals",value:function(u){return u instanceof R?u.width===this.width&&u.height===this.height&&jr.equals(u.projectionMatrix,this.projectionMatrix)&&jr.equals(u.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(u){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=_.topLeft,q=b===void 0?!0:b,de=this.projectPosition(u),ct=jf(de,this.pixelProjectionMatrix),st=(0,Ho.Z)(ct,2),Mt=st[0],Ir=st[1],Gr=q?Ir:this.height-Ir;return u.length===2?[Mt,Gr]:[Mt,Gr,ct[2]]}},{key:"unproject",value:function(u){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=_.topLeft,q=b===void 0?!0:b,de=_.targetZ,ct=(0,Ho.Z)(u,3),st=ct[0],Mt=ct[1],Ir=ct[2],Gr=q?Mt:this.height-Mt,xn=de&&de*this.pixelsPerMeter,gn=Pc([st,Gr,Ir],this.pixelUnprojectionMatrix,xn),Sn=this.unprojectPosition(gn),Wn=(0,Ho.Z)(Sn,3),bi=Wn[0],pa=Wn[1],Wa=Wn[2];return Number.isFinite(Ir)?[bi,pa,Wa]:Number.isFinite(de)?[bi,pa,de]:[bi,pa]}},{key:"projectPosition",value:function(u){var _=this.projectFlat(u),b=(0,Ho.Z)(_,2),q=b[0],de=b[1],ct=(u[2]||0)*this.pixelsPerMeter;return[q,de,ct]}},{key:"unprojectPosition",value:function(u){var _=this.unprojectFlat(u),b=(0,Ho.Z)(_,2),q=b[0],de=b[1],ct=(u[2]||0)/this.pixelsPerMeter;return[q,de,ct]}},{key:"projectFlat",value:function(u){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return u}},{key:"unprojectFlat",value:function(u){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return u}}]),R}();function Du(R){var m=R.width,u=R.height,_=R.bounds,b=R.minExtent,q=b===void 0?0:b,de=R.maxZoom,ct=de===void 0?24:de,st=R.padding,Mt=st===void 0?0:st,Ir=R.offset,Gr=Ir===void 0?[0,0]:Ir,xn=(0,Ho.Z)(_,2),gn=(0,Ho.Z)(xn[0],2),Sn=gn[0],Wn=gn[1],bi=(0,Ho.Z)(xn[1],2),pa=bi[0],Wa=bi[1];if(Number.isFinite(Mt)){var Qa=Mt;Mt={top:Qa,bottom:Qa,left:Qa,right:Qa}}else su(Number.isFinite(Mt.top)&&Number.isFinite(Mt.bottom)&&Number.isFinite(Mt.left)&&Number.isFinite(Mt.right));var ro=new ku({width:m,height:u,longitude:0,latitude:0,zoom:0}),Ko=ro.project([Sn,Wa]),sa=ro.project([pa,Wn]),_o=[Math.max(Math.abs(sa[0]-Ko[0]),q),Math.max(Math.abs(sa[1]-Ko[1]),q)],xa=[m-Mt.left-Mt.right-Math.abs(Gr[0])*2,u-Mt.top-Mt.bottom-Math.abs(Gr[1])*2];su(xa[0]>0&&xa[1]>0);var xo=xa[0]/_o[0],ds=xa[1]/_o[1],ru=(Mt.right-Mt.left)/2/xo,Rc=(Mt.bottom-Mt.top)/2/ds,mc=[(sa[0]+Ko[0])/2+ru,(sa[1]+Ko[1])/2+Rc],vl=ro.unproject(mc),Jf=ro.zoom+Math.log2(Math.abs(Math.min(xo,ds)));return{longitude:vl[0],latitude:vl[1],zoom:Math.min(Jf,ct)}}var ku=function(R){(0,tu.Z)(m,R);function m(){var u,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=_.width,q=_.height,de=_.latitude,ct=de===void 0?0:de,st=_.longitude,Mt=st===void 0?0:st,Ir=_.zoom,Gr=Ir===void 0?0:Ir,xn=_.pitch,gn=xn===void 0?0:xn,Sn=_.bearing,Wn=Sn===void 0?0:Sn,bi=_.altitude,pa=bi===void 0?1.5:bi,Wa=_.nearZMultiplier,Qa=_.farZMultiplier;(0,Pa.Z)(this,m),b=b||1,q=q||1;var ro=Yc(Gr);pa=Math.max(.75,pa);var Ko=Bs([Mt,ct],ro);Ko[2]=0;var sa=vc({width:b,height:q,pitch:gn,bearing:Wn,altitude:pa,nearZMultiplier:Wa||1/q,farZMultiplier:Qa||1.01}),_o=rl({height:q,center:Ko,pitch:gn,bearing:Wn,altitude:pa,flipY:!0});return u=(0,eu.Z)(this,(0,As.Z)(m).call(this,{width:b,height:q,viewMatrix:_o,projectionMatrix:sa})),u.latitude=ct,u.longitude=Mt,u.zoom=Gr,u.pitch=gn,u.bearing=Wn,u.altitude=pa,u.scale=ro,u.center=Ko,u.pixelsPerMeter=ql((0,Ls.Z)((0,Ls.Z)(u))).pixelsPerMeter[2],Object.freeze((0,Ls.Z)((0,Ls.Z)(u))),u}return(0,Aa.Z)(m,[{key:"projectFlat",value:function(_){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Bs(_,b)}},{key:"unprojectFlat",value:function(_){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return pc(_,b)}},{key:"getMapCenterByLngLatPosition",value:function(_){var b=_.lngLat,q=_.pos,de=Pc(q,this.pixelUnprojectionMatrix),ct=Bs(b,this.scale),st=ou.IH([],ct,ou.tk([],de)),Mt=ou.IH([],this.center,st);return pc(Mt,this.scale)}},{key:"getLocationAtPoint",value:function(_){var b=_.lngLat,q=_.pos;return this.getMapCenterByLngLatPosition({lngLat:b,pos:q})}},{key:"fitBounds",value:function(_){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},q=this.width,de=this.height,ct=Du(Object.assign({width:q,height:de,bounds:_},b)),st=ct.longitude,Mt=ct.latitude,Ir=ct.zoom;return new m({width:q,height:de,longitude:st,latitude:Mt,zoom:Ir})}}]),m}(Rl),Lc=function(){function R(){v(this,R),Y(this,"viewport",void 0)}return a(R,[{key:"syncWithMapCamera",value:function(u){var _=u.center,b=u.zoom,q=u.pitch,de=u.bearing,ct=u.viewportHeight,st=u.viewportWidth;this.viewport=new ku({width:st,height:ct,longitude:_&&_[0],latitude:_&&_[1],zoom:b,pitch:q,bearing:de})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(u,_){return this.viewport.projectFlat(u,_)}}]),R}(),lf={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Oc=["id","attributionControl","style","rotation","mapInstance","version","mapSize"],hu=["id","attributionControl","style","rotation","mapInstance","canvas","hasBaseMap"],bf,Gf,Kf,Ef,Cf,_h,$c,Of,If,Rf,dl;function uh(R,m){var u=Object.keys(R);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(R);m&&(_=_.filter(function(b){return Object.getOwnPropertyDescriptor(R,b).enumerable})),u.push.apply(u,_)}return u}function xh(R){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?uh(Object(u),!0).forEach(function(_){Y(R,_,u[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(u)):uh(Object(u)).forEach(function(_){Object.defineProperty(R,_,Object.getOwnPropertyDescriptor(u,_))})}return R}var qf={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Vf=12,bh=(bf=(0,Ae.b2)(),Gf=(0,Ae.f3)(ce.TYPES.MapConfig),Kf=(0,Ae.f3)(ce.TYPES.IGlobalConfigService),Ef=(0,Ae.f3)(ce.TYPES.ICoordinateSystemService),Cf=(0,Ae.f3)(ce.TYPES.IEventEmitter),bf(_h=($c=function(){function R(){var m=this;v(this,R),Y(this,"version",Cr.G.L7MAP),Y(this,"map",void 0),Y(this,"simpleMapCoord",new ke),Y(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),N(this,"config",Of,this),N(this,"configService",If,this),N(this,"coordinateSystemService",Rf,this),N(this,"eventEmitter",dl,this),Y(this,"viewport",void 0),Y(this,"markerContainer",void 0),Y(this,"cameraChangedCallback",void 0),Y(this,"$mapContainer",void 0),Y(this,"handleMiniCameraChanged",function(u,_,b,q,de){var ct=m.config.offsetCoordinate,st=ct===void 0?!0:ct;m.viewport.syncWithMapCamera({bearing:q,center:[u,_],viewportHeight:m.map.transform.height,pitch:de,viewportWidth:m.map.transform.width,zoom:b,cameraHeight:0}),m.viewport.getZoom()>Vf&&st?m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT_OFFSET):m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT),m.cameraChangedCallback(m.viewport)}),Y(this,"handleCameraChanged",function(){var u=m.map.getCenter(),_=u.lat,b=u.lng,q=m.config.offsetCoordinate,de=q===void 0?!0:q;m.emit("mapchange"),m.viewport.syncWithMapCamera({bearing:m.map.getBearing(),center:[b,_],viewportHeight:m.map.transform.height,pitch:m.map.getPitch(),viewportWidth:m.map.transform.width,zoom:m.map.getZoom(),cameraHeight:0}),m.viewport.getZoom()>Vf&&de?m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT_OFFSET):m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT),m.cameraChangedCallback(m.viewport)})}return a(R,[{key:"setBgColor",value:function(u){this.bgColor=u}},{key:"addMarkerContainer",value:function(){var u=this.map.getCanvasContainer();this.markerContainer=vr.DOM.create("div","l7-marker-container",u),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(u,_){ce.MapServiceEvent.indexOf(u)!==-1?this.eventEmitter.on(u,_):this.map.on(qf[u]||u,_)}},{key:"off",value:function(u,_){this.map.off(qf[u]||u,_),this.eventEmitter.off(u,_)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version===Cr.G.SIMPLE)return this.simpleMapCoord.getSize();var u=this.map.transform;return[u.width,u.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(u){return this.map.setZoom(u)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(u){this.map.setCenter(u)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(u){this.map.setBearing(u)}},{key:"zoomIn",value:function(u,_){this.map.zoomIn(u,_)}},{key:"zoomOut",value:function(u,_){this.map.zoomOut(u,_)}},{key:"setPitch",value:function(u){return this.map.setPitch(u)}},{key:"panTo",value:function(u){this.map.panTo(u)}},{key:"panBy",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([u,_])}},{key:"fitBounds",value:function(u,_){this.map.fitBounds(u,_)}},{key:"setMaxZoom",value:function(u){this.map.setMaxZoom(u)}},{key:"setMinZoom",value:function(u){this.map.setMinZoom(u)}},{key:"setMapStatus",value:function(u){u.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),u.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),u.dragEnable===!1&&this.map.dragPan.disable(),u.dragEnable===!0&&this.map.dragPan.enable(),u.rotateEnable===!1&&this.map.dragRotate.disable(),u.dragEnable===!0&&this.map.dragRotate.enable(),u.keyboardEnable===!1&&this.map.keyboard.disable(),u.keyboardEnable===!0&&this.map.keyboard.enable(),u.zoomEnable===!1&&this.map.scrollZoom.disable(),u.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(u,_){this.map.flyTo({zoom:u,center:_})}},{key:"setMapStyle",value:function(u){this.map.setStyle(this.getMapStyle(u))}},{key:"pixelToLngLat",value:function(u){return this.map.unproject(u)}},{key:"lngLatToPixel",value:function(u){return this.map.project(u)}},{key:"containerToLngLat",value:function(u){return this.map.unproject(u)}},{key:"lngLatToContainer",value:function(u){return this.map.project(u)}},{key:"lngLatToMercator",value:function(u,_){throw new Error("not implement")}},{key:"getModelMatrix",value:function(u,_,b){var q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],de=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var m=Pe(et().mark(function _(){var b,q,de,ct,st,Mt,Ir,Gr,xn,gn,Sn,Wn,bi,pa,Wa;return et().wrap(function(ro){for(;;)switch(ro.prev=ro.next){case 0:b=this.config,q=b.id,de=q===void 0?"map":q,ct=b.attributionControl,st=ct===void 0?!1:ct,Mt=b.style,Ir=Mt===void 0?"light":Mt,Gr=b.rotation,xn=Gr===void 0?0:Gr,gn=b.mapInstance,Sn=b.version,Wn=Sn===void 0?"L7MAP":Sn,bi=b.mapSize,pa=bi===void 0?1e4:bi,Wa=qt(b,Oc),this.viewport=new Lc,this.version=Wn,this.simpleMapCoord.setSize(pa),Wn===Cr.G.SIMPLE&&Wa.center&&(Wa.center=this.simpleMapCoord.unproject(Wa.center)),gn?(this.map=gn,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(de),this.map=new z(xh({container:this.$mapContainer,style:this.getMapStyle(Ir),bearing:xn},Wa))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return ro.stop()}},_,this)}));function u(){return m.apply(this,arguments)}return u}()},{key:"initMiniMap",value:function(){var m=Pe(et().mark(function _(){var b=this,q,de,ct,st,Mt,Ir,Gr,xn,gn,Sn,Wn,bi,pa,Wa,Qa,ro;return et().wrap(function(sa){for(;;)switch(sa.prev=sa.next){case 0:q=this.config,de=q.id,ct=de===void 0?"map":de,st=q.attributionControl,Mt=st===void 0?!1:st,Ir=q.style,Gr=Ir===void 0?"light":Ir,xn=q.rotation,gn=xn===void 0?0:xn,Sn=q.mapInstance,Wn=q.canvas,bi=Wn===void 0?null:Wn,pa=q.hasBaseMap,Wa=pa===void 0?!1:pa,Qa=qt(q,hu),this.viewport=new Lc,this.$mapContainer=bi,this.map=new z(xh({container:this.$mapContainer,style:this.getMapStyle(Gr),bearing:gn,canvas:bi},Qa)),Wa?(ro=this.map.getCenter(),this.handleMiniCameraChanged(ro.lng,ro.lat,this.map.getZoom(),this.map.getBearing(),this.map.getPitch()),vr.$window.document.addEventListener("mapCameaParams",function(_o){var xa=_o.e,xo=xa.longitude,ds=xa.latitude,ru=xa.scale,Rc=xa.bearing,mc=xa.pitch;b.handleMiniCameraChanged(xo,ds,ru-1.25,Rc,mc)})):(this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged());case 5:case"end":return sa.stop()}},_,this)}));function u(){return m.apply(this,arguments)}return u}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).emit.apply(_,[u].concat(q))}},{key:"once",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).once.apply(_,[u].concat(q))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(u){var _=this.map.getCanvas(),b=u==="jpg"?_==null?void 0:_.toDataURL("image/jpeg"):_==null?void 0:_.toDataURL("image/png");return b}},{key:"onCameraChanged",value:function(u){this.cameraChangedCallback=u}},{key:"creatAmapContainer",value:function(u){var _=u;return typeof u=="string"&&(_=document.getElementById(u)),_}},{key:"getMapStyle",value:function(u){return typeof u!="string"?u:lf[u]?lf[u]:u}}]),R}(),Of=H($c.prototype,"config",[Gf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),If=H($c.prototype,"configService",[Kf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rf=H($c.prototype,"coordinateSystemService",[Ef],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dl=H($c.prototype,"eventEmitter",[Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$c))||_h);function gp(R){var m=lh();return function(){var _=V(R),b;if(m){var q=V(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return B(this,b)}}function lh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}var Gh=function(R){L(u,R);var m=gp(u);function u(){return v(this,u),m.apply(this,arguments)}return a(u,[{key:"getServiceConstructor",value:function(){return bh}}]),u}(fe),Ph=y(6158),ch=y.n(Ph),Fu=function(){function R(){v(this,R),Y(this,"viewport",void 0)}return a(R,[{key:"syncWithMapCamera",value:function(u){var _=u.center,b=u.zoom,q=u.pitch,de=u.bearing,ct=u.viewportHeight,st=u.viewportWidth;this.viewport=new ku({width:st,height:ct,longitude:_&&_[0],latitude:_&&_[1],zoom:b,pitch:q,bearing:de})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(u,_){return this.viewport.projectFlat(u,_)}}]),R}(),Dl={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},ns=["id","attributionControl","style","token","rotation","mapInstance"],Qf,Df,Hf,Wf,Kc,kf,qc,Qc,Ic,C,ve;function $(R,m){var u=Object.keys(R);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(R);m&&(_=_.filter(function(b){return Object.getOwnPropertyDescriptor(R,b).enumerable})),u.push.apply(u,_)}return u}function ee(R){for(var m=1;m<arguments.length;m++){var u=arguments[m]!=null?arguments[m]:{};m%2?$(Object(u),!0).forEach(function(_){Y(R,_,u[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(u)):$(Object(u)).forEach(function(_){Object.defineProperty(R,_,Object.getOwnPropertyDescriptor(u,_))})}return R}function Ee(R,m){var u=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(u||_)&&(m||(m=document),!!m)){var b=m.head||m.getElementsByTagName("head")[0];if(!b){b=m.createElement("head");var q=m.body||m.getElementsByTagName("body")[0];q?q.parentNode.insertBefore(b,q):m.documentElement.appendChild(b)}var de=m.createElement("style");return de.type="text/css",de.styleSheet?de.styleSheet.cssText=R:de.appendChild(m.createTextNode(R)),b.appendChild(de),de}}Ee(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=ch();var We={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},er=0,hr=12,Kt="pk.eyJ1IjoibHp4dWUiLCJhIjoiY2tvaWZuM2s4MWZuYjJ1dHI5ZGduYTlrdiJ9.DQCfMRbZzx0VSwecQ69McA",kr=(Qf=(0,Ae.b2)(),Df=(0,Ae.f3)(ce.TYPES.MapConfig),Hf=(0,Ae.f3)(ce.TYPES.IGlobalConfigService),Wf=(0,Ae.f3)(ce.TYPES.ICoordinateSystemService),Kc=(0,Ae.f3)(ce.TYPES.IEventEmitter),Qf(kf=(qc=function(){function R(){var m=this;v(this,R),Y(this,"version",Cr.G.MAPBOX),Y(this,"map",void 0),Y(this,"simpleMapCoord",new ke),Y(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),N(this,"config",Qc,this),N(this,"configService",Ic,this),N(this,"coordinateSystemService",C,this),N(this,"eventEmitter",ve,this),Y(this,"viewport",void 0),Y(this,"markerContainer",void 0),Y(this,"cameraChangedCallback",void 0),Y(this,"$mapContainer",void 0),Y(this,"handleCameraChanged",function(){var u=m.map.getCenter().wrap(),_=u.lat,b=u.lng;m.emit("mapchange"),m.viewport.syncWithMapCamera({bearing:m.map.getBearing(),center:[b,_],viewportHeight:m.map.transform.height,pitch:m.map.getPitch(),viewportWidth:m.map.transform.width,zoom:m.map.getZoom(),cameraHeight:0});var q=m.config.offsetZoom,de=q===void 0?hr:q;m.viewport.getZoom()>de?m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT_OFFSET):m.coordinateSystemService.setCoordinateSystem(ce.CoordinateSystem.LNGLAT),m.cameraChangedCallback(m.viewport)})}return a(R,[{key:"setBgColor",value:function(u){this.bgColor=u}},{key:"addMarkerContainer",value:function(){var u=this.map.getCanvasContainer();this.markerContainer=vr.DOM.create("div","l7-marker-container",u),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(u,_){ce.MapServiceEvent.indexOf(u)!==-1?this.eventEmitter.on(u,_):this.map.on(We[u]||u,_)}},{key:"off",value:function(u,_){this.map.off(We[u]||u,_),this.eventEmitter.off(u,_)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var u=this.map.transform;return[u.width,u.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(u){return this.map.setZoom(u)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(u){this.map.setCenter(u)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(u){this.map.setBearing(u)}},{key:"zoomIn",value:function(u,_){this.map.zoomIn(u,_)}},{key:"zoomOut",value:function(u,_){this.map.zoomOut(u,_)}},{key:"setPitch",value:function(u){return this.map.setPitch(u)}},{key:"panTo",value:function(u){this.map.panTo(u)}},{key:"panBy",value:function(u,_){this.panTo([u,_])}},{key:"fitBounds",value:function(u,_){this.map.fitBounds(u,_)}},{key:"setMaxZoom",value:function(u){this.map.setMaxZoom(u)}},{key:"setMinZoom",value:function(u){this.map.setMinZoom(u)}},{key:"setMapStatus",value:function(u){u.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),u.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),u.dragEnable===!1&&this.map.dragPan.disable(),u.dragEnable===!0&&this.map.dragPan.enable(),u.rotateEnable===!1&&this.map.dragRotate.disable(),u.rotateEnable===!0&&this.map.dragRotate.enable(),u.keyboardEnable===!1&&this.map.keyboard.disable(),u.keyboardEnable===!0&&this.map.keyboard.enable(),u.zoomEnable===!1&&this.map.scrollZoom.disable(),u.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(u,_){this.map.flyTo({zoom:u,center:_})}},{key:"setMapStyle",value:function(u){this.map.setStyle(this.getMapStyle(u))}},{key:"pixelToLngLat",value:function(u){return this.map.unproject(u)}},{key:"lngLatToPixel",value:function(u){return this.map.project(u)}},{key:"containerToLngLat",value:function(u){return this.map.unproject(u)}},{key:"lngLatToContainer",value:function(u){return this.map.project(u)}},{key:"lngLatToCoord",value:function(u){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},b=this.lngLatToMercator(u,0),q=b.x,de=b.y;return[q-_.x,de-_.y]}},{key:"lngLatToMercator",value:function(u,_){var b=window.mapboxgl.MercatorCoordinate.fromLngLat(u,_),q=b.x,de=q===void 0?0:q,ct=b.y,st=ct===void 0?0:ct,Mt=b.z,Ir=Mt===void 0?0:Mt;return{x:de,y:st,z:Ir}}},{key:"getModelMatrix",value:function(u,_,b){var q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],de=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},ct=window.mapboxgl.MercatorCoordinate.fromLngLat(u,_),st=ct.meterInMercatorCoordinateUnits(),Mt=jr.create();return jr.translate(Mt,Mt,xr.fromValues(ct.x-de.x,ct.y-de.y,ct.z||0-de.z)),jr.scale(Mt,Mt,xr.fromValues(st*q[0],-st*q[1],st*q[2])),jr.rotateX(Mt,Mt,b[0]),jr.rotateY(Mt,Mt,b[1]),jr.rotateZ(Mt,Mt,b[2]),Mt}},{key:"init",value:function(){var m=Pe(et().mark(function _(){var b,q,de,ct,st,Mt,Ir,Gr,xn,gn,Sn,Wn,bi;return et().wrap(function(Wa){for(;;)switch(Wa.prev=Wa.next){case 0:b=this.config,q=b.id,de=q===void 0?"map":q,ct=b.attributionControl,st=ct===void 0?!1:ct,Mt=b.style,Ir=Mt===void 0?"light":Mt,Gr=b.token,xn=Gr===void 0?Kt:Gr,gn=b.rotation,Sn=gn===void 0?0:gn,Wn=b.mapInstance,bi=qt(b,ns),this.viewport=new Fu,!Wn&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),xn===Kt&&Ir!=="blank"&&!window.mapboxgl.accessToken&&!Wn&&console.warn(this.configService.getSceneWarninfo("MapToken")),!Wn&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=xn),Wn?(this.map=Wn,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(de),this.map=new window.mapboxgl.Map(ee({container:this.$mapContainer,style:this.getMapStyle(Ir),attributionControl:st,bearing:Sn},bi))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Wa.stop()}},_,this)}));function u(){return m.apply(this,arguments)}return u}()},{key:"destroy",value:function(){var u,_;(u=this.$mapContainer)===null||u===void 0||(_=u.parentNode)===null||_===void 0||_.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).emit.apply(_,[u].concat(q))}},{key:"once",value:function(u){for(var _,b=arguments.length,q=new Array(b>1?b-1:0),de=1;de<b;de++)q[de-1]=arguments[de];(_=this.eventEmitter).once.apply(_,[u].concat(q))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(u,_){var b=new(ch()).LngLat(u[0],u[1]),q=new(ch()).LngLat(_[0],_[1]),de=b.distanceTo(q),ct=ch().MercatorCoordinate.fromLngLat({lng:u[0],lat:u[1]}),st=ch().MercatorCoordinate.fromLngLat({lng:_[0],lat:_[1]}),Mt=ct.x,Ir=ct.y,Gr=st.x,xn=st.y,gn=Math.sqrt(Math.pow(Mt-Gr,2)+Math.pow(Ir-xn,2))*4194304*2;return gn/de}},{key:"exportMap",value:function(u){var _=this.map.getCanvas(),b=u==="jpg"?_==null?void 0:_.toDataURL("image/jpeg"):_==null?void 0:_.toDataURL("image/png");return b}},{key:"onCameraChanged",value:function(u){this.cameraChangedCallback=u}},{key:"creatAmapContainer",value:function(u){var _=u;typeof u=="string"&&(_=document.getElementById(u));var b=document.createElement("div");return b.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,b.id="l7_mapbox_div"+er++,_.appendChild(b),b}},{key:"getMapStyle",value:function(u){return typeof u!="string"?u:Dl[u]?Dl[u]:u}}]),R}(),Qc=H(qc.prototype,"config",[Df],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ic=H(qc.prototype,"configService",[Hf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=H(qc.prototype,"coordinateSystemService",[Wf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=H(qc.prototype,"eventEmitter",[Kc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qc))||kf);function wn(R){var m=Ai();return function(){var _=V(R),b;if(m){var q=V(this).constructor;b=Reflect.construct(_,arguments,q)}else b=_.apply(this,arguments);return B(this,b)}}function Ai(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(R){return!1}}function Hi(R,m){var u=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(u||_)&&(m||(m=document),!!m)){var b=m.head||m.getElementsByTagName("head")[0];if(!b){b=m.createElement("head");var q=m.body||m.getElementsByTagName("body")[0];q?q.parentNode.insertBefore(b,q):m.documentElement.appendChild(b)}var de=m.createElement("style");return de.type="text/css",de.styleSheet?de.styleSheet.cssText=R:de.appendChild(m.createTextNode(R)),b.appendChild(de),de}}Hi(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var $i=function(R){L(u,R);var m=wn(u);function u(){return v(this,u),m.apply(this,arguments)}return a(u,[{key:"getServiceConstructor",value:function(){return kr}}]),u}(fe)},84859:function(Ft,A,y){"use strict";y.d(A,{G:function(){return v}});var v;(function(Z){Z["GAODE1.x"]="GAODE1.x",Z["GAODE2.x"]="GAODE2.x",Z.MAPBOX="MAPBOX",Z.L7MAP="L7MAP",Z.SIMPLE="SIMPLE",Z.GLOBEL="GLOBEL"})(v||(v={}))},71035:function(Ft,A,y){Ft.exports=y(17445)},22233:function(Ft,A,y){Ft.exports=y(17445)},20110:function(Ft,A,y){"use strict";y.r(A),y.d(A,{Scene:function(){return li}});function v($r){if(Array.isArray($r))return $r}function Z($r,Zt){var it=$r==null?null:typeof Symbol!="undefined"&&$r[Symbol.iterator]||$r["@@iterator"];if(it!=null){var ne=[],_e=!0,Oe=!1,je,dt;try{for(it=it.call($r);!(_e=(je=it.next()).done)&&(ne.push(je.value),!(Zt&&ne.length===Zt));_e=!0);}catch(Ut){Oe=!0,dt=Ut}finally{try{!_e&&it.return!=null&&it.return()}finally{if(Oe)throw dt}}return ne}}function a($r,Zt){(Zt==null||Zt>$r.length)&&(Zt=$r.length);for(var it=0,ne=new Array(Zt);it<Zt;it++)ne[it]=$r[it];return ne}function P($r,Zt){if(!!$r){if(typeof $r=="string")return a($r,Zt);var it=Object.prototype.toString.call($r).slice(8,-1);if(it==="Object"&&$r.constructor&&(it=$r.constructor.name),it==="Map"||it==="Set")return Array.from($r);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return a($r,Zt)}}function L(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O($r,Zt){return v($r)||Z($r,Zt)||P($r,Zt)||L()}function D($r,Zt){if(!($r instanceof Zt))throw new TypeError("Cannot call a class as a function")}function B($r,Zt){for(var it=0;it<Zt.length;it++){var ne=Zt[it];ne.enumerable=ne.enumerable||!1,ne.configurable=!0,"value"in ne&&(ne.writable=!0),Object.defineProperty($r,ne.key,ne)}}function V($r,Zt,it){return Zt&&B($r.prototype,Zt),it&&B($r,it),Object.defineProperty($r,"prototype",{writable:!1}),$r}function N($r,Zt,it){return Zt in $r?Object.defineProperty($r,Zt,{value:it,enumerable:!0,configurable:!0,writable:!0}):$r[Zt]=it,$r}var Y=y(66845),H=y(39128),ce=y(27630);function at($r,Zt,it,ne,_e,Oe,je){try{var dt=$r[Oe](je),Ut=dt.value}catch(ur){it(ur);return}dt.done?Zt(Ut):Promise.resolve(Ut).then(ne,_e)}function rt($r){return function(){var Zt=this,it=arguments;return new Promise(function(ne,_e){var Oe=$r.apply(Zt,it);function je(Ut){at(Oe,ne,_e,je,dt,"next",Ut)}function dt(Ut){at(Oe,ne,_e,je,dt,"throw",Ut)}je(void 0)})}}function Re($r,Zt){if(!($r instanceof Zt))throw new TypeError("Cannot call a class as a function")}function vt($r,Zt){for(var it=0;it<Zt.length;it++){var ne=Zt[it];ne.enumerable=ne.enumerable||!1,ne.configurable=!0,"value"in ne&&(ne.writable=!0),Object.defineProperty($r,ne.key,ne)}}function wt($r,Zt,it){return Zt&&vt($r.prototype,Zt),it&&vt($r,it),Object.defineProperty($r,"prototype",{writable:!1}),$r}function fe($r,Zt,it){return Zt in $r?Object.defineProperty($r,Zt,{value:it,enumerable:!0,configurable:!0,writable:!0}):$r[Zt]=it,$r}var $e=y(22233),re=y.n($e),Ge=y(86049),Qe=y(86700),Te=y(88307),Le=y.n(Te),Ce=y(28660),Fe=function(){function $r(Zt,it){Re(this,$r),fe(this,"attribute",void 0),fe(this,"buffer",void 0);var ne=it.buffer,_e=it.offset,Oe=it.stride,je=it.normalized,dt=it.size,Ut=it.divisor;this.buffer=ne,this.attribute={buffer:ne.get(),offset:_e||0,stride:Oe||0,normalized:je||!1,divisor:Ut||0},dt&&(this.attribute.size=dt)}return wt($r,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(it){this.buffer.subData(it)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),$r}(),Ke,qt,ir,Pe,Ne,Xe,kt,rr,me,et,or,on,vr,jr,xr=(Ke={},fe(Ke,H.gl.POINTS,"points"),fe(Ke,H.gl.LINES,"lines"),fe(Ke,H.gl.LINE_LOOP,"line loop"),fe(Ke,H.gl.LINE_STRIP,"line strip"),fe(Ke,H.gl.TRIANGLES,"triangles"),fe(Ke,H.gl.TRIANGLE_FAN,"triangle fan"),fe(Ke,H.gl.TRIANGLE_STRIP,"triangle strip"),Ke),Ae=(qt={},fe(qt,H.gl.STATIC_DRAW,"static"),fe(qt,H.gl.DYNAMIC_DRAW,"dynamic"),fe(qt,H.gl.STREAM_DRAW,"stream"),qt),De=(ir={},fe(ir,H.gl.BYTE,"int8"),fe(ir,H.gl.UNSIGNED_INT,"int16"),fe(ir,H.gl.INT,"int32"),fe(ir,H.gl.UNSIGNED_BYTE,"uint8"),fe(ir,H.gl.UNSIGNED_SHORT,"uint16"),fe(ir,H.gl.UNSIGNED_INT,"uint32"),fe(ir,H.gl.FLOAT,"float"),ir),ke=(Pe={},fe(Pe,H.gl.ALPHA,"alpha"),fe(Pe,H.gl.LUMINANCE,"luminance"),fe(Pe,H.gl.LUMINANCE_ALPHA,"luminance alpha"),fe(Pe,H.gl.RGB,"rgb"),fe(Pe,H.gl.RGBA,"rgba"),fe(Pe,H.gl.RGBA4,"rgba4"),fe(Pe,H.gl.RGB5_A1,"rgb5 a1"),fe(Pe,H.gl.RGB565,"rgb565"),fe(Pe,H.gl.DEPTH_COMPONENT,"depth"),fe(Pe,H.gl.DEPTH_STENCIL,"depth stencil"),Pe),Bt=(Ne={},fe(Ne,H.gl.DONT_CARE,"dont care"),fe(Ne,H.gl.NICEST,"nice"),fe(Ne,H.gl.FASTEST,"fast"),Ne),mt=(Xe={},fe(Xe,H.gl.NEAREST,"nearest"),fe(Xe,H.gl.LINEAR,"linear"),fe(Xe,H.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),fe(Xe,H.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),fe(Xe,H.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),fe(Xe,H.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Xe),Mr=(kt={},fe(kt,H.gl.REPEAT,"repeat"),fe(kt,H.gl.CLAMP_TO_EDGE,"clamp"),fe(kt,H.gl.MIRRORED_REPEAT,"mirror"),kt),Cr=(rr={},fe(rr,H.gl.NONE,"none"),fe(rr,H.gl.BROWSER_DEFAULT_WEBGL,"browser"),rr),Nr=(me={},fe(me,H.gl.NEVER,"never"),fe(me,H.gl.ALWAYS,"always"),fe(me,H.gl.LESS,"less"),fe(me,H.gl.LEQUAL,"lequal"),fe(me,H.gl.GREATER,"greater"),fe(me,H.gl.GEQUAL,"gequal"),fe(me,H.gl.EQUAL,"equal"),fe(me,H.gl.NOTEQUAL,"notequal"),me),nt=(et={},fe(et,H.gl.FUNC_ADD,"add"),fe(et,H.gl.MIN_EXT,"min"),fe(et,H.gl.MAX_EXT,"max"),fe(et,H.gl.FUNC_SUBTRACT,"subtract"),fe(et,H.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),et),Ye=(or={},fe(or,H.gl.ZERO,"zero"),fe(or,H.gl.ONE,"one"),fe(or,H.gl.SRC_COLOR,"src color"),fe(or,H.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),fe(or,H.gl.SRC_ALPHA,"src alpha"),fe(or,H.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),fe(or,H.gl.DST_COLOR,"dst color"),fe(or,H.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),fe(or,H.gl.DST_ALPHA,"dst alpha"),fe(or,H.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),fe(or,H.gl.CONSTANT_COLOR,"constant color"),fe(or,H.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),fe(or,H.gl.CONSTANT_ALPHA,"constant alpha"),fe(or,H.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),fe(or,H.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),or),M=(on={},fe(on,H.gl.NEVER,"never"),fe(on,H.gl.ALWAYS,"always"),fe(on,H.gl.LESS,"less"),fe(on,H.gl.LEQUAL,"lequal"),fe(on,H.gl.GREATER,"greater"),fe(on,H.gl.GEQUAL,"gequal"),fe(on,H.gl.EQUAL,"equal"),fe(on,H.gl.NOTEQUAL,"notequal"),on),W=(vr={},fe(vr,H.gl.ZERO,"zero"),fe(vr,H.gl.KEEP,"keep"),fe(vr,H.gl.REPLACE,"replace"),fe(vr,H.gl.INVERT,"invert"),fe(vr,H.gl.INCR,"increment"),fe(vr,H.gl.DECR,"decrement"),fe(vr,H.gl.INCR_WRAP,"increment wrap"),fe(vr,H.gl.DECR_WRAP,"decrement wrap"),vr),ue=(jr={},fe(jr,H.gl.FRONT,"front"),fe(jr,H.gl.BACK,"back"),jr),X=function(){function $r(Zt,it){Re(this,$r),fe(this,"buffer",void 0);var ne=it.data,_e=it.usage,Oe=it.type;this.buffer=Zt.buffer({data:ne,usage:Ae[_e||H.gl.STATIC_DRAW],type:De[Oe||H.gl.UNSIGNED_BYTE]})}return wt($r,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(it){var ne=it.data,_e=it.offset;this.buffer.subdata(ne,_e)}}]),$r}(),ie=function(){function $r(Zt,it){Re(this,$r),fe(this,"elements",void 0);var ne=it.data,_e=it.usage,Oe=it.type,je=it.count;this.elements=Zt.elements({data:ne,usage:Ae[_e||H.gl.STATIC_DRAW],type:De[Oe||H.gl.UNSIGNED_BYTE],count:je})}return wt($r,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(it){var ne=it.data;this.elements.subdata(ne)}},{key:"destroy",value:function(){}}]),$r}(),ye=function(){function $r(Zt,it){Re(this,$r),fe(this,"framebuffer",void 0);var ne=it.width,_e=it.height,Oe=it.color,je=it.colors,dt=it.depth,Ut=it.stencil,ur={width:ne,height:_e};Array.isArray(je)&&(ur.colors=je.map(function(lt){return lt.get()})),Oe&&typeof Oe!="boolean"&&(ur.color=Oe.get()),this.framebuffer=Zt.framebuffer(ur)}return wt($r,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(it){var ne=it.width,_e=it.height;this.framebuffer.resize(ne,_e)}}]),$r}();function J($r){return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Zt){return typeof Zt}:function(Zt){return Zt&&typeof Symbol=="function"&&Zt.constructor===Symbol&&Zt!==Symbol.prototype?"symbol":typeof Zt},J($r)}var ht=y(36719),ze=y.n(ht),pt=y(68630),Me=y.n(pt),Ue=y(50361),yt=y.n(Ue);function gt($r,Zt){var it=Object.keys($r);if(Object.getOwnPropertySymbols){var ne=Object.getOwnPropertySymbols($r);Zt&&(ne=ne.filter(function(_e){return Object.getOwnPropertyDescriptor($r,_e).enumerable})),it.push.apply(it,ne)}return it}function nr($r){for(var Zt=1;Zt<arguments.length;Zt++){var it=arguments[Zt]!=null?arguments[Zt]:{};Zt%2?gt(Object(it),!0).forEach(function(ne){fe($r,ne,it[ne])}):Object.getOwnPropertyDescriptors?Object.defineProperties($r,Object.getOwnPropertyDescriptors(it)):gt(Object(it)).forEach(function(ne){Object.defineProperty($r,ne,Object.getOwnPropertyDescriptor(it,ne))})}return $r}var pe=function(){function $r(Zt,it){Re(this,$r),fe(this,"reGl",void 0),fe(this,"destroyed",!1),fe(this,"drawCommand",void 0),fe(this,"drawPickCommand",void 0),fe(this,"drawParams",void 0),fe(this,"options",void 0),fe(this,"uniforms",{}),this.reGl=Zt;var ne=it.vs,_e=it.fs,Oe=it.attributes,je=it.uniforms,dt=it.primitive,Ut=it.count,ur=it.elements,lt=it.depth,Nt=it.blend,Sr=it.stencil,fn=it.cull,Br=it.instances,Jr={};this.options=it,je&&(this.uniforms=this.extractUniforms(je),Object.keys(je).forEach(function(Pr){Jr[Pr]=Zt.prop(Pr)}));var Tn={};Object.keys(Oe).forEach(function(Pr){Tn[Pr]=Oe[Pr].get()});var hi={attributes:Tn,frag:_e,uniforms:Jr,vert:ne,blend:{},primitive:xr[dt===void 0?H.gl.TRIANGLES:dt]};Br&&(hi.instances=Br),Ut&&(hi.count=Ut),ur&&(hi.elements=ur.get()),this.initDepthDrawParams({depth:lt},hi),this.initBlendDrawParams({blend:Nt},hi),this.initStencilDrawParams({stencil:Sr},hi),this.initCullDrawParams({cull:fn},hi),this.drawCommand=Zt(hi);var On=yt()(hi);On.blend=nr(nr({},On.blend),{},{enable:!1}),this.drawPickCommand=Zt(On),this.drawParams=hi}return wt($r,[{key:"updateAttributes",value:function(it){var ne={};Object.keys(it).forEach(function(Oe){ne[Oe]=it[Oe].get()}),this.drawParams.attributes=ne,this.drawCommand=this.reGl(this.drawParams);var _e=yt()(this.drawParams);_e.blend=nr(nr({},_e.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(_e)}},{key:"addUniforms",value:function(it){this.uniforms=nr(nr({},this.uniforms),this.extractUniforms(it))}},{key:"draw",value:function(it,ne){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var _e=nr(nr({},this.uniforms),this.extractUniforms(it.uniforms||{})),Oe={};Object.keys(_e).forEach(function(je){var dt=J(_e[je]);dt==="boolean"||dt==="number"||Array.isArray(_e[je])||_e[je].BYTES_PER_ELEMENT?Oe[je]=_e[je]:Oe[je]=_e[je].get()}),ne?this.drawPickCommand(Oe):this.drawCommand(Oe)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(it){it.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(it,ne){var _e=it.depth;_e&&(ne.depth={enable:_e.enable===void 0?!0:!!_e.enable,mask:_e.mask===void 0?!0:!!_e.mask,func:Nr[_e.func||H.gl.LESS],range:_e.range||[0,1]})}},{key:"initBlendDrawParams",value:function(it,ne){var _e=it.blend;if(_e){var Oe=_e.enable,je=_e.func,dt=_e.equation,Ut=_e.color,ur=Ut===void 0?[0,0,0,0]:Ut;ne.blend={enable:!!Oe,func:{srcRGB:Ye[je&&je.srcRGB||H.gl.SRC_ALPHA],srcAlpha:Ye[je&&je.srcAlpha||H.gl.SRC_ALPHA],dstRGB:Ye[je&&je.dstRGB||H.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Ye[je&&je.dstAlpha||H.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:nt[dt&&dt.rgb||H.gl.FUNC_ADD],alpha:nt[dt&&dt.alpha||H.gl.FUNC_ADD]},color:ur}}}},{key:"initStencilDrawParams",value:function(it,ne){var _e=it.stencil;if(_e){var Oe=_e.enable,je=_e.mask,dt=je===void 0?-1:je,Ut=_e.func,ur=Ut===void 0?{cmp:H.gl.ALWAYS,ref:0,mask:-1}:Ut,lt=_e.opFront,Nt=lt===void 0?{fail:H.gl.KEEP,zfail:H.gl.KEEP,zpass:H.gl.KEEP}:lt,Sr=_e.opBack,fn=Sr===void 0?{fail:H.gl.KEEP,zfail:H.gl.KEEP,zpass:H.gl.KEEP}:Sr;ne.stencil={enable:!!Oe,mask:dt,func:nr(nr({},ur),{},{cmp:M[ur.cmp]}),opFront:{fail:W[Nt.fail],zfail:W[Nt.zfail],zpass:W[Nt.zpass]},opBack:{fail:W[fn.fail],zfail:W[fn.zfail],zpass:W[fn.zpass]}}}}},{key:"initCullDrawParams",value:function(it,ne){var _e=it.cull;if(_e){var Oe=_e.enable,je=_e.face,dt=je===void 0?H.gl.BACK:je;ne.cull={enable:!!Oe,face:ue[dt]}}}},{key:"extractUniforms",value:function(it){var ne=this,_e={};return Object.keys(it).forEach(function(Oe){ne.extractUniformsRecursively(Oe,it[Oe],_e,"")}),_e}},{key:"extractUniformsRecursively",value:function(it,ne,_e,Oe){var je=this;if(ne===null||typeof ne=="number"||typeof ne=="boolean"||Array.isArray(ne)&&typeof ne[0]=="number"||ze()(ne)||ne===""||"resize"in ne){_e["".concat(Oe&&Oe+".").concat(it)]=ne;return}Me()(ne)&&Object.keys(ne).forEach(function(dt){je.extractUniformsRecursively(dt,ne[dt],_e,"".concat(Oe&&Oe+".").concat(it))}),Array.isArray(ne)&&ne.forEach(function(dt,Ut){Object.keys(dt).forEach(function(ur){je.extractUniformsRecursively(ur,dt[ur],_e,"".concat(Oe&&Oe+".").concat(it,"[").concat(Ut,"]"))})})}}]),$r}(),lr=function(){function $r(Zt,it){Re(this,$r),fe(this,"texture",void 0),fe(this,"width",void 0),fe(this,"height",void 0),fe(this,"isDistroy",!1);var ne=it.data,_e=it.type,Oe=_e===void 0?H.gl.UNSIGNED_BYTE:_e,je=it.width,dt=it.height,Ut=it.flipY,ur=Ut===void 0?!1:Ut,lt=it.format,Nt=lt===void 0?H.gl.RGBA:lt,Sr=it.mipmap,fn=Sr===void 0?!1:Sr,Br=it.wrapS,Jr=Br===void 0?H.gl.CLAMP_TO_EDGE:Br,Tn=it.wrapT,hi=Tn===void 0?H.gl.CLAMP_TO_EDGE:Tn,On=it.aniso,Pr=On===void 0?0:On,vi=it.alignment,Jn=vi===void 0?1:vi,ui=it.premultiplyAlpha,Da=ui===void 0?!1:ui,Yn=it.mag,wa=Yn===void 0?H.gl.NEAREST:Yn,vo=it.min,Ua=vo===void 0?H.gl.NEAREST:vo,Ka=it.colorSpace,Ga=Ka===void 0?H.gl.BROWSER_DEFAULT_WEBGL:Ka,ei=it.x,eo=ei===void 0?0:ei,ra=it.y,Rn=ra===void 0?0:ra,qa=it.copy,ba=qa===void 0?!1:qa;this.width=je,this.height=dt;var Na={width:je,height:dt,type:De[Oe],format:ke[Nt],wrapS:Mr[Jr],wrapT:Mr[hi],mag:mt[wa],min:mt[Ua],alignment:Jn,flipY:ur,colorSpace:Cr[Ga],premultiplyAlpha:Da,aniso:Pr,x:eo,y:Rn,copy:ba};ne&&(Na.data=ne),typeof fn=="number"?Na.mipmap=Bt[fn]:typeof fn=="boolean"&&(Na.mipmap=fn),this.texture=Zt.texture(Na)}return wt($r,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(it)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(it){var ne=it.width,_e=it.height;this.texture.resize(ne,_e),this.width=ne,this.height=_e}},{key:"destroy",value:function(){if(!this.isDistroy){var it;(it=this.texture)===null||it===void 0||it.destroy()}this.isDistroy=!0}}]),$r}(),Ur,Hr,un=(Ur=(0,Qe.b2)(),Ur(Hr=function(){function $r(){var Zt=this;Re(this,$r),fe(this,"extensionObject",void 0),fe(this,"gl",void 0),fe(this,"$container",void 0),fe(this,"canvas",void 0),fe(this,"width",void 0),fe(this,"height",void 0),fe(this,"isDirty",void 0),fe(this,"createModel",function(it){return new pe(Zt.gl,it)}),fe(this,"createAttribute",function(it){return new Fe(Zt.gl,it)}),fe(this,"createBuffer",function(it){return new X(Zt.gl,it)}),fe(this,"createElements",function(it){return new ie(Zt.gl,it)}),fe(this,"createTexture2D",function(it){return new lr(Zt.gl,it)}),fe(this,"createFramebuffer",function(it){return new ye(Zt.gl,it)}),fe(this,"useFramebuffer",function(it,ne){Zt.gl({framebuffer:it?it.get():null})(ne)}),fe(this,"clear",function(it){var ne=it.color,_e=it.depth,Oe=it.stencil,je=it.framebuffer,dt=je===void 0?null:je,Ut={color:ne,depth:_e,stencil:Oe};Ut.framebuffer=dt===null?dt:dt.get(),Zt.gl.clear(Ut)}),fe(this,"viewport",function(it){var ne=it.x,_e=it.y,Oe=it.width,je=it.height;Zt.gl._gl.viewport(ne,_e,Oe,je),Zt.width=Oe,Zt.height=je,Zt.gl._refresh()}),fe(this,"readPixels",function(it){var ne=it.framebuffer,_e=it.x,Oe=it.y,je=it.width,dt=it.height,Ut={x:_e,y:Oe,width:je,height:dt};return ne&&(Ut.framebuffer=ne.get()),Zt.gl.read(Ut)}),fe(this,"getViewportSize",function(){return{width:Zt.gl._gl.drawingBufferWidth,height:Zt.gl._gl.drawingBufferHeight}}),fe(this,"getContainer",function(){if(Ge.isMini)return Zt.canvas;var it;return(it=Zt.canvas)===null||it===void 0?void 0:it.parentElement}),fe(this,"getCanvas",function(){return Zt.canvas}),fe(this,"getGLContext",function(){return Zt.gl._gl}),fe(this,"destroy",function(){Zt.canvas=null,Zt.gl.destroy(),Zt.gl=null})}return wt($r,[{key:"init",value:function(){var Zt=rt(re().mark(function ne(_e,Oe){var je=this;return re().wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:return this.canvas=_e,Ut.next=3,new Promise(function(ur,lt){Le()({canvas:je.canvas,attributes:{alpha:!0,antialias:Oe.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Oe.preserveDrawingBuffer,stencil:Oe.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(Sr,fn){(Sr||!fn)&&lt(Sr),ur(fn)}})});case 3:this.gl=Ut.sent,this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 5:case"end":return Ut.stop()}},ne,this)}));function it(ne,_e){return Zt.apply(this,arguments)}return it}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(it){return!!this.getGLContext().getExtension(it)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var it=this.getGLContext();it.disable(it.CULL_FACE)}},{key:"setDirty",value:function(it){this.isDirty=it}},{key:"getDirty",value:function(){return this.isDirty}}]),$r}())||Hr);function bn($r,Zt){var it=Object.keys($r);if(Object.getOwnPropertySymbols){var ne=Object.getOwnPropertySymbols($r);Zt&&(ne=ne.filter(function(_e){return Object.getOwnPropertyDescriptor($r,_e).enumerable})),it.push.apply(it,ne)}return it}function Gn($r){for(var Zt=1;Zt<arguments.length;Zt++){var it=arguments[Zt]!=null?arguments[Zt]:{};Zt%2?bn(Object(it),!0).forEach(function(ne){N($r,ne,it[ne])}):Object.getOwnPropertyDescriptors?Object.defineProperties($r,Object.getOwnPropertyDescriptors(it)):bn(Object(it)).forEach(function(ne){Object.defineProperty($r,ne,Object.getOwnPropertyDescriptor(it,ne))})}return $r}var li=function(){function $r(Zt){D(this,$r),N(this,"sceneService",void 0),N(this,"mapService",void 0),N(this,"controlService",void 0),N(this,"layerService",void 0),N(this,"iconService",void 0),N(this,"markerService",void 0),N(this,"popupService",void 0),N(this,"fontService",void 0),N(this,"interactionService",void 0),N(this,"container",void 0);var it=Zt.id,ne=Zt.map,_e=Zt.canvas,Oe=Zt.hasBaseMap,je=(0,H.createSceneContainer)();this.container=je,ne.setContainer(je,it,_e,Oe),je.bind(H.TYPES.IRendererService).to(un).inSingletonScope(),this.sceneService=je.get(H.TYPES.ISceneService),this.mapService=je.get(H.TYPES.IMapService),this.iconService=je.get(H.TYPES.IIconService),this.fontService=je.get(H.TYPES.IFontService),this.controlService=je.get(H.TYPES.IControlService),this.layerService=je.get(H.TYPES.ILayerService),this.markerService=je.get(H.TYPES.IMarkerService),this.interactionService=je.get(H.TYPES.IInteractionService),this.popupService=je.get(H.TYPES.IPopupService),Ge.isMini?this.sceneService.initMiniScene(Zt):(this.initComponent(it),this.sceneService.init(Zt),this.initControl())}return V($r,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(it){return this.sceneService.exportPng(it)}},{key:"exportMap",value:function(it){return this.sceneService.exportPng(it)}},{key:"registerRenderService",value:function(it){var ne=this;if(this.sceneService.loaded){var _e=new it(this);_e.init()}else this.on("loaded",function(){var Oe=new it(ne);Oe.init()})}},{key:"setBgColor",value:function(it){this.mapService.setBgColor(it)}},{key:"addLayer",value:function(it){var ne=(0,H.createLayerContainer)(this.container);it.setContainer(ne,this.container),this.sceneService.addLayer(it);var _e=it.getLayerConfig();if(_e){var Oe=_e.mask,je=_e.maskfence,dt=_e.maskColor,Ut=dt===void 0?"#000":dt,ur=_e.maskOpacity,lt=ur===void 0?0:ur;if(Oe&&je){var Nt=new ce.Z().source(je).shape("fill").color(Ut).style({opacity:lt});this.addMask(Nt,it.id)}}else console.warn("addLayer should run after scene loaded!")}},{key:"addMask",value:function(it,ne){var _e=this.getLayer(ne);if(_e){var Oe=(0,H.createLayerContainer)(this.container);it.setContainer(Oe,this.container),_e.addMaskLayer(it),this.sceneService.addLayer(it)}else console.warn("parent layer not find!")}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(it){return this.layerService.getLayer(it)}},{key:"getLayerByName",value:function(it){return this.layerService.getLayerByName(it)}},{key:"removeLayer",value:function(it,ne){this.layerService.remove(it,ne)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(it){this.layerService.setEnableRender(it)}},{key:"addIconFont",value:function(it,ne){this.fontService.addIconFont(it,ne)}},{key:"addIconFonts",value:function(it){var ne=this;it.forEach(function(_e){var Oe=O(_e,2),je=Oe[0],dt=Oe[1];ne.fontService.addIconFont(je,dt)})}},{key:"addFontFace",value:function(it,ne){this.sceneService.addFontFace(it,ne)}},{key:"addImage",value:function(it,ne){Ge.isMini?this.iconService.addImageMini(it,ne,this.sceneService):this.iconService.addImage(it,ne)}},{key:"hasImage",value:function(it){return this.iconService.hasImage(it)}},{key:"removeImage",value:function(it){this.iconService.removeImage(it)}},{key:"addIconFontGlyphs",value:function(it,ne){this.fontService.addIconGlyphs(ne)}},{key:"addControl",value:function(it){this.controlService.addControl(it,this.container)}},{key:"removeControl",value:function(it){this.controlService.removeControl(it)}},{key:"getControlByName",value:function(it){return this.controlService.getControlByName(it)}},{key:"addMarker",value:function(it){this.markerService.addMarker(it)}},{key:"addMarkerLayer",value:function(it){this.markerService.addMarkerLayer(it)}},{key:"removeMarkerLayer",value:function(it){this.markerService.removeMarkerLayer(it)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(it){this.popupService.addPopup(it)}},{key:"on",value:function(it,ne){H.SceneEventList.indexOf(it)===-1?this.mapService.on(it,ne):this.sceneService.on(it,ne)}},{key:"once",value:function(it,ne){H.SceneEventList.indexOf(it)===-1?this.mapService.once(it,ne):this.sceneService.once(it,ne)}},{key:"off",value:function(it,ne){H.SceneEventList.indexOf(it)===-1?this.mapService.off(it,ne):this.sceneService.off(it,ne)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(it){return this.mapService.getCenter(it)}},{key:"setCenter",value:function(it,ne){return this.mapService.setCenter(it,ne)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(it){return this.mapService.setPitch(it)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(it){this.mapService.setRotation(it)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(it){this.mapService.panTo(it)}},{key:"panBy",value:function(it,ne){this.mapService.panBy(it,ne)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(it){this.mapService.setZoom(it)}},{key:"fitBounds",value:function(it,ne){var _e=this.sceneService.getSceneConfig(),Oe=_e.fitBoundsOptions,je=_e.animate;this.mapService.fitBounds(it,ne||Gn(Gn({},Oe),{},{animate:je}))}},{key:"setZoomAndCenter",value:function(it,ne){this.mapService.setZoomAndCenter(it,ne)}},{key:"setMapStyle",value:function(it){this.mapService.setMapStyle(it)}},{key:"setMapStatus",value:function(it){this.mapService.setMapStatus(it)}},{key:"pixelToLngLat",value:function(it){return this.mapService.pixelToLngLat(it)}},{key:"lngLatToPixel",value:function(it){return this.mapService.lngLatToPixel(it)}},{key:"containerToLngLat",value:function(it){return this.mapService.containerToLngLat(it)}},{key:"lngLatToContainer",value:function(it){return this.mapService.lngLatToContainer(it)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(it,ne){this.container.bind(H.TYPES.IPostProcessingPass).to(it).whenTargetNamed(ne)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(it){this.controlService.init({container:Ge.DOM.getContainer(it)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var it=this.sceneService.getSceneConfig(),ne=it.logoVisible,_e=it.logoPosition;ne&&this.addControl(new Y.Logo({position:_e}))}}]),$r}()},96090:function(Ft,A,y){"use strict";y.r(A),y.d(A,{DEFAULT_DATA:function(){return $n},DEFAULT_PARSER:function(){return Gi},default:function(){return to},getParser:function(){return a},getTransform:function(){return L},registerParser:function(){return P},registerTransform:function(){return O}});var v={},Z={},a=function(It){return Z[It]},P=function(It,Ot){Z[It]=Ot},L=function(It){return v[It]},O=function(It,Ot){v[It]=Ot},D={},B={},V=34,N=10,Y=13;function H(Je){return new Function("d","return {"+Je.map(function(It,Ot){return JSON.stringify(It)+": d["+Ot+'] || ""'}).join(",")+"}")}function ce(Je,It){var Ot=H(Je);return function(Xt,Dr){return It(Ot(Xt),Dr,Je)}}function at(Je){var It=Object.create(null),Ot=[];return Je.forEach(function(Xt){for(var Dr in Xt)Dr in It||Ot.push(It[Dr]=Dr)}),Ot}function rt(Je,It){var Ot=Je+"",Xt=Ot.length;return Xt<It?new Array(It-Xt+1).join(0)+Ot:Ot}function Re(Je){return Je<0?"-"+rt(-Je,6):Je>9999?"+"+rt(Je,6):rt(Je,4)}function vt(Je){var It=Je.getUTCHours(),Ot=Je.getUTCMinutes(),Xt=Je.getUTCSeconds(),Dr=Je.getUTCMilliseconds();return isNaN(Je)?"Invalid Date":Re(Je.getUTCFullYear(),4)+"-"+rt(Je.getUTCMonth()+1,2)+"-"+rt(Je.getUTCDate(),2)+(Dr?"T"+rt(It,2)+":"+rt(Ot,2)+":"+rt(Xt,2)+"."+rt(Dr,3)+"Z":Xt?"T"+rt(It,2)+":"+rt(Ot,2)+":"+rt(Xt,2)+"Z":Ot||It?"T"+rt(It,2)+":"+rt(Ot,2)+"Z":"")}function wt(Je){var It=new RegExp('["'+Je+`
\r]`),Ot=Je.charCodeAt(0);function Xt(Fn,ci){var ia,_a,ao=Dr(Fn,function(Yo,Vo){if(ia)return ia(Yo,Vo-1);_a=Yo,ia=ci?ce(Yo,ci):H(Yo)});return ao.columns=_a||[],ao}function Dr(Fn,ci){var ia=[],_a=Fn.length,ao=0,Yo=0,Vo,Bo=_a<=0,mo=!1;Fn.charCodeAt(_a-1)===N&&--_a,Fn.charCodeAt(_a-1)===Y&&--_a;function Do(){if(Bo)return B;if(mo)return mo=!1,D;var g,U=ao,he;if(Fn.charCodeAt(U)===V){for(;ao++<_a&&Fn.charCodeAt(ao)!==V||Fn.charCodeAt(++ao)===V;);return(g=ao)>=_a?Bo=!0:(he=Fn.charCodeAt(ao++))===N?mo=!0:he===Y&&(mo=!0,Fn.charCodeAt(ao)===N&&++ao),Fn.slice(U+1,g-1).replace(/""/g,'"')}for(;ao<_a;){if((he=Fn.charCodeAt(g=ao++))===N)mo=!0;else if(he===Y)mo=!0,Fn.charCodeAt(ao)===N&&++ao;else if(he!==Ot)continue;return Fn.slice(U,g)}return Bo=!0,Fn.slice(U,_a)}for(;(Vo=Do())!==B;){for(var ps=[];Vo!==D&&Vo!==B;)ps.push(Vo),Vo=Do();ci&&(ps=ci(ps,Yo++))==null||ia.push(ps)}return ia}function Lr(Fn,ci){return Fn.map(function(ia){return ci.map(function(_a){return Oa(ia[_a])}).join(Je)})}function _n(Fn,ci){return ci==null&&(ci=at(Fn)),[ci.map(Oa).join(Je)].concat(Lr(Fn,ci)).join(`
`)}function Un(Fn,ci){return ci==null&&(ci=at(Fn)),Lr(Fn,ci).join(`
`)}function mn(Fn){return Fn.map(mi).join(`
`)}function mi(Fn){return Fn.map(Oa).join(Je)}function Oa(Fn){return Fn==null?"":Fn instanceof Date?vt(Fn):It.test(Fn+="")?'"'+Fn.replace(/"/g,'""')+'"':Fn}return{parse:Xt,parseRows:Dr,format:_n,formatBody:Un,formatRows:mn,formatRow:mi,formatValue:Oa}}var fe=wt(","),$e=fe.parse,re=fe.parseRows,Ge=fe.format,Qe=fe.formatBody,Te=fe.formatRows,Le=fe.formatRow,Ce=fe.formatValue;function Fe(Je,It,Ot){return It in Je?Object.defineProperty(Je,It,{value:Ot,enumerable:!0,configurable:!0,writable:!0}):Je[It]=Ot,Je}function Ke(Je,It){(It==null||It>Je.length)&&(It=Je.length);for(var Ot=0,Xt=new Array(It);Ot<It;Ot++)Xt[Ot]=Je[Ot];return Xt}function qt(Je){if(Array.isArray(Je))return Ke(Je)}function ir(Je){if(typeof Symbol!="undefined"&&Je[Symbol.iterator]!=null||Je["@@iterator"]!=null)return Array.from(Je)}function Pe(Je,It){if(!!Je){if(typeof Je=="string")return Ke(Je,It);var Ot=Object.prototype.toString.call(Je).slice(8,-1);if(Ot==="Object"&&Je.constructor&&(Ot=Je.constructor.name),Ot==="Map"||Ot==="Set")return Array.from(Je);if(Ot==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ot))return Ke(Je,It)}}function Ne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xe(Je){return qt(Je)||ir(Je)||Pe(Je)||Ne()}var kt=y(38163),rr=y.n(kt);function me(Je,It){var Ot=Object.keys(Je);if(Object.getOwnPropertySymbols){var Xt=Object.getOwnPropertySymbols(Je);It&&(Xt=Xt.filter(function(Dr){return Object.getOwnPropertyDescriptor(Je,Dr).enumerable})),Ot.push.apply(Ot,Xt)}return Ot}function et(Je){for(var It=1;It<arguments.length;It++){var Ot=arguments[It]!=null?arguments[It]:{};It%2?me(Object(Ot),!0).forEach(function(Xt){Fe(Je,Xt,Ot[Xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Je,Object.getOwnPropertyDescriptors(Ot)):me(Object(Ot)).forEach(function(Xt){Object.defineProperty(Je,Xt,Object.getOwnPropertyDescriptor(Ot,Xt))})}return Je}function or(Je,It){var Ot=It.x,Xt=It.y,Dr=It.x1,Lr=It.y1,_n=It.coordinates,Un=[];return Array.isArray(Je)?(Je.forEach(function(mn,mi){var Oa=[];if(Ot&&Xt&&(Oa=[parseFloat(mn[Ot]),parseFloat(mn[Xt])]),Ot&&Xt&&Dr&&Lr){var Fn=[parseFloat(mn[Ot]),parseFloat(mn[Xt])],ci=[parseFloat(mn[Dr]),parseFloat(mn[Lr])];Oa=[Fn,ci]}if(_n){var ia="Polygon";Array.isArray(_n[0])||(ia="Point"),Array.isArray(_n[0])&&!Array.isArray(_n[0][0])&&(ia="LineString");var _a={type:ia,coordinates:Xe(mn[_n])};rr()(_a,!0),Oa=_a.coordinates}var ao=et(et({},mn),{},{_id:mi,coordinates:Oa});Un.push(ao)}),{dataArray:Un}):{dataArray:[]}}var on=[{lng1:100,lat1:30,lng2:130,lat2:30}],vr={parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}};function jr(Je,It){var Ot=$e(Je);return or(Ot,It)}var xr=y(40271);function Ae(Je){if(!Je)throw new Error("coord is required");if(!Array.isArray(Je)){if(Je.type==="Feature"&&Je.geometry!==null&&Je.geometry.type==="Point")return Je.geometry.coordinates;if(Je.type==="Point")return Je.coordinates}if(Array.isArray(Je)&&Je.length>=2&&!Array.isArray(Je[0])&&!Array.isArray(Je[1]))return Je;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function De(Je){if(Array.isArray(Je))return Je;if(Je.type==="Feature"){if(Je.geometry!==null)return Je.geometry.coordinates}else if(Je.coordinates)return Je.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ke(Je){if(Je.length>1&&isNumber(Je[0])&&isNumber(Je[1]))return!0;if(Array.isArray(Je[0])&&Je[0].length)return ke(Je[0]);throw new Error("coordinates must only contain numbers")}function Bt(Je,It,Ot){if(!It||!Ot)throw new Error("type and name required");if(!Je||Je.type!==It)throw new Error("Invalid input to "+Ot+": must be a "+It+", given "+Je.type)}function mt(Je,It,Ot){if(!Je)throw new Error("No feature passed");if(!Ot)throw new Error(".featureOf() requires a name");if(!Je||Je.type!=="Feature"||!Je.geometry)throw new Error("Invalid input to "+Ot+", Feature with geometry required");if(!Je.geometry||Je.geometry.type!==It)throw new Error("Invalid input to "+Ot+": must be a "+It+", given "+Je.geometry.type)}function Mr(Je,It,Ot){if(!Je)throw new Error("No featureCollection passed");if(!Ot)throw new Error(".collectionOf() requires a name");if(!Je||Je.type!=="FeatureCollection")throw new Error("Invalid input to "+Ot+", FeatureCollection required");for(var Xt=0,Dr=Je.features;Xt<Dr.length;Xt++){var Lr=Dr[Xt];if(!Lr||Lr.type!=="Feature"||!Lr.geometry)throw new Error("Invalid input to "+Ot+", Feature with geometry required");if(!Lr.geometry||Lr.geometry.type!==It)throw new Error("Invalid input to "+Ot+": must be a "+It+", given "+Lr.geometry.type)}}function Cr(Je){return Je.type==="Feature"?Je.geometry:Je}function Nr(Je,It){return Je.type==="FeatureCollection"?"FeatureCollection":Je.type==="GeometryCollection"?"GeometryCollection":Je.type==="Feature"&&Je.geometry!==null?Je.geometry.type:Je.type}function nt(Je,It,Ot){if(Je!==null)for(var Xt,Dr,Lr,_n,Un,mn,mi,Oa=0,Fn=0,ci,ia=Je.type,_a=ia==="FeatureCollection",ao=ia==="Feature",Yo=_a?Je.features.length:1,Vo=0;Vo<Yo;Vo++){mi=_a?Je.features[Vo].geometry:ao?Je.geometry:Je,ci=mi?mi.type==="GeometryCollection":!1,Un=ci?mi.geometries.length:1;for(var Bo=0;Bo<Un;Bo++){var mo=0,Do=0;if(_n=ci?mi.geometries[Bo]:mi,_n!==null){mn=_n.coordinates;var ps=_n.type;switch(Oa=Ot&&(ps==="Polygon"||ps==="MultiPolygon")?1:0,ps){case null:break;case"Point":if(It(mn,Fn,Vo,mo,Do)===!1)return!1;Fn++,mo++;break;case"LineString":case"MultiPoint":for(Xt=0;Xt<mn.length;Xt++){if(It(mn[Xt],Fn,Vo,mo,Do)===!1)return!1;Fn++,ps==="MultiPoint"&&mo++}ps==="LineString"&&mo++;break;case"Polygon":case"MultiLineString":for(Xt=0;Xt<mn.length;Xt++){for(Dr=0;Dr<mn[Xt].length-Oa;Dr++){if(It(mn[Xt][Dr],Fn,Vo,mo,Do)===!1)return!1;Fn++}ps==="MultiLineString"&&mo++,ps==="Polygon"&&Do++}ps==="Polygon"&&mo++;break;case"MultiPolygon":for(Xt=0;Xt<mn.length;Xt++){for(Do=0,Dr=0;Dr<mn[Xt].length;Dr++){for(Lr=0;Lr<mn[Xt][Dr].length-Oa;Lr++){if(It(mn[Xt][Dr][Lr],Fn,Vo,mo,Do)===!1)return!1;Fn++}Do++}mo++}break;case"GeometryCollection":for(Xt=0;Xt<_n.geometries.length;Xt++)if(nt(_n.geometries[Xt],It,Ot)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ye(Je,It,Ot,Xt){var Dr=Ot;return nt(Je,function(Lr,_n,Un,mn,mi){_n===0&&Ot===void 0?Dr=Lr:Dr=It(Dr,Lr,_n,Un,mn,mi)},Xt),Dr}function M(Je,It){var Ot;switch(Je.type){case"FeatureCollection":for(Ot=0;Ot<Je.features.length&&It(Je.features[Ot].properties,Ot)!==!1;Ot++);break;case"Feature":It(Je.properties,0);break}}function W(Je,It,Ot){var Xt=Ot;return M(Je,function(Dr,Lr){Lr===0&&Ot===void 0?Xt=Dr:Xt=It(Xt,Dr,Lr)}),Xt}function ue(Je,It){if(Je.type==="Feature")It(Je,0);else if(Je.type==="FeatureCollection")for(var Ot=0;Ot<Je.features.length&&It(Je.features[Ot],Ot)!==!1;Ot++);}function X(Je,It,Ot){var Xt=Ot;return ue(Je,function(Dr,Lr){Lr===0&&Ot===void 0?Xt=Dr:Xt=It(Xt,Dr,Lr)}),Xt}function ie(Je){var It=[];return nt(Je,function(Ot){It.push(Ot)}),It}function ye(Je,It){var Ot,Xt,Dr,Lr,_n,Un,mn,mi,Oa,Fn,ci=0,ia=Je.type==="FeatureCollection",_a=Je.type==="Feature",ao=ia?Je.features.length:1;for(Ot=0;Ot<ao;Ot++){for(Un=ia?Je.features[Ot].geometry:_a?Je.geometry:Je,mi=ia?Je.features[Ot].properties:_a?Je.properties:{},Oa=ia?Je.features[Ot].bbox:_a?Je.bbox:void 0,Fn=ia?Je.features[Ot].id:_a?Je.id:void 0,mn=Un?Un.type==="GeometryCollection":!1,_n=mn?Un.geometries.length:1,Dr=0;Dr<_n;Dr++){if(Lr=mn?Un.geometries[Dr]:Un,Lr===null){if(It(null,ci,mi,Oa,Fn)===!1)return!1;continue}switch(Lr.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(It(Lr,ci,mi,Oa,Fn)===!1)return!1;break}case"GeometryCollection":{for(Xt=0;Xt<Lr.geometries.length;Xt++)if(It(Lr.geometries[Xt],ci,mi,Oa,Fn)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ci++}}function J(Je,It,Ot){var Xt=Ot;return ye(Je,function(Dr,Lr,_n,Un,mn){Lr===0&&Ot===void 0?Xt=Dr:Xt=It(Xt,Dr,Lr,_n,Un,mn)}),Xt}function ht(Je,It){ye(Je,function(Ot,Xt,Dr,Lr,_n){var Un=Ot===null?null:Ot.type;switch(Un){case null:case"Point":case"LineString":case"Polygon":return It((0,xr.zL)(Ot,Dr,{bbox:Lr,id:_n}),Xt,0)===!1?!1:void 0}var mn;switch(Un){case"MultiPoint":mn="Point";break;case"MultiLineString":mn="LineString";break;case"MultiPolygon":mn="Polygon";break}for(var mi=0;mi<Ot.coordinates.length;mi++){var Oa=Ot.coordinates[mi],Fn={type:mn,coordinates:Oa};if(It((0,xr.zL)(Fn,Dr),Xt,mi)===!1)return!1}})}function ze(Je,It,Ot){var Xt=Ot;return ht(Je,function(Dr,Lr,_n){Lr===0&&_n===0&&Ot===void 0?Xt=Dr:Xt=It(Xt,Dr,Lr,_n)}),Xt}function pt(Je,It){ht(Je,function(Ot,Xt,Dr){var Lr=0;if(!!Ot.geometry){var _n=Ot.geometry.type;if(!(_n==="Point"||_n==="MultiPoint")){var Un,mn=0,mi=0,Oa=0;if(nt(Ot,function(Fn,ci,ia,_a,ao){if(Un===void 0||Xt>mn||_a>mi||ao>Oa){Un=Fn,mn=Xt,mi=_a,Oa=ao,Lr=0;return}var Yo=lineString([Un,Fn],Ot.properties);if(It(Yo,Xt,Dr,ao,Lr)===!1)return!1;Lr++,Un=Fn})===!1)return!1}}})}function Me(Je,It,Ot){var Xt=Ot,Dr=!1;return pt(Je,function(Lr,_n,Un,mn,mi){Dr===!1&&Ot===void 0?Xt=Lr:Xt=It(Xt,Lr,_n,Un,mn,mi),Dr=!0}),Xt}function Ue(Je,It){if(!Je)throw new Error("geojson is required");ht(Je,function(Ot,Xt,Dr){if(Ot.geometry!==null){var Lr=Ot.geometry.type,_n=Ot.geometry.coordinates;switch(Lr){case"LineString":if(It(Ot,Xt,Dr,0,0)===!1)return!1;break;case"Polygon":for(var Un=0;Un<_n.length;Un++)if(It(lineString(_n[Un],Ot.properties),Xt,Dr,Un)===!1)return!1;break}}})}function yt(Je,It,Ot){var Xt=Ot;return Ue(Je,function(Dr,Lr,_n,Un){Lr===0&&Ot===void 0?Xt=Dr:Xt=It(Xt,Dr,Lr,_n,Un)}),Xt}function gt(Je,It){if(It=It||{},!isObject(It))throw new Error("options is invalid");var Ot=It.featureIndex||0,Xt=It.multiFeatureIndex||0,Dr=It.geometryIndex||0,Lr=It.segmentIndex||0,_n=It.properties,Un;switch(Je.type){case"FeatureCollection":Ot<0&&(Ot=Je.features.length+Ot),_n=_n||Je.features[Ot].properties,Un=Je.features[Ot].geometry;break;case"Feature":_n=_n||Je.properties,Un=Je.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Un=Je;break;default:throw new Error("geojson is invalid")}if(Un===null)return null;var mn=Un.coordinates;switch(Un.type){case"Point":case"MultiPoint":return null;case"LineString":return Lr<0&&(Lr=mn.length+Lr-1),lineString([mn[Lr],mn[Lr+1]],_n,It);case"Polygon":return Dr<0&&(Dr=mn.length+Dr),Lr<0&&(Lr=mn[Dr].length+Lr-1),lineString([mn[Dr][Lr],mn[Dr][Lr+1]],_n,It);case"MultiLineString":return Xt<0&&(Xt=mn.length+Xt),Lr<0&&(Lr=mn[Xt].length+Lr-1),lineString([mn[Xt][Lr],mn[Xt][Lr+1]],_n,It);case"MultiPolygon":return Xt<0&&(Xt=mn.length+Xt),Dr<0&&(Dr=mn[Xt].length+Dr),Lr<0&&(Lr=mn[Xt][Dr].length-Lr-1),lineString([mn[Xt][Dr][Lr],mn[Xt][Dr][Lr+1]],_n,It)}throw new Error("geojson is invalid")}function nr(Je,It){if(It=It||{},!isObject(It))throw new Error("options is invalid");var Ot=It.featureIndex||0,Xt=It.multiFeatureIndex||0,Dr=It.geometryIndex||0,Lr=It.coordIndex||0,_n=It.properties,Un;switch(Je.type){case"FeatureCollection":Ot<0&&(Ot=Je.features.length+Ot),_n=_n||Je.features[Ot].properties,Un=Je.features[Ot].geometry;break;case"Feature":_n=_n||Je.properties,Un=Je.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Un=Je;break;default:throw new Error("geojson is invalid")}if(Un===null)return null;var mn=Un.coordinates;switch(Un.type){case"Point":return point(mn,_n,It);case"MultiPoint":return Xt<0&&(Xt=mn.length+Xt),point(mn[Xt],_n,It);case"LineString":return Lr<0&&(Lr=mn.length+Lr),point(mn[Lr],_n,It);case"Polygon":return Dr<0&&(Dr=mn.length+Dr),Lr<0&&(Lr=mn[Dr].length+Lr),point(mn[Dr][Lr],_n,It);case"MultiLineString":return Xt<0&&(Xt=mn.length+Xt),Lr<0&&(Lr=mn[Xt].length+Lr),point(mn[Xt][Lr],_n,It);case"MultiPolygon":return Xt<0&&(Xt=mn.length+Xt),Dr<0&&(Dr=mn[Xt].length+Dr),Lr<0&&(Lr=mn[Xt][Dr].length-Lr),point(mn[Xt][Dr][Lr],_n,It)}throw new Error("geojson is invalid")}function pe(Je,It){var Ot=Object.keys(Je);if(Object.getOwnPropertySymbols){var Xt=Object.getOwnPropertySymbols(Je);It&&(Xt=Xt.filter(function(Dr){return Object.getOwnPropertyDescriptor(Je,Dr).enumerable})),Ot.push.apply(Ot,Xt)}return Ot}function lr(Je){for(var It=1;It<arguments.length;It++){var Ot=arguments[It]!=null?arguments[It]:{};It%2?pe(Object(Ot),!0).forEach(function(Xt){Fe(Je,Xt,Ot[Xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Je,Object.getOwnPropertyDescriptors(Ot)):pe(Object(Ot)).forEach(function(Xt){Object.defineProperty(Je,Xt,Object.getOwnPropertyDescriptor(Ot,Xt))})}return Je}function Ur(Je,It){var Ot=[],Xt={};if(Je.features=Je.features.filter(function(Lr){var _n=Lr.geometry;return Lr!=null&&_n&&_n.type&&_n.coordinates&&_n.coordinates.length>0}),rr()(Je,!0),Je.features.length===0)return{dataArray:[],featureKeys:Xt};var Dr=0;return ht(Je,function(Lr,_n){var Un=De(Lr),mn=_n,mi=lr(lr({},Lr.properties),{},{coordinates:Un,_id:mn});Ot.push(mi)}),{dataArray:Ot,featureKeys:Xt}}var Hr=y(86049);function un(Je,It){var Ot=It.extent,Xt=Ot===void 0?[121.168,30.2828,121.384,30.4219]:Ot,Dr=new Promise(function(_n){bn(Je,function(Un){_n(Un)})}),Lr={originData:Je,images:Dr,_id:1,dataArray:[{_id:0,coordinates:[[Xt[0],Xt[1]],[Xt[2],Xt[3]]]}]};return Lr}function bn(Je,It){var Ot=Je,Xt=[];if(typeof Ot=="string")(0,Hr.getImage)({url:Ot},function(_n,Un){Xt.push(Un),It(Xt)});else{var Dr=Ot.length,Lr=0;Ot.forEach(function(_n){(0,Hr.getImage)({url:_n},function(Un,mn){Lr++,Xt.push(mn),Lr===Dr&&It(Xt)})})}return un}function Gn(Je,It){var Ot=It.extent,Xt=It.width,Dr=It.height,Lr=It.min,_n=It.max,Un={_id:1,dataArray:[{_id:1,data:Array.from(Je),width:Xt,height:Dr,min:Lr,max:_n,coordinates:[[Ot[0],Ot[1]],[Ot[2],Ot[3]]]}]};return Un}function li(Je,It){if(!(Je instanceof It))throw new TypeError("Cannot call a class as a function")}function $r(Je,It){for(var Ot=0;Ot<It.length;Ot++){var Xt=It[Ot];Xt.enumerable=Xt.enumerable||!1,Xt.configurable=!0,"value"in Xt&&(Xt.writable=!0),Object.defineProperty(Je,Xt.key,Xt)}}function Zt(Je,It,Ot){return It&&$r(Je.prototype,It),Ot&&$r(Je,Ot),Object.defineProperty(Je,"prototype",{writable:!1}),Je}function it(Je){if(Je===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Je}function ne(Je,It){return ne=Object.setPrototypeOf||function(Xt,Dr){return Xt.__proto__=Dr,Xt},ne(Je,It)}function _e(Je,It){if(typeof It!="function"&&It!==null)throw new TypeError("Super expression must either be null or a function");Je.prototype=Object.create(It&&It.prototype,{constructor:{value:Je,writable:!0,configurable:!0}}),Object.defineProperty(Je,"prototype",{writable:!1}),It&&ne(Je,It)}function Oe(Je){return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(It){return typeof It}:function(It){return It&&typeof Symbol=="function"&&It.constructor===Symbol&&It!==Symbol.prototype?"symbol":typeof It},Oe(Je)}function je(Je,It){if(It&&(Oe(It)==="object"||typeof It=="function"))return It;if(It!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return it(Je)}function dt(Je){return dt=Object.setPrototypeOf?Object.getPrototypeOf:function(Ot){return Ot.__proto__||Object.getPrototypeOf(Ot)},dt(Je)}var Ut=y(30236),ur=y.n(Ut),lt=y(47037),Nt=y.n(lt),Sr=y(23560),fn=y.n(Sr),Br=y(50361),Jr=y.n(Br),Tn=y(46343),hi=y(26729),On=y(69848),Pr=y.n(On);function vi(Je,It){var Ot=Object.keys(Je);if(Object.getOwnPropertySymbols){var Xt=Object.getOwnPropertySymbols(Je);It&&(Xt=Xt.filter(function(Dr){return Object.getOwnPropertyDescriptor(Je,Dr).enumerable})),Ot.push.apply(Ot,Xt)}return Ot}function Jn(Je){for(var It=1;It<arguments.length;It++){var Ot=arguments[It]!=null?arguments[It]:{};It%2?vi(Object(Ot),!0).forEach(function(Xt){Fe(Je,Xt,Ot[Xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Je,Object.getOwnPropertyDescriptors(Ot)):vi(Object(Ot)).forEach(function(Xt){Object.defineProperty(Je,Xt,Object.getOwnPropertyDescriptor(Ot,Xt))})}return Je}function ui(Je,It){var Ot=It.radius,Xt=Ot===void 0?40:Ot,Dr=It.maxZoom,Lr=Dr===void 0?18:Dr,_n=It.minZoom,Un=_n===void 0?0:_n,mn=It.zoom,mi=mn===void 0?2:mn;if(Je.pointIndex){var Oa=Je.pointIndex.getClusters(Je.extent,Math.floor(mi));return Je.dataArray=Da(Oa),Je}var Fn=new(Pr())({radius:Xt,minZoom:Un,maxZoom:Lr}),ci={type:"FeatureCollection",features:[]};return ci.features=Je.dataArray.map(function(ia){return{type:"Feature",geometry:{type:"Point",coordinates:ia.coordinates},properties:Jn({},ia)}}),Fn.load(ci.features),Fn}function Da(Je){return Je.map(function(It,Ot){return Jn({coordinates:It.geometry.coordinates,_id:Ot+1},It.properties)})}function Yn(Je){if(Je.length===0)throw new Error("max requires at least one data point");for(var It=Je[0],Ot=1;Ot<Je.length;Ot++)Je[Ot]>It&&(It=Je[Ot]);return It}function wa(Je){if(Je.length===0)throw new Error("min requires at least one data point");for(var It=Je[0],Ot=1;Ot<Je.length;Ot++)Je[Ot]<It&&(It=Je[Ot]);return It}function vo(Je){if(Je.length===0)return 0;for(var It=Je[0],Ot=0,Xt,Dr=1;Dr<Je.length;Dr++)Xt=It+Je[Dr]*1,Math.abs(It)>=Math.abs(Je[Dr])?Ot+=It-Xt+Je[Dr]:Ot+=Je[Dr]-Xt+It,It=Xt;return It+Ot*1}function Ua(Je){if(Je.length===0)throw new Error("mean requires at least one data point");return vo(Je)/Je.length}var Ka={min:wa,max:Yn,mean:Ua,sum:vo};function Ga(Je,It){return Je.map(function(Ot){return Ot[It]*1})}function ei(Je,It){var Ot=Object.keys(Je);if(Object.getOwnPropertySymbols){var Xt=Object.getOwnPropertySymbols(Je);It&&(Xt=Xt.filter(function(Dr){return Object.getOwnPropertyDescriptor(Je,Dr).enumerable})),Ot.push.apply(Ot,Xt)}return Ot}function eo(Je){for(var It=1;It<arguments.length;It++){var Ot=arguments[It]!=null?arguments[It]:{};It%2?ei(Object(Ot),!0).forEach(function(Xt){Fe(Je,Xt,Ot[Xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Je,Object.getOwnPropertyDescriptors(Ot)):ei(Object(Ot)).forEach(function(Xt){Object.defineProperty(Je,Xt,Object.getOwnPropertyDescriptor(Ot,Xt))})}return Je}function ra(Je){var It=Rn();return function(){var Xt=dt(Je),Dr;if(It){var Lr=dt(this).constructor;Dr=Reflect.construct(Xt,arguments,Lr)}else Dr=Xt.apply(this,arguments);return je(this,Dr)}}function Rn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Je){return!1}}function qa(Je,It){if(Array.isArray(It))return It}var ba=function(Je){_e(Ot,Je);var It=ra(Ot);function Ot(Xt,Dr){var Lr;return li(this,Ot),Lr=It.call(this),Fe(it(Lr),"data",void 0),Fe(it(Lr),"extent",void 0),Fe(it(Lr),"hooks",{init:new Tn.ni}),Fe(it(Lr),"parser",{type:"geojson"}),Fe(it(Lr),"transforms",[]),Fe(it(Lr),"cluster",!1),Fe(it(Lr),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),Fe(it(Lr),"mapService",void 0),Fe(it(Lr),"invalidExtent",!1),Fe(it(Lr),"dataArrayChanged",!1),Fe(it(Lr),"originData",void 0),Fe(it(Lr),"rawData",void 0),Fe(it(Lr),"cfg",{}),Fe(it(Lr),"clusterIndex",void 0),Lr.originData=Xt,Lr.initCfg(Dr),Lr.hooks.init.tap("parser",function(){Lr.excuteParser()}),Lr.hooks.init.tap("cluster",function(){Lr.initCluster()}),Lr.hooks.init.tap("transform",function(){Lr.executeTrans()}),Lr.init(),Lr}return Zt(Ot,[{key:"setData",value:function(Dr,Lr){this.originData=Dr,this.dataArrayChanged=!1,this.initCfg(Lr),this.init(),this.emit("update")}},{key:"getClusters",value:function(Dr){return this.clusterIndex.getClusters(this.caculClusterExtent(2),Dr)}},{key:"getClustersLeaves",value:function(Dr){return this.clusterIndex.getLeaves(Dr,Infinity)}},{key:"updateClusterData",value:function(Dr){var Lr=this,_n=this.clusterOptions,Un=_n.method,mn=Un===void 0?"sum":Un,mi=_n.field,Oa=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(Dr));this.clusterOptions.zoom=Dr,Oa.forEach(function(Fn){Fn.id||(Fn.properties.point_count=1)}),(mi||fn()(mn))&&(Oa=Oa.map(function(Fn){var ci=Fn.id;if(ci){var ia=Lr.clusterIndex.getLeaves(ci,Infinity),_a=ia.map(function(Vo){return Vo.properties}),ao;if(Nt()(mn)&&mi){var Yo=Ga(_a,mi);ao=Ka[mn](Yo)}fn()(mn)&&(ao=mn(_a)),Fn.properties.stat=ao}else Fn.properties.point_count=1;return Fn})),this.data=a("geojson")({type:"FeatureCollection",features:Oa}),this.executeTrans()}},{key:"getFeatureById",value:function(Dr){var Lr=this.parser.type,_n=Lr===void 0?"geojson":Lr;if(_n==="geojson"&&!this.cluster){var Un=Dr<this.originData.features.length?this.originData.features[Dr]:"null",mn=Jr()(Un);if(this.transforms.length!==0||this.dataArrayChanged){var mi=this.data.dataArray.find(function(Oa){return Oa._id===Dr});mn.properties=mi}return mn}else return Dr<this.data.dataArray.length?this.data.dataArray[Dr]:"null"}},{key:"updateFeaturePropertiesById",value:function(Dr,Lr){this.data.dataArray=this.data.dataArray.map(function(_n){return _n._id===Dr?eo(eo({},_n),Lr):_n}),this.dataArrayChanged=!0,this.emit("update")}},{key:"getFeatureId",value:function(Dr,Lr){var _n=this.data.dataArray.find(function(Un){return Un[Dr]===Lr});return _n==null?void 0:_n._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(Dr){var Lr=[[-Infinity,-Infinity],[Infinity,Infinity]];return this.invalidExtent||(Lr=(0,Hr.padBounds)((0,Hr.bBoxToBounds)(this.extent),Dr)),Lr[0].concat(Lr[1])}},{key:"initCfg",value:function(Dr){this.cfg=ur()(this.cfg,Dr,qa);var Lr=this.cfg;Lr&&(Lr.parser&&(this.parser=Lr.parser),Lr.transforms&&(this.transforms=Lr.transforms),this.cluster=Lr.cluster||!1,Lr.clusterOptions&&(this.cluster=!0,this.clusterOptions=eo(eo({},this.clusterOptions),Lr.clusterOptions)))}},{key:"excuteParser",value:function(){var Dr=this.parser,Lr=Dr.type||"geojson";if(Lr==="imagetile"){this.data={tileurl:this.originData,dataArray:[]};return}var _n=a(Lr);this.data=_n(this.originData,Dr),this.extent=(0,Hr.extent)(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}},{key:"executeTrans",value:function(){var Dr=this,Lr=this.transforms;Lr.forEach(function(_n){var Un=_n.type,mn=L(Un)(Dr.data,_n);Object.assign(Dr.data,mn)})}},{key:"initCluster",value:function(){if(!!this.cluster){var Dr=this.clusterOptions||{};this.clusterIndex=ui(this.data,Dr)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),Ot}(hi.EventEmitter);function Na(Je,It){var Ot=It.callback;return Ot&&(Je.dataArray=Je.dataArray.filter(Ot)),Je}function wo(Je,It){var Ot=typeof Symbol!="undefined"&&Je[Symbol.iterator]||Je["@@iterator"];if(!Ot){if(Array.isArray(Je)||(Ot=ya(Je))||It&&Je&&typeof Je.length=="number"){Ot&&(Je=Ot);var Xt=0,Dr=function(){};return{s:Dr,n:function(){return Xt>=Je.length?{done:!0}:{done:!1,value:Je[Xt++]}},e:function(mi){throw mi},f:Dr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Lr=!0,_n=!1,Un;return{s:function(){Ot=Ot.call(Je)},n:function(){var mi=Ot.next();return Lr=mi.done,mi},e:function(mi){_n=!0,Un=mi},f:function(){try{!Lr&&Ot.return!=null&&Ot.return()}finally{if(_n)throw Un}}}}function ya(Je,It){if(!!Je){if(typeof Je=="string")return Gt(Je,It);var Ot=Object.prototype.toString.call(Je).slice(8,-1);if(Ot==="Object"&&Je.constructor&&(Ot=Je.constructor.name),Ot==="Map"||Ot==="Set")return Array.from(Je);if(Ot==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ot))return Gt(Je,It)}}function Gt(Je,It){(It==null||It>Je.length)&&(It=Je.length);for(var Ot=0,Xt=new Array(It);Ot<It;Ot++)Xt[Ot]=Je[Ot];return Xt}var gs=6378e3;function Qi(Je,It){var Ot=Je.dataArray,Xt=It.size,Dr=Xt===void 0?10:Xt,Lr=Dr/(2*Math.PI*gs)*(256<<20)/2,_n=So(Ot,Dr),Un=_n.gridHash,mn=_n.gridOffset,mi=ls(Un,mn,It);return{yOffset:Lr,xOffset:Lr,radius:Lr,type:"grid",dataArray:mi}}function So(Je,It){var Ot=Infinity,Xt=-Infinity,Dr,Lr=wo(Je),_n;try{for(Lr.s();!(_n=Lr.n()).done;){var Un=_n.value;Dr=Un.coordinates[1],Number.isFinite(Dr)&&(Ot=Dr<Ot?Dr:Ot,Xt=Dr>Xt?Dr:Xt)}}catch(mo){Lr.e(mo)}finally{Lr.f()}var mn=(Ot+Xt)/2,mi=ll(It,mn);if(mi.xOffset<=0||mi.yOffset<=0)return{gridHash:{},gridOffset:mi};var Oa={},Fn=wo(Je),ci;try{for(Fn.s();!(ci=Fn.n()).done;){var ia=ci.value,_a=ia.coordinates[1],ao=ia.coordinates[0];if(Number.isFinite(_a)&&Number.isFinite(ao)){var Yo=Math.floor((_a+90)/mi.yOffset),Vo=Math.floor((ao+180)/mi.xOffset),Bo="".concat(Yo,"-").concat(Vo);Oa[Bo]=Oa[Bo]||{count:0,points:[]},Oa[Bo].count+=1,Oa[Bo].points.push(ia)}}}catch(mo){Fn.e(mo)}finally{Fn.f()}return{gridHash:Oa,gridOffset:mi}}function ll(Je,It){var Ot=Ss(Je),Xt=rs(It,Je);return{yOffset:Ot,xOffset:Xt}}function Ss(Je){return Je/gs*(180/Math.PI)}function rs(Je,It){return It/gs*(180/Math.PI)/Math.cos(Je*Math.PI/180)}function ls(Je,It,Ot){return Object.keys(Je).reduce(function(Xt,Dr,Lr){var _n=Dr.split("-"),Un=parseInt(_n[0],10),mn=parseInt(_n[1],10),mi={};if(Ot.field&&Ot.method){var Oa=Hr.Satistics.getColumn(Je[Dr].points,Ot.field);mi[Ot.method]=Hr.Satistics.statMap[Ot.method](Oa)}return Object.assign(mi,{_id:Lr,coordinates:(0,Hr.aProjectFlat)([-180+It.xOffset*(mn+.5),-90+It.yOffset*(Un+.5)]),rawData:Je[Dr].points,count:Je[Dr].count}),Xt.push(mi),Xt},[])}function Ia(Je){if(Array.isArray(Je))return Je}function Ms(Je,It){var Ot=Je==null?null:typeof Symbol!="undefined"&&Je[Symbol.iterator]||Je["@@iterator"];if(Ot!=null){var Xt=[],Dr=!0,Lr=!1,_n,Un;try{for(Ot=Ot.call(Je);!(Dr=(_n=Ot.next()).done)&&(Xt.push(_n.value),!(It&&Xt.length===It));Dr=!0);}catch(mn){Lr=!0,Un=mn}finally{try{!Dr&&Ot.return!=null&&Ot.return()}finally{if(Lr)throw Un}}return Xt}}function uo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qs(Je,It){return Ia(Je)||Ms(Je,It)||Pe(Je,It)||uo()}var Ao=Math.PI/3,Ts=[0,Ao,2*Ao,3*Ao,4*Ao,5*Ao];function ua(Je){return Je[0]}function cs(Je){return Je[1]}function Ds(){var Je=0,It=0,Ot=1,Xt=1,Dr=ua,Lr=cs,_n,Un,mn;function mi(Fn){var ci={},ia=[],_a,ao=Fn.length;for(_a=0;_a<ao;++_a)if(!(isNaN(Vo=+Dr.call(null,Yo=Fn[_a],_a,Fn))||isNaN(Bo=+Lr.call(null,Yo,_a,Fn)))){var Yo,Vo,Bo,mo=Math.round(Bo=Bo/mn),Do=Math.round(Vo=Vo/Un-(mo&1)/2),ps=Bo-mo;if(Math.abs(ps)*3>1){var g=Vo-Do,U=Do+(Vo<Do?-1:1)/2,he=mo+(Bo<mo?-1:1),te=Vo-U,tt=Bo-he;g*g+ps*ps>te*te+tt*tt&&(Do=U+(mo&1?1:-1)/2,mo=he)}var Pt=Do+"-"+mo,fr=ci[Pt];fr?fr.push(Yo):(ia.push(fr=ci[Pt]=[Yo]),fr.x=(Do+(mo&1)/2)*Un,fr.y=mo*mn)}return ia}function Oa(Fn){var ci=0,ia=0;return Ts.map(function(_a){var ao=Math.sin(_a)*Fn,Yo=-Math.cos(_a)*Fn,Vo=ao-ci,Bo=Yo-ia;return ci=ao,ia=Yo,[Vo,Bo]})}return mi.hexagon=function(Fn){return"m"+Oa(Fn==null?_n:+Fn).join("l")+"z"},mi.centers=function(){for(var Fn=[],ci=Math.round(It/mn),ia=Math.round(Je/Un),_a=ci*mn;_a<Xt+_n;_a+=mn,++ci)for(var ao=ia*Un+(ci&1)*Un/2;ao<Ot+Un/2;ao+=Un)Fn.push([ao,_a]);return Fn},mi.mesh=function(){var Fn=Oa(_n).slice(0,4).join("l");return mi.centers().map(function(ci){return"M"+ci+"m"+Fn}).join("")},mi.x=function(Fn){return arguments.length?(Dr=Fn,mi):Dr},mi.y=function(Fn){return arguments.length?(Lr=Fn,mi):Lr},mi.radius=function(Fn){return arguments.length?(_n=+Fn,Un=_n*2*Math.sin(Ao),mn=_n*1.5,mi):_n},mi.size=function(Fn){return arguments.length?(Je=It=0,Ot=+Fn[0],Xt=+Fn[1],mi):[Ot-Je,Xt-It]},mi.extent=function(Fn){return arguments.length?(Je=+Fn[0][0],It=+Fn[0][1],Ot=+Fn[1][0],Xt=+Fn[1][1],mi):[[Je,It],[Ot,Xt]]},mi.radius(1)}function Ro(Je,It){var Ot=Object.keys(Je);if(Object.getOwnPropertySymbols){var Xt=Object.getOwnPropertySymbols(Je);It&&(Xt=Xt.filter(function(Dr){return Object.getOwnPropertyDescriptor(Je,Dr).enumerable})),Ot.push.apply(Ot,Xt)}return Ot}function Eu(Je){for(var It=1;It<arguments.length;It++){var Ot=arguments[It]!=null?arguments[It]:{};It%2?Ro(Object(Ot),!0).forEach(function(Xt){Fe(Je,Xt,Ot[Xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Je,Object.getOwnPropertyDescriptors(Ot)):Ro(Object(Ot)).forEach(function(Xt){Object.defineProperty(Je,Xt,Object.getOwnPropertyDescriptor(Ot,Xt))})}return Je}var ec=6378e3;function Gs(Je,It){var Ot=Je.dataArray,Xt=It.size,Dr=Xt===void 0?10:Xt,Lr=It.method,_n=Lr===void 0?"sum":Lr,Un=Dr/(2*Math.PI*ec)*(256<<20)/2,mn=Ot.map(function(ci){var ia=(0,Hr.aProjectFlat)(ci.coordinates),_a=Qs(ia,2),ao=_a[0],Yo=_a[1];return Eu(Eu({},ci),{},{coordinates:[ao,Yo]})}),mi=Ds().radius(Un).x(function(ci){return ci.coordinates[0]}).y(function(ci){return ci.coordinates[1]}),Oa=mi(mn),Fn={dataArray:Oa.map(function(ci,ia){var _a;if(It.field&&_n){var ao=Hr.Satistics.getColumn(ci,It.field);ci[_n]=Hr.Satistics.statMap[_n](ao)}return _a={},Fe(_a,It.method,ci[_n]),Fe(_a,"count",ci.length),Fe(_a,"rawData",ci),Fe(_a,"coordinates",[ci.x,ci.y]),Fe(_a,"_id",ia),_a}),radius:Un,xOffset:Un,yOffset:Un,type:"hexagon"};return Fn}function ft(Je,It){var Ot=Object.keys(Je);if(Object.getOwnPropertySymbols){var Xt=Object.getOwnPropertySymbols(Je);It&&(Xt=Xt.filter(function(Dr){return Object.getOwnPropertyDescriptor(Je,Dr).enumerable})),Ot.push.apply(Ot,Xt)}return Ot}function St(Je){for(var It=1;It<arguments.length;It++){var Ot=arguments[It]!=null?arguments[It]:{};It%2?ft(Object(Ot),!0).forEach(function(Xt){Fe(Je,Xt,Ot[Xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Je,Object.getOwnPropertyDescriptors(Ot)):ft(Object(Ot)).forEach(function(Xt){Object.defineProperty(Je,Xt,Object.getOwnPropertyDescriptor(Ot,Xt))})}return Je}function _r(Je,It){var Ot=It.sourceField,Xt=It.targetField,Dr=It.data,Lr={};return Dr.forEach(function(_n){Lr[_n[Ot]]=_n}),Je.dataArray=Je.dataArray.map(function(_n){var Un=_n[Xt];return St(St({},_n),Lr[Un])}),Je}function Or(Je,It){var Ot=It.callback;return Ot&&(Je.dataArray=Je.dataArray.map(Ot)),Je}P("geojson",Ur),P("image",un),P("csv",jr),P("json",or),P("raster",Gn),O("cluster",ui),O("filter",Na),O("join",_r),O("map",Or),O("grid",Qi),O("hexagon",Gs);var $n=on,Gi=vr,to=ba},86049:function(Ft,A,y){"use strict";y.r(A),y.d(A,{$XMLHttpRequest:function(){return mi},$location:function(){return Oa},$window:function(){return mn},BKDRHash:function(){return a},DOM:function(){return v},FrequencyController:function(){return Cu},LRUCache:function(){return Ul},Satistics:function(){return Z},aProjectFlat:function(){return qu},anchorTranslate:function(){return ko},anchorType:function(){return ef},applyAnchorClass:function(){return Zc},bBoxToBounds:function(){return Ps},bindAll:function(){return Qu},boundsContains:function(){return To},calAngle:function(){return Bf},calDistance:function(){return ju},decodePickingColor:function(){return Gu},dispatchMapCameraParams:function(){return Ia},dispatchMouseDown:function(){return It},dispatchMouseMove:function(){return Ot},dispatchMouseUp:function(){return Xt},dispatchPointerDown:function(){return St},dispatchPointerMove:function(){return _r},dispatchPointerUp:function(){return Or},dispatchTouchEnd:function(){return ls},dispatchTouchMove:function(){return rs},dispatchTouchStart:function(){return Ss},djb2hash:function(){return P},encodePickingColor:function(){return pf},extent:function(){return ws},flow:function(){return vu},generateColorRamp:function(){return Cc},getAngle:function(){return Jc},getArrayBuffer:function(){return Po},getCullFace:function(){return cl},getImage:function(){return yo},getJSON:function(){return Mo},getMask:function(){return Su},isColor:function(){return nc},isMini:function(){return _n},isMiniAli:function(){return Dr},isWeChatMiniProgram:function(){return Lr},latitude:function(){return Ec},lngLatToMeters:function(){return xl},lnglatDistance:function(){return ss},longitude:function(){return rc},metersToLngLat:function(){return qo},miniWindow:function(){return Un},normalize:function(){return hf},padBounds:function(){return El},project:function(){return bl},rgb2arr:function(){return ic},tranfrormCoord:function(){return $u},unProjectFlat:function(){return ys},validateLngLat:function(){return Va}});var v={};y.r(v),y.d(v,{DPR:function(){return fr},addClass:function(){return Vo},create:function(){return ao},empty:function(){return g},getClass:function(){return ps},getContainer:function(){return Fn},getViewPortScale:function(){return Pt},hasClass:function(){return mo},printCanvas:function(){return tt},remove:function(){return Yo},removeClass:function(){return Bo},setClass:function(){return Do},setTransform:function(){return he},splitWords:function(){return ia},triggerResize:function(){return te},trim:function(){return ci}});var Z={};y.r(Z),y.d(Z,{getColumn:function(){return Nf},getSatByColumn:function(){return rf},max:function(){return tf},mean:function(){return jc},min:function(){return Gl},mode:function(){return Vl},statMap:function(){return Cl},sum:function(){return fl}});function a(le){var Ve=131,_t=137,ut=0;le+="x";for(var Wt=Math.floor(9007199254740991/_t),hn=0;hn<le.length;hn++)ut>Wt&&(ut=Math.floor(ut/_t)),ut=ut*Ve+le.charCodeAt(hn);return ut}function P(le){le=le.toString();for(var Ve=5381,_t=le.length;_t;)Ve=Ve*33^le.charCodeAt(--_t);return Ve>>>0}function L(le){if(Array.isArray(le))return le}function O(le,Ve){var _t=le==null?null:typeof Symbol!="undefined"&&le[Symbol.iterator]||le["@@iterator"];if(_t!=null){var ut=[],Wt=!0,hn=!1,Mi,da;try{for(_t=_t.call(le);!(Wt=(Mi=_t.next()).done)&&(ut.push(Mi.value),!(Ve&&ut.length===Ve));Wt=!0);}catch(oa){hn=!0,da=oa}finally{try{!Wt&&_t.return!=null&&_t.return()}finally{if(hn)throw da}}return ut}}function D(le,Ve){(Ve==null||Ve>le.length)&&(Ve=le.length);for(var _t=0,ut=new Array(Ve);_t<Ve;_t++)ut[_t]=le[_t];return ut}function B(le,Ve){if(!!le){if(typeof le=="string")return D(le,Ve);var _t=Object.prototype.toString.call(le).slice(8,-1);if(_t==="Object"&&le.constructor&&(_t=le.constructor.name),_t==="Map"||_t==="Set")return Array.from(le);if(_t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_t))return D(le,Ve)}}function V(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N(le,Ve){return L(le)||O(le,Ve)||B(le,Ve)||V()}var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function H(le){this.message=le}H.prototype=new Error,H.prototype.name="InvalidCharacterError";function ce(le){var Ve=String(le).replace(/=+$/,"");if(Ve.length%4==1)throw new H("'atob' failed: The string to be decoded is not correctly encoded.");for(var _t="",ut=0,Wt,hn,Mi=0;hn=Ve.charAt(Mi++);~hn&&(Wt=ut%4?Wt*64+hn:hn,ut++%4)?_t+=String.fromCharCode(255&Wt>>(-2*ut&6)):0)hn=Y.indexOf(hn);return _t}function at(le){le=String(le);for(var Ve,_t,ut,Wt,hn="",Mi=0,da=le.length%3;Mi<le.length;){if((_t=le.charCodeAt(Mi++))>255||(ut=le.charCodeAt(Mi++))>255||(Wt=le.charCodeAt(Mi++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");Ve=_t<<16|ut<<8|Wt,hn+=Y.charAt(Ve>>18&63)+Y.charAt(Ve>>12&63)+Y.charAt(Ve>>6&63)+Y.charAt(Ve&63)}return da?hn.slice(0,da-3)+"===".substring(da):hn}function rt(le,Ve){if(!(le instanceof Ve))throw new TypeError("Cannot call a class as a function")}function Re(le,Ve){for(var _t=0;_t<Ve.length;_t++){var ut=Ve[_t];ut.enumerable=ut.enumerable||!1,ut.configurable=!0,"value"in ut&&(ut.writable=!0),Object.defineProperty(le,ut.key,ut)}}function vt(le,Ve,_t){return Ve&&Re(le.prototype,Ve),_t&&Re(le,_t),Object.defineProperty(le,"prototype",{writable:!1}),le}var wt=function(){function le(Ve,_t){rt(this,le),this.buffers=Ve,this.type=_t}return vt(le,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(_t,ut,Wt){throw new Error("not implemented")}}]),le}(),fe;typeof window=="undefined"?fe={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(Ve){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(Ve){return null},clearMeasures:function(Ve){return null},clearMarks:function(Ve){return null},measure:function(Ve,_t,ut){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(Ve){return!0},Event:function(Ve,_t){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:fe=window;var $e=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,re=$e?my.getSystemInfoSync().pixelRatio:fe.devicePixelRatio;function Ge(le,Ve){return Ge=Object.setPrototypeOf||function(ut,Wt){return ut.__proto__=Wt,ut},Ge(le,Ve)}function Qe(le,Ve){if(typeof Ve!="function"&&Ve!==null)throw new TypeError("Super expression must either be null or a function");le.prototype=Object.create(Ve&&Ve.prototype,{constructor:{value:le,writable:!0,configurable:!0}}),Object.defineProperty(le,"prototype",{writable:!1}),Ve&&Ge(le,Ve)}function Te(le){return Te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ve){return typeof Ve}:function(Ve){return Ve&&typeof Symbol=="function"&&Ve.constructor===Symbol&&Ve!==Symbol.prototype?"symbol":typeof Ve},Te(le)}function Le(le){if(le===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le}function Ce(le,Ve){if(Ve&&(Te(Ve)==="object"||typeof Ve=="function"))return Ve;if(Ve!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Le(le)}function Fe(le){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(_t){return _t.__proto__||Object.getPrototypeOf(_t)},Fe(le)}function Ke(le,Ve,_t){return Ve in le?Object.defineProperty(le,Ve,{value:_t,enumerable:!0,configurable:!0,writable:!0}):le[Ve]=_t,le}var qt=vt(function le(Ve,_t){rt(this,le),Ke(this,"cancelBubble",void 0),Ke(this,"cancelable",void 0),Ke(this,"target",void 0),Ke(this,"currentTarget",void 0),Ke(this,"preventDefault",void 0),Ke(this,"stopPropagation",void 0),Ke(this,"type",void 0),Ke(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=Ve,this.timeStamp=Date.now()});function ir(le,Ve){var _t=typeof Symbol!="undefined"&&le[Symbol.iterator]||le["@@iterator"];if(!_t){if(Array.isArray(le)||(_t=Pe(le))||Ve&&le&&typeof le.length=="number"){_t&&(le=_t);var ut=0,Wt=function(){};return{s:Wt,n:function(){return ut>=le.length?{done:!0}:{done:!1,value:le[ut++]}},e:function(za){throw za},f:Wt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hn=!0,Mi=!1,da;return{s:function(){_t=_t.call(le)},n:function(){var za=_t.next();return hn=za.done,za},e:function(za){Mi=!0,da=za},f:function(){try{!hn&&_t.return!=null&&_t.return()}finally{if(Mi)throw da}}}}function Pe(le,Ve){if(!!le){if(typeof le=="string")return Ne(le,Ve);var _t=Object.prototype.toString.call(le).slice(8,-1);if(_t==="Object"&&le.constructor&&(_t=le.constructor.name),_t==="Map"||_t==="Set")return Array.from(le);if(_t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_t))return Ne(le,Ve)}}function Ne(le,Ve){(Ve==null||Ve>le.length)&&(Ve=le.length);for(var _t=0,ut=new Array(Ve);_t<Ve;_t++)ut[_t]=le[_t];return ut}var Xe=new WeakMap,kt=function(){function le(){rt(this,le),Xe.set(this,{})}return vt(le,[{key:"addEventListener",value:function(_t,ut){var Wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},hn=Xe.get(this);hn||(hn={}),hn[_t]||(hn[_t]=[]),hn[_t].push(ut),Xe.set(this,hn),Wt.capture,Wt.once,Wt.passive}},{key:"removeEventListener",value:function(_t,ut){var Wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},hn=Xe.get(this);if(hn){var Mi=hn[_t];if(Mi&&Mi.length>0){for(var da=Mi.length;da--;da>0)if(Mi[da]===ut){Mi.splice(da,1);break}}}}},{key:"dispatchEvent",value:function(_t){var ut=Xe.get(this)[_t.type];if(ut){var Wt=ir(ut),hn;try{for(Wt.s();!(hn=Wt.n()).done;){var Mi=hn.value;Mi(_t)}}catch(da){Wt.e(da)}finally{Wt.f()}}}}]),le}();function rr(le){var Ve=me();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function me(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var et=function(le){Qe(_t,le);var Ve=rr(_t);function _t(){var ut;return rt(this,_t),ut=Ve.call(this),Ke(Le(ut),"childNodes",void 0),ut.childNodes=[],ut}return vt(_t,[{key:"appendChild",value:function(Wt){this.childNodes.push(Wt)}},{key:"cloneNode",value:function(){var Wt=Object.create(this);return Object.assign(Wt,this),Wt}},{key:"removeChild",value:function(Wt){var hn=this.childNodes.findIndex(function(Mi){return Mi===Wt});return hn>-1?this.childNodes.splice(hn,1):null}}]),_t}(kt);function or(le){var Ve=on();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function on(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var vr=function(le){Qe(_t,le);var Ve=or(_t);function _t(){var ut;return rt(this,_t),ut=Ve.call(this),Ke(Le(ut),"className",void 0),Ke(Le(ut),"children",void 0),ut.className="",ut.children=[],ut}return vt(_t,[{key:"setAttribute",value:function(Wt,hn){this[Wt]=hn}},{key:"getAttribute",value:function(Wt){return this[Wt]}},{key:"setAttributeNS",value:function(Wt,hn){this[Wt]=hn}},{key:"getAttributeNS",value:function(Wt){return this[Wt]}}]),_t}(et),jr=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,xr,Ae,De,ke;if(jr){var Bt=my.getSystemInfoSync();xr=Bt.screenWidth,Ae=Bt.screenHeight,De=Bt.windowWidth,ke=Bt.windowHeight}else{var mt=fe.innerWidth,Mr=fe.innerHeight;xr=mt,Ae=Mr,De=mt,ke=Mr}var Cr={width:xr,height:Ae,availWidth:De,availHeight:ke,availLeft:0,availTop:0},Nr=Cr.availWidth,nt=Cr.availHeight,Ye={style:[]};function M(le,Ve){if(!("parentNode"in le)){var _t;Ve===0?_t=function(){return null}:Ve===1?_t=function(){return Ye}:_t=function(){return null},Object.defineProperty(le,"parentNode",{enumerable:!0,get:_t})}if(!("parentElement"in le)){var ut;Ve===0?ut=function(){return null}:Ve===1?ut=function(){return Ye}:ut=function(){return null},Object.defineProperty(le,"parentElement",{enumerable:!0,get:ut})}}function W(le){le.style=le.style||{},Object.assign(le.style,{top:"0px",left:"0px",width:Nr+"px",height:nt+"px",margin:"0px",padding:"0px"})}function ue(le){"clientLeft"in le||(le.clientLeft=0,le.clientTop=0),"clientWidth"in le||(le.clientWidth=Nr,le.clientHeight=nt),"getBoundingClientRect"in le||(le.getBoundingClientRect=function(){var Ve={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return Ve})}function X(le){"offsetLeft"in le||(le.offsetLeft=0,le.offsetTop=0),"offsetWidth"in le||(le.offsetWidth=Nr,le.offsetHeight=nt)}function ie(le){"scrollLeft"in le||(le.scrollLeft=0,le.scrollTop=0),"scrollWidth"in le||(le.scrollWidth=Nr,le.scrollHeight=nt)}function ye(le){var Ve=function(){return!0};le.classList=[],le.classList.add=Ve,le.classList.remove=Ve,le.classList.contains=Ve,le.classList.toggle=Ve}function J(le){var Ve=ht();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function ht(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}function ze(){}var pt=function(le){Qe(_t,le);var Ve=J(_t);function _t(){var ut,Wt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",hn=arguments.length>1?arguments[1]:void 0;return rt(this,_t),ut=Ve.call(this),Ke(Le(ut),"className",void 0),Ke(Le(ut),"children",void 0),Ke(Le(ut),"focus",void 0),Ke(Le(ut),"blur",void 0),Ke(Le(ut),"insertBefore",void 0),Ke(Le(ut),"appendChild",void 0),Ke(Le(ut),"removeChild",void 0),Ke(Le(ut),"remove",void 0),Ke(Le(ut),"innerHTML",void 0),Ke(Le(ut),"tagName",void 0),ut.className="",ut.children=[],ut.focus=ze,ut.blur=ze,ut.insertBefore=ze,ut.appendChild=ze,ut.removeChild=ze,ut.remove=ze,ut.innerHTML="",ut.tagName=Wt.toUpperCase(),M(Le(ut),hn),W(Le(ut)),ye(Le(ut)),ue(Le(ut)),X(Le(ut)),ie(Le(ut)),ut}return vt(_t)}(vr);function Me(le){var Ve=Ue();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function Ue(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var yt=function(le){Qe(_t,le);var Ve=Me(_t);function _t(ut){return rt(this,_t),Ve.call(this,ut)}return vt(_t,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),_t}(pt);function gt(le){var Ve=nr();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function nr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var pe=function(le){Qe(_t,le);var Ve=gt(_t);function _t(){return rt(this,_t),Ve.call(this,"video")}return vt(_t)}(yt),lr={},Ur={};function Hr(le,Ve){lr=le,lr.id=Ve,"tagName"in lr||(lr.tagName="CANVAS"),lr.type="canvas",Mixin.parentNode(lr),Mixin.style(lr),Mixin.classList(lr),Mixin.clientRegion(lr),Mixin.offsetRegion(lr),lr.focus=function(){},lr.blur=function(){}}function un(le,Ve){var _t=1024,ut=1024;Ur={width:_t,height:ut,clientWidth:_t/devicePixelRatio,clientHeight:ut/devicePixelRatio,id:Ve,type:"canvas"},"tagName"in Ur||(Ur.tagName="CANVAS"),Mixin.parentNode(Ur),Mixin.style(Ur),Mixin.classList(Ur),Mixin.clientRegion(Ur),Mixin.offsetRegion(Ur),Ur.getContext=function(Wt){if(Wt==="2d")return le},Ur.focus=function(){},Ur.blur=function(){}}function bn(){return lr}function Gn(){return Ur}var li=vt(function le(){rt(this,le);var Ve=bn(),_t=Ve.createImage&&Ve.createImage()||{};return"tagName"in _t||(_t.tagName="IMG",_t.__proto__=le.prototype),M(_t),ye(_t),Object.assign(_t,{addEventListener:function(Wt,hn){_t["on".concat(Wt)]=hn.bind(_t)},removeEventListener:function(Wt){_t["on".concat(Wt)]=null}}),_t}),$r={href:"",protocol:"",host:""};function Zt(le){var Ve=it();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function it(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var ne=function(le){Qe(_t,le);var Ve=Zt(_t);function _t(){return rt(this,_t),Ve.call(this,"body",0)}return vt(_t,[{key:"addEventListener",value:function(Wt,hn){var Mi=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(Wt,hn,Mi){}},{key:"dispatchEvent",value:function(Wt){}}]),_t}(pt),_e=function(le){Qe(_t,le);var Ve=Zt(_t);function _t(){return rt(this,_t),Ve.call(this,"html",0)}return vt(_t,[{key:"addEventListener",value:function(Wt,hn){var Mi=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(Wt,hn){}},{key:"dispatchEvent",value:function(Wt){}}]),_t}(pt),Oe={},je={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:$r,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(Ve){return Ve=Ve.toLowerCase(),Ve==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):Ve==="img"?new li:Ve==="video"?new pe:new pt(Ve)},createElementNS:function(Ve,_t){return this.createElement(_t)},createTextNode:function(Ve){return Ve},getElementById:function(Ve){return null},getElementsByTagName:function(Ve){return Ve=Ve.toLowerCase(),[]},getElementsByTagNameNS:function(Ve,_t){return this.getElementsByTagName(_t)},getElementsByName:function(Ve){return[]},querySelector:function(Ve){return null},querySelectorAll:function(Ve){return[]},addEventListener:function(Ve,_t,ut){Oe[Ve]||(Oe[Ve]=[]),Oe[Ve].push(_t)},removeEventListener:function(Ve,_t){var ut=Oe[Ve];if(ut&&ut.length>0){for(var Wt=ut.length;Wt--;Wt>0)if(ut[Wt]===_t){ut.splice(Wt,1);break}}},dispatchEvent:function(Ve){var _t=Ve.type,ut=Oe[_t];if(ut)for(var Wt=0;Wt<ut.length;Wt++)ut[Wt](Ve);Ve.target&&typeof Ve.target["on"+_t]=="function"&&Ve.target["on"+_t](Ve)},createEvent:function(Ve){return new qt(Ve)}};je.documentElement=new _e,je.head=new pt("head"),je.body=new ne;var dt=Object,Ut=function(){function le(){rt(this,le),Ke(this,"_w",void 0),Ke(this,"_h",void 0),Ke(this,"_data",void 0);var Ve=arguments.length;if(Ve===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else Ve===3&&Te(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return vt(le,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),le}(),ur=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,lt,Nt,Sr;if(ur){var fn=my.getSystemInfoSync();lt=fn.system,Nt=fn.platform,Sr=fn.language}else{var Br={versions:function(){var le=fe.navigator.userAgent;return{trident:le.indexOf("Trident")>-1,presto:le.indexOf("Presto")>-1,webKit:le.indexOf("AppleWebKit")>-1,gecko:le.indexOf("Gecko")>-1&&le.indexOf("KHTML")===-1,mobile:!!le.match(/AppleWebKit.*Mobile.*/),ios:!!le.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:le.indexOf("Android")>-1||le.indexOf("Linux")>-1,iPhone:le.indexOf("iPhone")>-1,iPad:le.indexOf("iPad")>-1,webApp:le.indexOf("Safari")===-1,weixin:le.indexOf("MicroMessenger")>-1,qq:le.match(/\sQQ/i)===" qq"}}(),language:(fe.navigator.browserLanguage||fe.navigator.language).toLowerCase()};Br.versions.android?Nt="android":Br.versions.trident?Nt="IE":Br.versions.presto?Nt="Opera":Br.versions.webKit?Nt="webKit":Br.versions.gecko?Nt="Firefox":Br.versions.mobile?Nt="mobile":Br.versions.ios?Nt="ios":Br.versions.iPhone?Nt="iPhone":Br.versions.iPad?Nt="ipad":Br.versions.webApp?Nt="webApp":Br.versions.weixin?Nt="weixin":Br.versions.qq&&(Nt="qq"),lt=fe.navigator.userAgent,Sr=Br.language}var Jr=lt.toLowerCase().indexOf("android")!==-1,Tn=Jr?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",hi="Mozilla/5.0 (".concat(Tn,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(Sr),On={platform:Nt,language:Sr,appVersion:"5.0 (".concat(Tn,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:hi},Pr={mark:function(Ve){return null},clearMeasures:function(Ve){return null},clearMarks:function(Ve){return null},measure:function(Ve,_t,ut){return{duration:0}},now:function(){}},vi=0,Jn=0;function ui(le){var Ve=Date.now(),_t=Math.max(vi+23,Ve);return Jn=setTimeout(function(){le(vi=_t)},_t-Ve),Jn}function Da(le){var Ve=bn();return Ve.requestAnimationFrame?Ve.requestAnimationFrame(le):ui(le)}function Yn(le){var Ve=bn();return Ve.cancelAnimationFrame?Ve.cancelAnimationFrame(le):clearTimeout(le)}var wa=function(){function le(Ve){var _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(rt(this,le),Ke(this,"href",void 0),Ve.indexOf("http://")==0||Ve.indexOf("https://")==0){this.href=Ve;return}this.href=_t+Ve}return vt(le,null,[{key:"createObjectURL",value:function(_t){var ut=_t.buffers[0],Wt=_t.type,hn=vo(ut),Mi="data:".concat(Wt,";base64, ");return Mi+hn}}]),le}();function vo(le){for(var Ve="",_t=new Uint8Array(le),ut=_t.byteLength,Wt=0;Wt<ut;Wt++)Ve+=String.fromCharCode(_t[Wt]);return at(Ve)}var Ua={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},Ka={};function Ga(le){var Ve=ei();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function ei(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var eo=new Map,ra=new Map,Rn=new Map,qa={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function ba(le){var Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(le)]=="function"&&this["on".concat(le)].call(this,Ve)}function Na(le){var Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:le};this.readyState=le,ba.call(this,"readystatechange",Ve)}var wo=function(le){Qe(_t,le);var Ve=Ga(_t);function _t(){var ut;return rt(this,_t),ut=Ve.call(this),Ke(Le(ut),"onabort",void 0),Ke(Le(ut),"onerror",void 0),Ke(Le(ut),"onload",void 0),Ke(Le(ut),"onloadstart",void 0),Ke(Le(ut),"onprogress",void 0),Ke(Le(ut),"ontimeout",void 0),Ke(Le(ut),"onloadend",void 0),Ke(Le(ut),"onreadystatechange",void 0),Ke(Le(ut),"readyState",void 0),Ke(Le(ut),"response",void 0),Ke(Le(ut),"responseText",void 0),Ke(Le(ut),"_responseType",void 0),Ke(Le(ut),"responseXML",void 0),Ke(Le(ut),"status",void 0),Ke(Le(ut),"statusText",void 0),Ke(Le(ut),"upload",void 0),Ke(Le(ut),"withCredentials",void 0),Ke(Le(ut),"timeout",void 0),Ke(Le(ut),"_url",void 0),Ke(Le(ut),"_method",void 0),ut.onabort=null,ut.onerror=null,ut.onload=null,ut.onloadstart=null,ut.onprogress=null,ut.ontimeout=null,ut.onloadend=null,ut.onreadystatechange=null,ut.readyState=0,ut.response=null,ut.responseText=null,ut._responseType="text",ut.responseXML=null,ut.status=0,ut.statusText="",ut.upload={},ut.withCredentials=!1,eo.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),ut}return vt(_t,[{key:"responseType",set:function(Wt){this._responseType=Wt}},{key:"abort",value:function(){var Wt=Rn.get("requestTask");Wt&&Wt.abort()}},{key:"getAllResponseHeaders",value:function(){var Wt=ra.get("responseHeader");return Object.keys(Wt).map(function(hn){return"".concat(hn,": ").concat(Wt[hn])}).join(`
`)}},{key:"getResponseHeader",value:function(Wt){return ra.get("responseHeader")[Wt]}},{key:"open",value:function(Wt,hn,Mi){this._method=Wt,this._url=hn}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var Wt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(Wt,hn){var Mi=eo.get("requestHeader");Mi[Wt]=hn,eo.set("requestHeader",Mi)}},{key:"addEventListener",value:function(Wt,hn){var Mi=this;typeof hn=="function"&&(this["on"+Wt]=function(){var da=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};da.target=da.target||Mi,hn.call(Mi,da)})}},{key:"removeEventListener",value:function(Wt,hn){this["on"+Wt]===hn&&(this["on"+Wt]=null)}}]),_t}(kt);Ke(wo,"UNSEND",void 0),Ke(wo,"OPENED",void 0),Ke(wo,"HEADERS_RECEIVED",void 0),Ke(wo,"LOADING",void 0),Ke(wo,"DONE",void 0),wo.UNSEND=0,wo.OPENED=1,wo.HEADERS_RECEIVED=2,wo.LOADING=3,wo.DONE=4;function ya(le){var Ve=Gt();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function Gt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var gs=function(le){Qe(_t,le);var Ve=ya(_t);function _t(ut){var Wt;return rt(this,_t),Wt=Ve.call(this,ut),Ke(Le(Wt),"touches",void 0),Ke(Le(Wt),"targetTouches",void 0),Ke(Le(Wt),"changedTouches",void 0),Wt.touches=[],Wt.targetTouches=[],Wt.changedTouches=[],Wt.target=bn(),Wt.currentTarget=bn(),Wt}return vt(_t)}(qt);function Qi(le){var Ve=le||{},_t=Ve.x,ut=_t===void 0?0:_t,Wt=Ve.y,hn=Wt===void 0?0:Wt,Mi=Ve.clientX,da=Mi===void 0?0:Mi,oa=Ve.clientY,za=oa===void 0?0:oa;Object.keys(le).indexOf("x")!==-1?(le.pageX=le.clientX=ut,le.pageY=le.clientY=hn):(le.x=da,le.y=za)}function So(le){return function(Ve){var _t=new gs(le);_t.changedTouches=Ve.changedTouches,_t.touches=Ve.touches,_t.targetTouches=Array.prototype.slice.call(Ve.touches),_t.timeStamp=Ve.timeStamp,_t.changedTouches.forEach(function(ut){return Qi(ut)}),_t.touches.forEach(function(ut){return Qi(ut)}),_t.targetTouches.forEach(function(ut){return Qi(ut)}),je.dispatchEvent(_t)}}function ll(le){return function(Ve){Ve.type=le,je.dispatchEvent(Ve)}}var Ss=So("touchstart"),rs=So("touchmove"),ls=So("touchend"),Ia=ll("mapCameaParams");function Ms(le){var Ve=uo();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function uo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var Qs=function(le){Qe(_t,le);var Ve=Ms(_t);function _t(ut){var Wt;return rt(this,_t),Wt=Ve.call(this,ut),Ke(Le(Wt),"buttons",void 0),Ke(Le(Wt),"which",void 0),Ke(Le(Wt),"pointerId",void 0),Ke(Le(Wt),"bubbles",void 0),Ke(Le(Wt),"button",void 0),Ke(Le(Wt),"width",void 0),Ke(Le(Wt),"height",void 0),Ke(Le(Wt),"pressure",void 0),Ke(Le(Wt),"isPrimary",void 0),Ke(Le(Wt),"pointerType",void 0),Ke(Le(Wt),"altKey",void 0),Ke(Le(Wt),"ctrlKey",void 0),Ke(Le(Wt),"metaKey",void 0),Ke(Le(Wt),"shiftKey",void 0),Wt.target=bn(),Wt.currentTarget=bn(),Wt}return vt(_t)}(qt),Ao=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],Ts=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],ua="touch";function cs(le,Ve,_t){for(var ut=new Qs(le),Wt=0;Wt<Ao.length;Wt++){var hn=Ao[Wt];ut[hn]=Ve[hn]||Ts[Wt]}return ut.type=le,ut.target=bn(),ut.currentTarget=bn(),ut.buttons=Ds(le),ut.which=ut.buttons,ut.pointerId=(Ve.identifier||0)+2,ut.bubbles=!0,ut.cancelable=!0,ut.button=0,ut.width=(Ve.radiusX||.5)*2,ut.height=(Ve.radiusY||.5)*2,ut.pressure=Ve.force||.5,ut.isPrimary=Eu(Ve),ut.pointerType=ua,ut.altKey=_t.altKey,ut.ctrlKey=_t.ctrlKey,ut.metaKey=_t.metaKey,ut.shiftKey=_t.shiftKey,_t.preventDefault&&(ut.preventDefault=function(){_t.preventDefault()}),ut}function Ds(le){var Ve=0;return(le==="touchstart"||le==="touchmove"||le==="pointerdown"||le==="pointermove")&&(Ve=1),Ve}var Ro=null;function Eu(le){return Ro===le.identifier}function ec(le){Ro===null&&(Ro=le.identifier)}function Gs(le){Ro===le.identifier&&(Ro=null)}function ft(le){return function(Ve){for(var _t=Ve.changedTouches,ut=0;ut<_t.length;ut++){var Wt=_t[ut];ut===0&&le==="pointerdown"?ec(Wt):(le==="pointerup"||le==="pointercancel")&&Gs(Wt);var hn=cs(le,Wt,Ve);je.dispatchEvent(hn)}}}var St=ft("pointerdown"),_r=ft("pointermove"),Or=ft("pointerup");function $n(le){var Ve=Gi();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function Gi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var to=function(le){Qe(_t,le);var Ve=$n(_t);function _t(ut){return rt(this,_t),Ve.call(this,ut)}return vt(_t)}(qt);function Je(le){return function(Ve){Ve.type=le,je.dispatchEvent(Ve)}}var It=Je("mousedown"),Ot=Je("mousemove"),Xt=Je("mouseup"),Dr=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Lr=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),_n=Dr||Lr,Un={atob:ce,btoa:at,devicePixelRatio:re,Blob:wt,document:je,Element:vr,Event:qt,EventTarget:kt,HTMLCanvasElement:dt,HTMLElement:pt,HTMLMediaElement:yt,HTMLVideoElement:pe,Image:li,ImageData:Ut,navigator:On,Node:et,requestAnimationFrame:Da,cancelAnimationFrame:Yn,screen:Cr,XMLHttpRequest:wo,performance:Pr,URL:wa,WebGLRenderingContext:Ua,WebGL2RenderingContext:Ka,addEventListener:function(Ve,_t){var ut=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};je.addEventListener(Ve,_t,ut)},removeEventListener:function(Ve,_t,ut){je.removeEventListener(Ve,_t)},dispatchEvent:function(Ve){je.dispatchEvent(Ve)},innerWidth:Cr.availWidth,innerHeight:Cr.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},mn=_n?Un:fe,mi=_n?wo:fe.XMLHttpRequest,Oa=_n?$r:fe.location;function Fn(le){var Ve=le;return typeof le=="string"&&(Ve=mn.document.getElementById(le)),Ve}function ci(le){return le.trim?le.trim():le.replace(/^\s+|\s+$/g,"")}function ia(le){return ci(le).split(/\s+/)}function _a(le){var Ve,_t,ut=mn==null||(Ve=mn.document)===null||Ve===void 0||(_t=Ve.documentElement)===null||_t===void 0?void 0:_t.style;if(!ut)return le[0];for(var Wt in le)if(le[Wt]&&le[Wt]in ut)return le[Wt];return le[0]}function ao(le,Ve,_t){var ut=mn.document.createElement(le);return ut.className=Ve||"",_t&&_t.appendChild(ut),ut}function Yo(le){var Ve=le.parentNode;Ve&&Ve.removeChild(le)}function Vo(le,Ve){if(le.classList!==void 0)for(var _t=ia(Ve),ut=0,Wt=_t.length;ut<Wt;ut++)le.classList.add(_t[ut]);else if(!mo(le,Ve)){var hn=ps(le);Do(le,(hn?hn+" ":"")+Ve)}}function Bo(le,Ve){le.classList!==void 0?le.classList.remove(Ve):Do(le,ci((" "+ps(le)+" ").replace(" "+Ve+" "," ")))}function mo(le,Ve){if(le.classList!==void 0)return le.classList.contains(Ve);var _t=ps(le);return _t.length>0&&new RegExp("(^|\\s)"+Ve+"(\\s|$)").test(_t)}function Do(le,Ve){le instanceof HTMLElement?le.className=Ve:le.className.baseVal=Ve}function ps(le){return le instanceof SVGElement&&(le=le.correspondingElement),le.className.baseVal===void 0?le.className:le.className.baseVal}function g(le){for(;le&&le.firstChild;)le.removeChild(le.firstChild)}var U=_a(["transform","WebkitTransform"]);function he(le,Ve){le.style[U]=Ve}function te(){if(typeof Event=="function")mn.dispatchEvent(new Event("resize"));else{var le=mn.document.createEvent("UIEvents");le.initUIEvent("resize",!0,!1,mn,0),mn.dispatchEvent(le)}}function tt(le){var Ve=["padding: "+(le.height/2-8)+"px "+le.width/2+"px;","line-height: "+le.height+"px;","background-image: url("+le.toDataURL()+");"];console.log(`%c
`,Ve.join(""))}function Pt(){var le,Ve=mn.document.querySelector('meta[name="viewport"]');if(!Ve)return 1;var _t=(le=Ve.content)===null||le===void 0?void 0:le.split(","),ut=_t.find(function(Wt){var hn=Wt.split("="),Mi=N(hn,2),da=Mi[0],oa=Mi[1];return da==="initial-scale"});return ut?ut.split("=")[1]*1:1}var fr=Pt()<1?1:mn.devicePixelRatio;function Fr(le){return Function.toString.call(le).indexOf("[native code]")!==-1}function zr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}function En(le,Ve,_t){return zr()?En=Reflect.construct:En=function(Wt,hn,Mi){var da=[null];da.push.apply(da,hn);var oa=Function.bind.apply(Wt,da),za=new oa;return Mi&&Ge(za,Mi.prototype),za},En.apply(null,arguments)}function Dn(le){var Ve=typeof Map=="function"?new Map:void 0;return Dn=function(ut){if(ut===null||!Fr(ut))return ut;if(typeof ut!="function")throw new TypeError("Super expression must either be null or a function");if(typeof Ve!="undefined"){if(Ve.has(ut))return Ve.get(ut);Ve.set(ut,Wt)}function Wt(){return En(ut,arguments,Fe(this).constructor)}return Wt.prototype=Object.create(ut.prototype,{constructor:{value:Wt,enumerable:!1,writable:!0,configurable:!0}}),Ge(Wt,ut)},Dn(le)}function na(le){var Ve=ka();return function(){var ut=Fe(le),Wt;if(Ve){var hn=Fe(this).constructor;Wt=Reflect.construct(ut,arguments,hn)}else Wt=ut.apply(this,arguments);return Ce(this,Wt)}}function ka(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}var ha=function(le){Qe(_t,le);var Ve=na(_t);function _t(ut,Wt,hn){var Mi;return rt(this,_t),Mi=Ve.call(this,ut),Ke(Le(Mi),"status",void 0),Ke(Le(Mi),"url",void 0),Mi.status=Wt,Mi.url=hn,Mi.name=Mi.constructor.name,Mi.message=ut,Mi}return vt(_t,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),_t}(Dn(Error));function Fa(le){var Ve=new mi;Ve.open("GET",le.url,!0);for(var _t in le.headers)le.headers.hasOwnProperty(_t)&&Ve.setRequestHeader(_t,le.headers[_t]);return Ve.withCredentials=le.credentials==="include",Ve}var Mo=function(Ve,_t){var ut=Fa(Ve);return ut.setRequestHeader("Accept","application/json"),ut.onerror=function(){_t(new Error(ut.statusText))},ut.onload=function(){if(ut.status>=200&&ut.status<300&&ut.response){var Wt;try{Wt=JSON.parse(ut.response)}catch(hn){return _t(hn)}_t(null,Wt)}else ut.status===401?_t(new ha("".concat(ut.statusText),ut.status,Ve.url)):_t(new ha(ut.statusText,ut.status,Ve.url))},ut.send(),ut},Po=function(Ve,_t){var ut=Fa(Ve);return ut.responseType="arraybuffer",ut.onerror=function(){_t(new Error(ut.statusText))},ut.onload=function(){var Wt=ut.response;if(Wt.byteLength===0&&ut.status===200)return _t(new Error("http status 200 returned without content."));ut.status>=200&&ut.status<300&&ut.response?_t(null,{data:Wt,cacheControl:ut.getResponseHeader("Cache-Control"),expires:ut.getResponseHeader("Expires")}):_t(new ha(ut.statusText,ut.status,Ve.url))},ut.send(),ut};function go(le){var Ve=$window.document.createElement("a");return Ve.href=le,Ve.protocol===$window.document.location.protocol&&Ve.host===$window.document.location.host}var fu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",yo=function(Ve,_t){return Po(Ve,function(ut,Wt){if(ut)_t(ut);else if(Wt){var hn=new mn.Image;hn.crossOrigin="anonymous";var Mi=mn.URL||mn.webkitURL;hn.onload=function(){_t(null,hn),Mi.revokeObjectURL(hn.src)};var da=new mn.Blob([new Uint8Array(Wt.data)],{type:"image/png"});hn.src=Wt.data.byteLength?Mi.createObjectURL(da):fu}})},Zu=y(40271),tc=2*Math.PI*6378137/2;function ws(le){var Ve=[Infinity,Infinity,-Infinity,-Infinity];return le.forEach(function(_t){var ut=_t.coordinates;Nc(Ve,ut)}),Ve}function Nc(le,Ve){return Array.isArray(Ve[0])?Ve.forEach(function(_t){Nc(le,_t)}):(le[0]>Ve[0]&&(le[0]=Ve[0]),le[1]>Ve[1]&&(le[1]=Ve[1]),le[2]<Ve[0]&&(le[2]=Ve[0]),le[3]<Ve[1]&&(le[3]=Ve[1])),le}function $u(le,Ve){return Ku(le,Ve)}function Ku(le,Ve){return Array.isArray(le[0])?le.map(function(_t){return Ku(_t,Ve)}):Ve(le)}function xl(le){var Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};le=Va(le,Ve);var ut=le[0],Wt=le[1],hn=ut*tc/180,Mi=Math.log(Math.tan((90+Wt)*Math.PI/360))/(Math.PI/180);return Mi=Mi*tc/180,_t.enable&&(hn=Number(hn.toFixed(_t.decimal)),Mi=Number(Mi.toFixed(_t.decimal))),le.length===3?[hn,Mi,le[2]]:[hn,Mi]}function qo(le){var Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,_t=le[0],ut=le[1],Wt=_t/tc*180,hn=ut/tc*180;return hn=180/Math.PI*(2*Math.atan(Math.exp(hn*Math.PI/180))-Math.PI/2),Ve!=null&&(Wt=Number(Wt.toFixed(Ve)),hn=Number(hn.toFixed(Ve))),le.length===3?[Wt,hn,le[2]]:[Wt,hn]}function rc(le){if(le==null)throw new Error("lng is required");return(le>180||le<-180)&&(le=le%360,le>180&&(le=-360+le),le<-180&&(le=360+le),le===0&&(le=0)),le}function Ec(le){if(le==null)throw new Error("lat is required");return(le>90||le<-90)&&(le=le%180,le>90&&(le=-180+le),le<-90&&(le=180+le),le===0&&(le=0)),le}function Va(le,Ve){if(Ve===!1)return le;var _t=rc(le[0]),ut=Ec(le[1]);return ut>85&&(ut=85),ut<-85&&(ut=-85),le.length===3?[_t,ut,le[2]]:[_t,ut]}function qu(le){var Ve=85.0511287798,_t=Math.max(Math.min(Ve,le[1]),-Ve),ut=256<<20,Wt=Math.PI/180,hn=le[0]*Wt,Mi=_t*Wt;Mi=Math.log(Math.tan(Math.PI/4+Mi/2));var da=.5/Math.PI,oa=.5,za=-.5/Math.PI;return Wt=.5,hn=ut*(da*hn+oa),Mi=ut*(za*Mi+Wt),[Math.floor(hn),Math.floor(Mi)]}function ys(le){var Ve=.5/Math.PI,_t=.5,ut=-.5/Math.PI,Wt=.5,hn=256<<20,Mi=N(le,2),da=Mi[0],oa=Mi[1];da=(da/hn-_t)/Ve,oa=(oa/hn-Wt)/ut,oa=(Math.atan(Math.pow(Math.E,oa))-Math.PI/4)*2,Wt=Math.PI/180;var za=oa/Wt,Xo=da/Wt;return[Xo,za]}function ss(le,Ve,_t){var ut=(0,Zu.Ht)(Ve[1]-le[1]),Wt=(0,Zu.Ht)(Ve[0]-le[0]),hn=(0,Zu.Ht)(le[1]),Mi=(0,Zu.Ht)(Ve[1]),da=Math.pow(Math.sin(ut/2),2)+Math.pow(Math.sin(Wt/2),2)*Math.cos(hn)*Math.cos(Mi);return(0,Zu.DL)(2*Math.atan2(Math.sqrt(da),Math.sqrt(1-da)),_t="meters")}function bl(le){var Ve=Math.PI/180,_t=85.0511287798,ut=6378137,Wt=Math.max(Math.min(_t,le[1]),-_t),hn=Math.sin(Wt*Ve),Mi=ut*le[0]*Ve,da=ut*Math.log((1+hn)/(1-hn))/2;return[Mi,da]}function El(le,Ve){var _t=Math.abs(le[1][1]-le[0][1])*Ve,ut=Math.abs(le[1][0]-le[0][0])*Ve;return[[le[0][0]-ut,le[0][1]-_t],[le[1][0]+ut,le[1][1]+_t]]}function To(le,Ve){return le[0][0]<=Ve[0][0]&&le[0][1]<=Ve[0][1]&&le[1][0]>=Ve[1][0]&&le[1][1]>=Ve[1][1]}function Ps(le){return[[le[0],le[1]],[le[2],le[3]]]}function hf(le){var Ve=ju(le,[0,0]);return[le[0]/Ve,le[1]/Ve]}function ju(le,Ve){return Math.sqrt(Math.pow(le[0]-Ve[0],2)+Math.pow(le[1]-Ve[1],2))}function zc(le,Ve){return le[0]*Ve[0]+le[1]*Ve[1]}function Uc(le){return Math.sqrt(le[0]*le[0]+le[1]*le[1])}function Bf(le,Ve){return Math.acos(zc(le,Ve)/(Uc(le)*Uc(Ve)))*180/Math.PI}function Jc(le,Ve){return Ve[0]>0?Ve[1]>0?90-Math.atan(Ve[1]/Ve[0])*180/Math.PI:90+Math.atan(-Ve[1]/Ve[0])*180/Math.PI:Ve[1]<0?180+(90-Math.atan(Ve[1]/Ve[0])*180/Math.PI):270+Math.atan(Ve[1]/-Ve[0])*180/Math.PI}function vu(le){var Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!le||le.length<2)){for(var _t=[0,1],ut=0,Wt=[],hn=0;hn<le.length-1;hn++){var Mi=le[hn],da=le[hn+1],oa=ju(Mi,da);ut+=oa;var za=[Mi[0]-da[0],Mi[1]-da[1]],Xo=Jc(_t,za);if(hn>0){var Sc=Wt[hn-1].rotation;Sc-Xo>360-Sc+Xo&&(Xo=Xo+360)}Wt.push({start:Mi,end:da,dis:oa,rotation:Xo,duration:0})}return Wt.map(function(hl){hl.duration=Ve*(hl.dis/ut)}),Wt}}var Ul=function(){function le(){var Ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,_t=arguments.length>1?arguments[1]:void 0;rt(this,le),Ke(this,"limit",void 0),Ke(this,"cache",void 0),Ke(this,"destroy",void 0),Ke(this,"order",void 0),this.limit=Ve,this.destroy=_t||this.defaultDestroy,this.order=[],this.clear()}return vt(le,[{key:"clear",value:function(){var _t=this;this.order.forEach(function(ut){_t.delete(ut)}),this.cache={},this.order=[]}},{key:"get",value:function(_t){var ut=this.cache[_t];return ut&&(this.deleteOrder(_t),this.appendOrder(_t)),ut}},{key:"set",value:function(_t,ut){this.cache[_t]?(this.delete(_t),this.cache[_t]=ut,this.appendOrder(_t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[_t]=ut,this.appendOrder(_t))}},{key:"delete",value:function(_t){var ut=this.cache[_t];ut&&(this.deleteCache(_t),this.deleteOrder(_t),this.destroy(ut,_t))}},{key:"deleteCache",value:function(_t){delete this.cache[_t]}},{key:"deleteOrder",value:function(_t){var ut=this.order.findIndex(function(Wt){return Wt===_t});ut>=0&&this.order.splice(ut,1)}},{key:"appendOrder",value:function(_t){this.order.push(_t)}},{key:"defaultDestroy",value:function(_t,ut){return null}}]),le}();function Qu(le,Ve){le.forEach(function(_t){!Ve[_t]||(Ve[_t]=Ve[_t].bind(Ve))})}var Cu=function(){function le(){var Ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16;rt(this,le),Ke(this,"duration",16),Ke(this,"timestamp",new Date().getTime()),this.duration=Ve}return vt(le,[{key:"run",value:function(_t){var ut=new Date().getTime(),Wt=ut-this.timestamp;this.timestamp=ut,Wt>=this.duration&&_t()}}]),le}(),Zl=y(2650);function nc(le){return typeof le=="string"?!!Zl.ZP(le):!1}function ic(le){var Ve=Zl.ZP(le),_t=[0,0,0,0];return Ve!=null&&(_t[0]=Ve.r/255,_t[1]=Ve.g/255,_t[2]=Ve.b/255,_t[3]=Ve.opacity),_t}function Gu(le){var Ve=le&&le[0],_t=le&&le[1],ut=le&&le[2],Wt=Ve+_t*256+ut*65536-1;return Wt}function pf(le){return[le+1&255,le+1>>8&255,le+1>>8>>8&255]}function Cc(le){var Ve=mn.document.createElement("canvas"),_t=Ve.getContext("2d");Ve.width=256,Ve.height=1;for(var ut=_t.createLinearGradient(0,0,256,1),Wt=null,hn=le.positions[0],Mi=le.positions[le.positions.length-1],da=0;da<le.colors.length;++da){var oa=(le.positions[da]-hn)/(Mi-hn);ut.addColorStop(oa,le.colors[da])}if(_t.fillStyle=ut,_t.fillRect(0,0,256,1),_n)return Wt=new Uint8ClampedArray(_t.getImageData(0,0,256,1).data),{data:Wt,width:256,height:1};Wt=_t.getImageData(0,0,256,1).data;for(var za=_t.createImageData(256,1),Xo=0;Xo<za.data.length;Xo+=4)za.data[Xo+0]=Wt[Xo+0],za.data[Xo+1]=Wt[Xo+1],za.data[Xo+2]=Wt[Xo+2],za.data[Xo+3]=Wt[Xo+3];return za}var ef;(function(le){le.CENTER="center",le.TOP="top",le["TOP-LEFT"]="top-left",le["TOP-RIGHT"]="top-right",le.BOTTOM="bottom",le["BOTTOM-LEFT"]="bottom-left",le.LEFT="left",le.RIGHT="right"})(ef||(ef={}));var ko={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Zc(le,Ve,_t){var ut=le.classList;for(var Wt in ko)ko.hasOwnProperty(Wt)&&ut.remove("l7-".concat(_t,"-anchor-").concat(Wt));ut.add("l7-".concat(_t,"-anchor-").concat(Ve))}function Su(le,Ve){return{enable:le,mask:255,func:{cmp:514,ref:Ve?1:0,mask:255}}}var jl={BACK:1029,FRONT:1028};function cl(le){switch(le){case"GAODE1.x":return jl.BACK;case"GAODE2.x":return jl.BACK;case"MAPBOX":return jl.FRONT;case"SIMPLE":return jl.FRONT;case"GLOBEL":return jl.BACK;case"L7MAP":return jl.FRONT;default:return jl.FRONT}}function tf(le){if(le.length===0)throw new Error("max requires at least one data point");for(var Ve=le[0],_t=1;_t<le.length;_t++)le[_t]>Ve&&(Ve=le[_t]);return Ve*1}function Gl(le){if(le.length===0)throw new Error("min requires at least one data point");for(var Ve=le[0],_t=1;_t<le.length;_t++)le[_t]<Ve&&(Ve=le[_t]);return Ve*1}function fl(le){if(le.length===0)return 0;for(var Ve=le[0]*1,_t=1;_t<le.length;_t++)Ve+=le[_t]*1;return Ve}function jc(le){if(le.length===0)throw new Error("mean requires at least one data point");return fl(le)/le.length}function Vl(le){if(le.length===0)throw new Error("mean requires at least one data point");if(le.length<3)return le[0];le.sort();for(var Ve=le[0],_t=NaN,ut=0,Wt=1,hn=1;hn<le.length+1;hn++)le[hn]!==Ve?(Wt>ut&&(ut=Wt,_t=Ve),Wt=1,Ve=le[hn]):Wt++;return _t*1}var Cl={min:Gl,max:tf,mean:jc,sum:fl,mode:Vl};function Nf(le,Ve){return le.map(function(_t){return _t[Ve]})}function rf(le,Ve){return Cl[le](Ve)}},14403:function(Ft,A,y){"use strict";y.r(A),y.d(A,{CategoryLegend:function(){return Pe},ContinueLegend:function(){return xr},Tooltip:function(){return $e},version:function(){return v}});var v="0.0.5",Z=y(70655),a=y(49242),P=y(45442),L={fontFamily:`
  "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`},O="l7plot-tooltip",D="l7plot-tooltip__title",B="l7plot-tooltip__list",V="l7plot-tooltip__list-item",N="l7plot-tooltip__name",Y="l7plot-tooltip__value",H='<div class="'.concat(O,`">
  <div class="`).concat(D,`"></div>
  <ul class="`).concat(B,`"></ul>
</div>`),ce='<li class="'.concat(V,`" data-index={index}>
  <span class="`).concat(N,`">{name}</span>
  <span class="`).concat(Y,`">{value}</span>
</li>`),at,rt=(at={},at[O]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:L.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},at[D]={marginBottom:"4px"},at[B]={margin:"0px",listStyleType:"none",padding:"0px"},at[V]={listStyleType:"none",marginBottom:"4px",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"},at[N]={},at[Y]={marginLeft:"30px"},at),Re=y(6056);function vt(Ae,De){return!!Ae.className.match(new RegExp("(\\s|^)".concat(De,"(\\s|$)")))}function wt(Ae){for(var De=Ae.childNodes,ke=De.length,Bt=ke-1;Bt>=0;Bt--)Ae.removeChild(De[Bt])}var fe=function(){function Ae(De){this.destroyed=!1,this.options=(0,a.deepMix)({},this.getDefaultOptions(),De),this.container=this.initContainer(),this.initDom(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible(),this.render()}return Ae.prototype.getDefaultOptions=function(){return{name:"",containerTpl:"<div></div>",visible:!0,capture:!0,domStyles:{}}},Ae.prototype.getContainer=function(){return this.container},Ae.prototype.getParentContainer=function(){var De=this.options.parent,ke;if(!De)return ke;if((0,a.isString)(De)){var Bt=document.getElementById(De);if(Bt)ke=Bt;else throw new Error("No parent id ".concat(De))}else ke=De;return ke},Ae.prototype.initContainer=function(){var De=this.createDom(this.options.containerTpl),ke=this.getParentContainer();return ke&&ke.appendChild(De),De},Ae.prototype.initVisible=function(){this.options.visible?this.show():this.hide()},Ae.prototype.initCapture=function(){this.setCapture(this.options.capture)},Ae.prototype.update=function(De){this.options=(0,a.deepMix)({},this.options,De),this.updateInner(De),this.afterUpdate(De)},Ae.prototype.updateInner=function(De){De.domStyles&&this.applyStyles()},Ae.prototype.afterUpdate=function(De){De.capture&&this.setCapture(De.capture)},Ae.prototype.setCapture=function(De){var ke=this.container,Bt=De?"auto":"none";ke.style.pointerEvents=Bt},Ae.prototype.applyStyles=function(){var De=this.options.domStyles;if(!!De){var ke=this.container;this.applyChildrenStyles(ke,De);var Bt=this.options.className;if(Bt&&vt(ke,Bt)){var mt=De[Bt];(0,P.Z)(ke,mt)}}},Ae.prototype.applyChildrenStyles=function(De,ke){(0,a.each)(ke,function(Bt,mt){var Mr=De.getElementsByClassName(mt);(0,a.each)(Mr,function(Cr){(0,P.Z)(Cr,Bt)})})},Ae.prototype.applyStyle=function(De,ke){var Bt=this.options.domStyles;Bt&&(0,P.Z)(ke,Bt[De])},Ae.prototype.createDom=function(De){return De===void 0&&(De="<div></div>"),(0,Re.Z)(De)},Ae.prototype.removeDom=function(){var De=this.container;De&&De.parentNode&&De.parentNode.removeChild(De)},Ae.prototype.destroy=function(){this.removeEvent(),this.removeDom(),this.destroyed=!0},Ae}(),$e=function(Ae){(0,Z.__extends)(De,Ae);function De(){return Ae!==null&&Ae.apply(this,arguments)||this}return De.prototype.getDefaultOptions=function(){return(0,a.deepMix)({},Ae.prototype.getDefaultOptions.call(this),{id:"l7plot-tooltip",name:"l7plot-tooltip",title:"",showTitle:!0,items:[],containerTpl:H,itemTpl:ce,domStyles:rt,className:O})},De.prototype.initContainer=function(){var ke=this.options.customContent;if(ke){var Bt=this.getHtmlContentNode(ke),mt=this.getParentContainer();return mt&&mt.appendChild(Bt),Bt}else return Ae.prototype.initContainer.call(this)},De.prototype.initDom=function(){this.cacheDoms()},De.prototype.initEvent=function(){},De.prototype.removeEvent=function(){},De.prototype.cacheDoms=function(){var ke=this.container,Bt=ke.getElementsByClassName(D)[0],mt=ke.getElementsByClassName(B)[0];this.titleDom=Bt,this.listDom=mt},De.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},De.prototype.show=function(){var ke=this.container;!ke||this.destroyed||(0,P.Z)(ke,{visibility:"visible"})},De.prototype.hide=function(){var ke=this.container;!ke||this.destroyed||(0,P.Z)(ke,{visibility:"hidden"})},De.prototype.updateInner=function(ke){this.options.customContent?this.renderCustomContent(this.options.customContent):(ke.title&&this.resetTitle(),ke.items&&this.renderItems()),Ae.prototype.updateInner.call(this,ke)},De.prototype.renderCustomContent=function(ke){var Bt=this.container.parentNode,mt=this.getHtmlContentNode(ke),Mr=this.container;Bt&&Bt.replaceChild(mt,Mr),this.container=mt,this.applyStyles()},De.prototype.getHtmlContentNode=function(ke){var Bt,mt=ke(this.options.title||"",this.options.items);return(0,a.isString)(mt)?Bt=this.createDom(mt):Bt=mt,Bt},De.prototype.resetTitle=function(){var ke=this.options.title,Bt=this.options.showTitle;Bt&&ke?(this.showTitle(),this.setTitle(ke)):this.hideTitle()},De.prototype.showTitle=function(){var ke=this.titleDom;ke&&(0,P.Z)(ke,{display:"block"})},De.prototype.hideTitle=function(){var ke=this.titleDom;ke&&(0,P.Z)(ke,{display:"none"})},De.prototype.setTitle=function(ke){var Bt=this.titleDom;Bt&&(Bt.innerHTML=ke)},De.prototype.renderItems=function(){var ke=this;this.clearItemDoms();var Bt=this.options.items,mt=this.options.itemTpl||ce,Mr=this.listDom;Mr&&(Bt.forEach(function(Cr){var Nr=(0,Z.__assign)({},Cr),nt=(0,a.substitute)(mt,Nr),Ye=ke.createDom(nt);Mr.appendChild(Ye)}),this.applyChildrenStyles(Mr,this.options.domStyles))},De.prototype.clearItemDoms=function(){this.listDom&&wt(this.listDom)},De.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},De}(fe),re="l7plot-legend l7plot-legend__category",Ge="l7plot-legend__title",Qe="l7plot-legend__category-list",Te="l7plot-legend__list-item",Le="l7plot-legend__category-marker",Ce="l7plot-legend__category-value",Fe='<div class="'.concat(re,`">
  <div class="`).concat(Ge,`"></div>
  <ul class="`).concat(Qe,`"></ul>
</div>`),Ke='<li class="'.concat(Te,`" data-index={index}>
  <span class="`).concat(Le,`" style="background:{color}"></span>
  <span class="`).concat(Ce,`">{value}</span>
</li>`),qt,ir=(qt={},qt[re]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:L.fontFamily,padding:"10px 10px 6px 10px",lineHeight:1,fontSize:"12px"},qt[Ge]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},qt[Qe]={margin:"0px",listStyleType:"none",padding:"0px"},qt[Te]={listStyleType:"none",display:"flex",alignItems:"center",marginBottom:"2px"},qt[Le]={width:"10px",height:"10px"},qt[Ce]={paddingLeft:"8px"},qt),Pe=function(Ae){(0,Z.__extends)(De,Ae);function De(){return Ae!==null&&Ae.apply(this,arguments)||this}return De.prototype.getDefaultOptions=function(){return(0,a.deepMix)({},Ae.prototype.getDefaultOptions.call(this),{id:"l7plot-category-legend",name:"l7plot-category-legend",title:"",items:[],containerTpl:Fe,itemTpl:Ke,domStyles:ir,className:re})},De.prototype.initContainer=function(){var ke=this.options.customContent;if(ke){var Bt=this.getHtmlContentNode(ke),mt=this.getParentContainer();return mt&&mt.appendChild(Bt),Bt}else return Ae.prototype.initContainer.call(this)},De.prototype.initDom=function(){this.cacheDoms()},De.prototype.initEvent=function(){},De.prototype.removeEvent=function(){},De.prototype.cacheDoms=function(){var ke=this.container,Bt=ke.getElementsByClassName(Ge)[0],mt=ke.getElementsByClassName(Qe)[0];this.titleDom=Bt,this.listDom=mt},De.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},De.prototype.show=function(){var ke=this.container;!ke||this.destroyed||(0,P.Z)(ke,{visibility:"visible"})},De.prototype.hide=function(){var ke=this.container;!ke||this.destroyed||(0,P.Z)(ke,{visibility:"hidden"})},De.prototype.updateInner=function(ke){this.options.customContent?this.renderCustomContent(this.options.customContent):(ke.title&&this.resetTitle(),ke.items&&this.renderItems()),Ae.prototype.updateInner.call(this,ke)},De.prototype.renderCustomContent=function(ke){var Bt=this.container.parentNode,mt=this.getHtmlContentNode(ke),Mr=this.container;Bt&&Bt.replaceChild(mt,Mr),this.container=mt,this.applyStyles()},De.prototype.getHtmlContentNode=function(ke){var Bt,mt=ke(this.options.title||"",this.options.items);return(0,a.isString)(mt)?Bt=this.createDom(mt):Bt=mt,Bt},De.prototype.resetTitle=function(){var ke=this.options.title;ke?(this.showTitle(),this.setTitle(ke)):this.hideTitle()},De.prototype.showTitle=function(){var ke=this.titleDom;ke&&(0,P.Z)(ke,{display:"block"})},De.prototype.hideTitle=function(){var ke=this.titleDom;ke&&(0,P.Z)(ke,{display:"none"})},De.prototype.setTitle=function(ke){var Bt=this.titleDom;Bt&&(Bt.innerHTML=ke)},De.prototype.renderItems=function(){var ke=this;this.clearItemDoms();var Bt=this.options.items.length>30?this.options.items.slice(0,30):this.options.items,mt=this.options.itemTpl||Ke,Mr=this.listDom;Mr&&(Bt.forEach(function(Cr){var Nr=Cr.value==="",nt=Nr?"\u2014":Array.isArray(Cr.value)?Cr.value.join(" - "):Cr.value,Ye=(0,Z.__assign)((0,Z.__assign)({},Cr),{value:nt}),M=(0,a.substitute)(mt,Ye),W=ke.createDom(M);Mr.appendChild(W)}),this.applyChildrenStyles(Mr,this.options.domStyles))},De.prototype.clearItemDoms=function(){this.listDom&&wt(this.listDom)},De.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},De}(fe),Ne="l7plot-legend l7plot-legend__continue",Xe="l7plot-legend__title",kt="l7plot-legend__ribbon-container",rr="l7plot-legend__ribbon",me="l7plot-legend__gradient-bar",et="l7plot-legend__value-range",or='<div class="'.concat(Ne,`">
  <div class="`).concat(Xe,`"></div>
  <div class="`).concat(kt,`"></div>
</div>`),on='<div class="'.concat(rr,`">
  <span class="`).concat(et,`">{min}</span>
  <div class="`).concat(me,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(et,`">{max}</span>
</div>`),vr,jr=(vr={},vr[Ne]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:L.fontFamily,padding:"10px",lineHeight:1,fontSize:"12px"},vr[Xe]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},vr[rr]={display:"flex",alignItems:"center"},vr[me]={width:"140px",height:"14px",margin:"0px 5px"},vr[et]={padding:"0px"},vr),xr=function(Ae){(0,Z.__extends)(De,Ae);function De(){return Ae!==null&&Ae.apply(this,arguments)||this}return De.prototype.getDefaultOptions=function(){return(0,a.deepMix)({},Ae.prototype.getDefaultOptions.call(this),{id:"l7plot-continue-legend",name:"l7plot-continue-legend",title:"",containerTpl:or,ribbonTpl:on,domStyles:jr,className:Ne})},De.prototype.initContainer=function(){var ke=this.options.customContent;if(ke){var Bt=this.getHtmlContentNode(ke),mt=this.getParentContainer();return mt&&mt.appendChild(Bt),Bt}else return Ae.prototype.initContainer.call(this)},De.prototype.initDom=function(){this.cacheDoms()},De.prototype.initEvent=function(){},De.prototype.removeEvent=function(){},De.prototype.cacheDoms=function(){var ke=this.container,Bt=ke.getElementsByClassName(Xe)[0],mt=ke.getElementsByClassName(kt)[0];this.titleDom=Bt,this.ribbonContainerDom=mt},De.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderRibbon())},De.prototype.show=function(){var ke=this.container;!ke||this.destroyed||(0,P.Z)(ke,{visibility:"visible"})},De.prototype.hide=function(){var ke=this.container;!ke||this.destroyed||(0,P.Z)(ke,{visibility:"hidden"})},De.prototype.updateInner=function(ke){this.options.customContent?this.renderCustomContent(this.options.customContent):(ke.title&&this.resetTitle(),ke.colors&&this.renderRibbon()),Ae.prototype.updateInner.call(this,ke)},De.prototype.renderCustomContent=function(ke){var Bt=this.container.parentNode,mt=this.getHtmlContentNode(ke),Mr=this.container;Bt&&Bt.replaceChild(mt,Mr),this.container=mt,this.applyStyles()},De.prototype.getHtmlContentNode=function(ke){var Bt,mt=ke(this.options.title||"",this.options.min,this.options.max,this.options.colors);return(0,a.isString)(mt)?Bt=this.createDom(mt):Bt=mt,Bt},De.prototype.resetTitle=function(){var ke=this.options.title;ke?(this.showTitle(),this.setTitle(ke)):this.hideTitle()},De.prototype.showTitle=function(){var ke=this.titleDom;ke&&(0,P.Z)(ke,{display:"block"})},De.prototype.hideTitle=function(){var ke=this.titleDom;ke&&(0,P.Z)(ke,{display:"none"})},De.prototype.setTitle=function(ke){var Bt=this.titleDom;Bt&&(Bt.innerHTML=ke)},De.prototype.renderRibbon=function(){this.clearRibbonContainerDoms();var ke=this.options,Bt=ke.min,mt=ke.max,Mr=ke.colors,Cr=ke.ribbonTpl,Nr=Cr===void 0?on:Cr,nt=this.ribbonContainerDom;if(nt){var Ye="linear-gradient(to right, ".concat(Mr.join(", "),")"),M={min:Bt,max:mt,backgroundImage:Ye},W=(0,a.substitute)(Nr,M),ue=this.createDom(W);nt.appendChild(ue),this.applyChildrenStyles(nt,this.options.domStyles)}},De.prototype.clearRibbonContainerDoms=function(){this.ribbonContainerDom&&wt(this.ribbonContainerDom)},De.prototype.clear=function(){this.setTitle(""),this.clearRibbonContainerDoms()},De}(fe)},3876:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ITEM_TPL=A.CONTAINER_TPL=A.VALUE_CLASS=A.MARKER_CLASS=A.LIST_ITEM_CLASS=A.LIST_CLASS=A.TITLE_CLASS=A.CONTAINER_CLASS=void 0,A.CONTAINER_CLASS="l7plot-legend l7plot-legend__category",A.TITLE_CLASS="l7plot-legend__title",A.LIST_CLASS="l7plot-legend__category-list",A.LIST_ITEM_CLASS="l7plot-legend__list-item",A.MARKER_CLASS="l7plot-legend__category-marker",A.VALUE_CLASS="l7plot-legend__category-value",A.CONTAINER_TPL='<div class="'.concat(A.CONTAINER_CLASS,`">
  <div class="`).concat(A.TITLE_CLASS,`"></div>
  <ul class="`).concat(A.LIST_CLASS,`"></ul>
</div>`),A.ITEM_TPL='<li class="'.concat(A.LIST_ITEM_CLASS,`" data-index={index}>
  <span class="`).concat(A.MARKER_CLASS,`" style="background:{color}"></span>
  <span class="`).concat(A.VALUE_CLASS,`">{value}</span>
</li>`)},56992:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.RIBBON_TPL=A.CONTAINER_TPL=A.VALUE_RANGE_CLASS=A.GRADIENT_BAR_CLASS=A.RIBBON_CLASS=A.RIBBON_CONTAINER_CLASS=A.TITLE_CLASS=A.CONTAINER_CLASS=void 0,A.CONTAINER_CLASS="l7plot-legend l7plot-legend__continue",A.TITLE_CLASS="l7plot-legend__title",A.RIBBON_CONTAINER_CLASS="l7plot-legend__ribbon-container",A.RIBBON_CLASS="l7plot-legend__ribbon",A.GRADIENT_BAR_CLASS="l7plot-legend__gradient-bar",A.VALUE_RANGE_CLASS="l7plot-legend__value-range",A.CONTAINER_TPL='<div class="'.concat(A.CONTAINER_CLASS,`">
  <div class="`).concat(A.TITLE_CLASS,`"></div>
  <div class="`).concat(A.RIBBON_CONTAINER_CLASS,`"></div>
</div>`),A.RIBBON_TPL='<div class="'.concat(A.RIBBON_CLASS,`">
  <span class="`).concat(A.VALUE_RANGE_CLASS,`">{min}</span>
  <div class="`).concat(A.GRADIENT_BAR_CLASS,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(A.VALUE_RANGE_CLASS,`">{max}</span>
</div>`)},77972:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ITEM_TPL=A.CONTAINER_TPL=A.VALUE_CLASS=A.NAME_CLASS=A.LIST_ITEM_CLASS=A.LIST_CLASS=A.TITLE_CLASS=A.CONTAINER_CLASS=void 0,A.CONTAINER_CLASS="l7plot-tooltip",A.TITLE_CLASS="l7plot-tooltip__title",A.LIST_CLASS="l7plot-tooltip__list",A.LIST_ITEM_CLASS="l7plot-tooltip__list-item",A.NAME_CLASS="l7plot-tooltip__name",A.VALUE_CLASS="l7plot-tooltip__value",A.CONTAINER_TPL='<div class="'.concat(A.CONTAINER_CLASS,`">
  <div class="`).concat(A.TITLE_CLASS,`"></div>
  <ul class="`).concat(A.LIST_CLASS,`"></ul>
</div>`),A.ITEM_TPL='<li class="'.concat(A.LIST_ITEM_CLASS,`" data-index={index}>
  <span class="`).concat(A.NAME_CLASS,`">{name}</span>
  <span class="`).concat(A.VALUE_CLASS,`">{value}</span>
</li>`)},27544:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.MappingLayer=A.getMappingFunction=void 0;var v=y(49242);function Z(P,L){return function(){for(var O=[],D=0;D<arguments.length;D++)O[D]=arguments[D];var B={};return P.forEach(function(V,N){B[V]=O[N]}),delete B.undefined,L(B)}}A.getMappingFunction=Z;var a=function(){function P(){}return P.shape=function(L,O){if((0,v.isString)(O))L.shape(O);else if((0,v.isFunction)(O)){var D=[];L.shape(D.join("*"),Z(D,O))}else if((0,v.isObject)(O)){var B=O.field?O.field:"";if((0,v.isFunction)(O.value)){var D=(0,v.isArray)(B)?B:B.split("*");L.shape(B,Z(D,O.value))}else L.shape(B,O.value);(0,v.isString)(B)&&O.scale&&P.scale(L,B,O.scale)}},P.size=function(L,O){if((0,v.isNumber)(O))L.size(O);else if((0,v.isArray)(O))L.size(O);else if((0,v.isFunction)(O)){var D=[];L.size(D.join("*"),Z(D,O))}else if((0,v.isObject)(O)){var B=O.field?O.field:"";if((0,v.isFunction)(O.value)){var D=(0,v.isArray)(B)?B:B.split("*");L.size(B,Z(D,O.value))}else L.size(B,O.value);(0,v.isString)(B)&&O.scale&&P.scale(L,B,O.scale)}},P.color=function(L,O){if((0,v.isString)(O))L.color(O);else if((0,v.isFunction)(O)){var D=[];L.color(D.join("*"),Z(D,O))}else if((0,v.isObject)(O)){var B=O.field?O.field:"";if((0,v.isFunction)(O.value)){var D=(0,v.isArray)(B)?B:B.split("*");L.color(B,Z(D,O.value))}else L.color(B,O.value);(0,v.isString)(B)&&O.scale&&P.scale(L,B,O.scale)}},P.style=function(L,O){O&&L.style(O)},P.state=function(L,O){var D=O.active,B=O.select;D&&L.active(D),B&&L.select(B)},P.rotate=function(L,O){(0,v.isString)(O)||(0,v.isFunction)(O)||(0,v.isObject)(O)},P.texture=function(L,O){(0,v.isString)(O)&&L.texture(O)},P.animate=function(L,O){((0,v.isBoolean)(O)||(0,v.isObject)(O))&&L.animate(O)},P.scale=function(L,O,D){L.scale(O,D)},P.filter=function(L,O){var D=O.field?O.field:"",B=(0,v.isArray)(D)?D:D.split("*");L.filter(B.join("*"),Z(B,O.value))},P}();A.MappingLayer=a},60105:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.MappingSource=void 0;var y=function(){function v(){}return v.aggregation=function(Z,a){var P=a.type,L=P===void 0?"grid":P,O=a.radius,D=a.method,B=a.field,V={type:L,size:O,method:D,field:B};Z.transforms?(Z.transforms=Z.transforms.filter(function(N){return N.type!==V.type}),Z.transforms.push(V)):Z.transforms=[V]},v}();A.MappingSource=y},86677:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Legend=void 0;var v=y(70655),Z=y(66845),a=y(14403),P=function(L){(0,v.__extends)(O,L);function O(D){var B=L.call(this,D)||this;return B.legendComponents=[],B.options=D,B.legendComponents=B.initLegendComponents(D.items),B}return O.prototype.initLegendComponents=function(D){for(var B=[],V=0;V<D.length;V++){var N=D[V];if(N.type==="category"){var Y=new a.CategoryLegend({title:N.options.title,items:N.options.items,className:N.options.className,customContent:N.options.customContent,domStyles:N.options.domStyles});B.push(Y)}else if(N.type==="continue"){var Y=new a.ContinueLegend({title:N.options.title,min:N.options.min,max:N.options.max,colors:N.options.colors,className:N.options.className,customContent:N.options.customContent,domStyles:N.options.domStyles});B.push(Y)}}return B},O.prototype.getDefaultOptions=function(){return{position:"bottomleft"}},O.prototype.onAdd=function(){var D=window.document.createElement("div");return D.className="l7plot-legend-container",this.legendComponents.forEach(function(B){var V=B.getContainer();D.appendChild(V)}),D},O.prototype.onRemove=function(){this.legendComponents.forEach(function(D){D.destroy()})},O}(Z.Control);A.Legend=P},20430:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Tooltip=void 0;var v=y(70655),Z=y(66845),a=(0,v.__importDefault)(y(90494)),P=y(49242),L=y(14403),O=y(57324),D=y(75516),B=y(57042),V=["mousemove","click"],N=function(Y){(0,v.__extends)(H,Y);function H(ce,at,rt){var Re=Y.call(this)||this;Re.currentVisible=!1,Re.interactionTriggerHander=function(Le){var Ce=Le.feature,Fe=Le.featureId,Ke=Re.options,qt=Ke.title,ir=Ke.customTitle,Pe=Ke.items,Ne=Ke.customItems,Xe=Ce.type==="Feature"&&Ce.geometry&&Ce.properties,kt=Xe?Ce.properties:Ce,rr=[];if(Ne){var me=Ne(Ce);if(Array.isArray(me))rr=me;else throw new Error("customItems return array")}else Pe&&Pe.forEach(function(or){if((0,P.isString)(or)){var on=or.split(".").pop()||or,vr=(0,O.get)(kt,or);vr!==void 0&&rr.push({name:on,value:vr})}else{var jr=or.field,xr=or.alias,Ae=or.customValue,De=xr||jr.split(".").pop()||jr,vr=(0,O.get)(kt,jr);vr!==void 0&&rr.push({name:De,value:Ae?Ae(vr,kt,Fe):vr})}});var et={title:ir?ir(kt):qt,items:rr};Re.updateTooltip(Le,et)},Re.interactionUntriggerHander=function(){Re.hideTooltip()},Re.scene=ce,Re.interactionLayers=at,Re.options=(0,B.deepAssign)({},Re.getDefaultOptions(),rt);var vt=Re.options,wt=vt.offsets,fe=vt.title,$e=vt.showTitle,re=vt.customContent,Ge=vt.domStyles,Qe=vt.anchor,Te=vt.className;return Re.marker=new Z.Marker({offsets:wt,anchor:Qe,draggable:!1}),Re.tooltipComponent=new L.Tooltip({title:fe,showTitle:$e,items:[],customContent:re,domStyles:Ge,className:Te}),Re.setComponent(),Re.initInteractionEvent(),Re}return H.prototype.getDefaultOptions=function(){return{showTitle:!0,showComponent:!0,items:[],offsets:[15,0],trigger:"mousemove",anchor:D.TooltipAnchorType["TOP-LEFT"]}},H.prototype.update=function(ce){this.marker.remove(),this.currentVisible=!1,this.options=(0,B.deepAssign)({},this.options,ce);var at=this.options,rt=at.offsets,Re=at.showTitle,vt=at.customContent,wt=at.domStyles,fe=at.anchor,$e=at.className;this.marker=new Z.Marker({offsets:rt,anchor:fe,draggable:!1}),this.tooltipComponent.update({showTitle:Re,customContent:vt,domStyles:wt,className:$e}),this.setComponent()},H.prototype.initInteractionEvent=function(){var ce=this,at=this.options.trigger||"mousemove";if(!V.includes(at))throw new Error("trigger is mousemove or click");this.interactionLayers.forEach(function(rt){var Re=rt.layer;Re.on(at,ce.interactionTriggerHander),Re.on("un".concat(at),ce.interactionUntriggerHander)})},H.prototype.unBindInteractionEvent=function(){var ce=this,at=this.options.trigger||"mousemove";this.interactionLayers.forEach(function(rt){var Re=rt.layer;Re.off(at,ce.interactionTriggerHander),Re.off("un".concat(at),ce.interactionUntriggerHander)})},H.prototype.updateTooltip=function(ce,at){var rt=ce.lngLat,Re=ce.x,vt=ce.y;if(this.options.showComponent&&(this.updateComponent(at),this.setPostion(rt)),this.currentVisible){var wt={type:"tooltip:change",data:at,lngLat:rt,x:Re,y:vt};this.emit("tooltip:change",wt)}else{this.showTooltip();var fe={type:"tooltip:show",data:at,lngLat:rt,x:Re,y:vt};this.emit("tooltip:show",fe)}},H.prototype.showTooltip=function(){this.currentVisible||(this.options.showComponent&&this.scene.addMarker(this.marker),this.currentVisible=!0)},H.prototype.hideTooltip=function(){if(!!this.currentVisible){this.options.showComponent&&this.marker.remove(),this.currentVisible=!1;var ce={type:"tooltip:hide"};this.emit("tooltip:hide",ce)}},H.prototype.updateComponent=function(ce){(0,P.isEqual)(this.lastComponentOptions,ce)||(this.tooltipComponent.update(ce),this.lastComponentOptions=ce)},H.prototype.setComponent=function(){var ce=this.tooltipComponent.getContainer(),at=window.document.createElement("div");at.style.cursor="auto",at.style.userSelect="text",at.className="l7plot-tooltip-container",["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(rt){at.addEventListener(rt,function(Re){return Re.stopPropagation()})}),at.appendChild(ce),this.marker.setElement(at)},H.prototype.setPostion=function(ce){this.marker.setLnglat(ce)},H.prototype.destroy=function(){this.unBindInteractionEvent(),this.off(),this.marker.remove(),this.tooltipComponent.destroy()},H}(a.default);A.Tooltip=N},34525:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.LayerGroup=void 0;var v=y(70655),Z=y(49242),a=(0,v.__importDefault)(y(90494)),P=function(L){(0,v.__extends)(O,L);function O(D,B){D===void 0&&(D=[]),B===void 0&&(B={});var V=L.call(this)||this;return V.name=B.name?B.name:(0,Z.uniqueId)("layerGroup"),V.layers=D,V}return O.prototype.addTo=function(D){var B=this;this.scene=D;var V=0,N=this.layers.length;this.layers.forEach(function(Y){Y.once("inited",function(H){V++,B.emit("inited",H),V===N&&B.emit("inited-all")}),Y.addTo(D)})},O.prototype.hasLayer=function(D){return this.layers.some(function(B){return B===D})},O.prototype.addLayer=function(D){var B=this;this.layers.push(D),this.scene&&(D.once("inited",function(V){return B.emit("inited",V)}),D.addTo(this.scene))},O.prototype.removeLayer=function(D){var B=this.layers.findIndex(function(V){return V===D});return B===-1?!1:(this.layers.splice(B,1),this.scene&&D.remove(this.scene),!0)},O.prototype.getLayers=function(){return this.layers},O.prototype.getInteractionLayers=function(){return this.layers.filter(function(D){var B=D.interaction;return B})},O.prototype.getLayer=function(D){return this.layers.find(function(B){var V=B.layer;return V.id===D})},O.prototype.getLayerByName=function(D){return this.layers.find(function(B){return B.name===D})},O.prototype.removeAllLayer=function(){var D=this;this.layers.forEach(function(B){D.scene&&B.remove(D.scene)}),this.layers=[]},O.prototype.isEmpty=function(){return this.layers.length===0},O}(a.default);A.LayerGroup=P},19093:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.PlotLayer=void 0;var v=y(70655),Z=y(49242),a=(0,v.__importDefault)(y(96090)),P=(0,v.__importDefault)(y(90494)),L=y(55226),O=y(60105),D=y(52164),B=y(57042),V=["name","zIndex","visible","minZoom","maxZoom","pickingBuffer","autoFit","blend"],N=function(Y){(0,v.__extends)(H,Y);function H(ce){var at=Y.call(this)||this;return at.options=(0,B.deepAssign)({},at.getDefaultOptions(),ce),at.lastOptions=at.options,at}return H.prototype.getDefaultOptions=function(){return{}},H.prototype.pickLayerConfig=function(ce){var at=(0,Z.pick)(ce,V);return at},H.prototype.addTo=function(ce){ce.addLayer(this.layer)},H.prototype.remove=function(ce){ce.removeLayer(this.layer)},H.prototype.update=function(ce){this.updateOption(ce),this.updateConfig(ce)},H.prototype.updateOption=function(ce){this.lastOptions=this.options,this.options=(0,B.deepAssign)({},this.options,ce)},H.prototype.updateConfig=function(ce){!(0,Z.isUndefined)(ce.zIndex)&&!(0,Z.isEqual)(this.lastOptions.zIndex,this.options.zIndex)&&this.setIndex(ce.zIndex),!(0,Z.isUndefined)(ce.blend)&&!(0,Z.isEqual)(this.lastOptions.blend,this.options.blend)&&this.setBlend(ce.blend),!(0,Z.isUndefined)(ce.minZoom)&&!(0,Z.isEqual)(this.lastOptions.minZoom,this.options.minZoom)&&this.setMinZoom(ce.minZoom),!(0,Z.isUndefined)(ce.maxZoom)&&!(0,Z.isEqual)(this.lastOptions.maxZoom,this.options.maxZoom)&&this.setMinZoom(ce.maxZoom),!(0,Z.isUndefined)(ce.visible)&&!(0,Z.isEqual)(this.lastOptions.visible,this.options.visible)&&(ce.visible?this.show():this.hide())},H.prototype.render=function(){this.layer.renderLayers()},H.prototype.setSource=function(ce){if(ce instanceof a.default)this.layer.setSource(ce);else{var at=ce.data,rt=ce.aggregation,Re=(0,v.__rest)(ce,["data","aggregation"]);rt&&O.MappingSource.aggregation(Re,rt);var vt=this.layer.getSource();vt?this.layer.setData(at,Re):this.layer.source(at,Re)}},H.prototype.changeData=function(ce){this.setSource(ce)},H.prototype.setIndex=function(ce){this.layer.setIndex(ce)},H.prototype.setBlend=function(ce){this.layer.setBlend(ce)},H.prototype.setMinZoom=function(ce){this.layer.setMinZoom(ce)},H.prototype.setMaxZoom=function(ce){this.layer.setMaxZoom(ce)},H.prototype.show=function(){this.layer.inited&&this.layer.show()},H.prototype.hide=function(){this.layer.inited&&this.layer.hide()},H.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},H.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():this.options.visible},H.prototype.fitBounds=function(ce){this.layer.fitBounds(ce)},H.prototype.on=function(ce,at){return D.LayerEventList.indexOf(ce)!==-1?this.layer.on(ce,at):Y.prototype.on.call(this,ce,at),this},H.prototype.once=function(ce,at){return D.LayerEventList.indexOf(ce)!==-1?this.layer.once(ce,at):Y.prototype.once.call(this,ce,at),this},H.prototype.off=function(ce,at){return D.LayerEventList.indexOf(ce)!==-1?this.layer.off(ce,at):Y.prototype.off.call(this,ce,at),this},H.LayerType=L.LayerType,H.LayerConfigkeys=V,H}(P.default);A.PlotLayer=N},52164:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.LayerEventList=A.MapEventList=A.SceneEventList=void 0,A.SceneEventList=[{original:"loaded",adaptation:"scene-loaded"},{original:"resize",adaptation:"resize"},{original:"destroy",adaptation:"destroy"},{original:"resize",adaptation:"resize"}],A.MapEventList=["mapmove","movestart","moveend","zoomchange","zoomstart","zoomend","click","dblclick","contextmenu","mousemove","mousewheel","mouseover","mouseout","mouseup","mousedown","dragstart","dragging","dragend"],A.LayerEventList=["inited","add","remove","dataUpdate","click","unclick","contextmenu","uncontextmenu","mouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","uncontextmenu","unpick"]},12392:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Map=void 0;var v=y(70655),Z=y(20110),a=y(97671),P=y(66845),L=(0,v.__importDefault)(y(90494)),O=y(49242),D=y(20430),B=y(86677),V=y(57042),N=y(75516),Y=y(34525),H=y(52164),ce=y(23021),at=y(23316),rt=y(4548),Re={map:{type:N.BaseMapType.Amap},logo:!0},vt=function(wt){(0,v.__extends)(fe,wt);function fe($e){var re=wt.call(this)||this;return re.inited=!1,re.sceneLoaded=!1,re.layersLoaded=!1,re.loaded=!1,re.layerGroup=new Y.LayerGroup,re.options=(0,V.deepAssign)({},re.getDefaultOptions(),$e),re.lastOptions=re.options,re}return fe.prototype.getDefaultOptions=function(){return fe.DefaultOptions},fe.prototype.createContainer=function($e){var re=this.options,Ge=re.width,Qe=re.height,Te=typeof $e=="string"?document.getElementById($e):$e;return Te.style.position||(Te.style.position="relative"),Ge&&(Te.style.width||(Te.style.width="".concat(Ge,"px"))),Qe&&(Te.style.height||(Te.style.height="".concat(Qe,"px"))),Te},fe.prototype.createTheme=function(){var $e=(0,O.isObject)(this.options.theme)?(0,V.deepAssign)({},(0,at.getTheme)("default"),(0,rt.createTheme)(this.options.theme)):(0,at.getTheme)(this.options.theme);return $e},fe.prototype.createMap=function(){var $e=this.options.map?this.options.map:Re.map,re=$e.type,Ge=(0,v.__rest)($e,["type"]),Qe=Object.assign({style:this.theme.mapStyle},Ge);return re===N.BaseMapType.Amap?new a.GaodeMap(Qe):new a.Mapbox(Qe)},fe.prototype.createScene=function(){var $e=this.options,re=$e.logo,Ge=$e.antialias,Qe=$e.preserveDrawingBuffer,Te=(0,O.isBoolean)(re)?{logoVisible:re}:{logoVisible:re==null?void 0:re.visible,logoPosition:re==null?void 0:re.position},Le=Object.assign({antialias:Ge,preserveDrawingBuffer:Qe},Te),Ce=this.createMap(),Fe=new Z.Scene((0,v.__assign)({id:this.container,map:Ce},Le));return Fe},fe.prototype.registerResources=function(){var $e=this;ce.IMAGES_CACHE.size&&ce.IMAGES_CACHE.forEach(function(re,Ge){!$e.scene.hasImage(Ge)&&$e.scene.addImage(Ge,re)}),ce.FONT_FACE_CACHE.size&&ce.FONT_FACE_CACHE.forEach(function(re,Ge){$e.scene.addFontFace(Ge,re)}),ce.ICON_FONT_CACHE.size&&ce.ICON_FONT_CACHE.forEach(function(re,Ge){$e.scene.addIconFont(Ge,re)})},fe.prototype.update=function($e){this.updateOption($e),$e.map&&!(0,O.isEqual)(this.lastOptions.map,this.options.map)&&this.updateMap($e.map),this.render(),this.emit("update")},fe.prototype.updateOption=function($e){this.lastOptions=this.options,this.options=(0,V.deepAssign)({},this.options,$e)},fe.prototype.updateMap=function($e){var re;if(!!this.scene){var Ge=$e.style,Qe=$e.center,Te=$e.zoom,Le=$e.rotation,Ce=$e.pitch;(0,O.isUndefined)(Ce)||this.scene.setPitch(Ce),(0,O.isUndefined)(Le)||this.scene.setRotation(Le),Ge&&Ge!==((re=this.lastOptions.map)===null||re===void 0?void 0:re.style)&&this.scene.setMapStyle(Ge),Te&&Qe&&this.scene.setZoomAndCenter(Te,Qe)}},fe.prototype.changeSize=function($e,re){this.options.width===$e&&this.options.height===re||(this.container.style.width="".concat($e,"px"),this.container.style.height="".concat(re,"px"),this.options=Object.assign(this.options,{width:$e,height:re}))},fe.prototype.on=function($e,re){return this.proxyEventHander("on",$e,re),this},fe.prototype.once=function($e,re){return this.proxyEventHander("once",$e,re),this},fe.prototype.off=function($e,re){return this.proxyEventHander("off",$e,re),this},fe.prototype.proxyEventHander=function($e,re,Ge){var Qe=H.SceneEventList.find(function(Ke){return Ke.adaptation===re});if(Qe)this.scene[$e](Qe.original,Ge);else if(H.MapEventList.indexOf(re)!==-1)this.scene[$e](re,Ge);else if(re.includes("Layer:")){var Te=(0,v.__read)(re.split(":"),2),Le=Te[0],Ce=Te[1],Fe=this[Le]&&this[Le][$e];if(Fe&&H.LayerEventList.indexOf(Ce)!==-1)this[Le][$e](Ce,Ge);else throw new Error('No event name "'.concat(re,'"'))}else wt.prototype[$e].call(this,re,Ge)},fe.prototype.getScene=function(){return this.scene},fe.prototype.getMap=function(){var $e,re;return(($e=this.options.map)===null||$e===void 0?void 0:$e.type)===N.BaseMapType.Amap?this.scene.map:((re=this.options.map)===null||re===void 0?void 0:re.type)===N.BaseMapType.Mapbox?this.scene.map:this.scene.map},fe.prototype.addLayer=function($e){this.layerGroup.addLayer($e)},fe.prototype.getLayes=function(){return console.warn("Replace to use getLayers()"),this.getLayers()},fe.prototype.getLayers=function(){return this.layerGroup.getLayers()},fe.prototype.getLayerByName=function($e){return this.layerGroup.getLayerByName($e)},fe.prototype.removeLayer=function($e){return this.layerGroup.removeLayer($e)},fe.prototype.removeAllLayer=function(){this.layerGroup.removeAllLayer()},fe.prototype.zoomIn=function(){this.scene.zoomIn()},fe.prototype.zoomOut=function(){this.scene.zoomOut()},fe.prototype.setPitch=function($e){this.scene.setPitch($e)},fe.prototype.fitBounds=function($e){this.scene.fitBounds($e)},fe.prototype.setMapStatus=function($e){this.scene.setMapStatus($e)},fe.prototype.setBgColor=function($e){this.scene.setBgColor($e)},fe.prototype.initComponents=function(){this.initControls(),this.initTooltip()},fe.prototype.updateComponents=function(){this.updateControls(),this.initTooltip()},fe.prototype.initControls=function(){var $e=this.options,re=$e.zoom,Ge=$e.scale,Qe=$e.layerMenu,Te=$e.legend;Ge&&this.addScaleControl(Ge),re&&this.addZoomControl(re),Qe&&this.addLayerMenuControl(Qe),Te&&this.addLegendControl(Te)},fe.prototype.updateControls=function(){var $e=this.options,re=$e.zoom,Ge=$e.scale,Qe=$e.layerMenu,Te=$e.legend;(0,O.isEqual)(this.lastOptions.zoom,re)||(re?this.updateZoomControl(re):this.removeZoomControl()),(0,O.isEqual)(this.lastOptions.scale,Ge)||(Ge?this.updateScaleControl(Ge):this.removeScaleControl()),(0,O.isEqual)(this.lastOptions.layerMenu,Qe)||(Qe?this.updateLayerMenuControl(Qe):this.removeLayerMenuControl()),(0,O.isEqual)(this.lastOptions.legend,Te)||(Te?this.updateLegendControl(Te):this.removeLegendControl())},fe.prototype.addZoomControl=function($e){this.zoomControl||(this.zoomControl=new P.Zoom($e),this.scene.addControl(this.zoomControl))},fe.prototype.updateZoomControl=function($e){if(!this.zoomControl){this.addZoomControl($e);return}this.removeZoomControl(),this.addZoomControl($e)},fe.prototype.removeZoomControl=function(){this.zoomControl&&(this.zoomControl.remove(),this.zoomControl=void 0)},fe.prototype.addScaleControl=function($e){this.scaleControl||(this.scaleControl=new P.Scale($e),this.scene.addControl(this.scaleControl))},fe.prototype.updateScaleControl=function($e){if(!this.scaleControl){this.addScaleControl($e);return}this.removeScaleControl(),this.addScaleControl($e)},fe.prototype.removeScaleControl=function(){this.scaleControl&&(this.scaleControl.remove(),this.scaleControl=void 0)},fe.prototype.addLayerMenuControl=function($e){if(!this.layerMenuControl){var re={},Ge={};this.layerGroup.getLayers().forEach(function(Qe){var Te=Qe.name,Le=Qe.layer;Ge[Te]=Le}),this.layerMenuControl=new P.Layers(Object.assign({},$e,{baseLayers:re,overlayers:Ge})),this.scene.addControl(this.layerMenuControl)}},fe.prototype.updateLayerMenuControl=function($e){if(!this.layerMenuControl){this.addLayerMenuControl($e);return}this.removeLayerMenuControl(),this.addLayerMenuControl($e)},fe.prototype.removeLayerMenuControl=function(){this.layerMenuControl&&(this.layerMenuControl.remove(),this.layerMenuControl=void 0)},fe.prototype.getLegendOptions=function(){return{}},fe.prototype.addLegendControl=function($e){if(!this.legendControl){var re=this.theme.components.legend,Ge=(0,V.deepAssign)({},this.getLegendOptions(),$e),Qe=Ge.type,Te=Ge.position,Le=(0,v.__rest)(Ge,["type","position"]),Ce=[];if(Qe==="category"){var Fe=(0,V.deepAssign)({},{domStyles:re.category.domStyles},Le);Ce.push({type:Qe,options:Fe})}else if(Qe==="continue"){var Ke=(0,V.deepAssign)({},{domStyles:re.continue.domStyles},Le);Ce.push({type:Qe,options:Ke})}Ce.length&&(this.legendControl=new B.Legend({position:Te,items:Ce}),this.scene.addControl(this.legendControl))}},fe.prototype.updateLegendControl=function($e){if(!this.legendControl){this.addLegendControl($e);return}this.removeLegendControl(),this.addLegendControl($e)},fe.prototype.removeLegendControl=function(){this.legendControl&&(this.legendControl.remove(),this.legendControl=void 0)},fe.prototype.initTooltip=function(){var $e=this;this.tooltip&&this.tooltip.destroy();var re=this.options.tooltip;if(re){var Ge=(0,V.deepAssign)({},{domStyles:this.theme.components.tooltip.domStyles},re),Qe=this.layerGroup.getInteractionLayers();this.tooltip=new D.Tooltip(this.scene,Qe,Ge),this.tooltip.on("*",function(Te){return $e.emit(Te.type,Te)})}},fe.prototype.exportPng=function($e){return this.scene.exportPng($e)},fe.prototype.destroy=function(){var $e;wt.prototype.off.call(this,"*"),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),($e=this.tooltip)===null||$e===void 0||$e.destroy(),this.scene.destroy()},fe.DefaultOptions=Re,fe}(L.default);A.Map=vt},23021:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.unregisterIconFont=A.registerIconFonts=A.registerIconFont=A.ICON_FONT_CACHE=A.unregisterFontFace=A.registerFontFace=A.FONT_FACE_CACHE=A.unregisterImage=A.hasImage=A.getImage=A.registerImages=A.registerImage=A.IMAGES_CACHE=void 0,A.IMAGES_CACHE=new Map;function y(N,Y){A.IMAGES_CACHE.set(N,Y)}A.registerImage=y;function v(N){N.forEach(function(Y){A.IMAGES_CACHE.set(Y.id,Y.image)})}A.registerImages=v;function Z(N){return A.IMAGES_CACHE.get(N)}A.getImage=Z;function a(N){return A.IMAGES_CACHE.has(N)}A.hasImage=a;function P(N){return A.IMAGES_CACHE.delete(N)}A.unregisterImage=P,A.FONT_FACE_CACHE=new Map;function L(N,Y){A.FONT_FACE_CACHE.set(N,Y)}A.registerFontFace=L;function O(N){return A.FONT_FACE_CACHE.delete(N)}A.unregisterFontFace=O,A.ICON_FONT_CACHE=new Map;function D(N,Y){A.ICON_FONT_CACHE.set(N,Y)}A.registerIconFont=D;function B(N){N.forEach(function(Y){A.ICON_FONT_CACHE.set(Y.name,Y.fontUnicode)})}A.registerIconFonts=B;function V(N){return A.ICON_FONT_CACHE.delete(N)}A.unregisterIconFont=V},3071:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Plot=void 0;var v=y(70655),Z=y(12392),a=y(57042),P=y(71713),L=y(75516),O=y(60105),D=y(49242),B=y(23316),V={autoFit:!1},N=function(Y){(0,v.__extends)(H,Y);function H(ce,at){var rt=this;if(typeof ce=="string"||ce instanceof Element){if(at===void 0)throw new Error("options is undefined");rt=Y.call(this,at)||this,rt.container=rt.createContainer(ce),rt.theme=rt.createTheme(),rt.scene=rt.createScene(),rt.registerResources(),rt.initSource()}else rt=Y.call(this,ce)||this;return rt}return H.prototype.initSource=function(){this.source=this.createSource(),this.render(),this.inited=!0},H.prototype.initLayersEvent=function(){},H.prototype.getDefaultOptions=function(){return H.DefaultOptions},H.prototype.createSource=function(){var ce=this.options.source,at=ce.data,rt=ce.aggregation,Re=(0,v.__rest)(ce,["data","aggregation"]);rt&&O.MappingSource.aggregation(Re,rt);var vt=new L.Source(at,Re);return vt},H.prototype.createLabelLayer=function(ce,at,rt){var Re=rt||{},vt=Re.visible,wt=Re.minZoom,fe=Re.maxZoom,$e=Re.zIndex,re=$e===void 0?0:$e,Ge=new P.TextLayer((0,v.__assign)({name:"labelLayer",visible:vt,minZoom:wt,maxZoom:fe,zIndex:re+.1,source:ce},at));return Ge},H.prototype.updateLabelLayer=function(ce,at,rt,Re){at?Re?Re.update((0,v.__assign)({},at)):(Re=this.createLabelLayer(ce,at,rt),this.layerGroup.addLayer(Re)):at===!1&&Re&&this.layerGroup.removeLayer(Re)},H.prototype.render=function(){var ce=this,at=this.createLayers(this.source);this.inited?(this.layerGroup.removeAllLayer(),at.addTo(this.scene),this.layerGroup=at):(this.layerGroup=at,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){ce.onSceneLoaded()})),this.initLayersEvent()},H.prototype.onSceneLoaded=function(){var ce=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",function(){ce.onLayersLoaded()}),this.layerGroup.addTo(this.scene)},H.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.initComponents(),this.loaded=!0,this.emit("loaded")},H.prototype.attachToScene=function(ce,at){this.scene=ce,this.theme=at||(0,B.getTheme)("default"),this.registerResources(),this.initSource()},H.prototype.unattachFromScene=function(){var ce;this.removeAllLayer(),(ce=this.tooltip)===null||ce===void 0||ce.destroy()},H.prototype.addToScene=function(ce){this.attachToScene(ce)},H.prototype.removeFromScene=function(){var ce;this.removeAllLayer(),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(ce=this.tooltip)===null||ce===void 0||ce.destroy()},H.prototype.update=function(ce){if(this.updateOption(ce),ce.map&&!(0,D.isEqual)(this.lastOptions.map,this.options.map)&&this.updateMap(ce.map),this.scene.setEnableRender(!1),ce.source&&!(0,D.isEqual)(this.lastOptions.source,this.options.source)){var at=ce.source,rt=at.data,Re=(0,v.__rest)(at,["data"]);this.changeData(rt,Re)}this.scene.setEnableRender(!0),this.render(),this.updateComponents(),this.emit("update")},H.prototype.changeData=function(ce,at){var rt=this;this.options.source=(0,a.deepAssign)({},this.options.source,(0,v.__assign)({data:ce},at));var Re=this.options.source,vt=Re.aggregation,wt=(0,v.__rest)(Re,["aggregation"]);vt&&O.MappingSource.aggregation(wt,vt),this.source.setData(this.options.source.data,wt);var fe=this.options.legend;fe&&setTimeout(function(){rt.updateLegendControl(fe)}),this.emit("change-data")},H.DefaultOptions=V,H.PlotType=L.PlotType,H}(Z.Map);A.Plot=N},59183:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Choropleth=A.Area=A.Flow=A.Path=A.Hexbin=A.Grid=A.Heatmap=A.DotDensity=A.Dot=A.PrismLayer=A.AreaLayer=A.ArcLayer=A.PathLayer=A.HexbinLayer=A.GridLayer=A.HeatmapLayer=A.TextLayer=A.DotDensityLayer=A.IconLayer=A.DotLayer=A.L7Plot=A.Plot=A.Map=A.registerTheme=A.getTheme=A.unregisterIconFont=A.registerIconFonts=A.registerIconFont=A.unregisterFontFace=A.registerFontFace=A.unregisterImage=A.registerImages=A.registerImage=A.version=void 0;var v=y(70655),Z=y(1215);Object.defineProperty(A,"version",{enumerable:!0,get:function(){return(0,v.__importDefault)(Z).default}});var a=y(23021);Object.defineProperty(A,"registerImage",{enumerable:!0,get:function(){return a.registerImage}}),Object.defineProperty(A,"registerImages",{enumerable:!0,get:function(){return a.registerImages}}),Object.defineProperty(A,"unregisterImage",{enumerable:!0,get:function(){return a.unregisterImage}}),Object.defineProperty(A,"registerFontFace",{enumerable:!0,get:function(){return a.registerFontFace}}),Object.defineProperty(A,"unregisterFontFace",{enumerable:!0,get:function(){return a.unregisterFontFace}}),Object.defineProperty(A,"registerIconFont",{enumerable:!0,get:function(){return a.registerIconFont}}),Object.defineProperty(A,"registerIconFonts",{enumerable:!0,get:function(){return a.registerIconFonts}}),Object.defineProperty(A,"unregisterIconFont",{enumerable:!0,get:function(){return a.unregisterIconFont}});var P=y(23316);Object.defineProperty(A,"getTheme",{enumerable:!0,get:function(){return P.getTheme}}),Object.defineProperty(A,"registerTheme",{enumerable:!0,get:function(){return P.registerTheme}}),(0,v.__exportStar)(y(75516),A);var L=y(12392);Object.defineProperty(A,"Map",{enumerable:!0,get:function(){return L.Map}});var O=y(3071);Object.defineProperty(A,"Plot",{enumerable:!0,get:function(){return O.Plot}});var D=y(46278);Object.defineProperty(A,"L7Plot",{enumerable:!0,get:function(){return D.L7Plot}});var B=y(94340);Object.defineProperty(A,"DotLayer",{enumerable:!0,get:function(){return B.DotLayer}});var V=y(39276);Object.defineProperty(A,"IconLayer",{enumerable:!0,get:function(){return V.IconLayer}});var N=y(49855);Object.defineProperty(A,"DotDensityLayer",{enumerable:!0,get:function(){return N.DotDensityLayer}});var Y=y(71713);Object.defineProperty(A,"TextLayer",{enumerable:!0,get:function(){return Y.TextLayer}});var H=y(99177);Object.defineProperty(A,"HeatmapLayer",{enumerable:!0,get:function(){return H.HeatmapLayer}});var ce=y(25140);Object.defineProperty(A,"GridLayer",{enumerable:!0,get:function(){return ce.GridLayer}});var at=y(89645);Object.defineProperty(A,"HexbinLayer",{enumerable:!0,get:function(){return at.HexbinLayer}});var rt=y(84591);Object.defineProperty(A,"PathLayer",{enumerable:!0,get:function(){return rt.PathLayer}});var Re=y(11997);Object.defineProperty(A,"ArcLayer",{enumerable:!0,get:function(){return Re.ArcLayer}});var vt=y(79743);Object.defineProperty(A,"AreaLayer",{enumerable:!0,get:function(){return vt.AreaLayer}});var wt=y(17937);Object.defineProperty(A,"PrismLayer",{enumerable:!0,get:function(){return wt.PrismLayer}});var fe=y(76347);Object.defineProperty(A,"Dot",{enumerable:!0,get:function(){return fe.Dot}});var $e=y(43091);Object.defineProperty(A,"DotDensity",{enumerable:!0,get:function(){return $e.DotDensity}});var re=y(1403);Object.defineProperty(A,"Heatmap",{enumerable:!0,get:function(){return re.Heatmap}});var Ge=y(83821);Object.defineProperty(A,"Grid",{enumerable:!0,get:function(){return Ge.Grid}});var Qe=y(15266);Object.defineProperty(A,"Hexbin",{enumerable:!0,get:function(){return Qe.Hexbin}});var Te=y(13778);Object.defineProperty(A,"Path",{enumerable:!0,get:function(){return Te.Path}});var Le=y(8623);Object.defineProperty(A,"Flow",{enumerable:!0,get:function(){return Le.Flow}});var Ce=y(98994);Object.defineProperty(A,"Area",{enumerable:!0,get:function(){return Ce.Area}});var Fe=y(87883);Object.defineProperty(A,"Choropleth",{enumerable:!0,get:function(){return Fe.Choropleth}})},11997:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ArcLayer=void 0;var v=y(70655),Z=y(57042),a=y(34213),P=function(L){(0,v.__extends)(O,L);function O(){var D=L!==null&&L.apply(this,arguments)||this;return D.type=a.LinesLayer.LayerType.ArcLayer,D}return O.prototype.getDefaultOptions=function(){return(0,Z.deepAssign)({},a.LinesLayer.DefaultOptions,{shape:"arc"})},O}(a.LinesLayer);A.ArcLayer=P},52133:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=A.getDefaultState=void 0;var v=y(49242),Z=y(27544),a="#2f54eb",P={active:{fill:!1,stroke:a,lineWidth:1.5,lineOpacity:.8},select:{fill:!1,stroke:a,lineWidth:1.5,lineOpacity:.8}},L=function(D){return(0,v.isUndefined)(D)||(D.active===!1?P.active=Object.assign(P.active,{fill:!1,stroke:!1}):typeof D.active=="object"&&(D.active.fill===!1?P.active.fill=!1:typeof D.active.fill=="string"&&(P.active.fill=D.active.fill),D.active.stroke===!1?P.active.stroke=!1:typeof D.active.stroke=="string"&&(P.active.stroke=D.active.stroke),typeof D.active.lineWidth=="number"&&(P.active.lineWidth=D.active.lineWidth),typeof D.active.lineOpacity=="number"&&(P.active.lineOpacity=D.active.lineOpacity)),D.select===!1?P.select=Object.assign(P.select,{fill:!1,stroke:!1}):typeof D.select=="object"&&(D.select.fill===!1?P.select.fill=!1:typeof D.select.fill=="string"&&(P.select.fill=D.select.fill),D.select.stroke===!1?P.select.stroke=!1:typeof D.select.stroke=="string"&&(P.select.stroke=D.select.stroke),typeof D.select.lineWidth=="number"&&(P.select.lineWidth=D.select.lineWidth),typeof D.select.lineOpacity=="number"&&(P.select.lineOpacity=D.select.lineOpacity))),P};A.getDefaultState=L;function O(D,B,V,N,Y,H){var ce=H.color,at=H.style,rt=H.state,Re=(0,A.getDefaultState)(rt),vt={active:Re.active.fill===!1?!1:{color:Re.active.fill},select:!1},wt={opacity:at==null?void 0:at.opacity},fe=at==null?void 0:at.fillBottomColor,$e=at==null?void 0:at.lineWidth,re=at==null?void 0:at.stroke,Ge={opacity:at==null?void 0:at.lineOpacity,dashArray:at==null?void 0:at.lineDash,lineType:at==null?void 0:at.lineType};if(Z.MappingLayer.shape(D,"fill"),ce&&Z.MappingLayer.color(D,ce),wt&&Z.MappingLayer.style(D,wt),vt&&Z.MappingLayer.state(D,vt),fe&&D.setBottomColor(fe),Z.MappingLayer.shape(B,"line"),$e&&Z.MappingLayer.size(B,$e),re&&Z.MappingLayer.color(B,re),Ge&&Z.MappingLayer.style(B,Ge),Re.active.stroke){var Qe=Re.active.stroke,Te=Re.active.lineWidth||$e,Le={opacity:Re.active.lineOpacity};Z.MappingLayer.shape(V,"line"),Te&&Z.MappingLayer.size(V,Te),Qe&&Z.MappingLayer.color(V,Qe),Le&&Z.MappingLayer.style(V,Le)}if(Re.select.fill){var Ce=Re.select.fill;Z.MappingLayer.shape(N,"fill"),Ce&&Z.MappingLayer.color(N,Ce),wt&&Z.MappingLayer.style(N,wt),Z.MappingLayer.state(N,{select:!1,active:!1})}if(Re.select.stroke){var Fe=Re.select.stroke,Te=Re.select.lineWidth||$e,Ke={opacity:Re.select.lineOpacity};Z.MappingLayer.shape(Y,"line"),Te&&Z.MappingLayer.size(Y,Te),Fe&&Z.MappingLayer.color(Y,Fe),Ke&&Z.MappingLayer.style(Y,Ke)}}A.mappingLayer=O},79743:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.AreaLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(52133),O=y(88006),D={visible:!0,state:{active:!1,select:!1},enabledMultiSelect:!1},B=["color","style","state","enabledMultiSelect"],V=function(N){(0,v.__extends)(Y,N);function Y(H){var ce=N.call(this,H)||this;ce.selectData=[],ce.type=P.PlotLayer.LayerType.AreaLayer,ce.interaction=!0,ce.onHighlighHandle=function(Te){var Le=Te.feature,Ce=Te.featureId;ce.setHighlightLayerSource(Le,Ce)},ce.onUnhighlighHandle=function(){ce.setHighlightLayerSource()},ce.onSelectHandle=function(Te){var Le=ce.options.enabledMultiSelect,Ce=Te.feature,Fe=Te.featureId,Ke=(0,Z.clone)(ce.selectData),qt=Ke.findIndex(function(Pe){return Pe.featureId===Fe});if(qt===-1)Le?Ke.push({feature:Ce,featureId:Fe}):Ke=[{feature:Ce,featureId:Fe}],ce.emit("select",Ce,(0,Z.clone)(Ke));else{var ir=Ke[qt];Le?Ke.splice(qt,1):Ke=[],ce.emit("unselect",ir,(0,Z.clone)(Ke))}ce.setSelectLayerSource(Ke)};var at=ce.options,rt=at.name,Re=at.source,vt=at.visible,wt=at.minZoom,fe=at.maxZoom,$e=at.zIndex,re=$e===void 0?0:$e,Ge=ce.pickLayerConfig(ce.options),Qe=(0,L.getDefaultState)(ce.options.state);return ce.name=rt||(0,Z.uniqueId)(ce.type),ce.layer=new a.PolygonLayer((0,v.__assign)((0,v.__assign)({},Ge),{name:ce.name})),ce.strokeLayer=new a.LineLayer({name:"strokeLayer",visible:vt,zIndex:re,minZoom:wt,maxZoom:fe}),ce.highlightLayer=new a.LineLayer({name:"highlightLayer",visible:vt&&Boolean(Qe.active.stroke),zIndex:re+.1,minZoom:wt,maxZoom:fe}),ce.selectFillLayer=new a.PolygonLayer({name:"selectFillLayer",visible:vt&&Boolean(Qe.select.fill),zIndex:re+.1,minZoom:wt,maxZoom:fe}),ce.selectStrokeLayer=new a.LineLayer({name:"selectStrokeLayer",visible:vt&&Boolean(Qe.select.stroke),zIndex:re+.1,minZoom:wt,maxZoom:fe}),ce.mappingLayer(ce.options),ce.setSource(Re),ce.initEvent(),ce}return Y.prototype.getDefaultOptions=function(){return D},Y.prototype.mappingLayer=function(H){(0,L.mappingLayer)(this.layer,this.strokeLayer,this.highlightLayer,this.selectFillLayer,this.selectStrokeLayer,H)},Y.prototype.setSource=function(H){N.prototype.setSource.call(this,H),this.setStrokeLayerSource(),this.setHighlightLayerSource(),this.selectFillLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.selectStrokeLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}})},Y.prototype.setStrokeLayerSource=function(){var H=this.layer.getSource();if(H)this.strokeLayer.setSource(H);else{var ce=this.layer.sourceOption,at=ce.data,rt=ce.options;this.strokeLayer.source(at,rt)}},Y.prototype.setHighlightLayerSource=function(H,ce){if(ce===void 0&&(ce=-999),this.highlightLayerData!==ce){var at=H?[H]:[];this.highlightLayer.setData({type:"FeatureCollection",features:at},{parser:{type:"geojson"}}),this.highlightLayerData=ce}},Y.prototype.setSelectLayerSource=function(H){if(H===void 0&&(H=[]),!(this.selectData.length===H.length&&(0,Z.isEqual)(this.selectData.map(function(at){var rt=at.featureId;return rt}),H.map(function(at){var rt=at.featureId;return rt})))){var ce=H.map(function(at){var rt=at.feature;return rt});this.selectFillLayer.setData({type:"FeatureCollection",features:ce},{parser:{type:"geojson"}}),this.selectStrokeLayer.setData({type:"FeatureCollection",features:ce},{parser:{type:"geojson"}}),this.selectData=H}},Y.prototype.initEvent=function(){this.layer.off("mousemove",this.onHighlighHandle),this.layer.off("unmousemove",this.onHighlighHandle),this.layer.off("click",this.onSelectHandle),this.selectData=[],this.highlightLayerData=null,!!this.options.state&&(this.options.state.active&&(this.layer.on("mousemove",this.onHighlighHandle),this.layer.on("unmousemove",this.onUnhighlighHandle)),this.options.state.select&&this.layer.on("click",this.onSelectHandle))},Y.prototype.addTo=function(H){H.addLayer(this.layer),H.addLayer(this.strokeLayer),H.addLayer(this.highlightLayer),H.addLayer(this.selectFillLayer),H.addLayer(this.selectStrokeLayer)},Y.prototype.remove=function(H){H.removeLayer(this.layer),H.removeLayer(this.strokeLayer),H.removeLayer(this.highlightLayer),H.removeLayer(this.selectFillLayer),H.removeLayer(this.selectStrokeLayer)},Y.prototype.update=function(H){if(N.prototype.update.call(this,H),this.mappingLayer(this.options),this.options.visible){!(0,Z.isUndefined)(H.state)&&!(0,Z.isEqual)(this.lastOptions.state,this.options.state)&&this.updateHighlightLayer();var ce=(0,L.getDefaultState)(this.options.state);ce.active.stroke&&this.setHighlightLayerSource(),(ce.select.fill||ce.select.stroke)&&this.setSelectLayerSource()}this.initEvent()},Y.prototype.updateHighlightLayer=function(){var H=(0,L.getDefaultState)(this.options.state),ce=(0,L.getDefaultState)(this.lastOptions.state);ce.active.stroke!==H.active.stroke&&(H.active.stroke?this.highlightLayer.show():this.highlightLayer.hide()),ce.select.fill!==H.select.fill&&(H.select.fill?this.selectFillLayer.show():this.selectFillLayer.hide()),ce.select.stroke!==H.select.stroke&&(H.select.stroke?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())},Y.prototype.setIndex=function(H){this.layer.setIndex(H),this.strokeLayer.setIndex(H),this.highlightLayer.setIndex(H+.1),this.selectFillLayer.setIndex(H+.1),this.selectStrokeLayer.setIndex(H+.1)},Y.prototype.setMinZoom=function(H){this.layer.setMinZoom(H),this.strokeLayer.setMinZoom(H),this.highlightLayer.setMinZoom(H),this.selectFillLayer.setMinZoom(H),this.selectStrokeLayer.setMinZoom(H)},Y.prototype.setMaxZoom=function(H){this.layer.setMaxZoom(H),this.strokeLayer.setMaxZoom(H),this.highlightLayer.setMaxZoom(H),this.selectFillLayer.setMaxZoom(H),this.selectStrokeLayer.setMaxZoom(H)},Y.prototype.show=function(){!this.layer.inited||(this.layer.show(),this.strokeLayer.show(),this.selectFillLayer.show(),this.selectStrokeLayer.show())},Y.prototype.hide=function(){!this.layer.inited||(this.layer.hide(),this.strokeLayer.hide(),this.selectFillLayer.hide(),this.selectStrokeLayer.hide())},Y.prototype.getColorLegendItems=function(){var H=this.layer.getLegendItems("color");if(Array.isArray(H)&&H.length!==0){var ce=(0,O.getColorLegendItems)(H);return ce}return[]},Y.prototype.setActive=function(H){},Y.prototype.setSelect=function(H){},Y.DefaultOptions=D,Y.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(B),Y}(P.PlotLayer);A.AreaLayer=V},74939:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ColumnLayer=void 0;var v=y(70655),Z=y(57042),a=y(94340),P=function(L){(0,v.__extends)(O,L);function O(){var D=L!==null&&L.apply(this,arguments)||this;return D.type=a.DotLayer.LayerType.ColumnLayer,D}return O.prototype.getDefaultOptions=function(){return(0,Z.deepAssign)({},a.DotLayer.DefaultOptions,{shape:"cylinder"})},O}(a.DotLayer);A.ColumnLayer=P},49855:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DotDensityLayer=void 0;var v=y(70655),Z=y(57042),a=y(94340),P=["color","size","style","state","animate"],L=function(O){(0,v.__extends)(D,O);function D(){var B=O!==null&&O.apply(this,arguments)||this;return B.type=a.DotLayer.LayerType.DotDensity,B.interaction=!1,B}return D.prototype.getDefaultOptions=function(){return(0,Z.deepAssign)({},a.DotLayer.DefaultOptions,{shape:"dot",size:1})},D.LayerOptionsKeys=a.DotLayer.LayerConfigkeys.concat(P),D}(a.DotLayer);A.DotDensityLayer=L},22050:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=void 0;var v=y(27544);function Z(a,P){var L=P.shape,O=P.color,D=P.size,B=P.style,V=P.state,N=P.animate;L&&v.MappingLayer.shape(a,L),D&&v.MappingLayer.size(a,D),O&&v.MappingLayer.color(a,O),B&&v.MappingLayer.style(a,B),V&&v.MappingLayer.state(a,V),N&&v.MappingLayer.animate(a,N)}A.mappingLayer=Z},88006:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.getColorLegendItems=void 0;var v=y(70655),Z=y(57324),a=function(L){return!Array.isArray(L[0].value)},P=function(L){if(a(L))return L;var O=L.map(function(D){return(0,v.__assign)((0,v.__assign)({},D),{value:[(0,Z.round)(D.value[0],2),(0,Z.round)(D.value[1],2)]})});return O};A.getColorLegendItems=P},94340:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DotLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(22050),O=y(88006),D={source:{data:[],parser:{type:"json",x:"x",y:"y"}},shape:"circle",size:12,color:"#5FD3A6"},B=["shape","color","size","style","state","animate"],V=function(N){(0,v.__extends)(Y,N);function Y(H){var ce=N.call(this,H)||this;ce.type=P.PlotLayer.LayerType.DotLayer,ce.interaction=!0;var at=ce.options,rt=at.name,Re=at.source,vt=ce.pickLayerConfig(ce.options);return ce.name=rt||(0,Z.uniqueId)(ce.type),ce.layer=new a.PointLayer((0,v.__assign)((0,v.__assign)({},vt),{name:ce.name})),ce.mappingLayer(ce.layer,ce.options),ce.setSource(Re),ce}return Y.prototype.getDefaultOptions=function(){return D},Y.prototype.mappingLayer=function(H,ce){(0,L.mappingLayer)(H,ce)},Y.prototype.update=function(H){N.prototype.update.call(this,H),this.mappingLayer(this.layer,this.options)},Y.prototype.getColorLegendItems=function(){var H=this.layer.getLegendItems("color");if(Array.isArray(H)&&H.length!==0){var ce=(0,O.getColorLegendItems)(H);return ce}return[]},Y.DefaultOptions=D,Y.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(B),Y}(P.PlotLayer);A.DotLayer=V},39655:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=void 0;var v=y(27544);function Z(a,P){var L=P.shape,O=P.color,D=P.size,B=P.style,V=P.state;L&&v.MappingLayer.shape(a,L),D&&v.MappingLayer.size(a,D),O&&v.MappingLayer.color(a,O),B&&v.MappingLayer.style(a,B),V&&v.MappingLayer.state(a,V)}A.mappingLayer=Z},25140:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.GridLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(39655),O={source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"grid",field:"",radius:15e3,method:"sum"}},shape:"square",color:"#5FD3A6",style:{coverage:.9,angle:0,opacity:1}},D=["shape","color","size","style","state"],B=function(V){(0,v.__extends)(N,V);function N(Y){var H=V.call(this,Y)||this;H.type=P.PlotLayer.LayerType.GridLayer,H.interaction=!1;var ce=H.options,at=ce.name,rt=ce.source,Re=H.pickLayerConfig(H.options);return H.name=at||(0,Z.uniqueId)(H.type),H.layer=new a.HeatmapLayer((0,v.__assign)((0,v.__assign)({},Re),{name:H.name})),H.mappingLayer(H.layer,H.options),H.setSource(rt),H}return N.prototype.getDefaultOptions=function(){return O},N.prototype.mappingLayer=function(Y,H){(0,L.mappingLayer)(Y,H)},N.prototype.update=function(Y){V.prototype.update.call(this,Y),this.mappingLayer(this.layer,this.options)},N.DefaultOptions=O,N.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(D),N}(P.PlotLayer);A.GridLayer=B},79634:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=void 0;var v=y(27544);function Z(P){var L=P.colorsRamp,O={colors:[],positions:[]};return L.forEach(function(D){var B=D.color,V=D.position;O.colors.push(B),O.positions.push(V)}),O}function a(P,L){var O=L.shape,D=L.size,B=L.style,V=L.state;O&&v.MappingLayer.shape(P,O),D&&v.MappingLayer.size(P,D),B&&("colorsRamp"in B&&(B.rampColors=Z(B)),v.MappingLayer.style(P,B)),V&&v.MappingLayer.state(P,V)}A.mappingLayer=a},99177:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.HeatmapLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(79634),O={source:{data:[],parser:{type:"json",x:"x",y:"y"}},shape:"heatmap",size:{value:[0,1]},style:{intensity:3,radius:20,opacity:1,colorsRamp:[{color:"rgba(33,102,172,0.0)",position:0},{color:"rgb(103,169,207)",position:.2},{color:"rgb(209,229,240)",position:.4},{color:"rgb(253,219,199)",position:.6},{color:"rgb(239,138,98)",position:.8},{color:"rgb(178,24,43,1.0)",position:1}]}},D=["shape","color","size","style","state"],B=function(V){(0,v.__extends)(N,V);function N(Y){var H=V.call(this,Y)||this;H.type=P.PlotLayer.LayerType.HeatmapLayer,H.interaction=!1;var ce=H.options,at=ce.name,rt=ce.source,Re=H.pickLayerConfig(H.options);return H.name=at||(0,Z.uniqueId)(H.type),H.layer=new a.HeatmapLayer((0,v.__assign)((0,v.__assign)({},Re),{name:H.name})),H.mappingLayer(H.layer,H.options),H.setSource(rt),H}return N.prototype.getDefaultOptions=function(){return O},N.prototype.mappingLayer=function(Y,H){(0,L.mappingLayer)(Y,H)},N.prototype.update=function(Y){V.prototype.update.call(this,Y),this.mappingLayer(this.layer,this.options)},N.DefaultOptions=O,N.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(D),N}(P.PlotLayer);A.HeatmapLayer=B},460:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=void 0;var v=y(27544);function Z(a,P){var L=P.shape,O=P.color,D=P.size,B=P.style,V=P.state;L&&v.MappingLayer.shape(a,L),D&&v.MappingLayer.size(a,D),O&&v.MappingLayer.color(a,O),B&&v.MappingLayer.style(a,B),V&&v.MappingLayer.state(a,V)}A.mappingLayer=Z},89645:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.HexbinLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(460),O={source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"hexagon",field:"",radius:15e3,method:"sum"}},shape:"hexagon",color:"#5FD3A6",style:{coverage:.9,angle:0,opacity:1}},D=["shape","color","size","style","state"],B=function(V){(0,v.__extends)(N,V);function N(Y){var H=V.call(this,Y)||this;H.type=P.PlotLayer.LayerType.HexbinLayer,H.interaction=!1;var ce=H.options,at=ce.name,rt=ce.source,Re=H.pickLayerConfig(H.options);return H.name=at||(0,Z.uniqueId)(H.type),H.layer=new a.HeatmapLayer((0,v.__assign)((0,v.__assign)({},Re),{name:H.name})),H.mappingLayer(H.layer,H.options),H.setSource(rt),H}return N.prototype.getDefaultOptions=function(){return O},N.prototype.mappingLayer=function(Y,H){(0,L.mappingLayer)(Y,H)},N.prototype.update=function(Y){V.prototype.update.call(this,Y),this.mappingLayer(this.layer,this.options)},N.DefaultOptions=O,N.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(D),N}(P.PlotLayer);A.HexbinLayer=B},39276:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.IconLayer=void 0;var v=y(70655),Z=y(57042),a=y(94340),P=function(L){(0,v.__extends)(O,L);function O(){var D=L!==null&&L.apply(this,arguments)||this;return D.type=a.DotLayer.LayerType.IconLayer,D}return O.prototype.getDefaultOptions=function(){return(0,Z.deepAssign)({},a.DotLayer.DefaultOptions,{color:void 0})},O}(a.DotLayer);A.IconLayer=P},93627:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=void 0;var v=y(27544);function Z(a,P){var L=P.shape,O=P.color,D=P.size,B=P.style,V=P.state,N=P.animate,Y=P.texture;L&&v.MappingLayer.shape(a,L),D&&v.MappingLayer.size(a,D),O&&v.MappingLayer.color(a,O),B&&v.MappingLayer.style(a,B),V&&v.MappingLayer.state(a,V),N&&v.MappingLayer.animate(a,N),Y&&v.MappingLayer.texture(a,Y)}A.mappingLayer=Z},34213:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.LinesLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(93627),O=y(88006),D={},B=["shape","color","size","style","state","animate"],V=function(N){(0,v.__extends)(Y,N);function Y(H){var ce=N.call(this,H)||this;ce.type=P.PlotLayer.LayerType.LinesLayer,ce.interaction=!0;var at=ce.options,rt=at.name,Re=at.source,vt=ce.pickLayerConfig(ce.options);return ce.name=rt||(0,Z.uniqueId)(ce.type),ce.layer=new a.LineLayer((0,v.__assign)((0,v.__assign)({},vt),{name:ce.name})),ce.mappingLayer(ce.layer,ce.options),ce.setSource(Re),ce}return Y.prototype.getDefaultOptions=function(){return D},Y.prototype.mappingLayer=function(H,ce){(0,L.mappingLayer)(H,ce)},Y.prototype.update=function(H){N.prototype.update.call(this,H),this.mappingLayer(this.layer,this.options)},Y.prototype.getColorLegendItems=function(){var H=this.layer.getLegendItems("color");if(Array.isArray(H)&&H.length!==0){var ce=(0,O.getColorLegendItems)(H);return ce}return[]},Y.DefaultOptions=D,Y.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(B),Y}(P.PlotLayer);A.LinesLayer=V},84591:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.PathLayer=void 0;var v=y(70655),Z=y(57042),a=y(34213),P=["color","size","style","state","animate"],L=function(O){(0,v.__extends)(D,O);function D(){var B=O!==null&&O.apply(this,arguments)||this;return B.type=a.LinesLayer.LayerType.PathLayer,B}return D.prototype.getDefaultOptions=function(){return(0,Z.deepAssign)({},a.LinesLayer.DefaultOptions,{shape:"line"})},D.LayerOptionsKeys=a.LinesLayer.LayerConfigkeys.concat(P),D}(a.LinesLayer);A.PathLayer=L},19868:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=void 0;var v=y(27544);function Z(a,P){var L=P.color,O=P.size,D=P.style,B=P.state;v.MappingLayer.shape(a,"extrude"),O&&v.MappingLayer.size(a,O),L&&v.MappingLayer.color(a,L),D&&v.MappingLayer.style(a,D),B&&v.MappingLayer.state(a,B)}A.mappingLayer=Z},17937:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.PrismLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(19868),O=y(88006),D={},B=["color","size","style","state"],V=function(N){(0,v.__extends)(Y,N);function Y(H){var ce=N.call(this,H)||this;ce.type=P.PlotLayer.LayerType.PrismLayer,ce.interaction=!0;var at=ce.options,rt=at.name,Re=at.source,vt=ce.pickLayerConfig(ce.options);return ce.name=rt||(0,Z.uniqueId)(ce.type),ce.layer=new a.PolygonLayer((0,v.__assign)((0,v.__assign)({},vt),{name:ce.name})),ce.mappingLayer(ce.layer,ce.options),ce.setSource(Re),ce}return Y.prototype.getDefaultOptions=function(){return D},Y.prototype.mappingLayer=function(H,ce){(0,L.mappingLayer)(H,ce)},Y.prototype.update=function(H){N.prototype.update.call(this,H),this.mappingLayer(this.layer,this.options)},Y.prototype.getColorLegendItems=function(){var H=this.layer.getLegendItems("color");if(Array.isArray(H)&&H.length!==0){var ce=(0,O.getColorLegendItems)(H);return ce}return[]},Y.DefaultOptions=D,Y.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(B),Y}(P.PlotLayer);A.PrismLayer=V},57483:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.mappingLayer=void 0;var v=y(27544);function Z(a,P){var L=P.field,O=P.content,D=P.style,B=D===void 0?{}:D,V=P.state,N=B.fontSize,Y=B.fill,H=L||O||"",ce={field:H,value:"text"};v.MappingLayer.shape(a,ce),N&&v.MappingLayer.size(a,N),Y&&v.MappingLayer.color(a,Y),B&&v.MappingLayer.style(a,B),V&&v.MappingLayer.state(a,V)}A.mappingLayer=Z},71713:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.TextLayer=void 0;var v=y(70655),Z=y(49242),a=y(28675),P=y(19093),L=y(57483),O={style:{fontSize:12}},D=[],B=function(V){(0,v.__extends)(N,V);function N(Y){var H=V.call(this,Y)||this;H.type=P.PlotLayer.LayerType.TextLayer,H.interaction=!1;var ce=H.options,at=ce.name,rt=ce.source,Re=H.pickLayerConfig(H.options);return H.name=at||(0,Z.uniqueId)(H.type),H.layer=new a.PointLayer((0,v.__assign)((0,v.__assign)({},Re),{name:H.name})),H.mappingLayer(H.layer,H.options),H.setSource(rt),H}return N.prototype.getDefaultOptions=function(){return O},N.prototype.mappingLayer=function(Y,H){(0,L.mappingLayer)(Y,H)},N.prototype.update=function(Y){V.prototype.update.call(this,Y),this.mappingLayer(this.layer,this.options)},N.DefaultOptions=O,N.LayerOptionsKeys=P.PlotLayer.LayerConfigkeys.concat(D),N}(P.PlotLayer);A.TextLayer=B},46278:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.L7Plot=void 0;var v=y(70655),Z=y(49242),a=y(12392),P=y(57042),L=y(34525),O=y(20183),D={},B=function(V){(0,v.__extends)(N,V);function N(Y,H){var ce=V.call(this,H)||this;return ce.plots=[],ce.container=ce.createContainer(Y),ce.theme=ce.createTheme(),ce.scene=ce.createScene(),ce.registerResources(),ce.render(),ce.inited=!0,ce}return N.prototype.getDefaultOptions=function(){return(0,P.deepAssign)({},a.Map.DefaultOptions,N.DefaultOptions)},N.prototype.createLayers=function(){for(var Y=new L.LayerGroup([]),H=this.options.layers||[],ce=0;ce<H.length;ce++){var at=this.createLayer(H[ce]);Y.addLayer(at)}return Y},N.prototype.createLayer=function(Y){var H=Y.type,ce=(0,v.__rest)(Y,["type"]),at=O.LAYERS_MAP[H];if((0,Z.isUndefined)(at))throw new Error("Don't exist ".concat(H," layer"));var rt=new at(ce);return rt},N.prototype.addLayer=function(Y){var H=function(at){return typeof at.render=="function"};if(H(Y))V.prototype.addLayer.call(this,Y);else{var ce=this.createLayer(Y);V.prototype.addLayer.call(this,ce)}},N.prototype.removeLayerByName=function(Y){var H=this.layerGroup.getLayerByName(Y);return H?this.layerGroup.removeLayer(H):!1},N.prototype.updateLayers=function(Y){},N.prototype.updatePlots=function(Y){},N.prototype.render=function(){var Y=this,H=this.createLayers();this.inited?(this.layerGroup.removeAllLayer(),H.addTo(this.scene),this.layerGroup=H,this.updateControls()):(this.layerGroup=H,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){Y.onSceneLoaded()}))},N.prototype.onSceneLoaded=function(){var Y=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",function(){Y.onLayersLoaded()}),this.layerGroup.addTo(this.scene)},N.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.renderPlots(),this.initControls(),this.loaded=!0,this.emit("loaded")},N.prototype.renderPlots=function(){for(var Y=this.options.plots||[],H=0;H<Y.length;H++){var ce=Y[H],at=this.createPlot(ce);this.plots.push(at)}},N.prototype.createPlot=function(Y){var H=Y.type,ce=Y.legend,at=Y.layerMenu,rt=(0,v.__rest)(Y,["type","legend","layerMenu"]),Re=O.PLOTS_MAP[H];if((0,Z.isUndefined)(Re))throw new Error("Don't exist ".concat(H," plot"));var vt=new Re(rt);return vt.attachToScene(this.scene,this.theme),vt},N.prototype.addPlot=function(Y){var H=this.createPlot(Y);this.plots.push(H)},N.prototype.getPlots=function(){return this.plots},N.prototype.getPlotByName=function(Y){return this.plots.find(function(H){var ce;return((ce=H.options)===null||ce===void 0?void 0:ce.name)===Y})},N.prototype.removePlotByName=function(Y){var H=this.plots.findIndex(function(rt){var Re;return((Re=rt.options)===null||Re===void 0?void 0:Re.name)===Y});if(H===-1)return!1;var ce=(0,v.__read)(this.plots.splice(H,1),1),at=ce[0];return at.unattachFromScene(),!0},N.prototype.removeAllPlot=function(){this.plots.forEach(function(Y){Y.unattachFromScene()}),this.plots=[]},N.DefaultOptions=D,N}(a.Map);A.L7Plot=B},20183:function(Ft,A,y){"use strict";var v,Z;Object.defineProperty(A,"__esModule",{value:!0}),A.LAYERS_MAP=A.PLOTS_MAP=void 0;var a=y(75516),P=y(76347),L=y(43091),O=y(1403),D=y(83821),B=y(15266),V=y(13778),N=y(8623),Y=y(98994),H=y(87883),ce=y(71713),at=y(94340),rt=y(39276),Re=y(74939),vt=y(49855),wt=y(25140),fe=y(89645),$e=y(84591),re=y(11997),Ge=y(99177),Qe=y(79743),Te=y(17937);A.PLOTS_MAP=(v={},v[a.PlotType.Dot]=P.Dot,v[a.PlotType.DotDensity]=L.DotDensity,v[a.PlotType.Heatmap]=O.Heatmap,v[a.PlotType.Grid]=D.Grid,v[a.PlotType.Hexbin]=B.Hexbin,v[a.PlotType.Path]=V.Path,v[a.PlotType.Flow]=N.Flow,v[a.PlotType.Area]=Y.Area,v[a.PlotType.Choropleth]=H.Choropleth,v),A.LAYERS_MAP=(Z={},Z[a.LayerType.TextLayer]=ce.TextLayer,Z[a.LayerType.DotLayer]=at.DotLayer,Z[a.LayerType.IconLayer]=rt.IconLayer,Z[a.LayerType.DotDensity]=vt.DotDensityLayer,Z[a.LayerType.ColumnLayer]=Re.ColumnLayer,Z[a.LayerType.HeatmapLayer]=Ge.HeatmapLayer,Z[a.LayerType.GridLayer]=wt.GridLayer,Z[a.LayerType.HexbinLayer]=fe.HexbinLayer,Z[a.LayerType.PathLayer]=$e.PathLayer,Z[a.LayerType.ArcLayer]=re.ArcLayer,Z[a.LayerType.AreaLayer]=Qe.AreaLayer,Z[a.LayerType.PrismLayer]=Te.PrismLayer,Z)},57925:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}})},98994:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Area=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(57925),L=y(79743),O=y(34525),D=function(B){(0,v.__extends)(V,B);function V(){var N=B!==null&&B.apply(this,arguments)||this;return N.type=a.Plot.PlotType.Area,N}return V.prototype.getDefaultOptions=function(){return V.DefaultOptions},V.prototype.createLayers=function(N){this.areaLayer=new L.AreaLayer((0,v.__assign)({source:N},(0,Z.pick)(this.options,L.AreaLayer.LayerOptionsKeys)));var Y=new O.LayerGroup([this.areaLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(N,this.options.label,this.options),Y.addLayer(this.labelLayer)),Y},V.prototype.updateLayers=function(N){var Y=(0,Z.pick)(N,L.AreaLayer.LayerOptionsKeys);this.areaLayer.update(Y),this.updateLabelLayer(this.source,N.label,this.options,this.labelLayer)},V.prototype.initLayersEvent=function(){},V.prototype.getLegendOptions=function(){var N=this.areaLayer.getColorLegendItems();return N.length!==0?{type:"category",items:N}:{}},V.DefaultOptions=P.DEFAULT_OPTIONS,V}(a.Plot);A.Area=D},30201:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.unregisterCacheArea=A.hasCacheArea=A.getCacheArea=A.registerCacheAreas=A.registerCacheArea=A.AREA_CACHE=void 0,A.AREA_CACHE=new Map;function y(L,O){A.AREA_CACHE.set(L,O)}A.registerCacheArea=y;function v(L){L.forEach(function(O){A.AREA_CACHE.set(O.key,O.area)})}A.registerCacheAreas=v;function Z(L){return A.AREA_CACHE.get(L)}A.getCacheArea=Z;function a(L){return A.AREA_CACHE.has(L)}A.hasCacheArea=a;function P(L){return A.AREA_CACHE.delete(L)}A.unregisterCacheArea=P},89102:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.CHINA_BOUNDARY_STYLE=A.GEO_AREA_URL=A.GEO_DATA_URL=A.DEFAULT_AREA_GRANULARITY=A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:[],joinBy:{geoField:"adcode"}},viewLevel:{level:"country",adcode:"100000"},chinaBorder:!0}),A.DEFAULT_AREA_GRANULARITY={world:"country",country:"province",province:"city",city:"district",district:"district"},A.GEO_DATA_URL="https://gw.alipayobjects.com/os/alisis/geo-data-v0.1.2",A.GEO_AREA_URL="".concat(A.GEO_DATA_URL,"/choropleth-data"),A.CHINA_BOUNDARY_STYLE={national:{color:"red",width:1,opacity:1},dispute:{color:"red",width:1,opacity:.8,dashArray:[1,6]},coast:{color:"blue",width:.7,opacity:.8},hkm:{color:"gray",width:.7,opacity:.8}}},14207:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.getDrillStepDefaultConfig=A.isEqualDrillSteps=A.topojson2geojson=A.getGeoAreaConfig=void 0;var v=y(70655),Z=y(49242),a=(0,v.__importStar)(y(18146)),P=y(89102),L=function(V){var N={url:P.GEO_AREA_URL,type:"topojson",extension:"topo.json"};return(0,Z.isUndefined)(V)||(typeof V=="string"?N.url=V:(N.url=(V==null?void 0:V.url)||P.GEO_AREA_URL,N.type=V.type,N.extension=V.type==="topojson"?"topo.json":"json")),N};A.getGeoAreaConfig=L;var O=function(V){try{var N=a.feature(V,"json");return N}catch(Y){throw new Error('Failed convert to geojson from topojson, topojson default layer name "json"')}};A.topojson2geojson=O;var D=function(V,N){if(V.length!==N.length)return!1;for(var Y=0;Y<V.length;Y++){var H=V[Y],ce=H.level,at=H.granularity;if(N[Y].level!==ce||N[Y].granularity!==at)return!1}return!0};A.isEqualDrillSteps=D;var B=function(V){var N=(0,Z.pick)(V,["source","color","style","state","label","tooltip"]);return N};A.getDrillStepDefaultConfig=B},87883:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Choropleth=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(57042),L=y(89102),O=y(79743),D=y(71713),B=y(75516),V=y(34525),N=y(87405),Y=y(30201),H=y(14207),ce=function(at){(0,v.__extends)(rt,at);function rt(){var Re=at!==null&&at.apply(this,arguments)||this;return Re.type=a.Plot.PlotType.Choropleth,Re.chinaBoundaryData={type:"FeatureCollection",features:[]},Re.currentDistrictData={type:"FeatureCollection",features:[]},Re.drillSteps=[],Re.drillStacks=[],Re.onDrillDownHander=function(vt){var wt,fe=Re.options.drill,$e=fe.steps,re=fe.onDown,Ge=(wt=vt.feature)===null||wt===void 0?void 0:wt.properties,Qe=Ge.adcode;if(Re.drillStacks.length!==$e.length+1){var Te=Re.drillStacks.slice(-1)[0],Le=Re.drillStacks.length-1,Ce=Re.drillSteps[Le],Fe=Ce.level,Ke=Ce.granularity,qt=Ke===void 0?L.DEFAULT_AREA_GRANULARITY[Fe]:Ke,ir=(0,v.__rest)(Ce,["level","granularity"]),Pe={from:{level:Te.level,adcode:Te.adcode,granularity:Te.granularity},to:{level:Fe,adcode:Qe,granularity:qt,properties:Ge}},Ne=function(Xe){Xe===void 0&&(Xe={});var kt={level:Fe,adcode:Qe,granularity:qt},rr=(0,P.deepAssign)({},ir,Xe);Re.changeView(kt,rr).then(function(me){me&&(Re.drillStacks.push(me),Re.emit("drilldown",Pe))})};re?re(Pe.from,Pe.to,Ne):Ne()}},Re.onDrillUpHander=function(){var vt=Re.options.drill.onUp,wt=Re.drillStacks.length===0||Re.drillStacks.length===1;if(!wt){var fe=Re.drillStacks.length-1,$e=Re.drillStacks[fe],re=Re.drillStacks[fe-1],Ge={from:{level:$e.level,adcode:$e.adcode,granularity:$e.granularity},to:{level:re.level,adcode:re.adcode,granularity:re.granularity}},Qe=function(Te){Te===void 0&&(Te={});var Le=Ge.to,Ce=(0,P.deepAssign)({},re.config,Te);Re.changeView(Le,Ce).then(function(Fe){Fe&&(Re.drillStacks.pop(),Re.emit("drillup",Ge))})};vt?vt(Ge.from,Ge.to,Qe):Qe()}},Re}return rt.prototype.initSource=function(){var Re=this;this.getInitDistrictData().then(function(){Re.source=Re.createSource(),Re.render(),Re.inited=!0})},rt.prototype.render=function(){var Re=this;if(console.time("l7plot choropleth render time"),this.inited)this.scene.setEnableRender(!0),this.scene.render();else{var vt=this.createLayers(this.source);this.layerGroup=vt,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){Re.onSceneLoaded()}),this.initLayersEvent()}console.timeEnd("l7plot choropleth render time")},rt.prototype.update=function(Re){var vt=this,wt,fe,$e;if(this.updateOption(Re),Re.map&&!(0,Z.isEqual)(this.lastOptions.map,this.options.map)&&this.updateMap(Re.map),Re.drill&&Re.drill.enabled!==!1&&!(0,Z.isEqual)((wt=this.lastOptions.drill)===null||wt===void 0?void 0:wt.steps,(fe=this.options.drill)===null||fe===void 0?void 0:fe.steps)&&(this.drillReset(),this.initDrillEvent()),this.scene.setEnableRender(!1),Re.viewLevel&&!(0,Z.isEqual)(this.lastOptions.viewLevel,this.options.viewLevel)){var re=($e=Re.source)===null||$e===void 0?void 0:$e.joinBy.geoData;console.time("l7plot choropleth update viewLevel time"),this.getDistrictData(re).then(function(){var Le=vt.options.source,Ce=Le.data,Fe=(0,v.__rest)(Le,["data"]);vt.changeData(Ce,Fe),vt.updateLayers(Re),vt.render(),vt.updateComponents(),console.timeEnd("l7plot choropleth update viewLevel time"),vt.emit("update")})}else{if(Re.source&&!(0,Z.isEqual)(this.lastOptions.source,this.options.source)){var Ge=this.options.source,Qe=Ge.data,Te=(0,v.__rest)(Ge,["data"]);this.changeData(Qe,Te)}this.updateLayers(Re),this.render(),this.updateComponents(),this.emit("update")}},rt.prototype.getDefaultOptions=function(){return rt.DefaultOptions},rt.prototype.parserSourceConfig=function(Re){var vt=Re.data,wt=Re.joinBy,fe=(0,v.__rest)(Re,["data","joinBy"]),$e=wt.sourceField,re=wt.geoField,Ge=wt.geoData,Qe=Ge,Te={type:"join",sourceField:$e,targetField:re,data:vt};return fe.transforms?fe.transforms.push(Te):fe.transforms=[Te],fe.parser&&delete fe.parser,{data:Qe,sourceCFG:fe}},rt.prototype.createSource=function(){var Re=this.parserSourceConfig(this.options.source),vt=Re.data,wt=Re.sourceCFG,fe=new B.Source(vt,wt);return fe},rt.prototype.changeData=function(Re,vt){var wt=this;console.time("l7plot choropleth update data time"),this.options.source=(0,P.deepAssign)({},this.options.source,(0,v.__assign)({data:Re},vt));var fe=this.parserSourceConfig(this.options.source),$e=fe.data,re=fe.sourceCFG;this.source.setData($e,re),console.timeEnd("l7plot choropleth update data time");var Ge=this.options.legend;Ge&&setTimeout(function(){wt.updateLegendControl(Ge)}),this.emit("change-data")},rt.prototype.createLayers=function(Re){this.fillAreaLayer=new O.AreaLayer((0,v.__assign)({name:"fillAreaLayer",source:Re},(0,Z.pick)(this.options,O.AreaLayer.LayerOptionsKeys)));var vt=new V.LayerGroup([this.fillAreaLayer]);if(this.options.chinaBorder){var wt=this.createCountryBoundaryLayer(this.chinaBoundaryData,this.options),fe=wt.chinaBoundaryLayer,$e=wt.chinaDisputeBoundaryLayer;this.chinaBoundaryLayer=fe,this.chinaDisputeBoundaryLayer=$e,vt.addLayer(this.chinaBoundaryLayer),vt.addLayer(this.chinaDisputeBoundaryLayer)}return this.options.label&&(this.labelLayer=this.createLabelLayer(Re,this.options.label),vt.addLayer(this.labelLayer)),vt},rt.prototype.createCountryBoundaryLayer=function(Re,vt){var wt=(0,N.createCountryBoundaryLayer)(Re,vt),fe=wt.chinaBoundaryLayer,$e=wt.chinaDisputeBoundaryLayer;return{chinaBoundaryLayer:fe,chinaDisputeBoundaryLayer:$e}},rt.prototype.createLabelLayer=function(Re,vt){var wt=this,fe=Re.originData.features.map(function(Ke){var qt=Ke.properties;return Object.assign({},qt,{centroid:qt.centroid||qt.center})}).filter(function(Ke){var qt=Ke.centroid;return qt}),$e=this.options,re=$e.visible,Ge=$e.minZoom,Qe=$e.maxZoom,Te=$e.zIndex,Le=Te===void 0?0:Te,Ce=new D.TextLayer((0,v.__assign)({name:"labelLayer",source:{data:fe,parser:{type:"json",coordinates:"centroid"},transforms:Re.transforms},visible:re,minZoom:Ge,maxZoom:Qe,zIndex:Le+.1},vt)),Fe=function(){var Ke=wt.source.originData.features.map(function(qt){var ir=qt.properties;return ir}).filter(function(qt){var ir=qt.centroid;return ir});Ce.layer.setData(Ke)};return Re.on("update",Fe),Ce.on("remove",function(){Re.off("update",Fe)}),Ce},rt.prototype.updateLayers=function(Re){var vt=this,wt=(0,Z.pick)(Re,O.AreaLayer.LayerOptionsKeys);this.fillAreaLayer.update(wt);var fe=function(){var re=vt.createCountryBoundaryLayer(vt.chinaBoundaryData,vt.options),Ge=re.chinaBoundaryLayer,Qe=re.chinaDisputeBoundaryLayer;vt.chinaBoundaryLayer=Ge,vt.chinaDisputeBoundaryLayer=Qe,vt.layerGroup.addLayer(vt.chinaBoundaryLayer),vt.layerGroup.addLayer(vt.chinaDisputeBoundaryLayer)},$e=function(){vt.chinaBoundaryLayer&&vt.layerGroup.removeLayer(vt.chinaBoundaryLayer),vt.chinaDisputeBoundaryLayer&&vt.layerGroup.removeLayer(vt.chinaDisputeBoundaryLayer)};Re.chinaBorder?(this.chinaBoundaryLayer&&$e(),fe()):Re.chinaBorder===!1&&$e(),this.updateLabelLayer(this.source,Re.label,this.options,this.labelLayer)},rt.prototype.initLayersEvent=function(){this.initDrillEvent()},rt.prototype.initDrillEvent=function(){if(this.lastOptions.drill){var Re=this.lastOptions.drill,vt=Re.triggerUp,wt=vt===void 0?"unclick":vt,fe=Re.triggerDown,$e=fe===void 0?"click":fe;this.fillAreaLayer.off(wt,this.onDrillUpHander),this.fillAreaLayer.off($e,this.onDrillDownHander)}if(!(!this.options.drill||this.options.drill.enabled===!1)){var re=this.options.drill,Ge=re.steps,Qe=re.triggerUp,Te=Qe===void 0?"unclick":Qe,Le=re.triggerDown,Ce=Le===void 0?"click":Le,Fe=Ge.map(function(kt){return typeof kt=="string"?{level:kt,granularity:L.DEFAULT_AREA_GRANULARITY[kt]}:(kt.granularity||(kt.granularity=L.DEFAULT_AREA_GRANULARITY[kt.level]),kt)});if((0,H.isEqualDrillSteps)(Fe,this.drillSteps)||(this.drillSteps=Fe,this.drillStacks=[]),!this.drillStacks.length){var Ke=this.options.viewLevel,qt=Ke.level,ir=Ke.adcode,Pe=Ke.granularity,Ne=Pe===void 0?L.DEFAULT_AREA_GRANULARITY[qt]:Pe,Xe=(0,H.getDrillStepDefaultConfig)(this.options);this.drillStacks=[{level:qt,adcode:ir,granularity:Ne,config:Xe}]}this.fillAreaLayer.on(Te,this.onDrillUpHander),this.fillAreaLayer.on(Ce,this.onDrillDownHander)}},rt.prototype.drillReset=function(){this.drillStacks=[]},rt.prototype.getCurrentDrillSteps=function(){var Re=this.drillStacks.map(function(vt){return(0,Z.pick)(vt,["level","adcode","granularity"])});return Re},rt.prototype.getLegendOptions=function(){var Re=this.fillAreaLayer.getColorLegendItems();return Re.length!==0?{type:"category",items:Re}:{}},rt.prototype.fetchData=function(Re,vt,wt){return(0,v.__awaiter)(this,void 0,void 0,function(){var fe,$e,re,Ge,Qe,Te,Le,Ce;return(0,v.__generator)(this,function(Fe){switch(Fe.label){case 0:return fe="".concat(vt,"_").concat(Re,"_").concat(wt),$e=(0,Y.getCacheArea)(fe),$e?[2,$e]:(re=(0,H.getGeoAreaConfig)(this.options.geoArea),Ge=re.url,Qe=re.type,Te=re.extension,[4,fetch("".concat(Ge,"/").concat(Re,"/").concat(fe,".").concat(Te))]);case 1:return Le=Fe.sent(),[4,Le.json()];case 2:return Ce=Fe.sent(),Qe==="topojson"&&(Ce=(0,H.topojson2geojson)(Ce)),(0,Y.registerCacheArea)(fe,Ce),[2,Ce]}})})},rt.prototype.getInitDistrictData=function(){var Re;return(0,v.__awaiter)(this,void 0,void 0,function(){var vt,wt,fe,$e;return(0,v.__generator)(this,function(re){switch(re.label){case 0:vt=this.fetchData("country","100000","boundary"),wt=(Re=this.options.source)===null||Re===void 0?void 0:Re.joinBy.geoData,re.label=1;case 1:return re.trys.push([1,3,,4]),[4,Promise.all([vt,this.getDistrictData(wt)])];case 2:return $e=v.__read.apply(void 0,[re.sent(),1]),this.chinaBoundaryData=$e[0],[3,4];case 3:throw fe=re.sent(),new Error("Failed to get china boundary data\uFF0C".concat(fe));case 4:return[2]}})})},rt.prototype.getDistrictData=function(Re){return(0,v.__awaiter)(this,void 0,void 0,function(){var vt,wt,fe,$e,re,Ge,Qe,Te;return(0,v.__generator)(this,function(Le){switch(Le.label){case 0:vt=this.options.viewLevel,wt=vt.level,fe=vt.adcode,$e=vt.granularity,re=$e===void 0?L.DEFAULT_AREA_GRANULARITY[wt]:$e,Ge=Re?Promise.resolve(Re):this.fetchData(wt,fe,re),Le.label=1;case 1:return Le.trys.push([1,3,,4]),Qe=this,[4,Ge];case 2:return Qe.currentDistrictData=Le.sent(),this.options.source=(0,P.deepAssign)({},this.options.source,{joinBy:{geoData:this.currentDistrictData}}),[3,4];case 3:throw Te=Le.sent(),new Error("Failed to get district data\uFF0C".concat(Te));case 4:return[2]}})})},rt.prototype.drillDown=function(Re,vt){var wt=this;vt===void 0&&(vt={}),this.changeView(Re,vt).then(function(fe){fe&&wt.drillStacks.push(fe)})},rt.prototype.drillUp=function(Re,vt){Re===void 0&&(Re={});var wt=this.drillStacks.length,fe=[0,1].includes(wt);if(!fe){var $e=vt?this.drillStacks.findIndex(function(Fe){return Fe.level===vt}):-1,re=$e!==-1,Ge=re?$e:wt-2,Qe=this.drillStacks[Ge],Te=Qe.config,Le=(0,v.__rest)(Qe,["config"]),Ce=(0,P.deepAssign)({},Te,Re);this.changeView(Le,Ce),re?this.drillStacks.splice($e+1):this.drillStacks.pop()}},rt.prototype.changeView=function(Re,vt){return vt===void 0&&(vt={}),(0,v.__awaiter)(this,void 0,void 0,function(){var wt,fe,$e,re,Ge,Qe,Te;return(0,v.__generator)(this,function(Le){switch(Le.label){case 0:return wt=Re.level,fe=Re.adcode,$e=Re.granularity,re=$e===void 0?L.DEFAULT_AREA_GRANULARITY[wt]:$e,[4,this.fetchData(wt,fe,re)];case 1:return Ge=Le.sent(),Ge.features.length?(Qe=(0,P.deepAssign)({},(0,H.getDrillStepDefaultConfig)(this.options),vt,{viewLevel:{level:wt,adcode:fe,granularity:re},source:{joinBy:{geoData:Ge}}}),this.update(Qe),Te={level:wt,adcode:fe,granularity:re,config:Qe},[2,Te]):[2]}})})},rt.DefaultOptions=L.DEFAULT_OPTIONS,rt.GeoDataUrl=L.GEO_DATA_URL,rt.GeoAreaUrl=L.GEO_AREA_URL,rt}(a.Plot);A.Choropleth=ce},87405:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.createCountryBoundaryLayer=void 0;var v=y(57042),Z=y(84591),a=y(89102),P=function(L,O){var D=O||{},B=D.visible,V=D.minZoom,N=D.maxZoom,Y=D.zIndex,H=Y===void 0?0:Y,ce=D.chinaBorder,at=typeof ce=="object"?(0,v.deepAssign)({},a.CHINA_BOUNDARY_STYLE,ce):a.CHINA_BOUNDARY_STYLE,rt=L.features.filter(function(fe){var $e=fe.properties;return["coast","hkm","national"].includes($e==null?void 0:$e.type)}),Re=L.features.filter(function(fe){var $e=fe.properties;return($e==null?void 0:$e.type)==="dispute"}),vt=new Z.PathLayer({name:"chinaBoundaryLayer",visible:B,minZoom:V,maxZoom:N,zIndex:H+.1,source:{data:{type:"FeatureCollection",features:rt},parser:{type:"geojson"}},color:{field:"type",value:function(fe){var $e=fe.type;return at[$e].color}},size:{field:"type",value:function(fe){var $e=fe.type;return at[$e].width}},style:{opacity:["type",function(fe){return at[fe].opacity}]}}),wt=new Z.PathLayer({name:"chinaDisputeBoundaryLayer",visible:B,minZoom:V,maxZoom:N,zIndex:H+.1,source:{data:{type:"FeatureCollection",features:Re},parser:{type:"geojson"}},color:at.dispute.color,size:at.dispute.width,style:{opacity:at.dispute.opacity,lineType:"dash",dashArray:at.dispute.dashArray}});return{chinaBoundaryLayer:vt,chinaDisputeBoundaryLayer:wt}};A.createCountryBoundaryLayer=P},86514:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}})},43091:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DotDensity=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(86514),L=y(34525),O=y(49855),D=function(B){(0,v.__extends)(V,B);function V(){var N=B!==null&&B.apply(this,arguments)||this;return N.type=a.Plot.PlotType.DotDensity,N}return V.prototype.getDefaultOptions=function(){return V.DefaultOptions},V.prototype.createLayers=function(N){this.dotDensityLayer=new O.DotDensityLayer((0,v.__assign)({source:N},(0,Z.pick)(this.options,O.DotDensityLayer.LayerOptionsKeys)));var Y=new L.LayerGroup([this.dotDensityLayer]);return Y},V.prototype.updateLayers=function(N){var Y=(0,Z.pick)(N,O.DotDensityLayer.LayerOptionsKeys);this.dotDensityLayer.update(Y)},V.DefaultOptions=P.DEFAULT_OPTIONS,V}(a.Plot);A.DotDensity=D},98486:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}})},76347:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Dot=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(98486),L=y(94340),O=y(34525),D=function(B){(0,v.__extends)(V,B);function V(){var N=B!==null&&B.apply(this,arguments)||this;return N.type=a.Plot.PlotType.Dot,N}return V.prototype.getDefaultOptions=function(){return V.DefaultOptions},V.prototype.createLayers=function(N){this.dotLayer=new L.DotLayer((0,v.__assign)({source:N},(0,Z.pick)(this.options,L.DotLayer.LayerOptionsKeys)));var Y=new O.LayerGroup([this.dotLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(N,this.options.label,this.options),Y.addLayer(this.labelLayer)),Y},V.prototype.updateLayers=function(N){var Y=(0,Z.pick)(N,L.DotLayer.LayerOptionsKeys);this.dotLayer.update(Y),this.updateLabelLayer(this.source,N.label,this.options,this.labelLayer)},V.prototype.getLegendOptions=function(){var N=this.dotLayer.getColorLegendItems();return N.length!==0?{type:"category",items:N}:{}},V.DefaultOptions=P.DEFAULT_OPTIONS,V}(a.Plot);A.Dot=D},53556:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:[],parser:{type:"json"}},shape:"arc"})},8623:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Flow=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(53556),L=y(11997),O=y(94340),D=y(71713),B=y(34525),V=function(N){(0,v.__extends)(Y,N);function Y(){var H=N!==null&&N.apply(this,arguments)||this;return H.type=a.Plot.PlotType.Flow,H}return Y.prototype.getDefaultOptions=function(){return Y.DefaultOptions},Y.prototype.createLayers=function(H){this.flowLayer=new L.ArcLayer((0,v.__assign)({name:"flowLayer",source:H},(0,Z.pick)(this.options,L.ArcLayer.LayerOptionsKeys)));var ce=new B.LayerGroup([this.flowLayer]);return this.options.radiation&&(this.radiationLayer=this.createRadiationLayer(H),ce.addLayer(this.radiationLayer)),this.options.label&&(this.labelLayer=this.createLabelLayer(H,this.options.label),ce.addLayer(this.labelLayer)),ce},Y.prototype.parserPointData=function(H){var ce=[];return H.data.dataArray.forEach(function(at){var rt=at.coordinates,Re=(0,v.__read)(rt,2),vt=Re[1];ce.push((0,v.__assign)((0,v.__assign)({},at),{coordinates:vt}))}),ce},Y.prototype.createRadiationLayer=function(H){var ce=this,at=this.parserPointData(H),rt=this.options.radiation||{},Re=rt.enabled,vt=Re===void 0?!0:Re,wt=rt.color,fe=rt.size,$e=fe===void 0?20:fe,re=rt.shape,Ge=re===void 0?"circle":re,Qe=rt.animate,Te=Qe===void 0?!0:Qe,Le=new O.DotLayer({name:"radiationLayer",source:{data:at,parser:{type:"json",coordinates:"coordinates"}},visible:vt,color:wt,size:$e,shape:Ge,animate:Te}),Ce=function(){var Fe=ce.parserPointData(ce.source);Le.layer.setData(Fe)};return H.on("update",Ce),Le.on("remove",function(){H.off("update",Ce)}),Le},Y.prototype.createLabelLayer=function(H,ce){var at=this,rt=this.parserPointData(H),Re=this.options,vt=Re.visible,wt=Re.minZoom,fe=Re.maxZoom,$e=Re.zIndex,re=$e===void 0?0:$e,Ge=new D.TextLayer((0,v.__assign)({name:"labelLayer",source:{data:rt,parser:{type:"json",coordinates:"coordinates"}},visible:vt,minZoom:wt,maxZoom:fe,zIndex:re+.1},ce)),Qe=function(){var Te=at.parserPointData(at.source);Ge.layer.setData(Te)};return H.on("update",Qe),Ge.on("remove",function(){H.off("update",Qe)}),Ge},Y.prototype.updateLayers=function(H){var ce=(0,Z.pick)(H,L.ArcLayer.LayerOptionsKeys);if(this.flowLayer.update(ce),H.radiation)if(this.radiationLayer){var at=(0,v.__assign)((0,v.__assign)({},H.radiation),{visible:H.radiation.enabled});this.radiationLayer.update(at)}else this.radiationLayer=this.createRadiationLayer(this.source),this.layerGroup.addLayer(this.radiationLayer);this.updateLabelLayer(this.source,H.label,this.options,this.labelLayer)},Y.prototype.getLegendOptions=function(){var H=this.flowLayer.getColorLegendItems();return H.length!==0?{type:"category",items:H}:{}},Y.DefaultOptions=P.DEFAULT_OPTIONS,Y}(a.Plot);A.Flow=V},62120:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"grid",radius:15e3,method:"sum"}}})},83821:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Grid=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(62120),L=y(25140),O=y(34525),D=function(B){(0,v.__extends)(V,B);function V(){var N=B!==null&&B.apply(this,arguments)||this;return N.type=a.Plot.PlotType.Grid,N}return V.prototype.getDefaultOptions=function(){return V.DefaultOptions},V.prototype.createLayers=function(N){this.gridLayer=new L.GridLayer((0,v.__assign)({source:N},(0,Z.pick)(this.options,L.GridLayer.LayerOptionsKeys)));var Y=new O.LayerGroup([this.gridLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),Y.addLayer(this.labelLayer)),Y},V.prototype.updateLayers=function(N){var Y=(0,Z.pick)(N,L.GridLayer.LayerOptionsKeys);this.gridLayer.update(Y),this.updateLabelLayer(this.source,N.label,this.options,this.labelLayer)},V.DefaultOptions=P.DEFAULT_OPTIONS,V}(a.Plot);A.Grid=D},79455:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}})},1403:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Heatmap=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(79455),L=y(99177),O=y(34525),D=function(B){(0,v.__extends)(V,B);function V(){var N=B!==null&&B.apply(this,arguments)||this;return N.type=a.Plot.PlotType.Heatmap,N}return V.prototype.getDefaultOptions=function(){return V.DefaultOptions},V.prototype.createLayers=function(N){this.heatmapLayer=new L.HeatmapLayer((0,v.__assign)({source:N},(0,Z.pick)(this.options,L.HeatmapLayer.LayerOptionsKeys)));var Y=new O.LayerGroup([this.heatmapLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),Y.addLayer(this.labelLayer)),Y},V.prototype.updateLayers=function(N){var Y=(0,Z.pick)(N,L.HeatmapLayer.LayerOptionsKeys);this.heatmapLayer.update(Y),this.updateLabelLayer(this.source,N.label,this.options,this.labelLayer)},V.prototype.getLegendOptions=function(){var N,Y=this.heatmapLayer.layer.getLegendItems("size");if(Array.isArray(Y)&&Y.length!==0){var H=Y[0].value,ce=Y[Y.length-1].value,at=(N=this.heatmapLayer.options.style)===null||N===void 0?void 0:N.colorsRamp.map(function(rt){var Re=rt.color;return Re});return{type:"continue",min:H,max:ce,colors:at}}return{}},V.DefaultOptions=P.DEFAULT_OPTIONS,V}(a.Plot);A.Heatmap=D},1625:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"hexagon",radius:15e3,method:"sum"}}})},15266:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Hexbin=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(1625),L=y(89645),O=y(34525),D=function(B){(0,v.__extends)(V,B);function V(){var N=B!==null&&B.apply(this,arguments)||this;return N.type=a.Plot.PlotType.Hexbin,N}return V.prototype.getDefaultOptions=function(){return V.DefaultOptions},V.prototype.createLayers=function(N){this.hexbinLayer=new L.HexbinLayer((0,v.__assign)({source:N},(0,Z.pick)(this.options,L.HexbinLayer.LayerOptionsKeys)));var Y=new O.LayerGroup([this.hexbinLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),Y.addLayer(this.labelLayer)),Y},V.prototype.updateLayers=function(N){var Y=(0,Z.pick)(N,L.HexbinLayer.LayerOptionsKeys);this.hexbinLayer.update(Y),this.updateLabelLayer(this.source,N.label,this.options,this.labelLayer)},V.DefaultOptions=P.DEFAULT_OPTIONS,V}(a.Plot);A.Hexbin=D},8153:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.DEFAULT_OPTIONS=void 0;var v=y(3071),Z=y(57042);A.DEFAULT_OPTIONS=(0,Z.deepAssign)({},v.Plot.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}})},13778:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Path=void 0;var v=y(70655),Z=y(49242),a=y(3071),P=y(8153),L=y(84591),O=y(34525),D=function(B){(0,v.__extends)(V,B);function V(){var N=B!==null&&B.apply(this,arguments)||this;return N.type=a.Plot.PlotType.Path,N}return V.prototype.getDefaultOptions=function(){return V.DefaultOptions},V.prototype.createLayers=function(N){this.pathLayer=new L.PathLayer((0,v.__assign)({source:N},(0,Z.pick)(this.options,L.PathLayer.LayerOptionsKeys)));var Y=new O.LayerGroup([this.pathLayer]);return Y},V.prototype.updateLayers=function(N){var Y=(0,Z.pick)(N,L.PathLayer.LayerOptionsKeys);this.pathLayer.update(Y)},V.prototype.getLegendOptions=function(){var N=this.pathLayer.getColorLegendItems();return N.length!==0?{type:"category",items:N}:{}},V.DefaultOptions=P.DEFAULT_OPTIONS,V}(a.Plot);A.Path=D},23316:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.registerTheme=A.getTheme=void 0;var v=y(49242),Z=y(4548),a=(0,Z.createTheme)({}),P=(0,Z.createDarkTheme)({}),L={default:a,light:a,dark:P};function O(B){return B===void 0&&(B="default"),(0,v.get)(L,(0,v.lowerCase)(B),L.default)}A.getTheme=O;function D(B,V,N){N===void 0&&(N="light"),L[(0,v.lowerCase)(B)]=N==="light"?(0,Z.createTheme)(V):(0,Z.createDarkTheme)(V)}A.registerTheme=D},51070:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.dark=A.createDarkStyleSheet=void 0;var y={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},v={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Z=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],a=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],P=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],L=function(O){O===void 0&&(O={});var D=O.mapStyle,B=D===void 0?"dark":D,V=O.subColor,N=V===void 0?"rgba(255,255,255,0.05)":V,Y=O.paletteQualitative10,H=Y===void 0?Z:Y,ce=O.paletteQualitative20,at=ce===void 0?a:ce,rt=O.paletteSemanticRed,Re=rt===void 0?"#F4664A":rt,vt=O.paletteSemanticGreen,wt=vt===void 0?"#30BF78":vt,fe=O.paletteSemanticYellow,$e=fe===void 0?"#FAAD14":fe,re=O.paletteSequence,Ge=re===void 0?P:re,Qe=O.fontFamily,Te=Qe===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Qe,Le=O.brandColor,Ce=Le===void 0?H[0]:Le;return{mapStyle:B,brandColor:Ce,subColor:N,paletteQualitative10:H,paletteQualitative20:at,paletteSemanticRed:Re,paletteSemanticGreen:wt,paletteSemanticYellow:$e,paletteSequence:Ge,fontFamily:Te,legendContainerFillColor:"rgba(31, 31, 31, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:v[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(31, 31, 31, 0.9)",tooltipContainerShadow:"0px 2px 4px rgba(0, 0, 0, 0.5)",tooltipContainerBorderRadius:2,tooltipTextFillColor:v[65],tooltipItemNameFillColor:v[65],tooltipItemValueFillColor:v[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:v[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:Z[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:y[100],pointActiveBorderColor:v[100],pointSelectedBorderColor:v[100]}};A.createDarkStyleSheet=L,A.dark=(0,A.createDarkStyleSheet)()},64349:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.light=A.createLightStyleSheet=void 0;var y={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},v={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Z=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],a=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],P=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],L=function(O){O===void 0&&(O={});var D=O.mapStyle,B=D===void 0?"light":D,V=O.subColor,N=V===void 0?"rgba(0,0,0,0.05)":V,Y=O.paletteQualitative10,H=Y===void 0?Z:Y,ce=O.paletteQualitative20,at=ce===void 0?a:ce,rt=O.paletteSemanticRed,Re=rt===void 0?"#F4664A":rt,vt=O.paletteSemanticGreen,wt=vt===void 0?"#30BF78":vt,fe=O.paletteSemanticYellow,$e=fe===void 0?"#FAAD14":fe,re=O.paletteSequence,Ge=re===void 0?P:re,Qe=O.fontFamily,Te=Qe===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Qe,Le=O.brandColor,Ce=Le===void 0?H[0]:Le;return{mapStyle:B,brandColor:Ce,subColor:N,paletteQualitative10:H,paletteQualitative20:at,paletteSemanticRed:Re,paletteSemanticGreen:wt,paletteSemanticYellow:$e,paletteSequence:Ge,fontFamily:Te,legendContainerFillColor:"rgba(255, 255, 255, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:y[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(255, 255, 255, 0.9)",tooltipContainerShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",tooltipContainerBorderRadius:2,tooltipTextFillColor:y[65],tooltipItemNameFillColor:y[65],tooltipItemValueFillColor:y[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:y[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:Ce,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:v[100],pointActiveBorderColor:y[100],pointSelectedBorderColor:y[100]}};A.createLightStyleSheet=L,A.light=(0,A.createLightStyleSheet)()},53830:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.createThemeByStyleSheet=void 0;var v=y(70655),Z=(0,v.__importStar)(y(77972)),a=(0,v.__importStar)(y(3876)),P=(0,v.__importStar)(y(56992));function L(O){var D,B,V,N={point:{default:{fill:O.pointFillColor,size:O.pointSize,stroke:O.pointBorderColor,lineWidth:O.pointBorder,fillOpacity:O.pointFillOpacity},active:{fill:O.pointActiveFillColor},selected:{fill:O.pointSelectedFillColor}}};return{mapStyle:O.mapStyle,defaultColor:O.brandColor,subColor:O.subColor,semanticRed:O.paletteSemanticRed,semanticGreen:O.paletteSemanticGreen,fontFamily:O.fontFamily,colors10:O.paletteQualitative10,colors20:O.paletteQualitative20,sequenceColors:O.paletteSequence,shapes:{point:["circle","square"],line:["line"]},sizes:[1,10],geometries:{point:{circle:{default:{style:N.point.default},active:{style:N.point.active},selected:{style:N.point.selected}}},line:{},polygon:{}},components:{legend:{category:{domStyles:(D={},D[a.CONTAINER_CLASS]={visibility:"visible",zIndex:1,backgroundColor:O.legendContainerFillColor,boxShadow:O.legendContainerShadow,borderRadius:"".concat(O.legendContainerBorderRadius,"px"),color:O.legendTextFillColor,fontFamily:O.fontFamily,padding:"10px",lineHeight:"1",fontSize:"".concat(O.legendTextFontSize,"px")},D[a.TITLE_CLASS]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},D[a.LIST_CLASS]={margin:"0px",padding:"0px"},D[a.LIST_ITEM_CLASS]={marginBottom:"2px"},D[a.MARKER_CLASS]={width:"10px",height:"10px"},D[a.VALUE_CLASS]={paddingLeft:"8px"},D)},continue:{domStyles:(B={},B[P.CONTAINER_CLASS]={visibility:"visible",zIndex:1,backgroundColor:O.legendContainerFillColor,boxShadow:O.legendContainerShadow,borderRadius:"".concat(O.legendContainerBorderRadius,"px"),color:O.legendTextFillColor,fontFamily:O.fontFamily,padding:"10px",lineHeight:1,fontSize:"".concat(O.legendTextFontSize,"px")},B[P.TITLE_CLASS]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},B[P.RIBBON_CLASS]={display:"flex",alignItems:"center"},B[P.GRADIENT_BAR_CLASS]={width:"140px",height:"14px",margin:"0px 5px"},B[P.VALUE_RANGE_CLASS]={padding:"0px"},B)}},tooltip:{domStyles:(V={},V[Z.CONTAINER_CLASS]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:O.tooltipContainerFillColor,boxShadow:O.tooltipContainerShadow,borderRadius:"".concat(O.tooltipContainerBorderRadius,"px"),color:O.tooltipTextFillColor,fontSize:"".concat(O.tooltipTextFontSize,"px"),fontFamily:O.fontFamily,lineHeight:O.tooltipTextLineHeight},V[Z.TITLE_CLASS]={marginBottom:"4px"},V[Z.LIST_CLASS]={margin:"0px",padding:"0px"},V[Z.LIST_ITEM_CLASS]={marginBottom:"4px"},V[Z.NAME_CLASS]={color:O.tooltipItemNameFillColor},V[Z.VALUE_CLASS]={color:O.tooltipItemValueFillColor,marginLeft:"30px"},V)},label:{style:{textAnchor:"center",textOffset:[0,0],fill:O.labelFillColor,fontSize:O.labelFontSize,fontFamily:O.fontFamily,fillColorDark:O.labelFillColorDark,fillColorLight:O.labelFillColorLight}}}}}A.createThemeByStyleSheet=L},72985:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.createDarkTheme=A.createTheme=void 0;var v=y(70655),Z=y(49242),a=y(53830),P=y(64349),L=y(51070);function O(B){var V=B.styleSheet,N=V===void 0?{}:V,Y=(0,v.__rest)(B,["styleSheet"]),H=(0,P.createLightStyleSheet)(N);return(0,Z.deepMix)({},(0,a.createThemeByStyleSheet)(H),Y)}A.createTheme=O;function D(B){var V=B.styleSheet,N=V===void 0?{}:V,Y=(0,v.__rest)(B,["styleSheet"]),H=(0,L.createDarkStyleSheet)(N);return(0,Z.deepMix)({},(0,a.createThemeByStyleSheet)(H),Y)}A.createDarkTheme=D},4548:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.createDarkTheme=A.createTheme=void 0;var v=y(72985);Object.defineProperty(A,"createTheme",{enumerable:!0,get:function(){return v.createTheme}}),Object.defineProperty(A,"createDarkTheme",{enumerable:!0,get:function(){return v.createDarkTheme}})},69947:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0})},1019:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BlendType=void 0;var v=y(39128);Object.defineProperty(A,"BlendType",{enumerable:!0,get:function(){return v.BlendType}});var Z=y(20110)},79194:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.PositionType=void 0;var v=y(39128);Object.defineProperty(A,"PositionType",{enumerable:!0,get:function(){return v.PositionType}})},75516:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0});var v=y(70655);(0,v.__exportStar)(y(1019),A),(0,v.__exportStar)(y(69947),A),(0,v.__exportStar)(y(55226),A),(0,v.__exportStar)(y(36240),A),(0,v.__exportStar)(y(38113),A),(0,v.__exportStar)(y(53178),A),(0,v.__exportStar)(y(4085),A),(0,v.__exportStar)(y(16995),A),(0,v.__exportStar)(y(79194),A),(0,v.__exportStar)(y(43071),A),(0,v.__exportStar)(y(46690),A)},53178:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0})},55226:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.LayerType=A.LineStyleType=void 0;var y;(function(Z){Z[Z.solid=0]="solid",Z[Z.dash=1]="dash"})(y=A.LineStyleType||(A.LineStyleType={}));var v;(function(Z){Z.TextLayer="textLayer",Z.DotLayer="dotLayer",Z.IconLayer="iconLayer",Z.DotDensity="dotDensityLayer",Z.ColumnLayer="columnLayer",Z.HeatmapLayer="heatmapLayer",Z.GridLayer="gridLayer",Z.HexbinLayer="hexbinLayer",Z.LinesLayer="linesLayer",Z.PathLayer="pathLayer",Z.ArcLayer="arcLayer",Z.AreaLayer="areaLayer",Z.PrismLayer="prismLayer"})(v=A.LayerType||(A.LayerType={}))},43071:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0})},36240:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BaseMapType=A.Source=A.MapboxglMap=void 0;var v=y(70655),Z=y(6158);Object.defineProperty(A,"MapboxglMap",{enumerable:!0,get:function(){return Z.Map}});var a=(0,v.__importDefault)(y(96090));A.Source=a.default;var P;(function(L){L.Amap="amap",L.Mapbox="mapbox"})(P=A.BaseMapType||(A.BaseMapType={}))},38113:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.PlotType=void 0;var y;(function(v){v.Dot="dot",v.DotDensity="dotDensity",v.Heatmap="heatmap",v.Grid="grid",v.Hexbin="hexbin",v.Path="path",v.Flow="flow",v.Area="area",v.Choropleth="choropleth"})(y=A.PlotType||(A.PlotType={}))},16995:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0})},46690:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0})},4085:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.TooltipAnchorType=void 0;var v=y(86049);Object.defineProperty(A,"TooltipAnchorType",{enumerable:!0,get:function(){return v.anchorType}})},21658:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.deepAssign=void 0;var y=5,v=new Object().toString,Z=function(B,V){return v.call(B)==="[object "+V+"]"},a=function(B){return Z(B,"Array")},P=function(B){return typeof B=="object"&&B!==null},L=function(B){if(!P(B)||!Z(B,"Object"))return!1;for(var V=B;Object.getPrototypeOf(V)!==null;)V=Object.getPrototypeOf(V);return Object.getPrototypeOf(B)===V},O=function(B,V,N,Y){N=N||0,Y=Y||y;for(var H in V)if(Object.prototype.hasOwnProperty.call(V,H)){var ce=V[H];ce?L(ce)?(L(B[H])||(B[H]={}),N<Y?O(B[H],ce,N+1,Y):B[H]=V[H]):a(ce)?(B[H]=[],B[H]=B[H].concat(ce)):B[H]=ce:B[H]=ce}},D=function(B){for(var V=[],N=1;N<arguments.length;N++)V[N-1]=arguments[N];for(var Y=0;Y<V.length;Y+=1)O(B,V[Y]);return B};A.deepAssign=D},57042:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.deepAssign=void 0;var v=y(21658);Object.defineProperty(A,"deepAssign",{enumerable:!0,get:function(){return v.deepAssign}})},1215:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.default="0.0.11"},31795:function(Ft,A,y){var v=y(75752);Ft.exports.geometry=Z,Ft.exports.ring=P;function Z(O){var D=0,B;switch(O.type){case"Polygon":return a(O.coordinates);case"MultiPolygon":for(B=0;B<O.coordinates.length;B++)D+=a(O.coordinates[B]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(B=0;B<O.geometries.length;B++)D+=Z(O.geometries[B]);return D}}function a(O){var D=0;if(O&&O.length>0){D+=Math.abs(P(O[0]));for(var B=1;B<O.length;B++)D-=Math.abs(P(O[B]))}return D}function P(O){var D,B,V,N,Y,H,ce,at=0,rt=O.length;if(rt>2){for(ce=0;ce<rt;ce++)ce===rt-2?(N=rt-2,Y=rt-1,H=0):ce===rt-1?(N=rt-1,Y=0,H=1):(N=ce,Y=ce+1,H=ce+2),D=O[N],B=O[Y],V=O[H],at+=(L(V[0])-L(D[0]))*Math.sin(L(B[1]));at=at*v.RADIUS*v.RADIUS/2}return at}function L(O){return O*Math.PI/180}},38163:function(Ft,A,y){var v=y(31795);Ft.exports=Z;function Z(B,V){switch(B&&B.type||null){case"FeatureCollection":return B.features=B.features.map(a(Z,V)),B;case"GeometryCollection":return B.geometries=B.geometries.map(a(Z,V)),B;case"Feature":return B.geometry=Z(B.geometry,V),B;case"Polygon":case"MultiPolygon":return P(B,V);default:return B}}function a(B,V){return function(N){return B(N,V)}}function P(B,V){return B.type==="Polygon"?B.coordinates=L(B.coordinates,V):B.type==="MultiPolygon"&&(B.coordinates=B.coordinates.map(a(L,V))),B}function L(B,V){V=!!V,B[0]=O(B[0],V);for(var N=1;N<B.length;N++)B[N]=O(B[N],!V);return B}function O(B,V){return D(B)===V?B:B.reverse()}function D(B){return v.ring(B)>=0}},99874:function(Ft){Ft.exports=A;function A(y,v,Z,a){this.cx=3*y,this.bx=3*(Z-y)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*v,this.by=3*(a-v)-this.cy,this.ay=1-this.cy-this.by,this.p1x=y,this.p1y=a,this.p2x=Z,this.p2y=a}A.prototype.sampleCurveX=function(y){return((this.ax*y+this.bx)*y+this.cx)*y},A.prototype.sampleCurveY=function(y){return((this.ay*y+this.by)*y+this.cy)*y},A.prototype.sampleCurveDerivativeX=function(y){return(3*this.ax*y+2*this.bx)*y+this.cx},A.prototype.solveCurveX=function(y,v){typeof v=="undefined"&&(v=1e-6);var Z,a,P,L,O;for(P=y,O=0;O<8;O++){if(L=this.sampleCurveX(P)-y,Math.abs(L)<v)return P;var D=this.sampleCurveDerivativeX(P);if(Math.abs(D)<1e-6)break;P=P-L/D}if(Z=0,a=1,P=y,P<Z)return Z;if(P>a)return a;for(;Z<a;){if(L=this.sampleCurveX(P),Math.abs(L-y)<v)return P;y>L?Z=P:a=P,P=(a-Z)*.5+Z}return P},A.prototype.solve=function(y,v){return this.sampleCurveY(this.solveCurveX(y,v))}},40271:function(Ft,A,y){"use strict";y.d(A,{zL:function(){return L},DL:function(){return fe},Ht:function(){return Te}});var v=63710088e-1,Z={centimeters:v*100,centimetres:v*100,degrees:v/111325,feet:v*3.28084,inches:v*39.37,kilometers:v/1e3,kilometres:v/1e3,meters:v,metres:v,miles:v/1609.344,millimeters:v*1e3,millimetres:v*1e3,nauticalmiles:v/1852,radians:1,yards:v*1.0936},a={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/v,yards:1.0936133},P={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function L(Pe,Ne,Xe){Xe===void 0&&(Xe={});var kt={type:"Feature"};return(Xe.id===0||Xe.id)&&(kt.id=Xe.id),Xe.bbox&&(kt.bbox=Xe.bbox),kt.properties=Ne||{},kt.geometry=Pe,kt}function O(Pe,Ne,Xe){switch(Xe===void 0&&(Xe={}),Pe){case"Point":return D(Ne).geometry;case"LineString":return Y(Ne).geometry;case"Polygon":return V(Ne).geometry;case"MultiPoint":return rt(Ne).geometry;case"MultiLineString":return at(Ne).geometry;case"MultiPolygon":return Re(Ne).geometry;default:throw new Error(Pe+" is invalid")}}function D(Pe,Ne,Xe){if(Xe===void 0&&(Xe={}),!Pe)throw new Error("coordinates is required");if(!Array.isArray(Pe))throw new Error("coordinates must be an Array");if(Pe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Fe(Pe[0])||!Fe(Pe[1]))throw new Error("coordinates must contain numbers");var kt={type:"Point",coordinates:Pe};return L(kt,Ne,Xe)}function B(Pe,Ne,Xe){return Xe===void 0&&(Xe={}),ce(Pe.map(function(kt){return D(kt,Ne)}),Xe)}function V(Pe,Ne,Xe){Xe===void 0&&(Xe={});for(var kt=0,rr=Pe;kt<rr.length;kt++){var me=rr[kt];if(me.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var et=0;et<me[me.length-1].length;et++)if(me[me.length-1][et]!==me[0][et])throw new Error("First and last Position are not equivalent.")}var or={type:"Polygon",coordinates:Pe};return L(or,Ne,Xe)}function N(Pe,Ne,Xe){return Xe===void 0&&(Xe={}),ce(Pe.map(function(kt){return V(kt,Ne)}),Xe)}function Y(Pe,Ne,Xe){if(Xe===void 0&&(Xe={}),Pe.length<2)throw new Error("coordinates must be an array of two or more positions");var kt={type:"LineString",coordinates:Pe};return L(kt,Ne,Xe)}function H(Pe,Ne,Xe){return Xe===void 0&&(Xe={}),ce(Pe.map(function(kt){return Y(kt,Ne)}),Xe)}function ce(Pe,Ne){Ne===void 0&&(Ne={});var Xe={type:"FeatureCollection"};return Ne.id&&(Xe.id=Ne.id),Ne.bbox&&(Xe.bbox=Ne.bbox),Xe.features=Pe,Xe}function at(Pe,Ne,Xe){Xe===void 0&&(Xe={});var kt={type:"MultiLineString",coordinates:Pe};return L(kt,Ne,Xe)}function rt(Pe,Ne,Xe){Xe===void 0&&(Xe={});var kt={type:"MultiPoint",coordinates:Pe};return L(kt,Ne,Xe)}function Re(Pe,Ne,Xe){Xe===void 0&&(Xe={});var kt={type:"MultiPolygon",coordinates:Pe};return L(kt,Ne,Xe)}function vt(Pe,Ne,Xe){Xe===void 0&&(Xe={});var kt={type:"GeometryCollection",geometries:Pe};return L(kt,Ne,Xe)}function wt(Pe,Ne){if(Ne===void 0&&(Ne=0),Ne&&!(Ne>=0))throw new Error("precision must be a positive number");var Xe=Math.pow(10,Ne||0);return Math.round(Pe*Xe)/Xe}function fe(Pe,Ne){Ne===void 0&&(Ne="kilometers");var Xe=Z[Ne];if(!Xe)throw new Error(Ne+" units is invalid");return Pe*Xe}function $e(Pe,Ne){Ne===void 0&&(Ne="kilometers");var Xe=Z[Ne];if(!Xe)throw new Error(Ne+" units is invalid");return Pe/Xe}function re(Pe,Ne){return Qe($e(Pe,Ne))}function Ge(Pe){var Ne=Pe%360;return Ne<0&&(Ne+=360),Ne}function Qe(Pe){var Ne=Pe%(2*Math.PI);return Ne*180/Math.PI}function Te(Pe){var Ne=Pe%360;return Ne*Math.PI/180}function Le(Pe,Ne,Xe){if(Ne===void 0&&(Ne="kilometers"),Xe===void 0&&(Xe="kilometers"),!(Pe>=0))throw new Error("length must be a positive number");return fe($e(Pe,Ne),Xe)}function Ce(Pe,Ne,Xe){if(Ne===void 0&&(Ne="meters"),Xe===void 0&&(Xe="kilometers"),!(Pe>=0))throw new Error("area must be a positive number");var kt=P[Ne];if(!kt)throw new Error("invalid original units");var rr=P[Xe];if(!rr)throw new Error("invalid final units");return Pe/kt*rr}function Fe(Pe){return!isNaN(Pe)&&Pe!==null&&!Array.isArray(Pe)}function Ke(Pe){return!!Pe&&Pe.constructor===Object}function qt(Pe){if(!Pe)throw new Error("bbox is required");if(!Array.isArray(Pe))throw new Error("bbox must be an Array");if(Pe.length!==4&&Pe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Pe.forEach(function(Ne){if(!Fe(Ne))throw new Error("bbox must only contain numbers")})}function ir(Pe){if(!Pe)throw new Error("id is required");if(["string","number"].indexOf(typeof Pe)===-1)throw new Error("id must be a number or a string")}},9187:function(Ft){"use strict";Ft.exports=A,Ft.exports.default=A;function A(Pe,Ne,Xe){Xe=Xe||2;var kt=Ne&&Ne.length,rr=kt?Ne[0]*Xe:Pe.length,me=y(Pe,0,rr,Xe,!0),et=[];if(!me||me.next===me.prev)return et;var or,on,vr,jr,xr,Ae,De;if(kt&&(me=D(Pe,Ne,me,Xe)),Pe.length>80*Xe){or=vr=Pe[0],on=jr=Pe[1];for(var ke=Xe;ke<rr;ke+=Xe)xr=Pe[ke],Ae=Pe[ke+1],xr<or&&(or=xr),Ae<on&&(on=Ae),xr>vr&&(vr=xr),Ae>jr&&(jr=Ae);De=Math.max(vr-or,jr-on),De=De!==0?1/De:0}return Z(me,et,Xe,or,on,De),et}function y(Pe,Ne,Xe,kt,rr){var me,et;if(rr===ir(Pe,Ne,Xe,kt)>0)for(me=Ne;me<Xe;me+=kt)et=Fe(me,Pe[me],Pe[me+1],et);else for(me=Xe-kt;me>=Ne;me-=kt)et=Fe(me,Pe[me],Pe[me+1],et);return et&&fe(et,et.next)&&(Ke(et),et=et.next),et}function v(Pe,Ne){if(!Pe)return Pe;Ne||(Ne=Pe);var Xe=Pe,kt;do if(kt=!1,!Xe.steiner&&(fe(Xe,Xe.next)||wt(Xe.prev,Xe,Xe.next)===0)){if(Ke(Xe),Xe=Ne=Xe.prev,Xe===Xe.next)break;kt=!0}else Xe=Xe.next;while(kt||Xe!==Ne);return Ne}function Z(Pe,Ne,Xe,kt,rr,me,et){if(!!Pe){!et&&me&&H(Pe,kt,rr,me);for(var or=Pe,on,vr;Pe.prev!==Pe.next;){if(on=Pe.prev,vr=Pe.next,me?P(Pe,kt,rr,me):a(Pe)){Ne.push(on.i/Xe),Ne.push(Pe.i/Xe),Ne.push(vr.i/Xe),Ke(Pe),Pe=vr.next,or=vr.next;continue}if(Pe=vr,Pe===or){et?et===1?(Pe=L(v(Pe),Ne,Xe),Z(Pe,Ne,Xe,kt,rr,me,2)):et===2&&O(Pe,Ne,Xe,kt,rr,me):Z(v(Pe),Ne,Xe,kt,rr,me,1);break}}}}function a(Pe){var Ne=Pe.prev,Xe=Pe,kt=Pe.next;if(wt(Ne,Xe,kt)>=0)return!1;for(var rr=Pe.next.next;rr!==Pe.prev;){if(Re(Ne.x,Ne.y,Xe.x,Xe.y,kt.x,kt.y,rr.x,rr.y)&&wt(rr.prev,rr,rr.next)>=0)return!1;rr=rr.next}return!0}function P(Pe,Ne,Xe,kt){var rr=Pe.prev,me=Pe,et=Pe.next;if(wt(rr,me,et)>=0)return!1;for(var or=rr.x<me.x?rr.x<et.x?rr.x:et.x:me.x<et.x?me.x:et.x,on=rr.y<me.y?rr.y<et.y?rr.y:et.y:me.y<et.y?me.y:et.y,vr=rr.x>me.x?rr.x>et.x?rr.x:et.x:me.x>et.x?me.x:et.x,jr=rr.y>me.y?rr.y>et.y?rr.y:et.y:me.y>et.y?me.y:et.y,xr=at(or,on,Ne,Xe,kt),Ae=at(vr,jr,Ne,Xe,kt),De=Pe.prevZ,ke=Pe.nextZ;De&&De.z>=xr&&ke&&ke.z<=Ae;){if(De!==Pe.prev&&De!==Pe.next&&Re(rr.x,rr.y,me.x,me.y,et.x,et.y,De.x,De.y)&&wt(De.prev,De,De.next)>=0||(De=De.prevZ,ke!==Pe.prev&&ke!==Pe.next&&Re(rr.x,rr.y,me.x,me.y,et.x,et.y,ke.x,ke.y)&&wt(ke.prev,ke,ke.next)>=0))return!1;ke=ke.nextZ}for(;De&&De.z>=xr;){if(De!==Pe.prev&&De!==Pe.next&&Re(rr.x,rr.y,me.x,me.y,et.x,et.y,De.x,De.y)&&wt(De.prev,De,De.next)>=0)return!1;De=De.prevZ}for(;ke&&ke.z<=Ae;){if(ke!==Pe.prev&&ke!==Pe.next&&Re(rr.x,rr.y,me.x,me.y,et.x,et.y,ke.x,ke.y)&&wt(ke.prev,ke,ke.next)>=0)return!1;ke=ke.nextZ}return!0}function L(Pe,Ne,Xe){var kt=Pe;do{var rr=kt.prev,me=kt.next.next;!fe(rr,me)&&$e(rr,kt,kt.next,me)&&Te(rr,me)&&Te(me,rr)&&(Ne.push(rr.i/Xe),Ne.push(kt.i/Xe),Ne.push(me.i/Xe),Ke(kt),Ke(kt.next),kt=Pe=me),kt=kt.next}while(kt!==Pe);return v(kt)}function O(Pe,Ne,Xe,kt,rr,me){var et=Pe;do{for(var or=et.next.next;or!==et.prev;){if(et.i!==or.i&&vt(et,or)){var on=Ce(et,or);et=v(et,et.next),on=v(on,on.next),Z(et,Ne,Xe,kt,rr,me),Z(on,Ne,Xe,kt,rr,me);return}or=or.next}et=et.next}while(et!==Pe)}function D(Pe,Ne,Xe,kt){var rr=[],me,et,or,on,vr;for(me=0,et=Ne.length;me<et;me++)or=Ne[me]*kt,on=me<et-1?Ne[me+1]*kt:Pe.length,vr=y(Pe,or,on,kt,!1),vr===vr.next&&(vr.steiner=!0),rr.push(rt(vr));for(rr.sort(B),me=0;me<rr.length;me++)Xe=V(rr[me],Xe),Xe=v(Xe,Xe.next);return Xe}function B(Pe,Ne){return Pe.x-Ne.x}function V(Pe,Ne){var Xe=N(Pe,Ne);if(!Xe)return Ne;var kt=Ce(Xe,Pe),rr=v(Xe,Xe.next);return v(kt,kt.next),Ne===Xe?rr:Ne}function N(Pe,Ne){var Xe=Ne,kt=Pe.x,rr=Pe.y,me=-Infinity,et;do{if(rr<=Xe.y&&rr>=Xe.next.y&&Xe.next.y!==Xe.y){var or=Xe.x+(rr-Xe.y)*(Xe.next.x-Xe.x)/(Xe.next.y-Xe.y);if(or<=kt&&or>me){if(me=or,or===kt){if(rr===Xe.y)return Xe;if(rr===Xe.next.y)return Xe.next}et=Xe.x<Xe.next.x?Xe:Xe.next}}Xe=Xe.next}while(Xe!==Ne);if(!et)return null;if(kt===me)return et;var on=et,vr=et.x,jr=et.y,xr=Infinity,Ae;Xe=et;do kt>=Xe.x&&Xe.x>=vr&&kt!==Xe.x&&Re(rr<jr?kt:me,rr,vr,jr,rr<jr?me:kt,rr,Xe.x,Xe.y)&&(Ae=Math.abs(rr-Xe.y)/(kt-Xe.x),Te(Xe,Pe)&&(Ae<xr||Ae===xr&&(Xe.x>et.x||Xe.x===et.x&&Y(et,Xe)))&&(et=Xe,xr=Ae)),Xe=Xe.next;while(Xe!==on);return et}function Y(Pe,Ne){return wt(Pe.prev,Pe,Ne.prev)<0&&wt(Ne.next,Pe,Pe.next)<0}function H(Pe,Ne,Xe,kt){var rr=Pe;do rr.z===null&&(rr.z=at(rr.x,rr.y,Ne,Xe,kt)),rr.prevZ=rr.prev,rr.nextZ=rr.next,rr=rr.next;while(rr!==Pe);rr.prevZ.nextZ=null,rr.prevZ=null,ce(rr)}function ce(Pe){var Ne,Xe,kt,rr,me,et,or,on,vr=1;do{for(Xe=Pe,Pe=null,me=null,et=0;Xe;){for(et++,kt=Xe,or=0,Ne=0;Ne<vr&&(or++,kt=kt.nextZ,!!kt);Ne++);for(on=vr;or>0||on>0&&kt;)or!==0&&(on===0||!kt||Xe.z<=kt.z)?(rr=Xe,Xe=Xe.nextZ,or--):(rr=kt,kt=kt.nextZ,on--),me?me.nextZ=rr:Pe=rr,rr.prevZ=me,me=rr;Xe=kt}me.nextZ=null,vr*=2}while(et>1);return Pe}function at(Pe,Ne,Xe,kt,rr){return Pe=32767*(Pe-Xe)*rr,Ne=32767*(Ne-kt)*rr,Pe=(Pe|Pe<<8)&16711935,Pe=(Pe|Pe<<4)&252645135,Pe=(Pe|Pe<<2)&858993459,Pe=(Pe|Pe<<1)&1431655765,Ne=(Ne|Ne<<8)&16711935,Ne=(Ne|Ne<<4)&252645135,Ne=(Ne|Ne<<2)&858993459,Ne=(Ne|Ne<<1)&1431655765,Pe|Ne<<1}function rt(Pe){var Ne=Pe,Xe=Pe;do(Ne.x<Xe.x||Ne.x===Xe.x&&Ne.y<Xe.y)&&(Xe=Ne),Ne=Ne.next;while(Ne!==Pe);return Xe}function Re(Pe,Ne,Xe,kt,rr,me,et,or){return(rr-et)*(Ne-or)-(Pe-et)*(me-or)>=0&&(Pe-et)*(kt-or)-(Xe-et)*(Ne-or)>=0&&(Xe-et)*(me-or)-(rr-et)*(kt-or)>=0}function vt(Pe,Ne){return Pe.next.i!==Ne.i&&Pe.prev.i!==Ne.i&&!Qe(Pe,Ne)&&(Te(Pe,Ne)&&Te(Ne,Pe)&&Le(Pe,Ne)&&(wt(Pe.prev,Pe,Ne.prev)||wt(Pe,Ne.prev,Ne))||fe(Pe,Ne)&&wt(Pe.prev,Pe,Pe.next)>0&&wt(Ne.prev,Ne,Ne.next)>0)}function wt(Pe,Ne,Xe){return(Ne.y-Pe.y)*(Xe.x-Ne.x)-(Ne.x-Pe.x)*(Xe.y-Ne.y)}function fe(Pe,Ne){return Pe.x===Ne.x&&Pe.y===Ne.y}function $e(Pe,Ne,Xe,kt){var rr=Ge(wt(Pe,Ne,Xe)),me=Ge(wt(Pe,Ne,kt)),et=Ge(wt(Xe,kt,Pe)),or=Ge(wt(Xe,kt,Ne));return!!(rr!==me&&et!==or||rr===0&&re(Pe,Xe,Ne)||me===0&&re(Pe,kt,Ne)||et===0&&re(Xe,Pe,kt)||or===0&&re(Xe,Ne,kt))}function re(Pe,Ne,Xe){return Ne.x<=Math.max(Pe.x,Xe.x)&&Ne.x>=Math.min(Pe.x,Xe.x)&&Ne.y<=Math.max(Pe.y,Xe.y)&&Ne.y>=Math.min(Pe.y,Xe.y)}function Ge(Pe){return Pe>0?1:Pe<0?-1:0}function Qe(Pe,Ne){var Xe=Pe;do{if(Xe.i!==Pe.i&&Xe.next.i!==Pe.i&&Xe.i!==Ne.i&&Xe.next.i!==Ne.i&&$e(Xe,Xe.next,Pe,Ne))return!0;Xe=Xe.next}while(Xe!==Pe);return!1}function Te(Pe,Ne){return wt(Pe.prev,Pe,Pe.next)<0?wt(Pe,Ne,Pe.next)>=0&&wt(Pe,Pe.prev,Ne)>=0:wt(Pe,Ne,Pe.prev)<0||wt(Pe,Pe.next,Ne)<0}function Le(Pe,Ne){var Xe=Pe,kt=!1,rr=(Pe.x+Ne.x)/2,me=(Pe.y+Ne.y)/2;do Xe.y>me!=Xe.next.y>me&&Xe.next.y!==Xe.y&&rr<(Xe.next.x-Xe.x)*(me-Xe.y)/(Xe.next.y-Xe.y)+Xe.x&&(kt=!kt),Xe=Xe.next;while(Xe!==Pe);return kt}function Ce(Pe,Ne){var Xe=new qt(Pe.i,Pe.x,Pe.y),kt=new qt(Ne.i,Ne.x,Ne.y),rr=Pe.next,me=Ne.prev;return Pe.next=Ne,Ne.prev=Pe,Xe.next=rr,rr.prev=Xe,kt.next=Xe,Xe.prev=kt,me.next=kt,kt.prev=me,kt}function Fe(Pe,Ne,Xe,kt){var rr=new qt(Pe,Ne,Xe);return kt?(rr.next=kt.next,rr.prev=kt,kt.next.prev=rr,kt.next=rr):(rr.prev=rr,rr.next=rr),rr}function Ke(Pe){Pe.next.prev=Pe.prev,Pe.prev.next=Pe.next,Pe.prevZ&&(Pe.prevZ.nextZ=Pe.nextZ),Pe.nextZ&&(Pe.nextZ.prevZ=Pe.prevZ)}function qt(Pe,Ne,Xe){this.i=Pe,this.x=Ne,this.y=Xe,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}A.deviation=function(Pe,Ne,Xe,kt){var rr=Ne&&Ne.length,me=rr?Ne[0]*Xe:Pe.length,et=Math.abs(ir(Pe,0,me,Xe));if(rr)for(var or=0,on=Ne.length;or<on;or++){var vr=Ne[or]*Xe,jr=or<on-1?Ne[or+1]*Xe:Pe.length;et-=Math.abs(ir(Pe,vr,jr,Xe))}var xr=0;for(or=0;or<kt.length;or+=3){var Ae=kt[or]*Xe,De=kt[or+1]*Xe,ke=kt[or+2]*Xe;xr+=Math.abs((Pe[Ae]-Pe[ke])*(Pe[De+1]-Pe[Ae+1])-(Pe[Ae]-Pe[De])*(Pe[ke+1]-Pe[Ae+1]))}return et===0&&xr===0?0:Math.abs((xr-et)/et)};function ir(Pe,Ne,Xe,kt){for(var rr=0,me=Ne,et=Xe-kt;me<Xe;me+=kt)rr+=(Pe[et]-Pe[me])*(Pe[me+1]+Pe[et+1]),et=me;return rr}A.flatten=function(Pe){for(var Ne=Pe[0][0].length,Xe={vertices:[],holes:[],dimensions:Ne},kt=0,rr=0;rr<Pe.length;rr++){for(var me=0;me<Pe[rr].length;me++)for(var et=0;et<Ne;et++)Xe.vertices.push(Pe[rr][me][et]);rr>0&&(kt+=Pe[rr-1].length,Xe.holes.push(kt))}return Xe}},67709:function(Ft){function A(v){var Z=v.target||v.srcElement;Z.__resizeRAF__&&cancelAnimationFrame(Z.__resizeRAF__),Z.__resizeRAF__=requestAnimationFrame(function(){var a=Z.__resizeTrigger__,P=a&&a.__resizeListeners__;P&&P.forEach(function(L){L.call(a,v)})})}var y=function(Z,a){var P=this,L=P.document,O,D=L.attachEvent;typeof navigator!="undefined"&&(O=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function B(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",A)}if(!Z.__resizeListeners__)if(Z.__resizeListeners__=[],D)Z.__resizeTrigger__=Z,Z.attachEvent("onresize",A);else{getComputedStyle(Z).position==="static"&&(Z.style.position="relative");var V=Z.__resizeTrigger__=L.createElement("object");V.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),V.setAttribute("class","resize-sensor"),V.setAttribute("tabindex","-1"),V.setAttribute("title",""),V.__resizeElement__=Z,V.onload=B,V.type="text/html",O&&Z.appendChild(V),V.data="about:blank",O||Z.appendChild(V)}Z.__resizeListeners__.push(a)};Ft.exports=typeof window=="undefined"?y:y.bind(window),Ft.exports.unbind=function(v,Z){var a=document.attachEvent,P=v.__resizeListeners__||[];if(Z){var L=P.indexOf(Z);L!==-1&&P.splice(L,1)}else P=v.__resizeListeners__=[];if(!P.length){if(a)v.detachEvent("onresize",A);else if(v.__resizeTrigger__){var O=v.__resizeTrigger__.contentDocument,D=O&&O.defaultView;D&&(D.removeEventListener("resize",A),delete D.__resizeTrigger__),v.__resizeTrigger__=!v.removeChild(v.__resizeTrigger__)}delete v.__resizeListeners__}}},26729:function(Ft){"use strict";var A=Object.prototype.hasOwnProperty,y="~";function v(){}Object.create&&(v.prototype=Object.create(null),new v().__proto__||(y=!1));function Z(O,D,B){this.fn=O,this.context=D,this.once=B||!1}function a(O,D,B,V,N){if(typeof B!="function")throw new TypeError("The listener must be a function");var Y=new Z(B,V||O,N),H=y?y+D:D;return O._events[H]?O._events[H].fn?O._events[H]=[O._events[H],Y]:O._events[H].push(Y):(O._events[H]=Y,O._eventsCount++),O}function P(O,D){--O._eventsCount==0?O._events=new v:delete O._events[D]}function L(){this._events=new v,this._eventsCount=0}L.prototype.eventNames=function(){var D=[],B,V;if(this._eventsCount===0)return D;for(V in B=this._events)A.call(B,V)&&D.push(y?V.slice(1):V);return Object.getOwnPropertySymbols?D.concat(Object.getOwnPropertySymbols(B)):D},L.prototype.listeners=function(D){var B=y?y+D:D,V=this._events[B];if(!V)return[];if(V.fn)return[V.fn];for(var N=0,Y=V.length,H=new Array(Y);N<Y;N++)H[N]=V[N].fn;return H},L.prototype.listenerCount=function(D){var B=y?y+D:D,V=this._events[B];return V?V.fn?1:V.length:0},L.prototype.emit=function(D,B,V,N,Y,H){var ce=y?y+D:D;if(!this._events[ce])return!1;var at=this._events[ce],rt=arguments.length,Re,vt;if(at.fn){switch(at.once&&this.removeListener(D,at.fn,void 0,!0),rt){case 1:return at.fn.call(at.context),!0;case 2:return at.fn.call(at.context,B),!0;case 3:return at.fn.call(at.context,B,V),!0;case 4:return at.fn.call(at.context,B,V,N),!0;case 5:return at.fn.call(at.context,B,V,N,Y),!0;case 6:return at.fn.call(at.context,B,V,N,Y,H),!0}for(vt=1,Re=new Array(rt-1);vt<rt;vt++)Re[vt-1]=arguments[vt];at.fn.apply(at.context,Re)}else{var wt=at.length,fe;for(vt=0;vt<wt;vt++)switch(at[vt].once&&this.removeListener(D,at[vt].fn,void 0,!0),rt){case 1:at[vt].fn.call(at[vt].context);break;case 2:at[vt].fn.call(at[vt].context,B);break;case 3:at[vt].fn.call(at[vt].context,B,V);break;case 4:at[vt].fn.call(at[vt].context,B,V,N);break;default:if(!Re)for(fe=1,Re=new Array(rt-1);fe<rt;fe++)Re[fe-1]=arguments[fe];at[vt].fn.apply(at[vt].context,Re)}}return!0},L.prototype.on=function(D,B,V){return a(this,D,B,V,!1)},L.prototype.once=function(D,B,V){return a(this,D,B,V,!0)},L.prototype.removeListener=function(D,B,V,N){var Y=y?y+D:D;if(!this._events[Y])return this;if(!B)return P(this,Y),this;var H=this._events[Y];if(H.fn)H.fn===B&&(!N||H.once)&&(!V||H.context===V)&&P(this,Y);else{for(var ce=0,at=[],rt=H.length;ce<rt;ce++)(H[ce].fn!==B||N&&!H[ce].once||V&&H[ce].context!==V)&&at.push(H[ce]);at.length?this._events[Y]=at.length===1?at[0]:at:P(this,Y)}return this},L.prototype.removeAllListeners=function(D){var B;return D?(B=y?y+D:D,this._events[B]&&P(this,B)):(this._events=new v,this._eventsCount=0),this},L.prototype.off=L.prototype.removeListener,L.prototype.addListener=L.prototype.on,L.prefixed=y,L.EventEmitter=L,Ft.exports=L},85975:function(Ft,A,y){"use strict";y.r(A),y.d(A,{create:function(){return Z},clone:function(){return a},copy:function(){return P},fromValues:function(){return L},set:function(){return O},identity:function(){return D},transpose:function(){return B},invert:function(){return V},adjoint:function(){return N},determinant:function(){return Y},multiply:function(){return H},translate:function(){return ce},scale:function(){return at},rotate:function(){return rt},rotateX:function(){return Re},rotateY:function(){return vt},rotateZ:function(){return wt},fromTranslation:function(){return fe},fromScaling:function(){return $e},fromRotation:function(){return re},fromXRotation:function(){return Ge},fromYRotation:function(){return Qe},fromZRotation:function(){return Te},fromRotationTranslation:function(){return Le},fromQuat2:function(){return Ce},getTranslation:function(){return Fe},getScaling:function(){return Ke},getRotation:function(){return qt},fromRotationTranslationScale:function(){return ir},fromRotationTranslationScaleOrigin:function(){return Pe},fromQuat:function(){return Ne},frustum:function(){return Xe},perspectiveNO:function(){return kt},perspective:function(){return rr},perspectiveZO:function(){return me},perspectiveFromFieldOfView:function(){return et},orthoNO:function(){return or},ortho:function(){return on},orthoZO:function(){return vr},lookAt:function(){return jr},targetTo:function(){return xr},str:function(){return Ae},frob:function(){return De},add:function(){return ke},subtract:function(){return Bt},multiplyScalar:function(){return mt},multiplyScalarAndAdd:function(){return Mr},exactEquals:function(){return Cr},equals:function(){return Nr},mul:function(){return nt},sub:function(){return Ye}});var v=y(49685);function Z(){var M=new v.WT(16);return v.WT!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0),M[0]=1,M[5]=1,M[10]=1,M[15]=1,M}function a(M){var W=new v.WT(16);return W[0]=M[0],W[1]=M[1],W[2]=M[2],W[3]=M[3],W[4]=M[4],W[5]=M[5],W[6]=M[6],W[7]=M[7],W[8]=M[8],W[9]=M[9],W[10]=M[10],W[11]=M[11],W[12]=M[12],W[13]=M[13],W[14]=M[14],W[15]=M[15],W}function P(M,W){return M[0]=W[0],M[1]=W[1],M[2]=W[2],M[3]=W[3],M[4]=W[4],M[5]=W[5],M[6]=W[6],M[7]=W[7],M[8]=W[8],M[9]=W[9],M[10]=W[10],M[11]=W[11],M[12]=W[12],M[13]=W[13],M[14]=W[14],M[15]=W[15],M}function L(M,W,ue,X,ie,ye,J,ht,ze,pt,Me,Ue,yt,gt,nr,pe){var lr=new v.WT(16);return lr[0]=M,lr[1]=W,lr[2]=ue,lr[3]=X,lr[4]=ie,lr[5]=ye,lr[6]=J,lr[7]=ht,lr[8]=ze,lr[9]=pt,lr[10]=Me,lr[11]=Ue,lr[12]=yt,lr[13]=gt,lr[14]=nr,lr[15]=pe,lr}function O(M,W,ue,X,ie,ye,J,ht,ze,pt,Me,Ue,yt,gt,nr,pe,lr){return M[0]=W,M[1]=ue,M[2]=X,M[3]=ie,M[4]=ye,M[5]=J,M[6]=ht,M[7]=ze,M[8]=pt,M[9]=Me,M[10]=Ue,M[11]=yt,M[12]=gt,M[13]=nr,M[14]=pe,M[15]=lr,M}function D(M){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function B(M,W){if(M===W){var ue=W[1],X=W[2],ie=W[3],ye=W[6],J=W[7],ht=W[11];M[1]=W[4],M[2]=W[8],M[3]=W[12],M[4]=ue,M[6]=W[9],M[7]=W[13],M[8]=X,M[9]=ye,M[11]=W[14],M[12]=ie,M[13]=J,M[14]=ht}else M[0]=W[0],M[1]=W[4],M[2]=W[8],M[3]=W[12],M[4]=W[1],M[5]=W[5],M[6]=W[9],M[7]=W[13],M[8]=W[2],M[9]=W[6],M[10]=W[10],M[11]=W[14],M[12]=W[3],M[13]=W[7],M[14]=W[11],M[15]=W[15];return M}function V(M,W){var ue=W[0],X=W[1],ie=W[2],ye=W[3],J=W[4],ht=W[5],ze=W[6],pt=W[7],Me=W[8],Ue=W[9],yt=W[10],gt=W[11],nr=W[12],pe=W[13],lr=W[14],Ur=W[15],Hr=ue*ht-X*J,un=ue*ze-ie*J,bn=ue*pt-ye*J,Gn=X*ze-ie*ht,li=X*pt-ye*ht,$r=ie*pt-ye*ze,Zt=Me*pe-Ue*nr,it=Me*lr-yt*nr,ne=Me*Ur-gt*nr,_e=Ue*lr-yt*pe,Oe=Ue*Ur-gt*pe,je=yt*Ur-gt*lr,dt=Hr*je-un*Oe+bn*_e+Gn*ne-li*it+$r*Zt;return dt?(dt=1/dt,M[0]=(ht*je-ze*Oe+pt*_e)*dt,M[1]=(ie*Oe-X*je-ye*_e)*dt,M[2]=(pe*$r-lr*li+Ur*Gn)*dt,M[3]=(yt*li-Ue*$r-gt*Gn)*dt,M[4]=(ze*ne-J*je-pt*it)*dt,M[5]=(ue*je-ie*ne+ye*it)*dt,M[6]=(lr*bn-nr*$r-Ur*un)*dt,M[7]=(Me*$r-yt*bn+gt*un)*dt,M[8]=(J*Oe-ht*ne+pt*Zt)*dt,M[9]=(X*ne-ue*Oe-ye*Zt)*dt,M[10]=(nr*li-pe*bn+Ur*Hr)*dt,M[11]=(Ue*bn-Me*li-gt*Hr)*dt,M[12]=(ht*it-J*_e-ze*Zt)*dt,M[13]=(ue*_e-X*it+ie*Zt)*dt,M[14]=(pe*un-nr*Gn-lr*Hr)*dt,M[15]=(Me*Gn-Ue*un+yt*Hr)*dt,M):null}function N(M,W){var ue=W[0],X=W[1],ie=W[2],ye=W[3],J=W[4],ht=W[5],ze=W[6],pt=W[7],Me=W[8],Ue=W[9],yt=W[10],gt=W[11],nr=W[12],pe=W[13],lr=W[14],Ur=W[15];return M[0]=ht*(yt*Ur-gt*lr)-Ue*(ze*Ur-pt*lr)+pe*(ze*gt-pt*yt),M[1]=-(X*(yt*Ur-gt*lr)-Ue*(ie*Ur-ye*lr)+pe*(ie*gt-ye*yt)),M[2]=X*(ze*Ur-pt*lr)-ht*(ie*Ur-ye*lr)+pe*(ie*pt-ye*ze),M[3]=-(X*(ze*gt-pt*yt)-ht*(ie*gt-ye*yt)+Ue*(ie*pt-ye*ze)),M[4]=-(J*(yt*Ur-gt*lr)-Me*(ze*Ur-pt*lr)+nr*(ze*gt-pt*yt)),M[5]=ue*(yt*Ur-gt*lr)-Me*(ie*Ur-ye*lr)+nr*(ie*gt-ye*yt),M[6]=-(ue*(ze*Ur-pt*lr)-J*(ie*Ur-ye*lr)+nr*(ie*pt-ye*ze)),M[7]=ue*(ze*gt-pt*yt)-J*(ie*gt-ye*yt)+Me*(ie*pt-ye*ze),M[8]=J*(Ue*Ur-gt*pe)-Me*(ht*Ur-pt*pe)+nr*(ht*gt-pt*Ue),M[9]=-(ue*(Ue*Ur-gt*pe)-Me*(X*Ur-ye*pe)+nr*(X*gt-ye*Ue)),M[10]=ue*(ht*Ur-pt*pe)-J*(X*Ur-ye*pe)+nr*(X*pt-ye*ht),M[11]=-(ue*(ht*gt-pt*Ue)-J*(X*gt-ye*Ue)+Me*(X*pt-ye*ht)),M[12]=-(J*(Ue*lr-yt*pe)-Me*(ht*lr-ze*pe)+nr*(ht*yt-ze*Ue)),M[13]=ue*(Ue*lr-yt*pe)-Me*(X*lr-ie*pe)+nr*(X*yt-ie*Ue),M[14]=-(ue*(ht*lr-ze*pe)-J*(X*lr-ie*pe)+nr*(X*ze-ie*ht)),M[15]=ue*(ht*yt-ze*Ue)-J*(X*yt-ie*Ue)+Me*(X*ze-ie*ht),M}function Y(M){var W=M[0],ue=M[1],X=M[2],ie=M[3],ye=M[4],J=M[5],ht=M[6],ze=M[7],pt=M[8],Me=M[9],Ue=M[10],yt=M[11],gt=M[12],nr=M[13],pe=M[14],lr=M[15],Ur=W*J-ue*ye,Hr=W*ht-X*ye,un=W*ze-ie*ye,bn=ue*ht-X*J,Gn=ue*ze-ie*J,li=X*ze-ie*ht,$r=pt*nr-Me*gt,Zt=pt*pe-Ue*gt,it=pt*lr-yt*gt,ne=Me*pe-Ue*nr,_e=Me*lr-yt*nr,Oe=Ue*lr-yt*pe;return Ur*Oe-Hr*_e+un*ne+bn*it-Gn*Zt+li*$r}function H(M,W,ue){var X=W[0],ie=W[1],ye=W[2],J=W[3],ht=W[4],ze=W[5],pt=W[6],Me=W[7],Ue=W[8],yt=W[9],gt=W[10],nr=W[11],pe=W[12],lr=W[13],Ur=W[14],Hr=W[15],un=ue[0],bn=ue[1],Gn=ue[2],li=ue[3];return M[0]=un*X+bn*ht+Gn*Ue+li*pe,M[1]=un*ie+bn*ze+Gn*yt+li*lr,M[2]=un*ye+bn*pt+Gn*gt+li*Ur,M[3]=un*J+bn*Me+Gn*nr+li*Hr,un=ue[4],bn=ue[5],Gn=ue[6],li=ue[7],M[4]=un*X+bn*ht+Gn*Ue+li*pe,M[5]=un*ie+bn*ze+Gn*yt+li*lr,M[6]=un*ye+bn*pt+Gn*gt+li*Ur,M[7]=un*J+bn*Me+Gn*nr+li*Hr,un=ue[8],bn=ue[9],Gn=ue[10],li=ue[11],M[8]=un*X+bn*ht+Gn*Ue+li*pe,M[9]=un*ie+bn*ze+Gn*yt+li*lr,M[10]=un*ye+bn*pt+Gn*gt+li*Ur,M[11]=un*J+bn*Me+Gn*nr+li*Hr,un=ue[12],bn=ue[13],Gn=ue[14],li=ue[15],M[12]=un*X+bn*ht+Gn*Ue+li*pe,M[13]=un*ie+bn*ze+Gn*yt+li*lr,M[14]=un*ye+bn*pt+Gn*gt+li*Ur,M[15]=un*J+bn*Me+Gn*nr+li*Hr,M}function ce(M,W,ue){var X=ue[0],ie=ue[1],ye=ue[2],J,ht,ze,pt,Me,Ue,yt,gt,nr,pe,lr,Ur;return W===M?(M[12]=W[0]*X+W[4]*ie+W[8]*ye+W[12],M[13]=W[1]*X+W[5]*ie+W[9]*ye+W[13],M[14]=W[2]*X+W[6]*ie+W[10]*ye+W[14],M[15]=W[3]*X+W[7]*ie+W[11]*ye+W[15]):(J=W[0],ht=W[1],ze=W[2],pt=W[3],Me=W[4],Ue=W[5],yt=W[6],gt=W[7],nr=W[8],pe=W[9],lr=W[10],Ur=W[11],M[0]=J,M[1]=ht,M[2]=ze,M[3]=pt,M[4]=Me,M[5]=Ue,M[6]=yt,M[7]=gt,M[8]=nr,M[9]=pe,M[10]=lr,M[11]=Ur,M[12]=J*X+Me*ie+nr*ye+W[12],M[13]=ht*X+Ue*ie+pe*ye+W[13],M[14]=ze*X+yt*ie+lr*ye+W[14],M[15]=pt*X+gt*ie+Ur*ye+W[15]),M}function at(M,W,ue){var X=ue[0],ie=ue[1],ye=ue[2];return M[0]=W[0]*X,M[1]=W[1]*X,M[2]=W[2]*X,M[3]=W[3]*X,M[4]=W[4]*ie,M[5]=W[5]*ie,M[6]=W[6]*ie,M[7]=W[7]*ie,M[8]=W[8]*ye,M[9]=W[9]*ye,M[10]=W[10]*ye,M[11]=W[11]*ye,M[12]=W[12],M[13]=W[13],M[14]=W[14],M[15]=W[15],M}function rt(M,W,ue,X){var ie=X[0],ye=X[1],J=X[2],ht=Math.hypot(ie,ye,J),ze,pt,Me,Ue,yt,gt,nr,pe,lr,Ur,Hr,un,bn,Gn,li,$r,Zt,it,ne,_e,Oe,je,dt,Ut;return ht<v.Ib?null:(ht=1/ht,ie*=ht,ye*=ht,J*=ht,ze=Math.sin(ue),pt=Math.cos(ue),Me=1-pt,Ue=W[0],yt=W[1],gt=W[2],nr=W[3],pe=W[4],lr=W[5],Ur=W[6],Hr=W[7],un=W[8],bn=W[9],Gn=W[10],li=W[11],$r=ie*ie*Me+pt,Zt=ye*ie*Me+J*ze,it=J*ie*Me-ye*ze,ne=ie*ye*Me-J*ze,_e=ye*ye*Me+pt,Oe=J*ye*Me+ie*ze,je=ie*J*Me+ye*ze,dt=ye*J*Me-ie*ze,Ut=J*J*Me+pt,M[0]=Ue*$r+pe*Zt+un*it,M[1]=yt*$r+lr*Zt+bn*it,M[2]=gt*$r+Ur*Zt+Gn*it,M[3]=nr*$r+Hr*Zt+li*it,M[4]=Ue*ne+pe*_e+un*Oe,M[5]=yt*ne+lr*_e+bn*Oe,M[6]=gt*ne+Ur*_e+Gn*Oe,M[7]=nr*ne+Hr*_e+li*Oe,M[8]=Ue*je+pe*dt+un*Ut,M[9]=yt*je+lr*dt+bn*Ut,M[10]=gt*je+Ur*dt+Gn*Ut,M[11]=nr*je+Hr*dt+li*Ut,W!==M&&(M[12]=W[12],M[13]=W[13],M[14]=W[14],M[15]=W[15]),M)}function Re(M,W,ue){var X=Math.sin(ue),ie=Math.cos(ue),ye=W[4],J=W[5],ht=W[6],ze=W[7],pt=W[8],Me=W[9],Ue=W[10],yt=W[11];return W!==M&&(M[0]=W[0],M[1]=W[1],M[2]=W[2],M[3]=W[3],M[12]=W[12],M[13]=W[13],M[14]=W[14],M[15]=W[15]),M[4]=ye*ie+pt*X,M[5]=J*ie+Me*X,M[6]=ht*ie+Ue*X,M[7]=ze*ie+yt*X,M[8]=pt*ie-ye*X,M[9]=Me*ie-J*X,M[10]=Ue*ie-ht*X,M[11]=yt*ie-ze*X,M}function vt(M,W,ue){var X=Math.sin(ue),ie=Math.cos(ue),ye=W[0],J=W[1],ht=W[2],ze=W[3],pt=W[8],Me=W[9],Ue=W[10],yt=W[11];return W!==M&&(M[4]=W[4],M[5]=W[5],M[6]=W[6],M[7]=W[7],M[12]=W[12],M[13]=W[13],M[14]=W[14],M[15]=W[15]),M[0]=ye*ie-pt*X,M[1]=J*ie-Me*X,M[2]=ht*ie-Ue*X,M[3]=ze*ie-yt*X,M[8]=ye*X+pt*ie,M[9]=J*X+Me*ie,M[10]=ht*X+Ue*ie,M[11]=ze*X+yt*ie,M}function wt(M,W,ue){var X=Math.sin(ue),ie=Math.cos(ue),ye=W[0],J=W[1],ht=W[2],ze=W[3],pt=W[4],Me=W[5],Ue=W[6],yt=W[7];return W!==M&&(M[8]=W[8],M[9]=W[9],M[10]=W[10],M[11]=W[11],M[12]=W[12],M[13]=W[13],M[14]=W[14],M[15]=W[15]),M[0]=ye*ie+pt*X,M[1]=J*ie+Me*X,M[2]=ht*ie+Ue*X,M[3]=ze*ie+yt*X,M[4]=pt*ie-ye*X,M[5]=Me*ie-J*X,M[6]=Ue*ie-ht*X,M[7]=yt*ie-ze*X,M}function fe(M,W){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=W[0],M[13]=W[1],M[14]=W[2],M[15]=1,M}function $e(M,W){return M[0]=W[0],M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=W[1],M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=W[2],M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function re(M,W,ue){var X=ue[0],ie=ue[1],ye=ue[2],J=Math.hypot(X,ie,ye),ht,ze,pt;return J<v.Ib?null:(J=1/J,X*=J,ie*=J,ye*=J,ht=Math.sin(W),ze=Math.cos(W),pt=1-ze,M[0]=X*X*pt+ze,M[1]=ie*X*pt+ye*ht,M[2]=ye*X*pt-ie*ht,M[3]=0,M[4]=X*ie*pt-ye*ht,M[5]=ie*ie*pt+ze,M[6]=ye*ie*pt+X*ht,M[7]=0,M[8]=X*ye*pt+ie*ht,M[9]=ie*ye*pt-X*ht,M[10]=ye*ye*pt+ze,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M)}function Ge(M,W){var ue=Math.sin(W),X=Math.cos(W);return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=X,M[6]=ue,M[7]=0,M[8]=0,M[9]=-ue,M[10]=X,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function Qe(M,W){var ue=Math.sin(W),X=Math.cos(W);return M[0]=X,M[1]=0,M[2]=-ue,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=ue,M[9]=0,M[10]=X,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function Te(M,W){var ue=Math.sin(W),X=Math.cos(W);return M[0]=X,M[1]=ue,M[2]=0,M[3]=0,M[4]=-ue,M[5]=X,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function Le(M,W,ue){var X=W[0],ie=W[1],ye=W[2],J=W[3],ht=X+X,ze=ie+ie,pt=ye+ye,Me=X*ht,Ue=X*ze,yt=X*pt,gt=ie*ze,nr=ie*pt,pe=ye*pt,lr=J*ht,Ur=J*ze,Hr=J*pt;return M[0]=1-(gt+pe),M[1]=Ue+Hr,M[2]=yt-Ur,M[3]=0,M[4]=Ue-Hr,M[5]=1-(Me+pe),M[6]=nr+lr,M[7]=0,M[8]=yt+Ur,M[9]=nr-lr,M[10]=1-(Me+gt),M[11]=0,M[12]=ue[0],M[13]=ue[1],M[14]=ue[2],M[15]=1,M}function Ce(M,W){var ue=new v.WT(3),X=-W[0],ie=-W[1],ye=-W[2],J=W[3],ht=W[4],ze=W[5],pt=W[6],Me=W[7],Ue=X*X+ie*ie+ye*ye+J*J;return Ue>0?(ue[0]=(ht*J+Me*X+ze*ye-pt*ie)*2/Ue,ue[1]=(ze*J+Me*ie+pt*X-ht*ye)*2/Ue,ue[2]=(pt*J+Me*ye+ht*ie-ze*X)*2/Ue):(ue[0]=(ht*J+Me*X+ze*ye-pt*ie)*2,ue[1]=(ze*J+Me*ie+pt*X-ht*ye)*2,ue[2]=(pt*J+Me*ye+ht*ie-ze*X)*2),Le(M,W,ue),M}function Fe(M,W){return M[0]=W[12],M[1]=W[13],M[2]=W[14],M}function Ke(M,W){var ue=W[0],X=W[1],ie=W[2],ye=W[4],J=W[5],ht=W[6],ze=W[8],pt=W[9],Me=W[10];return M[0]=Math.hypot(ue,X,ie),M[1]=Math.hypot(ye,J,ht),M[2]=Math.hypot(ze,pt,Me),M}function qt(M,W){var ue=new v.WT(3);Ke(ue,W);var X=1/ue[0],ie=1/ue[1],ye=1/ue[2],J=W[0]*X,ht=W[1]*ie,ze=W[2]*ye,pt=W[4]*X,Me=W[5]*ie,Ue=W[6]*ye,yt=W[8]*X,gt=W[9]*ie,nr=W[10]*ye,pe=J+Me+nr,lr=0;return pe>0?(lr=Math.sqrt(pe+1)*2,M[3]=.25*lr,M[0]=(Ue-gt)/lr,M[1]=(yt-ze)/lr,M[2]=(ht-pt)/lr):J>Me&&J>nr?(lr=Math.sqrt(1+J-Me-nr)*2,M[3]=(Ue-gt)/lr,M[0]=.25*lr,M[1]=(ht+pt)/lr,M[2]=(yt+ze)/lr):Me>nr?(lr=Math.sqrt(1+Me-J-nr)*2,M[3]=(yt-ze)/lr,M[0]=(ht+pt)/lr,M[1]=.25*lr,M[2]=(Ue+gt)/lr):(lr=Math.sqrt(1+nr-J-Me)*2,M[3]=(ht-pt)/lr,M[0]=(yt+ze)/lr,M[1]=(Ue+gt)/lr,M[2]=.25*lr),M}function ir(M,W,ue,X){var ie=W[0],ye=W[1],J=W[2],ht=W[3],ze=ie+ie,pt=ye+ye,Me=J+J,Ue=ie*ze,yt=ie*pt,gt=ie*Me,nr=ye*pt,pe=ye*Me,lr=J*Me,Ur=ht*ze,Hr=ht*pt,un=ht*Me,bn=X[0],Gn=X[1],li=X[2];return M[0]=(1-(nr+lr))*bn,M[1]=(yt+un)*bn,M[2]=(gt-Hr)*bn,M[3]=0,M[4]=(yt-un)*Gn,M[5]=(1-(Ue+lr))*Gn,M[6]=(pe+Ur)*Gn,M[7]=0,M[8]=(gt+Hr)*li,M[9]=(pe-Ur)*li,M[10]=(1-(Ue+nr))*li,M[11]=0,M[12]=ue[0],M[13]=ue[1],M[14]=ue[2],M[15]=1,M}function Pe(M,W,ue,X,ie){var ye=W[0],J=W[1],ht=W[2],ze=W[3],pt=ye+ye,Me=J+J,Ue=ht+ht,yt=ye*pt,gt=ye*Me,nr=ye*Ue,pe=J*Me,lr=J*Ue,Ur=ht*Ue,Hr=ze*pt,un=ze*Me,bn=ze*Ue,Gn=X[0],li=X[1],$r=X[2],Zt=ie[0],it=ie[1],ne=ie[2],_e=(1-(pe+Ur))*Gn,Oe=(gt+bn)*Gn,je=(nr-un)*Gn,dt=(gt-bn)*li,Ut=(1-(yt+Ur))*li,ur=(lr+Hr)*li,lt=(nr+un)*$r,Nt=(lr-Hr)*$r,Sr=(1-(yt+pe))*$r;return M[0]=_e,M[1]=Oe,M[2]=je,M[3]=0,M[4]=dt,M[5]=Ut,M[6]=ur,M[7]=0,M[8]=lt,M[9]=Nt,M[10]=Sr,M[11]=0,M[12]=ue[0]+Zt-(_e*Zt+dt*it+lt*ne),M[13]=ue[1]+it-(Oe*Zt+Ut*it+Nt*ne),M[14]=ue[2]+ne-(je*Zt+ur*it+Sr*ne),M[15]=1,M}function Ne(M,W){var ue=W[0],X=W[1],ie=W[2],ye=W[3],J=ue+ue,ht=X+X,ze=ie+ie,pt=ue*J,Me=X*J,Ue=X*ht,yt=ie*J,gt=ie*ht,nr=ie*ze,pe=ye*J,lr=ye*ht,Ur=ye*ze;return M[0]=1-Ue-nr,M[1]=Me+Ur,M[2]=yt-lr,M[3]=0,M[4]=Me-Ur,M[5]=1-pt-nr,M[6]=gt+pe,M[7]=0,M[8]=yt+lr,M[9]=gt-pe,M[10]=1-pt-Ue,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function Xe(M,W,ue,X,ie,ye,J){var ht=1/(ue-W),ze=1/(ie-X),pt=1/(ye-J);return M[0]=ye*2*ht,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=ye*2*ze,M[6]=0,M[7]=0,M[8]=(ue+W)*ht,M[9]=(ie+X)*ze,M[10]=(J+ye)*pt,M[11]=-1,M[12]=0,M[13]=0,M[14]=J*ye*2*pt,M[15]=0,M}function kt(M,W,ue,X,ie){var ye=1/Math.tan(W/2),J;return M[0]=ye/ue,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=ye,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,ie!=null&&ie!==Infinity?(J=1/(X-ie),M[10]=(ie+X)*J,M[14]=2*ie*X*J):(M[10]=-1,M[14]=-2*X),M}var rr=kt;function me(M,W,ue,X,ie){var ye=1/Math.tan(W/2),J;return M[0]=ye/ue,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=ye,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,ie!=null&&ie!==Infinity?(J=1/(X-ie),M[10]=ie*J,M[14]=ie*X*J):(M[10]=-1,M[14]=-X),M}function et(M,W,ue,X){var ie=Math.tan(W.upDegrees*Math.PI/180),ye=Math.tan(W.downDegrees*Math.PI/180),J=Math.tan(W.leftDegrees*Math.PI/180),ht=Math.tan(W.rightDegrees*Math.PI/180),ze=2/(J+ht),pt=2/(ie+ye);return M[0]=ze,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=pt,M[6]=0,M[7]=0,M[8]=-((J-ht)*ze*.5),M[9]=(ie-ye)*pt*.5,M[10]=X/(ue-X),M[11]=-1,M[12]=0,M[13]=0,M[14]=X*ue/(ue-X),M[15]=0,M}function or(M,W,ue,X,ie,ye,J){var ht=1/(W-ue),ze=1/(X-ie),pt=1/(ye-J);return M[0]=-2*ht,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*ze,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=2*pt,M[11]=0,M[12]=(W+ue)*ht,M[13]=(ie+X)*ze,M[14]=(J+ye)*pt,M[15]=1,M}var on=or;function vr(M,W,ue,X,ie,ye,J){var ht=1/(W-ue),ze=1/(X-ie),pt=1/(ye-J);return M[0]=-2*ht,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*ze,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=pt,M[11]=0,M[12]=(W+ue)*ht,M[13]=(ie+X)*ze,M[14]=ye*pt,M[15]=1,M}function jr(M,W,ue,X){var ie,ye,J,ht,ze,pt,Me,Ue,yt,gt,nr=W[0],pe=W[1],lr=W[2],Ur=X[0],Hr=X[1],un=X[2],bn=ue[0],Gn=ue[1],li=ue[2];return Math.abs(nr-bn)<v.Ib&&Math.abs(pe-Gn)<v.Ib&&Math.abs(lr-li)<v.Ib?D(M):(Me=nr-bn,Ue=pe-Gn,yt=lr-li,gt=1/Math.hypot(Me,Ue,yt),Me*=gt,Ue*=gt,yt*=gt,ie=Hr*yt-un*Ue,ye=un*Me-Ur*yt,J=Ur*Ue-Hr*Me,gt=Math.hypot(ie,ye,J),gt?(gt=1/gt,ie*=gt,ye*=gt,J*=gt):(ie=0,ye=0,J=0),ht=Ue*J-yt*ye,ze=yt*ie-Me*J,pt=Me*ye-Ue*ie,gt=Math.hypot(ht,ze,pt),gt?(gt=1/gt,ht*=gt,ze*=gt,pt*=gt):(ht=0,ze=0,pt=0),M[0]=ie,M[1]=ht,M[2]=Me,M[3]=0,M[4]=ye,M[5]=ze,M[6]=Ue,M[7]=0,M[8]=J,M[9]=pt,M[10]=yt,M[11]=0,M[12]=-(ie*nr+ye*pe+J*lr),M[13]=-(ht*nr+ze*pe+pt*lr),M[14]=-(Me*nr+Ue*pe+yt*lr),M[15]=1,M)}function xr(M,W,ue,X){var ie=W[0],ye=W[1],J=W[2],ht=X[0],ze=X[1],pt=X[2],Me=ie-ue[0],Ue=ye-ue[1],yt=J-ue[2],gt=Me*Me+Ue*Ue+yt*yt;gt>0&&(gt=1/Math.sqrt(gt),Me*=gt,Ue*=gt,yt*=gt);var nr=ze*yt-pt*Ue,pe=pt*Me-ht*yt,lr=ht*Ue-ze*Me;return gt=nr*nr+pe*pe+lr*lr,gt>0&&(gt=1/Math.sqrt(gt),nr*=gt,pe*=gt,lr*=gt),M[0]=nr,M[1]=pe,M[2]=lr,M[3]=0,M[4]=Ue*lr-yt*pe,M[5]=yt*nr-Me*lr,M[6]=Me*pe-Ue*nr,M[7]=0,M[8]=Me,M[9]=Ue,M[10]=yt,M[11]=0,M[12]=ie,M[13]=ye,M[14]=J,M[15]=1,M}function Ae(M){return"mat4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+", "+M[4]+", "+M[5]+", "+M[6]+", "+M[7]+", "+M[8]+", "+M[9]+", "+M[10]+", "+M[11]+", "+M[12]+", "+M[13]+", "+M[14]+", "+M[15]+")"}function De(M){return Math.hypot(M[0],M[1],M[2],M[3],M[4],M[5],M[6],M[7],M[8],M[9],M[10],M[11],M[12],M[13],M[14],M[15])}function ke(M,W,ue){return M[0]=W[0]+ue[0],M[1]=W[1]+ue[1],M[2]=W[2]+ue[2],M[3]=W[3]+ue[3],M[4]=W[4]+ue[4],M[5]=W[5]+ue[5],M[6]=W[6]+ue[6],M[7]=W[7]+ue[7],M[8]=W[8]+ue[8],M[9]=W[9]+ue[9],M[10]=W[10]+ue[10],M[11]=W[11]+ue[11],M[12]=W[12]+ue[12],M[13]=W[13]+ue[13],M[14]=W[14]+ue[14],M[15]=W[15]+ue[15],M}function Bt(M,W,ue){return M[0]=W[0]-ue[0],M[1]=W[1]-ue[1],M[2]=W[2]-ue[2],M[3]=W[3]-ue[3],M[4]=W[4]-ue[4],M[5]=W[5]-ue[5],M[6]=W[6]-ue[6],M[7]=W[7]-ue[7],M[8]=W[8]-ue[8],M[9]=W[9]-ue[9],M[10]=W[10]-ue[10],M[11]=W[11]-ue[11],M[12]=W[12]-ue[12],M[13]=W[13]-ue[13],M[14]=W[14]-ue[14],M[15]=W[15]-ue[15],M}function mt(M,W,ue){return M[0]=W[0]*ue,M[1]=W[1]*ue,M[2]=W[2]*ue,M[3]=W[3]*ue,M[4]=W[4]*ue,M[5]=W[5]*ue,M[6]=W[6]*ue,M[7]=W[7]*ue,M[8]=W[8]*ue,M[9]=W[9]*ue,M[10]=W[10]*ue,M[11]=W[11]*ue,M[12]=W[12]*ue,M[13]=W[13]*ue,M[14]=W[14]*ue,M[15]=W[15]*ue,M}function Mr(M,W,ue,X){return M[0]=W[0]+ue[0]*X,M[1]=W[1]+ue[1]*X,M[2]=W[2]+ue[2]*X,M[3]=W[3]+ue[3]*X,M[4]=W[4]+ue[4]*X,M[5]=W[5]+ue[5]*X,M[6]=W[6]+ue[6]*X,M[7]=W[7]+ue[7]*X,M[8]=W[8]+ue[8]*X,M[9]=W[9]+ue[9]*X,M[10]=W[10]+ue[10]*X,M[11]=W[11]+ue[11]*X,M[12]=W[12]+ue[12]*X,M[13]=W[13]+ue[13]*X,M[14]=W[14]+ue[14]*X,M[15]=W[15]+ue[15]*X,M}function Cr(M,W){return M[0]===W[0]&&M[1]===W[1]&&M[2]===W[2]&&M[3]===W[3]&&M[4]===W[4]&&M[5]===W[5]&&M[6]===W[6]&&M[7]===W[7]&&M[8]===W[8]&&M[9]===W[9]&&M[10]===W[10]&&M[11]===W[11]&&M[12]===W[12]&&M[13]===W[13]&&M[14]===W[14]&&M[15]===W[15]}function Nr(M,W){var ue=M[0],X=M[1],ie=M[2],ye=M[3],J=M[4],ht=M[5],ze=M[6],pt=M[7],Me=M[8],Ue=M[9],yt=M[10],gt=M[11],nr=M[12],pe=M[13],lr=M[14],Ur=M[15],Hr=W[0],un=W[1],bn=W[2],Gn=W[3],li=W[4],$r=W[5],Zt=W[6],it=W[7],ne=W[8],_e=W[9],Oe=W[10],je=W[11],dt=W[12],Ut=W[13],ur=W[14],lt=W[15];return Math.abs(ue-Hr)<=v.Ib*Math.max(1,Math.abs(ue),Math.abs(Hr))&&Math.abs(X-un)<=v.Ib*Math.max(1,Math.abs(X),Math.abs(un))&&Math.abs(ie-bn)<=v.Ib*Math.max(1,Math.abs(ie),Math.abs(bn))&&Math.abs(ye-Gn)<=v.Ib*Math.max(1,Math.abs(ye),Math.abs(Gn))&&Math.abs(J-li)<=v.Ib*Math.max(1,Math.abs(J),Math.abs(li))&&Math.abs(ht-$r)<=v.Ib*Math.max(1,Math.abs(ht),Math.abs($r))&&Math.abs(ze-Zt)<=v.Ib*Math.max(1,Math.abs(ze),Math.abs(Zt))&&Math.abs(pt-it)<=v.Ib*Math.max(1,Math.abs(pt),Math.abs(it))&&Math.abs(Me-ne)<=v.Ib*Math.max(1,Math.abs(Me),Math.abs(ne))&&Math.abs(Ue-_e)<=v.Ib*Math.max(1,Math.abs(Ue),Math.abs(_e))&&Math.abs(yt-Oe)<=v.Ib*Math.max(1,Math.abs(yt),Math.abs(Oe))&&Math.abs(gt-je)<=v.Ib*Math.max(1,Math.abs(gt),Math.abs(je))&&Math.abs(nr-dt)<=v.Ib*Math.max(1,Math.abs(nr),Math.abs(dt))&&Math.abs(pe-Ut)<=v.Ib*Math.max(1,Math.abs(pe),Math.abs(Ut))&&Math.abs(lr-ur)<=v.Ib*Math.max(1,Math.abs(lr),Math.abs(ur))&&Math.abs(Ur-lt)<=v.Ib*Math.max(1,Math.abs(Ur),Math.abs(lt))}var nt=H,Ye=Bt},98333:function(Ft,A,y){"use strict";y.d(A,{Ue:function(){return Z},al:function(){return P},bA:function(){return Re},fF:function(){return qt}});var v=y(49685);function Z(){var Ae=new v.WT(4);return v.WT!=Float32Array&&(Ae[0]=0,Ae[1]=0,Ae[2]=0,Ae[3]=0),Ae}function a(Ae){var De=new glMatrix.ARRAY_TYPE(4);return De[0]=Ae[0],De[1]=Ae[1],De[2]=Ae[2],De[3]=Ae[3],De}function P(Ae,De,ke,Bt){var mt=new v.WT(4);return mt[0]=Ae,mt[1]=De,mt[2]=ke,mt[3]=Bt,mt}function L(Ae,De){return Ae[0]=De[0],Ae[1]=De[1],Ae[2]=De[2],Ae[3]=De[3],Ae}function O(Ae,De,ke,Bt,mt){return Ae[0]=De,Ae[1]=ke,Ae[2]=Bt,Ae[3]=mt,Ae}function D(Ae,De,ke){return Ae[0]=De[0]+ke[0],Ae[1]=De[1]+ke[1],Ae[2]=De[2]+ke[2],Ae[3]=De[3]+ke[3],Ae}function B(Ae,De,ke){return Ae[0]=De[0]-ke[0],Ae[1]=De[1]-ke[1],Ae[2]=De[2]-ke[2],Ae[3]=De[3]-ke[3],Ae}function V(Ae,De,ke){return Ae[0]=De[0]*ke[0],Ae[1]=De[1]*ke[1],Ae[2]=De[2]*ke[2],Ae[3]=De[3]*ke[3],Ae}function N(Ae,De,ke){return Ae[0]=De[0]/ke[0],Ae[1]=De[1]/ke[1],Ae[2]=De[2]/ke[2],Ae[3]=De[3]/ke[3],Ae}function Y(Ae,De){return Ae[0]=Math.ceil(De[0]),Ae[1]=Math.ceil(De[1]),Ae[2]=Math.ceil(De[2]),Ae[3]=Math.ceil(De[3]),Ae}function H(Ae,De){return Ae[0]=Math.floor(De[0]),Ae[1]=Math.floor(De[1]),Ae[2]=Math.floor(De[2]),Ae[3]=Math.floor(De[3]),Ae}function ce(Ae,De,ke){return Ae[0]=Math.min(De[0],ke[0]),Ae[1]=Math.min(De[1],ke[1]),Ae[2]=Math.min(De[2],ke[2]),Ae[3]=Math.min(De[3],ke[3]),Ae}function at(Ae,De,ke){return Ae[0]=Math.max(De[0],ke[0]),Ae[1]=Math.max(De[1],ke[1]),Ae[2]=Math.max(De[2],ke[2]),Ae[3]=Math.max(De[3],ke[3]),Ae}function rt(Ae,De){return Ae[0]=Math.round(De[0]),Ae[1]=Math.round(De[1]),Ae[2]=Math.round(De[2]),Ae[3]=Math.round(De[3]),Ae}function Re(Ae,De,ke){return Ae[0]=De[0]*ke,Ae[1]=De[1]*ke,Ae[2]=De[2]*ke,Ae[3]=De[3]*ke,Ae}function vt(Ae,De,ke,Bt){return Ae[0]=De[0]+ke[0]*Bt,Ae[1]=De[1]+ke[1]*Bt,Ae[2]=De[2]+ke[2]*Bt,Ae[3]=De[3]+ke[3]*Bt,Ae}function wt(Ae,De){var ke=De[0]-Ae[0],Bt=De[1]-Ae[1],mt=De[2]-Ae[2],Mr=De[3]-Ae[3];return Math.hypot(ke,Bt,mt,Mr)}function fe(Ae,De){var ke=De[0]-Ae[0],Bt=De[1]-Ae[1],mt=De[2]-Ae[2],Mr=De[3]-Ae[3];return ke*ke+Bt*Bt+mt*mt+Mr*Mr}function $e(Ae){var De=Ae[0],ke=Ae[1],Bt=Ae[2],mt=Ae[3];return Math.hypot(De,ke,Bt,mt)}function re(Ae){var De=Ae[0],ke=Ae[1],Bt=Ae[2],mt=Ae[3];return De*De+ke*ke+Bt*Bt+mt*mt}function Ge(Ae,De){return Ae[0]=-De[0],Ae[1]=-De[1],Ae[2]=-De[2],Ae[3]=-De[3],Ae}function Qe(Ae,De){return Ae[0]=1/De[0],Ae[1]=1/De[1],Ae[2]=1/De[2],Ae[3]=1/De[3],Ae}function Te(Ae,De){var ke=De[0],Bt=De[1],mt=De[2],Mr=De[3],Cr=ke*ke+Bt*Bt+mt*mt+Mr*Mr;return Cr>0&&(Cr=1/Math.sqrt(Cr)),Ae[0]=ke*Cr,Ae[1]=Bt*Cr,Ae[2]=mt*Cr,Ae[3]=Mr*Cr,Ae}function Le(Ae,De){return Ae[0]*De[0]+Ae[1]*De[1]+Ae[2]*De[2]+Ae[3]*De[3]}function Ce(Ae,De,ke,Bt){var mt=ke[0]*Bt[1]-ke[1]*Bt[0],Mr=ke[0]*Bt[2]-ke[2]*Bt[0],Cr=ke[0]*Bt[3]-ke[3]*Bt[0],Nr=ke[1]*Bt[2]-ke[2]*Bt[1],nt=ke[1]*Bt[3]-ke[3]*Bt[1],Ye=ke[2]*Bt[3]-ke[3]*Bt[2],M=De[0],W=De[1],ue=De[2],X=De[3];return Ae[0]=W*Ye-ue*nt+X*Nr,Ae[1]=-(M*Ye)+ue*Cr-X*Mr,Ae[2]=M*nt-W*Cr+X*mt,Ae[3]=-(M*Nr)+W*Mr-ue*mt,Ae}function Fe(Ae,De,ke,Bt){var mt=De[0],Mr=De[1],Cr=De[2],Nr=De[3];return Ae[0]=mt+Bt*(ke[0]-mt),Ae[1]=Mr+Bt*(ke[1]-Mr),Ae[2]=Cr+Bt*(ke[2]-Cr),Ae[3]=Nr+Bt*(ke[3]-Nr),Ae}function Ke(Ae,De){De=De||1;var ke,Bt,mt,Mr,Cr,Nr;do ke=glMatrix.RANDOM()*2-1,Bt=glMatrix.RANDOM()*2-1,Cr=ke*ke+Bt*Bt;while(Cr>=1);do mt=glMatrix.RANDOM()*2-1,Mr=glMatrix.RANDOM()*2-1,Nr=mt*mt+Mr*Mr;while(Nr>=1);var nt=Math.sqrt((1-Cr)/Nr);return Ae[0]=De*ke,Ae[1]=De*Bt,Ae[2]=De*mt*nt,Ae[3]=De*Mr*nt,Ae}function qt(Ae,De,ke){var Bt=De[0],mt=De[1],Mr=De[2],Cr=De[3];return Ae[0]=ke[0]*Bt+ke[4]*mt+ke[8]*Mr+ke[12]*Cr,Ae[1]=ke[1]*Bt+ke[5]*mt+ke[9]*Mr+ke[13]*Cr,Ae[2]=ke[2]*Bt+ke[6]*mt+ke[10]*Mr+ke[14]*Cr,Ae[3]=ke[3]*Bt+ke[7]*mt+ke[11]*Mr+ke[15]*Cr,Ae}function ir(Ae,De,ke){var Bt=De[0],mt=De[1],Mr=De[2],Cr=ke[0],Nr=ke[1],nt=ke[2],Ye=ke[3],M=Ye*Bt+Nr*Mr-nt*mt,W=Ye*mt+nt*Bt-Cr*Mr,ue=Ye*Mr+Cr*mt-Nr*Bt,X=-Cr*Bt-Nr*mt-nt*Mr;return Ae[0]=M*Ye+X*-Cr+W*-nt-ue*-Nr,Ae[1]=W*Ye+X*-Nr+ue*-Cr-M*-nt,Ae[2]=ue*Ye+X*-nt+M*-Nr-W*-Cr,Ae[3]=De[3],Ae}function Pe(Ae){return Ae[0]=0,Ae[1]=0,Ae[2]=0,Ae[3]=0,Ae}function Ne(Ae){return"vec4("+Ae[0]+", "+Ae[1]+", "+Ae[2]+", "+Ae[3]+")"}function Xe(Ae,De){return Ae[0]===De[0]&&Ae[1]===De[1]&&Ae[2]===De[2]&&Ae[3]===De[3]}function kt(Ae,De){var ke=Ae[0],Bt=Ae[1],mt=Ae[2],Mr=Ae[3],Cr=De[0],Nr=De[1],nt=De[2],Ye=De[3];return Math.abs(ke-Cr)<=glMatrix.EPSILON*Math.max(1,Math.abs(ke),Math.abs(Cr))&&Math.abs(Bt-Nr)<=glMatrix.EPSILON*Math.max(1,Math.abs(Bt),Math.abs(Nr))&&Math.abs(mt-nt)<=glMatrix.EPSILON*Math.max(1,Math.abs(mt),Math.abs(nt))&&Math.abs(Mr-Ye)<=glMatrix.EPSILON*Math.max(1,Math.abs(Mr),Math.abs(Ye))}var rr=null,me=null,et=null,or=null,on=null,vr=null,jr=null,xr=function(){var Ae=Z();return function(De,ke,Bt,mt,Mr,Cr){var Nr,nt;for(ke||(ke=4),Bt||(Bt=0),mt?nt=Math.min(mt*ke+Bt,De.length):nt=De.length,Nr=Bt;Nr<nt;Nr+=ke)Ae[0]=De[Nr],Ae[1]=De[Nr+1],Ae[2]=De[Nr+2],Ae[3]=De[Nr+3],Mr(Ae,Ae,Cr),De[Nr]=Ae[0],De[Nr+1]=Ae[1],De[Nr+2]=Ae[2],De[Nr+3]=Ae[3];return De}}()},7375:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0});var y=Symbol.for("INJECTION");function v(O,D,B,V){function N(){return V&&!Reflect.hasMetadata(y,this,D)&&Reflect.defineMetadata(y,B(),this,D),Reflect.hasMetadata(y,this,D)?Reflect.getMetadata(y,this,D):B()}function Y(H){Reflect.defineMetadata(y,H,this,D)}Object.defineProperty(O,D,{configurable:!0,enumerable:!0,get:N,set:Y})}function Z(O,D){return function(B){return function(V,N){var Y=function(){return O.get(B)};v(V,N,Y,D)}}}A.makePropertyInjectDecorator=Z;function a(O,D){return function(B,V){return function(N,Y){var H=function(){return O.getNamed(B,V)};v(N,Y,H,D)}}}A.makePropertyInjectNamedDecorator=a;function P(O,D){return function(B,V,N){return function(Y,H){var ce=function(){return O.getTagged(B,V,N)};v(Y,H,ce,D)}}}A.makePropertyInjectTaggedDecorator=P;function L(O,D){return function(B){return function(V,N){var Y=function(){return O.getAll(B)};v(V,N,Y,D)}}}A.makePropertyMultiInjectDecorator=L},84879:function(Ft,A,y){"use strict";var v;v={value:!0};var Z=y(7375);function a(P,L){L===void 0&&(L=!0);var O=Z.makePropertyInjectDecorator(P,L),D=Z.makePropertyInjectNamedDecorator(P,L),B=Z.makePropertyInjectTaggedDecorator(P,L),V=Z.makePropertyMultiInjectDecorator(P,L);return{lazyInject:O,lazyInjectNamed:D,lazyInjectTagged:B,lazyMultiInject:V}}A.Z=a},99934:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.tagProperty=A.tagParameter=A.decorate=void 0;var v=y(16674),Z=y(6867);function a(V,N,Y,H){var ce=Z.TAGGED;L(ce,V,N,H,Y)}A.tagParameter=a;function P(V,N,Y){var H=Z.TAGGED_PROP;L(H,V.constructor,N,Y)}A.tagProperty=P;function L(V,N,Y,H,ce){var at={},rt=typeof ce=="number",Re=ce!==void 0&&rt?ce.toString():Y;if(rt&&Y!==void 0)throw new Error(v.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(V,N)&&(at=Reflect.getMetadata(V,N));var vt=at[Re];if(!Array.isArray(vt))vt=[];else for(var wt=0,fe=vt;wt<fe.length;wt++){var $e=fe[wt];if($e.key===H.key)throw new Error(v.DUPLICATED_METADATA+" "+$e.key.toString())}vt.push(H),at[Re]=vt,Reflect.defineMetadata(V,at,N)}function O(V,N){Reflect.decorate(V,N)}function D(V,N){return function(Y,H){N(Y,H,V)}}function B(V,N,Y){typeof Y=="number"?O([D(Y,V)],N):typeof Y=="string"?Reflect.decorate([V],N,Y):O([V],N)}A.decorate=B},5744:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.inject=A.LazyServiceIdentifer=void 0;var v=y(16674),Z=y(6867),a=y(47738),P=y(99934),L=function(){function D(B){this._cb=B}return D.prototype.unwrap=function(){return this._cb()},D}();A.LazyServiceIdentifer=L;function O(D){return function(B,V,N){if(D===void 0)throw new Error(v.UNDEFINED_INJECT_ANNOTATION(B.name));var Y=new a.Metadata(Z.INJECT_TAG,D);typeof N=="number"?P.tagParameter(B,V,N,Y):P.tagProperty(B,V,Y)}}A.inject=O},64315:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.injectable=void 0;var v=y(16674),Z=y(6867);function a(){return function(P){if(Reflect.hasOwnMetadata(Z.PARAM_TYPES,P))throw new Error(v.DUPLICATED_INJECTABLE_DECORATOR);var L=Reflect.getMetadata(Z.DESIGN_PARAM_TYPES,P)||[];return Reflect.defineMetadata(Z.PARAM_TYPES,L,P),P}}A.injectable=a},71693:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.multiInject=void 0;var v=y(6867),Z=y(47738),a=y(99934);function P(L){return function(O,D,B){var V=new Z.Metadata(v.MULTI_INJECT_TAG,L);typeof B=="number"?a.tagParameter(O,D,B,V):a.tagProperty(O,D,V)}}A.multiInject=P},38085:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.named=void 0;var v=y(6867),Z=y(47738),a=y(99934);function P(L){return function(O,D,B){var V=new Z.Metadata(v.NAMED_TAG,L);typeof B=="number"?a.tagParameter(O,D,B,V):a.tagProperty(O,D,V)}}A.named=P},6515:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.optional=void 0;var v=y(6867),Z=y(47738),a=y(99934);function P(){return function(L,O,D){var B=new Z.Metadata(v.OPTIONAL_TAG,!0);typeof D=="number"?a.tagParameter(L,O,D,B):a.tagProperty(L,O,B)}}A.optional=P},7014:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.postConstruct=void 0;var v=y(16674),Z=y(6867),a=y(47738);function P(){return function(L,O,D){var B=new a.Metadata(Z.POST_CONSTRUCT,O);if(Reflect.hasOwnMetadata(Z.POST_CONSTRUCT,L.constructor))throw new Error(v.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(Z.POST_CONSTRUCT,B,L.constructor)}}A.postConstruct=P},32052:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.tagged=void 0;var v=y(47738),Z=y(99934);function a(P,L){return function(O,D,B){var V=new v.Metadata(P,L);typeof B=="number"?Z.tagParameter(O,D,B,V):Z.tagProperty(O,D,V)}}A.tagged=a},55638:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.targetName=void 0;var v=y(6867),Z=y(47738),a=y(99934);function P(L){return function(O,D,B){var V=new Z.Metadata(v.NAME_TAG,L);a.tagParameter(O,D,B,V)}}A.targetName=P},86757:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.unmanaged=void 0;var v=y(6867),Z=y(47738),a=y(99934);function P(){return function(L,O,D){var B=new Z.Metadata(v.UNMANAGED_TAG,!0);a.tagParameter(L,O,D,B)}}A.unmanaged=P},44290:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Binding=void 0;var v=y(28421),Z=y(37791),a=function(){function P(L,O){this.id=Z.id(),this.activated=!1,this.serviceIdentifier=L,this.scope=O,this.type=v.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return P.prototype.clone=function(){var L=new P(this.serviceIdentifier,this.scope);return L.activated=L.scope===v.BindingScopeEnum.Singleton?this.activated:!1,L.implementationType=this.implementationType,L.dynamicValue=this.dynamicValue,L.scope=this.scope,L.type=this.type,L.factory=this.factory,L.provider=this.provider,L.constraint=this.constraint,L.onActivation=this.onActivation,L.cache=this.cache,L},P}();A.Binding=a},23184:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BindingCount=void 0;var y={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};A.BindingCount=y},16674:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.STACK_OVERFLOW=A.CIRCULAR_DEPENDENCY_IN_FACTORY=A.POST_CONSTRUCT_ERROR=A.MULTIPLE_POST_CONSTRUCT_METHODS=A.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=A.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=A.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=A.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=A.ARGUMENTS_LENGTH_MISMATCH=A.INVALID_DECORATOR_OPERATION=A.INVALID_TO_SELF_VALUE=A.INVALID_FUNCTION_BINDING=A.INVALID_MIDDLEWARE_RETURN=A.NO_MORE_SNAPSHOTS_AVAILABLE=A.INVALID_BINDING_TYPE=A.NOT_IMPLEMENTED=A.CIRCULAR_DEPENDENCY=A.UNDEFINED_INJECT_ANNOTATION=A.MISSING_INJECT_ANNOTATION=A.MISSING_INJECTABLE_ANNOTATION=A.NOT_REGISTERED=A.CANNOT_UNBIND=A.AMBIGUOUS_MATCH=A.KEY_NOT_FOUND=A.NULL_ARGUMENT=A.DUPLICATED_METADATA=A.DUPLICATED_INJECTABLE_DECORATOR=void 0,A.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",A.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",A.NULL_ARGUMENT="NULL argument",A.KEY_NOT_FOUND="Key Not Found",A.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",A.CANNOT_UNBIND="Could not unbind serviceIdentifier:",A.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",A.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",A.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var y=function(P){return"@inject called with undefined this could mean that the class "+P+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};A.UNDEFINED_INJECT_ANNOTATION=y,A.CIRCULAR_DEPENDENCY="Circular dependency found:",A.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",A.INVALID_BINDING_TYPE="Invalid binding type:",A.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",A.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",A.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",A.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",A.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var v=function(){for(var P=[],L=0;L<arguments.length;L++)P[L]=arguments[L];return"The number of constructor arguments in the derived class "+(P[0]+" must be >= than the number of constructor arguments of its base class.")};A.ARGUMENTS_LENGTH_MISMATCH=v,A.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",A.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",A.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",A.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",A.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var Z=function(){for(var P=[],L=0;L<arguments.length;L++)P[L]=arguments[L];return"@postConstruct error in class "+P[0]+": "+P[1]};A.POST_CONSTRUCT_ERROR=Z;var a=function(){for(var P=[],L=0;L<arguments.length;L++)P[L]=arguments[L];return"It looks like there is a circular dependency "+("in one of the '"+P[0]+"' bindings. Please investigate bindings with")+("service identifier '"+P[1]+"'.")};A.CIRCULAR_DEPENDENCY_IN_FACTORY=a,A.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.TargetTypeEnum=A.BindingTypeEnum=A.BindingScopeEnum=void 0;var y={Request:"Request",Singleton:"Singleton",Transient:"Transient"};A.BindingScopeEnum=y;var v={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};A.BindingTypeEnum=v;var Z={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};A.TargetTypeEnum=Z},6867:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.NON_CUSTOM_TAG_KEYS=A.POST_CONSTRUCT=A.DESIGN_PARAM_TYPES=A.PARAM_TYPES=A.TAGGED_PROP=A.TAGGED=A.MULTI_INJECT_TAG=A.INJECT_TAG=A.OPTIONAL_TAG=A.UNMANAGED_TAG=A.NAME_TAG=A.NAMED_TAG=void 0,A.NAMED_TAG="named",A.NAME_TAG="name",A.UNMANAGED_TAG="unmanaged",A.OPTIONAL_TAG="optional",A.INJECT_TAG="inject",A.MULTI_INJECT_TAG="multi_inject",A.TAGGED="inversify:tagged",A.TAGGED_PROP="inversify:tagged_props",A.PARAM_TYPES="inversify:paramtypes",A.DESIGN_PARAM_TYPES="design:paramtypes",A.POST_CONSTRUCT="post_construct";function y(){return[A.INJECT_TAG,A.MULTI_INJECT_TAG,A.NAME_TAG,A.UNMANAGED_TAG,A.NAMED_TAG,A.OPTIONAL_TAG]}A.NON_CUSTOM_TAG_KEYS=y()},51389:function(Ft,A,y){"use strict";var v=this&&this.__awaiter||function(vt,wt,fe,$e){function re(Ge){return Ge instanceof fe?Ge:new fe(function(Qe){Qe(Ge)})}return new(fe||(fe=Promise))(function(Ge,Qe){function Te(Fe){try{Ce($e.next(Fe))}catch(Ke){Qe(Ke)}}function Le(Fe){try{Ce($e.throw(Fe))}catch(Ke){Qe(Ke)}}function Ce(Fe){Fe.done?Ge(Fe.value):re(Fe.value).then(Te,Le)}Ce(($e=$e.apply(vt,wt||[])).next())})},Z=this&&this.__generator||function(vt,wt){var fe={label:0,sent:function(){if(Ge[0]&1)throw Ge[1];return Ge[1]},trys:[],ops:[]},$e,re,Ge,Qe;return Qe={next:Te(0),throw:Te(1),return:Te(2)},typeof Symbol=="function"&&(Qe[Symbol.iterator]=function(){return this}),Qe;function Te(Ce){return function(Fe){return Le([Ce,Fe])}}function Le(Ce){if($e)throw new TypeError("Generator is already executing.");for(;fe;)try{if($e=1,re&&(Ge=Ce[0]&2?re.return:Ce[0]?re.throw||((Ge=re.return)&&Ge.call(re),0):re.next)&&!(Ge=Ge.call(re,Ce[1])).done)return Ge;switch(re=0,Ge&&(Ce=[Ce[0]&2,Ge.value]),Ce[0]){case 0:case 1:Ge=Ce;break;case 4:return fe.label++,{value:Ce[1],done:!1};case 5:fe.label++,re=Ce[1],Ce=[0];continue;case 7:Ce=fe.ops.pop(),fe.trys.pop();continue;default:if(Ge=fe.trys,!(Ge=Ge.length>0&&Ge[Ge.length-1])&&(Ce[0]===6||Ce[0]===2)){fe=0;continue}if(Ce[0]===3&&(!Ge||Ce[1]>Ge[0]&&Ce[1]<Ge[3])){fe.label=Ce[1];break}if(Ce[0]===6&&fe.label<Ge[1]){fe.label=Ge[1],Ge=Ce;break}if(Ge&&fe.label<Ge[2]){fe.label=Ge[2],fe.ops.push(Ce);break}Ge[2]&&fe.ops.pop(),fe.trys.pop();continue}Ce=wt.call(vt,fe)}catch(Fe){Ce=[6,Fe],re=0}finally{$e=Ge=0}if(Ce[0]&5)throw Ce[1];return{value:Ce[0]?Ce[1]:void 0,done:!0}}},a=this&&this.__spreadArray||function(vt,wt){for(var fe=0,$e=wt.length,re=vt.length;fe<$e;fe++,re++)vt[re]=wt[fe];return vt};Object.defineProperty(A,"__esModule",{value:!0}),A.Container=void 0;var P=y(44290),L=y(16674),O=y(28421),D=y(6867),B=y(51377),V=y(86311),N=y(31927),Y=y(51860),H=y(37791),ce=y(55800),at=y(85700),rt=y(80175),Re=function(){function vt(wt){this._appliedMiddleware=[];var fe=wt||{};if(typeof fe!="object")throw new Error(""+L.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(fe.defaultScope===void 0)fe.defaultScope=O.BindingScopeEnum.Transient;else if(fe.defaultScope!==O.BindingScopeEnum.Singleton&&fe.defaultScope!==O.BindingScopeEnum.Transient&&fe.defaultScope!==O.BindingScopeEnum.Request)throw new Error(""+L.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(fe.autoBindInjectable===void 0)fe.autoBindInjectable=!1;else if(typeof fe.autoBindInjectable!="boolean")throw new Error(""+L.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(fe.skipBaseClassChecks===void 0)fe.skipBaseClassChecks=!1;else if(typeof fe.skipBaseClassChecks!="boolean")throw new Error(""+L.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:fe.autoBindInjectable,defaultScope:fe.defaultScope,skipBaseClassChecks:fe.skipBaseClassChecks},this.id=H.id(),this._bindingDictionary=new rt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new B.MetadataReader}return vt.merge=function(wt,fe){for(var $e=[],re=2;re<arguments.length;re++)$e[re-2]=arguments[re];var Ge=new vt,Qe=a([wt,fe],$e).map(function(Ce){return V.getBindingDictionary(Ce)}),Te=V.getBindingDictionary(Ge);function Le(Ce,Fe){Ce.traverse(function(Ke,qt){qt.forEach(function(ir){Fe.add(ir.serviceIdentifier,ir.clone())})})}return Qe.forEach(function(Ce){Le(Ce,Te)}),Ge},vt.prototype.load=function(){for(var wt=[],fe=0;fe<arguments.length;fe++)wt[fe]=arguments[fe];for(var $e=this._getContainerModuleHelpersFactory(),re=0,Ge=wt;re<Ge.length;re++){var Qe=Ge[re],Te=$e(Qe.id);Qe.registry(Te.bindFunction,Te.unbindFunction,Te.isboundFunction,Te.rebindFunction)}},vt.prototype.loadAsync=function(){for(var wt=[],fe=0;fe<arguments.length;fe++)wt[fe]=arguments[fe];return v(this,void 0,void 0,function(){var $e,re,Ge,Qe,Te;return Z(this,function(Le){switch(Le.label){case 0:$e=this._getContainerModuleHelpersFactory(),re=0,Ge=wt,Le.label=1;case 1:return re<Ge.length?(Qe=Ge[re],Te=$e(Qe.id),[4,Qe.registry(Te.bindFunction,Te.unbindFunction,Te.isboundFunction,Te.rebindFunction)]):[3,4];case 2:Le.sent(),Le.label=3;case 3:return re++,[3,1];case 4:return[2]}})})},vt.prototype.unload=function(){for(var wt=this,fe=[],$e=0;$e<arguments.length;$e++)fe[$e]=arguments[$e];var re=function(Ge){return function(Qe){return Qe.moduleId===Ge}};fe.forEach(function(Ge){var Qe=re(Ge.id);wt._bindingDictionary.removeByCondition(Qe)})},vt.prototype.bind=function(wt){var fe=this.options.defaultScope||O.BindingScopeEnum.Transient,$e=new P.Binding(wt,fe);return this._bindingDictionary.add(wt,$e),new Y.BindingToSyntax($e)},vt.prototype.rebind=function(wt){return this.unbind(wt),this.bind(wt)},vt.prototype.unbind=function(wt){try{this._bindingDictionary.remove(wt)}catch(fe){throw new Error(L.CANNOT_UNBIND+" "+ce.getServiceIdentifierAsString(wt))}},vt.prototype.unbindAll=function(){this._bindingDictionary=new rt.Lookup},vt.prototype.isBound=function(wt){var fe=this._bindingDictionary.hasKey(wt);return!fe&&this.parent&&(fe=this.parent.isBound(wt)),fe},vt.prototype.isBoundNamed=function(wt,fe){return this.isBoundTagged(wt,D.NAMED_TAG,fe)},vt.prototype.isBoundTagged=function(wt,fe,$e){var re=!1;if(this._bindingDictionary.hasKey(wt)){var Ge=this._bindingDictionary.get(wt),Qe=V.createMockRequest(this,wt,fe,$e);re=Ge.some(function(Te){return Te.constraint(Qe)})}return!re&&this.parent&&(re=this.parent.isBoundTagged(wt,fe,$e)),re},vt.prototype.snapshot=function(){this._snapshots.push(at.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},vt.prototype.restore=function(){var wt=this._snapshots.pop();if(wt===void 0)throw new Error(L.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=wt.bindings,this._middleware=wt.middleware},vt.prototype.createChild=function(wt){var fe=new vt(wt||this.options);return fe.parent=this,fe},vt.prototype.applyMiddleware=function(){for(var wt=[],fe=0;fe<arguments.length;fe++)wt[fe]=arguments[fe];this._appliedMiddleware=this._appliedMiddleware.concat(wt);var $e=this._middleware?this._middleware:this._planAndResolve();this._middleware=wt.reduce(function(re,Ge){return Ge(re)},$e)},vt.prototype.applyCustomMetadataReader=function(wt){this._metadataReader=wt},vt.prototype.get=function(wt){return this._get(!1,!1,O.TargetTypeEnum.Variable,wt)},vt.prototype.getTagged=function(wt,fe,$e){return this._get(!1,!1,O.TargetTypeEnum.Variable,wt,fe,$e)},vt.prototype.getNamed=function(wt,fe){return this.getTagged(wt,D.NAMED_TAG,fe)},vt.prototype.getAll=function(wt){return this._get(!0,!0,O.TargetTypeEnum.Variable,wt)},vt.prototype.getAllTagged=function(wt,fe,$e){return this._get(!1,!0,O.TargetTypeEnum.Variable,wt,fe,$e)},vt.prototype.getAllNamed=function(wt,fe){return this.getAllTagged(wt,D.NAMED_TAG,fe)},vt.prototype.resolve=function(wt){var fe=this.createChild();return fe.bind(wt).toSelf(),this._appliedMiddleware.forEach(function($e){fe.applyMiddleware($e)}),fe.get(wt)},vt.prototype._getContainerModuleHelpersFactory=function(){var wt=this,fe=function(Te,Le){Te._binding.moduleId=Le},$e=function(Te){return function(Le){var Ce=wt.bind.bind(wt),Fe=Ce(Le);return fe(Fe,Te),Fe}},re=function(Te){return function(Le){var Ce=wt.unbind.bind(wt);Ce(Le)}},Ge=function(Te){return function(Le){var Ce=wt.isBound.bind(wt);return Ce(Le)}},Qe=function(Te){return function(Le){var Ce=wt.rebind.bind(wt),Fe=Ce(Le);return fe(Fe,Te),Fe}};return function(Te){return{bindFunction:$e(Te),isboundFunction:Ge(Te),rebindFunction:Qe(Te),unbindFunction:re(Te)}}},vt.prototype._get=function(wt,fe,$e,re,Ge,Qe){var Te=null,Le={avoidConstraints:wt,contextInterceptor:function(Ce){return Ce},isMultiInject:fe,key:Ge,serviceIdentifier:re,targetType:$e,value:Qe};if(this._middleware){if(Te=this._middleware(Le),Te==null)throw new Error(L.INVALID_MIDDLEWARE_RETURN)}else Te=this._planAndResolve()(Le);return Te},vt.prototype._planAndResolve=function(){var wt=this;return function(fe){var $e=V.plan(wt._metadataReader,wt,fe.isMultiInject,fe.targetType,fe.serviceIdentifier,fe.key,fe.value,fe.avoidConstraints);$e=fe.contextInterceptor($e);var re=N.resolve($e);return re}},vt}();A.Container=Re},33244:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.AsyncContainerModule=A.ContainerModule=void 0;var v=y(37791),Z=function(){function P(L){this.id=v.id(),this.registry=L}return P}();A.ContainerModule=Z;var a=function(){function P(L){this.id=v.id(),this.registry=L}return P}();A.AsyncContainerModule=a},85700:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ContainerSnapshot=void 0;var y=function(){function v(){}return v.of=function(Z,a){var P=new v;return P.bindings=Z,P.middleware=a,P},v}();A.ContainerSnapshot=y},80175:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Lookup=void 0;var v=y(16674),Z=function(){function a(){this._map=new Map}return a.prototype.getMap=function(){return this._map},a.prototype.add=function(P,L){if(P==null)throw new Error(v.NULL_ARGUMENT);if(L==null)throw new Error(v.NULL_ARGUMENT);var O=this._map.get(P);O!==void 0?(O.push(L),this._map.set(P,O)):this._map.set(P,[L])},a.prototype.get=function(P){if(P==null)throw new Error(v.NULL_ARGUMENT);var L=this._map.get(P);if(L!==void 0)return L;throw new Error(v.KEY_NOT_FOUND)},a.prototype.remove=function(P){if(P==null)throw new Error(v.NULL_ARGUMENT);if(!this._map.delete(P))throw new Error(v.KEY_NOT_FOUND)},a.prototype.removeByCondition=function(P){var L=this;this._map.forEach(function(O,D){var B=O.filter(function(V){return!P(V)});B.length>0?L._map.set(D,B):L._map.delete(D)})},a.prototype.hasKey=function(P){if(P==null)throw new Error(v.NULL_ARGUMENT);return this._map.has(P)},a.prototype.clone=function(){var P=new a;return this._map.forEach(function(L,O){L.forEach(function(D){return P.add(O,D.clone())})}),P},a.prototype.traverse=function(P){this._map.forEach(function(L,O){P(O,L)})},a}();A.Lookup=Z},86700:function(Ft,A,y){"use strict";var v;v={value:!0},v=v=v=v=v=v=A.GW=v=v=A.zY=v=v=v=v=v=A.f3=v=v=A.b2=v=v=v=v=v=A.W2=v=void 0;var Z=y(6867);v=Z;var a=y(51389);Object.defineProperty(A,"W2",{enumerable:!0,get:function(){return a.Container}});var P=y(28421);v={enumerable:!0,get:function(){return P.BindingScopeEnum}},v={enumerable:!0,get:function(){return P.BindingTypeEnum}},v={enumerable:!0,get:function(){return P.TargetTypeEnum}};var L=y(33244);v={enumerable:!0,get:function(){return L.AsyncContainerModule}},v={enumerable:!0,get:function(){return L.ContainerModule}};var O=y(64315);Object.defineProperty(A,"b2",{enumerable:!0,get:function(){return O.injectable}});var D=y(32052);v={enumerable:!0,get:function(){return D.tagged}};var B=y(38085);v={enumerable:!0,get:function(){return B.named}};var V=y(5744);Object.defineProperty(A,"f3",{enumerable:!0,get:function(){return V.inject}}),v={enumerable:!0,get:function(){return V.LazyServiceIdentifer}};var N=y(6515);v={enumerable:!0,get:function(){return N.optional}};var Y=y(86757);v={enumerable:!0,get:function(){return Y.unmanaged}};var H=y(71693);v={enumerable:!0,get:function(){return H.multiInject}};var ce=y(55638);v={enumerable:!0,get:function(){return ce.targetName}};var at=y(7014);Object.defineProperty(A,"zY",{enumerable:!0,get:function(){return at.postConstruct}});var rt=y(51377);v={enumerable:!0,get:function(){return rt.MetadataReader}};var Re=y(37791);v={enumerable:!0,get:function(){return Re.id}};var vt=y(99934);Object.defineProperty(A,"GW",{enumerable:!0,get:function(){return vt.decorate}});var wt=y(84164);v={enumerable:!0,get:function(){return wt.traverseAncerstors}},v={enumerable:!0,get:function(){return wt.taggedConstraint}},v={enumerable:!0,get:function(){return wt.namedConstraint}},v={enumerable:!0,get:function(){return wt.typeConstraint}};var fe=y(55800);v={enumerable:!0,get:function(){return fe.getServiceIdentifierAsString}};var $e=y(70600);v={enumerable:!0,get:function(){return $e.multiBindToService}}},95228:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Context=void 0;var v=y(37791),Z=function(){function a(P){this.id=v.id(),this.container=P}return a.prototype.addPlan=function(P){this.plan=P},a.prototype.setCurrentRequest=function(P){this.currentRequest=P},a}();A.Context=Z},47738:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Metadata=void 0;var v=y(6867),Z=function(){function a(P,L){this.key=P,this.value=L}return a.prototype.toString=function(){return this.key===v.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},a}();A.Metadata=Z},51377:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.MetadataReader=void 0;var v=y(6867),Z=function(){function a(){}return a.prototype.getConstructorMetadata=function(P){var L=Reflect.getMetadata(v.PARAM_TYPES,P),O=Reflect.getMetadata(v.TAGGED,P);return{compilerGeneratedMetadata:L,userGeneratedMetadata:O||{}}},a.prototype.getPropertiesMetadata=function(P){var L=Reflect.getMetadata(v.TAGGED_PROP,P)||[];return L},a}();A.MetadataReader=Z},55314:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Plan=void 0;var y=function(){function v(Z,a){this.parentContext=Z,this.rootRequest=a}return v}();A.Plan=y},86311:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.getBindingDictionary=A.createMockRequest=A.plan=void 0;var v=y(23184),Z=y(16674),a=y(28421),P=y(6867),L=y(85265),O=y(55800),D=y(95228),B=y(47738),V=y(55314),N=y(6e3),Y=y(6748),H=y(18924);function ce(re){return re._bindingDictionary}A.getBindingDictionary=ce;function at(re,Ge,Qe,Te,Le,Ce){var Fe=re?P.MULTI_INJECT_TAG:P.INJECT_TAG,Ke=new B.Metadata(Fe,Qe),qt=new H.Target(Ge,Te,Qe,Ke);if(Le!==void 0){var ir=new B.Metadata(Le,Ce);qt.metadata.push(ir)}return qt}function rt(re,Ge,Qe,Te,Le){var Ce=wt(Qe.container,Le.serviceIdentifier),Fe=[];return Ce.length===v.BindingCount.NoBindingsAvailable&&Qe.container.options.autoBindInjectable&&typeof Le.serviceIdentifier=="function"&&re.getConstructorMetadata(Le.serviceIdentifier).compilerGeneratedMetadata&&(Qe.container.bind(Le.serviceIdentifier).toSelf(),Ce=wt(Qe.container,Le.serviceIdentifier)),Ge?Fe=Ce:Fe=Ce.filter(function(Ke){var qt=new Y.Request(Ke.serviceIdentifier,Qe,Te,Ke,Le);return Ke.constraint(qt)}),Re(Le.serviceIdentifier,Fe,Le,Qe.container),Fe}function Re(re,Ge,Qe,Te){switch(Ge.length){case v.BindingCount.NoBindingsAvailable:if(Qe.isOptional())return Ge;var Le=O.getServiceIdentifierAsString(re),Ce=Z.NOT_REGISTERED;throw Ce+=O.listMetadataForTarget(Le,Qe),Ce+=O.listRegisteredBindingsForServiceIdentifier(Te,Le,wt),new Error(Ce);case v.BindingCount.OnlyOneBindingAvailable:if(!Qe.isArray())return Ge;case v.BindingCount.MultipleBindingsAvailable:default:if(Qe.isArray())return Ge;var Le=O.getServiceIdentifierAsString(re),Ce=Z.AMBIGUOUS_MATCH+" "+Le;throw Ce+=O.listRegisteredBindingsForServiceIdentifier(Te,Le,wt),new Error(Ce)}}function vt(re,Ge,Qe,Te,Le,Ce){var Fe,Ke;if(Le===null){Fe=rt(re,Ge,Te,null,Ce),Ke=new Y.Request(Qe,Te,null,Fe,Ce);var qt=new V.Plan(Te,Ke);Te.addPlan(qt)}else Fe=rt(re,Ge,Te,Le,Ce),Ke=Le.addChildRequest(Ce.serviceIdentifier,Fe,Ce);Fe.forEach(function(ir){var Pe=null;if(Ce.isArray())Pe=Ke.addChildRequest(ir.serviceIdentifier,ir,Ce);else{if(ir.cache)return;Pe=Ke}if(ir.type===a.BindingTypeEnum.Instance&&ir.implementationType!==null){var Ne=N.getDependencies(re,ir.implementationType);if(!Te.container.options.skipBaseClassChecks){var Xe=N.getBaseClassDependencyCount(re,ir.implementationType);if(Ne.length<Xe){var kt=Z.ARGUMENTS_LENGTH_MISMATCH(N.getFunctionName(ir.implementationType));throw new Error(kt)}}Ne.forEach(function(rr){vt(re,!1,rr.serviceIdentifier,Te,Pe,rr)})}})}function wt(re,Ge){var Qe=[],Te=ce(re);return Te.hasKey(Ge)?Qe=Te.get(Ge):re.parent!==null&&(Qe=wt(re.parent,Ge)),Qe}function fe(re,Ge,Qe,Te,Le,Ce,Fe,Ke){Ke===void 0&&(Ke=!1);var qt=new D.Context(Ge),ir=at(Qe,Te,Le,"",Ce,Fe);try{return vt(re,Ke,Le,qt,null,ir),qt}catch(Pe){throw L.isStackOverflowExeption(Pe)&&qt.plan&&O.circularDependencyToException(qt.plan.rootRequest),Pe}}A.plan=fe;function $e(re,Ge,Qe,Te){var Le=new H.Target(a.TargetTypeEnum.Variable,"",Ge,new B.Metadata(Qe,Te)),Ce=new D.Context(re),Fe=new Y.Request(Ge,Ce,null,[],Le);return Fe}A.createMockRequest=$e},88460:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.QueryableString=void 0;var y=function(){function v(Z){this.str=Z}return v.prototype.startsWith=function(Z){return this.str.indexOf(Z)===0},v.prototype.endsWith=function(Z){var a="",P=Z.split("").reverse().join("");return a=this.str.split("").reverse().join(""),this.startsWith.call({str:a},P)},v.prototype.contains=function(Z){return this.str.indexOf(Z)!==-1},v.prototype.equals=function(Z){return this.str===Z},v.prototype.value=function(){return this.str},v}();A.QueryableString=y},6e3:function(Ft,A,y){"use strict";var v=this&&this.__spreadArray||function(rt,Re){for(var vt=0,wt=Re.length,fe=rt.length;vt<wt;vt++,fe++)rt[fe]=Re[vt];return rt};Object.defineProperty(A,"__esModule",{value:!0}),A.getFunctionName=A.getBaseClassDependencyCount=A.getDependencies=void 0;var Z=y(5744),a=y(16674),P=y(28421),L=y(6867),O=y(55800);Object.defineProperty(A,"getFunctionName",{enumerable:!0,get:function(){return O.getFunctionName}});var D=y(18924);function B(rt,Re){var vt=O.getFunctionName(Re),wt=V(rt,vt,Re,!1);return wt}A.getDependencies=B;function V(rt,Re,vt,wt){var fe=rt.getConstructorMetadata(vt),$e=fe.compilerGeneratedMetadata;if($e===void 0){var re=a.MISSING_INJECTABLE_ANNOTATION+" "+Re+".";throw new Error(re)}var Ge=fe.userGeneratedMetadata,Qe=Object.keys(Ge),Te=vt.length===0&&Qe.length>0,Le=Qe.length>vt.length,Ce=Te||Le?Qe.length:vt.length,Fe=Y(wt,Re,$e,Ge,Ce),Ke=H(rt,vt),qt=v(v([],Fe),Ke);return qt}function N(rt,Re,vt,wt,fe){var $e=fe[rt.toString()]||[],re=at($e),Ge=re.unmanaged!==!0,Qe=wt[rt],Te=re.inject||re.multiInject;if(Qe=Te||Qe,Qe instanceof Z.LazyServiceIdentifer&&(Qe=Qe.unwrap()),Ge){var Le=Qe===Object,Ce=Qe===Function,Fe=Qe===void 0,Ke=Le||Ce||Fe;if(!Re&&Ke){var qt=a.MISSING_INJECT_ANNOTATION+" argument "+rt+" in class "+vt+".";throw new Error(qt)}var ir=new D.Target(P.TargetTypeEnum.ConstructorArgument,re.targetName,Qe);return ir.metadata=$e,ir}return null}function Y(rt,Re,vt,wt,fe){for(var $e=[],re=0;re<fe;re++){var Ge=re,Qe=N(Ge,rt,Re,vt,wt);Qe!==null&&$e.push(Qe)}return $e}function H(rt,Re){for(var vt=rt.getPropertiesMetadata(Re),wt=[],fe=Object.keys(vt),$e=0,re=fe;$e<re.length;$e++){var Ge=re[$e],Qe=vt[Ge],Te=at(vt[Ge]),Le=Te.targetName||Ge,Ce=Te.inject||Te.multiInject,Fe=new D.Target(P.TargetTypeEnum.ClassProperty,Le,Ce);Fe.metadata=Qe,wt.push(Fe)}var Ke=Object.getPrototypeOf(Re.prototype).constructor;if(Ke!==Object){var qt=H(rt,Ke);wt=v(v([],wt),qt)}return wt}function ce(rt,Re){var vt=Object.getPrototypeOf(Re.prototype).constructor;if(vt!==Object){var wt=O.getFunctionName(vt),fe=V(rt,wt,vt,!0),$e=fe.map(function(Qe){return Qe.metadata.filter(function(Te){return Te.key===L.UNMANAGED_TAG})}),re=[].concat.apply([],$e).length,Ge=fe.length-re;return Ge>0?Ge:ce(rt,vt)}else return 0}A.getBaseClassDependencyCount=ce;function at(rt){var Re={};return rt.forEach(function(vt){Re[vt.key.toString()]=vt.value}),{inject:Re[L.INJECT_TAG],multiInject:Re[L.MULTI_INJECT_TAG],targetName:Re[L.NAME_TAG],unmanaged:Re[L.UNMANAGED_TAG]}}},6748:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Request=void 0;var v=y(37791),Z=function(){function a(P,L,O,D,B){this.id=v.id(),this.serviceIdentifier=P,this.parentContext=L,this.parentRequest=O,this.target=B,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=O===null?new Map:null}return a.prototype.addChildRequest=function(P,L,O){var D=new a(P,this.parentContext,this,L,O);return this.childRequests.push(D),D},a}();A.Request=Z},18924:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.Target=void 0;var v=y(6867),Z=y(37791),a=y(47738),P=y(88460),L=function(){function O(D,B,V,N){this.id=Z.id(),this.type=D,this.serviceIdentifier=V,this.name=new P.QueryableString(B||""),this.metadata=new Array;var Y=null;typeof N=="string"?Y=new a.Metadata(v.NAMED_TAG,N):N instanceof a.Metadata&&(Y=N),Y!==null&&this.metadata.push(Y)}return O.prototype.hasTag=function(D){for(var B=0,V=this.metadata;B<V.length;B++){var N=V[B];if(N.key===D)return!0}return!1},O.prototype.isArray=function(){return this.hasTag(v.MULTI_INJECT_TAG)},O.prototype.matchesArray=function(D){return this.matchesTag(v.MULTI_INJECT_TAG)(D)},O.prototype.isNamed=function(){return this.hasTag(v.NAMED_TAG)},O.prototype.isTagged=function(){return this.metadata.some(function(D){return v.NON_CUSTOM_TAG_KEYS.every(function(B){return D.key!==B})})},O.prototype.isOptional=function(){return this.matchesTag(v.OPTIONAL_TAG)(!0)},O.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===v.NAMED_TAG})[0]:null},O.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return v.NON_CUSTOM_TAG_KEYS.every(function(B){return D.key!==B})}):null},O.prototype.matchesNamedTag=function(D){return this.matchesTag(v.NAMED_TAG)(D)},O.prototype.matchesTag=function(D){var B=this;return function(V){for(var N=0,Y=B.metadata;N<Y.length;N++){var H=Y[N];if(H.key===D&&H.value===V)return!0}return!1}},O}();A.Target=L},52279:function(Ft,A,y){"use strict";var v=this&&this.__spreadArray||function(V,N){for(var Y=0,H=N.length,ce=V.length;Y<H;Y++,ce++)V[ce]=N[Y];return V};Object.defineProperty(A,"__esModule",{value:!0}),A.resolveInstance=void 0;var Z=y(16674),a=y(28421),P=y(6867);function L(V,N,Y){var H=N.filter(function(at){return at.target!==null&&at.target.type===a.TargetTypeEnum.ClassProperty}),ce=H.map(Y);return H.forEach(function(at,rt){var Re="";Re=at.target.name.value();var vt=ce[rt];V[Re]=vt}),V}function O(V,N){return new(V.bind.apply(V,v([void 0],N)))}function D(V,N){if(Reflect.hasMetadata(P.POST_CONSTRUCT,V)){var Y=Reflect.getMetadata(P.POST_CONSTRUCT,V);try{N[Y.value]()}catch(H){throw new Error(Z.POST_CONSTRUCT_ERROR(V.name,H.message))}}}function B(V,N,Y){var H=null;if(N.length>0){var ce=N.filter(function(rt){return rt.target!==null&&rt.target.type===a.TargetTypeEnum.ConstructorArgument}),at=ce.map(Y);H=O(V,at),H=L(H,N,Y)}else H=new V;return D(V,H),H}A.resolveInstance=B},31927:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.resolve=void 0;var v=y(16674),Z=y(28421),a=y(85265),P=y(55800),L=y(52279),O=function(V,N,Y){try{return Y()}catch(H){throw a.isStackOverflowExeption(H)?new Error(v.CIRCULAR_DEPENDENCY_IN_FACTORY(V,N.toString())):H}},D=function(V){return function(N){N.parentContext.setCurrentRequest(N);var Y=N.bindings,H=N.childRequests,ce=N.target&&N.target.isArray(),at=!N.parentRequest||!N.parentRequest.target||!N.target||!N.parentRequest.target.matchesArray(N.target.serviceIdentifier);if(ce&&at)return H.map(function($e){var re=D(V);return re($e)});var rt=null;if(N.target.isOptional()&&Y.length===0)return;var Re=Y[0],vt=Re.scope===Z.BindingScopeEnum.Singleton,wt=Re.scope===Z.BindingScopeEnum.Request;if(vt&&Re.activated)return Re.cache;if(wt&&V!==null&&V.has(Re.id))return V.get(Re.id);if(Re.type===Z.BindingTypeEnum.ConstantValue)rt=Re.cache,Re.activated=!0;else if(Re.type===Z.BindingTypeEnum.Function)rt=Re.cache,Re.activated=!0;else if(Re.type===Z.BindingTypeEnum.Constructor)rt=Re.implementationType;else if(Re.type===Z.BindingTypeEnum.DynamicValue&&Re.dynamicValue!==null)rt=O("toDynamicValue",Re.serviceIdentifier,function(){return Re.dynamicValue(N.parentContext)});else if(Re.type===Z.BindingTypeEnum.Factory&&Re.factory!==null)rt=O("toFactory",Re.serviceIdentifier,function(){return Re.factory(N.parentContext)});else if(Re.type===Z.BindingTypeEnum.Provider&&Re.provider!==null)rt=O("toProvider",Re.serviceIdentifier,function(){return Re.provider(N.parentContext)});else if(Re.type===Z.BindingTypeEnum.Instance&&Re.implementationType!==null)rt=L.resolveInstance(Re.implementationType,H,D(V));else{var fe=P.getServiceIdentifierAsString(N.serviceIdentifier);throw new Error(v.INVALID_BINDING_TYPE+" "+fe)}return typeof Re.onActivation=="function"&&(rt=Re.onActivation(N.parentContext,rt)),vt&&(Re.cache=rt,Re.activated=!0),wt&&V!==null&&!V.has(Re.id)&&V.set(Re.id,rt),rt}};function B(V){var N=D(V.plan.rootRequest.requestScope);return N(V.plan.rootRequest)}A.resolve=B},83366:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BindingInSyntax=void 0;var v=y(28421),Z=y(71325),a=function(){function P(L){this._binding=L}return P.prototype.inRequestScope=function(){return this._binding.scope=v.BindingScopeEnum.Request,new Z.BindingWhenOnSyntax(this._binding)},P.prototype.inSingletonScope=function(){return this._binding.scope=v.BindingScopeEnum.Singleton,new Z.BindingWhenOnSyntax(this._binding)},P.prototype.inTransientScope=function(){return this._binding.scope=v.BindingScopeEnum.Transient,new Z.BindingWhenOnSyntax(this._binding)},P}();A.BindingInSyntax=a},99812:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BindingInWhenOnSyntax=void 0;var v=y(83366),Z=y(51811),a=y(98370),P=function(){function L(O){this._binding=O,this._bindingWhenSyntax=new a.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Z.BindingOnSyntax(this._binding),this._bindingInSyntax=new v.BindingInSyntax(O)}return L.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},L.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},L.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},L.prototype.when=function(O){return this._bindingWhenSyntax.when(O)},L.prototype.whenTargetNamed=function(O){return this._bindingWhenSyntax.whenTargetNamed(O)},L.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},L.prototype.whenTargetTagged=function(O,D){return this._bindingWhenSyntax.whenTargetTagged(O,D)},L.prototype.whenInjectedInto=function(O){return this._bindingWhenSyntax.whenInjectedInto(O)},L.prototype.whenParentNamed=function(O){return this._bindingWhenSyntax.whenParentNamed(O)},L.prototype.whenParentTagged=function(O,D){return this._bindingWhenSyntax.whenParentTagged(O,D)},L.prototype.whenAnyAncestorIs=function(O){return this._bindingWhenSyntax.whenAnyAncestorIs(O)},L.prototype.whenNoAncestorIs=function(O){return this._bindingWhenSyntax.whenNoAncestorIs(O)},L.prototype.whenAnyAncestorNamed=function(O){return this._bindingWhenSyntax.whenAnyAncestorNamed(O)},L.prototype.whenAnyAncestorTagged=function(O,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(O,D)},L.prototype.whenNoAncestorNamed=function(O){return this._bindingWhenSyntax.whenNoAncestorNamed(O)},L.prototype.whenNoAncestorTagged=function(O,D){return this._bindingWhenSyntax.whenNoAncestorTagged(O,D)},L.prototype.whenAnyAncestorMatches=function(O){return this._bindingWhenSyntax.whenAnyAncestorMatches(O)},L.prototype.whenNoAncestorMatches=function(O){return this._bindingWhenSyntax.whenNoAncestorMatches(O)},L.prototype.onActivation=function(O){return this._bindingOnSyntax.onActivation(O)},L}();A.BindingInWhenOnSyntax=P},51811:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BindingOnSyntax=void 0;var v=y(98370),Z=function(){function a(P){this._binding=P}return a.prototype.onActivation=function(P){return this._binding.onActivation=P,new v.BindingWhenSyntax(this._binding)},a}();A.BindingOnSyntax=Z},51860:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BindingToSyntax=void 0;var v=y(16674),Z=y(28421),a=y(99812),P=y(71325),L=function(){function O(D){this._binding=D}return O.prototype.to=function(D){return this._binding.type=Z.BindingTypeEnum.Instance,this._binding.implementationType=D,new a.BindingInWhenOnSyntax(this._binding)},O.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+v.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},O.prototype.toConstantValue=function(D){return this._binding.type=Z.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Z.BindingScopeEnum.Singleton,new P.BindingWhenOnSyntax(this._binding)},O.prototype.toDynamicValue=function(D){return this._binding.type=Z.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new a.BindingInWhenOnSyntax(this._binding)},O.prototype.toConstructor=function(D){return this._binding.type=Z.BindingTypeEnum.Constructor,this._binding.implementationType=D,this._binding.scope=Z.BindingScopeEnum.Singleton,new P.BindingWhenOnSyntax(this._binding)},O.prototype.toFactory=function(D){return this._binding.type=Z.BindingTypeEnum.Factory,this._binding.factory=D,this._binding.scope=Z.BindingScopeEnum.Singleton,new P.BindingWhenOnSyntax(this._binding)},O.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(v.INVALID_FUNCTION_BINDING);var B=this.toConstantValue(D);return this._binding.type=Z.BindingTypeEnum.Function,this._binding.scope=Z.BindingScopeEnum.Singleton,B},O.prototype.toAutoFactory=function(D){return this._binding.type=Z.BindingTypeEnum.Factory,this._binding.factory=function(B){var V=function(){return B.container.get(D)};return V},this._binding.scope=Z.BindingScopeEnum.Singleton,new P.BindingWhenOnSyntax(this._binding)},O.prototype.toProvider=function(D){return this._binding.type=Z.BindingTypeEnum.Provider,this._binding.provider=D,this._binding.scope=Z.BindingScopeEnum.Singleton,new P.BindingWhenOnSyntax(this._binding)},O.prototype.toService=function(D){this.toDynamicValue(function(B){return B.container.get(D)})},O}();A.BindingToSyntax=L},71325:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BindingWhenOnSyntax=void 0;var v=y(51811),Z=y(98370),a=function(){function P(L){this._binding=L,this._bindingWhenSyntax=new Z.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new v.BindingOnSyntax(this._binding)}return P.prototype.when=function(L){return this._bindingWhenSyntax.when(L)},P.prototype.whenTargetNamed=function(L){return this._bindingWhenSyntax.whenTargetNamed(L)},P.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},P.prototype.whenTargetTagged=function(L,O){return this._bindingWhenSyntax.whenTargetTagged(L,O)},P.prototype.whenInjectedInto=function(L){return this._bindingWhenSyntax.whenInjectedInto(L)},P.prototype.whenParentNamed=function(L){return this._bindingWhenSyntax.whenParentNamed(L)},P.prototype.whenParentTagged=function(L,O){return this._bindingWhenSyntax.whenParentTagged(L,O)},P.prototype.whenAnyAncestorIs=function(L){return this._bindingWhenSyntax.whenAnyAncestorIs(L)},P.prototype.whenNoAncestorIs=function(L){return this._bindingWhenSyntax.whenNoAncestorIs(L)},P.prototype.whenAnyAncestorNamed=function(L){return this._bindingWhenSyntax.whenAnyAncestorNamed(L)},P.prototype.whenAnyAncestorTagged=function(L,O){return this._bindingWhenSyntax.whenAnyAncestorTagged(L,O)},P.prototype.whenNoAncestorNamed=function(L){return this._bindingWhenSyntax.whenNoAncestorNamed(L)},P.prototype.whenNoAncestorTagged=function(L,O){return this._bindingWhenSyntax.whenNoAncestorTagged(L,O)},P.prototype.whenAnyAncestorMatches=function(L){return this._bindingWhenSyntax.whenAnyAncestorMatches(L)},P.prototype.whenNoAncestorMatches=function(L){return this._bindingWhenSyntax.whenNoAncestorMatches(L)},P.prototype.onActivation=function(L){return this._bindingOnSyntax.onActivation(L)},P}();A.BindingWhenOnSyntax=a},98370:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BindingWhenSyntax=void 0;var v=y(51811),Z=y(84164),a=function(){function P(L){this._binding=L}return P.prototype.when=function(L){return this._binding.constraint=L,new v.BindingOnSyntax(this._binding)},P.prototype.whenTargetNamed=function(L){return this._binding.constraint=Z.namedConstraint(L),new v.BindingOnSyntax(this._binding)},P.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(L){var O=L.target!==null&&!L.target.isNamed()&&!L.target.isTagged();return O},new v.BindingOnSyntax(this._binding)},P.prototype.whenTargetTagged=function(L,O){return this._binding.constraint=Z.taggedConstraint(L)(O),new v.BindingOnSyntax(this._binding)},P.prototype.whenInjectedInto=function(L){return this._binding.constraint=function(O){return Z.typeConstraint(L)(O.parentRequest)},new v.BindingOnSyntax(this._binding)},P.prototype.whenParentNamed=function(L){return this._binding.constraint=function(O){return Z.namedConstraint(L)(O.parentRequest)},new v.BindingOnSyntax(this._binding)},P.prototype.whenParentTagged=function(L,O){return this._binding.constraint=function(D){return Z.taggedConstraint(L)(O)(D.parentRequest)},new v.BindingOnSyntax(this._binding)},P.prototype.whenAnyAncestorIs=function(L){return this._binding.constraint=function(O){return Z.traverseAncerstors(O,Z.typeConstraint(L))},new v.BindingOnSyntax(this._binding)},P.prototype.whenNoAncestorIs=function(L){return this._binding.constraint=function(O){return!Z.traverseAncerstors(O,Z.typeConstraint(L))},new v.BindingOnSyntax(this._binding)},P.prototype.whenAnyAncestorNamed=function(L){return this._binding.constraint=function(O){return Z.traverseAncerstors(O,Z.namedConstraint(L))},new v.BindingOnSyntax(this._binding)},P.prototype.whenNoAncestorNamed=function(L){return this._binding.constraint=function(O){return!Z.traverseAncerstors(O,Z.namedConstraint(L))},new v.BindingOnSyntax(this._binding)},P.prototype.whenAnyAncestorTagged=function(L,O){return this._binding.constraint=function(D){return Z.traverseAncerstors(D,Z.taggedConstraint(L)(O))},new v.BindingOnSyntax(this._binding)},P.prototype.whenNoAncestorTagged=function(L,O){return this._binding.constraint=function(D){return!Z.traverseAncerstors(D,Z.taggedConstraint(L)(O))},new v.BindingOnSyntax(this._binding)},P.prototype.whenAnyAncestorMatches=function(L){return this._binding.constraint=function(O){return Z.traverseAncerstors(O,L)},new v.BindingOnSyntax(this._binding)},P.prototype.whenNoAncestorMatches=function(L){return this._binding.constraint=function(O){return!Z.traverseAncerstors(O,L)},new v.BindingOnSyntax(this._binding)},P}();A.BindingWhenSyntax=a},84164:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.typeConstraint=A.namedConstraint=A.taggedConstraint=A.traverseAncerstors=void 0;var v=y(6867),Z=y(47738),a=function(D,B){var V=D.parentRequest;return V!==null?B(V)?!0:a(V,B):!1};A.traverseAncerstors=a;var P=function(D){return function(B){var V=function(N){return N!==null&&N.target!==null&&N.target.matchesTag(D)(B)};return V.metaData=new Z.Metadata(D,B),V}};A.taggedConstraint=P;var L=P(v.NAMED_TAG);A.namedConstraint=L;var O=function(D){return function(B){var V=null;if(B!==null)if(V=B.bindings[0],typeof D=="string"){var N=V.serviceIdentifier;return N===D}else{var Y=B.bindings[0].implementationType;return D===Y}return!1}};A.typeConstraint=O},70600:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.multiBindToService=void 0;var y=function(v){return function(Z){return function(){for(var a=[],P=0;P<arguments.length;P++)a[P]=arguments[P];return a.forEach(function(L){return v.bind(L).toService(Z)})}}};A.multiBindToService=y},85265:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.isStackOverflowExeption=void 0;var v=y(16674);function Z(a){return a instanceof RangeError||a.message===v.STACK_OVERFLOW}A.isStackOverflowExeption=Z},37791:function(Ft,A){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.id=void 0;var y=0;function v(){return y++}A.id=v},55800:function(Ft,A,y){"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.circularDependencyToException=A.listMetadataForTarget=A.listRegisteredBindingsForServiceIdentifier=A.getServiceIdentifierAsString=A.getFunctionName=void 0;var v=y(16674);function Z(V){if(typeof V=="function"){var N=V;return N.name}else{if(typeof V=="symbol")return V.toString();var N=V;return N}}A.getServiceIdentifierAsString=Z;function a(V,N,Y){var H="",ce=Y(V,N);return ce.length!==0&&(H=`
Registered bindings:`,ce.forEach(function(at){var rt="Object";at.implementationType!==null&&(rt=B(at.implementationType)),H=H+`
 `+rt,at.constraint.metaData&&(H=H+" - "+at.constraint.metaData)})),H}A.listRegisteredBindingsForServiceIdentifier=a;function P(V,N){return V.parentRequest===null?!1:V.parentRequest.serviceIdentifier===N?!0:P(V.parentRequest,N)}function L(V){function N(H,ce){ce===void 0&&(ce=[]);var at=Z(H.serviceIdentifier);return ce.push(at),H.parentRequest!==null?N(H.parentRequest,ce):ce}var Y=N(V);return Y.reverse().join(" --> ")}function O(V){V.childRequests.forEach(function(N){if(P(N,N.serviceIdentifier)){var Y=L(N);throw new Error(v.CIRCULAR_DEPENDENCY+" "+Y)}else O(N)})}A.circularDependencyToException=O;function D(V,N){if(N.isTagged()||N.isNamed()){var Y="",H=N.getNamedTag(),ce=N.getCustomTags();return H!==null&&(Y+=H.toString()+`
`),ce!==null&&ce.forEach(function(at){Y+=at.toString()+`
`})," "+V+`
 `+V+" - "+Y}else return" "+V}A.listMetadataForTarget=D;function B(V){if(V.name)return V.name;var N=V.toString(),Y=N.match(/^function\s*([^\s(]+)/);return Y?Y[1]:"Anonymous function: "+N}A.getFunctionName=B},31745:function(Ft){"use strict";Ft.exports=y,Ft.exports.default=y;var A=1e20;function y(L,O,D,B,V,N){this.fontSize=L||24,this.buffer=O===void 0?3:O,this.cutoff=B||.25,this.fontFamily=V||"sans-serif",this.fontWeight=N||"normal",this.radius=D||8;var Y=this.size=this.fontSize+this.buffer*2,H=Y+this.buffer*2,ce=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;ce?this.canvas=my.createOffscreenCanvas(Y,Y,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Y),this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(H*H),this.gridInner=new Float64Array(H*H),this.f=new Float64Array(H),this.z=new Float64Array(H+1),this.v=new Uint16Array(H),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,ce?this.middle=Math.round(Y/2*1):this.middle=Math.round(Y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function v(L,O,D,B,V,N,Y){N.fill(A,0,O*D),Y.fill(0,0,O*D);for(var H=(O-B)/2,ce=0;ce<V;ce++)for(var at=0;at<B;at++){var rt=(ce+H)*O+at+H,Re=L.data[4*(ce*B+at)+3]/255;if(Re===1)N[rt]=0,Y[rt]=A;else if(Re===0)N[rt]=A,Y[rt]=0;else{var vt=Math.max(0,.5-Re),wt=Math.max(0,Re-.5);N[rt]=vt*vt,Y[rt]=wt*wt}}}function Z(L,O,D,B,V,N,Y){for(var H=0;H<O*D;H++){var ce=Math.sqrt(B[H])-Math.sqrt(V[H]);L[H]=Math.round(255-255*(ce/N+Y))}}y.prototype._draw=function(L,O){var D=this.ctx.measureText(L),B=D.width,V=2*this.buffer,N,Y,H,ce,at,rt,Re,vt;O&&this.useMetrics?(at=Math.floor(D.actualBoundingBoxAscent),vt=this.buffer+Math.ceil(D.actualBoundingBoxAscent),rt=this.buffer,Re=this.buffer,Y=Math.min(this.size,Math.ceil(D.actualBoundingBoxRight-D.actualBoundingBoxLeft)),ce=Math.min(this.size-rt,Math.ceil(D.actualBoundingBoxAscent+D.actualBoundingBoxDescent)),N=Y+V,H=ce+V,this.ctx.textBaseline="alphabetic"):(N=Y=this.size,H=ce=this.size,at=19*this.fontSize/24,rt=Re=0,vt=this.middle,this.ctx.textBaseline="middle");var wt;Y&&ce&&(this.ctx.clearRect(Re,rt,Y,ce),this.ctx.fillText(L,this.buffer,vt),wt=this.ctx.getImageData(Re,rt,Y,ce));var fe=new Uint8ClampedArray(N*H);return v(wt,N,H,Y,ce,this.gridOuter,this.gridInner),a(this.gridOuter,N,H,this.f,this.v,this.z),a(this.gridInner,N,H,this.f,this.v,this.z),Z(fe,N,H,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:fe,metrics:{width:Y,height:ce,sdfWidth:N,sdfHeight:H,top:at,left:0,advance:B}}},y.prototype.draw=function(L){return this._draw(L,!1).data},y.prototype.drawWithMetrics=function(L){return this._draw(L,!0)};function a(L,O,D,B,V,N){for(var Y=0;Y<O;Y++)P(L,Y,O,D,B,V,N);for(var H=0;H<D;H++)P(L,H*O,1,O,B,V,N)}function P(L,O,D,B,V,N,Y){var H,ce,at,rt;for(N[0]=0,Y[0]=-A,Y[1]=A,H=0;H<B;H++)V[H]=L[O+H*D];for(H=1,ce=0,at=0;H<B;H++){do rt=N[ce],at=(V[H]-V[rt]+H*H-rt*rt)/(H-rt)/2;while(at<=Y[ce]&&--ce>-1);ce++,N[ce]=H,Y[ce]=at,Y[ce+1]=A}for(H=0,ce=0;H<B;H++){for(;Y[ce+1]<H;)ce++;rt=N[ce],L[O+H*D]=V[rt]+(H-rt)*(H-rt)}}},18857:function(Ft,A,y){"use strict";y.r(A),y.d(A,{Function:function(){return Do},Interpreter:function(){return ia},default:function(){return ps},evaluate:function(){return mo},vm:function(){return v}});var v={};y.r(v),y.d(v,{Script:function(){return Bo},compileFunction:function(){return ao},createContext:function(){return _a},runInContext:function(){return Yo},runInNewContext:function(){return Vo}});var Z={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},a="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",P={5:a,"5module":a+" export import",6:a+" const class extends export import super"},L=/^in(stanceof)?$/,O="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",D="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",B=new RegExp("["+O+"]"),V=new RegExp("["+O+D+"]");O=D=null;var N=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],Y=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function H(g,U){for(var he=65536,te=0;te<U.length;te+=2){if(he+=U[te],he>g)return!1;if(he+=U[te+1],he>=g)return!0}}function ce(g,U){return g<65?g===36:g<91?!0:g<97?g===95:g<123?!0:g<=65535?g>=170&&B.test(String.fromCharCode(g)):U===!1?!1:H(g,N)}function at(g,U){return g<48?g===36:g<58?!0:g<65?!1:g<91?!0:g<97?g===95:g<123?!0:g<=65535?g>=170&&V.test(String.fromCharCode(g)):U===!1?!1:H(g,N)||H(g,Y)}var rt=function(U,he){he===void 0&&(he={}),this.label=U,this.keyword=he.keyword,this.beforeExpr=!!he.beforeExpr,this.startsExpr=!!he.startsExpr,this.isLoop=!!he.isLoop,this.isAssign=!!he.isAssign,this.prefix=!!he.prefix,this.postfix=!!he.postfix,this.binop=he.binop||null,this.updateContext=null};function Re(g,U){return new rt(g,{beforeExpr:!0,binop:U})}var vt={beforeExpr:!0},wt={startsExpr:!0},fe={};function $e(g,U){return U===void 0&&(U={}),U.keyword=g,fe[g]=new rt(g,U)}var re={num:new rt("num",wt),regexp:new rt("regexp",wt),string:new rt("string",wt),name:new rt("name",wt),eof:new rt("eof"),bracketL:new rt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new rt("]"),braceL:new rt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new rt("}"),parenL:new rt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new rt(")"),comma:new rt(",",vt),semi:new rt(";",vt),colon:new rt(":",vt),dot:new rt("."),question:new rt("?",vt),questionDot:new rt("?."),arrow:new rt("=>",vt),template:new rt("template"),invalidTemplate:new rt("invalidTemplate"),ellipsis:new rt("...",vt),backQuote:new rt("`",wt),dollarBraceL:new rt("${",{beforeExpr:!0,startsExpr:!0}),eq:new rt("=",{beforeExpr:!0,isAssign:!0}),assign:new rt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new rt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new rt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Re("||",1),logicalAND:Re("&&",2),bitwiseOR:Re("|",3),bitwiseXOR:Re("^",4),bitwiseAND:Re("&",5),equality:Re("==/!=/===/!==",6),relational:Re("</>/<=/>=",7),bitShift:Re("<</>>/>>>",8),plusMin:new rt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Re("%",10),star:Re("*",10),slash:Re("/",10),starstar:new rt("**",{beforeExpr:!0}),coalesce:Re("??",1),_break:$e("break"),_case:$e("case",vt),_catch:$e("catch"),_continue:$e("continue"),_debugger:$e("debugger"),_default:$e("default",vt),_do:$e("do",{isLoop:!0,beforeExpr:!0}),_else:$e("else",vt),_finally:$e("finally"),_for:$e("for",{isLoop:!0}),_function:$e("function",wt),_if:$e("if"),_return:$e("return",vt),_switch:$e("switch"),_throw:$e("throw",vt),_try:$e("try"),_var:$e("var"),_const:$e("const"),_while:$e("while",{isLoop:!0}),_with:$e("with"),_new:$e("new",{beforeExpr:!0,startsExpr:!0}),_this:$e("this",wt),_super:$e("super",wt),_class:$e("class",wt),_extends:$e("extends",vt),_export:$e("export"),_import:$e("import",wt),_null:$e("null",wt),_true:$e("true",wt),_false:$e("false",wt),_in:$e("in",{beforeExpr:!0,binop:7}),_instanceof:$e("instanceof",{beforeExpr:!0,binop:7}),_typeof:$e("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:$e("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:$e("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Ge=/\r\n?|\n|\u2028|\u2029/,Qe=new RegExp(Ge.source,"g");function Te(g,U){return g===10||g===13||!U&&(g===8232||g===8233)}var Le=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ce=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Fe=Object.prototype,Ke=Fe.hasOwnProperty,qt=Fe.toString;function ir(g,U){return Ke.call(g,U)}var Pe=Array.isArray||function(g){return qt.call(g)==="[object Array]"};function Ne(g){return new RegExp("^(?:"+g.replace(/ /g,"|")+")$")}var Xe=function(U,he){this.line=U,this.column=he};Xe.prototype.offset=function(U){return new Xe(this.line,this.column+U)};var kt=function(U,he,te){this.start=he,this.end=te,U.sourceFile!==null&&(this.source=U.sourceFile)};function rr(g,U){for(var he=1,te=0;;){Qe.lastIndex=te;var tt=Qe.exec(g);if(tt&&tt.index<U)++he,te=tt.index+tt[0].length;else return new Xe(he,U-te)}}var me={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function et(g){var U={};for(var he in me)U[he]=g&&ir(g,he)?g[he]:me[he];if(U.ecmaVersion>=2015&&(U.ecmaVersion-=2009),U.allowReserved==null&&(U.allowReserved=U.ecmaVersion<5),Pe(U.onToken)){var te=U.onToken;U.onToken=function(tt){return te.push(tt)}}return Pe(U.onComment)&&(U.onComment=or(U,U.onComment)),U}function or(g,U){return function(he,te,tt,Pt,fr,Fr){var zr={type:he?"Block":"Line",value:te,start:tt,end:Pt};g.locations&&(zr.loc=new kt(this,fr,Fr)),g.ranges&&(zr.range=[tt,Pt]),U.push(zr)}}var on=1,vr=2,jr=on|vr,xr=4,Ae=8,De=16,ke=32,Bt=64,mt=128;function Mr(g,U){return vr|(g?xr:0)|(U?Ae:0)}var Cr=0,Nr=1,nt=2,Ye=3,M=4,W=5,ue=function(U,he,te){this.options=U=et(U),this.sourceFile=U.sourceFile,this.keywords=Ne(P[U.ecmaVersion>=6?6:U.sourceType==="module"?"5module":5]);var tt="";if(U.allowReserved!==!0){for(var Pt=U.ecmaVersion;!(tt=Z[Pt]);Pt--);U.sourceType==="module"&&(tt+=" await")}this.reservedWords=Ne(tt);var fr=(tt?tt+" ":"")+Z.strict;this.reservedWordsStrict=Ne(fr),this.reservedWordsStrictBind=Ne(fr+" "+Z.strictBind),this.input=String(he),this.containsEsc=!1,te?(this.pos=te,this.lineStart=this.input.lastIndexOf(`
`,te-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Ge).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=re.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=U.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&U.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(on),this.regexpState=null},X={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};ue.prototype.parse=function(){var U=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(U)},X.inFunction.get=function(){return(this.currentVarScope().flags&vr)>0},X.inGenerator.get=function(){return(this.currentVarScope().flags&Ae)>0},X.inAsync.get=function(){return(this.currentVarScope().flags&xr)>0},X.allowSuper.get=function(){return(this.currentThisScope().flags&Bt)>0},X.allowDirectSuper.get=function(){return(this.currentThisScope().flags&mt)>0},X.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},ue.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&vr)>0},ue.extend=function(){for(var U=[],he=arguments.length;he--;)U[he]=arguments[he];for(var te=this,tt=0;tt<U.length;tt++)te=U[tt](te);return te},ue.parse=function(U,he){return new this(he,U).parse()},ue.parseExpressionAt=function(U,he,te){var tt=new this(te,U,he);return tt.nextToken(),tt.parseExpression()},ue.tokenizer=function(U,he){return new this(he,U)},Object.defineProperties(ue.prototype,X);var ie=ue.prototype,ye=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;ie.strictDirective=function(g){for(;;){Ce.lastIndex=g,g+=Ce.exec(this.input)[0].length;var U=ye.exec(this.input.slice(g));if(!U)return!1;if((U[1]||U[2])==="use strict"){Ce.lastIndex=g+U[0].length;var he=Ce.exec(this.input),te=he.index+he[0].length,tt=this.input.charAt(te);return tt===";"||tt==="}"||Ge.test(he[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(tt)||tt==="!"&&this.input.charAt(te+1)==="=")}g+=U[0].length,Ce.lastIndex=g,g+=Ce.exec(this.input)[0].length,this.input[g]===";"&&g++}},ie.eat=function(g){return this.type===g?(this.next(),!0):!1},ie.isContextual=function(g){return this.type===re.name&&this.value===g&&!this.containsEsc},ie.eatContextual=function(g){return this.isContextual(g)?(this.next(),!0):!1},ie.expectContextual=function(g){this.eatContextual(g)||this.unexpected()},ie.canInsertSemicolon=function(){return this.type===re.eof||this.type===re.braceR||Ge.test(this.input.slice(this.lastTokEnd,this.start))},ie.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},ie.semicolon=function(){!this.eat(re.semi)&&!this.insertSemicolon()&&this.unexpected()},ie.afterTrailingComma=function(g,U){if(this.type===g)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),U||this.next(),!0},ie.expect=function(g){this.eat(g)||this.unexpected()},ie.unexpected=function(g){this.raise(g!=null?g:this.start,"Unexpected token")};function J(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}ie.checkPatternErrors=function(g,U){if(!!g){g.trailingComma>-1&&this.raiseRecoverable(g.trailingComma,"Comma is not permitted after the rest element");var he=U?g.parenthesizedAssign:g.parenthesizedBind;he>-1&&this.raiseRecoverable(he,"Parenthesized pattern")}},ie.checkExpressionErrors=function(g,U){if(!g)return!1;var he=g.shorthandAssign,te=g.doubleProto;if(!U)return he>=0||te>=0;he>=0&&this.raise(he,"Shorthand property assignments are valid only in destructuring patterns"),te>=0&&this.raiseRecoverable(te,"Redefinition of __proto__ property")},ie.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},ie.isSimpleAssignTarget=function(g){return g.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(g.expression):g.type==="Identifier"||g.type==="MemberExpression"};var ht=ue.prototype;ht.parseTopLevel=function(g){var U={};for(g.body||(g.body=[]);this.type!==re.eof;){var he=this.parseStatement(null,!0,U);g.body.push(he)}if(this.inModule)for(var te=0,tt=Object.keys(this.undefinedExports);te<tt.length;te+=1){var Pt=tt[te];this.raiseRecoverable(this.undefinedExports[Pt].start,"Export '"+Pt+"' is not defined")}return this.adaptDirectivePrologue(g.body),this.next(),g.sourceType=this.options.sourceType,this.finishNode(g,"Program")};var ze={kind:"loop"},pt={kind:"switch"};ht.isLet=function(g){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Ce.lastIndex=this.pos;var U=Ce.exec(this.input),he=this.pos+U[0].length,te=this.input.charCodeAt(he);if(te===91)return!0;if(g)return!1;if(te===123)return!0;if(ce(te,!0)){for(var tt=he+1;at(this.input.charCodeAt(tt),!0);)++tt;var Pt=this.input.slice(he,tt);if(!L.test(Pt))return!0}return!1},ht.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Ce.lastIndex=this.pos;var g=Ce.exec(this.input),U=this.pos+g[0].length;return!Ge.test(this.input.slice(this.pos,U))&&this.input.slice(U,U+8)==="function"&&(U+8===this.input.length||!at(this.input.charAt(U+8)))},ht.parseStatement=function(g,U,he){var te=this.type,tt=this.startNode(),Pt;switch(this.isLet(g)&&(te=re._var,Pt="let"),te){case re._break:case re._continue:return this.parseBreakContinueStatement(tt,te.keyword);case re._debugger:return this.parseDebuggerStatement(tt);case re._do:return this.parseDoStatement(tt);case re._for:return this.parseForStatement(tt);case re._function:return g&&(this.strict||g!=="if"&&g!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(tt,!1,!g);case re._class:return g&&this.unexpected(),this.parseClass(tt,!0);case re._if:return this.parseIfStatement(tt);case re._return:return this.parseReturnStatement(tt);case re._switch:return this.parseSwitchStatement(tt);case re._throw:return this.parseThrowStatement(tt);case re._try:return this.parseTryStatement(tt);case re._const:case re._var:return Pt=Pt||this.value,g&&Pt!=="var"&&this.unexpected(),this.parseVarStatement(tt,Pt);case re._while:return this.parseWhileStatement(tt);case re._with:return this.parseWithStatement(tt);case re.braceL:return this.parseBlock(!0,tt);case re.semi:return this.parseEmptyStatement(tt);case re._export:case re._import:if(this.options.ecmaVersion>10&&te===re._import){Ce.lastIndex=this.pos;var fr=Ce.exec(this.input),Fr=this.pos+fr[0].length,zr=this.input.charCodeAt(Fr);if(zr===40||zr===46)return this.parseExpressionStatement(tt,this.parseExpression())}return this.options.allowImportExportEverywhere||(U||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),te===re._import?this.parseImport(tt):this.parseExport(tt,he);default:if(this.isAsyncFunction())return g&&this.unexpected(),this.next(),this.parseFunctionStatement(tt,!0,!g);var En=this.value,Dn=this.parseExpression();return te===re.name&&Dn.type==="Identifier"&&this.eat(re.colon)?this.parseLabeledStatement(tt,En,Dn,g):this.parseExpressionStatement(tt,Dn)}},ht.parseBreakContinueStatement=function(g,U){var he=U==="break";this.next(),this.eat(re.semi)||this.insertSemicolon()?g.label=null:this.type!==re.name?this.unexpected():(g.label=this.parseIdent(),this.semicolon());for(var te=0;te<this.labels.length;++te){var tt=this.labels[te];if((g.label==null||tt.name===g.label.name)&&(tt.kind!=null&&(he||tt.kind==="loop")||g.label&&he))break}return te===this.labels.length&&this.raise(g.start,"Unsyntactic "+U),this.finishNode(g,he?"BreakStatement":"ContinueStatement")},ht.parseDebuggerStatement=function(g){return this.next(),this.semicolon(),this.finishNode(g,"DebuggerStatement")},ht.parseDoStatement=function(g){return this.next(),this.labels.push(ze),g.body=this.parseStatement("do"),this.labels.pop(),this.expect(re._while),g.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(re.semi):this.semicolon(),this.finishNode(g,"DoWhileStatement")},ht.parseForStatement=function(g){this.next();var U=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(ze),this.enterScope(0),this.expect(re.parenL),this.type===re.semi)return U>-1&&this.unexpected(U),this.parseFor(g,null);var he=this.isLet();if(this.type===re._var||this.type===re._const||he){var te=this.startNode(),tt=he?"let":this.value;return this.next(),this.parseVar(te,!0,tt),this.finishNode(te,"VariableDeclaration"),(this.type===re._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&te.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===re._in?U>-1&&this.unexpected(U):g.await=U>-1),this.parseForIn(g,te)):(U>-1&&this.unexpected(U),this.parseFor(g,te))}var Pt=new J,fr=this.parseExpression(!0,Pt);return this.type===re._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===re._in?U>-1&&this.unexpected(U):g.await=U>-1),this.toAssignable(fr,!1,Pt),this.checkLVal(fr),this.parseForIn(g,fr)):(this.checkExpressionErrors(Pt,!0),U>-1&&this.unexpected(U),this.parseFor(g,fr))},ht.parseFunctionStatement=function(g,U,he){return this.next(),this.parseFunction(g,Ue|(he?0:yt),!1,U)},ht.parseIfStatement=function(g){return this.next(),g.test=this.parseParenExpression(),g.consequent=this.parseStatement("if"),g.alternate=this.eat(re._else)?this.parseStatement("if"):null,this.finishNode(g,"IfStatement")},ht.parseReturnStatement=function(g){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(re.semi)||this.insertSemicolon()?g.argument=null:(g.argument=this.parseExpression(),this.semicolon()),this.finishNode(g,"ReturnStatement")},ht.parseSwitchStatement=function(g){this.next(),g.discriminant=this.parseParenExpression(),g.cases=[],this.expect(re.braceL),this.labels.push(pt),this.enterScope(0);for(var U,he=!1;this.type!==re.braceR;)if(this.type===re._case||this.type===re._default){var te=this.type===re._case;U&&this.finishNode(U,"SwitchCase"),g.cases.push(U=this.startNode()),U.consequent=[],this.next(),te?U.test=this.parseExpression():(he&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),he=!0,U.test=null),this.expect(re.colon)}else U||this.unexpected(),U.consequent.push(this.parseStatement(null));return this.exitScope(),U&&this.finishNode(U,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(g,"SwitchStatement")},ht.parseThrowStatement=function(g){return this.next(),Ge.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),g.argument=this.parseExpression(),this.semicolon(),this.finishNode(g,"ThrowStatement")};var Me=[];ht.parseTryStatement=function(g){if(this.next(),g.block=this.parseBlock(),g.handler=null,this.type===re._catch){var U=this.startNode();if(this.next(),this.eat(re.parenL)){U.param=this.parseBindingAtom();var he=U.param.type==="Identifier";this.enterScope(he?ke:0),this.checkLVal(U.param,he?M:nt),this.expect(re.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),U.param=null,this.enterScope(0);U.body=this.parseBlock(!1),this.exitScope(),g.handler=this.finishNode(U,"CatchClause")}return g.finalizer=this.eat(re._finally)?this.parseBlock():null,!g.handler&&!g.finalizer&&this.raise(g.start,"Missing catch or finally clause"),this.finishNode(g,"TryStatement")},ht.parseVarStatement=function(g,U){return this.next(),this.parseVar(g,!1,U),this.semicolon(),this.finishNode(g,"VariableDeclaration")},ht.parseWhileStatement=function(g){return this.next(),g.test=this.parseParenExpression(),this.labels.push(ze),g.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(g,"WhileStatement")},ht.parseWithStatement=function(g){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),g.object=this.parseParenExpression(),g.body=this.parseStatement("with"),this.finishNode(g,"WithStatement")},ht.parseEmptyStatement=function(g){return this.next(),this.finishNode(g,"EmptyStatement")},ht.parseLabeledStatement=function(g,U,he,te){for(var tt=0,Pt=this.labels;tt<Pt.length;tt+=1){var fr=Pt[tt];fr.name===U&&this.raise(he.start,"Label '"+U+"' is already declared")}for(var Fr=this.type.isLoop?"loop":this.type===re._switch?"switch":null,zr=this.labels.length-1;zr>=0;zr--){var En=this.labels[zr];if(En.statementStart===g.start)En.statementStart=this.start,En.kind=Fr;else break}return this.labels.push({name:U,kind:Fr,statementStart:this.start}),g.body=this.parseStatement(te?te.indexOf("label")===-1?te+"label":te:"label"),this.labels.pop(),g.label=he,this.finishNode(g,"LabeledStatement")},ht.parseExpressionStatement=function(g,U){return g.expression=U,this.semicolon(),this.finishNode(g,"ExpressionStatement")},ht.parseBlock=function(g,U,he){for(g===void 0&&(g=!0),U===void 0&&(U=this.startNode()),U.body=[],this.expect(re.braceL),g&&this.enterScope(0);this.type!==re.braceR;){var te=this.parseStatement(null);U.body.push(te)}return he&&(this.strict=!1),this.next(),g&&this.exitScope(),this.finishNode(U,"BlockStatement")},ht.parseFor=function(g,U){return g.init=U,this.expect(re.semi),g.test=this.type===re.semi?null:this.parseExpression(),this.expect(re.semi),g.update=this.type===re.parenR?null:this.parseExpression(),this.expect(re.parenR),g.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(g,"ForStatement")},ht.parseForIn=function(g,U){var he=this.type===re._in;return this.next(),U.type==="VariableDeclaration"&&U.declarations[0].init!=null&&(!he||this.options.ecmaVersion<8||this.strict||U.kind!=="var"||U.declarations[0].id.type!=="Identifier")?this.raise(U.start,(he?"for-in":"for-of")+" loop variable declaration may not have an initializer"):U.type==="AssignmentPattern"&&this.raise(U.start,"Invalid left-hand side in for-loop"),g.left=U,g.right=he?this.parseExpression():this.parseMaybeAssign(),this.expect(re.parenR),g.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(g,he?"ForInStatement":"ForOfStatement")},ht.parseVar=function(g,U,he){for(g.declarations=[],g.kind=he;;){var te=this.startNode();if(this.parseVarId(te,he),this.eat(re.eq)?te.init=this.parseMaybeAssign(U):he==="const"&&!(this.type===re._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():te.id.type!=="Identifier"&&!(U&&(this.type===re._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):te.init=null,g.declarations.push(this.finishNode(te,"VariableDeclarator")),!this.eat(re.comma))break}return g},ht.parseVarId=function(g,U){g.id=this.parseBindingAtom(),this.checkLVal(g.id,U==="var"?Nr:nt,!1)};var Ue=1,yt=2,gt=4;ht.parseFunction=function(g,U,he,te){this.initFunction(g),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!te)&&(this.type===re.star&&U&yt&&this.unexpected(),g.generator=this.eat(re.star)),this.options.ecmaVersion>=8&&(g.async=!!te),U&Ue&&(g.id=U&gt&&this.type!==re.name?null:this.parseIdent(),g.id&&!(U&yt)&&this.checkLVal(g.id,this.strict||g.generator||g.async?this.treatFunctionsAsVar?Nr:nt:Ye));var tt=this.yieldPos,Pt=this.awaitPos,fr=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Mr(g.async,g.generator)),U&Ue||(g.id=this.type===re.name?this.parseIdent():null),this.parseFunctionParams(g),this.parseFunctionBody(g,he,!1),this.yieldPos=tt,this.awaitPos=Pt,this.awaitIdentPos=fr,this.finishNode(g,U&Ue?"FunctionDeclaration":"FunctionExpression")},ht.parseFunctionParams=function(g){this.expect(re.parenL),g.params=this.parseBindingList(re.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},ht.parseClass=function(g,U){this.next();var he=this.strict;this.strict=!0,this.parseClassId(g,U),this.parseClassSuper(g);var te=this.startNode(),tt=!1;for(te.body=[],this.expect(re.braceL);this.type!==re.braceR;){var Pt=this.parseClassElement(g.superClass!==null);Pt&&(te.body.push(Pt),Pt.type==="MethodDefinition"&&Pt.kind==="constructor"&&(tt&&this.raise(Pt.start,"Duplicate constructor in the same class"),tt=!0))}return this.strict=he,this.next(),g.body=this.finishNode(te,"ClassBody"),this.finishNode(g,U?"ClassDeclaration":"ClassExpression")},ht.parseClassElement=function(g){var U=this;if(this.eat(re.semi))return null;var he=this.startNode(),te=function(zr,En){En===void 0&&(En=!1);var Dn=U.start,na=U.startLoc;return U.eatContextual(zr)?U.type!==re.parenL&&(!En||!U.canInsertSemicolon())?!0:(he.key&&U.unexpected(),he.computed=!1,he.key=U.startNodeAt(Dn,na),he.key.name=zr,U.finishNode(he.key,"Identifier"),!1):!1};he.kind="method",he.static=te("static");var tt=this.eat(re.star),Pt=!1;tt||(this.options.ecmaVersion>=8&&te("async",!0)?(Pt=!0,tt=this.options.ecmaVersion>=9&&this.eat(re.star)):te("get")?he.kind="get":te("set")&&(he.kind="set")),he.key||this.parsePropertyName(he);var fr=he.key,Fr=!1;return!he.computed&&!he.static&&(fr.type==="Identifier"&&fr.name==="constructor"||fr.type==="Literal"&&fr.value==="constructor")?(he.kind!=="method"&&this.raise(fr.start,"Constructor can't have get/set modifier"),tt&&this.raise(fr.start,"Constructor can't be a generator"),Pt&&this.raise(fr.start,"Constructor can't be an async method"),he.kind="constructor",Fr=g):he.static&&fr.type==="Identifier"&&fr.name==="prototype"&&this.raise(fr.start,"Classes may not have a static property named prototype"),this.parseClassMethod(he,tt,Pt,Fr),he.kind==="get"&&he.value.params.length!==0&&this.raiseRecoverable(he.value.start,"getter should have no params"),he.kind==="set"&&he.value.params.length!==1&&this.raiseRecoverable(he.value.start,"setter should have exactly one param"),he.kind==="set"&&he.value.params[0].type==="RestElement"&&this.raiseRecoverable(he.value.params[0].start,"Setter cannot use rest params"),he},ht.parseClassMethod=function(g,U,he,te){return g.value=this.parseMethod(U,he,te),this.finishNode(g,"MethodDefinition")},ht.parseClassId=function(g,U){this.type===re.name?(g.id=this.parseIdent(),U&&this.checkLVal(g.id,nt,!1)):(U===!0&&this.unexpected(),g.id=null)},ht.parseClassSuper=function(g){g.superClass=this.eat(re._extends)?this.parseExprSubscripts():null},ht.parseExport=function(g,U){if(this.next(),this.eat(re.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(g.exported=this.parseIdent(!0),this.checkExport(U,g.exported.name,this.lastTokStart)):g.exported=null),this.expectContextual("from"),this.type!==re.string&&this.unexpected(),g.source=this.parseExprAtom(),this.semicolon(),this.finishNode(g,"ExportAllDeclaration");if(this.eat(re._default)){this.checkExport(U,"default",this.lastTokStart);var he;if(this.type===re._function||(he=this.isAsyncFunction())){var te=this.startNode();this.next(),he&&this.next(),g.declaration=this.parseFunction(te,Ue|gt,!1,he)}else if(this.type===re._class){var tt=this.startNode();g.declaration=this.parseClass(tt,"nullableID")}else g.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(g,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())g.declaration=this.parseStatement(null),g.declaration.type==="VariableDeclaration"?this.checkVariableExport(U,g.declaration.declarations):this.checkExport(U,g.declaration.id.name,g.declaration.id.start),g.specifiers=[],g.source=null;else{if(g.declaration=null,g.specifiers=this.parseExportSpecifiers(U),this.eatContextual("from"))this.type!==re.string&&this.unexpected(),g.source=this.parseExprAtom();else{for(var Pt=0,fr=g.specifiers;Pt<fr.length;Pt+=1){var Fr=fr[Pt];this.checkUnreserved(Fr.local),this.checkLocalExport(Fr.local)}g.source=null}this.semicolon()}return this.finishNode(g,"ExportNamedDeclaration")},ht.checkExport=function(g,U,he){!g||(ir(g,U)&&this.raiseRecoverable(he,"Duplicate export '"+U+"'"),g[U]=!0)},ht.checkPatternExport=function(g,U){var he=U.type;if(he==="Identifier")this.checkExport(g,U.name,U.start);else if(he==="ObjectPattern")for(var te=0,tt=U.properties;te<tt.length;te+=1){var Pt=tt[te];this.checkPatternExport(g,Pt)}else if(he==="ArrayPattern")for(var fr=0,Fr=U.elements;fr<Fr.length;fr+=1){var zr=Fr[fr];zr&&this.checkPatternExport(g,zr)}else he==="Property"?this.checkPatternExport(g,U.value):he==="AssignmentPattern"?this.checkPatternExport(g,U.left):he==="RestElement"?this.checkPatternExport(g,U.argument):he==="ParenthesizedExpression"&&this.checkPatternExport(g,U.expression)},ht.checkVariableExport=function(g,U){if(!!g)for(var he=0,te=U;he<te.length;he+=1){var tt=te[he];this.checkPatternExport(g,tt.id)}},ht.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},ht.parseExportSpecifiers=function(g){var U=[],he=!0;for(this.expect(re.braceL);!this.eat(re.braceR);){if(he)he=!1;else if(this.expect(re.comma),this.afterTrailingComma(re.braceR))break;var te=this.startNode();te.local=this.parseIdent(!0),te.exported=this.eatContextual("as")?this.parseIdent(!0):te.local,this.checkExport(g,te.exported.name,te.exported.start),U.push(this.finishNode(te,"ExportSpecifier"))}return U},ht.parseImport=function(g){return this.next(),this.type===re.string?(g.specifiers=Me,g.source=this.parseExprAtom()):(g.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),g.source=this.type===re.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(g,"ImportDeclaration")},ht.parseImportSpecifiers=function(){var g=[],U=!0;if(this.type===re.name){var he=this.startNode();if(he.local=this.parseIdent(),this.checkLVal(he.local,nt),g.push(this.finishNode(he,"ImportDefaultSpecifier")),!this.eat(re.comma))return g}if(this.type===re.star){var te=this.startNode();return this.next(),this.expectContextual("as"),te.local=this.parseIdent(),this.checkLVal(te.local,nt),g.push(this.finishNode(te,"ImportNamespaceSpecifier")),g}for(this.expect(re.braceL);!this.eat(re.braceR);){if(U)U=!1;else if(this.expect(re.comma),this.afterTrailingComma(re.braceR))break;var tt=this.startNode();tt.imported=this.parseIdent(!0),this.eatContextual("as")?tt.local=this.parseIdent():(this.checkUnreserved(tt.imported),tt.local=tt.imported),this.checkLVal(tt.local,nt),g.push(this.finishNode(tt,"ImportSpecifier"))}return g},ht.adaptDirectivePrologue=function(g){for(var U=0;U<g.length&&this.isDirectiveCandidate(g[U]);++U)g[U].directive=g[U].expression.raw.slice(1,-1)},ht.isDirectiveCandidate=function(g){return g.type==="ExpressionStatement"&&g.expression.type==="Literal"&&typeof g.expression.value=="string"&&(this.input[g.start]==='"'||this.input[g.start]==="'")};var nr=ue.prototype;nr.toAssignable=function(g,U,he){if(this.options.ecmaVersion>=6&&g)switch(g.type){case"Identifier":this.inAsync&&g.name==="await"&&this.raise(g.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":g.type="ObjectPattern",he&&this.checkPatternErrors(he,!0);for(var te=0,tt=g.properties;te<tt.length;te+=1){var Pt=tt[te];this.toAssignable(Pt,U),Pt.type==="RestElement"&&(Pt.argument.type==="ArrayPattern"||Pt.argument.type==="ObjectPattern")&&this.raise(Pt.argument.start,"Unexpected token")}break;case"Property":g.kind!=="init"&&this.raise(g.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(g.value,U);break;case"ArrayExpression":g.type="ArrayPattern",he&&this.checkPatternErrors(he,!0),this.toAssignableList(g.elements,U);break;case"SpreadElement":g.type="RestElement",this.toAssignable(g.argument,U),g.argument.type==="AssignmentPattern"&&this.raise(g.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":g.operator!=="="&&this.raise(g.left.end,"Only '=' operator can be used for specifying default value."),g.type="AssignmentPattern",delete g.operator,this.toAssignable(g.left,U);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(g.expression,U,he);break;case"ChainExpression":this.raiseRecoverable(g.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!U)break;default:this.raise(g.start,"Assigning to rvalue")}else he&&this.checkPatternErrors(he,!0);return g},nr.toAssignableList=function(g,U){for(var he=g.length,te=0;te<he;te++){var tt=g[te];tt&&this.toAssignable(tt,U)}if(he){var Pt=g[he-1];this.options.ecmaVersion===6&&U&&Pt&&Pt.type==="RestElement"&&Pt.argument.type!=="Identifier"&&this.unexpected(Pt.argument.start)}return g},nr.parseSpread=function(g){var U=this.startNode();return this.next(),U.argument=this.parseMaybeAssign(!1,g),this.finishNode(U,"SpreadElement")},nr.parseRestBinding=function(){var g=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==re.name&&this.unexpected(),g.argument=this.parseBindingAtom(),this.finishNode(g,"RestElement")},nr.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case re.bracketL:var g=this.startNode();return this.next(),g.elements=this.parseBindingList(re.bracketR,!0,!0),this.finishNode(g,"ArrayPattern");case re.braceL:return this.parseObj(!0)}return this.parseIdent()},nr.parseBindingList=function(g,U,he){for(var te=[],tt=!0;!this.eat(g);)if(tt?tt=!1:this.expect(re.comma),U&&this.type===re.comma)te.push(null);else{if(he&&this.afterTrailingComma(g))break;if(this.type===re.ellipsis){var Pt=this.parseRestBinding();this.parseBindingListItem(Pt),te.push(Pt),this.type===re.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(g);break}else{var fr=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(fr),te.push(fr)}}return te},nr.parseBindingListItem=function(g){return g},nr.parseMaybeDefault=function(g,U,he){if(he=he||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(re.eq))return he;var te=this.startNodeAt(g,U);return te.left=he,te.right=this.parseMaybeAssign(),this.finishNode(te,"AssignmentPattern")},nr.checkLVal=function(g,U,he){switch(U===void 0&&(U=Cr),g.type){case"Identifier":U===nt&&g.name==="let"&&this.raiseRecoverable(g.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(g.name)&&this.raiseRecoverable(g.start,(U?"Binding ":"Assigning to ")+g.name+" in strict mode"),he&&(ir(he,g.name)&&this.raiseRecoverable(g.start,"Argument name clash"),he[g.name]=!0),U!==Cr&&U!==W&&this.declareName(g.name,U,g.start);break;case"ChainExpression":this.raiseRecoverable(g.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":U&&this.raiseRecoverable(g.start,"Binding member expression");break;case"ObjectPattern":for(var te=0,tt=g.properties;te<tt.length;te+=1){var Pt=tt[te];this.checkLVal(Pt,U,he)}break;case"Property":this.checkLVal(g.value,U,he);break;case"ArrayPattern":for(var fr=0,Fr=g.elements;fr<Fr.length;fr+=1){var zr=Fr[fr];zr&&this.checkLVal(zr,U,he)}break;case"AssignmentPattern":this.checkLVal(g.left,U,he);break;case"RestElement":this.checkLVal(g.argument,U,he);break;case"ParenthesizedExpression":this.checkLVal(g.expression,U,he);break;default:this.raise(g.start,(U?"Binding":"Assigning to")+" rvalue")}};var pe=ue.prototype;pe.checkPropClash=function(g,U,he){if(!(this.options.ecmaVersion>=9&&g.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(g.computed||g.method||g.shorthand))){var te=g.key,tt;switch(te.type){case"Identifier":tt=te.name;break;case"Literal":tt=String(te.value);break;default:return}var Pt=g.kind;if(this.options.ecmaVersion>=6){tt==="__proto__"&&Pt==="init"&&(U.proto&&(he?he.doubleProto<0&&(he.doubleProto=te.start):this.raiseRecoverable(te.start,"Redefinition of __proto__ property")),U.proto=!0);return}tt="$"+tt;var fr=U[tt];if(fr){var Fr;Pt==="init"?Fr=this.strict&&fr.init||fr.get||fr.set:Fr=fr.init||fr[Pt],Fr&&this.raiseRecoverable(te.start,"Redefinition of property")}else fr=U[tt]={init:!1,get:!1,set:!1};fr[Pt]=!0}},pe.parseExpression=function(g,U){var he=this.start,te=this.startLoc,tt=this.parseMaybeAssign(g,U);if(this.type===re.comma){var Pt=this.startNodeAt(he,te);for(Pt.expressions=[tt];this.eat(re.comma);)Pt.expressions.push(this.parseMaybeAssign(g,U));return this.finishNode(Pt,"SequenceExpression")}return tt},pe.parseMaybeAssign=function(g,U,he){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(g);this.exprAllowed=!1}var te=!1,tt=-1,Pt=-1;U?(tt=U.parenthesizedAssign,Pt=U.trailingComma,U.parenthesizedAssign=U.trailingComma=-1):(U=new J,te=!0);var fr=this.start,Fr=this.startLoc;(this.type===re.parenL||this.type===re.name)&&(this.potentialArrowAt=this.start);var zr=this.parseMaybeConditional(g,U);if(he&&(zr=he.call(this,zr,fr,Fr)),this.type.isAssign){var En=this.startNodeAt(fr,Fr);return En.operator=this.value,En.left=this.type===re.eq?this.toAssignable(zr,!1,U):zr,te||(U.parenthesizedAssign=U.trailingComma=U.doubleProto=-1),U.shorthandAssign>=En.left.start&&(U.shorthandAssign=-1),this.checkLVal(zr),this.next(),En.right=this.parseMaybeAssign(g),this.finishNode(En,"AssignmentExpression")}else te&&this.checkExpressionErrors(U,!0);return tt>-1&&(U.parenthesizedAssign=tt),Pt>-1&&(U.trailingComma=Pt),zr},pe.parseMaybeConditional=function(g,U){var he=this.start,te=this.startLoc,tt=this.parseExprOps(g,U);if(this.checkExpressionErrors(U))return tt;if(this.eat(re.question)){var Pt=this.startNodeAt(he,te);return Pt.test=tt,Pt.consequent=this.parseMaybeAssign(),this.expect(re.colon),Pt.alternate=this.parseMaybeAssign(g),this.finishNode(Pt,"ConditionalExpression")}return tt},pe.parseExprOps=function(g,U){var he=this.start,te=this.startLoc,tt=this.parseMaybeUnary(U,!1);return this.checkExpressionErrors(U)||tt.start===he&&tt.type==="ArrowFunctionExpression"?tt:this.parseExprOp(tt,he,te,-1,g)},pe.parseExprOp=function(g,U,he,te,tt){var Pt=this.type.binop;if(Pt!=null&&(!tt||this.type!==re._in)&&Pt>te){var fr=this.type===re.logicalOR||this.type===re.logicalAND,Fr=this.type===re.coalesce;Fr&&(Pt=re.logicalAND.binop);var zr=this.value;this.next();var En=this.start,Dn=this.startLoc,na=this.parseExprOp(this.parseMaybeUnary(null,!1),En,Dn,Pt,tt),ka=this.buildBinary(U,he,g,na,zr,fr||Fr);return(fr&&this.type===re.coalesce||Fr&&(this.type===re.logicalOR||this.type===re.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(ka,U,he,te,tt)}return g},pe.buildBinary=function(g,U,he,te,tt,Pt){var fr=this.startNodeAt(g,U);return fr.left=he,fr.operator=tt,fr.right=te,this.finishNode(fr,Pt?"LogicalExpression":"BinaryExpression")},pe.parseMaybeUnary=function(g,U){var he=this.start,te=this.startLoc,tt;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))tt=this.parseAwait(),U=!0;else if(this.type.prefix){var Pt=this.startNode(),fr=this.type===re.incDec;Pt.operator=this.value,Pt.prefix=!0,this.next(),Pt.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(g,!0),fr?this.checkLVal(Pt.argument):this.strict&&Pt.operator==="delete"&&Pt.argument.type==="Identifier"?this.raiseRecoverable(Pt.start,"Deleting local variable in strict mode"):U=!0,tt=this.finishNode(Pt,fr?"UpdateExpression":"UnaryExpression")}else{if(tt=this.parseExprSubscripts(g),this.checkExpressionErrors(g))return tt;for(;this.type.postfix&&!this.canInsertSemicolon();){var Fr=this.startNodeAt(he,te);Fr.operator=this.value,Fr.prefix=!1,Fr.argument=tt,this.checkLVal(tt),this.next(),tt=this.finishNode(Fr,"UpdateExpression")}}return!U&&this.eat(re.starstar)?this.buildBinary(he,te,tt,this.parseMaybeUnary(null,!1),"**",!1):tt},pe.parseExprSubscripts=function(g){var U=this.start,he=this.startLoc,te=this.parseExprAtom(g);if(te.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return te;var tt=this.parseSubscripts(te,U,he);return g&&tt.type==="MemberExpression"&&(g.parenthesizedAssign>=tt.start&&(g.parenthesizedAssign=-1),g.parenthesizedBind>=tt.start&&(g.parenthesizedBind=-1)),tt},pe.parseSubscripts=function(g,U,he,te){for(var tt=this.options.ecmaVersion>=8&&g.type==="Identifier"&&g.name==="async"&&this.lastTokEnd===g.end&&!this.canInsertSemicolon()&&g.end-g.start==5&&this.potentialArrowAt===g.start,Pt=!1;;){var fr=this.parseSubscript(g,U,he,te,tt,Pt);if(fr.optional&&(Pt=!0),fr===g||fr.type==="ArrowFunctionExpression"){if(Pt){var Fr=this.startNodeAt(U,he);Fr.expression=fr,fr=this.finishNode(Fr,"ChainExpression")}return fr}g=fr}},pe.parseSubscript=function(g,U,he,te,tt,Pt){var fr=this.options.ecmaVersion>=11,Fr=fr&&this.eat(re.questionDot);te&&Fr&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var zr=this.eat(re.bracketL);if(zr||Fr&&this.type!==re.parenL&&this.type!==re.backQuote||this.eat(re.dot)){var En=this.startNodeAt(U,he);En.object=g,En.property=zr?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),En.computed=!!zr,zr&&this.expect(re.bracketR),fr&&(En.optional=Fr),g=this.finishNode(En,"MemberExpression")}else if(!te&&this.eat(re.parenL)){var Dn=new J,na=this.yieldPos,ka=this.awaitPos,ha=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Fa=this.parseExprList(re.parenR,this.options.ecmaVersion>=8,!1,Dn);if(tt&&!Fr&&!this.canInsertSemicolon()&&this.eat(re.arrow))return this.checkPatternErrors(Dn,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=na,this.awaitPos=ka,this.awaitIdentPos=ha,this.parseArrowExpression(this.startNodeAt(U,he),Fa,!0);this.checkExpressionErrors(Dn,!0),this.yieldPos=na||this.yieldPos,this.awaitPos=ka||this.awaitPos,this.awaitIdentPos=ha||this.awaitIdentPos;var Mo=this.startNodeAt(U,he);Mo.callee=g,Mo.arguments=Fa,fr&&(Mo.optional=Fr),g=this.finishNode(Mo,"CallExpression")}else if(this.type===re.backQuote){(Fr||Pt)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Po=this.startNodeAt(U,he);Po.tag=g,Po.quasi=this.parseTemplate({isTagged:!0}),g=this.finishNode(Po,"TaggedTemplateExpression")}return g},pe.parseExprAtom=function(g){this.type===re.slash&&this.readRegexp();var U,he=this.potentialArrowAt===this.start;switch(this.type){case re._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),U=this.startNode(),this.next(),this.type===re.parenL&&!this.allowDirectSuper&&this.raise(U.start,"super() call outside constructor of a subclass"),this.type!==re.dot&&this.type!==re.bracketL&&this.type!==re.parenL&&this.unexpected(),this.finishNode(U,"Super");case re._this:return U=this.startNode(),this.next(),this.finishNode(U,"ThisExpression");case re.name:var te=this.start,tt=this.startLoc,Pt=this.containsEsc,fr=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Pt&&fr.name==="async"&&!this.canInsertSemicolon()&&this.eat(re._function))return this.parseFunction(this.startNodeAt(te,tt),0,!1,!0);if(he&&!this.canInsertSemicolon()){if(this.eat(re.arrow))return this.parseArrowExpression(this.startNodeAt(te,tt),[fr],!1);if(this.options.ecmaVersion>=8&&fr.name==="async"&&this.type===re.name&&!Pt)return fr=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(re.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(te,tt),[fr],!0)}return fr;case re.regexp:var Fr=this.value;return U=this.parseLiteral(Fr.value),U.regex={pattern:Fr.pattern,flags:Fr.flags},U;case re.num:case re.string:return this.parseLiteral(this.value);case re._null:case re._true:case re._false:return U=this.startNode(),U.value=this.type===re._null?null:this.type===re._true,U.raw=this.type.keyword,this.next(),this.finishNode(U,"Literal");case re.parenL:var zr=this.start,En=this.parseParenAndDistinguishExpression(he);return g&&(g.parenthesizedAssign<0&&!this.isSimpleAssignTarget(En)&&(g.parenthesizedAssign=zr),g.parenthesizedBind<0&&(g.parenthesizedBind=zr)),En;case re.bracketL:return U=this.startNode(),this.next(),U.elements=this.parseExprList(re.bracketR,!0,!0,g),this.finishNode(U,"ArrayExpression");case re.braceL:return this.parseObj(!1,g);case re._function:return U=this.startNode(),this.next(),this.parseFunction(U,0);case re._class:return this.parseClass(this.startNode(),!1);case re._new:return this.parseNew();case re.backQuote:return this.parseTemplate();case re._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},pe.parseExprImport=function(){var g=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var U=this.parseIdent(!0);switch(this.type){case re.parenL:return this.parseDynamicImport(g);case re.dot:return g.meta=U,this.parseImportMeta(g);default:this.unexpected()}},pe.parseDynamicImport=function(g){if(this.next(),g.source=this.parseMaybeAssign(),!this.eat(re.parenR)){var U=this.start;this.eat(re.comma)&&this.eat(re.parenR)?this.raiseRecoverable(U,"Trailing comma is not allowed in import()"):this.unexpected(U)}return this.finishNode(g,"ImportExpression")},pe.parseImportMeta=function(g){this.next();var U=this.containsEsc;return g.property=this.parseIdent(!0),g.property.name!=="meta"&&this.raiseRecoverable(g.property.start,"The only valid meta property for import is 'import.meta'"),U&&this.raiseRecoverable(g.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(g.start,"Cannot use 'import.meta' outside a module"),this.finishNode(g,"MetaProperty")},pe.parseLiteral=function(g){var U=this.startNode();return U.value=g,U.raw=this.input.slice(this.start,this.end),U.raw.charCodeAt(U.raw.length-1)===110&&(U.bigint=U.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(U,"Literal")},pe.parseParenExpression=function(){this.expect(re.parenL);var g=this.parseExpression();return this.expect(re.parenR),g},pe.parseParenAndDistinguishExpression=function(g){var U=this.start,he=this.startLoc,te,tt=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Pt=this.start,fr=this.startLoc,Fr=[],zr=!0,En=!1,Dn=new J,na=this.yieldPos,ka=this.awaitPos,ha;for(this.yieldPos=0,this.awaitPos=0;this.type!==re.parenR;)if(zr?zr=!1:this.expect(re.comma),tt&&this.afterTrailingComma(re.parenR,!0)){En=!0;break}else if(this.type===re.ellipsis){ha=this.start,Fr.push(this.parseParenItem(this.parseRestBinding())),this.type===re.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else Fr.push(this.parseMaybeAssign(!1,Dn,this.parseParenItem));var Fa=this.start,Mo=this.startLoc;if(this.expect(re.parenR),g&&!this.canInsertSemicolon()&&this.eat(re.arrow))return this.checkPatternErrors(Dn,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=na,this.awaitPos=ka,this.parseParenArrowList(U,he,Fr);(!Fr.length||En)&&this.unexpected(this.lastTokStart),ha&&this.unexpected(ha),this.checkExpressionErrors(Dn,!0),this.yieldPos=na||this.yieldPos,this.awaitPos=ka||this.awaitPos,Fr.length>1?(te=this.startNodeAt(Pt,fr),te.expressions=Fr,this.finishNodeAt(te,"SequenceExpression",Fa,Mo)):te=Fr[0]}else te=this.parseParenExpression();if(this.options.preserveParens){var Po=this.startNodeAt(U,he);return Po.expression=te,this.finishNode(Po,"ParenthesizedExpression")}else return te},pe.parseParenItem=function(g){return g},pe.parseParenArrowList=function(g,U,he){return this.parseArrowExpression(this.startNodeAt(g,U),he)};var lr=[];pe.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var g=this.startNode(),U=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(re.dot)){g.meta=U;var he=this.containsEsc;return g.property=this.parseIdent(!0),g.property.name!=="target"&&this.raiseRecoverable(g.property.start,"The only valid meta property for new is 'new.target'"),he&&this.raiseRecoverable(g.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(g.start,"'new.target' can only be used in functions"),this.finishNode(g,"MetaProperty")}var te=this.start,tt=this.startLoc,Pt=this.type===re._import;return g.callee=this.parseSubscripts(this.parseExprAtom(),te,tt,!0),Pt&&g.callee.type==="ImportExpression"&&this.raise(te,"Cannot use new with import()"),this.eat(re.parenL)?g.arguments=this.parseExprList(re.parenR,this.options.ecmaVersion>=8,!1):g.arguments=lr,this.finishNode(g,"NewExpression")},pe.parseTemplateElement=function(g){var U=g.isTagged,he=this.startNode();return this.type===re.invalidTemplate?(U||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),he.value={raw:this.value,cooked:null}):he.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),he.tail=this.type===re.backQuote,this.finishNode(he,"TemplateElement")},pe.parseTemplate=function(g){g===void 0&&(g={});var U=g.isTagged;U===void 0&&(U=!1);var he=this.startNode();this.next(),he.expressions=[];var te=this.parseTemplateElement({isTagged:U});for(he.quasis=[te];!te.tail;)this.type===re.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(re.dollarBraceL),he.expressions.push(this.parseExpression()),this.expect(re.braceR),he.quasis.push(te=this.parseTemplateElement({isTagged:U}));return this.next(),this.finishNode(he,"TemplateLiteral")},pe.isAsyncProp=function(g){return!g.computed&&g.key.type==="Identifier"&&g.key.name==="async"&&(this.type===re.name||this.type===re.num||this.type===re.string||this.type===re.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===re.star)&&!Ge.test(this.input.slice(this.lastTokEnd,this.start))},pe.parseObj=function(g,U){var he=this.startNode(),te=!0,tt={};for(he.properties=[],this.next();!this.eat(re.braceR);){if(te)te=!1;else if(this.expect(re.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(re.braceR))break;var Pt=this.parseProperty(g,U);g||this.checkPropClash(Pt,tt,U),he.properties.push(Pt)}return this.finishNode(he,g?"ObjectPattern":"ObjectExpression")},pe.parseProperty=function(g,U){var he=this.startNode(),te,tt,Pt,fr;if(this.options.ecmaVersion>=9&&this.eat(re.ellipsis))return g?(he.argument=this.parseIdent(!1),this.type===re.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(he,"RestElement")):(this.type===re.parenL&&U&&(U.parenthesizedAssign<0&&(U.parenthesizedAssign=this.start),U.parenthesizedBind<0&&(U.parenthesizedBind=this.start)),he.argument=this.parseMaybeAssign(!1,U),this.type===re.comma&&U&&U.trailingComma<0&&(U.trailingComma=this.start),this.finishNode(he,"SpreadElement"));this.options.ecmaVersion>=6&&(he.method=!1,he.shorthand=!1,(g||U)&&(Pt=this.start,fr=this.startLoc),g||(te=this.eat(re.star)));var Fr=this.containsEsc;return this.parsePropertyName(he),!g&&!Fr&&this.options.ecmaVersion>=8&&!te&&this.isAsyncProp(he)?(tt=!0,te=this.options.ecmaVersion>=9&&this.eat(re.star),this.parsePropertyName(he,U)):tt=!1,this.parsePropertyValue(he,g,te,tt,Pt,fr,U,Fr),this.finishNode(he,"Property")},pe.parsePropertyValue=function(g,U,he,te,tt,Pt,fr,Fr){if((he||te)&&this.type===re.colon&&this.unexpected(),this.eat(re.colon))g.value=U?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,fr),g.kind="init";else if(this.options.ecmaVersion>=6&&this.type===re.parenL)U&&this.unexpected(),g.kind="init",g.method=!0,g.value=this.parseMethod(he,te);else if(!U&&!Fr&&this.options.ecmaVersion>=5&&!g.computed&&g.key.type==="Identifier"&&(g.key.name==="get"||g.key.name==="set")&&this.type!==re.comma&&this.type!==re.braceR&&this.type!==re.eq){(he||te)&&this.unexpected(),g.kind=g.key.name,this.parsePropertyName(g),g.value=this.parseMethod(!1);var zr=g.kind==="get"?0:1;if(g.value.params.length!==zr){var En=g.value.start;g.kind==="get"?this.raiseRecoverable(En,"getter should have no params"):this.raiseRecoverable(En,"setter should have exactly one param")}else g.kind==="set"&&g.value.params[0].type==="RestElement"&&this.raiseRecoverable(g.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!g.computed&&g.key.type==="Identifier"?((he||te)&&this.unexpected(),this.checkUnreserved(g.key),g.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=tt),g.kind="init",U?g.value=this.parseMaybeDefault(tt,Pt,g.key):this.type===re.eq&&fr?(fr.shorthandAssign<0&&(fr.shorthandAssign=this.start),g.value=this.parseMaybeDefault(tt,Pt,g.key)):g.value=g.key,g.shorthand=!0):this.unexpected()},pe.parsePropertyName=function(g){if(this.options.ecmaVersion>=6){if(this.eat(re.bracketL))return g.computed=!0,g.key=this.parseMaybeAssign(),this.expect(re.bracketR),g.key;g.computed=!1}return g.key=this.type===re.num||this.type===re.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},pe.initFunction=function(g){g.id=null,this.options.ecmaVersion>=6&&(g.generator=g.expression=!1),this.options.ecmaVersion>=8&&(g.async=!1)},pe.parseMethod=function(g,U,he){var te=this.startNode(),tt=this.yieldPos,Pt=this.awaitPos,fr=this.awaitIdentPos;return this.initFunction(te),this.options.ecmaVersion>=6&&(te.generator=g),this.options.ecmaVersion>=8&&(te.async=!!U),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Mr(U,te.generator)|Bt|(he?mt:0)),this.expect(re.parenL),te.params=this.parseBindingList(re.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(te,!1,!0),this.yieldPos=tt,this.awaitPos=Pt,this.awaitIdentPos=fr,this.finishNode(te,"FunctionExpression")},pe.parseArrowExpression=function(g,U,he){var te=this.yieldPos,tt=this.awaitPos,Pt=this.awaitIdentPos;return this.enterScope(Mr(he,!1)|De),this.initFunction(g),this.options.ecmaVersion>=8&&(g.async=!!he),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,g.params=this.toAssignableList(U,!0),this.parseFunctionBody(g,!0,!1),this.yieldPos=te,this.awaitPos=tt,this.awaitIdentPos=Pt,this.finishNode(g,"ArrowFunctionExpression")},pe.parseFunctionBody=function(g,U,he){var te=U&&this.type!==re.braceL,tt=this.strict,Pt=!1;if(te)g.body=this.parseMaybeAssign(),g.expression=!0,this.checkParams(g,!1);else{var fr=this.options.ecmaVersion>=7&&!this.isSimpleParamList(g.params);(!tt||fr)&&(Pt=this.strictDirective(this.end),Pt&&fr&&this.raiseRecoverable(g.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var Fr=this.labels;this.labels=[],Pt&&(this.strict=!0),this.checkParams(g,!tt&&!Pt&&!U&&!he&&this.isSimpleParamList(g.params)),this.strict&&g.id&&this.checkLVal(g.id,W),g.body=this.parseBlock(!1,void 0,Pt&&!tt),g.expression=!1,this.adaptDirectivePrologue(g.body.body),this.labels=Fr}this.exitScope()},pe.isSimpleParamList=function(g){for(var U=0,he=g;U<he.length;U+=1){var te=he[U];if(te.type!=="Identifier")return!1}return!0},pe.checkParams=function(g,U){for(var he={},te=0,tt=g.params;te<tt.length;te+=1){var Pt=tt[te];this.checkLVal(Pt,Nr,U?null:he)}},pe.parseExprList=function(g,U,he,te){for(var tt=[],Pt=!0;!this.eat(g);){if(Pt)Pt=!1;else if(this.expect(re.comma),U&&this.afterTrailingComma(g))break;var fr=void 0;he&&this.type===re.comma?fr=null:this.type===re.ellipsis?(fr=this.parseSpread(te),te&&this.type===re.comma&&te.trailingComma<0&&(te.trailingComma=this.start)):fr=this.parseMaybeAssign(!1,te),tt.push(fr)}return tt},pe.checkUnreserved=function(g){var U=g.start,he=g.end,te=g.name;if(this.inGenerator&&te==="yield"&&this.raiseRecoverable(U,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&te==="await"&&this.raiseRecoverable(U,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(te)&&this.raise(U,"Unexpected keyword '"+te+"'"),!(this.options.ecmaVersion<6&&this.input.slice(U,he).indexOf("\\")!==-1)){var tt=this.strict?this.reservedWordsStrict:this.reservedWords;tt.test(te)&&(!this.inAsync&&te==="await"&&this.raiseRecoverable(U,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(U,"The keyword '"+te+"' is reserved"))}},pe.parseIdent=function(g,U){var he=this.startNode();return this.type===re.name?he.name=this.value:this.type.keyword?(he.name=this.type.keyword,(he.name==="class"||he.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!g),this.finishNode(he,"Identifier"),g||(this.checkUnreserved(he),he.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=he.start)),he},pe.parseYield=function(g){this.yieldPos||(this.yieldPos=this.start);var U=this.startNode();return this.next(),this.type===re.semi||this.canInsertSemicolon()||this.type!==re.star&&!this.type.startsExpr?(U.delegate=!1,U.argument=null):(U.delegate=this.eat(re.star),U.argument=this.parseMaybeAssign(g)),this.finishNode(U,"YieldExpression")},pe.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var g=this.startNode();return this.next(),g.argument=this.parseMaybeUnary(null,!1),this.finishNode(g,"AwaitExpression")};var Ur=ue.prototype;Ur.raise=function(g,U){var he=rr(this.input,g);U+=" ("+he.line+":"+he.column+")";var te=new SyntaxError(U);throw te.pos=g,te.loc=he,te.raisedAt=this.pos,te},Ur.raiseRecoverable=Ur.raise,Ur.curPosition=function(){if(this.options.locations)return new Xe(this.curLine,this.pos-this.lineStart)};var Hr=ue.prototype,un=function(U){this.flags=U,this.var=[],this.lexical=[],this.functions=[]};Hr.enterScope=function(g){this.scopeStack.push(new un(g))},Hr.exitScope=function(){this.scopeStack.pop()},Hr.treatFunctionsAsVarInScope=function(g){return g.flags&vr||!this.inModule&&g.flags&on},Hr.declareName=function(g,U,he){var te=!1;if(U===nt){var tt=this.currentScope();te=tt.lexical.indexOf(g)>-1||tt.functions.indexOf(g)>-1||tt.var.indexOf(g)>-1,tt.lexical.push(g),this.inModule&&tt.flags&on&&delete this.undefinedExports[g]}else if(U===M){var Pt=this.currentScope();Pt.lexical.push(g)}else if(U===Ye){var fr=this.currentScope();this.treatFunctionsAsVar?te=fr.lexical.indexOf(g)>-1:te=fr.lexical.indexOf(g)>-1||fr.var.indexOf(g)>-1,fr.functions.push(g)}else for(var Fr=this.scopeStack.length-1;Fr>=0;--Fr){var zr=this.scopeStack[Fr];if(zr.lexical.indexOf(g)>-1&&!(zr.flags&ke&&zr.lexical[0]===g)||!this.treatFunctionsAsVarInScope(zr)&&zr.functions.indexOf(g)>-1){te=!0;break}if(zr.var.push(g),this.inModule&&zr.flags&on&&delete this.undefinedExports[g],zr.flags&jr)break}te&&this.raiseRecoverable(he,"Identifier '"+g+"' has already been declared")},Hr.checkLocalExport=function(g){this.scopeStack[0].lexical.indexOf(g.name)===-1&&this.scopeStack[0].var.indexOf(g.name)===-1&&(this.undefinedExports[g.name]=g)},Hr.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Hr.currentVarScope=function(){for(var g=this.scopeStack.length-1;;g--){var U=this.scopeStack[g];if(U.flags&jr)return U}},Hr.currentThisScope=function(){for(var g=this.scopeStack.length-1;;g--){var U=this.scopeStack[g];if(U.flags&jr&&!(U.flags&De))return U}};var bn=function(U,he,te){this.type="",this.start=he,this.end=0,U.options.locations&&(this.loc=new kt(U,te)),U.options.directSourceFile&&(this.sourceFile=U.options.directSourceFile),U.options.ranges&&(this.range=[he,0])},Gn=ue.prototype;Gn.startNode=function(){return new bn(this,this.start,this.startLoc)},Gn.startNodeAt=function(g,U){return new bn(this,g,U)};function li(g,U,he,te){return g.type=U,g.end=he,this.options.locations&&(g.loc.end=te),this.options.ranges&&(g.range[1]=he),g}Gn.finishNode=function(g,U){return li.call(this,g,U,this.lastTokEnd,this.lastTokEndLoc)},Gn.finishNodeAt=function(g,U,he,te){return li.call(this,g,U,he,te)};var $r=function(U,he,te,tt,Pt){this.token=U,this.isExpr=!!he,this.preserveSpace=!!te,this.override=tt,this.generator=!!Pt},Zt={b_stat:new $r("{",!1),b_expr:new $r("{",!0),b_tmpl:new $r("${",!1),p_stat:new $r("(",!1),p_expr:new $r("(",!0),q_tmpl:new $r("`",!0,!0,function(g){return g.tryReadTemplateToken()}),f_stat:new $r("function",!1),f_expr:new $r("function",!0),f_expr_gen:new $r("function",!0,!1,null,!0),f_gen:new $r("function",!1,!1,null,!0)},it=ue.prototype;it.initialContext=function(){return[Zt.b_stat]},it.braceIsBlock=function(g){var U=this.curContext();return U===Zt.f_expr||U===Zt.f_stat?!0:g===re.colon&&(U===Zt.b_stat||U===Zt.b_expr)?!U.isExpr:g===re._return||g===re.name&&this.exprAllowed?Ge.test(this.input.slice(this.lastTokEnd,this.start)):g===re._else||g===re.semi||g===re.eof||g===re.parenR||g===re.arrow?!0:g===re.braceL?U===Zt.b_stat:g===re._var||g===re._const||g===re.name?!1:!this.exprAllowed},it.inGeneratorContext=function(){for(var g=this.context.length-1;g>=1;g--){var U=this.context[g];if(U.token==="function")return U.generator}return!1},it.updateContext=function(g){var U,he=this.type;he.keyword&&g===re.dot?this.exprAllowed=!1:(U=he.updateContext)?U.call(this,g):this.exprAllowed=he.beforeExpr},re.parenR.updateContext=re.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var g=this.context.pop();g===Zt.b_stat&&this.curContext().token==="function"&&(g=this.context.pop()),this.exprAllowed=!g.isExpr},re.braceL.updateContext=function(g){this.context.push(this.braceIsBlock(g)?Zt.b_stat:Zt.b_expr),this.exprAllowed=!0},re.dollarBraceL.updateContext=function(){this.context.push(Zt.b_tmpl),this.exprAllowed=!0},re.parenL.updateContext=function(g){var U=g===re._if||g===re._for||g===re._with||g===re._while;this.context.push(U?Zt.p_stat:Zt.p_expr),this.exprAllowed=!0},re.incDec.updateContext=function(){},re._function.updateContext=re._class.updateContext=function(g){g.beforeExpr&&g!==re.semi&&g!==re._else&&!(g===re._return&&Ge.test(this.input.slice(this.lastTokEnd,this.start)))&&!((g===re.colon||g===re.braceL)&&this.curContext()===Zt.b_stat)?this.context.push(Zt.f_expr):this.context.push(Zt.f_stat),this.exprAllowed=!1},re.backQuote.updateContext=function(){this.curContext()===Zt.q_tmpl?this.context.pop():this.context.push(Zt.q_tmpl),this.exprAllowed=!1},re.star.updateContext=function(g){if(g===re._function){var U=this.context.length-1;this.context[U]===Zt.f_expr?this.context[U]=Zt.f_expr_gen:this.context[U]=Zt.f_gen}this.exprAllowed=!0},re.name.updateContext=function(g){var U=!1;this.options.ecmaVersion>=6&&g!==re.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(U=!0),this.exprAllowed=U};var ne="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",_e=ne+" Extended_Pictographic",Oe=_e,je={9:ne,10:_e,11:Oe},dt="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ut="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ur=Ut+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",lt=ur+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Nt={9:Ut,10:ur,11:lt},Sr={};function fn(g){var U=Sr[g]={binary:Ne(je[g]+" "+dt),nonBinary:{General_Category:Ne(dt),Script:Ne(Nt[g])}};U.nonBinary.Script_Extensions=U.nonBinary.Script,U.nonBinary.gc=U.nonBinary.General_Category,U.nonBinary.sc=U.nonBinary.Script,U.nonBinary.scx=U.nonBinary.Script_Extensions}fn(9),fn(10),fn(11);var Br=ue.prototype,Jr=function(U){this.parser=U,this.validFlags="gim"+(U.options.ecmaVersion>=6?"uy":"")+(U.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Sr[U.options.ecmaVersion>=11?11:U.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Jr.prototype.reset=function(U,he,te){var tt=te.indexOf("u")!==-1;this.start=U|0,this.source=he+"",this.flags=te,this.switchU=tt&&this.parser.options.ecmaVersion>=6,this.switchN=tt&&this.parser.options.ecmaVersion>=9},Jr.prototype.raise=function(U){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+U)},Jr.prototype.at=function(U,he){he===void 0&&(he=!1);var te=this.source,tt=te.length;if(U>=tt)return-1;var Pt=te.charCodeAt(U);if(!(he||this.switchU)||Pt<=55295||Pt>=57344||U+1>=tt)return Pt;var fr=te.charCodeAt(U+1);return fr>=56320&&fr<=57343?(Pt<<10)+fr-56613888:Pt},Jr.prototype.nextIndex=function(U,he){he===void 0&&(he=!1);var te=this.source,tt=te.length;if(U>=tt)return tt;var Pt=te.charCodeAt(U),fr;return!(he||this.switchU)||Pt<=55295||Pt>=57344||U+1>=tt||(fr=te.charCodeAt(U+1))<56320||fr>57343?U+1:U+2},Jr.prototype.current=function(U){return U===void 0&&(U=!1),this.at(this.pos,U)},Jr.prototype.lookahead=function(U){return U===void 0&&(U=!1),this.at(this.nextIndex(this.pos,U),U)},Jr.prototype.advance=function(U){U===void 0&&(U=!1),this.pos=this.nextIndex(this.pos,U)},Jr.prototype.eat=function(U,he){return he===void 0&&(he=!1),this.current(he)===U?(this.advance(he),!0):!1};function Tn(g){return g<=65535?String.fromCharCode(g):(g-=65536,String.fromCharCode((g>>10)+55296,(g&1023)+56320))}Br.validateRegExpFlags=function(g){for(var U=g.validFlags,he=g.flags,te=0;te<he.length;te++){var tt=he.charAt(te);U.indexOf(tt)===-1&&this.raise(g.start,"Invalid regular expression flag"),he.indexOf(tt,te+1)>-1&&this.raise(g.start,"Duplicate regular expression flag")}},Br.validateRegExpPattern=function(g){this.regexp_pattern(g),!g.switchN&&this.options.ecmaVersion>=9&&g.groupNames.length>0&&(g.switchN=!0,this.regexp_pattern(g))},Br.regexp_pattern=function(g){g.pos=0,g.lastIntValue=0,g.lastStringValue="",g.lastAssertionIsQuantifiable=!1,g.numCapturingParens=0,g.maxBackReference=0,g.groupNames.length=0,g.backReferenceNames.length=0,this.regexp_disjunction(g),g.pos!==g.source.length&&(g.eat(41)&&g.raise("Unmatched ')'"),(g.eat(93)||g.eat(125))&&g.raise("Lone quantifier brackets")),g.maxBackReference>g.numCapturingParens&&g.raise("Invalid escape");for(var U=0,he=g.backReferenceNames;U<he.length;U+=1){var te=he[U];g.groupNames.indexOf(te)===-1&&g.raise("Invalid named capture referenced")}},Br.regexp_disjunction=function(g){for(this.regexp_alternative(g);g.eat(124);)this.regexp_alternative(g);this.regexp_eatQuantifier(g,!0)&&g.raise("Nothing to repeat"),g.eat(123)&&g.raise("Lone quantifier brackets")},Br.regexp_alternative=function(g){for(;g.pos<g.source.length&&this.regexp_eatTerm(g););},Br.regexp_eatTerm=function(g){return this.regexp_eatAssertion(g)?(g.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(g)&&g.switchU&&g.raise("Invalid quantifier"),!0):(g.switchU?this.regexp_eatAtom(g):this.regexp_eatExtendedAtom(g))?(this.regexp_eatQuantifier(g),!0):!1},Br.regexp_eatAssertion=function(g){var U=g.pos;if(g.lastAssertionIsQuantifiable=!1,g.eat(94)||g.eat(36))return!0;if(g.eat(92)){if(g.eat(66)||g.eat(98))return!0;g.pos=U}if(g.eat(40)&&g.eat(63)){var he=!1;if(this.options.ecmaVersion>=9&&(he=g.eat(60)),g.eat(61)||g.eat(33))return this.regexp_disjunction(g),g.eat(41)||g.raise("Unterminated group"),g.lastAssertionIsQuantifiable=!he,!0}return g.pos=U,!1},Br.regexp_eatQuantifier=function(g,U){return U===void 0&&(U=!1),this.regexp_eatQuantifierPrefix(g,U)?(g.eat(63),!0):!1},Br.regexp_eatQuantifierPrefix=function(g,U){return g.eat(42)||g.eat(43)||g.eat(63)||this.regexp_eatBracedQuantifier(g,U)},Br.regexp_eatBracedQuantifier=function(g,U){var he=g.pos;if(g.eat(123)){var te=0,tt=-1;if(this.regexp_eatDecimalDigits(g)&&(te=g.lastIntValue,g.eat(44)&&this.regexp_eatDecimalDigits(g)&&(tt=g.lastIntValue),g.eat(125)))return tt!==-1&&tt<te&&!U&&g.raise("numbers out of order in {} quantifier"),!0;g.switchU&&!U&&g.raise("Incomplete quantifier"),g.pos=he}return!1},Br.regexp_eatAtom=function(g){return this.regexp_eatPatternCharacters(g)||g.eat(46)||this.regexp_eatReverseSolidusAtomEscape(g)||this.regexp_eatCharacterClass(g)||this.regexp_eatUncapturingGroup(g)||this.regexp_eatCapturingGroup(g)},Br.regexp_eatReverseSolidusAtomEscape=function(g){var U=g.pos;if(g.eat(92)){if(this.regexp_eatAtomEscape(g))return!0;g.pos=U}return!1},Br.regexp_eatUncapturingGroup=function(g){var U=g.pos;if(g.eat(40)){if(g.eat(63)&&g.eat(58)){if(this.regexp_disjunction(g),g.eat(41))return!0;g.raise("Unterminated group")}g.pos=U}return!1},Br.regexp_eatCapturingGroup=function(g){if(g.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(g):g.current()===63&&g.raise("Invalid group"),this.regexp_disjunction(g),g.eat(41))return g.numCapturingParens+=1,!0;g.raise("Unterminated group")}return!1},Br.regexp_eatExtendedAtom=function(g){return g.eat(46)||this.regexp_eatReverseSolidusAtomEscape(g)||this.regexp_eatCharacterClass(g)||this.regexp_eatUncapturingGroup(g)||this.regexp_eatCapturingGroup(g)||this.regexp_eatInvalidBracedQuantifier(g)||this.regexp_eatExtendedPatternCharacter(g)},Br.regexp_eatInvalidBracedQuantifier=function(g){return this.regexp_eatBracedQuantifier(g,!0)&&g.raise("Nothing to repeat"),!1},Br.regexp_eatSyntaxCharacter=function(g){var U=g.current();return hi(U)?(g.lastIntValue=U,g.advance(),!0):!1};function hi(g){return g===36||g>=40&&g<=43||g===46||g===63||g>=91&&g<=94||g>=123&&g<=125}Br.regexp_eatPatternCharacters=function(g){for(var U=g.pos,he=0;(he=g.current())!==-1&&!hi(he);)g.advance();return g.pos!==U},Br.regexp_eatExtendedPatternCharacter=function(g){var U=g.current();return U!==-1&&U!==36&&!(U>=40&&U<=43)&&U!==46&&U!==63&&U!==91&&U!==94&&U!==124?(g.advance(),!0):!1},Br.regexp_groupSpecifier=function(g){if(g.eat(63)){if(this.regexp_eatGroupName(g)){g.groupNames.indexOf(g.lastStringValue)!==-1&&g.raise("Duplicate capture group name"),g.groupNames.push(g.lastStringValue);return}g.raise("Invalid group")}},Br.regexp_eatGroupName=function(g){if(g.lastStringValue="",g.eat(60)){if(this.regexp_eatRegExpIdentifierName(g)&&g.eat(62))return!0;g.raise("Invalid capture group name")}return!1},Br.regexp_eatRegExpIdentifierName=function(g){if(g.lastStringValue="",this.regexp_eatRegExpIdentifierStart(g)){for(g.lastStringValue+=Tn(g.lastIntValue);this.regexp_eatRegExpIdentifierPart(g);)g.lastStringValue+=Tn(g.lastIntValue);return!0}return!1},Br.regexp_eatRegExpIdentifierStart=function(g){var U=g.pos,he=this.options.ecmaVersion>=11,te=g.current(he);return g.advance(he),te===92&&this.regexp_eatRegExpUnicodeEscapeSequence(g,he)&&(te=g.lastIntValue),On(te)?(g.lastIntValue=te,!0):(g.pos=U,!1)};function On(g){return ce(g,!0)||g===36||g===95}Br.regexp_eatRegExpIdentifierPart=function(g){var U=g.pos,he=this.options.ecmaVersion>=11,te=g.current(he);return g.advance(he),te===92&&this.regexp_eatRegExpUnicodeEscapeSequence(g,he)&&(te=g.lastIntValue),Pr(te)?(g.lastIntValue=te,!0):(g.pos=U,!1)};function Pr(g){return at(g,!0)||g===36||g===95||g===8204||g===8205}Br.regexp_eatAtomEscape=function(g){return this.regexp_eatBackReference(g)||this.regexp_eatCharacterClassEscape(g)||this.regexp_eatCharacterEscape(g)||g.switchN&&this.regexp_eatKGroupName(g)?!0:(g.switchU&&(g.current()===99&&g.raise("Invalid unicode escape"),g.raise("Invalid escape")),!1)},Br.regexp_eatBackReference=function(g){var U=g.pos;if(this.regexp_eatDecimalEscape(g)){var he=g.lastIntValue;if(g.switchU)return he>g.maxBackReference&&(g.maxBackReference=he),!0;if(he<=g.numCapturingParens)return!0;g.pos=U}return!1},Br.regexp_eatKGroupName=function(g){if(g.eat(107)){if(this.regexp_eatGroupName(g))return g.backReferenceNames.push(g.lastStringValue),!0;g.raise("Invalid named reference")}return!1},Br.regexp_eatCharacterEscape=function(g){return this.regexp_eatControlEscape(g)||this.regexp_eatCControlLetter(g)||this.regexp_eatZero(g)||this.regexp_eatHexEscapeSequence(g)||this.regexp_eatRegExpUnicodeEscapeSequence(g,!1)||!g.switchU&&this.regexp_eatLegacyOctalEscapeSequence(g)||this.regexp_eatIdentityEscape(g)},Br.regexp_eatCControlLetter=function(g){var U=g.pos;if(g.eat(99)){if(this.regexp_eatControlLetter(g))return!0;g.pos=U}return!1},Br.regexp_eatZero=function(g){return g.current()===48&&!wa(g.lookahead())?(g.lastIntValue=0,g.advance(),!0):!1},Br.regexp_eatControlEscape=function(g){var U=g.current();return U===116?(g.lastIntValue=9,g.advance(),!0):U===110?(g.lastIntValue=10,g.advance(),!0):U===118?(g.lastIntValue=11,g.advance(),!0):U===102?(g.lastIntValue=12,g.advance(),!0):U===114?(g.lastIntValue=13,g.advance(),!0):!1},Br.regexp_eatControlLetter=function(g){var U=g.current();return vi(U)?(g.lastIntValue=U%32,g.advance(),!0):!1};function vi(g){return g>=65&&g<=90||g>=97&&g<=122}Br.regexp_eatRegExpUnicodeEscapeSequence=function(g,U){U===void 0&&(U=!1);var he=g.pos,te=U||g.switchU;if(g.eat(117)){if(this.regexp_eatFixedHexDigits(g,4)){var tt=g.lastIntValue;if(te&&tt>=55296&&tt<=56319){var Pt=g.pos;if(g.eat(92)&&g.eat(117)&&this.regexp_eatFixedHexDigits(g,4)){var fr=g.lastIntValue;if(fr>=56320&&fr<=57343)return g.lastIntValue=(tt-55296)*1024+(fr-56320)+65536,!0}g.pos=Pt,g.lastIntValue=tt}return!0}if(te&&g.eat(123)&&this.regexp_eatHexDigits(g)&&g.eat(125)&&Jn(g.lastIntValue))return!0;te&&g.raise("Invalid unicode escape"),g.pos=he}return!1};function Jn(g){return g>=0&&g<=1114111}Br.regexp_eatIdentityEscape=function(g){if(g.switchU)return this.regexp_eatSyntaxCharacter(g)?!0:g.eat(47)?(g.lastIntValue=47,!0):!1;var U=g.current();return U!==99&&(!g.switchN||U!==107)?(g.lastIntValue=U,g.advance(),!0):!1},Br.regexp_eatDecimalEscape=function(g){g.lastIntValue=0;var U=g.current();if(U>=49&&U<=57){do g.lastIntValue=10*g.lastIntValue+(U-48),g.advance();while((U=g.current())>=48&&U<=57);return!0}return!1},Br.regexp_eatCharacterClassEscape=function(g){var U=g.current();if(ui(U))return g.lastIntValue=-1,g.advance(),!0;if(g.switchU&&this.options.ecmaVersion>=9&&(U===80||U===112)){if(g.lastIntValue=-1,g.advance(),g.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(g)&&g.eat(125))return!0;g.raise("Invalid property name")}return!1};function ui(g){return g===100||g===68||g===115||g===83||g===119||g===87}Br.regexp_eatUnicodePropertyValueExpression=function(g){var U=g.pos;if(this.regexp_eatUnicodePropertyName(g)&&g.eat(61)){var he=g.lastStringValue;if(this.regexp_eatUnicodePropertyValue(g)){var te=g.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(g,he,te),!0}}if(g.pos=U,this.regexp_eatLoneUnicodePropertyNameOrValue(g)){var tt=g.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(g,tt),!0}return!1},Br.regexp_validateUnicodePropertyNameAndValue=function(g,U,he){ir(g.unicodeProperties.nonBinary,U)||g.raise("Invalid property name"),g.unicodeProperties.nonBinary[U].test(he)||g.raise("Invalid property value")},Br.regexp_validateUnicodePropertyNameOrValue=function(g,U){g.unicodeProperties.binary.test(U)||g.raise("Invalid property name")},Br.regexp_eatUnicodePropertyName=function(g){var U=0;for(g.lastStringValue="";Da(U=g.current());)g.lastStringValue+=Tn(U),g.advance();return g.lastStringValue!==""};function Da(g){return vi(g)||g===95}Br.regexp_eatUnicodePropertyValue=function(g){var U=0;for(g.lastStringValue="";Yn(U=g.current());)g.lastStringValue+=Tn(U),g.advance();return g.lastStringValue!==""};function Yn(g){return Da(g)||wa(g)}Br.regexp_eatLoneUnicodePropertyNameOrValue=function(g){return this.regexp_eatUnicodePropertyValue(g)},Br.regexp_eatCharacterClass=function(g){if(g.eat(91)){if(g.eat(94),this.regexp_classRanges(g),g.eat(93))return!0;g.raise("Unterminated character class")}return!1},Br.regexp_classRanges=function(g){for(;this.regexp_eatClassAtom(g);){var U=g.lastIntValue;if(g.eat(45)&&this.regexp_eatClassAtom(g)){var he=g.lastIntValue;g.switchU&&(U===-1||he===-1)&&g.raise("Invalid character class"),U!==-1&&he!==-1&&U>he&&g.raise("Range out of order in character class")}}},Br.regexp_eatClassAtom=function(g){var U=g.pos;if(g.eat(92)){if(this.regexp_eatClassEscape(g))return!0;if(g.switchU){var he=g.current();(he===99||Ka(he))&&g.raise("Invalid class escape"),g.raise("Invalid escape")}g.pos=U}var te=g.current();return te!==93?(g.lastIntValue=te,g.advance(),!0):!1},Br.regexp_eatClassEscape=function(g){var U=g.pos;if(g.eat(98))return g.lastIntValue=8,!0;if(g.switchU&&g.eat(45))return g.lastIntValue=45,!0;if(!g.switchU&&g.eat(99)){if(this.regexp_eatClassControlLetter(g))return!0;g.pos=U}return this.regexp_eatCharacterClassEscape(g)||this.regexp_eatCharacterEscape(g)},Br.regexp_eatClassControlLetter=function(g){var U=g.current();return wa(U)||U===95?(g.lastIntValue=U%32,g.advance(),!0):!1},Br.regexp_eatHexEscapeSequence=function(g){var U=g.pos;if(g.eat(120)){if(this.regexp_eatFixedHexDigits(g,2))return!0;g.switchU&&g.raise("Invalid escape"),g.pos=U}return!1},Br.regexp_eatDecimalDigits=function(g){var U=g.pos,he=0;for(g.lastIntValue=0;wa(he=g.current());)g.lastIntValue=10*g.lastIntValue+(he-48),g.advance();return g.pos!==U};function wa(g){return g>=48&&g<=57}Br.regexp_eatHexDigits=function(g){var U=g.pos,he=0;for(g.lastIntValue=0;vo(he=g.current());)g.lastIntValue=16*g.lastIntValue+Ua(he),g.advance();return g.pos!==U};function vo(g){return g>=48&&g<=57||g>=65&&g<=70||g>=97&&g<=102}function Ua(g){return g>=65&&g<=70?10+(g-65):g>=97&&g<=102?10+(g-97):g-48}Br.regexp_eatLegacyOctalEscapeSequence=function(g){if(this.regexp_eatOctalDigit(g)){var U=g.lastIntValue;if(this.regexp_eatOctalDigit(g)){var he=g.lastIntValue;U<=3&&this.regexp_eatOctalDigit(g)?g.lastIntValue=U*64+he*8+g.lastIntValue:g.lastIntValue=U*8+he}else g.lastIntValue=U;return!0}return!1},Br.regexp_eatOctalDigit=function(g){var U=g.current();return Ka(U)?(g.lastIntValue=U-48,g.advance(),!0):(g.lastIntValue=0,!1)};function Ka(g){return g>=48&&g<=55}Br.regexp_eatFixedHexDigits=function(g,U){var he=g.pos;g.lastIntValue=0;for(var te=0;te<U;++te){var tt=g.current();if(!vo(tt))return g.pos=he,!1;g.lastIntValue=16*g.lastIntValue+Ua(tt),g.advance()}return!0};var Ga=function(U){this.type=U.type,this.value=U.value,this.start=U.start,this.end=U.end,U.options.locations&&(this.loc=new kt(U,U.startLoc,U.endLoc)),U.options.ranges&&(this.range=[U.start,U.end])},ei=ue.prototype;ei.next=function(g){!g&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Ga(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},ei.getToken=function(){return this.next(),new Ga(this)},typeof Symbol!="undefined"&&(ei[Symbol.iterator]=function(){var g=this;return{next:function(){var U=g.getToken();return{done:U.type===re.eof,value:U}}}}),ei.curContext=function(){return this.context[this.context.length-1]},ei.nextToken=function(){var g=this.curContext();if((!g||!g.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(re.eof);if(g.override)return g.override(this);this.readToken(this.fullCharCodeAtPos())},ei.readToken=function(g){return ce(g,this.options.ecmaVersion>=6)||g===92?this.readWord():this.getTokenFromCode(g)},ei.fullCharCodeAtPos=function(){var g=this.input.charCodeAt(this.pos);if(g<=55295||g>=57344)return g;var U=this.input.charCodeAt(this.pos+1);return(g<<10)+U-56613888},ei.skipBlockComment=function(){var g=this.options.onComment&&this.curPosition(),U=this.pos,he=this.input.indexOf("*/",this.pos+=2);if(he===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=he+2,this.options.locations){Qe.lastIndex=U;for(var te;(te=Qe.exec(this.input))&&te.index<this.pos;)++this.curLine,this.lineStart=te.index+te[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(U+2,he),U,this.pos,g,this.curPosition())},ei.skipLineComment=function(g){for(var U=this.pos,he=this.options.onComment&&this.curPosition(),te=this.input.charCodeAt(this.pos+=g);this.pos<this.input.length&&!Te(te);)te=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(U+g,this.pos),U,this.pos,he,this.curPosition())},ei.skipSpace=function(){e:for(;this.pos<this.input.length;){var g=this.input.charCodeAt(this.pos);switch(g){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(g>8&&g<14||g>=5760&&Le.test(String.fromCharCode(g)))++this.pos;else break e}}},ei.finishToken=function(g,U){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var he=this.type;this.type=g,this.value=U,this.updateContext(he)},ei.readToken_dot=function(){var g=this.input.charCodeAt(this.pos+1);if(g>=48&&g<=57)return this.readNumber(!0);var U=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&g===46&&U===46?(this.pos+=3,this.finishToken(re.ellipsis)):(++this.pos,this.finishToken(re.dot))},ei.readToken_slash=function(){var g=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):g===61?this.finishOp(re.assign,2):this.finishOp(re.slash,1)},ei.readToken_mult_modulo_exp=function(g){var U=this.input.charCodeAt(this.pos+1),he=1,te=g===42?re.star:re.modulo;return this.options.ecmaVersion>=7&&g===42&&U===42&&(++he,te=re.starstar,U=this.input.charCodeAt(this.pos+2)),U===61?this.finishOp(re.assign,he+1):this.finishOp(te,he)},ei.readToken_pipe_amp=function(g){var U=this.input.charCodeAt(this.pos+1);if(U===g){if(this.options.ecmaVersion>=12){var he=this.input.charCodeAt(this.pos+2);if(he===61)return this.finishOp(re.assign,3)}return this.finishOp(g===124?re.logicalOR:re.logicalAND,2)}return U===61?this.finishOp(re.assign,2):this.finishOp(g===124?re.bitwiseOR:re.bitwiseAND,1)},ei.readToken_caret=function(){var g=this.input.charCodeAt(this.pos+1);return g===61?this.finishOp(re.assign,2):this.finishOp(re.bitwiseXOR,1)},ei.readToken_plus_min=function(g){var U=this.input.charCodeAt(this.pos+1);return U===g?U===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Ge.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(re.incDec,2):U===61?this.finishOp(re.assign,2):this.finishOp(re.plusMin,1)},ei.readToken_lt_gt=function(g){var U=this.input.charCodeAt(this.pos+1),he=1;return U===g?(he=g===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+he)===61?this.finishOp(re.assign,he+1):this.finishOp(re.bitShift,he)):U===33&&g===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(U===61&&(he=2),this.finishOp(re.relational,he))},ei.readToken_eq_excl=function(g){var U=this.input.charCodeAt(this.pos+1);return U===61?this.finishOp(re.equality,this.input.charCodeAt(this.pos+2)===61?3:2):g===61&&U===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(re.arrow)):this.finishOp(g===61?re.eq:re.prefix,1)},ei.readToken_question=function(){var g=this.options.ecmaVersion;if(g>=11){var U=this.input.charCodeAt(this.pos+1);if(U===46){var he=this.input.charCodeAt(this.pos+2);if(he<48||he>57)return this.finishOp(re.questionDot,2)}if(U===63){if(g>=12){var te=this.input.charCodeAt(this.pos+2);if(te===61)return this.finishOp(re.assign,3)}return this.finishOp(re.coalesce,2)}}return this.finishOp(re.question,1)},ei.getTokenFromCode=function(g){switch(g){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(re.parenL);case 41:return++this.pos,this.finishToken(re.parenR);case 59:return++this.pos,this.finishToken(re.semi);case 44:return++this.pos,this.finishToken(re.comma);case 91:return++this.pos,this.finishToken(re.bracketL);case 93:return++this.pos,this.finishToken(re.bracketR);case 123:return++this.pos,this.finishToken(re.braceL);case 125:return++this.pos,this.finishToken(re.braceR);case 58:return++this.pos,this.finishToken(re.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(re.backQuote);case 48:var U=this.input.charCodeAt(this.pos+1);if(U===120||U===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(U===111||U===79)return this.readRadixNumber(8);if(U===98||U===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(g);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(g);case 124:case 38:return this.readToken_pipe_amp(g);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(g);case 60:case 62:return this.readToken_lt_gt(g);case 61:case 33:return this.readToken_eq_excl(g);case 63:return this.readToken_question();case 126:return this.finishOp(re.prefix,1)}this.raise(this.pos,"Unexpected character '"+Rn(g)+"'")},ei.finishOp=function(g,U){var he=this.input.slice(this.pos,this.pos+U);return this.pos+=U,this.finishToken(g,he)},ei.readRegexp=function(){for(var g,U,he=this.pos;;){this.pos>=this.input.length&&this.raise(he,"Unterminated regular expression");var te=this.input.charAt(this.pos);if(Ge.test(te)&&this.raise(he,"Unterminated regular expression"),g)g=!1;else{if(te==="[")U=!0;else if(te==="]"&&U)U=!1;else if(te==="/"&&!U)break;g=te==="\\"}++this.pos}var tt=this.input.slice(he,this.pos);++this.pos;var Pt=this.pos,fr=this.readWord1();this.containsEsc&&this.unexpected(Pt);var Fr=this.regexpState||(this.regexpState=new Jr(this));Fr.reset(he,tt,fr),this.validateRegExpFlags(Fr),this.validateRegExpPattern(Fr);var zr=null;try{zr=new RegExp(tt,fr)}catch(En){}return this.finishToken(re.regexp,{pattern:tt,flags:fr,value:zr})},ei.readInt=function(g,U,he){for(var te=this.options.ecmaVersion>=12&&U===void 0,tt=he&&this.input.charCodeAt(this.pos)===48,Pt=this.pos,fr=0,Fr=0,zr=0,En=U==null?Infinity:U;zr<En;++zr,++this.pos){var Dn=this.input.charCodeAt(this.pos),na=void 0;if(te&&Dn===95){tt&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Fr===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),zr===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Fr=Dn;continue}if(Dn>=97?na=Dn-97+10:Dn>=65?na=Dn-65+10:Dn>=48&&Dn<=57?na=Dn-48:na=Infinity,na>=g)break;Fr=Dn,fr=fr*g+na}return te&&Fr===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Pt||U!=null&&this.pos-Pt!==U?null:fr};function eo(g,U){return U?parseInt(g,8):parseFloat(g.replace(/_/g,""))}function ra(g){return typeof BigInt!="function"?null:BigInt(g.replace(/_/g,""))}ei.readRadixNumber=function(g){var U=this.pos;this.pos+=2;var he=this.readInt(g);return he==null&&this.raise(this.start+2,"Expected number in radix "+g),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(he=ra(this.input.slice(U,this.pos)),++this.pos):ce(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(re.num,he)},ei.readNumber=function(g){var U=this.pos;!g&&this.readInt(10,void 0,!0)===null&&this.raise(U,"Invalid number");var he=this.pos-U>=2&&this.input.charCodeAt(U)===48;he&&this.strict&&this.raise(U,"Invalid number");var te=this.input.charCodeAt(this.pos);if(!he&&!g&&this.options.ecmaVersion>=11&&te===110){var tt=ra(this.input.slice(U,this.pos));return++this.pos,ce(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(re.num,tt)}he&&/[89]/.test(this.input.slice(U,this.pos))&&(he=!1),te===46&&!he&&(++this.pos,this.readInt(10),te=this.input.charCodeAt(this.pos)),(te===69||te===101)&&!he&&(te=this.input.charCodeAt(++this.pos),(te===43||te===45)&&++this.pos,this.readInt(10)===null&&this.raise(U,"Invalid number")),ce(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Pt=eo(this.input.slice(U,this.pos),he);return this.finishToken(re.num,Pt)},ei.readCodePoint=function(){var g=this.input.charCodeAt(this.pos),U;if(g===123){this.options.ecmaVersion<6&&this.unexpected();var he=++this.pos;U=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,U>1114111&&this.invalidStringToken(he,"Code point out of bounds")}else U=this.readHexChar(4);return U};function Rn(g){return g<=65535?String.fromCharCode(g):(g-=65536,String.fromCharCode((g>>10)+55296,(g&1023)+56320))}ei.readString=function(g){for(var U="",he=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var te=this.input.charCodeAt(this.pos);if(te===g)break;te===92?(U+=this.input.slice(he,this.pos),U+=this.readEscapedChar(!1),he=this.pos):(Te(te,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return U+=this.input.slice(he,this.pos++),this.finishToken(re.string,U)};var qa={};ei.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(g){if(g===qa)this.readInvalidTemplateToken();else throw g}this.inTemplateElement=!1},ei.invalidStringToken=function(g,U){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw qa;this.raise(g,U)},ei.readTmplToken=function(){for(var g="",U=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var he=this.input.charCodeAt(this.pos);if(he===96||he===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===re.template||this.type===re.invalidTemplate)?he===36?(this.pos+=2,this.finishToken(re.dollarBraceL)):(++this.pos,this.finishToken(re.backQuote)):(g+=this.input.slice(U,this.pos),this.finishToken(re.template,g));if(he===92)g+=this.input.slice(U,this.pos),g+=this.readEscapedChar(!0),U=this.pos;else if(Te(he)){switch(g+=this.input.slice(U,this.pos),++this.pos,he){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:g+=`
`;break;default:g+=String.fromCharCode(he);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),U=this.pos}else++this.pos}},ei.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(re.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},ei.readEscapedChar=function(g){var U=this.input.charCodeAt(++this.pos);switch(++this.pos,U){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Rn(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(g){var he=this.pos-1;return this.invalidStringToken(he,"Invalid escape sequence in template string"),null}default:if(U>=48&&U<=55){var te=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],tt=parseInt(te,8);return tt>255&&(te=te.slice(0,-1),tt=parseInt(te,8)),this.pos+=te.length-1,U=this.input.charCodeAt(this.pos),(te!=="0"||U===56||U===57)&&(this.strict||g)&&this.invalidStringToken(this.pos-1-te.length,g?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(tt)}return Te(U)?"":String.fromCharCode(U)}},ei.readHexChar=function(g){var U=this.pos,he=this.readInt(16,g);return he===null&&this.invalidStringToken(U,"Bad character escape sequence"),he},ei.readWord1=function(){this.containsEsc=!1;for(var g="",U=!0,he=this.pos,te=this.options.ecmaVersion>=6;this.pos<this.input.length;){var tt=this.fullCharCodeAtPos();if(at(tt,te))this.pos+=tt<=65535?1:2;else if(tt===92){this.containsEsc=!0,g+=this.input.slice(he,this.pos);var Pt=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var fr=this.readCodePoint();(U?ce:at)(fr,te)||this.invalidStringToken(Pt,"Invalid Unicode escape"),g+=Rn(fr),he=this.pos}else break;U=!1}return g+this.input.slice(he,this.pos)},ei.readWord=function(){var g=this.readWord1(),U=re.name;return this.keywords.test(g)&&(U=fe[g]),this.finishToken(U,g)};var ba="7.4.1";ue.acorn={Parser:ue,version:ba,defaultOptions:me,Position:Xe,SourceLocation:kt,getLineInfo:rr,Node:bn,TokenType:rt,tokTypes:re,keywordTypes:fe,TokContext:$r,tokContexts:Zt,isIdentifierChar:at,isIdentifierStart:ce,Token:Ga,isNewLine:Te,lineBreak:Ge,lineBreakG:Qe,nonASCIIwhitespace:Le};function Na(g,U){return ue.parse(g,U)}function wo(g,U,he){return ue.parseExpressionAt(g,U,he)}function ya(g,U){return ue.tokenizer(g,U)}function Gt(g,U){g.prototype=Object.create(U.prototype),g.prototype.constructor=g,g.__proto__=U}function gs(g){var U=typeof Map=="function"?new Map:void 0;return gs=function(te){if(te===null||!ll(te))return te;if(typeof te!="function")throw new TypeError("Super expression must either be null or a function");if(typeof U!="undefined"){if(U.has(te))return U.get(te);U.set(te,tt)}function tt(){return So(te,arguments,rs(this).constructor)}return tt.prototype=Object.create(te.prototype,{constructor:{value:tt,enumerable:!1,writable:!0,configurable:!0}}),Ss(tt,te)},gs(g)}function Qi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(g){return!1}}function So(g,U,he){return Qi()?So=Reflect.construct:So=function(tt,Pt,fr){var Fr=[null];Fr.push.apply(Fr,Pt);var zr=Function.bind.apply(tt,Fr),En=new zr;return fr&&Ss(En,fr.prototype),En},So.apply(null,arguments)}function ll(g){return Function.toString.call(g).indexOf("[native code]")!==-1}function Ss(g,U){return Ss=Object.setPrototypeOf||function(te,tt){return te.__proto__=tt,te},Ss(g,U)}function rs(g){return rs=Object.setPrototypeOf?Object.getPrototypeOf:function(he){return he.__proto__||Object.getPrototypeOf(he)},rs(g)}var ls=function(g){Gt(U,g);function U(){return g.apply(this,arguments)||this}return U}(gs(Error)),Ia=function(g){Gt(U,g);function U(){return g.apply(this,arguments)||this}return U}(gs(SyntaxError)),Ms=function(g){Gt(U,g);function U(){return g.apply(this,arguments)||this}return U}(gs(ReferenceError)),uo=function(g){Gt(U,g);function U(){return g.apply(this,arguments)||this}return U}(gs(TypeError)),Qs=function(g){Gt(U,g);function U(){return g.apply(this,arguments)||this}return U}(ls),Ao=function(g){Gt(U,g);function U(){return g.apply(this,arguments)||this}return U}(Ia),Ts=function(g){Gt(U,g);function U(){return g.apply(this,arguments)||this}return U}(Ms),ua={UnknownError:[3001,"%0",Qs],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",Qs],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Ts],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Ts],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Ts],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Ts],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Ts],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Ts],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Ts],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Ts],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Ts],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Ts],FunctionUndefinedReferenceError:[2001,"%0 is not a function",Ms],VariableUndefinedReferenceError:[2002,"%0 is not defined",Ms],IsNotConstructor:[2003,"%0 is not a constructor",uo]};function cs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(g){return!1}}function Ds(g,U,he){return cs()?Ds=Reflect.construct:Ds=function(tt,Pt,fr){var Fr=[null];Fr.push.apply(Fr,Pt);var zr=Function.bind.apply(tt,Fr),En=new zr;return fr&&Ro(En,fr.prototype),En},Ds.apply(null,arguments)}function Ro(g,U){return Ro=Object.setPrototypeOf||function(te,tt){return te.__proto__=tt,te},Ro(g,U)}var Eu="0.0.3";function ec(g,U){Object.defineProperty(g,"name",{value:U,writable:!1,enumerable:!1,configurable:!0})}var Gs=Object.prototype.hasOwnProperty,ft=Symbol("Break"),St=Symbol("Continue"),_r=Symbol("DefaultCase"),Or=Symbol("EmptyStatementReturn"),$n=Symbol("WithScopeName"),Gi=Symbol("SuperScopeName"),to=Symbol("RootScopeName"),Je=Symbol("GlobalScopeName");function It(g){return typeof g=="function"}var Ot=function(){function g(he){this.interpreter=he}var U=g.prototype;return U.generator=function(){var te=this.interpreter;function tt(){return this.getCurrentScope()}function Pt(){return this.getGlobalScope()}function fr(){return this.getCurrentContext()}return{getOptions:te.getOptions.bind(te),getCurrentScope:tt.bind(te),getGlobalScope:Pt.bind(te),getCurrentContext:fr.bind(te),getExecStartTime:te.getExecStartTime.bind(te)}},g}();function Xt(g,U,he){if(he===void 0&&(he=!0),!(g instanceof Ot))throw new Error("Illegal call");if(typeof U!="string")return U;if(!!U){var te=g.generator(),tt=te.getOptions(),Pt={timeout:tt.timeout,_initEnv:function(){he||this.setCurrentContext(te.getCurrentContext()),this.execStartTime=te.getExecStartTime(),this.execEndTime=this.execStartTime}},fr=he?te.getGlobalScope():te.getCurrentScope(),Fr=new ia(fr,Pt);return Fr.evaluate(U)}}Object.defineProperty(Xt,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function Dr(g){if(!(g instanceof Ot))throw new Error("Illegal call");for(var U=g.generator(),he=arguments.length,te=new Array(he>1?he-1:0),tt=1;tt<he;tt++)te[tt-1]=arguments[tt];var Pt=te.pop(),fr=new ia(U.getGlobalScope(),U.getOptions()),Fr=`
		    (function anonymous(`+te.join(",")+`){
		        `+Pt+`
		    });
		    `;return fr.evaluate(Fr)}Object.defineProperty(Dr,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var Lr=function(U){this.value=U},_n=function(U){this.value=U},Un=function(U){this.value=U},mn=function(U,he,te){he===void 0&&(he=null),this.name=te,this.parent=he,this.data=U,this.labelStack=[]};function mi(){}function Oa(g,U){return g===void 0&&(g=null),new mn(Object.create(null),g,U)}function Fn(g){return Object.create(g)}var ci={NaN:NaN,Infinity:Infinity,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:Xt,Function:Dr};typeof JSON!="undefined"&&(ci.JSON=JSON),typeof Promise!="undefined"&&(ci.Promise=Promise),typeof Set!="undefined"&&(ci.Set=Set),typeof Map!="undefined"&&(ci.Map=Map),typeof Symbol!="undefined"&&(ci.Symbol=Symbol),typeof Proxy!="undefined"&&(ci.Proxy=Proxy),typeof WeakMap!="undefined"&&(ci.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(ci.WeakSet=WeakSet),typeof Reflect!="undefined"&&(ci.Reflect=Reflect);var ia=function(){function g(he,te){he===void 0&&(he=g.global),te===void 0&&(te={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:te.ecmaVersion||g.ecmaVersion,timeout:te.timeout||0,rootContext:te.rootContext,globalContextInFunction:te.globalContextInFunction===void 0?g.globalContextInFunction:te.globalContextInFunction,_initEnv:te._initEnv},this.context=he||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var U=g.prototype;return U.initEnvironment=function(te){var tt;if(te instanceof mn)tt=te;else{var Pt=null,fr=this.createSuperScope(te);this.options.rootContext&&(Pt=new mn(Fn(this.options.rootContext),fr,to)),tt=new mn(te,Pt||fr,Je)}this.globalScope=tt,this.currentScope=this.globalScope,this.globalContext=tt.data,this.currentContext=tt.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var Fr=this.options._initEnv;Fr&&Fr.call(this)},U.getExecStartTime=function(){return this.execStartTime},U.getExecutionTime=function(){return this.execEndTime-this.execStartTime},U.setExecTimeout=function(te){te===void 0&&(te=0),this.options.timeout=te},U.getOptions=function(){return this.options},U.getGlobalScope=function(){return this.globalScope},U.getCurrentScope=function(){return this.currentScope},U.getCurrentContext=function(){return this.currentContext},U.isInterruptThrow=function(te){return te instanceof Qs||te instanceof Ts||te instanceof Ao},U.createSuperScope=function(te){var tt=Object.assign({},ci),Pt=Object.keys(tt);return Pt.forEach(function(fr){fr in te&&delete tt[fr]}),new mn(tt,null,Gi)},U.setCurrentContext=function(te){this.currentContext=te},U.setCurrentScope=function(te){this.currentScope=te},U.evaluate=function(te){te===void 0&&(te="");var tt;if(!!te)return tt=Na(te,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||g.ecmaVersion}),this.evaluateNode(tt,te)},U.appendCode=function(te){return this.evaluate(te)},U.evaluateNode=function(te,tt){var Pt=this;tt===void 0&&(tt=""),this.value=void 0,this.source=tt,this.sourceList.push(tt),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var fr=this.getCurrentScope(),Fr=this.getCurrentContext(),zr=fr.labelStack.concat([]),En=this.callStack.concat([]),Dn=function(){Pt.setCurrentScope(fr),Pt.setCurrentContext(Fr),fr.labelStack=zr,Pt.callStack=En};try{var na=this.createClosure(te);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),na()}catch(ka){throw ka}finally{Dn(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},U.createErrorMessage=function(te,tt,Pt){var fr=te[1].replace("%0",String(tt));return Pt!==null&&(fr+=this.getNodePosition(Pt||this.lastExecNode)),fr},U.createError=function(te,tt){return new tt(te)},U.createThrowError=function(te,tt){return this.createError(te,tt)},U.createInternalThrowError=function(te,tt,Pt){return this.createError(this.createErrorMessage(te,tt,Pt),te[2])},U.checkTimeout=function(){if(!this.isRunning)return!1;var te=this.options.timeout||0,tt=Date.now();return tt-this.execStartTime>te},U.getNodePosition=function(te){if(te){var tt="";return te.loc?" ["+te.loc.start.line+":"+te.loc.start.column+"]"+tt:""}return""},U.createClosure=function(te){var tt=this,Pt;switch(te.type){case"BinaryExpression":Pt=this.binaryExpressionHandler(te);break;case"LogicalExpression":Pt=this.logicalExpressionHandler(te);break;case"UnaryExpression":Pt=this.unaryExpressionHandler(te);break;case"UpdateExpression":Pt=this.updateExpressionHandler(te);break;case"ObjectExpression":Pt=this.objectExpressionHandler(te);break;case"ArrayExpression":Pt=this.arrayExpressionHandler(te);break;case"CallExpression":Pt=this.callExpressionHandler(te);break;case"NewExpression":Pt=this.newExpressionHandler(te);break;case"MemberExpression":Pt=this.memberExpressionHandler(te);break;case"ThisExpression":Pt=this.thisExpressionHandler(te);break;case"SequenceExpression":Pt=this.sequenceExpressionHandler(te);break;case"Literal":Pt=this.literalHandler(te);break;case"Identifier":Pt=this.identifierHandler(te);break;case"AssignmentExpression":Pt=this.assignmentExpressionHandler(te);break;case"FunctionDeclaration":Pt=this.functionDeclarationHandler(te);break;case"VariableDeclaration":Pt=this.variableDeclarationHandler(te);break;case"BlockStatement":case"Program":Pt=this.programHandler(te);break;case"ExpressionStatement":Pt=this.expressionStatementHandler(te);break;case"EmptyStatement":Pt=this.emptyStatementHandler(te);break;case"ReturnStatement":Pt=this.returnStatementHandler(te);break;case"FunctionExpression":Pt=this.functionExpressionHandler(te);break;case"IfStatement":Pt=this.ifStatementHandler(te);break;case"ConditionalExpression":Pt=this.conditionalExpressionHandler(te);break;case"ForStatement":Pt=this.forStatementHandler(te);break;case"WhileStatement":Pt=this.whileStatementHandler(te);break;case"DoWhileStatement":Pt=this.doWhileStatementHandler(te);break;case"ForInStatement":Pt=this.forInStatementHandler(te);break;case"WithStatement":Pt=this.withStatementHandler(te);break;case"ThrowStatement":Pt=this.throwStatementHandler(te);break;case"TryStatement":Pt=this.tryStatementHandler(te);break;case"ContinueStatement":Pt=this.continueStatementHandler(te);break;case"BreakStatement":Pt=this.breakStatementHandler(te);break;case"SwitchStatement":Pt=this.switchStatementHandler(te);break;case"LabeledStatement":Pt=this.labeledStatementHandler(te);break;case"DebuggerStatement":Pt=this.debuggerStatementHandler(te);break;default:throw this.createInternalThrowError(ua.NodeTypeSyntaxError,te.type,te)}return function(){var fr=tt.options.timeout;if(fr&&fr>0&&tt.checkTimeout())throw tt.createInternalThrowError(ua.ExecutionTimeOutError,fr,null);return tt.lastExecNode=te,Pt.apply(void 0,arguments)}},U.binaryExpressionHandler=function(te){var tt=this,Pt=this.createClosure(te.left),fr=this.createClosure(te.right);return function(){var Fr=Pt(),zr=fr();switch(te.operator){case"==":return Fr==zr;case"!=":return Fr!=zr;case"===":return Fr===zr;case"!==":return Fr!==zr;case"<":return Fr<zr;case"<=":return Fr<=zr;case">":return Fr>zr;case">=":return Fr>=zr;case"<<":return Fr<<zr;case">>":return Fr>>zr;case">>>":return Fr>>>zr;case"+":return Fr+zr;case"-":return Fr-zr;case"*":return Fr*zr;case"**":return Math.pow(Fr,zr);case"/":return Fr/zr;case"%":return Fr%zr;case"|":return Fr|zr;case"^":return Fr^zr;case"&":return Fr&zr;case"in":return Fr in zr;case"instanceof":return Fr instanceof zr;default:throw tt.createInternalThrowError(ua.BinaryOperatorSyntaxError,te.operator,te)}}},U.logicalExpressionHandler=function(te){var tt=this,Pt=this.createClosure(te.left),fr=this.createClosure(te.right);return function(){switch(te.operator){case"||":return Pt()||fr();case"&&":return Pt()&&fr();default:throw tt.createInternalThrowError(ua.LogicalOperatorSyntaxError,te.operator,te)}}},U.unaryExpressionHandler=function(te){var tt=this;switch(te.operator){case"delete":var Pt=this.createObjectGetter(te.argument),fr=this.createNameGetter(te.argument);return function(){var Dn=Pt(),na=fr();return delete Dn[na]};default:var Fr;if(te.operator==="typeof"&&te.argument.type==="Identifier"){var zr=this.createObjectGetter(te.argument),En=this.createNameGetter(te.argument);Fr=function(){return zr()[En()]}}else Fr=this.createClosure(te.argument);return function(){var Dn=Fr();switch(te.operator){case"-":return-Dn;case"+":return+Dn;case"!":return!Dn;case"~":return~Dn;case"void":return;case"typeof":return typeof Dn;default:throw tt.createInternalThrowError(ua.UnaryOperatorSyntaxError,te.operator,te)}}}},U.updateExpressionHandler=function(te){var tt=this,Pt=this.createObjectGetter(te.argument),fr=this.createNameGetter(te.argument);return function(){var Fr=Pt(),zr=fr();switch(tt.assertVariable(Fr,zr,te),te.operator){case"++":return te.prefix?++Fr[zr]:Fr[zr]++;case"--":return te.prefix?--Fr[zr]:Fr[zr]--;default:throw tt.createInternalThrowError(ua.UpdateOperatorSyntaxError,te.operator,te)}}},U.objectExpressionHandler=function(te){var tt=this,Pt=[];function fr(zr){return zr.type==="Identifier"?zr.name:zr.type==="Literal"?zr.value:this.throwError(ua.ObjectStructureSyntaxError,zr.type,zr)}var Fr=Object.create(null);return te.properties.forEach(function(zr){var En=zr.kind,Dn=fr(zr.key);(!Fr[Dn]||En==="init")&&(Fr[Dn]={}),Fr[Dn][En]=tt.createClosure(zr.value),Pt.push({key:Dn,property:zr})}),function(){for(var zr={},En=Pt.length,Dn=0;Dn<En;Dn++){var na=Pt[Dn],ka=na.key,ha=Fr[ka],Fa=ha.init?ha.init():void 0,Mo=ha.get?ha.get():function(){},Po=ha.set?ha.set():function(Zu){};if("set"in ha||"get"in ha){var go={configurable:!0,enumerable:!0,get:Mo,set:Po};Object.defineProperty(zr,ka,go)}else{var fu=na.property,yo=fu.kind;fu.key.type==="Identifier"&&fu.value.type==="FunctionExpression"&&yo==="init"&&!fu.value.id&&ec(Fa,fu.key.name),zr[ka]=Fa}}return zr}},U.arrayExpressionHandler=function(te){var tt=this,Pt=te.elements.map(function(fr){return fr&&tt.createClosure(fr)});return function(){for(var fr=Pt.length,Fr=Array(fr),zr=0;zr<fr;zr++){var En=Pt[zr];En&&(Fr[zr]=En())}return Fr}},U.safeObjectGet=function(te,tt,Pt){return te[tt]},U.createCallFunctionGetter=function(te){var tt=this;switch(te.type){case"MemberExpression":var Pt=this.createClosure(te.object),fr=this.createMemberKeyGetter(te),Fr=this.source;return function(){var En=Pt(),Dn=fr(),na=tt.safeObjectGet(En,Dn,te);if(!na||!It(na)){var ka=Fr.slice(te.start,te.end);throw tt.createInternalThrowError(ua.FunctionUndefinedReferenceError,ka,te)}return na.__IS_EVAL_FUNC?function(ha){return na(new Ot(tt),ha,!0)}:na.__IS_FUNCTION_FUNC?function(){for(var ha=arguments.length,Fa=new Array(ha),Mo=0;Mo<ha;Mo++)Fa[Mo]=arguments[Mo];return na.apply(void 0,[new Ot(tt)].concat(Fa))}:na.bind(En)};default:var zr=this.createClosure(te);return function(){var En="";te.type==="Identifier"&&(En=te.name);var Dn=zr();if(!Dn||!It(Dn))throw tt.createInternalThrowError(ua.FunctionUndefinedReferenceError,En,te);if(te.type==="Identifier"&&Dn.__IS_EVAL_FUNC&&En==="eval")return function(ha){var Fa=tt.getScopeFromName(En,tt.getCurrentScope()),Mo=Fa.name===Gi||Fa.name===Je||Fa.name===to;return Dn(new Ot(tt),ha,!Mo)};if(Dn.__IS_EVAL_FUNC)return function(ha){return Dn(new Ot(tt),ha,!0)};if(Dn.__IS_FUNCTION_FUNC)return function(){for(var ha=arguments.length,Fa=new Array(ha),Mo=0;Mo<ha;Mo++)Fa[Mo]=arguments[Mo];return Dn.apply(void 0,[new Ot(tt)].concat(Fa))};var na=tt.options.globalContextInFunction;if(te.type==="Identifier"){var ka=tt.getIdentifierScope(te);ka.name===$n&&(na=ka.data)}return Dn.bind(na)}}},U.callExpressionHandler=function(te){var tt=this,Pt=this.createCallFunctionGetter(te.callee),fr=te.arguments.map(function(Fr){return tt.createClosure(Fr)});return function(){return Pt().apply(void 0,fr.map(function(Fr){return Fr()}))}},U.functionExpressionHandler=function(te){var tt=this,Pt=this,fr=this.source,Fr=this.collectDeclVars,zr=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var En=te.id?te.id.name:"",Dn=te.params.length,na=te.params.map(function(Mo){return tt.createParamNameGetter(Mo)}),ka=this.createClosure(te.body),ha=this.collectDeclVars,Fa=this.collectDeclFuncs;return this.collectDeclVars=Fr,this.collectDeclFuncs=zr,function(){var Mo=Pt.getCurrentScope(),Po=function go(){for(var fu=arguments.length,yo=new Array(fu),Zu=0;Zu<fu;Zu++)yo[Zu]=arguments[Zu];Pt.callStack.push(""+En);var tc=Pt.getCurrentScope(),ws=Oa(Mo,"FunctionScope("+En+")");Pt.setCurrentScope(ws),Pt.addDeclarationsToScope(ha,Fa,ws),En&&(ws.data[En]=go),ws.data.arguments=arguments,na.forEach(function(Ku,xl){ws.data[Ku()]=yo[xl]});var Nc=Pt.getCurrentContext();Pt.setCurrentContext(this);var $u=ka();if(Pt.setCurrentContext(Nc),Pt.setCurrentScope(tc),Pt.callStack.pop(),$u instanceof Lr)return $u.value};return ec(Po,En),Object.defineProperty(Po,"length",{value:Dn,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Po,"toString",{value:function(){return fr.slice(te.start,te.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Po,"valueOf",{value:function(){return fr.slice(te.start,te.end)},writable:!0,configurable:!0,enumerable:!1}),Po}},U.newExpressionHandler=function(te){var tt=this,Pt=this.source,fr=this.createClosure(te.callee),Fr=te.arguments.map(function(zr){return tt.createClosure(zr)});return function(){var zr=fr();if(!It(zr)||zr.__IS_EVAL_FUNC){var En=te.callee,Dn=Pt.slice(En.start,En.end);throw tt.createInternalThrowError(ua.IsNotConstructor,Dn,te)}return zr.__IS_FUNCTION_FUNC?zr.apply(void 0,[new Ot(tt)].concat(Fr.map(function(na){return na()}))):Ds(zr,Fr.map(function(na){return na()}))}},U.memberExpressionHandler=function(te){var tt=this.createClosure(te.object),Pt=this.createMemberKeyGetter(te);return function(){var fr=tt(),Fr=Pt();return fr[Fr]}},U.thisExpressionHandler=function(te){var tt=this;return function(){return tt.getCurrentContext()}},U.sequenceExpressionHandler=function(te){var tt=this,Pt=te.expressions.map(function(fr){return tt.createClosure(fr)});return function(){for(var fr,Fr=Pt.length,zr=0;zr<Fr;zr++){var En=Pt[zr];fr=En()}return fr}},U.literalHandler=function(te){return function(){return te.regex?new RegExp(te.regex.pattern,te.regex.flags):te.value}},U.identifierHandler=function(te){var tt=this;return function(){var Pt=tt.getCurrentScope(),fr=tt.getScopeDataFromName(te.name,Pt);return tt.assertVariable(fr,te.name,te),fr[te.name]}},U.getIdentifierScope=function(te){var tt=this.getCurrentScope(),Pt=this.getScopeFromName(te.name,tt);return Pt},U.assignmentExpressionHandler=function(te){var tt=this;te.left.type==="Identifier"&&te.right.type==="FunctionExpression"&&!te.right.id&&(te.right.id={type:"Identifier",name:te.left.name});var Pt=this.createObjectGetter(te.left),fr=this.createNameGetter(te.left),Fr=this.createClosure(te.right);return function(){var zr=Pt(),En=fr(),Dn=Fr();switch(te.operator!=="="&&tt.assertVariable(zr,En,te),te.operator){case"=":return zr[En]=Dn;case"+=":return zr[En]+=Dn;case"-=":return zr[En]-=Dn;case"*=":return zr[En]*=Dn;case"**=":return zr[En]=Math.pow(zr[En],Dn);case"/=":return zr[En]/=Dn;case"%=":return zr[En]%=Dn;case"<<=":return zr[En]<<=Dn;case">>=":return zr[En]>>=Dn;case">>>=":return zr[En]>>>=Dn;case"&=":return zr[En]&=Dn;case"^=":return zr[En]^=Dn;case"|=":return zr[En]|=Dn;default:throw tt.createInternalThrowError(ua.AssignmentExpressionSyntaxError,te.type,te)}}},U.functionDeclarationHandler=function(te){if(te.id){var tt=this.functionExpressionHandler(te);Object.defineProperty(tt,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(te.id.name,tt)}return function(){return Or}},U.getVariableName=function(te){if(te.type==="Identifier")return te.name;throw this.createInternalThrowError(ua.VariableTypeSyntaxError,te.type,te)},U.variableDeclarationHandler=function(te){for(var tt=this,Pt,fr=[],Fr=0;Fr<te.declarations.length;Fr++){var zr=te.declarations[Fr];this.varDeclaration(this.getVariableName(zr.id)),zr.init&&fr.push({type:"AssignmentExpression",operator:"=",left:zr.id,right:zr.init})}return fr.length&&(Pt=this.createClosure({type:"BlockStatement",body:fr})),function(){if(Pt){var En=tt.isVarDeclMode;tt.isVarDeclMode=!0,Pt(),tt.isVarDeclMode=En}return Or}},U.assertVariable=function(te,tt,Pt){if(te===this.globalScope.data&&!(tt in te))throw this.createInternalThrowError(ua.VariableUndefinedReferenceError,tt,Pt)},U.programHandler=function(te){var tt=this,Pt=te.body.map(function(fr){return tt.createClosure(fr)});return function(){for(var fr=Or,Fr=0;Fr<Pt.length;Fr++){var zr=Pt[Fr],En=tt.setValue(zr());if(En!==Or&&(fr=En,fr instanceof Lr||fr instanceof _n||fr instanceof Un||fr===ft||fr===St))break}return fr}},U.expressionStatementHandler=function(te){return this.createClosure(te.expression)},U.emptyStatementHandler=function(te){return function(){return Or}},U.returnStatementHandler=function(te){var tt=te.argument?this.createClosure(te.argument):mi;return function(){return new Lr(tt())}},U.ifStatementHandler=function(te){var tt=this.createClosure(te.test),Pt=this.createClosure(te.consequent),fr=te.alternate?this.createClosure(te.alternate):function(){return Or};return function(){return tt()?Pt():fr()}},U.conditionalExpressionHandler=function(te){return this.ifStatementHandler(te)},U.forStatementHandler=function(te){var tt=this,Pt=mi,fr=te.test?this.createClosure(te.test):function(){return!0},Fr=mi,zr=this.createClosure(te.body);return te.type==="ForStatement"&&(Pt=te.init?this.createClosure(te.init):Pt,Fr=te.update?this.createClosure(te.update):mi),function(En){var Dn,na=Or,ka=te.type==="DoWhileStatement";for(En&&En.type==="LabeledStatement"&&(Dn=En.label.name),Pt();ka||fr();Fr()){ka=!1;var ha=tt.setValue(zr());if(!(ha===Or||ha===St)){if(ha===ft)break;if(na=ha,na instanceof Un&&na.value===Dn){na=Or;continue}if(na instanceof Lr||na instanceof _n||na instanceof Un)break}}return na}},U.whileStatementHandler=function(te){return this.forStatementHandler(te)},U.doWhileStatementHandler=function(te){return this.forStatementHandler(te)},U.forInStatementHandler=function(te){var tt=this,Pt=te.left,fr=this.createClosure(te.right),Fr=this.createClosure(te.body);return te.left.type==="VariableDeclaration"&&(this.createClosure(te.left)(),Pt=te.left.declarations[0].id),function(zr){var En,Dn=Or,na;zr&&zr.type==="LabeledStatement"&&(En=zr.label.name);var ka=fr();for(na in ka){tt.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Pt,right:{type:"Literal",value:na}})();var ha=tt.setValue(Fr());if(!(ha===Or||ha===St)){if(ha===ft)break;if(Dn=ha,Dn instanceof Un&&Dn.value===En){Dn=Or;continue}if(Dn instanceof Lr||Dn instanceof _n||Dn instanceof Un)break}}return Dn}},U.withStatementHandler=function(te){var tt=this,Pt=this.createClosure(te.object),fr=this.createClosure(te.body);return function(){var Fr=Pt(),zr=tt.getCurrentScope(),En=new mn(Fr,zr,$n);tt.setCurrentScope(En);var Dn=tt.setValue(fr());return tt.setCurrentScope(zr),Dn}},U.throwStatementHandler=function(te){var tt=this,Pt=this.createClosure(te.argument);return function(){throw tt.setValue(void 0),Pt()}},U.tryStatementHandler=function(te){var tt=this,Pt=this.createClosure(te.block),fr=te.handler?this.catchClauseHandler(te.handler):null,Fr=te.finalizer?this.createClosure(te.finalizer):null;return function(){var zr=tt.getCurrentScope(),En=tt.getCurrentContext(),Dn=zr.labelStack.concat([]),na=tt.callStack.concat([]),ka=Or,ha,Fa,Mo=function(){tt.setCurrentScope(zr),tt.setCurrentContext(En),zr.labelStack=Dn,tt.callStack=na};try{ka=tt.setValue(Pt()),ka instanceof Lr&&(ha=ka)}catch(Po){if(Mo(),tt.isInterruptThrow(Po))throw Po;if(fr)try{ka=tt.setValue(fr(Po)),ka instanceof Lr&&(ha=ka)}catch(go){if(Mo(),tt.isInterruptThrow(go))throw go;Fa=go}}if(Fr)try{ka=Fr(),ka instanceof Lr&&(ha=ka)}catch(Po){if(Mo(),tt.isInterruptThrow(Po))throw Po;Fa=Po}if(Fa)throw Fa;return ha||ka}},U.catchClauseHandler=function(te){var tt=this,Pt=this.createParamNameGetter(te.param),fr=this.createClosure(te.body);return function(Fr){var zr,En=tt.getCurrentScope(),Dn=En.data,na=Pt(),ka=Gs.call(Dn,na),ha=Dn[na];return Dn[na]=Fr,zr=fr(),ka?Dn[na]=ha:delete Dn[na],zr}},U.continueStatementHandler=function(te){return function(){return te.label?new Un(te.label.name):St}},U.breakStatementHandler=function(te){return function(){return te.label?new _n(te.label.name):ft}},U.switchStatementHandler=function(te){var tt=this,Pt=this.createClosure(te.discriminant),fr=te.cases.map(function(Fr){return tt.switchCaseHandler(Fr)});return function(){for(var Fr=Pt(),zr=!1,En,Dn,na,ka=0;ka<fr.length;ka++){var ha=fr[ka](),Fa=ha.testClosure();if(Fa===_r){na=ha;continue}if(zr||Fa===Fr){if(zr=!0,Dn=tt.setValue(ha.bodyClosure()),Dn===Or)continue;if(Dn===ft||(En=Dn,En instanceof Lr||En instanceof _n||En instanceof Un||En===St))break}}if(!zr&&na){Dn=tt.setValue(na.bodyClosure());var Mo=Dn===Or||Dn===ft||Dn===St;Mo||(En=Dn)}return En}},U.switchCaseHandler=function(te){var tt=te.test?this.createClosure(te.test):function(){return _r},Pt=this.createClosure({type:"BlockStatement",body:te.consequent});return function(){return{testClosure:tt,bodyClosure:Pt}}},U.labeledStatementHandler=function(te){var tt=this,Pt=te.label.name,fr=this.createClosure(te.body);return function(){var Fr,zr=tt.getCurrentScope();return zr.labelStack.push(Pt),Fr=fr(te),Fr instanceof _n&&Fr.value===Pt&&(Fr=Or),zr.labelStack.pop(),Fr}},U.debuggerStatementHandler=function(te){return function(){debugger;return Or}},U.createParamNameGetter=function(te){if(te.type==="Identifier")return function(){return te.name};throw this.createInternalThrowError(ua.ParamTypeSyntaxError,te.type,te)},U.createObjectKeyGetter=function(te){var tt;return te.type==="Identifier"?tt=function(){return te.name}:tt=this.createClosure(te),function(){return tt()}},U.createMemberKeyGetter=function(te){return te.computed?this.createClosure(te.property):this.createObjectKeyGetter(te.property)},U.createObjectGetter=function(te){var tt=this;switch(te.type){case"Identifier":return function(){return tt.getScopeDataFromName(te.name,tt.getCurrentScope())};case"MemberExpression":return this.createClosure(te.object);default:throw this.createInternalThrowError(ua.AssignmentTypeSyntaxError,te.type,te)}},U.createNameGetter=function(te){switch(te.type){case"Identifier":return function(){return te.name};case"MemberExpression":return this.createMemberKeyGetter(te);default:throw this.createInternalThrowError(ua.AssignmentTypeSyntaxError,te.type,te)}},U.varDeclaration=function(te){var tt=this.collectDeclVars;tt[te]=void 0},U.funcDeclaration=function(te,tt){var Pt=this.collectDeclFuncs;Pt[te]=tt},U.addDeclarationsToScope=function(te,tt,Pt){var fr=Pt.data;for(var Fr in tt){var zr=tt[Fr];fr[Fr]=zr&&zr()}for(var En in te)En in fr||(fr[En]=void 0)},U.getScopeValue=function(te,tt){var Pt=this.getScopeFromName(te,tt);return Pt.data[te]},U.getScopeDataFromName=function(te,tt){return this.getScopeFromName(te,tt).data},U.getScopeFromName=function(te,tt){var Pt=tt;do if(te in Pt.data)return Pt;while(Pt=Pt.parent);return this.globalScope},U.setValue=function(te){var tt=this.callStack.length;return this.isVarDeclMode||tt||te===Or||te===ft||te===St||te instanceof _n||te instanceof Un||(this.value=te instanceof Lr?te.value:te),te},U.getValue=function(){return this.value},g}();ia.version=Eu,ia.eval=Xt,ia.Function=Dr,ia.ecmaVersion=5,ia.globalContextInFunction=void 0,ia.global=Object.create(null);function _a(g){return g===void 0&&(g=Object.create(null)),g}function ao(g,U,he){U===void 0&&(U=[]),he===void 0&&(he={});var te=he.parsingContext,tt=he.timeout===void 0?0:he.timeout,Pt=`
    (function anonymous(`+U.join(",")+`){
         `+g+`
    });
    `,fr=new ia(te,{ecmaVersion:he.ecmaVersion,timeout:tt,rootContext:he.rootContext,globalContextInFunction:he.globalContextInFunction});return fr.evaluate(Pt)}function Yo(g,U,he){var te=new ia(U,he);return te.evaluate(g)}var Vo=Yo,Bo=function(){function g(he){this._code=he}var U=g.prototype;return U.runInContext=function(te){return Yo(this._code,te)},U.runInNewContext=function(te){return Yo(this._code,te)},g}(),mo=function(g,U,he){return Yo(g,U,he)};function Do(){for(var g=arguments.length,U=new Array(g),he=0;he<g;he++)U[he]=arguments[he];var te=U.pop();return ao(te||"",U)}var ps=mo},20396:function(Ft,A,y){var v;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(Z,a,P,L){"use strict";var O=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,D=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),B=O||D,V=["","webkit","Moz","MS","ms","o"],N=B?"":a.createElement("div"),Y="function",H=Math.round,ce=Math.abs,at=Date.now;function rt(ft,St,_r){return setTimeout(Qe(ft,_r),St)}function Re(ft,St,_r){return Array.isArray(ft)?(vt(ft,_r[St],_r),!0):!1}function vt(ft,St,_r){var Or;if(!!ft)if(ft.forEach)ft.forEach(St,_r);else if(ft.length!==L)for(Or=0;Or<ft.length;)St.call(_r,ft[Or],Or,ft),Or++;else for(Or in ft)ft.hasOwnProperty(Or)&&St.call(_r,ft[Or],Or,ft)}function wt(ft,St,_r){var Or="DEPRECATED METHOD: "+St+`
`+_r+` AT 
`;return function(){var $n=new Error("get-stack-trace"),Gi=$n&&$n.stack?$n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",to=Z.console&&(Z.console.warn||Z.console.log);return to&&to.call(Z.console,Or,Gi),ft.apply(this,arguments)}}var fe;typeof Object.assign!="function"?fe=function(St){if(St===L||St===null)throw new TypeError("Cannot convert undefined or null to object");for(var _r=Object(St),Or=1;Or<arguments.length;Or++){var $n=arguments[Or];if($n!==L&&$n!==null)for(var Gi in $n)$n.hasOwnProperty(Gi)&&(_r[Gi]=$n[Gi])}return _r}:fe=Object.assign;var $e=wt(function(St,_r,Or){for(var $n=Object.keys(_r),Gi=0;Gi<$n.length;)(!Or||Or&&St[$n[Gi]]===L)&&(St[$n[Gi]]=_r[$n[Gi]]),Gi++;return St},"extend","Use `assign`."),re=wt(function(St,_r){return $e(St,_r,!0)},"merge","Use `assign`.");function Ge(ft,St,_r){var Or=St.prototype,$n;$n=ft.prototype=Object.create(Or),$n.constructor=ft,$n._super=Or,_r&&fe($n,_r)}function Qe(ft,St){return function(){return ft.apply(St,arguments)}}function Te(ft,St){return typeof ft==Y?ft.apply(St&&St[0]||L,St):ft}function Le(ft,St){return ft===L?St:ft}function Ce(ft,St,_r){vt(ir(St),function(Or){ft.addEventListener(Or,_r,!1)})}function Fe(ft,St,_r){vt(ir(St),function(Or){ft.removeEventListener(Or,_r,!1)})}function Ke(ft,St){for(;ft;){if(ft==St)return!0;ft=ft.parentNode}return!1}function qt(ft,St){return ft.indexOf(St)>-1}function ir(ft){return ft.trim().split(/\s+/g)}function Pe(ft,St,_r){if(ft.indexOf&&!_r)return ft.indexOf(St);for(var Or=0;Or<ft.length;){if(_r&&ft[Or][_r]==St||!_r&&ft[Or]===St)return Or;Or++}return-1}function Ne(ft){return Array.prototype.slice.call(ft,0)}function Xe(ft,St,_r){for(var Or=[],$n=[],Gi=0;Gi<ft.length;){var to=St?ft[Gi][St]:ft[Gi];Pe($n,to)<0&&Or.push(ft[Gi]),$n[Gi]=to,Gi++}return _r&&(St?Or=Or.sort(function(It,Ot){return It[St]>Ot[St]}):Or=Or.sort()),Or}function kt(ft,St){for(var _r,Or,$n=St[0].toUpperCase()+St.slice(1),Gi=0;Gi<V.length;){if(_r=V[Gi],Or=_r?_r+$n:St,Or in ft)return Or;Gi++}return L}var rr=1;function me(){return rr++}function et(ft){var St=ft.ownerDocument||ft;return St.defaultView||St.parentWindow||Z}var or=/mobile|tablet|ip(ad|hone|od)|android/i,on="ontouchstart"in Z,vr=kt(Z,"PointerEvent")!==L,jr=on&&or.test(navigator.userAgent),xr="touch",Ae="pen",De="mouse",ke="kinect",Bt=25,mt=1,Mr=2,Cr=4,Nr=8,nt=1,Ye=2,M=4,W=8,ue=16,X=Ye|M,ie=W|ue,ye=X|ie,J=["x","y"],ht=["clientX","clientY"];function ze(ft,St){var _r=this;this.manager=ft,this.callback=St,this.element=ft.element,this.target=ft.options.inputTarget,this.domHandler=function(Or){Te(ft.options.enable,[ft])&&_r.handler(Or)},this.init()}ze.prototype={handler:function(){},init:function(){this.evEl&&Ce(this.element,this.evEl,this.domHandler),this.evTarget&&Ce(this.target,this.evTarget,this.domHandler),this.evWin&&Ce(et(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Fe(this.element,this.evEl,this.domHandler),this.evTarget&&Fe(this.target,this.evTarget,this.domHandler),this.evWin&&Fe(et(this.element),this.evWin,this.domHandler)}};function pt(ft){var St,_r=ft.options.inputClass;return _r?St=_r:vr?St=dt:jr?St=Jr:on?St=Pr:St=it,new St(ft,Me)}function Me(ft,St,_r){var Or=_r.pointers.length,$n=_r.changedPointers.length,Gi=St&mt&&Or-$n==0,to=St&(Cr|Nr)&&Or-$n==0;_r.isFirst=!!Gi,_r.isFinal=!!to,Gi&&(ft.session={}),_r.eventType=St,Ue(ft,_r),ft.emit("hammer.input",_r),ft.recognize(_r),ft.session.prevInput=_r}function Ue(ft,St){var _r=ft.session,Or=St.pointers,$n=Or.length;_r.firstInput||(_r.firstInput=nr(St)),$n>1&&!_r.firstMultiple?_r.firstMultiple=nr(St):$n===1&&(_r.firstMultiple=!1);var Gi=_r.firstInput,to=_r.firstMultiple,Je=to?to.center:Gi.center,It=St.center=pe(Or);St.timeStamp=at(),St.deltaTime=St.timeStamp-Gi.timeStamp,St.angle=un(Je,It),St.distance=Hr(Je,It),yt(_r,St),St.offsetDirection=Ur(St.deltaX,St.deltaY);var Ot=lr(St.deltaTime,St.deltaX,St.deltaY);St.overallVelocityX=Ot.x,St.overallVelocityY=Ot.y,St.overallVelocity=ce(Ot.x)>ce(Ot.y)?Ot.x:Ot.y,St.scale=to?Gn(to.pointers,Or):1,St.rotation=to?bn(to.pointers,Or):0,St.maxPointers=_r.prevInput?St.pointers.length>_r.prevInput.maxPointers?St.pointers.length:_r.prevInput.maxPointers:St.pointers.length,gt(_r,St);var Xt=ft.element;Ke(St.srcEvent.target,Xt)&&(Xt=St.srcEvent.target),St.target=Xt}function yt(ft,St){var _r=St.center,Or=ft.offsetDelta||{},$n=ft.prevDelta||{},Gi=ft.prevInput||{};(St.eventType===mt||Gi.eventType===Cr)&&($n=ft.prevDelta={x:Gi.deltaX||0,y:Gi.deltaY||0},Or=ft.offsetDelta={x:_r.x,y:_r.y}),St.deltaX=$n.x+(_r.x-Or.x),St.deltaY=$n.y+(_r.y-Or.y)}function gt(ft,St){var _r=ft.lastInterval||St,Or=St.timeStamp-_r.timeStamp,$n,Gi,to,Je;if(St.eventType!=Nr&&(Or>Bt||_r.velocity===L)){var It=St.deltaX-_r.deltaX,Ot=St.deltaY-_r.deltaY,Xt=lr(Or,It,Ot);Gi=Xt.x,to=Xt.y,$n=ce(Xt.x)>ce(Xt.y)?Xt.x:Xt.y,Je=Ur(It,Ot),ft.lastInterval=St}else $n=_r.velocity,Gi=_r.velocityX,to=_r.velocityY,Je=_r.direction;St.velocity=$n,St.velocityX=Gi,St.velocityY=to,St.direction=Je}function nr(ft){for(var St=[],_r=0;_r<ft.pointers.length;)St[_r]={clientX:H(ft.pointers[_r].clientX),clientY:H(ft.pointers[_r].clientY)},_r++;return{timeStamp:at(),pointers:St,center:pe(St),deltaX:ft.deltaX,deltaY:ft.deltaY}}function pe(ft){var St=ft.length;if(St===1)return{x:H(ft[0].clientX),y:H(ft[0].clientY)};for(var _r=0,Or=0,$n=0;$n<St;)_r+=ft[$n].clientX,Or+=ft[$n].clientY,$n++;return{x:H(_r/St),y:H(Or/St)}}function lr(ft,St,_r){return{x:St/ft||0,y:_r/ft||0}}function Ur(ft,St){return ft===St?nt:ce(ft)>=ce(St)?ft<0?Ye:M:St<0?W:ue}function Hr(ft,St,_r){_r||(_r=J);var Or=St[_r[0]]-ft[_r[0]],$n=St[_r[1]]-ft[_r[1]];return Math.sqrt(Or*Or+$n*$n)}function un(ft,St,_r){_r||(_r=J);var Or=St[_r[0]]-ft[_r[0]],$n=St[_r[1]]-ft[_r[1]];return Math.atan2($n,Or)*180/Math.PI}function bn(ft,St){return un(St[1],St[0],ht)+un(ft[1],ft[0],ht)}function Gn(ft,St){return Hr(St[0],St[1],ht)/Hr(ft[0],ft[1],ht)}var li={mousedown:mt,mousemove:Mr,mouseup:Cr},$r="mousedown",Zt="mousemove mouseup";function it(){this.evEl=$r,this.evWin=Zt,this.pressed=!1,ze.apply(this,arguments)}Ge(it,ze,{handler:function(St){var _r=li[St.type];_r&mt&&St.button===0&&(this.pressed=!0),_r&Mr&&St.which!==1&&(_r=Cr),!!this.pressed&&(_r&Cr&&(this.pressed=!1),this.callback(this.manager,_r,{pointers:[St],changedPointers:[St],pointerType:De,srcEvent:St}))}});var ne={pointerdown:mt,pointermove:Mr,pointerup:Cr,pointercancel:Nr,pointerout:Nr},_e={2:xr,3:Ae,4:De,5:ke},Oe="pointerdown",je="pointermove pointerup pointercancel";!B&&Z.MSPointerEvent&&!Z.PointerEvent&&(Oe="MSPointerDown",je="MSPointerMove MSPointerUp MSPointerCancel");function dt(){this.evEl=Oe,this.evWin=je,ze.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Ge(dt,ze,{handler:function(St){var _r=this.store,Or=!1,$n=St.type.toLowerCase().replace("ms",""),Gi=ne[$n],to=_e[St.pointerType]||St.pointerType,Je=to==xr,It=Pe(_r,St.pointerId,"pointerId");Gi&mt&&(St.button===0||Je)?It<0&&(_r.push(St),It=_r.length-1):Gi&(Cr|Nr)&&(Or=!0),!(It<0)&&(_r[It]=St,this.callback(this.manager,Gi,{pointers:_r,changedPointers:[St],pointerType:to,srcEvent:St}),Or&&_r.splice(It,1))}});var Ut={touchstart:mt,touchmove:Mr,touchend:Cr,touchcancel:Nr},ur="touchstart",lt="touchstart touchmove touchend touchcancel";function Nt(){this.evTarget=ur,this.evWin=lt,this.started=!1,ze.apply(this,arguments)}Ge(Nt,ze,{handler:function(St){var _r=Ut[St.type];if(_r===mt&&(this.started=!0),!!this.started){var Or=Sr.call(this,St,_r);_r&(Cr|Nr)&&Or[0].length-Or[1].length==0&&(this.started=!1),this.callback(this.manager,_r,{pointers:Or[0],changedPointers:Or[1],pointerType:xr,srcEvent:St})}}});function Sr(ft,St){var _r=Ne(ft.touches),Or=Ne(ft.changedTouches);return St&(Cr|Nr)&&(_r=Xe(_r.concat(Or),"identifier",!0)),[_r,Or]}var fn={touchstart:mt,touchmove:Mr,touchend:Cr,touchcancel:Nr},Br="touchstart touchmove touchend touchcancel";function Jr(){this.evTarget=Br,this.targetIds={},ze.apply(this,arguments)}Ge(Jr,ze,{handler:function(St){var _r=fn[St.type],Or=Tn.call(this,St,_r);!Or||this.callback(this.manager,_r,{pointers:Or[0],changedPointers:Or[1],pointerType:xr,srcEvent:St})}});function Tn(ft,St){var _r=Ne(ft.touches),Or=this.targetIds;if(St&(mt|Mr)&&_r.length===1)return Or[_r[0].identifier]=!0,[_r,_r];var $n,Gi,to=Ne(ft.changedTouches),Je=[],It=this.target;if(Gi=_r.filter(function(Ot){return Ke(Ot.target,It)}),St===mt)for($n=0;$n<Gi.length;)Or[Gi[$n].identifier]=!0,$n++;for($n=0;$n<to.length;)Or[to[$n].identifier]&&Je.push(to[$n]),St&(Cr|Nr)&&delete Or[to[$n].identifier],$n++;if(!!Je.length)return[Xe(Gi.concat(Je),"identifier",!0),Je]}var hi=2500,On=25;function Pr(){ze.apply(this,arguments);var ft=Qe(this.handler,this);this.touch=new Jr(this.manager,ft),this.mouse=new it(this.manager,ft),this.primaryTouch=null,this.lastTouches=[]}Ge(Pr,ze,{handler:function(St,_r,Or){var $n=Or.pointerType==xr,Gi=Or.pointerType==De;if(!(Gi&&Or.sourceCapabilities&&Or.sourceCapabilities.firesTouchEvents)){if($n)vi.call(this,_r,Or);else if(Gi&&ui.call(this,Or))return;this.callback(St,_r,Or)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function vi(ft,St){ft&mt?(this.primaryTouch=St.changedPointers[0].identifier,Jn.call(this,St)):ft&(Cr|Nr)&&Jn.call(this,St)}function Jn(ft){var St=ft.changedPointers[0];if(St.identifier===this.primaryTouch){var _r={x:St.clientX,y:St.clientY};this.lastTouches.push(_r);var Or=this.lastTouches,$n=function(){var Gi=Or.indexOf(_r);Gi>-1&&Or.splice(Gi,1)};setTimeout($n,hi)}}function ui(ft){for(var St=ft.srcEvent.clientX,_r=ft.srcEvent.clientY,Or=0;Or<this.lastTouches.length;Or++){var $n=this.lastTouches[Or],Gi=Math.abs(St-$n.x),to=Math.abs(_r-$n.y);if(Gi<=On&&to<=On)return!0}return!1}var Da=B?L:kt(N.style,"touchAction"),Yn=Da!==L,wa="compute",vo="auto",Ua="manipulation",Ka="none",Ga="pan-x",ei="pan-y",eo=qa();function ra(ft,St){this.manager=ft,this.set(St)}ra.prototype={set:function(ft){ft==wa&&(ft=this.compute()),Yn&&this.manager.element.style&&eo[ft]&&(this.manager.element.style[Da]=ft),this.actions=ft.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ft=[];return vt(this.manager.recognizers,function(St){Te(St.options.enable,[St])&&(ft=ft.concat(St.getTouchAction()))}),Rn(ft.join(" "))},preventDefaults:function(ft){var St=ft.srcEvent,_r=ft.offsetDirection;if(this.manager.session.prevented){St.preventDefault();return}var Or=this.actions,$n=qt(Or,Ka)&&!eo[Ka],Gi=qt(Or,ei)&&!eo[ei],to=qt(Or,Ga)&&!eo[Ga];if($n){var Je=ft.pointers.length===1,It=ft.distance<2,Ot=ft.deltaTime<250;if(Je&&It&&Ot)return}if(!(to&&Gi)&&($n||Gi&&_r&X||to&&_r&ie))return this.preventSrc(St)},preventSrc:function(ft){this.manager.session.prevented=!0,ft.preventDefault()}};function Rn(ft){if(qt(ft,Ka))return Ka;var St=qt(ft,Ga),_r=qt(ft,ei);return St&&_r?Ka:St||_r?St?Ga:ei:qt(ft,Ua)?Ua:vo}function qa(){if(!Yn)return!1;var ft={};if(B)return ft;var St=Z.CSS&&Z.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(_r){ft[_r]=St?Z.CSS.supports("touch-action",_r):!0}),ft}var ba=1,Na=2,wo=4,ya=8,Gt=ya,gs=16,Qi=32;function So(ft){this.options=fe({},this.defaults,ft||{}),this.id=me(),this.manager=null,this.options.enable=Le(this.options.enable,!0),this.state=ba,this.simultaneous={},this.requireFail=[]}So.prototype={defaults:{},set:function(ft){return fe(this.options,ft),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ft){if(Re(ft,"recognizeWith",this))return this;var St=this.simultaneous;return ft=rs(ft,this),St[ft.id]||(St[ft.id]=ft,ft.recognizeWith(this)),this},dropRecognizeWith:function(ft){return Re(ft,"dropRecognizeWith",this)?this:(ft=rs(ft,this),delete this.simultaneous[ft.id],this)},requireFailure:function(ft){if(Re(ft,"requireFailure",this))return this;var St=this.requireFail;return ft=rs(ft,this),Pe(St,ft)===-1&&(St.push(ft),ft.requireFailure(this)),this},dropRequireFailure:function(ft){if(Re(ft,"dropRequireFailure",this))return this;ft=rs(ft,this);var St=Pe(this.requireFail,ft);return St>-1&&this.requireFail.splice(St,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ft){return!!this.simultaneous[ft.id]},emit:function(ft){var St=this,_r=this.state;function Or($n){St.manager.emit($n,ft)}_r<ya&&Or(St.options.event+ll(_r)),Or(St.options.event),ft.additionalEvent&&Or(ft.additionalEvent),_r>=ya&&Or(St.options.event+ll(_r))},tryEmit:function(ft){if(this.canEmit())return this.emit(ft);this.state=Qi},canEmit:function(){for(var ft=0;ft<this.requireFail.length;){if(!(this.requireFail[ft].state&(Qi|ba)))return!1;ft++}return!0},recognize:function(ft){var St=fe({},ft);if(!Te(this.options.enable,[this,St])){this.reset(),this.state=Qi;return}this.state&(Gt|gs|Qi)&&(this.state=ba),this.state=this.process(St),this.state&(Na|wo|ya|gs)&&this.tryEmit(St)},process:function(ft){},getTouchAction:function(){},reset:function(){}};function ll(ft){return ft&gs?"cancel":ft&ya?"end":ft&wo?"move":ft&Na?"start":""}function Ss(ft){return ft==ue?"down":ft==W?"up":ft==Ye?"left":ft==M?"right":""}function rs(ft,St){var _r=St.manager;return _r?_r.get(ft):ft}function ls(){So.apply(this,arguments)}Ge(ls,So,{defaults:{pointers:1},attrTest:function(ft){var St=this.options.pointers;return St===0||ft.pointers.length===St},process:function(ft){var St=this.state,_r=ft.eventType,Or=St&(Na|wo),$n=this.attrTest(ft);return Or&&(_r&Nr||!$n)?St|gs:Or||$n?_r&Cr?St|ya:St&Na?St|wo:Na:Qi}});function Ia(){ls.apply(this,arguments),this.pX=null,this.pY=null}Ge(Ia,ls,{defaults:{event:"pan",threshold:10,pointers:1,direction:ye},getTouchAction:function(){var ft=this.options.direction,St=[];return ft&X&&St.push(ei),ft&ie&&St.push(Ga),St},directionTest:function(ft){var St=this.options,_r=!0,Or=ft.distance,$n=ft.direction,Gi=ft.deltaX,to=ft.deltaY;return $n&St.direction||(St.direction&X?($n=Gi===0?nt:Gi<0?Ye:M,_r=Gi!=this.pX,Or=Math.abs(ft.deltaX)):($n=to===0?nt:to<0?W:ue,_r=to!=this.pY,Or=Math.abs(ft.deltaY))),ft.direction=$n,_r&&Or>St.threshold&&$n&St.direction},attrTest:function(ft){return ls.prototype.attrTest.call(this,ft)&&(this.state&Na||!(this.state&Na)&&this.directionTest(ft))},emit:function(ft){this.pX=ft.deltaX,this.pY=ft.deltaY;var St=Ss(ft.direction);St&&(ft.additionalEvent=this.options.event+St),this._super.emit.call(this,ft)}});function Ms(){ls.apply(this,arguments)}Ge(Ms,ls,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ka]},attrTest:function(ft){return this._super.attrTest.call(this,ft)&&(Math.abs(ft.scale-1)>this.options.threshold||this.state&Na)},emit:function(ft){if(ft.scale!==1){var St=ft.scale<1?"in":"out";ft.additionalEvent=this.options.event+St}this._super.emit.call(this,ft)}});function uo(){So.apply(this,arguments),this._timer=null,this._input=null}Ge(uo,So,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[vo]},process:function(ft){var St=this.options,_r=ft.pointers.length===St.pointers,Or=ft.distance<St.threshold,$n=ft.deltaTime>St.time;if(this._input=ft,!Or||!_r||ft.eventType&(Cr|Nr)&&!$n)this.reset();else if(ft.eventType&mt)this.reset(),this._timer=rt(function(){this.state=Gt,this.tryEmit()},St.time,this);else if(ft.eventType&Cr)return Gt;return Qi},reset:function(){clearTimeout(this._timer)},emit:function(ft){this.state===Gt&&(ft&&ft.eventType&Cr?this.manager.emit(this.options.event+"up",ft):(this._input.timeStamp=at(),this.manager.emit(this.options.event,this._input)))}});function Qs(){ls.apply(this,arguments)}Ge(Qs,ls,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ka]},attrTest:function(ft){return this._super.attrTest.call(this,ft)&&(Math.abs(ft.rotation)>this.options.threshold||this.state&Na)}});function Ao(){ls.apply(this,arguments)}Ge(Ao,ls,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:X|ie,pointers:1},getTouchAction:function(){return Ia.prototype.getTouchAction.call(this)},attrTest:function(ft){var St=this.options.direction,_r;return St&(X|ie)?_r=ft.overallVelocity:St&X?_r=ft.overallVelocityX:St&ie&&(_r=ft.overallVelocityY),this._super.attrTest.call(this,ft)&&St&ft.offsetDirection&&ft.distance>this.options.threshold&&ft.maxPointers==this.options.pointers&&ce(_r)>this.options.velocity&&ft.eventType&Cr},emit:function(ft){var St=Ss(ft.offsetDirection);St&&this.manager.emit(this.options.event+St,ft),this.manager.emit(this.options.event,ft)}});function Ts(){So.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Ge(Ts,So,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ua]},process:function(ft){var St=this.options,_r=ft.pointers.length===St.pointers,Or=ft.distance<St.threshold,$n=ft.deltaTime<St.time;if(this.reset(),ft.eventType&mt&&this.count===0)return this.failTimeout();if(Or&&$n&&_r){if(ft.eventType!=Cr)return this.failTimeout();var Gi=this.pTime?ft.timeStamp-this.pTime<St.interval:!0,to=!this.pCenter||Hr(this.pCenter,ft.center)<St.posThreshold;this.pTime=ft.timeStamp,this.pCenter=ft.center,!to||!Gi?this.count=1:this.count+=1,this._input=ft;var Je=this.count%St.taps;if(Je===0)return this.hasRequireFailures()?(this._timer=rt(function(){this.state=Gt,this.tryEmit()},St.interval,this),Na):Gt}return Qi},failTimeout:function(){return this._timer=rt(function(){this.state=Qi},this.options.interval,this),Qi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ua(ft,St){return St=St||{},St.recognizers=Le(St.recognizers,ua.defaults.preset),new Ro(ft,St)}ua.VERSION="2.0.7",ua.defaults={domEvents:!1,touchAction:wa,enable:!0,inputTarget:null,inputClass:null,preset:[[Qs,{enable:!1}],[Ms,{enable:!1},["rotate"]],[Ao,{direction:X}],[Ia,{direction:X},["swipe"]],[Ts],[Ts,{event:"doubletap",taps:2},["tap"]],[uo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var cs=1,Ds=2;function Ro(ft,St){this.options=fe({},ua.defaults,St||{}),this.options.inputTarget=this.options.inputTarget||ft,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ft,this.input=pt(this),this.touchAction=new ra(this,this.options.touchAction),Eu(this,!0),vt(this.options.recognizers,function(_r){var Or=this.add(new _r[0](_r[1]));_r[2]&&Or.recognizeWith(_r[2]),_r[3]&&Or.requireFailure(_r[3])},this)}Ro.prototype={set:function(ft){return fe(this.options,ft),ft.touchAction&&this.touchAction.update(),ft.inputTarget&&(this.input.destroy(),this.input.target=ft.inputTarget,this.input.init()),this},stop:function(ft){this.session.stopped=ft?Ds:cs},recognize:function(ft){var St=this.session;if(!St.stopped){this.touchAction.preventDefaults(ft);var _r,Or=this.recognizers,$n=St.curRecognizer;(!$n||$n&&$n.state&Gt)&&($n=St.curRecognizer=null);for(var Gi=0;Gi<Or.length;)_r=Or[Gi],St.stopped!==Ds&&(!$n||_r==$n||_r.canRecognizeWith($n))?_r.recognize(ft):_r.reset(),!$n&&_r.state&(Na|wo|ya)&&($n=St.curRecognizer=_r),Gi++}},get:function(ft){if(ft instanceof So)return ft;for(var St=this.recognizers,_r=0;_r<St.length;_r++)if(St[_r].options.event==ft)return St[_r];return null},add:function(ft){if(Re(ft,"add",this))return this;var St=this.get(ft.options.event);return St&&this.remove(St),this.recognizers.push(ft),ft.manager=this,this.touchAction.update(),ft},remove:function(ft){if(Re(ft,"remove",this))return this;if(ft=this.get(ft),ft){var St=this.recognizers,_r=Pe(St,ft);_r!==-1&&(St.splice(_r,1),this.touchAction.update())}return this},on:function(ft,St){if(ft!==L&&St!==L){var _r=this.handlers;return vt(ir(ft),function(Or){_r[Or]=_r[Or]||[],_r[Or].push(St)}),this}},off:function(ft,St){if(ft!==L){var _r=this.handlers;return vt(ir(ft),function(Or){St?_r[Or]&&_r[Or].splice(Pe(_r[Or],St),1):delete _r[Or]}),this}},emit:function(ft,St){this.options.domEvents&&ec(ft,St);var _r=this.handlers[ft]&&this.handlers[ft].slice();if(!(!_r||!_r.length)){St.type=ft,St.preventDefault=function(){St.srcEvent.preventDefault()};for(var Or=0;Or<_r.length;)_r[Or](St),Or++}},destroy:function(){this.element&&Eu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Eu(ft,St){var _r=ft.element;if(!!_r.style){var Or;vt(ft.options.cssProps,function($n,Gi){Or=kt(_r.style,Gi),St?(ft.oldCssProps[Or]=_r.style[Or],_r.style[Or]=$n):_r.style[Or]=ft.oldCssProps[Or]||""}),St||(ft.oldCssProps={})}}function ec(ft,St){if(!B){var _r=a.createEvent("Event");_r.initEvent(ft,!0,!0),_r.gesture=St,St.target.dispatchEvent(_r)}}if(!B){fe(ua,{INPUT_START:mt,INPUT_MOVE:Mr,INPUT_END:Cr,INPUT_CANCEL:Nr,STATE_POSSIBLE:ba,STATE_BEGAN:Na,STATE_CHANGED:wo,STATE_ENDED:ya,STATE_RECOGNIZED:Gt,STATE_CANCELLED:gs,STATE_FAILED:Qi,DIRECTION_NONE:nt,DIRECTION_LEFT:Ye,DIRECTION_RIGHT:M,DIRECTION_UP:W,DIRECTION_DOWN:ue,DIRECTION_HORIZONTAL:X,DIRECTION_VERTICAL:ie,DIRECTION_ALL:ye,Manager:Ro,Input:ze,TouchAction:ra,TouchInput:Jr,MouseInput:it,PointerEventInput:dt,TouchMouseInput:Pr,SingleTouchInput:Nt,Recognizer:So,AttrRecognizer:ls,Tap:Ts,Pan:Ia,Swipe:Ao,Pinch:Ms,Rotate:Qs,Press:uo,on:Ce,off:Fe,each:vt,merge:re,extend:$e,assign:fe,inherit:Ge,bindFn:Qe,prefixed:kt});var Gs=typeof window!="undefined"?window:typeof self!="undefined"?self:{};Gs.Hammer=ua,v=function(){return ua}.call(A,y,A,Ft),v!==L&&(Ft.exports=v)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},88307:function(Ft,A,y){(function(v,Z){Ft.exports=Z(y(18857))})(this,function(v){"use strict";var Z=function(ge){return ge instanceof Uint8Array||ge instanceof Uint16Array||ge instanceof Uint32Array||ge instanceof Int8Array||ge instanceof Int16Array||ge instanceof Int32Array||ge instanceof Float32Array||ge instanceof Float64Array||ge instanceof Uint8ClampedArray},a=function(ge,Lt){for(var sr=Object.keys(Lt),an=0;an<sr.length;++an)ge[sr[an]]=Lt[sr[an]];return ge},P=`
`;function L(ge){return typeof atob!="undefined"?atob(ge):"base64:"+ge}function O(ge){var Lt=new Error("(regl) "+ge);throw console.error(Lt),Lt}function D(ge,Lt){ge||O(Lt)}function B(ge){return ge?": "+ge:""}function V(ge,Lt,sr){ge in Lt||O("unknown parameter ("+ge+")"+B(sr)+". possible values: "+Object.keys(Lt).join())}function N(ge,Lt){Z(ge)||O("invalid parameter type"+B(Lt)+". must be a typed array")}function Y(ge,Lt){switch(Lt){case"number":return typeof ge=="number";case"object":return typeof ge=="object";case"string":return typeof ge=="string";case"boolean":return typeof ge=="boolean";case"function":return typeof ge=="function";case"undefined":return typeof ge=="undefined";case"symbol":return typeof ge=="symbol"}}function H(ge,Lt,sr){Y(ge,Lt)||O("invalid parameter type"+B(sr)+". expected "+Lt+", got "+typeof ge)}function ce(ge,Lt){ge>=0&&(ge|0)===ge||O("invalid parameter type, ("+ge+")"+B(Lt)+". must be a nonnegative integer")}function at(ge,Lt,sr){Lt.indexOf(ge)<0&&O("invalid value"+B(sr)+". must be one of: "+Lt)}var rt=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Re(ge){Object.keys(ge).forEach(function(Lt){rt.indexOf(Lt)<0&&O('invalid regl constructor argument "'+Lt+'". must be one of '+rt)})}function vt(ge,Lt){for(ge=ge+"";ge.length<Lt;)ge=" "+ge;return ge}function wt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function fe(ge,Lt){this.number=ge,this.line=Lt,this.errors=[]}function $e(ge,Lt,sr){this.file=ge,this.line=Lt,this.message=sr}function re(){var ge=new Error,Lt=(ge.stack||ge).toString(),sr=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Lt);if(sr)return sr[1];var an=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Lt);return an?an[1]:"unknown"}function Ge(){var ge=new Error,Lt=(ge.stack||ge).toString(),sr=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Lt);if(sr)return sr[1];var an=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Lt);return an?an[1]:"unknown"}function Qe(ge,Lt){var sr=ge.split(`
`),an=1,Pn=0,rn={unknown:new wt,0:new wt};rn.unknown.name=rn[0].name=Lt||re(),rn.unknown.lines.push(new fe(0,""));for(var yn=0;yn<sr.length;++yn){var In=sr[yn],jn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(In);if(jn)switch(jn[1]){case"line":var Kn=/(\d+)(\s+\d+)?/.exec(jn[2]);Kn&&(an=Kn[1]|0,Kn[2]&&(Pn=Kn[2]|0,Pn in rn||(rn[Pn]=new wt)));break;case"define":var ti=/SHADER_NAME(_B64)?\s+(.*)$/.exec(jn[2]);ti&&(rn[Pn].name=ti[1]?L(ti[2]):ti[2]);break}rn[Pn].lines.push(new fe(an++,In))}return Object.keys(rn).forEach(function(ii){var Ei=rn[ii];Ei.lines.forEach(function(Xn){Ei.index[Xn.number]=Xn})}),rn}function Te(ge){var Lt=[];return ge.split(`
`).forEach(function(sr){if(!(sr.length<5)){var an=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(sr);an?Lt.push(new $e(an[1]|0,an[2]|0,an[3].trim())):sr.length>0&&Lt.push(new $e("unknown",0,sr))}}),Lt}function Le(ge,Lt){Lt.forEach(function(sr){var an=ge[sr.file];if(an){var Pn=an.index[sr.line];if(Pn){Pn.errors.push(sr),an.hasErrors=!0;return}}ge.unknown.hasErrors=!0,ge.unknown.lines[0].errors.push(sr)})}function Ce(ge,Lt,sr,an,Pn){if(!ge.getShaderParameter(Lt,ge.COMPILE_STATUS)){var rn=ge.getShaderInfoLog(Lt),yn=an===ge.FRAGMENT_SHADER?"fragment":"vertex";Xe(sr,"string",yn+" shader source must be a string",Pn);var In=Qe(sr,Pn),jn=Te(rn);Le(In,jn),Object.keys(In).forEach(function(Kn){var ti=In[Kn];if(!ti.hasErrors)return;var ii=[""],Ei=[""];function Xn(ai,Vr){ii.push(ai),Ei.push(Vr||"")}Xn("file number "+Kn+": "+ti.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ti.lines.forEach(function(ai){if(ai.errors.length>0){Xn(vt(ai.number,4)+"|  ","background-color:yellow; font-weight:bold"),Xn(ai.line+P,"color:red; background-color:yellow; font-weight:bold");var Vr=0;ai.errors.forEach(function(dn){var ri=dn.message,xi=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ri);if(xi){var Nn=xi[1];switch(ri=xi[2],Nn){case"assign":Nn="=";break}Vr=Math.max(ai.line.indexOf(Nn,Vr),0)}else Vr=0;Xn(vt("| ",6)),Xn(vt("^^^",Vr+3)+P,"font-weight:bold"),Xn(vt("| ",6)),Xn(ri+P,"font-weight:bold")}),Xn(vt("| ",6)+P)}else Xn(vt(ai.number,4)+"|  "),Xn(ai.line+P,"color:red")}),typeof document!="undefined"&&!window.chrome?(Ei[0]=ii.join("%c"),console.log.apply(console,Ei)):console.log(ii.join(""))}),D.raise("Error compiling "+yn+" shader, "+In[0].name)}}function Fe(ge,Lt,sr,an,Pn){if(!ge.getProgramParameter(Lt,ge.LINK_STATUS)){var rn=ge.getProgramInfoLog(Lt),yn=Qe(sr,Pn),In=Qe(an,Pn),jn='Error linking program with vertex shader, "'+In[0].name+'", and fragment shader "'+yn[0].name+'"';typeof document!="undefined"?console.log("%c"+jn+P+"%c"+rn,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(jn+P+rn),D.raise(jn)}}function Ke(ge){ge._commandRef=re()}function qt(ge,Lt,sr,an){Ke(ge);function Pn(jn){return jn?an.id(jn):0}ge._fragId=Pn(ge.static.frag),ge._vertId=Pn(ge.static.vert);function rn(jn,Kn){Object.keys(Kn).forEach(function(ti){jn[an.id(ti)]=!0})}var yn=ge._uniformSet={};rn(yn,Lt.static),rn(yn,Lt.dynamic);var In=ge._attributeSet={};rn(In,sr.static),rn(In,sr.dynamic),ge._hasCount="count"in ge.static||"count"in ge.dynamic||"elements"in ge.static||"elements"in ge.dynamic}function ir(ge,Lt){var sr=Ge();O(ge+" in command "+(Lt||re())+(sr==="unknown"?"":" called from "+sr))}function Pe(ge,Lt,sr){ge||ir(Lt,sr||re())}function Ne(ge,Lt,sr,an){ge in Lt||ir("unknown parameter ("+ge+")"+B(sr)+". possible values: "+Object.keys(Lt).join(),an||re())}function Xe(ge,Lt,sr,an){Y(ge,Lt)||ir("invalid parameter type"+B(sr)+". expected "+Lt+", got "+typeof ge,an||re())}function kt(ge){ge()}function rr(ge,Lt,sr){ge.texture?at(ge.texture._texture.internalformat,Lt,"unsupported texture format for attachment"):at(ge.renderbuffer._renderbuffer.format,sr,"unsupported renderbuffer format for attachment")}var me=33071,et=9728,or=9984,on=9985,vr=9986,jr=9987,xr=5120,Ae=5121,De=5122,ke=5123,Bt=5124,mt=5125,Mr=5126,Cr=32819,Nr=32820,nt=33635,Ye=34042,M=36193,W={};W[xr]=W[Ae]=1,W[De]=W[ke]=W[M]=W[nt]=W[Cr]=W[Nr]=2,W[Bt]=W[mt]=W[Mr]=W[Ye]=4;function ue(ge,Lt){return ge===Nr||ge===Cr||ge===nt?2:ge===Ye?4:W[ge]*Lt}function X(ge){return!(ge&ge-1)&&!!ge}function ie(ge,Lt,sr){var an,Pn=Lt.width,rn=Lt.height,yn=Lt.channels;D(Pn>0&&Pn<=sr.maxTextureSize&&rn>0&&rn<=sr.maxTextureSize,"invalid texture shape"),(ge.wrapS!==me||ge.wrapT!==me)&&D(X(Pn)&&X(rn),"incompatible wrap mode for texture, both width and height must be power of 2"),Lt.mipmask===1?Pn!==1&&rn!==1&&D(ge.minFilter!==or&&ge.minFilter!==vr&&ge.minFilter!==on&&ge.minFilter!==jr,"min filter requires mipmap"):(D(X(Pn)&&X(rn),"texture must be a square power of 2 to support mipmapping"),D(Lt.mipmask===(Pn<<1)-1,"missing or incomplete mipmap data")),Lt.type===Mr&&(sr.extensions.indexOf("oes_texture_float_linear")<0&&D(ge.minFilter===et&&ge.magFilter===et,"filter not supported, must enable oes_texture_float_linear"),D(!ge.genMipmaps,"mipmap generation not supported with float textures"));var In=Lt.images;for(an=0;an<16;++an)if(In[an]){var jn=Pn>>an,Kn=rn>>an;D(Lt.mipmask&1<<an,"missing mipmap data");var ti=In[an];if(D(ti.width===jn&&ti.height===Kn,"invalid shape for mip images"),D(ti.format===Lt.format&&ti.internalformat===Lt.internalformat&&ti.type===Lt.type,"incompatible type for mip image"),!ti.compressed)if(ti.data){var ii=Math.ceil(ue(ti.type,yn)*jn/ti.unpackAlignment)*ti.unpackAlignment;D(ti.data.byteLength===ii*Kn,"invalid data for image, buffer size is inconsistent with image format")}else ti.element||ti.copy}else ge.genMipmaps||D((Lt.mipmask&1<<an)==0,"extra mipmap data");Lt.compressed&&D(!ge.genMipmaps,"mipmap generation for compressed images not supported")}function ye(ge,Lt,sr,an){var Pn=ge.width,rn=ge.height,yn=ge.channels;D(Pn>0&&Pn<=an.maxTextureSize&&rn>0&&rn<=an.maxTextureSize,"invalid texture shape"),D(Pn===rn,"cube map must be square"),D(Lt.wrapS===me&&Lt.wrapT===me,"wrap mode not supported by cube map");for(var In=0;In<sr.length;++In){var jn=sr[In];D(jn.width===Pn&&jn.height===rn,"inconsistent cube map face shape"),Lt.genMipmaps&&(D(!jn.compressed,"can not generate mipmap for compressed textures"),D(jn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Kn=jn.images,ti=0;ti<16;++ti){var ii=Kn[ti];if(ii){var Ei=Pn>>ti,Xn=rn>>ti;D(jn.mipmask&1<<ti,"missing mipmap data"),D(ii.width===Ei&&ii.height===Xn,"invalid shape for mip images"),D(ii.format===ge.format&&ii.internalformat===ge.internalformat&&ii.type===ge.type,"incompatible type for mip image"),ii.compressed||(ii.data?D(ii.data.byteLength===Ei*Xn*Math.max(ue(ii.type,yn),ii.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ii.element||ii.copy)}}}}var J=a(D,{optional:kt,raise:O,commandRaise:ir,command:Pe,parameter:V,commandParameter:Ne,constructor:Re,type:H,commandType:Xe,isTypedArray:N,nni:ce,oneOf:at,shaderError:Ce,linkError:Fe,callSite:Ge,saveCommandRef:Ke,saveDrawInfo:qt,framebufferFormat:rr,guessCommand:re,texture2D:ie,textureCube:ye}),ht=0,ze=0,pt=5,Me=6;function Ue(ge,Lt){this.id=ht++,this.type=ge,this.data=Lt}function yt(ge){return ge.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function gt(ge){if(ge.length===0)return[];var Lt=ge.charAt(0),sr=ge.charAt(ge.length-1);if(ge.length>1&&Lt===sr&&(Lt==='"'||Lt==="'"))return['"'+yt(ge.substr(1,ge.length-2))+'"'];var an=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ge);if(an)return gt(ge.substr(0,an.index)).concat(gt(an[1])).concat(gt(ge.substr(an.index+an[0].length)));var Pn=ge.split(".");if(Pn.length===1)return['"'+yt(ge)+'"'];for(var rn=[],yn=0;yn<Pn.length;++yn)rn=rn.concat(gt(Pn[yn]));return rn}function nr(ge){return"["+gt(ge).join("][")+"]"}function pe(ge,Lt){return new Ue(ge,nr(Lt+""))}function lr(ge){return typeof ge=="function"&&!ge._reglType||ge instanceof Ue}function Ur(ge,Lt){if(typeof ge=="function")return new Ue(ze,ge);if(typeof ge=="number"||typeof ge=="boolean")return new Ue(pt,ge);if(Array.isArray(ge))return new Ue(Me,ge.map(function(sr,an){return Ur(sr,Lt+"["+an+"]")}));if(ge instanceof Ue)return ge;J(!1,"invalid option type in uniform "+Lt)}var Hr={DynamicVariable:Ue,define:pe,isDynamic:lr,unbox:Ur,accessor:nr},un={next:typeof requestAnimationFrame=="function"?function(ge){return requestAnimationFrame(ge)}:function(ge){return setTimeout(ge,16)},cancel:typeof cancelAnimationFrame=="function"?function(ge){return cancelAnimationFrame(ge)}:clearTimeout},bn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Gn=bn?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function li(){var ge={"":0},Lt=[""];return{id:function(sr){var an=ge[sr];return an||(an=ge[sr]=Lt.length,Lt.push(sr),an)},str:function(sr){return Lt[sr]}}}function $r(ge,Lt,sr){var an=document.createElement("canvas");a(an.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),ge.appendChild(an),ge===document.body&&(an.style.position="absolute",a(ge.style,{margin:0,padding:0}));function Pn(){var In=window.innerWidth,jn=window.innerHeight;if(ge!==document.body){var Kn=an.getBoundingClientRect();In=Kn.right-Kn.left,jn=Kn.bottom-Kn.top}an.width=sr*In,an.height=sr*jn}var rn;ge!==document.body&&typeof ResizeObserver=="function"?(rn=new ResizeObserver(function(){setTimeout(Pn)}),rn.observe(ge)):window.addEventListener("resize",Pn,!1);function yn(){rn?rn.disconnect():window.removeEventListener("resize",Pn),ge.removeChild(an)}return Pn(),{canvas:an,onDestroy:yn}}function Zt(ge,Lt){function sr(an){try{return ge.getContext(an,Lt)}catch(Pn){return null}}return sr("webgl")||sr("experimental-webgl")||sr("webgl-experimental")}function it(ge){return typeof ge.nodeName=="string"&&typeof ge.appendChild=="function"&&typeof ge.getBoundingClientRect=="function"}function ne(ge){return typeof ge.drawArrays=="function"||typeof ge.drawElements=="function"}function _e(ge){return typeof ge=="string"?ge.split():(J(Array.isArray(ge),"invalid extension array"),ge)}function Oe(ge){return typeof ge=="string"?(J(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ge)):ge}function je(ge){var Lt=ge||{},sr,an,Pn,rn,yn={},In=[],jn=[],Kn=typeof window=="undefined"?1:window.devicePixelRatio,ti=!1,ii=function(ai){ai&&J.raise(ai)},Ei=function(){};if(typeof Lt=="string"?(J(typeof document!="undefined","selector queries only supported in DOM environments"),sr=document.querySelector(Lt),J(sr,"invalid query string for element")):typeof Lt=="object"?it(Lt)?sr=Lt:ne(Lt)?(rn=Lt,Pn=rn.canvas):(J.constructor(Lt),"gl"in Lt?rn=Lt.gl:"canvas"in Lt?Pn=Oe(Lt.canvas):"container"in Lt&&(an=Oe(Lt.container)),"attributes"in Lt&&(yn=Lt.attributes,J.type(yn,"object","invalid context attributes")),"extensions"in Lt&&(In=_e(Lt.extensions)),"optionalExtensions"in Lt&&(jn=_e(Lt.optionalExtensions)),"onDone"in Lt&&(J.type(Lt.onDone,"function","invalid or missing onDone callback"),ii=Lt.onDone),"profile"in Lt&&(ti=!!Lt.profile),"pixelRatio"in Lt&&(Kn=+Lt.pixelRatio,J(Kn>0,"invalid pixel ratio"))):J.raise("invalid arguments to regl"),sr&&(sr.nodeName.toLowerCase()==="canvas"?Pn=sr:an=sr),!rn){if(!Pn){J(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Xn=$r(an||document.body,ii,Kn);if(!Xn)return null;Pn=Xn.canvas,Ei=Xn.onDestroy}yn.premultipliedAlpha===void 0&&(yn.premultipliedAlpha=!0),rn=Zt(Pn,yn)}return rn?{gl:rn,canvas:Pn,container:an,extensions:In,optionalExtensions:jn,pixelRatio:Kn,profile:ti,onDone:ii,onDestroy:Ei}:(Ei(),ii("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function dt(ge,Lt){var sr={};function an(In){J.type(In,"string","extension name must be string");var jn=In.toLowerCase(),Kn;try{Kn=sr[jn]=Pn(In)}catch(ti){}return!!Kn}function Pn(In){return ge.getExtension(In)?ge.getExtension(In):ge.getExtension(In.toLowerCase())?ge.getExtension(In.toLowerCase()):null}for(var rn=0;rn<Lt.extensions.length;++rn){var yn=Lt.extensions[rn];if(!an(yn))return Lt.onDestroy(),Lt.onDone('"'+yn+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Lt.optionalExtensions.forEach(an),{extensions:sr,restore:function(){Object.keys(sr).forEach(function(In){if(sr[In]&&!an(In))throw new Error("(regl): error restoring extension "+In)})}}}function Ut(ge,Lt){for(var sr=Array(ge),an=0;an<ge;++an)sr[an]=Lt(an);return sr}var ur=5120,lt=5121,Nt=5122,Sr=5123,fn=5124,Br=5125,Jr=5126;function Tn(ge){for(var Lt=16;Lt<=1<<28;Lt*=16)if(ge<=Lt)return Lt;return 0}function hi(ge){var Lt,sr;return Lt=(ge>65535)<<4,ge>>>=Lt,sr=(ge>255)<<3,ge>>>=sr,Lt|=sr,sr=(ge>15)<<2,ge>>>=sr,Lt|=sr,sr=(ge>3)<<1,ge>>>=sr,Lt|=sr,Lt|ge>>1}function On(){var ge=Ut(8,function(){return[]});function Lt(rn){var yn=Tn(rn),In=ge[hi(yn)>>2];return In.length>0?In.pop():new ArrayBuffer(yn)}function sr(rn){ge[hi(rn.byteLength)>>2].push(rn)}function an(rn,yn){var In=null;switch(rn){case ur:In=new Int8Array(Lt(yn),0,yn);break;case lt:In=new Uint8Array(Lt(yn),0,yn);break;case Nt:In=new Int16Array(Lt(2*yn),0,yn);break;case Sr:In=new Uint16Array(Lt(2*yn),0,yn);break;case fn:In=new Int32Array(Lt(4*yn),0,yn);break;case Br:In=new Uint32Array(Lt(4*yn),0,yn);break;case Jr:In=new Float32Array(Lt(4*yn),0,yn);break;default:return null}return In.length!==yn?In.subarray(0,yn):In}function Pn(rn){sr(rn.buffer)}return{alloc:Lt,free:sr,allocType:an,freeType:Pn}}var Pr=On();Pr.zero=On();var vi=3408,Jn=3410,ui=3411,Da=3412,Yn=3413,wa=3414,vo=3415,Ua=33901,Ka=33902,Ga=3379,ei=3386,eo=34921,ra=36347,Rn=36348,qa=35661,ba=35660,Na=34930,wo=36349,ya=34076,Gt=34024,gs=7936,Qi=7937,So=7938,ll=35724,Ss=34047,rs=36063,ls=34852,Ia=3553,Ms=34067,uo=34069,Qs=33984,Ao=6408,Ts=5126,ua=5121,cs=36160,Ds=36053,Ro=36064,Eu=16384,ec=function(ge,Lt){var sr=1;Lt.ext_texture_filter_anisotropic&&(sr=ge.getParameter(Ss));var an=1,Pn=1;Lt.webgl_draw_buffers&&(an=ge.getParameter(ls),Pn=ge.getParameter(rs));var rn=!!Lt.oes_texture_float;if(rn){var yn=ge.createTexture();ge.bindTexture(Ia,yn),ge.texImage2D(Ia,0,Ao,1,1,0,Ao,Ts,null);var In=ge.createFramebuffer();if(ge.bindFramebuffer(cs,In),ge.framebufferTexture2D(cs,Ro,Ia,yn,0),ge.bindTexture(Ia,null),ge.checkFramebufferStatus(cs)!==Ds)rn=!1;else{ge.viewport(0,0,1,1),ge.clearColor(1,0,0,1),ge.clear(Eu);var jn=Pr.allocType(Ts,4);ge.readPixels(0,0,1,1,Ao,Ts,jn),ge.getError()?rn=!1:(ge.deleteFramebuffer(In),ge.deleteTexture(yn),rn=jn[0]===1),Pr.freeType(jn)}}var Kn=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ti=!0;if(!Kn){var ii=ge.createTexture(),Ei=Pr.allocType(ua,36);ge.activeTexture(Qs),ge.bindTexture(Ms,ii),ge.texImage2D(uo,0,Ao,3,3,0,Ao,ua,Ei),Pr.freeType(Ei),ge.bindTexture(Ms,null),ge.deleteTexture(ii),ti=!ge.getError()}return{colorBits:[ge.getParameter(Jn),ge.getParameter(ui),ge.getParameter(Da),ge.getParameter(Yn)],depthBits:ge.getParameter(wa),stencilBits:ge.getParameter(vo),subpixelBits:ge.getParameter(vi),extensions:Object.keys(Lt).filter(function(Xn){return!!Lt[Xn]}),maxAnisotropic:sr,maxDrawbuffers:an,maxColorAttachments:Pn,pointSizeDims:ge.getParameter(Ua),lineWidthDims:ge.getParameter(Ka),maxViewportDims:ge.getParameter(ei),maxCombinedTextureUnits:ge.getParameter(qa),maxCubeMapSize:ge.getParameter(ya),maxRenderbufferSize:ge.getParameter(Gt),maxTextureUnits:ge.getParameter(Na),maxTextureSize:ge.getParameter(Ga),maxAttributes:ge.getParameter(eo),maxVertexUniforms:ge.getParameter(ra),maxVertexTextureUnits:ge.getParameter(ba),maxVaryingVectors:ge.getParameter(Rn),maxFragmentUniforms:ge.getParameter(wo),glsl:ge.getParameter(ll),renderer:ge.getParameter(Qi),vendor:ge.getParameter(gs),version:ge.getParameter(So),readFloat:rn,npotTextureCube:ti}};function Gs(ge){return!!ge&&typeof ge=="object"&&Array.isArray(ge.shape)&&Array.isArray(ge.stride)&&typeof ge.offset=="number"&&ge.shape.length===ge.stride.length&&(Array.isArray(ge.data)||Z(ge.data))}var ft=function(ge){return Object.keys(ge).map(function(Lt){return ge[Lt]})},St={shape:Je,flatten:to};function _r(ge,Lt,sr){for(var an=0;an<Lt;++an)sr[an]=ge[an]}function Or(ge,Lt,sr,an){for(var Pn=0,rn=0;rn<Lt;++rn)for(var yn=ge[rn],In=0;In<sr;++In)an[Pn++]=yn[In]}function $n(ge,Lt,sr,an,Pn,rn){for(var yn=rn,In=0;In<Lt;++In)for(var jn=ge[In],Kn=0;Kn<sr;++Kn)for(var ti=jn[Kn],ii=0;ii<an;++ii)Pn[yn++]=ti[ii]}function Gi(ge,Lt,sr,an,Pn){for(var rn=1,yn=sr+1;yn<Lt.length;++yn)rn*=Lt[yn];var In=Lt[sr];if(Lt.length-sr==4){var jn=Lt[sr+1],Kn=Lt[sr+2],ti=Lt[sr+3];for(yn=0;yn<In;++yn)$n(ge[yn],jn,Kn,ti,an,Pn),Pn+=rn}else for(yn=0;yn<In;++yn)Gi(ge[yn],Lt,sr+1,an,Pn),Pn+=rn}function to(ge,Lt,sr,an){var Pn=1;if(Lt.length)for(var rn=0;rn<Lt.length;++rn)Pn*=Lt[rn];else Pn=0;var yn=an||Pr.allocType(sr,Pn);switch(Lt.length){case 0:break;case 1:_r(ge,Lt[0],yn);break;case 2:Or(ge,Lt[0],Lt[1],yn);break;case 3:$n(ge,Lt[0],Lt[1],Lt[2],yn,0);break;default:Gi(ge,Lt,0,yn,0)}return yn}function Je(ge){for(var Lt=[],sr=ge;sr.length;sr=sr[0])Lt.push(sr.length);return Lt}var It={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ot=5120,Xt=5122,Dr=5124,Lr=5121,_n=5123,Un=5125,mn=5126,mi=5126,Oa={int8:Ot,int16:Xt,int32:Dr,uint8:Lr,uint16:_n,uint32:Un,float:mn,float32:mi},Fn=35048,ci=35040,ia={dynamic:Fn,stream:ci,static:35044},_a=St.flatten,ao=St.shape,Yo=35044,Vo=35040,Bo=5121,mo=5126,Do=[];Do[5120]=1,Do[5122]=2,Do[5124]=4,Do[5121]=1,Do[5123]=2,Do[5125]=4,Do[5126]=4;function ps(ge){return It[Object.prototype.toString.call(ge)]|0}function g(ge,Lt){for(var sr=0;sr<Lt.length;++sr)ge[sr]=Lt[sr]}function U(ge,Lt,sr,an,Pn,rn,yn){for(var In=0,jn=0;jn<sr;++jn)for(var Kn=0;Kn<an;++Kn)ge[In++]=Lt[Pn*jn+rn*Kn+yn]}function he(ge,Lt,sr,an){var Pn=0,rn={};function yn(Vr){this.id=Pn++,this.buffer=ge.createBuffer(),this.type=Vr,this.usage=Yo,this.byteLength=0,this.dimension=1,this.dtype=Bo,this.persistentData=null,sr.profile&&(this.stats={size:0})}yn.prototype.bind=function(){ge.bindBuffer(this.type,this.buffer)},yn.prototype.destroy=function(){Ei(this)};var In=[];function jn(Vr,dn){var ri=In.pop();return ri||(ri=new yn(Vr)),ri.bind(),ii(ri,dn,Vo,0,1,!1),ri}function Kn(Vr){In.push(Vr)}function ti(Vr,dn,ri){Vr.byteLength=dn.byteLength,ge.bufferData(Vr.type,dn,ri)}function ii(Vr,dn,ri,xi,Nn,fi){var Li;if(Vr.usage=ri,Array.isArray(dn)){if(Vr.dtype=xi||mo,dn.length>0){var ga;if(Array.isArray(dn[0])){Li=ao(dn);for(var Cn=1,Mn=1;Mn<Li.length;++Mn)Cn*=Li[Mn];Vr.dimension=Cn,ga=_a(dn,Li,Vr.dtype),ti(Vr,ga,ri),fi?Vr.persistentData=ga:Pr.freeType(ga)}else if(typeof dn[0]=="number"){Vr.dimension=Nn;var Ki=Pr.allocType(Vr.dtype,dn.length);g(Ki,dn),ti(Vr,Ki,ri),fi?Vr.persistentData=Ki:Pr.freeType(Ki)}else Z(dn[0])?(Vr.dimension=dn[0].length,Vr.dtype=xi||ps(dn[0])||mo,ga=_a(dn,[dn.length,dn[0].length],Vr.dtype),ti(Vr,ga,ri),fi?Vr.persistentData=ga:Pr.freeType(ga)):J.raise("invalid buffer data")}}else if(Z(dn))Vr.dtype=xi||ps(dn),Vr.dimension=Nn,ti(Vr,dn,ri),fi&&(Vr.persistentData=new Uint8Array(new Uint8Array(dn.buffer)));else if(Gs(dn)){Li=dn.shape;var Ti=dn.stride,qn=dn.offset,Oi=0,Ri=0,no=0,io=0;Li.length===1?(Oi=Li[0],Ri=1,no=Ti[0],io=0):Li.length===2?(Oi=Li[0],Ri=Li[1],no=Ti[0],io=Ti[1]):J.raise("invalid shape"),Vr.dtype=xi||ps(dn.data)||mo,Vr.dimension=Ri;var Ii=Pr.allocType(Vr.dtype,Oi*Ri);U(Ii,dn.data,Oi,Ri,no,io,qn),ti(Vr,Ii,ri),fi?Vr.persistentData=Ii:Pr.freeType(Ii)}else dn instanceof ArrayBuffer?(Vr.dtype=Bo,Vr.dimension=Nn,ti(Vr,dn,ri),fi&&(Vr.persistentData=new Uint8Array(new Uint8Array(dn)))):J.raise("invalid buffer data")}function Ei(Vr){Lt.bufferCount--,an(Vr);var dn=Vr.buffer;J(dn,"buffer must not be deleted already"),ge.deleteBuffer(dn),Vr.buffer=null,delete rn[Vr.id]}function Xn(Vr,dn,ri,xi){Lt.bufferCount++;var Nn=new yn(dn);rn[Nn.id]=Nn;function fi(Cn){var Mn=Yo,Ki=null,Ti=0,qn=0,Oi=1;return Array.isArray(Cn)||Z(Cn)||Gs(Cn)||Cn instanceof ArrayBuffer?Ki=Cn:typeof Cn=="number"?Ti=Cn|0:Cn&&(J.type(Cn,"object","buffer arguments must be an object, a number or an array"),"data"in Cn&&(J(Ki===null||Array.isArray(Ki)||Z(Ki)||Gs(Ki),"invalid data for buffer"),Ki=Cn.data),"usage"in Cn&&(J.parameter(Cn.usage,ia,"invalid buffer usage"),Mn=ia[Cn.usage]),"type"in Cn&&(J.parameter(Cn.type,Oa,"invalid buffer type"),qn=Oa[Cn.type]),"dimension"in Cn&&(J.type(Cn.dimension,"number","invalid dimension"),Oi=Cn.dimension|0),"length"in Cn&&(J.nni(Ti,"buffer length must be a nonnegative integer"),Ti=Cn.length|0)),Nn.bind(),Ki?ii(Nn,Ki,Mn,qn,Oi,xi):(Ti&&ge.bufferData(Nn.type,Ti,Mn),Nn.dtype=qn||Bo,Nn.usage=Mn,Nn.dimension=Oi,Nn.byteLength=Ti),sr.profile&&(Nn.stats.size=Nn.byteLength*Do[Nn.dtype]),fi}function Li(Cn,Mn){J(Mn+Cn.byteLength<=Nn.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Cn.byteLength+" starting from offset "+Mn+" to a buffer of size "+Nn.byteLength),ge.bufferSubData(Nn.type,Mn,Cn)}function ga(Cn,Mn){var Ki=(Mn||0)|0,Ti;if(Nn.bind(),Z(Cn)||Cn instanceof ArrayBuffer)Li(Cn,Ki);else if(Array.isArray(Cn)){if(Cn.length>0)if(typeof Cn[0]=="number"){var qn=Pr.allocType(Nn.dtype,Cn.length);g(qn,Cn),Li(qn,Ki),Pr.freeType(qn)}else if(Array.isArray(Cn[0])||Z(Cn[0])){Ti=ao(Cn);var Oi=_a(Cn,Ti,Nn.dtype);Li(Oi,Ki),Pr.freeType(Oi)}else J.raise("invalid buffer data")}else if(Gs(Cn)){Ti=Cn.shape;var Ri=Cn.stride,no=0,io=0,Ii=0,Di=0;Ti.length===1?(no=Ti[0],io=1,Ii=Ri[0],Di=0):Ti.length===2?(no=Ti[0],io=Ti[1],Ii=Ri[0],Di=Ri[1]):J.raise("invalid shape");var Xa=Array.isArray(Cn.data)?Nn.dtype:ps(Cn.data),lo=Pr.allocType(Xa,no*io);U(lo,Cn.data,no,io,Ii,Di,Cn.offset),Li(lo,Ki),Pr.freeType(lo)}else J.raise("invalid data for buffer subdata");return fi}return ri||fi(Vr),fi._reglType="buffer",fi._buffer=Nn,fi.subdata=ga,sr.profile&&(fi.stats=Nn.stats),fi.destroy=function(){Ei(Nn)},fi}function ai(){ft(rn).forEach(function(Vr){Vr.buffer=ge.createBuffer(),ge.bindBuffer(Vr.type,Vr.buffer),ge.bufferData(Vr.type,Vr.persistentData||Vr.byteLength,Vr.usage)})}return sr.profile&&(Lt.getTotalBufferSize=function(){var Vr=0;return Object.keys(rn).forEach(function(dn){Vr+=rn[dn].stats.size}),Vr}),{create:Xn,createStream:jn,destroyStream:Kn,clear:function(){ft(rn).forEach(Ei),In.forEach(Ei)},getBuffer:function(Vr){return Vr&&Vr._buffer instanceof yn?Vr._buffer:null},restore:ai,_initBuffer:ii}}var te=0,tt=0,Pt=1,fr=1,Fr=4,zr=4,En={points:te,point:tt,lines:Pt,line:fr,triangles:Fr,triangle:zr,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Dn=0,na=1,ka=4,ha=5120,Fa=5121,Mo=5122,Po=5123,go=5124,fu=5125,yo=34963,Zu=35040,tc=35044;function ws(ge,Lt,sr,an){var Pn={},rn=0,yn={uint8:Fa,uint16:Po};Lt.oes_element_index_uint&&(yn.uint32=fu);function In(ai){this.id=rn++,Pn[this.id]=this,this.buffer=ai,this.primType=ka,this.vertCount=0,this.type=0}In.prototype.bind=function(){this.buffer.bind()};var jn=[];function Kn(ai){var Vr=jn.pop();return Vr||(Vr=new In(sr.create(null,yo,!0,!1)._buffer)),ii(Vr,ai,Zu,-1,-1,0,0),Vr}function ti(ai){jn.push(ai)}function ii(ai,Vr,dn,ri,xi,Nn,fi){ai.buffer.bind();var Li;if(Vr){var ga=fi;!fi&&(!Z(Vr)||Gs(Vr)&&!Z(Vr.data))&&(ga=Lt.oes_element_index_uint?fu:Po),sr._initBuffer(ai.buffer,Vr,dn,ga,3)}else ge.bufferData(yo,Nn,dn),ai.buffer.dtype=Li||Fa,ai.buffer.usage=dn,ai.buffer.dimension=3,ai.buffer.byteLength=Nn;if(Li=fi,!fi){switch(ai.buffer.dtype){case Fa:case ha:Li=Fa;break;case Po:case Mo:Li=Po;break;case fu:case go:Li=fu;break;default:J.raise("unsupported type for element array")}ai.buffer.dtype=Li}ai.type=Li,J(Li!==fu||!!Lt.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Cn=xi;Cn<0&&(Cn=ai.buffer.byteLength,Li===Po?Cn>>=1:Li===fu&&(Cn>>=2)),ai.vertCount=Cn;var Mn=ri;if(ri<0){Mn=ka;var Ki=ai.buffer.dimension;Ki===1&&(Mn=Dn),Ki===2&&(Mn=na),Ki===3&&(Mn=ka)}ai.primType=Mn}function Ei(ai){an.elementsCount--,J(ai.buffer!==null,"must not double destroy elements"),delete Pn[ai.id],ai.buffer.destroy(),ai.buffer=null}function Xn(ai,Vr){var dn=sr.create(null,yo,!0),ri=new In(dn._buffer);an.elementsCount++;function xi(Nn){if(!Nn)dn(),ri.primType=ka,ri.vertCount=0,ri.type=Fa;else if(typeof Nn=="number")dn(Nn),ri.primType=ka,ri.vertCount=Nn|0,ri.type=Fa;else{var fi=null,Li=tc,ga=-1,Cn=-1,Mn=0,Ki=0;Array.isArray(Nn)||Z(Nn)||Gs(Nn)?fi=Nn:(J.type(Nn,"object","invalid arguments for elements"),"data"in Nn&&(fi=Nn.data,J(Array.isArray(fi)||Z(fi)||Gs(fi),"invalid data for element buffer")),"usage"in Nn&&(J.parameter(Nn.usage,ia,"invalid element buffer usage"),Li=ia[Nn.usage]),"primitive"in Nn&&(J.parameter(Nn.primitive,En,"invalid element buffer primitive"),ga=En[Nn.primitive]),"count"in Nn&&(J(typeof Nn.count=="number"&&Nn.count>=0,"invalid vertex count for elements"),Cn=Nn.count|0),"type"in Nn&&(J.parameter(Nn.type,yn,"invalid buffer type"),Ki=yn[Nn.type]),"length"in Nn?Mn=Nn.length|0:(Mn=Cn,Ki===Po||Ki===Mo?Mn*=2:(Ki===fu||Ki===go)&&(Mn*=4))),ii(ri,fi,Li,ga,Cn,Mn,Ki)}return xi}return xi(ai),xi._reglType="elements",xi._elements=ri,xi.subdata=function(Nn,fi){return dn.subdata(Nn,fi),xi},xi.destroy=function(){Ei(ri)},xi}return{create:Xn,createStream:Kn,destroyStream:ti,getElements:function(ai){return typeof ai=="function"&&ai._elements instanceof In?ai._elements:null},clear:function(){ft(Pn).forEach(Ei)}}}var Nc=new Float32Array(1),$u=new Uint32Array(Nc.buffer),Ku=5123;function xl(ge){for(var Lt=Pr.allocType(Ku,ge.length),sr=0;sr<ge.length;++sr)if(isNaN(ge[sr]))Lt[sr]=65535;else if(ge[sr]===Infinity)Lt[sr]=31744;else if(ge[sr]===-Infinity)Lt[sr]=64512;else{Nc[0]=ge[sr];var an=$u[0],Pn=an>>>31<<15,rn=(an<<1>>>24)-127,yn=an>>13&(1<<10)-1;if(rn<-24)Lt[sr]=Pn;else if(rn<-14){var In=-14-rn;Lt[sr]=Pn+(yn+(1<<10)>>In)}else rn>15?Lt[sr]=Pn+31744:Lt[sr]=Pn+(rn+15<<10)+yn}return Lt}function qo(ge){return Array.isArray(ge)||Z(ge)}var rc=function(ge){return!(ge&ge-1)&&!!ge},Ec=34467,Va=3553,qu=34067,ys=34069,ss=6408,bl=6406,El=6407,To=6409,Ps=6410,hf=32854,ju=32855,zc=36194,Uc=32819,Bf=32820,Jc=33635,vu=34042,Ul=6402,Qu=34041,Cu=35904,Zl=35906,nc=36193,ic=33776,Gu=33777,pf=33778,Cc=33779,ef=35986,ko=35987,Zc=34798,Su=35840,jl=35841,cl=35842,tf=35843,Gl=36196,fl=5121,jc=5123,Vl=5125,Cl=5126,Nf=10242,rf=10243,le=10497,Ve=33071,_t=33648,ut=10240,Wt=10241,hn=9728,Mi=9729,da=9984,oa=9985,za=9986,Xo=9987,Sc=33170,hl=4352,df=4353,yh=4354,ih=34046,Hl=3317,Sl=37440,ac=37441,Vs=37443,Gc=37444,vf=33984,Hs=[da,za,oa,Xo],zi=[0,To,Ps,El,ss],ks={};ks[To]=ks[bl]=ks[Ul]=1,ks[Qu]=ks[Ps]=2,ks[El]=ks[Cu]=3,ks[ss]=ks[Zl]=4;function Vc(ge){return"[object "+ge+"]"}var nf=Vc("HTMLCanvasElement"),Ws=Vc("OffscreenCanvas"),Vu=Vc("CanvasRenderingContext2D"),mf=Vc("ImageBitmap"),_i=Vc("HTMLImageElement"),gf=Vc("HTMLVideoElement"),$f=Object.keys(It).concat([nf,Ws,Vu,mf,_i,gf]),Al=[];Al[fl]=1,Al[Cl]=4,Al[nc]=2,Al[jc]=2,Al[Vl]=4;var _s=[];_s[hf]=2,_s[ju]=2,_s[zc]=2,_s[Qu]=4,_s[ic]=.5,_s[Gu]=.5,_s[pf]=1,_s[Cc]=1,_s[ef]=.5,_s[ko]=1,_s[Zc]=1,_s[Su]=.5,_s[jl]=.25,_s[cl]=.5,_s[tf]=.25,_s[Gl]=.5;function Au(ge){return Array.isArray(ge)&&(ge.length===0||typeof ge[0]=="number")}function yf(ge){if(!Array.isArray(ge))return!1;var Lt=ge.length;return!(Lt===0||!qo(ge[0]))}function Tl(ge){return Object.prototype.toString.call(ge)}function Ru(ge){return Tl(ge)===nf}function Ac(ge){return Tl(ge)===Ws}function ah(ge){return Tl(ge)===Vu}function zf(ge){return Tl(ge)===mf}function Uf(ge){return Tl(ge)===_i}function oh(ge){return Tl(ge)===gf}function wl(ge){var Lt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Lt&&ge&&ge.getContext)}function pl(ge){var Lt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Lt&&ge&&"src"in ge&&"crossOrigin"in ge)}function fo(ge){if(!ge)return!1;if(wl(ge)||pl(ge))return!0;var Lt=Tl(ge);return $f.indexOf(Lt)>=0?!0:Au(ge)||yf(ge)||Gs(ge)}function Ju(ge){return It[Object.prototype.toString.call(ge)]|0}function Ml(ge,Lt){var sr=Lt.length;switch(ge.type){case fl:case jc:case Vl:case Cl:var an=Pr.allocType(ge.type,sr);an.set(Lt),ge.data=an;break;case nc:ge.data=xl(Lt);break;default:J.raise("unsupported texture type, must specify a typed array")}}function Xs(ge,Lt){return Pr.allocType(ge.type===nc?Cl:ge.type,Lt)}function oc(ge,Lt){ge.type===nc?(ge.data=xl(Lt),Pr.freeType(Lt)):ge.data=Lt}function Hc(ge,Lt,sr,an,Pn,rn){for(var yn=ge.width,In=ge.height,jn=ge.channels,Kn=yn*In*jn,ti=Xs(ge,Kn),ii=0,Ei=0;Ei<In;++Ei)for(var Xn=0;Xn<yn;++Xn)for(var ai=0;ai<jn;++ai)ti[ii++]=Lt[sr*Xn+an*Ei+Pn*ai+rn];oc(ge,ti)}function Tu(ge,Lt,sr,an,Pn,rn){var yn;if(typeof _s[ge]!="undefined"?yn=_s[ge]:yn=ks[ge]*Al[Lt],rn&&(yn*=6),Pn){for(var In=0,jn=sr;jn>=1;)In+=yn*jn*jn,jn/=2;return In}else return yn*sr*an}function Hu(ge,Lt,sr,an,Pn,rn,yn){var In={"don't care":hl,"dont care":hl,nice:yh,fast:df},jn={repeat:le,clamp:Ve,mirror:_t},Kn={nearest:hn,linear:Mi},ti=a({mipmap:Xo,"nearest mipmap nearest":da,"linear mipmap nearest":oa,"nearest mipmap linear":za,"linear mipmap linear":Xo},Kn),ii={none:0,browser:Gc},Ei={uint8:fl,rgba4:Uc,rgb565:Jc,"rgb5 a1":Bf},Xn={alpha:bl,luminance:To,"luminance alpha":Ps,rgb:El,rgba:ss,rgba4:hf,"rgb5 a1":ju,rgb565:zc},ai={};Lt.ext_srgb&&(Xn.srgb=Cu,Xn.srgba=Zl),Lt.oes_texture_float&&(Ei.float32=Ei.float=Cl),Lt.oes_texture_half_float&&(Ei.float16=Ei["half float"]=nc),Lt.webgl_depth_texture&&(a(Xn,{depth:Ul,"depth stencil":Qu}),a(Ei,{uint16:jc,uint32:Vl,"depth stencil":vu})),Lt.webgl_compressed_texture_s3tc&&a(ai,{"rgb s3tc dxt1":ic,"rgba s3tc dxt1":Gu,"rgba s3tc dxt3":pf,"rgba s3tc dxt5":Cc}),Lt.webgl_compressed_texture_atc&&a(ai,{"rgb atc":ef,"rgba atc explicit alpha":ko,"rgba atc interpolated alpha":Zc}),Lt.webgl_compressed_texture_pvrtc&&a(ai,{"rgb pvrtc 4bppv1":Su,"rgb pvrtc 2bppv1":jl,"rgba pvrtc 4bppv1":cl,"rgba pvrtc 2bppv1":tf}),Lt.webgl_compressed_texture_etc1&&(ai["rgb etc1"]=Gl);var Vr=Array.prototype.slice.call(ge.getParameter(Ec)||new Uint32Array(0));Object.keys(ai).forEach(function($t){var sn=ai[$t];Vr.indexOf(sn)>=0&&(Xn[$t]=sn)});var dn=Object.keys(Xn);sr.textureFormats=dn;var ri=[];Object.keys(Xn).forEach(function($t){var sn=Xn[$t];ri[sn]=$t});var xi=[];Object.keys(Ei).forEach(function($t){var sn=Ei[$t];xi[sn]=$t});var Nn=[];Object.keys(Kn).forEach(function($t){var sn=Kn[$t];Nn[sn]=$t});var fi=[];Object.keys(ti).forEach(function($t){var sn=ti[$t];fi[sn]=$t});var Li=[];Object.keys(jn).forEach(function($t){var sn=jn[$t];Li[sn]=$t});var ga=dn.reduce(function($t,sn){var Kr=Xn[sn];return Kr===To||Kr===bl||Kr===To||Kr===Ps||Kr===Ul||Kr===Qu||Lt.ext_srgb&&(Kr===Cu||Kr===Zl)?$t[Kr]=Kr:Kr===ju||sn.indexOf("rgba")>=0?$t[Kr]=ss:$t[Kr]=El,$t},{});function Cn(){this.internalformat=ss,this.format=ss,this.type=fl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Gc,this.width=0,this.height=0,this.channels=0}function Mn($t,sn){$t.internalformat=sn.internalformat,$t.format=sn.format,$t.type=sn.type,$t.compressed=sn.compressed,$t.premultiplyAlpha=sn.premultiplyAlpha,$t.flipY=sn.flipY,$t.unpackAlignment=sn.unpackAlignment,$t.colorSpace=sn.colorSpace,$t.width=sn.width,$t.height=sn.height,$t.channels=sn.channels}function Ki($t,sn){if(!(typeof sn!="object"||!sn)){if("premultiplyAlpha"in sn&&(J.type(sn.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),$t.premultiplyAlpha=sn.premultiplyAlpha),"flipY"in sn&&(J.type(sn.flipY,"boolean","invalid texture flip"),$t.flipY=sn.flipY),"alignment"in sn&&(J.oneOf(sn.alignment,[1,2,4,8],"invalid texture unpack alignment"),$t.unpackAlignment=sn.alignment),"colorSpace"in sn&&(J.parameter(sn.colorSpace,ii,"invalid colorSpace"),$t.colorSpace=ii[sn.colorSpace]),"type"in sn){var Kr=sn.type;J(Lt.oes_texture_float||!(Kr==="float"||Kr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),J(Lt.oes_texture_half_float||!(Kr==="half float"||Kr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),J(Lt.webgl_depth_texture||!(Kr==="uint16"||Kr==="uint32"||Kr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(Kr,Ei,"invalid texture type"),$t.type=Ei[Kr]}var Ci=$t.width,No=$t.height,Dt=$t.channels,Ct=!1;"shape"in sn?(J(Array.isArray(sn.shape)&&sn.shape.length>=2,"shape must be an array"),Ci=sn.shape[0],No=sn.shape[1],sn.shape.length===3&&(Dt=sn.shape[2],J(Dt>0&&Dt<=4,"invalid number of channels"),Ct=!0),J(Ci>=0&&Ci<=sr.maxTextureSize,"invalid width"),J(No>=0&&No<=sr.maxTextureSize,"invalid height")):("radius"in sn&&(Ci=No=sn.radius,J(Ci>=0&&Ci<=sr.maxTextureSize,"invalid radius")),"width"in sn&&(Ci=sn.width,J(Ci>=0&&Ci<=sr.maxTextureSize,"invalid width")),"height"in sn&&(No=sn.height,J(No>=0&&No<=sr.maxTextureSize,"invalid height")),"channels"in sn&&(Dt=sn.channels,J(Dt>0&&Dt<=4,"invalid number of channels"),Ct=!0)),$t.width=Ci|0,$t.height=No|0,$t.channels=Dt|0;var yr=!1;if("format"in sn){var wr=sn.format;J(Lt.webgl_depth_texture||!(wr==="depth"||wr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),J.parameter(wr,Xn,"invalid texture format");var tn=$t.internalformat=Xn[wr];$t.format=ga[tn],wr in Ei&&("type"in sn||($t.type=Ei[wr])),wr in ai&&($t.compressed=!0),yr=!0}!Ct&&yr?$t.channels=ks[$t.format]:Ct&&!yr?$t.channels!==zi[$t.format]&&($t.format=$t.internalformat=zi[$t.channels]):yr&&Ct&&J($t.channels===ks[$t.format],"number of channels inconsistent with specified format")}}function Ti($t){ge.pixelStorei(Sl,$t.flipY),ge.pixelStorei(ac,$t.premultiplyAlpha),ge.pixelStorei(Vs,$t.colorSpace),ge.pixelStorei(Hl,$t.unpackAlignment)}function qn(){Cn.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Oi($t,sn){var Kr=null;if(fo(sn)?Kr=sn:sn&&(J.type(sn,"object","invalid pixel data type"),Ki($t,sn),"x"in sn&&($t.xOffset=sn.x|0),"y"in sn&&($t.yOffset=sn.y|0),fo(sn.data)&&(Kr=sn.data)),J(!$t.compressed||Kr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),sn.copy){J(!Kr,"can not specify copy and data field for the same texture");var Ci=Pn.viewportWidth,No=Pn.viewportHeight;$t.width=$t.width||Ci-$t.xOffset,$t.height=$t.height||No-$t.yOffset,$t.needsCopy=!0,J($t.xOffset>=0&&$t.xOffset<Ci&&$t.yOffset>=0&&$t.yOffset<No&&$t.width>0&&$t.width<=Ci&&$t.height>0&&$t.height<=No,"copy texture read out of bounds")}else if(!Kr)$t.width=$t.width||1,$t.height=$t.height||1,$t.channels=$t.channels||4;else if(Z(Kr))$t.channels=$t.channels||4,$t.data=Kr,!("type"in sn)&&$t.type===fl&&($t.type=Ju(Kr));else if(Au(Kr))$t.channels=$t.channels||4,Ml($t,Kr),$t.alignment=1,$t.needsFree=!0;else if(Gs(Kr)){var Dt=Kr.data;!Array.isArray(Dt)&&$t.type===fl&&($t.type=Ju(Dt));var Ct=Kr.shape,yr=Kr.stride,wr,tn,Er,ar,Rr,Rt;Ct.length===3?(Er=Ct[2],Rt=yr[2]):(J(Ct.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Er=1,Rt=1),wr=Ct[0],tn=Ct[1],ar=yr[0],Rr=yr[1],$t.alignment=1,$t.width=wr,$t.height=tn,$t.channels=Er,$t.format=$t.internalformat=zi[Er],$t.needsFree=!0,Hc($t,Dt,ar,Rr,Rt,Kr.offset)}else if(wl(Kr)||Ru(Kr)||Ac(Kr)||ah(Kr))wl(Kr)||Ru(Kr)||Ac(Kr)?$t.element=Kr:$t.element=Kr.canvas,$t.width=$t.element.width,$t.height=$t.element.height,$t.channels=4;else if(zf(Kr))$t.element=Kr,$t.width=Kr.width,$t.height=Kr.height,$t.channels=4;else if(Uf(Kr))$t.element=Kr,$t.width=Kr.naturalWidth,$t.height=Kr.naturalHeight,$t.channels=4;else if(pl(Kr))$t.element=Kr,$t.width=Kr.width,$t.height=Kr.height,$t.channels=4;else if(oh(Kr))$t.element=Kr,$t.width=Kr.videoWidth,$t.height=Kr.videoHeight,$t.channels=4;else if(yf(Kr)){var pr=$t.width||Kr[0].length,jt=$t.height||Kr.length,Wr=$t.channels;qo(Kr[0][0])?Wr=Wr||Kr[0][0].length:Wr=Wr||1;for(var qr=St.shape(Kr),zn=1,yi=0;yi<qr.length;++yi)zn*=qr[yi];var gi=Xs($t,zn);St.flatten(Kr,qr,"",gi),oc($t,gi),$t.alignment=1,$t.width=pr,$t.height=jt,$t.channels=Wr,$t.format=$t.internalformat=zi[Wr],$t.needsFree=!0}$t.type===Cl?J(sr.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):$t.type===nc&&J(sr.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Ri($t,sn,Kr){var Ci=$t.element,No=$t.data,Dt=$t.internalformat,Ct=$t.format,yr=$t.type,wr=$t.width,tn=$t.height;Ti($t),Ci?ge.texImage2D(sn,Kr,Ct,Ct,yr,Ci):$t.compressed?ge.compressedTexImage2D(sn,Kr,Dt,wr,tn,0,No):$t.needsCopy?(an(),ge.copyTexImage2D(sn,Kr,Ct,$t.xOffset,$t.yOffset,wr,tn,0)):ge.texImage2D(sn,Kr,Ct,wr,tn,0,Ct,yr,No||null)}function no($t,sn,Kr,Ci,No){var Dt=$t.element,Ct=$t.data,yr=$t.internalformat,wr=$t.format,tn=$t.type,Er=$t.width,ar=$t.height;Ti($t),Dt?ge.texSubImage2D(sn,No,Kr,Ci,wr,tn,Dt):$t.compressed?ge.compressedTexSubImage2D(sn,No,Kr,Ci,yr,Er,ar,Ct):$t.needsCopy?(an(),ge.copyTexSubImage2D(sn,No,Kr,Ci,$t.xOffset,$t.yOffset,Er,ar)):ge.texSubImage2D(sn,No,Kr,Ci,Er,ar,wr,tn,Ct)}var io=[];function Ii(){return io.pop()||new qn}function Di($t){$t.needsFree&&Pr.freeType($t.data),qn.call($t),io.push($t)}function Xa(){Cn.call(this),this.genMipmaps=!1,this.mipmapHint=hl,this.mipmask=0,this.images=Array(16)}function lo($t,sn,Kr){var Ci=$t.images[0]=Ii();$t.mipmask=1,Ci.width=$t.width=sn,Ci.height=$t.height=Kr,Ci.channels=$t.channels=4}function bo($t,sn){var Kr=null;if(fo(sn))Kr=$t.images[0]=Ii(),Mn(Kr,$t),Oi(Kr,sn),$t.mipmask=1;else if(Ki($t,sn),Array.isArray(sn.mipmap))for(var Ci=sn.mipmap,No=0;No<Ci.length;++No)Kr=$t.images[No]=Ii(),Mn(Kr,$t),Kr.width>>=No,Kr.height>>=No,Oi(Kr,Ci[No]),$t.mipmask|=1<<No;else Kr=$t.images[0]=Ii(),Mn(Kr,$t),Oi(Kr,sn),$t.mipmask=1;Mn($t,$t.images[0]),$t.compressed&&($t.internalformat===ic||$t.internalformat===Gu||$t.internalformat===pf||$t.internalformat===Cc)&&J($t.width%4==0&&$t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function nu($t,sn){for(var Kr=$t.images,Ci=0;Ci<Kr.length;++Ci){if(!Kr[Ci])return;Ri(Kr[Ci],sn,Ci)}}var $s=[];function Lo(){var $t=$s.pop()||new Xa;Cn.call($t),$t.mipmask=0;for(var sn=0;sn<16;++sn)$t.images[sn]=null;return $t}function ml($t){for(var sn=$t.images,Kr=0;Kr<sn.length;++Kr)sn[Kr]&&Di(sn[Kr]),sn[Kr]=null;$s.push($t)}function bs(){this.minFilter=hn,this.magFilter=hn,this.wrapS=Ve,this.wrapT=Ve,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=hl}function nl($t,sn){if("min"in sn){var Kr=sn.min;J.parameter(Kr,ti),$t.minFilter=ti[Kr],Hs.indexOf($t.minFilter)>=0&&!("faces"in sn)&&($t.genMipmaps=!0)}if("mag"in sn){var Ci=sn.mag;J.parameter(Ci,Kn),$t.magFilter=Kn[Ci]}var No=$t.wrapS,Dt=$t.wrapT;if("wrap"in sn){var Ct=sn.wrap;typeof Ct=="string"?(J.parameter(Ct,jn),No=Dt=jn[Ct]):Array.isArray(Ct)&&(J.parameter(Ct[0],jn),J.parameter(Ct[1],jn),No=jn[Ct[0]],Dt=jn[Ct[1]])}else{if("wrapS"in sn){var yr=sn.wrapS;J.parameter(yr,jn),No=jn[yr]}if("wrapT"in sn){var wr=sn.wrapT;J.parameter(wr,jn),Dt=jn[wr]}}if($t.wrapS=No,$t.wrapT=Dt,"anisotropic"in sn){var tn=sn.anisotropic;J(typeof tn=="number"&&tn>=1&&tn<=sr.maxAnisotropic,"aniso samples must be between 1 and "),$t.anisotropic=sn.anisotropic}if("mipmap"in sn){var Er=!1;switch(typeof sn.mipmap){case"string":J.parameter(sn.mipmap,In,"invalid mipmap hint"),$t.mipmapHint=In[sn.mipmap],$t.genMipmaps=!0,Er=!0;break;case"boolean":Er=$t.genMipmaps=sn.mipmap;break;case"object":J(Array.isArray(sn.mipmap),"invalid mipmap type"),$t.genMipmaps=!1,Er=!0;break;default:J.raise("invalid mipmap type")}Er&&!("min"in sn)&&($t.minFilter=da)}}function Mu($t,sn){ge.texParameteri(sn,Wt,$t.minFilter),ge.texParameteri(sn,ut,$t.magFilter),ge.texParameteri(sn,Nf,$t.wrapS),ge.texParameteri(sn,rf,$t.wrapT),Lt.ext_texture_filter_anisotropic&&ge.texParameteri(sn,ih,$t.anisotropic),$t.genMipmaps&&(ge.hint(Sc,$t.mipmapHint),ge.generateMipmap(sn))}var il=0,al={},kl=sr.maxTextureUnits,_u=Array(kl).map(function(){return null});function ho($t){Cn.call(this),this.mipmask=0,this.internalformat=ss,this.id=il++,this.refCount=1,this.target=$t,this.texture=ge.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new bs,yn.profile&&(this.stats={size:0})}function Bu($t){ge.activeTexture(vf),ge.bindTexture($t.target,$t.texture)}function is(){var $t=_u[0];$t?ge.bindTexture($t.target,$t.texture):ge.bindTexture(Va,null)}function Nu($t){var sn=$t.texture;J(sn,"must not double destroy texture");var Kr=$t.unit,Ci=$t.target;Kr>=0&&(ge.activeTexture(vf+Kr),ge.bindTexture(Ci,null),_u[Kr]=null),ge.deleteTexture(sn),$t.texture=null,$t.params=null,$t.pixels=null,$t.refCount=0,delete al[$t.id],rn.textureCount--}a(ho.prototype,{bind:function(){var $t=this;$t.bindCount+=1;var sn=$t.unit;if(sn<0){for(var Kr=0;Kr<kl;++Kr){var Ci=_u[Kr];if(Ci){if(Ci.bindCount>0)continue;Ci.unit=-1}_u[Kr]=$t,sn=Kr;break}sn>=kl&&J.raise("insufficient number of texture units"),yn.profile&&rn.maxTextureUnits<sn+1&&(rn.maxTextureUnits=sn+1),$t.unit=sn,ge.activeTexture(vf+sn),ge.bindTexture($t.target,$t.texture)}return sn},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Nu(this)}});function Za($t,sn){var Kr=new ho(Va);al[Kr.id]=Kr,rn.textureCount++;function Ci(Ct,yr){var wr=Kr.texInfo;bs.call(wr);var tn=Lo();return typeof Ct=="number"?typeof yr=="number"?lo(tn,Ct|0,yr|0):lo(tn,Ct|0,Ct|0):Ct?(J.type(Ct,"object","invalid arguments to regl.texture"),nl(wr,Ct),bo(tn,Ct)):lo(tn,1,1),wr.genMipmaps&&(tn.mipmask=(tn.width<<1)-1),Kr.mipmask=tn.mipmask,Mn(Kr,tn),J.texture2D(wr,tn,sr),Kr.internalformat=tn.internalformat,Ci.width=tn.width,Ci.height=tn.height,Bu(Kr),nu(tn,Va),Mu(wr,Va),is(),ml(tn),yn.profile&&(Kr.stats.size=Tu(Kr.internalformat,Kr.type,tn.width,tn.height,wr.genMipmaps,!1)),Ci.format=ri[Kr.internalformat],Ci.type=xi[Kr.type],Ci.mag=Nn[wr.magFilter],Ci.min=fi[wr.minFilter],Ci.wrapS=Li[wr.wrapS],Ci.wrapT=Li[wr.wrapT],Ci}function No(Ct,yr,wr,tn){J(!!Ct,"must specify image data");var Er=yr|0,ar=wr|0,Rr=tn|0,Rt=Ii();return Mn(Rt,Kr),Rt.width=0,Rt.height=0,Oi(Rt,Ct),Rt.width=Rt.width||(Kr.width>>Rr)-Er,Rt.height=Rt.height||(Kr.height>>Rr)-ar,J(Kr.type===Rt.type&&Kr.format===Rt.format&&Kr.internalformat===Rt.internalformat,"incompatible format for texture.subimage"),J(Er>=0&&ar>=0&&Er+Rt.width<=Kr.width&&ar+Rt.height<=Kr.height,"texture.subimage write out of bounds"),J(Kr.mipmask&1<<Rr,"missing mipmap data"),J(Rt.data||Rt.element||Rt.needsCopy,"missing image data"),Bu(Kr),no(Rt,Va,Er,ar,Rr),is(),Di(Rt),Ci}function Dt(Ct,yr){var wr=Ct|0,tn=yr|0||wr;if(wr===Kr.width&&tn===Kr.height)return Ci;Ci.width=Kr.width=wr,Ci.height=Kr.height=tn,Bu(Kr);for(var Er=0;Kr.mipmask>>Er;++Er){var ar=wr>>Er,Rr=tn>>Er;if(!ar||!Rr)break;ge.texImage2D(Va,Er,Kr.format,ar,Rr,0,Kr.format,Kr.type,null)}return is(),yn.profile&&(Kr.stats.size=Tu(Kr.internalformat,Kr.type,wr,tn,!1,!1)),Ci}return Ci($t,sn),Ci.subimage=No,Ci.resize=Dt,Ci._reglType="texture2d",Ci._texture=Kr,yn.profile&&(Ci.stats=Kr.stats),Ci.destroy=function(){Kr.decRef()},Ci}function Zo($t,sn,Kr,Ci,No,Dt){var Ct=new ho(qu);al[Ct.id]=Ct,rn.cubeCount++;var yr=new Array(6);function wr(ar,Rr,Rt,pr,jt,Wr){var qr,zn=Ct.texInfo;for(bs.call(zn),qr=0;qr<6;++qr)yr[qr]=Lo();if(typeof ar=="number"||!ar){var yi=ar|0||1;for(qr=0;qr<6;++qr)lo(yr[qr],yi,yi)}else if(typeof ar=="object")if(Rr)bo(yr[0],ar),bo(yr[1],Rr),bo(yr[2],Rt),bo(yr[3],pr),bo(yr[4],jt),bo(yr[5],Wr);else if(nl(zn,ar),Ki(Ct,ar),"faces"in ar){var gi=ar.faces;for(J(Array.isArray(gi)&&gi.length===6,"cube faces must be a length 6 array"),qr=0;qr<6;++qr)J(typeof gi[qr]=="object"&&!!gi[qr],"invalid input for cube map face"),Mn(yr[qr],Ct),bo(yr[qr],gi[qr])}else for(qr=0;qr<6;++qr)bo(yr[qr],ar);else J.raise("invalid arguments to cube map");for(Mn(Ct,yr[0]),J.optional(function(){sr.npotTextureCube||J(rc(Ct.width)&&rc(Ct.height),"your browser does not support non power or two texture dimensions")}),zn.genMipmaps?Ct.mipmask=(yr[0].width<<1)-1:Ct.mipmask=yr[0].mipmask,J.textureCube(Ct,zn,yr,sr),Ct.internalformat=yr[0].internalformat,wr.width=yr[0].width,wr.height=yr[0].height,Bu(Ct),qr=0;qr<6;++qr)nu(yr[qr],ys+qr);for(Mu(zn,qu),is(),yn.profile&&(Ct.stats.size=Tu(Ct.internalformat,Ct.type,wr.width,wr.height,zn.genMipmaps,!0)),wr.format=ri[Ct.internalformat],wr.type=xi[Ct.type],wr.mag=Nn[zn.magFilter],wr.min=fi[zn.minFilter],wr.wrapS=Li[zn.wrapS],wr.wrapT=Li[zn.wrapT],qr=0;qr<6;++qr)ml(yr[qr]);return wr}function tn(ar,Rr,Rt,pr,jt){J(!!Rr,"must specify image data"),J(typeof ar=="number"&&ar===(ar|0)&&ar>=0&&ar<6,"invalid face");var Wr=Rt|0,qr=pr|0,zn=jt|0,yi=Ii();return Mn(yi,Ct),yi.width=0,yi.height=0,Oi(yi,Rr),yi.width=yi.width||(Ct.width>>zn)-Wr,yi.height=yi.height||(Ct.height>>zn)-qr,J(Ct.type===yi.type&&Ct.format===yi.format&&Ct.internalformat===yi.internalformat,"incompatible format for texture.subimage"),J(Wr>=0&&qr>=0&&Wr+yi.width<=Ct.width&&qr+yi.height<=Ct.height,"texture.subimage write out of bounds"),J(Ct.mipmask&1<<zn,"missing mipmap data"),J(yi.data||yi.element||yi.needsCopy,"missing image data"),Bu(Ct),no(yi,ys+ar,Wr,qr,zn),is(),Di(yi),wr}function Er(ar){var Rr=ar|0;if(Rr!==Ct.width){wr.width=Ct.width=Rr,wr.height=Ct.height=Rr,Bu(Ct);for(var Rt=0;Rt<6;++Rt)for(var pr=0;Ct.mipmask>>pr;++pr)ge.texImage2D(ys+Rt,pr,Ct.format,Rr>>pr,Rr>>pr,0,Ct.format,Ct.type,null);return is(),yn.profile&&(Ct.stats.size=Tu(Ct.internalformat,Ct.type,wr.width,wr.height,!1,!0)),wr}}return wr($t,sn,Kr,Ci,No,Dt),wr.subimage=tn,wr.resize=Er,wr._reglType="textureCube",wr._texture=Ct,yn.profile&&(wr.stats=Ct.stats),wr.destroy=function(){Ct.decRef()},wr}function as(){for(var $t=0;$t<kl;++$t)ge.activeTexture(vf+$t),ge.bindTexture(Va,null),_u[$t]=null;ft(al).forEach(Nu),rn.cubeCount=0,rn.textureCount=0}yn.profile&&(rn.getTotalTextureSize=function(){var $t=0;return Object.keys(al).forEach(function(sn){$t+=al[sn].stats.size}),$t});function Os(){for(var $t=0;$t<kl;++$t){var sn=_u[$t];sn&&(sn.bindCount=0,sn.unit=-1,_u[$t]=null)}ft(al).forEach(function(Kr){Kr.texture=ge.createTexture(),ge.bindTexture(Kr.target,Kr.texture);for(var Ci=0;Ci<32;++Ci)if((Kr.mipmask&1<<Ci)!=0)if(Kr.target===Va)ge.texImage2D(Va,Ci,Kr.internalformat,Kr.width>>Ci,Kr.height>>Ci,0,Kr.internalformat,Kr.type,null);else for(var No=0;No<6;++No)ge.texImage2D(ys+No,Ci,Kr.internalformat,Kr.width>>Ci,Kr.height>>Ci,0,Kr.internalformat,Kr.type,null);Mu(Kr.texInfo,Kr.target)})}function Ks(){for(var $t=0;$t<kl;++$t){var sn=_u[$t];sn&&(sn.bindCount=0,sn.unit=-1,_u[$t]=null),ge.activeTexture(vf+$t),ge.bindTexture(Va,null),ge.bindTexture(qu,null)}}return{create2D:Za,createCube:Zo,clear:as,getTexture:function($t){return null},restore:Os,refresh:Ks}}var Js=36161,la=32854,Vi=32855,wf=36194,wu=33189,Wl=36168,mu=34041,Pl=35907,Zf=34836,sc=34842,$o=34843,fs=[];fs[la]=2,fs[Vi]=2,fs[wf]=2,fs[wu]=2,fs[Wl]=1,fs[mu]=4,fs[Pl]=4,fs[Zf]=16,fs[sc]=8,fs[$o]=6;function _f(ge,Lt,sr){return fs[ge]*Lt*sr}var uc=function(ge,Lt,sr,an,Pn){var rn={rgba4:la,rgb565:wf,"rgb5 a1":Vi,depth:wu,stencil:Wl,"depth stencil":mu};Lt.ext_srgb&&(rn.srgba=Pl),Lt.ext_color_buffer_half_float&&(rn.rgba16f=sc,rn.rgb16f=$o),Lt.webgl_color_buffer_float&&(rn.rgba32f=Zf);var yn=[];Object.keys(rn).forEach(function(Xn){var ai=rn[Xn];yn[ai]=Xn});var In=0,jn={};function Kn(Xn){this.id=In++,this.refCount=1,this.renderbuffer=Xn,this.format=la,this.width=0,this.height=0,Pn.profile&&(this.stats={size:0})}Kn.prototype.decRef=function(){--this.refCount<=0&&ti(this)};function ti(Xn){var ai=Xn.renderbuffer;J(ai,"must not double destroy renderbuffer"),ge.bindRenderbuffer(Js,null),ge.deleteRenderbuffer(ai),Xn.renderbuffer=null,Xn.refCount=0,delete jn[Xn.id],an.renderbufferCount--}function ii(Xn,ai){var Vr=new Kn(ge.createRenderbuffer());jn[Vr.id]=Vr,an.renderbufferCount++;function dn(xi,Nn){var fi=0,Li=0,ga=la;if(typeof xi=="object"&&xi){var Cn=xi;if("shape"in Cn){var Mn=Cn.shape;J(Array.isArray(Mn)&&Mn.length>=2,"invalid renderbuffer shape"),fi=Mn[0]|0,Li=Mn[1]|0}else"radius"in Cn&&(fi=Li=Cn.radius|0),"width"in Cn&&(fi=Cn.width|0),"height"in Cn&&(Li=Cn.height|0);"format"in Cn&&(J.parameter(Cn.format,rn,"invalid renderbuffer format"),ga=rn[Cn.format])}else typeof xi=="number"?(fi=xi|0,typeof Nn=="number"?Li=Nn|0:Li=fi):xi?J.raise("invalid arguments to renderbuffer constructor"):fi=Li=1;if(J(fi>0&&Li>0&&fi<=sr.maxRenderbufferSize&&Li<=sr.maxRenderbufferSize,"invalid renderbuffer size"),!(fi===Vr.width&&Li===Vr.height&&ga===Vr.format))return dn.width=Vr.width=fi,dn.height=Vr.height=Li,Vr.format=ga,ge.bindRenderbuffer(Js,Vr.renderbuffer),ge.renderbufferStorage(Js,ga,fi,Li),J(ge.getError()===0,"invalid render buffer format"),Pn.profile&&(Vr.stats.size=_f(Vr.format,Vr.width,Vr.height)),dn.format=yn[Vr.format],dn}function ri(xi,Nn){var fi=xi|0,Li=Nn|0||fi;return fi===Vr.width&&Li===Vr.height||(J(fi>0&&Li>0&&fi<=sr.maxRenderbufferSize&&Li<=sr.maxRenderbufferSize,"invalid renderbuffer size"),dn.width=Vr.width=fi,dn.height=Vr.height=Li,ge.bindRenderbuffer(Js,Vr.renderbuffer),ge.renderbufferStorage(Js,Vr.format,fi,Li),J(ge.getError()===0,"invalid render buffer format"),Pn.profile&&(Vr.stats.size=_f(Vr.format,Vr.width,Vr.height))),dn}return dn(Xn,ai),dn.resize=ri,dn._reglType="renderbuffer",dn._renderbuffer=Vr,Pn.profile&&(dn.stats=Vr.stats),dn.destroy=function(){Vr.decRef()},dn}Pn.profile&&(an.getTotalRenderbufferSize=function(){var Xn=0;return Object.keys(jn).forEach(function(ai){Xn+=jn[ai].stats.size}),Xn});function Ei(){ft(jn).forEach(function(Xn){Xn.renderbuffer=ge.createRenderbuffer(),ge.bindRenderbuffer(Js,Xn.renderbuffer),ge.renderbufferStorage(Js,Xn.format,Xn.width,Xn.height)}),ge.bindRenderbuffer(Js,null)}return{create:ii,clear:function(){ft(jn).forEach(ti)},restore:Ei}},lc=36160,Ll=36161,au=3553,Tc=34069,cc=36064,xf=36096,fc=36128,Xl=33306,Mf=36053,af=36054,Yl=36055,of=36057,$l=36061,Kl=36193,hc=5121,gu=5126,el=6407,Wc=6408,sf=6402,sh=[el,Wc],Pf=[];Pf[Wc]=4,Pf[el]=3;var n=[];n[hc]=1,n[gu]=4,n[Kl]=2;var o=32854,i=32855,l=36194,w=33189,z=36168,j=34041,ae=35907,Se=34836,He=34842,xt=34843,Et=[o,i,l,ae,He,xt,Se],Tt={};Tt[Mf]="complete",Tt[af]="incomplete attachment",Tt[of]="incomplete dimensions",Tt[Yl]="incomplete, missing attachment",Tt[$l]="unsupported";function Jt(ge,Lt,sr,an,Pn,rn){var yn={cur:null,next:null,dirty:!1,setFBO:null},In=["rgba"],jn=["rgba4","rgb565","rgb5 a1"];Lt.ext_srgb&&jn.push("srgba"),Lt.ext_color_buffer_half_float&&jn.push("rgba16f","rgb16f"),Lt.webgl_color_buffer_float&&jn.push("rgba32f");var Kn=["uint8"];Lt.oes_texture_half_float&&Kn.push("half float","float16"),Lt.oes_texture_float&&Kn.push("float","float32");function ti(qn,Oi,Ri){this.target=qn,this.texture=Oi,this.renderbuffer=Ri;var no=0,io=0;Oi?(no=Oi.width,io=Oi.height):Ri&&(no=Ri.width,io=Ri.height),this.width=no,this.height=io}function ii(qn){qn&&(qn.texture&&qn.texture._texture.decRef(),qn.renderbuffer&&qn.renderbuffer._renderbuffer.decRef())}function Ei(qn,Oi,Ri){if(!!qn)if(qn.texture){var no=qn.texture._texture,io=Math.max(1,no.width),Ii=Math.max(1,no.height);J(io===Oi&&Ii===Ri,"inconsistent width/height for supplied texture"),no.refCount+=1}else{var Di=qn.renderbuffer._renderbuffer;J(Di.width===Oi&&Di.height===Ri,"inconsistent width/height for renderbuffer"),Di.refCount+=1}}function Xn(qn,Oi){Oi&&(Oi.texture?ge.framebufferTexture2D(lc,qn,Oi.target,Oi.texture._texture.texture,0):ge.framebufferRenderbuffer(lc,qn,Ll,Oi.renderbuffer._renderbuffer.renderbuffer))}function ai(qn){var Oi=au,Ri=null,no=null,io=qn;typeof qn=="object"&&(io=qn.data,"target"in qn&&(Oi=qn.target|0)),J.type(io,"function","invalid attachment data");var Ii=io._reglType;return Ii==="texture2d"?(Ri=io,J(Oi===au)):Ii==="textureCube"?(Ri=io,J(Oi>=Tc&&Oi<Tc+6,"invalid cube map target")):Ii==="renderbuffer"?(no=io,Oi=Ll):J.raise("invalid regl object for attachment"),new ti(Oi,Ri,no)}function Vr(qn,Oi,Ri,no,io){if(Ri){var Ii=an.create2D({width:qn,height:Oi,format:no,type:io});return Ii._texture.refCount=0,new ti(au,Ii,null)}else{var Di=Pn.create({width:qn,height:Oi,format:no});return Di._renderbuffer.refCount=0,new ti(Ll,null,Di)}}function dn(qn){return qn&&(qn.texture||qn.renderbuffer)}function ri(qn,Oi,Ri){qn&&(qn.texture?qn.texture.resize(Oi,Ri):qn.renderbuffer&&qn.renderbuffer.resize(Oi,Ri),qn.width=Oi,qn.height=Ri)}var xi=0,Nn={};function fi(){this.id=xi++,Nn[this.id]=this,this.framebuffer=ge.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Li(qn){qn.colorAttachments.forEach(ii),ii(qn.depthAttachment),ii(qn.stencilAttachment),ii(qn.depthStencilAttachment)}function ga(qn){var Oi=qn.framebuffer;J(Oi,"must not double destroy framebuffer"),ge.deleteFramebuffer(Oi),qn.framebuffer=null,rn.framebufferCount--,delete Nn[qn.id]}function Cn(qn){var Oi;ge.bindFramebuffer(lc,qn.framebuffer);var Ri=qn.colorAttachments;for(Oi=0;Oi<Ri.length;++Oi)Xn(cc+Oi,Ri[Oi]);for(Oi=Ri.length;Oi<sr.maxColorAttachments;++Oi)ge.framebufferTexture2D(lc,cc+Oi,au,null,0);ge.framebufferTexture2D(lc,Xl,au,null,0),ge.framebufferTexture2D(lc,xf,au,null,0),ge.framebufferTexture2D(lc,fc,au,null,0),Xn(xf,qn.depthAttachment),Xn(fc,qn.stencilAttachment),Xn(Xl,qn.depthStencilAttachment);var no=ge.checkFramebufferStatus(lc);!ge.isContextLost()&&no!==Mf&&J.raise("framebuffer configuration not supported, status = "+Tt[no]),ge.bindFramebuffer(lc,yn.next?yn.next.framebuffer:null),yn.cur=yn.next,ge.getError()}function Mn(qn,Oi){var Ri=new fi;rn.framebufferCount++;function no(Ii,Di){var Xa;J(yn.next!==Ri,"can not update framebuffer which is currently in use");var lo=0,bo=0,nu=!0,$s=!0,Lo=null,ml=!0,bs="rgba",nl="uint8",Mu=1,il=null,al=null,kl=null,_u=!1;if(typeof Ii=="number")lo=Ii|0,bo=Di|0||lo;else if(!Ii)lo=bo=1;else{J.type(Ii,"object","invalid arguments for framebuffer");var ho=Ii;if("shape"in ho){var Bu=ho.shape;J(Array.isArray(Bu)&&Bu.length>=2,"invalid shape for framebuffer"),lo=Bu[0],bo=Bu[1]}else"radius"in ho&&(lo=bo=ho.radius),"width"in ho&&(lo=ho.width),"height"in ho&&(bo=ho.height);("color"in ho||"colors"in ho)&&(Lo=ho.color||ho.colors,Array.isArray(Lo)&&J(Lo.length===1||Lt.webgl_draw_buffers,"multiple render targets not supported")),Lo||("colorCount"in ho&&(Mu=ho.colorCount|0,J(Mu>0,"invalid color buffer count")),"colorTexture"in ho&&(ml=!!ho.colorTexture,bs="rgba4"),"colorType"in ho&&(nl=ho.colorType,ml?(J(Lt.oes_texture_float||!(nl==="float"||nl==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),J(Lt.oes_texture_half_float||!(nl==="half float"||nl==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):nl==="half float"||nl==="float16"?(J(Lt.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),bs="rgba16f"):(nl==="float"||nl==="float32")&&(J(Lt.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),bs="rgba32f"),J.oneOf(nl,Kn,"invalid color type")),"colorFormat"in ho&&(bs=ho.colorFormat,In.indexOf(bs)>=0?ml=!0:jn.indexOf(bs)>=0?ml=!1:J.optional(function(){ml?J.oneOf(ho.colorFormat,In,"invalid color format for texture"):J.oneOf(ho.colorFormat,jn,"invalid color format for renderbuffer")}))),("depthTexture"in ho||"depthStencilTexture"in ho)&&(_u=!!(ho.depthTexture||ho.depthStencilTexture),J(!_u||Lt.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ho&&(typeof ho.depth=="boolean"?nu=ho.depth:(il=ho.depth,$s=!1)),"stencil"in ho&&(typeof ho.stencil=="boolean"?$s=ho.stencil:(al=ho.stencil,nu=!1)),"depthStencil"in ho&&(typeof ho.depthStencil=="boolean"?nu=$s=ho.depthStencil:(kl=ho.depthStencil,nu=!1,$s=!1))}var is=null,Nu=null,Za=null,Zo=null;if(Array.isArray(Lo))is=Lo.map(ai);else if(Lo)is=[ai(Lo)];else for(is=new Array(Mu),Xa=0;Xa<Mu;++Xa)is[Xa]=Vr(lo,bo,ml,bs,nl);J(Lt.webgl_draw_buffers||is.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),J(is.length<=sr.maxColorAttachments,"too many color attachments, not supported"),lo=lo||is[0].width,bo=bo||is[0].height,il?Nu=ai(il):nu&&!$s&&(Nu=Vr(lo,bo,_u,"depth","uint32")),al?Za=ai(al):$s&&!nu&&(Za=Vr(lo,bo,!1,"stencil","uint8")),kl?Zo=ai(kl):!il&&!al&&$s&&nu&&(Zo=Vr(lo,bo,_u,"depth stencil","depth stencil")),J(!!il+!!al+!!kl<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var as=null;for(Xa=0;Xa<is.length;++Xa)if(Ei(is[Xa],lo,bo),J(!is[Xa]||is[Xa].texture&&sh.indexOf(is[Xa].texture._texture.format)>=0||is[Xa].renderbuffer&&Et.indexOf(is[Xa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Xa+" is invalid"),is[Xa]&&is[Xa].texture){var Os=Pf[is[Xa].texture._texture.format]*n[is[Xa].texture._texture.type];as===null?as=Os:J(as===Os,"all color attachments much have the same number of bits per pixel.")}return Ei(Nu,lo,bo),J(!Nu||Nu.texture&&Nu.texture._texture.format===sf||Nu.renderbuffer&&Nu.renderbuffer._renderbuffer.format===w,"invalid depth attachment for framebuffer object"),Ei(Za,lo,bo),J(!Za||Za.renderbuffer&&Za.renderbuffer._renderbuffer.format===z,"invalid stencil attachment for framebuffer object"),Ei(Zo,lo,bo),J(!Zo||Zo.texture&&Zo.texture._texture.format===j||Zo.renderbuffer&&Zo.renderbuffer._renderbuffer.format===j,"invalid depth-stencil attachment for framebuffer object"),Li(Ri),Ri.width=lo,Ri.height=bo,Ri.colorAttachments=is,Ri.depthAttachment=Nu,Ri.stencilAttachment=Za,Ri.depthStencilAttachment=Zo,no.color=is.map(dn),no.depth=dn(Nu),no.stencil=dn(Za),no.depthStencil=dn(Zo),no.width=Ri.width,no.height=Ri.height,Cn(Ri),no}function io(Ii,Di){J(yn.next!==Ri,"can not resize a framebuffer which is currently in use");var Xa=Math.max(Ii|0,1),lo=Math.max(Di|0||Xa,1);if(Xa===Ri.width&&lo===Ri.height)return no;for(var bo=Ri.colorAttachments,nu=0;nu<bo.length;++nu)ri(bo[nu],Xa,lo);return ri(Ri.depthAttachment,Xa,lo),ri(Ri.stencilAttachment,Xa,lo),ri(Ri.depthStencilAttachment,Xa,lo),Ri.width=no.width=Xa,Ri.height=no.height=lo,Cn(Ri),no}return no(qn,Oi),a(no,{resize:io,_reglType:"framebuffer",_framebuffer:Ri,destroy:function(){ga(Ri),Li(Ri)},use:function(Ii){yn.setFBO({framebuffer:no},Ii)}})}function Ki(qn){var Oi=Array(6);function Ri(io){var Ii;J(Oi.indexOf(yn.next)<0,"can not update framebuffer which is currently in use");var Di={color:null},Xa=0,lo=null,bo="rgba",nu="uint8",$s=1;if(typeof io=="number")Xa=io|0;else if(!io)Xa=1;else{J.type(io,"object","invalid arguments for framebuffer");var Lo=io;if("shape"in Lo){var ml=Lo.shape;J(Array.isArray(ml)&&ml.length>=2,"invalid shape for framebuffer"),J(ml[0]===ml[1],"cube framebuffer must be square"),Xa=ml[0]}else"radius"in Lo&&(Xa=Lo.radius|0),"width"in Lo?(Xa=Lo.width|0,"height"in Lo&&J(Lo.height===Xa,"must be square")):"height"in Lo&&(Xa=Lo.height|0);("color"in Lo||"colors"in Lo)&&(lo=Lo.color||Lo.colors,Array.isArray(lo)&&J(lo.length===1||Lt.webgl_draw_buffers,"multiple render targets not supported")),lo||("colorCount"in Lo&&($s=Lo.colorCount|0,J($s>0,"invalid color buffer count")),"colorType"in Lo&&(J.oneOf(Lo.colorType,Kn,"invalid color type"),nu=Lo.colorType),"colorFormat"in Lo&&(bo=Lo.colorFormat,J.oneOf(Lo.colorFormat,In,"invalid color format for texture"))),"depth"in Lo&&(Di.depth=Lo.depth),"stencil"in Lo&&(Di.stencil=Lo.stencil),"depthStencil"in Lo&&(Di.depthStencil=Lo.depthStencil)}var bs;if(lo)if(Array.isArray(lo))for(bs=[],Ii=0;Ii<lo.length;++Ii)bs[Ii]=lo[Ii];else bs=[lo];else{bs=Array($s);var nl={radius:Xa,format:bo,type:nu};for(Ii=0;Ii<$s;++Ii)bs[Ii]=an.createCube(nl)}for(Di.color=Array(bs.length),Ii=0;Ii<bs.length;++Ii){var Mu=bs[Ii];J(typeof Mu=="function"&&Mu._reglType==="textureCube","invalid cube map"),Xa=Xa||Mu.width,J(Mu.width===Xa&&Mu.height===Xa,"invalid cube map shape"),Di.color[Ii]={target:Tc,data:bs[Ii]}}for(Ii=0;Ii<6;++Ii){for(var il=0;il<bs.length;++il)Di.color[il].target=Tc+Ii;Ii>0&&(Di.depth=Oi[0].depth,Di.stencil=Oi[0].stencil,Di.depthStencil=Oi[0].depthStencil),Oi[Ii]?Oi[Ii](Di):Oi[Ii]=Mn(Di)}return a(Ri,{width:Xa,height:Xa,color:bs})}function no(io){var Ii,Di=io|0;if(J(Di>0&&Di<=sr.maxCubeMapSize,"invalid radius for cube fbo"),Di===Ri.width)return Ri;var Xa=Ri.color;for(Ii=0;Ii<Xa.length;++Ii)Xa[Ii].resize(Di);for(Ii=0;Ii<6;++Ii)Oi[Ii].resize(Di);return Ri.width=Ri.height=Di,Ri}return Ri(qn),a(Ri,{faces:Oi,resize:no,_reglType:"framebufferCube",destroy:function(){Oi.forEach(function(io){io.destroy()})}})}function Ti(){yn.cur=null,yn.next=null,yn.dirty=!0,ft(Nn).forEach(function(qn){qn.framebuffer=ge.createFramebuffer(),Cn(qn)})}return a(yn,{getFramebuffer:function(qn){if(typeof qn=="function"&&qn._reglType==="framebuffer"){var Oi=qn._framebuffer;if(Oi instanceof fi)return Oi}return null},create:Mn,createCube:Ki,clear:function(){ft(Nn).forEach(ga)},restore:Ti})}var Yt=5126,gr=34962,Vt=34963,mr=["attributes","elements","offset","count","primitive","instances"];function Ar(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Yt,this.offset=0,this.stride=0,this.divisor=0}function Xr(ge,Lt,sr,an,Pn,rn,yn){for(var In=sr.maxAttributes,jn=new Array(In),Kn=0;Kn<In;++Kn)jn[Kn]=new Ar;var ti=0,ii={},Ei={Record:Ar,scope:{},state:jn,currentVAO:null,targetVAO:null,restore:ai()?Li:function(){},createVAO:ga,getVAO:dn,destroyBuffer:Xn,setVAO:ai()?ri:xi,clear:ai()?Nn:function(){}};function Xn(Cn){for(var Mn=0;Mn<jn.length;++Mn){var Ki=jn[Mn];Ki.buffer===Cn&&(ge.disableVertexAttribArray(Mn),Ki.buffer=null)}}function ai(){return Lt.oes_vertex_array_object}function Vr(){return Lt.angle_instanced_arrays}function dn(Cn){return typeof Cn=="function"&&Cn._vao?Cn._vao:null}function ri(Cn){if(Cn!==Ei.currentVAO){var Mn=ai();Cn?Mn.bindVertexArrayOES(Cn.vao):Mn.bindVertexArrayOES(null),Ei.currentVAO=Cn}}function xi(Cn){if(Cn!==Ei.currentVAO){if(Cn)Cn.bindAttrs();else{for(var Mn=Vr(),Ki=0;Ki<jn.length;++Ki){var Ti=jn[Ki];Ti.buffer?(ge.enableVertexAttribArray(Ki),Ti.buffer.bind(),ge.vertexAttribPointer(Ki,Ti.size,Ti.type,Ti.normalized,Ti.stride,Ti.offfset),Mn&&Ti.divisor&&Mn.vertexAttribDivisorANGLE(Ki,Ti.divisor)):(ge.disableVertexAttribArray(Ki),ge.vertexAttrib4f(Ki,Ti.x,Ti.y,Ti.z,Ti.w))}yn.elements?ge.bindBuffer(Vt,yn.elements.buffer.buffer):ge.bindBuffer(Vt,null)}Ei.currentVAO=Cn}}function Nn(){ft(ii).forEach(function(Cn){Cn.destroy()})}function fi(){this.id=++ti,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Cn=ai();Cn?this.vao=Cn.createVertexArrayOES():this.vao=null,ii[this.id]=this,this.buffers=[]}fi.prototype.bindAttrs=function(){for(var Cn=Vr(),Mn=this.attributes,Ki=0;Ki<Mn.length;++Ki){var Ti=Mn[Ki];Ti.buffer?(ge.enableVertexAttribArray(Ki),ge.bindBuffer(gr,Ti.buffer.buffer),ge.vertexAttribPointer(Ki,Ti.size,Ti.type,Ti.normalized,Ti.stride,Ti.offset),Cn&&Ti.divisor&&Cn.vertexAttribDivisorANGLE(Ki,Ti.divisor)):(ge.disableVertexAttribArray(Ki),ge.vertexAttrib4f(Ki,Ti.x,Ti.y,Ti.z,Ti.w))}for(var qn=Mn.length;qn<In;++qn)ge.disableVertexAttribArray(qn);var Oi=rn.getElements(this.elements);Oi?ge.bindBuffer(Vt,Oi.buffer.buffer):ge.bindBuffer(Vt,null)},fi.prototype.refresh=function(){var Cn=ai();Cn&&(Cn.bindVertexArrayOES(this.vao),this.bindAttrs(),Ei.currentVAO=null,Cn.bindVertexArrayOES(null))},fi.prototype.destroy=function(){if(this.vao){var Cn=ai();this===Ei.currentVAO&&(Ei.currentVAO=null,Cn.bindVertexArrayOES(null)),Cn.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ii[this.id]&&(delete ii[this.id],an.vaoCount-=1)};function Li(){var Cn=ai();Cn&&ft(ii).forEach(function(Mn){Mn.refresh()})}function ga(Cn){var Mn=new fi;an.vaoCount+=1;function Ki(Ti){var qn;if(Array.isArray(Ti))qn=Ti,Mn.elements&&Mn.ownsElements&&Mn.elements.destroy(),Mn.elements=null,Mn.ownsElements=!1,Mn.offset=0,Mn.count=0,Mn.instances=-1,Mn.primitive=4;else{if(J(typeof Ti=="object","invalid arguments for create vao"),J("attributes"in Ti,"must specify attributes for vao"),Ti.elements){var Oi=Ti.elements;Mn.ownsElements?typeof Oi=="function"&&Oi._reglType==="elements"?(Mn.elements.destroy(),Mn.ownsElements=!1):(Mn.elements(Oi),Mn.ownsElements=!1):rn.getElements(Ti.elements)?(Mn.elements=Ti.elements,Mn.ownsElements=!1):(Mn.elements=rn.create(Ti.elements),Mn.ownsElements=!0)}else Mn.elements=null,Mn.ownsElements=!1;qn=Ti.attributes,Mn.offset=0,Mn.count=-1,Mn.instances=-1,Mn.primitive=4,Mn.elements&&(Mn.count=Mn.elements._elements.vertCount,Mn.primitive=Mn.elements._elements.primType),"offset"in Ti&&(Mn.offset=Ti.offset|0),"count"in Ti&&(Mn.count=Ti.count|0),"instances"in Ti&&(Mn.instances=Ti.instances|0),"primitive"in Ti&&(J(Ti.primitive in En,"bad primitive type: "+Ti.primitive),Mn.primitive=En[Ti.primitive]),J.optional(function(){for(var nu=Object.keys(Ti),$s=0;$s<nu.length;++$s)J(mr.indexOf(nu[$s])>=0,'invalid option for vao: "'+nu[$s]+'" valid options are '+mr)}),J(Array.isArray(qn),"attributes must be an array")}J(qn.length<In,"too many attributes"),J(qn.length>0,"must specify at least one attribute");var Ri={},no=Mn.attributes;no.length=qn.length;for(var io=0;io<qn.length;++io){var Ii=qn[io],Di=no[io]=new Ar,Xa=Ii.data||Ii;if(Array.isArray(Xa)||Z(Xa)||Gs(Xa)){var lo;Mn.buffers[io]&&(lo=Mn.buffers[io],Z(Xa)&&lo._buffer.byteLength>=Xa.byteLength?lo.subdata(Xa):(lo.destroy(),Mn.buffers[io]=null)),Mn.buffers[io]||(lo=Mn.buffers[io]=Pn.create(Ii,gr,!1,!0)),Di.buffer=Pn.getBuffer(lo),Di.size=Di.buffer.dimension|0,Di.normalized=!1,Di.type=Di.buffer.dtype,Di.offset=0,Di.stride=0,Di.divisor=0,Di.state=1,Ri[io]=1}else Pn.getBuffer(Ii)?(Di.buffer=Pn.getBuffer(Ii),Di.size=Di.buffer.dimension|0,Di.normalized=!1,Di.type=Di.buffer.dtype,Di.offset=0,Di.stride=0,Di.divisor=0,Di.state=1):Pn.getBuffer(Ii.buffer)?(Di.buffer=Pn.getBuffer(Ii.buffer),Di.size=(+Ii.size||Di.buffer.dimension)|0,Di.normalized=!!Ii.normalized||!1,"type"in Ii?(J.parameter(Ii.type,Oa,"invalid buffer type"),Di.type=Oa[Ii.type]):Di.type=Di.buffer.dtype,Di.offset=(Ii.offset||0)|0,Di.stride=(Ii.stride||0)|0,Di.divisor=(Ii.divisor||0)|0,Di.state=1,J(Di.size>=1&&Di.size<=4,"size must be between 1 and 4"),J(Di.offset>=0,"invalid offset"),J(Di.stride>=0&&Di.stride<=255,"stride must be between 0 and 255"),J(Di.divisor>=0,"divisor must be positive"),J(!Di.divisor||!!Lt.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ii?(J(io>0,"first attribute must not be a constant"),Di.x=+Ii.x||0,Di.y=+Ii.y||0,Di.z=+Ii.z||0,Di.w=+Ii.w||0,Di.state=2):J(!1,"invalid attribute spec for location "+io)}for(var bo=0;bo<Mn.buffers.length;++bo)!Ri[bo]&&Mn.buffers[bo]&&(Mn.buffers[bo].destroy(),Mn.buffers[bo]=null);return Mn.refresh(),Ki}return Ki.destroy=function(){for(var Ti=0;Ti<Mn.buffers.length;++Ti)Mn.buffers[Ti]&&Mn.buffers[Ti].destroy();Mn.buffers.length=0,Mn.ownsElements&&(Mn.elements.destroy(),Mn.elements=null,Mn.ownsElements=!1),Mn.destroy()},Ki._vao=Mn,Ki._reglType="vao",Ki(Cn)}return Ei}var cn=35632,nn=35633,pn=35718,Bn=35721;function Zn(ge,Lt,sr,an){var Pn={},rn={};function yn(Vr,dn,ri,xi){this.name=Vr,this.id=dn,this.location=ri,this.info=xi}function In(Vr,dn){for(var ri=0;ri<Vr.length;++ri)if(Vr[ri].id===dn.id){Vr[ri].location=dn.location;return}Vr.push(dn)}function jn(Vr,dn,ri){var xi=Vr===cn?Pn:rn,Nn=xi[dn];if(!Nn){var fi=Lt.str(dn);Nn=ge.createShader(Vr),ge.shaderSource(Nn,fi),ge.compileShader(Nn),J.shaderError(ge,Nn,fi,Vr,ri),xi[dn]=Nn}return Nn}var Kn={},ti=[],ii=0;function Ei(Vr,dn){this.id=ii++,this.fragId=Vr,this.vertId=dn,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,an.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Xn(Vr,dn,ri){var xi,Nn,fi=jn(cn,Vr.fragId),Li=jn(nn,Vr.vertId),ga=Vr.program=ge.createProgram();if(ge.attachShader(ga,fi),ge.attachShader(ga,Li),ri)for(xi=0;xi<ri.length;++xi){var Cn=ri[xi];ge.bindAttribLocation(ga,Cn[0],Cn[1])}ge.linkProgram(ga),J.linkError(ge,ga,Lt.str(Vr.fragId),Lt.str(Vr.vertId),dn);var Mn=ge.getProgramParameter(ga,pn);an.profile&&(Vr.stats.uniformsCount=Mn);var Ki=Vr.uniforms;for(xi=0;xi<Mn;++xi)if(Nn=ge.getActiveUniform(ga,xi),Nn)if(Nn.size>1)for(var Ti=0;Ti<Nn.size;++Ti){var qn=Nn.name.replace("[0]","["+Ti+"]");In(Ki,new yn(qn,Lt.id(qn),ge.getUniformLocation(ga,qn),Nn))}else In(Ki,new yn(Nn.name,Lt.id(Nn.name),ge.getUniformLocation(ga,Nn.name),Nn));var Oi=ge.getProgramParameter(ga,Bn);an.profile&&(Vr.stats.attributesCount=Oi);var Ri=Vr.attributes;for(xi=0;xi<Oi;++xi)Nn=ge.getActiveAttrib(ga,xi),Nn&&In(Ri,new yn(Nn.name,Lt.id(Nn.name),ge.getAttribLocation(ga,Nn.name),Nn))}an.profile&&(sr.getMaxUniformsCount=function(){var Vr=0;return ti.forEach(function(dn){dn.stats.uniformsCount>Vr&&(Vr=dn.stats.uniformsCount)}),Vr},sr.getMaxAttributesCount=function(){var Vr=0;return ti.forEach(function(dn){dn.stats.attributesCount>Vr&&(Vr=dn.stats.attributesCount)}),Vr});function ai(){Pn={},rn={};for(var Vr=0;Vr<ti.length;++Vr)Xn(ti[Vr],null,ti[Vr].attributes.map(function(dn){return[dn.location,dn.name]}))}return{clear:function(){var Vr=ge.deleteShader.bind(ge);ft(Pn).forEach(Vr),Pn={},ft(rn).forEach(Vr),rn={},ti.forEach(function(dn){ge.deleteProgram(dn.program)}),ti.length=0,Kn={},sr.shaderCount=0},program:function(Vr,dn,ri,xi){J.command(Vr>=0,"missing vertex shader",ri),J.command(dn>=0,"missing fragment shader",ri);var Nn=Kn[dn];Nn||(Nn=Kn[dn]={});var fi=Nn[Vr];if(fi&&(fi.refCount++,!xi))return fi;var Li=new Ei(dn,Vr);return sr.shaderCount++,Xn(Li,ri,xi),fi||(Nn[Vr]=Li),ti.push(Li),a(Li,{destroy:function(){if(Li.refCount--,Li.refCount<=0){ge.deleteProgram(Li.program);var ga=ti.indexOf(Li);ti.splice(ga,1),sr.shaderCount--}Nn[Li.vertId].refCount<=0&&(ge.deleteShader(rn[Li.vertId]),delete rn[Li.vertId],delete Kn[Li.fragId][Li.vertId]),Object.keys(Kn[Li.fragId]).length||(ge.deleteShader(Pn[Li.fragId]),delete Pn[Li.fragId],delete Kn[Li.fragId])}})},restore:ai,shader:jn,frag:-1,vert:-1}}var Vn=6408,Si=5121,Zi=3333,ca=5126;function ma(ge,Lt,sr,an,Pn,rn,yn){function In(ti){var ii;Lt.next===null?(J(Pn.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ii=Si):(J(Lt.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ii=Lt.next.colorAttachments[0].texture._texture.type,J.optional(function(){rn.oes_texture_float?(J(ii===Si||ii===ca,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ii===ca&&J(yn.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):J(ii===Si,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var Ei=0,Xn=0,ai=an.framebufferWidth,Vr=an.framebufferHeight,dn=null;Z(ti)?dn=ti:ti&&(J.type(ti,"object","invalid arguments to regl.read()"),Ei=ti.x|0,Xn=ti.y|0,J(Ei>=0&&Ei<an.framebufferWidth,"invalid x offset for regl.read"),J(Xn>=0&&Xn<an.framebufferHeight,"invalid y offset for regl.read"),ai=(ti.width||an.framebufferWidth-Ei)|0,Vr=(ti.height||an.framebufferHeight-Xn)|0,dn=ti.data||null),dn&&(ii===Si?J(dn instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ii===ca&&J(dn instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),J(ai>0&&ai+Ei<=an.framebufferWidth,"invalid width for read pixels"),J(Vr>0&&Vr+Xn<=an.framebufferHeight,"invalid height for read pixels"),sr();var ri=ai*Vr*4;return dn||(ii===Si?dn=new Uint8Array(ri):ii===ca&&(dn=dn||new Float32Array(ri))),J.isTypedArray(dn,"data buffer for regl.read() must be a typedarray"),J(dn.byteLength>=ri,"data buffer for regl.read() too small"),ge.pixelStorei(Zi,4),ge.readPixels(Ei,Xn,ai,Vr,Vn,ii,dn),dn}function jn(ti){var ii;return Lt.setFBO({framebuffer:ti.framebuffer},function(){ii=In(ti)}),ii}function Kn(ti){return!ti||!("framebuffer"in ti)?In(ti):jn(ti)}return Kn}function Co(ge){return Array.prototype.slice.call(ge)}function Pi(ge){return Co(ge).join("")}function Ha(){var ge=0,Lt=[],sr=[];function an(ii){for(var Ei=0;Ei<sr.length;++Ei)if(sr[Ei]===ii)return Lt[Ei];var Xn="g"+ge++;return Lt.push(Xn),sr.push(ii),Xn}function Pn(){var ii=[];function Ei(){ii.push.apply(ii,Co(arguments))}var Xn=[];function ai(){var Vr="v"+ge++;return Xn.push(Vr),arguments.length>0&&(ii.push(Vr,"="),ii.push.apply(ii,Co(arguments)),ii.push(";")),Vr}return a(Ei,{def:ai,toString:function(){return Pi([Xn.length>0?"var "+Xn.join(",")+";":"",Pi(ii)])}})}function rn(){var ii=Pn(),Ei=Pn(),Xn=ii.toString,ai=Ei.toString;function Vr(dn,ri){Ei(dn,ri,"=",ii.def(dn,ri),";")}return a(function(){ii.apply(ii,Co(arguments))},{def:ii.def,entry:ii,exit:Ei,save:Vr,set:function(dn,ri,xi){Vr(dn,ri),ii(dn,ri,"=",xi,";")},toString:function(){return Xn()+ai()}})}function yn(){var ii=Pi(arguments),Ei=rn(),Xn=rn(),ai=Ei.toString,Vr=Xn.toString;return a(Ei,{then:function(){return Ei.apply(Ei,Co(arguments)),this},else:function(){return Xn.apply(Xn,Co(arguments)),this},toString:function(){var dn=Vr();return dn&&(dn="else{"+dn+"}"),Pi(["if(",ii,"){",ai(),"}",dn])}})}var In=Pn(),jn={};function Kn(ii,Ei){var Xn=[];function ai(){var Nn="a"+Xn.length;return Xn.push(Nn),Nn}Ei=Ei||0;for(var Vr=0;Vr<Ei;++Vr)ai();var dn=rn(),ri=dn.toString,xi=jn[ii]=a(dn,{arg:ai,toString:function(){return Pi(["function(",Xn.join(),"){",ri(),"}"])}});return xi}function ti(){var ii=['"use strict";',In,"return {"];Object.keys(jn).forEach(function(Vr){ii.push('"',Vr,'":',jn[Vr].toString(),",")}),ii.push("}");var Ei=Pi(ii).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Xn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ai=Xn?v.Function.apply(null,Lt.concat(Ei)):Function.apply(null,Lt.concat(Ei));return ai.apply(null,sr)}return{global:In,link:an,block:Pn,proc:Kn,scope:rn,cond:yn,compile:ti}}var Ma="xyzw".split(""),Ba=5121,Ea=1,oo=2,Pa=0,Aa=1,eu=2,As=3,tu=4,Ls=5,Ho=6,xs="dither",zs="blend.enable",yu="blend.color",Xc="blend.equation",ou="blend.func",su="depth.enable",Fs="depth.func",uf="depth.range",tl="depth.mask",Ol="colorMask",wc="cull.enable",Mc="cull.face",Us="frontFace",Yc="lineWidth",Il="polygonOffset.enable",Bs="polygonOffset.offset",pc="sample.alpha",dc="sample.enable",ql="sample.coverage",Uo="stencil.enable",rl="stencil.mask",uu="stencil.func",vc="stencil.opFront",jf="stencil.opBack",Pc="scissor.enable",Lf="scissor.box",Rl="viewport",Du="profile",ku="framebuffer",Lc="vert",lf="frag",Oc="elements",hu="primitive",bf="count",Gf="offset",Kf="instances",Ef="vao",Cf="Width",_h="Height",$c=ku+Cf,Of=ku+_h,If=Rl+Cf,Rf=Rl+_h,dl="drawingBuffer",uh=dl+Cf,xh=dl+_h,qf=[ou,Xc,uu,vc,jf,ql,Rl,Lf,Bs],Vf=34962,bh=34963,gp=35632,lh=35633,Gh=3553,Ph=34067,ch=2884,Fu=3042,Dl=3024,ns=2960,Qf=2929,Df=3089,Hf=32823,Wf=32926,Kc=32928,kf=5126,qc=35664,Qc=35665,Ic=35666,C=5124,ve=35667,$=35668,ee=35669,Ee=35670,We=35671,er=35672,hr=35673,Kt=35674,kr=35675,wn=35676,Ai=35678,Hi=35680,$i=4,R=1028,m=1029,u=2304,_=2305,b=32775,q=32776,de=519,ct=7680,st=0,Mt=1,Ir=32774,Gr=513,xn=36160,gn=36064,Sn={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Wn=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],bi={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},pa={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Wa={frag:gp,vert:lh},Qa={cw:u,ccw:_};function ro(ge){return Array.isArray(ge)||Z(ge)||Gs(ge)}function Ko(ge){return ge.sort(function(Lt,sr){return Lt===Rl?-1:sr===Rl?1:Lt<sr?-1:1})}function sa(ge,Lt,sr,an){this.thisDep=ge,this.contextDep=Lt,this.propDep=sr,this.append=an}function _o(ge){return ge&&!(ge.thisDep||ge.contextDep||ge.propDep)}function xa(ge){return new sa(!1,!1,!1,ge)}function xo(ge,Lt){var sr=ge.type;if(sr===Pa){var an=ge.data.length;return new sa(!0,an>=1,an>=2,Lt)}else if(sr===tu){var Pn=ge.data;return new sa(Pn.thisDep,Pn.contextDep,Pn.propDep,Lt)}else{if(sr===Ls)return new sa(!1,!1,!1,Lt);if(sr===Ho){for(var rn=!1,yn=!1,In=!1,jn=0;jn<ge.data.length;++jn){var Kn=ge.data[jn];if(Kn.type===Aa)In=!0;else if(Kn.type===eu)yn=!0;else if(Kn.type===As)rn=!0;else if(Kn.type===Pa){rn=!0;var ti=Kn.data;ti>=1&&(yn=!0),ti>=2&&(In=!0)}else Kn.type===tu&&(rn=rn||Kn.data.thisDep,yn=yn||Kn.data.contextDep,In=In||Kn.data.propDep)}return new sa(rn,yn,In,Lt)}else return new sa(sr===As,sr===eu,sr===Aa,Lt)}}var ds=new sa(!1,!1,!1,function(){});function ru(ge,Lt,sr,an,Pn,rn,yn,In,jn,Kn,ti,ii,Ei,Xn,ai){var Vr=Kn.Record,dn={add:32774,subtract:32778,"reverse subtract":32779};sr.ext_blend_minmax&&(dn.min=b,dn.max=q);var ri=sr.angle_instanced_arrays,xi=sr.webgl_draw_buffers,Nn=sr.oes_vertex_array_object,fi={dirty:!0,profile:ai.profile},Li={},ga=[],Cn={},Mn={};function Ki(Dt){return Dt.replace(".","_")}function Ti(Dt,Ct,yr){var wr=Ki(Dt);ga.push(Dt),Li[wr]=fi[wr]=!!yr,Cn[wr]=Ct}function qn(Dt,Ct,yr){var wr=Ki(Dt);ga.push(Dt),Array.isArray(yr)?(fi[wr]=yr.slice(),Li[wr]=yr.slice()):fi[wr]=Li[wr]=yr,Mn[wr]=Ct}Ti(xs,Dl),Ti(zs,Fu),qn(yu,"blendColor",[0,0,0,0]),qn(Xc,"blendEquationSeparate",[Ir,Ir]),qn(ou,"blendFuncSeparate",[Mt,st,Mt,st]),Ti(su,Qf,!0),qn(Fs,"depthFunc",Gr),qn(uf,"depthRange",[0,1]),qn(tl,"depthMask",!0),qn(Ol,Ol,[!0,!0,!0,!0]),Ti(wc,ch),qn(Mc,"cullFace",m),qn(Us,Us,_),qn(Yc,Yc,1),Ti(Il,Hf),qn(Bs,"polygonOffset",[0,0]),Ti(pc,Wf),Ti(dc,Kc),qn(ql,"sampleCoverage",[1,!1]),Ti(Uo,ns),qn(rl,"stencilMask",-1),qn(uu,"stencilFunc",[de,0,-1]),qn(vc,"stencilOpSeparate",[R,ct,ct,ct]),qn(jf,"stencilOpSeparate",[m,ct,ct,ct]),Ti(Pc,Df),qn(Lf,"scissor",[0,0,ge.drawingBufferWidth,ge.drawingBufferHeight]),qn(Rl,Rl,[0,0,ge.drawingBufferWidth,ge.drawingBufferHeight]);var Oi={gl:ge,context:Ei,strings:Lt,next:Li,current:fi,draw:ii,elements:rn,buffer:Pn,shader:ti,attributes:Kn.state,vao:Kn,uniforms:jn,framebuffer:In,extensions:sr,timer:Xn,isBufferArgs:ro},Ri={primTypes:En,compareFuncs:bi,blendFuncs:Sn,blendEquations:dn,stencilOps:pa,glTypes:Oa,orientationType:Qa};J.optional(function(){Oi.isArrayLike=qo}),xi&&(Ri.backBuffer=[m],Ri.drawBuffer=Ut(an.maxDrawbuffers,function(Dt){return Dt===0?[0]:Ut(Dt,function(Ct){return gn+Ct})}));var no=0;function io(){var Dt=Ha(),Ct=Dt.link,yr=Dt.global;Dt.id=no++,Dt.batchId="0";var wr=Ct(Oi),tn=Dt.shared={props:"a0"};Object.keys(Oi).forEach(function(pr){tn[pr]=yr.def(wr,".",pr)}),J.optional(function(){Dt.CHECK=Ct(J),Dt.commandStr=J.guessCommand(),Dt.command=Ct(Dt.commandStr),Dt.assert=function(pr,jt,Wr){pr("if(!(",jt,"))",this.CHECK,".commandRaise(",Ct(Wr),",",this.command,");")},Ri.invalidBlendCombinations=Wn});var Er=Dt.next={},ar=Dt.current={};Object.keys(Mn).forEach(function(pr){Array.isArray(fi[pr])&&(Er[pr]=yr.def(tn.next,".",pr),ar[pr]=yr.def(tn.current,".",pr))});var Rr=Dt.constants={};Object.keys(Ri).forEach(function(pr){Rr[pr]=yr.def(JSON.stringify(Ri[pr]))}),Dt.invoke=function(pr,jt){switch(jt.type){case Pa:var Wr=["this",tn.context,tn.props,Dt.batchId];return pr.def(Ct(jt.data),".call(",Wr.slice(0,Math.max(jt.data.length+1,4)),")");case Aa:return pr.def(tn.props,jt.data);case eu:return pr.def(tn.context,jt.data);case As:return pr.def("this",jt.data);case tu:return jt.data.append(Dt,pr),jt.data.ref;case Ls:return jt.data.toString();case Ho:return jt.data.map(function(qr){return Dt.invoke(pr,qr)})}},Dt.attribCache={};var Rt={};return Dt.scopeAttrib=function(pr){var jt=Lt.id(pr);if(jt in Rt)return Rt[jt];var Wr=Kn.scope[jt];Wr||(Wr=Kn.scope[jt]=new Vr);var qr=Rt[jt]=Ct(Wr);return qr},Dt}function Ii(Dt){var Ct=Dt.static,yr=Dt.dynamic,wr;if(Du in Ct){var tn=!!Ct[Du];wr=xa(function(ar,Rr){return tn}),wr.enable=tn}else if(Du in yr){var Er=yr[Du];wr=xo(Er,function(ar,Rr){return ar.invoke(Rr,Er)})}return wr}function Di(Dt,Ct){var yr=Dt.static,wr=Dt.dynamic;if(ku in yr){var tn=yr[ku];return tn?(tn=In.getFramebuffer(tn),J.command(tn,"invalid framebuffer object"),xa(function(ar,Rr){var Rt=ar.link(tn),pr=ar.shared;Rr.set(pr.framebuffer,".next",Rt);var jt=pr.context;return Rr.set(jt,"."+$c,Rt+".width"),Rr.set(jt,"."+Of,Rt+".height"),Rt})):xa(function(ar,Rr){var Rt=ar.shared;Rr.set(Rt.framebuffer,".next","null");var pr=Rt.context;return Rr.set(pr,"."+$c,pr+"."+uh),Rr.set(pr,"."+Of,pr+"."+xh),"null"})}else if(ku in wr){var Er=wr[ku];return xo(Er,function(ar,Rr){var Rt=ar.invoke(Rr,Er),pr=ar.shared,jt=pr.framebuffer,Wr=Rr.def(jt,".getFramebuffer(",Rt,")");J.optional(function(){ar.assert(Rr,"!"+Rt+"||"+Wr,"invalid framebuffer object")}),Rr.set(jt,".next",Wr);var qr=pr.context;return Rr.set(qr,"."+$c,Wr+"?"+Wr+".width:"+qr+"."+uh),Rr.set(qr,"."+Of,Wr+"?"+Wr+".height:"+qr+"."+xh),Wr})}else return null}function Xa(Dt,Ct,yr){var wr=Dt.static,tn=Dt.dynamic;function Er(Rt){if(Rt in wr){var pr=wr[Rt];J.commandType(pr,"object","invalid "+Rt,yr.commandStr);var jt=!0,Wr=pr.x|0,qr=pr.y|0,zn,yi;return"width"in pr?(zn=pr.width|0,J.command(zn>=0,"invalid "+Rt,yr.commandStr)):jt=!1,"height"in pr?(yi=pr.height|0,J.command(yi>=0,"invalid "+Rt,yr.commandStr)):jt=!1,new sa(!jt&&Ct&&Ct.thisDep,!jt&&Ct&&Ct.contextDep,!jt&&Ct&&Ct.propDep,function(pi,aa){var Ui=pi.shared.context,Ji=zn;"width"in pr||(Ji=aa.def(Ui,".",$c,"-",Wr));var ea=yi;return"height"in pr||(ea=aa.def(Ui,".",Of,"-",qr)),[Wr,qr,Ji,ea]})}else if(Rt in tn){var gi=tn[Rt],Bi=xo(gi,function(pi,aa){var Ui=pi.invoke(aa,gi);J.optional(function(){pi.assert(aa,Ui+"&&typeof "+Ui+'==="object"',"invalid "+Rt)});var Ji=pi.shared.context,ea=aa.def(Ui,".x|0"),ji=aa.def(Ui,".y|0"),Ya=aa.def('"width" in ',Ui,"?",Ui,".width|0:","(",Ji,".",$c,"-",ea,")"),Es=aa.def('"height" in ',Ui,"?",Ui,".height|0:","(",Ji,".",Of,"-",ji,")");return J.optional(function(){pi.assert(aa,Ya+">=0&&"+Es+">=0","invalid "+Rt)}),[ea,ji,Ya,Es]});return Ct&&(Bi.thisDep=Bi.thisDep||Ct.thisDep,Bi.contextDep=Bi.contextDep||Ct.contextDep,Bi.propDep=Bi.propDep||Ct.propDep),Bi}else return Ct?new sa(Ct.thisDep,Ct.contextDep,Ct.propDep,function(pi,aa){var Ui=pi.shared.context;return[0,0,aa.def(Ui,".",$c),aa.def(Ui,".",Of)]}):null}var ar=Er(Rl);if(ar){var Rr=ar;ar=new sa(ar.thisDep,ar.contextDep,ar.propDep,function(Rt,pr){var jt=Rr.append(Rt,pr),Wr=Rt.shared.context;return pr.set(Wr,"."+If,jt[2]),pr.set(Wr,"."+Rf,jt[3]),jt})}return{viewport:ar,scissor_box:Er(Lf)}}function lo(Dt,Ct){var yr=Dt.static,wr=typeof yr[lf]=="string"&&typeof yr[Lc]=="string";if(wr){if(Object.keys(Ct.dynamic).length>0)return null;var tn=Ct.static,Er=Object.keys(tn);if(Er.length>0&&typeof tn[Er[0]]=="number"){for(var ar=[],Rr=0;Rr<Er.length;++Rr)J(typeof tn[Er[Rr]]=="number","must specify all vertex attribute locations when using vaos"),ar.push([tn[Er[Rr]]|0,Er[Rr]]);return ar}}return null}function bo(Dt,Ct,yr){var wr=Dt.static,tn=Dt.dynamic;function Er(jt){if(jt in wr){var Wr=Lt.id(wr[jt]);J.optional(function(){ti.shader(Wa[jt],Wr,J.guessCommand())});var qr=xa(function(){return Wr});return qr.id=Wr,qr}else if(jt in tn){var zn=tn[jt];return xo(zn,function(yi,gi){var Bi=yi.invoke(gi,zn),pi=gi.def(yi.shared.strings,".id(",Bi,")");return J.optional(function(){gi(yi.shared.shader,".shader(",Wa[jt],",",pi,",",yi.command,");")}),pi})}return null}var ar=Er(lf),Rr=Er(Lc),Rt=null,pr;return _o(ar)&&_o(Rr)?(Rt=ti.program(Rr.id,ar.id,null,yr),pr=xa(function(jt,Wr){return jt.link(Rt)})):pr=new sa(ar&&ar.thisDep||Rr&&Rr.thisDep,ar&&ar.contextDep||Rr&&Rr.contextDep,ar&&ar.propDep||Rr&&Rr.propDep,function(jt,Wr){var qr=jt.shared.shader,zn;ar?zn=ar.append(jt,Wr):zn=Wr.def(qr,".",lf);var yi;Rr?yi=Rr.append(jt,Wr):yi=Wr.def(qr,".",Lc);var gi=qr+".program("+yi+","+zn;return J.optional(function(){gi+=","+jt.command}),Wr.def(gi+")")}),{frag:ar,vert:Rr,progVar:pr,program:Rt}}function nu(Dt,Ct){var yr=Dt.static,wr=Dt.dynamic,tn={},Er=!1;function ar(){if(Ef in yr){var aa=yr[Ef];return aa!==null&&Kn.getVAO(aa)===null&&(aa=Kn.createVAO(aa)),Er=!0,tn.vao=aa,xa(function(Ji){var ea=Kn.getVAO(aa);return ea?Ji.link(ea):"null"})}else if(Ef in wr){Er=!0;var Ui=wr[Ef];return xo(Ui,function(Ji,ea){var ji=Ji.invoke(ea,Ui);return ea.def(Ji.shared.vao+".getVAO("+ji+")")})}return null}var Rr=ar(),Rt=!1;function pr(){if(Oc in yr){var aa=yr[Oc];if(tn.elements=aa,ro(aa)){var Ui=tn.elements=rn.create(aa,!0);aa=rn.getElements(Ui),Rt=!0}else aa&&(aa=rn.getElements(aa),Rt=!0,J.command(aa,"invalid elements",Ct.commandStr));var Ji=xa(function(ji,Ya){if(aa){var Es=ji.link(aa);return ji.ELEMENTS=Es,Es}return ji.ELEMENTS=null,null});return Ji.value=aa,Ji}else if(Oc in wr){Rt=!0;var ea=wr[Oc];return xo(ea,function(ji,Ya){var Es=ji.shared,ol=Es.isBufferArgs,os=Es.elements,us=ji.invoke(Ya,ea),Sf=Ya.def("null"),yc=Ya.def(ol,"(",us,")"),Ff=ji.cond(yc).then(Sf,"=",os,".createStream(",us,");").else(Sf,"=",os,".getElements(",us,");");return J.optional(function(){ji.assert(Ff.else,"!"+us+"||"+Sf,"invalid elements")}),Ya.entry(Ff),Ya.exit(ji.cond(yc).then(os,".destroyStream(",Sf,");")),ji.ELEMENTS=Sf,Sf})}else if(Er)return new sa(Rr.thisDep,Rr.contextDep,Rr.propDep,function(ji,Ya){return Ya.def(ji.shared.vao+".currentVAO?"+ji.shared.elements+".getElements("+ji.shared.vao+".currentVAO.elements):null")});return null}var jt=pr();function Wr(){if(hu in yr){var aa=yr[hu];return tn.primitive=aa,J.commandParameter(aa,En,"invalid primitve",Ct.commandStr),xa(function(Ji,ea){return En[aa]})}else if(hu in wr){var Ui=wr[hu];return xo(Ui,function(Ji,ea){var ji=Ji.constants.primTypes,Ya=Ji.invoke(ea,Ui);return J.optional(function(){Ji.assert(ea,Ya+" in "+ji,"invalid primitive, must be one of "+Object.keys(En))}),ea.def(ji,"[",Ya,"]")})}else{if(Rt)return _o(jt)?jt.value?xa(function(Ji,ea){return ea.def(Ji.ELEMENTS,".primType")}):xa(function(){return $i}):new sa(jt.thisDep,jt.contextDep,jt.propDep,function(Ji,ea){var ji=Ji.ELEMENTS;return ea.def(ji,"?",ji,".primType:",$i)});if(Er)return new sa(Rr.thisDep,Rr.contextDep,Rr.propDep,function(Ji,ea){return ea.def(Ji.shared.vao+".currentVAO?"+Ji.shared.vao+".currentVAO.primitive:"+$i)})}return null}function qr(aa,Ui){if(aa in yr){var Ji=yr[aa]|0;return Ui?tn.offset=Ji:tn.instances=Ji,J.command(!Ui||Ji>=0,"invalid "+aa,Ct.commandStr),xa(function(ji,Ya){return Ui&&(ji.OFFSET=Ji),Ji})}else if(aa in wr){var ea=wr[aa];return xo(ea,function(ji,Ya){var Es=ji.invoke(Ya,ea);return Ui&&(ji.OFFSET=Es,J.optional(function(){ji.assert(Ya,Es+">=0","invalid "+aa)})),Es})}else if(Ui){if(Rt)return xa(function(ji,Ya){return ji.OFFSET=0,0});if(Er)return new sa(Rr.thisDep,Rr.contextDep,Rr.propDep,function(ji,Ya){return Ya.def(ji.shared.vao+".currentVAO?"+ji.shared.vao+".currentVAO.offset:0")})}else if(Er)return new sa(Rr.thisDep,Rr.contextDep,Rr.propDep,function(ji,Ya){return Ya.def(ji.shared.vao+".currentVAO?"+ji.shared.vao+".currentVAO.instances:-1")});return null}var zn=qr(Gf,!0);function yi(){if(bf in yr){var aa=yr[bf]|0;return tn.count=aa,J.command(typeof aa=="number"&&aa>=0,"invalid vertex count",Ct.commandStr),xa(function(){return aa})}else if(bf in wr){var Ui=wr[bf];return xo(Ui,function(Ya,Es){var ol=Ya.invoke(Es,Ui);return J.optional(function(){Ya.assert(Es,"typeof "+ol+'==="number"&&'+ol+">=0&&"+ol+"===("+ol+"|0)","invalid vertex count")}),ol})}else if(Rt)if(_o(jt)){if(jt)return zn?new sa(zn.thisDep,zn.contextDep,zn.propDep,function(Ya,Es){var ol=Es.def(Ya.ELEMENTS,".vertCount-",Ya.OFFSET);return J.optional(function(){Ya.assert(Es,ol+">=0","invalid vertex offset/element buffer too small")}),ol}):xa(function(Ya,Es){return Es.def(Ya.ELEMENTS,".vertCount")});var Ji=xa(function(){return-1});return J.optional(function(){Ji.MISSING=!0}),Ji}else{var ea=new sa(jt.thisDep||zn.thisDep,jt.contextDep||zn.contextDep,jt.propDep||zn.propDep,function(Ya,Es){var ol=Ya.ELEMENTS;return Ya.OFFSET?Es.def(ol,"?",ol,".vertCount-",Ya.OFFSET,":-1"):Es.def(ol,"?",ol,".vertCount:-1")});return J.optional(function(){ea.DYNAMIC=!0}),ea}else if(Er){var ji=new sa(Rr.thisDep,Rr.contextDep,Rr.propDep,function(Ya,Es){return Es.def(Ya.shared.vao,".currentVAO?",Ya.shared.vao,".currentVAO.count:-1")});return ji}return null}var gi=Wr(),Bi=yi(),pi=qr(Kf,!1);return{elements:jt,primitive:gi,count:Bi,instances:pi,offset:zn,vao:Rr,vaoActive:Er,elementsActive:Rt,static:tn}}function $s(Dt,Ct){var yr=Dt.static,wr=Dt.dynamic,tn={};return ga.forEach(function(Er){var ar=Ki(Er);function Rr(Rt,pr){if(Er in yr){var jt=Rt(yr[Er]);tn[ar]=xa(function(){return jt})}else if(Er in wr){var Wr=wr[Er];tn[ar]=xo(Wr,function(qr,zn){return pr(qr,zn,qr.invoke(zn,Wr))})}}switch(Er){case wc:case zs:case xs:case Uo:case su:case Pc:case Il:case pc:case dc:case tl:return Rr(function(Rt){return J.commandType(Rt,"boolean",Er,Ct.commandStr),Rt},function(Rt,pr,jt){return J.optional(function(){Rt.assert(pr,"typeof "+jt+'==="boolean"',"invalid flag "+Er,Rt.commandStr)}),jt});case Fs:return Rr(function(Rt){return J.commandParameter(Rt,bi,"invalid "+Er,Ct.commandStr),bi[Rt]},function(Rt,pr,jt){var Wr=Rt.constants.compareFuncs;return J.optional(function(){Rt.assert(pr,jt+" in "+Wr,"invalid "+Er+", must be one of "+Object.keys(bi))}),pr.def(Wr,"[",jt,"]")});case uf:return Rr(function(Rt){return J.command(qo(Rt)&&Rt.length===2&&typeof Rt[0]=="number"&&typeof Rt[1]=="number"&&Rt[0]<=Rt[1],"depth range is 2d array",Ct.commandStr),Rt},function(Rt,pr,jt){J.optional(function(){Rt.assert(pr,Rt.shared.isArrayLike+"("+jt+")&&"+jt+".length===2&&typeof "+jt+'[0]==="number"&&typeof '+jt+'[1]==="number"&&'+jt+"[0]<="+jt+"[1]","depth range must be a 2d array")});var Wr=pr.def("+",jt,"[0]"),qr=pr.def("+",jt,"[1]");return[Wr,qr]});case ou:return Rr(function(Rt){J.commandType(Rt,"object","blend.func",Ct.commandStr);var pr="srcRGB"in Rt?Rt.srcRGB:Rt.src,jt="srcAlpha"in Rt?Rt.srcAlpha:Rt.src,Wr="dstRGB"in Rt?Rt.dstRGB:Rt.dst,qr="dstAlpha"in Rt?Rt.dstAlpha:Rt.dst;return J.commandParameter(pr,Sn,ar+".srcRGB",Ct.commandStr),J.commandParameter(jt,Sn,ar+".srcAlpha",Ct.commandStr),J.commandParameter(Wr,Sn,ar+".dstRGB",Ct.commandStr),J.commandParameter(qr,Sn,ar+".dstAlpha",Ct.commandStr),J.command(Wn.indexOf(pr+", "+Wr)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+pr+", "+Wr+")",Ct.commandStr),[Sn[pr],Sn[Wr],Sn[jt],Sn[qr]]},function(Rt,pr,jt){var Wr=Rt.constants.blendFuncs;J.optional(function(){Rt.assert(pr,jt+"&&typeof "+jt+'==="object"',"invalid blend func, must be an object")});function qr(Ui,Ji){var ea=pr.def('"',Ui,Ji,'" in ',jt,"?",jt,".",Ui,Ji,":",jt,".",Ui);return J.optional(function(){Rt.assert(pr,ea+" in "+Wr,"invalid "+Er+"."+Ui+Ji+", must be one of "+Object.keys(Sn))}),ea}var zn=qr("src","RGB"),yi=qr("dst","RGB");J.optional(function(){var Ui=Rt.constants.invalidBlendCombinations;Rt.assert(pr,Ui+".indexOf("+zn+'+", "+'+yi+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var gi=pr.def(Wr,"[",zn,"]"),Bi=pr.def(Wr,"[",qr("src","Alpha"),"]"),pi=pr.def(Wr,"[",yi,"]"),aa=pr.def(Wr,"[",qr("dst","Alpha"),"]");return[gi,pi,Bi,aa]});case Xc:return Rr(function(Rt){if(typeof Rt=="string")return J.commandParameter(Rt,dn,"invalid "+Er,Ct.commandStr),[dn[Rt],dn[Rt]];if(typeof Rt=="object")return J.commandParameter(Rt.rgb,dn,Er+".rgb",Ct.commandStr),J.commandParameter(Rt.alpha,dn,Er+".alpha",Ct.commandStr),[dn[Rt.rgb],dn[Rt.alpha]];J.commandRaise("invalid blend.equation",Ct.commandStr)},function(Rt,pr,jt){var Wr=Rt.constants.blendEquations,qr=pr.def(),zn=pr.def(),yi=Rt.cond("typeof ",jt,'==="string"');return J.optional(function(){function gi(Bi,pi,aa){Rt.assert(Bi,aa+" in "+Wr,"invalid "+pi+", must be one of "+Object.keys(dn))}gi(yi.then,Er,jt),Rt.assert(yi.else,jt+"&&typeof "+jt+'==="object"',"invalid "+Er),gi(yi.else,Er+".rgb",jt+".rgb"),gi(yi.else,Er+".alpha",jt+".alpha")}),yi.then(qr,"=",zn,"=",Wr,"[",jt,"];"),yi.else(qr,"=",Wr,"[",jt,".rgb];",zn,"=",Wr,"[",jt,".alpha];"),pr(yi),[qr,zn]});case yu:return Rr(function(Rt){return J.command(qo(Rt)&&Rt.length===4,"blend.color must be a 4d array",Ct.commandStr),Ut(4,function(pr){return+Rt[pr]})},function(Rt,pr,jt){return J.optional(function(){Rt.assert(pr,Rt.shared.isArrayLike+"("+jt+")&&"+jt+".length===4","blend.color must be a 4d array")}),Ut(4,function(Wr){return pr.def("+",jt,"[",Wr,"]")})});case rl:return Rr(function(Rt){return J.commandType(Rt,"number",ar,Ct.commandStr),Rt|0},function(Rt,pr,jt){return J.optional(function(){Rt.assert(pr,"typeof "+jt+'==="number"',"invalid stencil.mask")}),pr.def(jt,"|0")});case uu:return Rr(function(Rt){J.commandType(Rt,"object",ar,Ct.commandStr);var pr=Rt.cmp||"keep",jt=Rt.ref||0,Wr="mask"in Rt?Rt.mask:-1;return J.commandParameter(pr,bi,Er+".cmp",Ct.commandStr),J.commandType(jt,"number",Er+".ref",Ct.commandStr),J.commandType(Wr,"number",Er+".mask",Ct.commandStr),[bi[pr],jt,Wr]},function(Rt,pr,jt){var Wr=Rt.constants.compareFuncs;J.optional(function(){function gi(){Rt.assert(pr,Array.prototype.join.call(arguments,""),"invalid stencil.func")}gi(jt+"&&typeof ",jt,'==="object"'),gi('!("cmp" in ',jt,")||(",jt,".cmp in ",Wr,")")});var qr=pr.def('"cmp" in ',jt,"?",Wr,"[",jt,".cmp]",":",ct),zn=pr.def(jt,".ref|0"),yi=pr.def('"mask" in ',jt,"?",jt,".mask|0:-1");return[qr,zn,yi]});case vc:case jf:return Rr(function(Rt){J.commandType(Rt,"object",ar,Ct.commandStr);var pr=Rt.fail||"keep",jt=Rt.zfail||"keep",Wr=Rt.zpass||"keep";return J.commandParameter(pr,pa,Er+".fail",Ct.commandStr),J.commandParameter(jt,pa,Er+".zfail",Ct.commandStr),J.commandParameter(Wr,pa,Er+".zpass",Ct.commandStr),[Er===jf?m:R,pa[pr],pa[jt],pa[Wr]]},function(Rt,pr,jt){var Wr=Rt.constants.stencilOps;J.optional(function(){Rt.assert(pr,jt+"&&typeof "+jt+'==="object"',"invalid "+Er)});function qr(zn){return J.optional(function(){Rt.assert(pr,'!("'+zn+'" in '+jt+")||("+jt+"."+zn+" in "+Wr+")","invalid "+Er+"."+zn+", must be one of "+Object.keys(pa))}),pr.def('"',zn,'" in ',jt,"?",Wr,"[",jt,".",zn,"]:",ct)}return[Er===jf?m:R,qr("fail"),qr("zfail"),qr("zpass")]});case Bs:return Rr(function(Rt){J.commandType(Rt,"object",ar,Ct.commandStr);var pr=Rt.factor|0,jt=Rt.units|0;return J.commandType(pr,"number",ar+".factor",Ct.commandStr),J.commandType(jt,"number",ar+".units",Ct.commandStr),[pr,jt]},function(Rt,pr,jt){J.optional(function(){Rt.assert(pr,jt+"&&typeof "+jt+'==="object"',"invalid "+Er)});var Wr=pr.def(jt,".factor|0"),qr=pr.def(jt,".units|0");return[Wr,qr]});case Mc:return Rr(function(Rt){var pr=0;return Rt==="front"?pr=R:Rt==="back"&&(pr=m),J.command(!!pr,ar,Ct.commandStr),pr},function(Rt,pr,jt){return J.optional(function(){Rt.assert(pr,jt+'==="front"||'+jt+'==="back"',"invalid cull.face")}),pr.def(jt,'==="front"?',R,":",m)});case Yc:return Rr(function(Rt){return J.command(typeof Rt=="number"&&Rt>=an.lineWidthDims[0]&&Rt<=an.lineWidthDims[1],"invalid line width, must be a positive number between "+an.lineWidthDims[0]+" and "+an.lineWidthDims[1],Ct.commandStr),Rt},function(Rt,pr,jt){return J.optional(function(){Rt.assert(pr,"typeof "+jt+'==="number"&&'+jt+">="+an.lineWidthDims[0]+"&&"+jt+"<="+an.lineWidthDims[1],"invalid line width")}),jt});case Us:return Rr(function(Rt){return J.commandParameter(Rt,Qa,ar,Ct.commandStr),Qa[Rt]},function(Rt,pr,jt){return J.optional(function(){Rt.assert(pr,jt+'==="cw"||'+jt+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),pr.def(jt+'==="cw"?'+u+":"+_)});case Ol:return Rr(function(Rt){return J.command(qo(Rt)&&Rt.length===4,"color.mask must be length 4 array",Ct.commandStr),Rt.map(function(pr){return!!pr})},function(Rt,pr,jt){return J.optional(function(){Rt.assert(pr,Rt.shared.isArrayLike+"("+jt+")&&"+jt+".length===4","invalid color.mask")}),Ut(4,function(Wr){return"!!"+jt+"["+Wr+"]"})});case ql:return Rr(function(Rt){J.command(typeof Rt=="object"&&Rt,ar,Ct.commandStr);var pr="value"in Rt?Rt.value:1,jt=!!Rt.invert;return J.command(typeof pr=="number"&&pr>=0&&pr<=1,"sample.coverage.value must be a number between 0 and 1",Ct.commandStr),[pr,jt]},function(Rt,pr,jt){J.optional(function(){Rt.assert(pr,jt+"&&typeof "+jt+'==="object"',"invalid sample.coverage")});var Wr=pr.def('"value" in ',jt,"?+",jt,".value:1"),qr=pr.def("!!",jt,".invert");return[Wr,qr]})}}),tn}function Lo(Dt,Ct){var yr=Dt.static,wr=Dt.dynamic,tn={};return Object.keys(yr).forEach(function(Er){var ar=yr[Er],Rr;if(typeof ar=="number"||typeof ar=="boolean")Rr=xa(function(){return ar});else if(typeof ar=="function"){var Rt=ar._reglType;Rt==="texture2d"||Rt==="textureCube"?Rr=xa(function(pr){return pr.link(ar)}):Rt==="framebuffer"||Rt==="framebufferCube"?(J.command(ar.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Er+'"',Ct.commandStr),Rr=xa(function(pr){return pr.link(ar.color[0])})):J.commandRaise('invalid data for uniform "'+Er+'"',Ct.commandStr)}else qo(ar)?Rr=xa(function(pr){var jt=pr.global.def("[",Ut(ar.length,function(Wr){return J.command(typeof ar[Wr]=="number"||typeof ar[Wr]=="boolean","invalid uniform "+Er,pr.commandStr),ar[Wr]}),"]");return jt}):J.commandRaise('invalid or missing data for uniform "'+Er+'"',Ct.commandStr);Rr.value=ar,tn[Er]=Rr}),Object.keys(wr).forEach(function(Er){var ar=wr[Er];tn[Er]=xo(ar,function(Rr,Rt){return Rr.invoke(Rt,ar)})}),tn}function ml(Dt,Ct){var yr=Dt.static,wr=Dt.dynamic,tn={};return Object.keys(yr).forEach(function(Er){var ar=yr[Er],Rr=Lt.id(Er),Rt=new Vr;if(ro(ar))Rt.state=Ea,Rt.buffer=Pn.getBuffer(Pn.create(ar,Vf,!1,!0)),Rt.type=0;else{var pr=Pn.getBuffer(ar);if(pr)Rt.state=Ea,Rt.buffer=pr,Rt.type=0;else if(J.command(typeof ar=="object"&&ar,"invalid data for attribute "+Er,Ct.commandStr),"constant"in ar){var jt=ar.constant;Rt.buffer="null",Rt.state=oo,typeof jt=="number"?Rt.x=jt:(J.command(qo(jt)&&jt.length>0&&jt.length<=4,"invalid constant for attribute "+Er,Ct.commandStr),Ma.forEach(function(pi,aa){aa<jt.length&&(Rt[pi]=jt[aa])}))}else{ro(ar.buffer)?pr=Pn.getBuffer(Pn.create(ar.buffer,Vf,!1,!0)):pr=Pn.getBuffer(ar.buffer),J.command(!!pr,'missing buffer for attribute "'+Er+'"',Ct.commandStr);var Wr=ar.offset|0;J.command(Wr>=0,'invalid offset for attribute "'+Er+'"',Ct.commandStr);var qr=ar.stride|0;J.command(qr>=0&&qr<256,'invalid stride for attribute "'+Er+'", must be integer betweeen [0, 255]',Ct.commandStr);var zn=ar.size|0;J.command(!("size"in ar)||zn>0&&zn<=4,'invalid size for attribute "'+Er+'", must be 1,2,3,4',Ct.commandStr);var yi=!!ar.normalized,gi=0;"type"in ar&&(J.commandParameter(ar.type,Oa,"invalid type for attribute "+Er,Ct.commandStr),gi=Oa[ar.type]);var Bi=ar.divisor|0;J.optional(function(){"divisor"in ar&&(J.command(Bi===0||ri,'cannot specify divisor for attribute "'+Er+'", instancing not supported',Ct.commandStr),J.command(Bi>=0,'invalid divisor for attribute "'+Er+'"',Ct.commandStr));var pi=Ct.commandStr,aa=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ar).forEach(function(Ui){J.command(aa.indexOf(Ui)>=0,'unknown parameter "'+Ui+'" for attribute pointer "'+Er+'" (valid parameters are '+aa+")",pi)})}),Rt.buffer=pr,Rt.state=Ea,Rt.size=zn,Rt.normalized=yi,Rt.type=gi||pr.dtype,Rt.offset=Wr,Rt.stride=qr,Rt.divisor=Bi}}tn[Er]=xa(function(pi,aa){var Ui=pi.attribCache;if(Rr in Ui)return Ui[Rr];var Ji={isStream:!1};return Object.keys(Rt).forEach(function(ea){Ji[ea]=Rt[ea]}),Rt.buffer&&(Ji.buffer=pi.link(Rt.buffer),Ji.type=Ji.type||Ji.buffer+".dtype"),Ui[Rr]=Ji,Ji})}),Object.keys(wr).forEach(function(Er){var ar=wr[Er];function Rr(Rt,pr){var jt=Rt.invoke(pr,ar),Wr=Rt.shared,qr=Rt.constants,zn=Wr.isBufferArgs,yi=Wr.buffer;J.optional(function(){Rt.assert(pr,jt+"&&(typeof "+jt+'==="object"||typeof '+jt+'==="function")&&('+zn+"("+jt+")||"+yi+".getBuffer("+jt+")||"+yi+".getBuffer("+jt+".buffer)||"+zn+"("+jt+'.buffer)||("constant" in '+jt+"&&(typeof "+jt+'.constant==="number"||'+Wr.isArrayLike+"("+jt+".constant))))",'invalid dynamic attribute "'+Er+'"')});var gi={isStream:pr.def(!1)},Bi=new Vr;Bi.state=Ea,Object.keys(Bi).forEach(function(Ji){gi[Ji]=pr.def(""+Bi[Ji])});var pi=gi.buffer,aa=gi.type;pr("if(",zn,"(",jt,")){",gi.isStream,"=true;",pi,"=",yi,".createStream(",Vf,",",jt,");",aa,"=",pi,".dtype;","}else{",pi,"=",yi,".getBuffer(",jt,");","if(",pi,"){",aa,"=",pi,".dtype;",'}else if("constant" in ',jt,"){",gi.state,"=",oo,";","if(typeof "+jt+'.constant === "number"){',gi[Ma[0]],"=",jt,".constant;",Ma.slice(1).map(function(Ji){return gi[Ji]}).join("="),"=0;","}else{",Ma.map(function(Ji,ea){return gi[Ji]+"="+jt+".constant.length>"+ea+"?"+jt+".constant["+ea+"]:0;"}).join(""),"}}else{","if(",zn,"(",jt,".buffer)){",pi,"=",yi,".createStream(",Vf,",",jt,".buffer);","}else{",pi,"=",yi,".getBuffer(",jt,".buffer);","}",aa,'="type" in ',jt,"?",qr.glTypes,"[",jt,".type]:",pi,".dtype;",gi.normalized,"=!!",jt,".normalized;");function Ui(Ji){pr(gi[Ji],"=",jt,".",Ji,"|0;")}return Ui("size"),Ui("offset"),Ui("stride"),Ui("divisor"),pr("}}"),pr.exit("if(",gi.isStream,"){",yi,".destroyStream(",pi,");","}"),gi}tn[Er]=xo(ar,Rr)}),tn}function bs(Dt){var Ct=Dt.static,yr=Dt.dynamic,wr={};return Object.keys(Ct).forEach(function(tn){var Er=Ct[tn];wr[tn]=xa(function(ar,Rr){return typeof Er=="number"||typeof Er=="boolean"?""+Er:ar.link(Er)})}),Object.keys(yr).forEach(function(tn){var Er=yr[tn];wr[tn]=xo(Er,function(ar,Rr){return ar.invoke(Rr,Er)})}),wr}function nl(Dt,Ct,yr,wr,tn){var Er=Dt.static,ar=Dt.dynamic;J.optional(function(){var Ui=[ku,Lc,lf,Oc,hu,Gf,bf,Kf,Du,Ef].concat(ga);function Ji(ea){Object.keys(ea).forEach(function(ji){J.command(Ui.indexOf(ji)>=0,'unknown parameter "'+ji+'"',tn.commandStr)})}Ji(Er),Ji(ar)});var Rr=lo(Dt,Ct),Rt=Di(Dt,tn),pr=Xa(Dt,Rt,tn),jt=nu(Dt,tn),Wr=$s(Dt,tn),qr=bo(Dt,tn,Rr);function zn(Ui){var Ji=pr[Ui];Ji&&(Wr[Ui]=Ji)}zn(Rl),zn(Ki(Lf));var yi=Object.keys(Wr).length>0,gi={framebuffer:Rt,draw:jt,shader:qr,state:Wr,dirty:yi,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(gi.profile=Ii(Dt,tn),gi.uniforms=Lo(yr,tn),gi.drawVAO=gi.scopeVAO=jt.vao,!gi.drawVAO&&qr.program&&!Rr&&sr.angle_instanced_arrays&&jt.static.elements){var Bi=!0,pi=qr.program.attributes.map(function(Ui){var Ji=Ct.static[Ui];return Bi=Bi&&!!Ji,Ji});if(Bi&&pi.length>0){var aa=Kn.getVAO(Kn.createVAO({attributes:pi,elements:jt.static.elements}));gi.drawVAO=new sa(null,null,null,function(Ui,Ji){return Ui.link(aa)}),gi.useVAO=!0}}return Rr?gi.useVAO=!0:gi.attributes=ml(Ct,tn),gi.context=bs(wr,tn),gi}function Mu(Dt,Ct,yr){var wr=Dt.shared,tn=wr.context,Er=Dt.scope();Object.keys(yr).forEach(function(ar){Ct.save(tn,"."+ar);var Rr=yr[ar],Rt=Rr.append(Dt,Ct);Array.isArray(Rt)?Er(tn,".",ar,"=[",Rt.join(),"];"):Er(tn,".",ar,"=",Rt,";")}),Ct(Er)}function il(Dt,Ct,yr,wr){var tn=Dt.shared,Er=tn.gl,ar=tn.framebuffer,Rr;xi&&(Rr=Ct.def(tn.extensions,".webgl_draw_buffers"));var Rt=Dt.constants,pr=Rt.drawBuffer,jt=Rt.backBuffer,Wr;yr?Wr=yr.append(Dt,Ct):Wr=Ct.def(ar,".next"),wr||Ct("if(",Wr,"!==",ar,".cur){"),Ct("if(",Wr,"){",Er,".bindFramebuffer(",xn,",",Wr,".framebuffer);"),xi&&Ct(Rr,".drawBuffersWEBGL(",pr,"[",Wr,".colorAttachments.length]);"),Ct("}else{",Er,".bindFramebuffer(",xn,",null);"),xi&&Ct(Rr,".drawBuffersWEBGL(",jt,");"),Ct("}",ar,".cur=",Wr,";"),wr||Ct("}")}function al(Dt,Ct,yr){var wr=Dt.shared,tn=wr.gl,Er=Dt.current,ar=Dt.next,Rr=wr.current,Rt=wr.next,pr=Dt.cond(Rr,".dirty");ga.forEach(function(jt){var Wr=Ki(jt);if(!(Wr in yr.state)){var qr,zn;if(Wr in ar){qr=ar[Wr],zn=Er[Wr];var yi=Ut(fi[Wr].length,function(Bi){return pr.def(qr,"[",Bi,"]")});pr(Dt.cond(yi.map(function(Bi,pi){return Bi+"!=="+zn+"["+pi+"]"}).join("||")).then(tn,".",Mn[Wr],"(",yi,");",yi.map(function(Bi,pi){return zn+"["+pi+"]="+Bi}).join(";"),";"))}else{qr=pr.def(Rt,".",Wr);var gi=Dt.cond(qr,"!==",Rr,".",Wr);pr(gi),Wr in Cn?gi(Dt.cond(qr).then(tn,".enable(",Cn[Wr],");").else(tn,".disable(",Cn[Wr],");"),Rr,".",Wr,"=",qr,";"):gi(tn,".",Mn[Wr],"(",qr,");",Rr,".",Wr,"=",qr,";")}}}),Object.keys(yr.state).length===0&&pr(Rr,".dirty=false;"),Ct(pr)}function kl(Dt,Ct,yr,wr){var tn=Dt.shared,Er=Dt.current,ar=tn.current,Rr=tn.gl;Ko(Object.keys(yr)).forEach(function(Rt){var pr=yr[Rt];if(!(wr&&!wr(pr))){var jt=pr.append(Dt,Ct);if(Cn[Rt]){var Wr=Cn[Rt];_o(pr)?jt?Ct(Rr,".enable(",Wr,");"):Ct(Rr,".disable(",Wr,");"):Ct(Dt.cond(jt).then(Rr,".enable(",Wr,");").else(Rr,".disable(",Wr,");")),Ct(ar,".",Rt,"=",jt,";")}else if(qo(jt)){var qr=Er[Rt];Ct(Rr,".",Mn[Rt],"(",jt,");",jt.map(function(zn,yi){return qr+"["+yi+"]="+zn}).join(";"),";")}else Ct(Rr,".",Mn[Rt],"(",jt,");",ar,".",Rt,"=",jt,";")}})}function _u(Dt,Ct){ri&&(Dt.instancing=Ct.def(Dt.shared.extensions,".angle_instanced_arrays"))}function ho(Dt,Ct,yr,wr,tn){var Er=Dt.shared,ar=Dt.stats,Rr=Er.current,Rt=Er.timer,pr=yr.profile;function jt(){var Ui=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Ui||typeof performance=="undefined"?"Date.now()":"performance.now()"}var Wr,qr;function zn(Ui){Wr=Ct.def(),Ui(Wr,"=",jt(),";"),typeof tn=="string"?Ui(ar,".count+=",tn,";"):Ui(ar,".count++;"),Xn&&(wr?(qr=Ct.def(),Ui(qr,"=",Rt,".getNumPendingQueries();")):Ui(Rt,".beginQuery(",ar,");"))}function yi(Ui){Ui(ar,".cpuTime+=",jt(),"-",Wr,";"),Xn&&(wr?Ui(Rt,".pushScopeStats(",qr,",",Rt,".getNumPendingQueries(),",ar,");"):Ui(Rt,".endQuery();"))}function gi(Ui){var Ji=Ct.def(Rr,".profile");Ct(Rr,".profile=",Ui,";"),Ct.exit(Rr,".profile=",Ji,";")}var Bi;if(pr){if(_o(pr)){pr.enable?(zn(Ct),yi(Ct.exit),gi("true")):gi("false");return}Bi=pr.append(Dt,Ct),gi(Bi)}else Bi=Ct.def(Rr,".profile");var pi=Dt.block();zn(pi),Ct("if(",Bi,"){",pi,"}");var aa=Dt.block();yi(aa),Ct.exit("if(",Bi,"){",aa,"}")}function Bu(Dt,Ct,yr,wr,tn){var Er=Dt.shared;function ar(Rt){switch(Rt){case qc:case ve:case We:return 2;case Qc:case $:case er:return 3;case Ic:case ee:case hr:return 4;default:return 1}}function Rr(Rt,pr,jt){var Wr=Er.gl,qr=Ct.def(Rt,".location"),zn=Ct.def(Er.attributes,"[",qr,"]"),yi=jt.state,gi=jt.buffer,Bi=[jt.x,jt.y,jt.z,jt.w],pi=["buffer","normalized","offset","stride"];function aa(){Ct("if(!",zn,".buffer){",Wr,".enableVertexAttribArray(",qr,");}");var Ji=jt.type,ea;if(jt.size?ea=Ct.def(jt.size,"||",pr):ea=pr,Ct("if(",zn,".type!==",Ji,"||",zn,".size!==",ea,"||",pi.map(function(Ya){return zn+"."+Ya+"!=="+jt[Ya]}).join("||"),"){",Wr,".bindBuffer(",Vf,",",gi,".buffer);",Wr,".vertexAttribPointer(",[qr,ea,Ji,jt.normalized,jt.stride,jt.offset],");",zn,".type=",Ji,";",zn,".size=",ea,";",pi.map(function(Ya){return zn+"."+Ya+"="+jt[Ya]+";"}).join(""),"}"),ri){var ji=jt.divisor;Ct("if(",zn,".divisor!==",ji,"){",Dt.instancing,".vertexAttribDivisorANGLE(",[qr,ji],");",zn,".divisor=",ji,";}")}}function Ui(){Ct("if(",zn,".buffer){",Wr,".disableVertexAttribArray(",qr,");",zn,".buffer=null;","}if(",Ma.map(function(Ji,ea){return zn+"."+Ji+"!=="+Bi[ea]}).join("||"),"){",Wr,".vertexAttrib4f(",qr,",",Bi,");",Ma.map(function(Ji,ea){return zn+"."+Ji+"="+Bi[ea]+";"}).join(""),"}")}yi===Ea?aa():yi===oo?Ui():(Ct("if(",yi,"===",Ea,"){"),aa(),Ct("}else{"),Ui(),Ct("}"))}wr.forEach(function(Rt){var pr=Rt.name,jt=yr.attributes[pr],Wr;if(jt){if(!tn(jt))return;Wr=jt.append(Dt,Ct)}else{if(!tn(ds))return;var qr=Dt.scopeAttrib(pr);J.optional(function(){Dt.assert(Ct,qr+".state","missing attribute "+pr)}),Wr={},Object.keys(new Vr).forEach(function(zn){Wr[zn]=Ct.def(qr,".",zn)})}Rr(Dt.link(Rt),ar(Rt.info.type),Wr)})}function is(Dt,Ct,yr,wr,tn,Er){for(var ar=Dt.shared,Rr=ar.gl,Rt,pr=0;pr<wr.length;++pr){var jt=wr[pr],Wr=jt.name,qr=jt.info.type,zn=yr.uniforms[Wr],yi=Dt.link(jt),gi=yi+".location",Bi;if(zn){if(!tn(zn))continue;if(_o(zn)){var pi=zn.value;if(J.command(pi!==null&&typeof pi!="undefined",'missing uniform "'+Wr+'"',Dt.commandStr),qr===Ai||qr===Hi){J.command(typeof pi=="function"&&(qr===Ai&&(pi._reglType==="texture2d"||pi._reglType==="framebuffer")||qr===Hi&&(pi._reglType==="textureCube"||pi._reglType==="framebufferCube")),"invalid texture for uniform "+Wr,Dt.commandStr);var aa=Dt.link(pi._texture||pi.color[0]._texture);Ct(Rr,".uniform1i(",gi,",",aa+".bind());"),Ct.exit(aa,".unbind();")}else if(qr===Kt||qr===kr||qr===wn){J.optional(function(){J.command(qo(pi),"invalid matrix for uniform "+Wr,Dt.commandStr),J.command(qr===Kt&&pi.length===4||qr===kr&&pi.length===9||qr===wn&&pi.length===16,"invalid length for matrix uniform "+Wr,Dt.commandStr)});var Ui=Dt.global.def("new Float32Array(["+Array.prototype.slice.call(pi)+"])"),Ji=2;qr===kr?Ji=3:qr===wn&&(Ji=4),Ct(Rr,".uniformMatrix",Ji,"fv(",gi,",false,",Ui,");")}else{switch(qr){case kf:J.commandType(pi,"number","uniform "+Wr,Dt.commandStr),Rt="1f";break;case qc:J.command(qo(pi)&&pi.length===2,"uniform "+Wr,Dt.commandStr),Rt="2f";break;case Qc:J.command(qo(pi)&&pi.length===3,"uniform "+Wr,Dt.commandStr),Rt="3f";break;case Ic:J.command(qo(pi)&&pi.length===4,"uniform "+Wr,Dt.commandStr),Rt="4f";break;case Ee:J.commandType(pi,"boolean","uniform "+Wr,Dt.commandStr),Rt="1i";break;case C:J.commandType(pi,"number","uniform "+Wr,Dt.commandStr),Rt="1i";break;case We:J.command(qo(pi)&&pi.length===2,"uniform "+Wr,Dt.commandStr),Rt="2i";break;case ve:J.command(qo(pi)&&pi.length===2,"uniform "+Wr,Dt.commandStr),Rt="2i";break;case er:J.command(qo(pi)&&pi.length===3,"uniform "+Wr,Dt.commandStr),Rt="3i";break;case $:J.command(qo(pi)&&pi.length===3,"uniform "+Wr,Dt.commandStr),Rt="3i";break;case hr:J.command(qo(pi)&&pi.length===4,"uniform "+Wr,Dt.commandStr),Rt="4i";break;case ee:J.command(qo(pi)&&pi.length===4,"uniform "+Wr,Dt.commandStr),Rt="4i";break}Ct(Rr,".uniform",Rt,"(",gi,",",qo(pi)?Array.prototype.slice.call(pi):pi,");")}continue}else Bi=zn.append(Dt,Ct)}else{if(!tn(ds))continue;Bi=Ct.def(ar.uniforms,"[",Lt.id(Wr),"]")}qr===Ai?(J(!Array.isArray(Bi),"must specify a scalar prop for textures"),Ct("if(",Bi,"&&",Bi,'._reglType==="framebuffer"){',Bi,"=",Bi,".color[0];","}")):qr===Hi&&(J(!Array.isArray(Bi),"must specify a scalar prop for cube maps"),Ct("if(",Bi,"&&",Bi,'._reglType==="framebufferCube"){',Bi,"=",Bi,".color[0];","}")),J.optional(function(){function yc(ff,Ch){Dt.assert(Ct,ff,'bad data or missing for uniform "'+Wr+'".  '+Ch)}function Ff(ff){J(!Array.isArray(Bi),"must not specify an array type for uniform"),yc("typeof "+Bi+'==="'+ff+'"',"invalid type, expected "+ff)}function cf(ff,Ch){Array.isArray(Bi)?J(Bi.length===ff,"must have length "+ff):yc(ar.isArrayLike+"("+Bi+")&&"+Bi+".length==="+ff,"invalid vector, should have length "+ff,Dt.commandStr)}function yp(ff){J(!Array.isArray(Bi),"must not specify a value type"),yc("typeof "+Bi+'==="function"&&'+Bi+'._reglType==="texture'+(ff===Gh?"2d":"Cube")+'"',"invalid texture type",Dt.commandStr)}switch(qr){case C:Ff("number");break;case ve:cf(2,"number");break;case $:cf(3,"number");break;case ee:cf(4,"number");break;case kf:Ff("number");break;case qc:cf(2,"number");break;case Qc:cf(3,"number");break;case Ic:cf(4,"number");break;case Ee:Ff("boolean");break;case We:cf(2,"boolean");break;case er:cf(3,"boolean");break;case hr:cf(4,"boolean");break;case Kt:cf(4,"number");break;case kr:cf(9,"number");break;case wn:cf(16,"number");break;case Ai:yp(Gh);break;case Hi:yp(Ph);break}});var ea=1;switch(qr){case Ai:case Hi:var ji=Ct.def(Bi,"._texture");Ct(Rr,".uniform1i(",gi,",",ji,".bind());"),Ct.exit(ji,".unbind();");continue;case C:case Ee:Rt="1i";break;case ve:case We:Rt="2i",ea=2;break;case $:case er:Rt="3i",ea=3;break;case ee:case hr:Rt="4i",ea=4;break;case kf:Rt="1f";break;case qc:Rt="2f",ea=2;break;case Qc:Rt="3f",ea=3;break;case Ic:Rt="4f",ea=4;break;case Kt:Rt="Matrix2fv";break;case kr:Rt="Matrix3fv";break;case wn:Rt="Matrix4fv";break}if(Rt.charAt(0)==="M"){Ct(Rr,".uniform",Rt,"(",gi,",");var Ya=Math.pow(qr-Kt+2,2),Es=Dt.global.def("new Float32Array(",Ya,")");Array.isArray(Bi)?Ct("false,(",Ut(Ya,function(yc){return Es+"["+yc+"]="+Bi[yc]}),",",Es,")"):Ct("false,(Array.isArray(",Bi,")||",Bi," instanceof Float32Array)?",Bi,":(",Ut(Ya,function(yc){return Es+"["+yc+"]="+Bi+"["+yc+"]"}),",",Es,")"),Ct(");")}else if(ea>1){for(var ol=[],os=[],us=0;us<ea;++us)Array.isArray(Bi)?os.push(Bi[us]):os.push(Ct.def(Bi+"["+us+"]")),Er&&ol.push(Ct.def());Er&&Ct("if(!",Dt.batchId,"||",ol.map(function(yc,Ff){return yc+"!=="+os[Ff]}).join("||"),"){",ol.map(function(yc,Ff){return yc+"="+os[Ff]+";"}).join("")),Ct(Rr,".uniform",Rt,"(",gi,",",os.join(","),");"),Er&&Ct("}")}else{if(J(!Array.isArray(Bi),"uniform value must not be an array"),Er){var Sf=Ct.def();Ct("if(!",Dt.batchId,"||",Sf,"!==",Bi,"){",Sf,"=",Bi,";")}Ct(Rr,".uniform",Rt,"(",gi,",",Bi,");"),Er&&Ct("}")}}}function Nu(Dt,Ct,yr,wr){var tn=Dt.shared,Er=tn.gl,ar=tn.draw,Rr=wr.draw;function Rt(){var ea=Rr.elements,ji,Ya=Ct;return ea?((ea.contextDep&&wr.contextDynamic||ea.propDep)&&(Ya=yr),ji=ea.append(Dt,Ya),Rr.elementsActive&&Ya("if("+ji+")"+Er+".bindBuffer("+bh+","+ji+".buffer.buffer);")):(ji=Ya.def(),Ya(ji,"=",ar,".",Oc,";","if(",ji,"){",Er,".bindBuffer(",bh,",",ji,".buffer.buffer);}","else if(",tn.vao,".currentVAO){",ji,"=",Dt.shared.elements+".getElements("+tn.vao,".currentVAO.elements);",Nn?"":"if("+ji+")"+Er+".bindBuffer("+bh+","+ji+".buffer.buffer);","}")),ji}function pr(){var ea=Rr.count,ji,Ya=Ct;return ea?((ea.contextDep&&wr.contextDynamic||ea.propDep)&&(Ya=yr),ji=ea.append(Dt,Ya),J.optional(function(){ea.MISSING&&Dt.assert(Ct,"false","missing vertex count"),ea.DYNAMIC&&Dt.assert(Ya,ji+">=0","missing vertex count")})):(ji=Ya.def(ar,".",bf),J.optional(function(){Dt.assert(Ya,ji+">=0","missing vertex count")})),ji}var jt=Rt();function Wr(ea){var ji=Rr[ea];return ji?ji.contextDep&&wr.contextDynamic||ji.propDep?ji.append(Dt,yr):ji.append(Dt,Ct):Ct.def(ar,".",ea)}var qr=Wr(hu),zn=Wr(Gf),yi=pr();if(typeof yi=="number"){if(yi===0)return}else yr("if(",yi,"){"),yr.exit("}");var gi,Bi;ri&&(gi=Wr(Kf),Bi=Dt.instancing);var pi=jt+".type",aa=Rr.elements&&_o(Rr.elements)&&!Rr.vaoActive;function Ui(){function ea(){yr(Bi,".drawElementsInstancedANGLE(",[qr,yi,pi,zn+"<<(("+pi+"-"+Ba+")>>1)",gi],");")}function ji(){yr(Bi,".drawArraysInstancedANGLE(",[qr,zn,yi,gi],");")}jt&&jt!=="null"?aa?ea():(yr("if(",jt,"){"),ea(),yr("}else{"),ji(),yr("}")):ji()}function Ji(){function ea(){yr(Er+".drawElements("+[qr,yi,pi,zn+"<<(("+pi+"-"+Ba+")>>1)"]+");")}function ji(){yr(Er+".drawArrays("+[qr,zn,yi]+");")}jt&&jt!=="null"?aa?ea():(yr("if(",jt,"){"),ea(),yr("}else{"),ji(),yr("}")):ji()}ri&&(typeof gi!="number"||gi>=0)?typeof gi=="string"?(yr("if(",gi,">0){"),Ui(),yr("}else if(",gi,"<0){"),Ji(),yr("}")):Ui():Ji()}function Za(Dt,Ct,yr,wr,tn){var Er=io(),ar=Er.proc("body",tn);return J.optional(function(){Er.commandStr=Ct.commandStr,Er.command=Er.link(Ct.commandStr)}),ri&&(Er.instancing=ar.def(Er.shared.extensions,".angle_instanced_arrays")),Dt(Er,ar,yr,wr),Er.compile().body}function Zo(Dt,Ct,yr,wr){_u(Dt,Ct),yr.useVAO?yr.drawVAO?Ct(Dt.shared.vao,".setVAO(",yr.drawVAO.append(Dt,Ct),");"):Ct(Dt.shared.vao,".setVAO(",Dt.shared.vao,".targetVAO);"):(Ct(Dt.shared.vao,".setVAO(null);"),Bu(Dt,Ct,yr,wr.attributes,function(){return!0})),is(Dt,Ct,yr,wr.uniforms,function(){return!0},!1),Nu(Dt,Ct,Ct,yr)}function as(Dt,Ct){var yr=Dt.proc("draw",1);_u(Dt,yr),Mu(Dt,yr,Ct.context),il(Dt,yr,Ct.framebuffer),al(Dt,yr,Ct),kl(Dt,yr,Ct.state),ho(Dt,yr,Ct,!1,!0);var wr=Ct.shader.progVar.append(Dt,yr);if(yr(Dt.shared.gl,".useProgram(",wr,".program);"),Ct.shader.program)Zo(Dt,yr,Ct,Ct.shader.program);else{yr(Dt.shared.vao,".setVAO(null);");var tn=Dt.global.def("{}"),Er=yr.def(wr,".id"),ar=yr.def(tn,"[",Er,"]");yr(Dt.cond(ar).then(ar,".call(this,a0);").else(ar,"=",tn,"[",Er,"]=",Dt.link(function(Rr){return Za(Zo,Dt,Ct,Rr,1)}),"(",wr,");",ar,".call(this,a0);"))}Object.keys(Ct.state).length>0&&yr(Dt.shared.current,".dirty=true;"),Dt.shared.vao&&yr(Dt.shared.vao,".setVAO(null);")}function Os(Dt,Ct,yr,wr){Dt.batchId="a1",_u(Dt,Ct);function tn(){return!0}Bu(Dt,Ct,yr,wr.attributes,tn),is(Dt,Ct,yr,wr.uniforms,tn,!1),Nu(Dt,Ct,Ct,yr)}function Ks(Dt,Ct,yr,wr){_u(Dt,Ct);var tn=yr.contextDep,Er=Ct.def(),ar="a0",Rr="a1",Rt=Ct.def();Dt.shared.props=Rt,Dt.batchId=Er;var pr=Dt.scope(),jt=Dt.scope();Ct(pr.entry,"for(",Er,"=0;",Er,"<",Rr,";++",Er,"){",Rt,"=",ar,"[",Er,"];",jt,"}",pr.exit);function Wr(pi){return pi.contextDep&&tn||pi.propDep}function qr(pi){return!Wr(pi)}if(yr.needsContext&&Mu(Dt,jt,yr.context),yr.needsFramebuffer&&il(Dt,jt,yr.framebuffer),kl(Dt,jt,yr.state,Wr),yr.profile&&Wr(yr.profile)&&ho(Dt,jt,yr,!1,!0),wr)yr.useVAO?yr.drawVAO?Wr(yr.drawVAO)?jt(Dt.shared.vao,".setVAO(",yr.drawVAO.append(Dt,jt),");"):pr(Dt.shared.vao,".setVAO(",yr.drawVAO.append(Dt,pr),");"):pr(Dt.shared.vao,".setVAO(",Dt.shared.vao,".targetVAO);"):(pr(Dt.shared.vao,".setVAO(null);"),Bu(Dt,pr,yr,wr.attributes,qr),Bu(Dt,jt,yr,wr.attributes,Wr)),is(Dt,pr,yr,wr.uniforms,qr,!1),is(Dt,jt,yr,wr.uniforms,Wr,!0),Nu(Dt,pr,jt,yr);else{var zn=Dt.global.def("{}"),yi=yr.shader.progVar.append(Dt,jt),gi=jt.def(yi,".id"),Bi=jt.def(zn,"[",gi,"]");jt(Dt.shared.gl,".useProgram(",yi,".program);","if(!",Bi,"){",Bi,"=",zn,"[",gi,"]=",Dt.link(function(pi){return Za(Os,Dt,yr,pi,2)}),"(",yi,");}",Bi,".call(this,a0[",Er,"],",Er,");")}}function $t(Dt,Ct){var yr=Dt.proc("batch",2);Dt.batchId="0",_u(Dt,yr);var wr=!1,tn=!0;Object.keys(Ct.context).forEach(function(zn){wr=wr||Ct.context[zn].propDep}),wr||(Mu(Dt,yr,Ct.context),tn=!1);var Er=Ct.framebuffer,ar=!1;Er?(Er.propDep?wr=ar=!0:Er.contextDep&&wr&&(ar=!0),ar||il(Dt,yr,Er)):il(Dt,yr,null),Ct.state.viewport&&Ct.state.viewport.propDep&&(wr=!0);function Rr(zn){return zn.contextDep&&wr||zn.propDep}al(Dt,yr,Ct),kl(Dt,yr,Ct.state,function(zn){return!Rr(zn)}),(!Ct.profile||!Rr(Ct.profile))&&ho(Dt,yr,Ct,!1,"a1"),Ct.contextDep=wr,Ct.needsContext=tn,Ct.needsFramebuffer=ar;var Rt=Ct.shader.progVar;if(Rt.contextDep&&wr||Rt.propDep)Ks(Dt,yr,Ct,null);else{var pr=Rt.append(Dt,yr);if(yr(Dt.shared.gl,".useProgram(",pr,".program);"),Ct.shader.program)Ks(Dt,yr,Ct,Ct.shader.program);else{yr(Dt.shared.vao,".setVAO(null);");var jt=Dt.global.def("{}"),Wr=yr.def(pr,".id"),qr=yr.def(jt,"[",Wr,"]");yr(Dt.cond(qr).then(qr,".call(this,a0,a1);").else(qr,"=",jt,"[",Wr,"]=",Dt.link(function(zn){return Za(Ks,Dt,Ct,zn,2)}),"(",pr,");",qr,".call(this,a0,a1);"))}}Object.keys(Ct.state).length>0&&yr(Dt.shared.current,".dirty=true;"),Dt.shared.vao&&yr(Dt.shared.vao,".setVAO(null);")}function sn(Dt,Ct){var yr=Dt.proc("scope",3);Dt.batchId="a2";var wr=Dt.shared,tn=wr.current;Mu(Dt,yr,Ct.context),Ct.framebuffer&&Ct.framebuffer.append(Dt,yr),Ko(Object.keys(Ct.state)).forEach(function(ar){var Rr=Ct.state[ar],Rt=Rr.append(Dt,yr);qo(Rt)?Rt.forEach(function(pr,jt){yr.set(Dt.next[ar],"["+jt+"]",pr)}):yr.set(wr.next,"."+ar,Rt)}),ho(Dt,yr,Ct,!0,!0),[Oc,Gf,bf,Kf,hu].forEach(function(ar){var Rr=Ct.draw[ar];!Rr||yr.set(wr.draw,"."+ar,""+Rr.append(Dt,yr))}),Object.keys(Ct.uniforms).forEach(function(ar){var Rr=Ct.uniforms[ar].append(Dt,yr);Array.isArray(Rr)&&(Rr="["+Rr.join()+"]"),yr.set(wr.uniforms,"["+Lt.id(ar)+"]",Rr)}),Object.keys(Ct.attributes).forEach(function(ar){var Rr=Ct.attributes[ar].append(Dt,yr),Rt=Dt.scopeAttrib(ar);Object.keys(new Vr).forEach(function(pr){yr.set(Rt,"."+pr,Rr[pr])})}),Ct.scopeVAO&&yr.set(wr.vao,".targetVAO",Ct.scopeVAO.append(Dt,yr));function Er(ar){var Rr=Ct.shader[ar];Rr&&yr.set(wr.shader,"."+ar,Rr.append(Dt,yr))}Er(Lc),Er(lf),Object.keys(Ct.state).length>0&&(yr(tn,".dirty=true;"),yr.exit(tn,".dirty=true;")),yr("a1(",Dt.shared.context,",a0,",Dt.batchId,");")}function Kr(Dt){if(!(typeof Dt!="object"||qo(Dt))){for(var Ct=Object.keys(Dt),yr=0;yr<Ct.length;++yr)if(Hr.isDynamic(Dt[Ct[yr]]))return!0;return!1}}function Ci(Dt,Ct,yr){var wr=Ct.static[yr];if(!wr||!Kr(wr))return;var tn=Dt.global,Er=Object.keys(wr),ar=!1,Rr=!1,Rt=!1,pr=Dt.global.def("{}");Er.forEach(function(Wr){var qr=wr[Wr];if(Hr.isDynamic(qr)){typeof qr=="function"&&(qr=wr[Wr]=Hr.unbox(qr));var zn=xo(qr,null);ar=ar||zn.thisDep,Rt=Rt||zn.propDep,Rr=Rr||zn.contextDep}else{switch(tn(pr,".",Wr,"="),typeof qr){case"number":tn(qr);break;case"string":tn('"',qr,'"');break;case"object":Array.isArray(qr)&&tn("[",qr.join(),"]");break;default:tn(Dt.link(qr));break}tn(";")}});function jt(Wr,qr){Er.forEach(function(zn){var yi=wr[zn];if(!!Hr.isDynamic(yi)){var gi=Wr.invoke(qr,yi);qr(pr,".",zn,"=",gi,";")}})}Ct.dynamic[yr]=new Hr.DynamicVariable(tu,{thisDep:ar,contextDep:Rr,propDep:Rt,ref:pr,append:jt}),delete Ct.static[yr]}function No(Dt,Ct,yr,wr,tn){var Er=io();Er.stats=Er.link(tn),Object.keys(Ct.static).forEach(function(Rr){Ci(Er,Ct,Rr)}),qf.forEach(function(Rr){Ci(Er,Dt,Rr)});var ar=nl(Dt,Ct,yr,wr,Er);return as(Er,ar),sn(Er,ar),$t(Er,ar),a(Er.compile(),{destroy:function(){ar.shader.program.destroy()}})}return{next:Li,current:fi,procs:function(){var Dt=io(),Ct=Dt.proc("poll"),yr=Dt.proc("refresh"),wr=Dt.block();Ct(wr),yr(wr);var tn=Dt.shared,Er=tn.gl,ar=tn.next,Rr=tn.current;wr(Rr,".dirty=false;"),il(Dt,Ct),il(Dt,yr,null,!0);var Rt;ri&&(Rt=Dt.link(ri)),sr.oes_vertex_array_object&&yr(Dt.link(sr.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var pr=0;pr<an.maxAttributes;++pr){var jt=yr.def(tn.attributes,"[",pr,"]"),Wr=Dt.cond(jt,".buffer");Wr.then(Er,".enableVertexAttribArray(",pr,");",Er,".bindBuffer(",Vf,",",jt,".buffer.buffer);",Er,".vertexAttribPointer(",pr,",",jt,".size,",jt,".type,",jt,".normalized,",jt,".stride,",jt,".offset);").else(Er,".disableVertexAttribArray(",pr,");",Er,".vertexAttrib4f(",pr,",",jt,".x,",jt,".y,",jt,".z,",jt,".w);",jt,".buffer=null;"),yr(Wr),ri&&yr(Rt,".vertexAttribDivisorANGLE(",pr,",",jt,".divisor);")}return yr(Dt.shared.vao,".currentVAO=null;",Dt.shared.vao,".setVAO(",Dt.shared.vao,".targetVAO);"),Object.keys(Cn).forEach(function(qr){var zn=Cn[qr],yi=wr.def(ar,".",qr),gi=Dt.block();gi("if(",yi,"){",Er,".enable(",zn,")}else{",Er,".disable(",zn,")}",Rr,".",qr,"=",yi,";"),yr(gi),Ct("if(",yi,"!==",Rr,".",qr,"){",gi,"}")}),Object.keys(Mn).forEach(function(qr){var zn=Mn[qr],yi=fi[qr],gi,Bi,pi=Dt.block();if(pi(Er,".",zn,"("),qo(yi)){var aa=yi.length;gi=Dt.global.def(ar,".",qr),Bi=Dt.global.def(Rr,".",qr),pi(Ut(aa,function(Ui){return gi+"["+Ui+"]"}),");",Ut(aa,function(Ui){return Bi+"["+Ui+"]="+gi+"["+Ui+"];"}).join("")),Ct("if(",Ut(aa,function(Ui){return gi+"["+Ui+"]!=="+Bi+"["+Ui+"]"}).join("||"),"){",pi,"}")}else gi=wr.def(ar,".",qr),Bi=wr.def(Rr,".",qr),pi(gi,");",Rr,".",qr,"=",gi,";"),Ct("if(",gi,"!==",Bi,"){",pi,"}");yr(pi)}),Dt.compile()}(),compile:No}}function Rc(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var mc=34918,vl=34919,Jf=35007,Vh=function(ge,Lt){if(!Lt.ext_disjoint_timer_query)return null;var sr=[];function an(){return sr.pop()||Lt.ext_disjoint_timer_query.createQueryEXT()}function Pn(ri){sr.push(ri)}var rn=[];function yn(ri){var xi=an();Lt.ext_disjoint_timer_query.beginQueryEXT(Jf,xi),rn.push(xi),Xn(rn.length-1,rn.length,ri)}function In(){Lt.ext_disjoint_timer_query.endQueryEXT(Jf)}function jn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Kn=[];function ti(){return Kn.pop()||new jn}function ii(ri){Kn.push(ri)}var Ei=[];function Xn(ri,xi,Nn){var fi=ti();fi.startQueryIndex=ri,fi.endQueryIndex=xi,fi.sum=0,fi.stats=Nn,Ei.push(fi)}var ai=[],Vr=[];function dn(){var ri,xi,Nn=rn.length;if(Nn!==0){Vr.length=Math.max(Vr.length,Nn+1),ai.length=Math.max(ai.length,Nn+1),ai[0]=0,Vr[0]=0;var fi=0;for(ri=0,xi=0;xi<rn.length;++xi){var Li=rn[xi];Lt.ext_disjoint_timer_query.getQueryObjectEXT(Li,vl)?(fi+=Lt.ext_disjoint_timer_query.getQueryObjectEXT(Li,mc),Pn(Li)):rn[ri++]=Li,ai[xi+1]=fi,Vr[xi+1]=ri}for(rn.length=ri,ri=0,xi=0;xi<Ei.length;++xi){var ga=Ei[xi],Cn=ga.startQueryIndex,Mn=ga.endQueryIndex;ga.sum+=ai[Mn]-ai[Cn];var Ki=Vr[Cn],Ti=Vr[Mn];Ti===Ki?(ga.stats.gpuTime+=ga.sum/1e6,ii(ga)):(ga.startQueryIndex=Ki,ga.endQueryIndex=Ti,Ei[ri++]=ga)}Ei.length=ri}}return{beginQuery:yn,endQuery:In,pushScopeStats:Xn,update:dn,getNumPendingQueries:function(){return rn.length},clear:function(){sr.push.apply(sr,rn);for(var ri=0;ri<sr.length;ri++)Lt.ext_disjoint_timer_query.deleteQueryEXT(sr[ri]);rn.length=0,sr.length=0},restore:function(){rn.length=0,sr.length=0}}},Lh=16384,fh=256,eh=1024,Eh=34962,Ns="webglcontextlost",ki="webglcontextrestored",Oh=1,Dc=2,Ys=3;function gc(ge,Lt){for(var sr=0;sr<ge.length;++sr)if(ge[sr]===Lt)return sr;return-1}function Hh(ge){var Lt=je(ge);if(!Lt)return null;var sr=Lt.gl,an=sr.getContextAttributes(),Pn=sr.isContextLost(),rn=dt(sr,Lt);if(!rn)return null;var yn=li(),In=Rc(),jn=rn.extensions,Kn=Vh(sr,jn),ti=Gn(),ii=sr.drawingBufferWidth,Ei=sr.drawingBufferHeight,Xn={tick:0,time:0,viewportWidth:ii,viewportHeight:Ei,framebufferWidth:ii,framebufferHeight:Ei,drawingBufferWidth:ii,drawingBufferHeight:Ei,pixelRatio:Lt.pixelRatio},ai={},Vr={elements:null,primitive:4,count:-1,offset:0,instances:-1},dn=ec(sr,jn),ri=he(sr,In,Lt,fi),xi=ws(sr,jn,ri,In),Nn=Xr(sr,jn,dn,In,ri,xi,Vr);function fi(Za){return Nn.destroyBuffer(Za)}var Li=Zn(sr,yn,In,Lt),ga=Hu(sr,jn,dn,function(){Ki.procs.poll()},Xn,In,Lt),Cn=uc(sr,jn,dn,In,Lt),Mn=Jt(sr,jn,dn,ga,Cn,In),Ki=ru(sr,yn,jn,dn,ri,xi,ga,Mn,ai,Nn,Li,Vr,Xn,Kn,Lt),Ti=ma(sr,Mn,Ki.procs.poll,Xn,an,jn,dn),qn=Ki.next,Oi=sr.canvas,Ri=[],no=[],io=[],Ii=[Lt.onDestroy],Di=null;function Xa(){if(Ri.length===0){Kn&&Kn.update(),Di=null;return}Di=un.next(Xa),_u();for(var Za=Ri.length-1;Za>=0;--Za){var Zo=Ri[Za];Zo&&Zo(Xn,null,0)}sr.flush(),Kn&&Kn.update()}function lo(){!Di&&Ri.length>0&&(Di=un.next(Xa))}function bo(){Di&&(un.cancel(Xa),Di=null)}function nu(Za){Za.preventDefault(),Pn=!0,bo(),no.forEach(function(Zo){Zo()})}function $s(Za){sr.getError(),Pn=!1,rn.restore(),Li.restore(),ri.restore(),ga.restore(),Cn.restore(),Mn.restore(),Nn.restore(),Kn&&Kn.restore(),Ki.procs.refresh(),lo(),io.forEach(function(Zo){Zo()})}var Lo=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!Lo&&Oi&&(Oi.addEventListener(Ns,nu,!1),Oi.addEventListener(ki,$s,!1));function ml(){Ri.length=0,bo(),!Lo&&Oi&&(Oi.removeEventListener(Ns,nu),Oi.removeEventListener(ki,$s)),Li.clear(),Mn.clear(),Cn.clear(),Nn.clear(),ga.clear(),xi.clear(),ri.clear(),Kn&&Kn.clear(),Ii.forEach(function(Za){Za()})}function bs(Za){J(!!Za,"invalid args to regl({...})"),J.type(Za,"object","invalid args to regl({...})");function Zo(Er){var ar=a({},Er);delete ar.uniforms,delete ar.attributes,delete ar.context,delete ar.vao,"stencil"in ar&&ar.stencil.op&&(ar.stencil.opBack=ar.stencil.opFront=ar.stencil.op,delete ar.stencil.op);function Rr(Rt){if(Rt in ar){var pr=ar[Rt];delete ar[Rt],Object.keys(pr).forEach(function(jt){ar[Rt+"."+jt]=pr[jt]})}}return Rr("blend"),Rr("depth"),Rr("cull"),Rr("stencil"),Rr("polygonOffset"),Rr("scissor"),Rr("sample"),"vao"in Er&&(ar.vao=Er.vao),ar}function as(Er,ar){var Rr={},Rt={};return Object.keys(Er).forEach(function(pr){var jt=Er[pr];if(Hr.isDynamic(jt)){Rt[pr]=Hr.unbox(jt,pr);return}else if(ar&&Array.isArray(jt)){for(var Wr=0;Wr<jt.length;++Wr)if(Hr.isDynamic(jt[Wr])){Rt[pr]=Hr.unbox(jt,pr);return}}Rr[pr]=jt}),{dynamic:Rt,static:Rr}}var Os=as(Za.context||{},!0),Ks=as(Za.uniforms||{},!0),$t=as(Za.attributes||{},!1),sn=as(Zo(Za),!1),Kr={gpuTime:0,cpuTime:0,count:0},Ci=Ki.compile(sn,$t,Ks,Os,Kr),No=Ci.draw,Dt=Ci.batch,Ct=Ci.scope,yr=[];function wr(Er){for(;yr.length<Er;)yr.push(null);return yr}function tn(Er,ar){var Rr;if(Pn&&J.raise("context lost"),typeof Er=="function")return Ct.call(this,null,Er,0);if(typeof ar=="function")if(typeof Er=="number")for(Rr=0;Rr<Er;++Rr)Ct.call(this,null,ar,Rr);else if(Array.isArray(Er))for(Rr=0;Rr<Er.length;++Rr)Ct.call(this,Er[Rr],ar,Rr);else return Ct.call(this,Er,ar,0);else if(typeof Er=="number"){if(Er>0)return Dt.call(this,wr(Er|0),Er|0)}else if(Array.isArray(Er)){if(Er.length)return Dt.call(this,Er,Er.length)}else return No.call(this,Er)}return a(tn,{stats:Kr,destroy:function(){Ci.destroy()}})}var nl=Mn.setFBO=bs({framebuffer:Hr.define.call(null,Oh,"framebuffer")});function Mu(Za,Zo){var as=0;Ki.procs.poll();var Os=Zo.color;Os&&(sr.clearColor(+Os[0]||0,+Os[1]||0,+Os[2]||0,+Os[3]||0),as|=Lh),"depth"in Zo&&(sr.clearDepth(+Zo.depth),as|=fh),"stencil"in Zo&&(sr.clearStencil(Zo.stencil|0),as|=eh),J(!!as,"called regl.clear with no buffer specified"),sr.clear(as)}function il(Za){if(J(typeof Za=="object"&&Za,"regl.clear() takes an object as input"),"framebuffer"in Za)if(Za.framebuffer&&Za.framebuffer_reglType==="framebufferCube")for(var Zo=0;Zo<6;++Zo)nl(a({framebuffer:Za.framebuffer.faces[Zo]},Za),Mu);else nl(Za,Mu);else Mu(null,Za)}function al(Za){J.type(Za,"function","regl.frame() callback must be a function"),Ri.push(Za);function Zo(){var as=gc(Ri,Za);J(as>=0,"cannot cancel a frame twice");function Os(){var Ks=gc(Ri,Os);Ri[Ks]=Ri[Ri.length-1],Ri.length-=1,Ri.length<=0&&bo()}Ri[as]=Os}return lo(),{cancel:Zo}}function kl(){var Za=qn.viewport,Zo=qn.scissor_box;Za[0]=Za[1]=Zo[0]=Zo[1]=0,Xn.viewportWidth=Xn.framebufferWidth=Xn.drawingBufferWidth=Za[2]=Zo[2]=sr.drawingBufferWidth,Xn.viewportHeight=Xn.framebufferHeight=Xn.drawingBufferHeight=Za[3]=Zo[3]=sr.drawingBufferHeight}function _u(){Xn.tick+=1,Xn.time=Bu(),kl(),Ki.procs.poll()}function ho(){ga.refresh(),kl(),Ki.procs.refresh(),Kn&&Kn.update()}function Bu(){return(Gn()-ti)/1e3}ho();function is(Za,Zo){J.type(Zo,"function","listener callback must be a function");var as;switch(Za){case"frame":return al(Zo);case"lost":as=no;break;case"restore":as=io;break;case"destroy":as=Ii;break;default:J.raise("invalid event, must be one of frame,lost,restore,destroy")}return as.push(Zo),{cancel:function(){for(var Os=0;Os<as.length;++Os)if(as[Os]===Zo){as[Os]=as[as.length-1],as.pop();return}}}}var Nu=a(bs,{clear:il,prop:Hr.define.bind(null,Oh),context:Hr.define.bind(null,Dc),this:Hr.define.bind(null,Ys),draw:bs({}),buffer:function(Za){return ri.create(Za,Eh,!1,!1)},elements:function(Za){return xi.create(Za,!1)},texture:ga.create2D,cube:ga.createCube,renderbuffer:Cn.create,framebuffer:Mn.create,framebufferCube:Mn.createCube,vao:Nn.createVAO,attributes:an,frame:al,on:is,limits:dn,hasExtension:function(Za){return dn.extensions.indexOf(Za.toLowerCase())>=0},read:Ti,destroy:ml,_gl:sr,_refresh:ho,poll:function(){_u(),Kn&&Kn.update()},now:Bu,stats:In});return Lt.onDone(null,Nu),Nu}return Hh})},57324:function(Ft,A,y){"use strict";y.r(A),y.d(A,{add:function(){return V},after:function(){return fe},ary:function(){return Yo},assign:function(){return tt},assignIn:function(){return Fr},assignInWith:function(){return En},assignWith:function(){return na},at:function(){return Ec},attempt:function(){return hf},before:function(){return Uc},bind:function(){return Ul},bindAll:function(){return nc},bindKey:function(){return ef},camelCase:function(){return Vt},capitalize:function(){return Al},castArray:function(){return Ar},ceil:function(){return Zn},chain:function(){return Si},chunk:function(){return Pi},clamp:function(){return Ea},clone:function(){return Qa},cloneDeep:function(){return _o},cloneDeepWith:function(){return ru},cloneWith:function(){return vl},commit:function(){return Vh},compact:function(){return fh},concat:function(){return Eh},cond:function(){return Ys},conforms:function(){return Pn},conformsTo:function(){return yn},constant:function(){return In.Z},countBy:function(){return xi},create:function(){return fi},curry:function(){return Cn},curryRight:function(){return Ti},debounce:function(){return qn.Z},deburr:function(){return Xs},default:function(){return bE},defaultTo:function(){return Ri},defaults:function(){return Xa},defaultsDeep:function(){return bs},defer:function(){return kl},delay:function(){return ho},difference:function(){return sn},differenceBy:function(){return Dt},differenceWith:function(){return yr},divide:function(){return tn},drop:function(){return ar},dropRight:function(){return Rt},dropRightWhile:function(){return qr},dropWhile:function(){return yi},each:function(){return gi.Z},eachRight:function(){return Sf},endsWith:function(){return Ff},entries:function(){return Xh},entriesIn:function(){return Ih},eq:function(){return no.Z},escape:function(){return Ip},escapeRegExp:function(){return s},every:function(){return be},extend:function(){return Fr},extendWith:function(){return En},fill:function(){return br},filter:function(){return vn},find:function(){return Ni},findIndex:function(){return Fi},findKey:function(){return Eo},findLast:function(){return pu},findLastIndex:function(){return Is},findLastKey:function(){return xu},first:function(){return Wu},flatMap:function(){return _c},flatMapDeep:function(){return Go},flatMapDepth:function(){return Wo},flatten:function(){return $u},flattenDeep:function(){return Nl},flattenDepth:function(){return Pu},flip:function(){return hh},floor:function(){return th},flow:function(){return ip},flowRight:function(){return ap},forEach:function(){return gi.Z},forEachRight:function(){return Sf},forIn:function(){return Th},forInRight:function(){return jh},forOwn:function(){return qh},forOwnRight:function(){return kh},fromPairs:function(){return sp},functions:function(){return Ap},functionsIn:function(){return lp},get:function(){return ka.Z},groupBy:function(){return ep},gt:function(){return Tp},gte:function(){return pp},has:function(){return Mh},hasIn:function(){return Xf.Z},head:function(){return Wu},identity:function(){return $e.Z},inRange:function(){return Fp},includes:function(){return S},indexOf:function(){return oe},initial:function(){return Be},intersection:function(){return Hn},intersectionBy:function(){return ni},intersectionWith:function(){return qi},invert:function(){return co},invertBy:function(){return Yf},invoke:function(){return dh},invokeMap:function(){return Xp},isArguments:function(){return go.Z},isArray:function(){return ht.Z},isArrayBuffer:function(){return Uu},isArrayLike:function(){return Do.Z},isArrayLikeObject:function(){return Ks.Z},isBoolean:function(){return vp},isBuffer:function(){return lh.Z},isDate:function(){return ev},isElement:function(){return tv},isEmpty:function(){return nv},isEqual:function(){return av},isEqualWith:function(){return ov},isError:function(){return To},isFinite:function(){return sv},isFunction:function(){return wh.Z},isInteger:function(){return bd},isLength:function(){return uv.Z},isMap:function(){return Df},isMatch:function(){return fv},isMatchWith:function(){return hv},isNaN:function(){return pv},isNative:function(){return dv},isNil:function(){return vv},isNull:function(){return mv},isNumber:function(){return Ed},isObject:function(){return Fe.Z},isObjectLike:function(){return ze.Z},isPlainObject:function(){return ys.Z},isRegExp:function(){return fd},isSafeInteger:function(){return _v},isSet:function(){return Qc},isString:function(){return tp},isSymbol:function(){return v.Z},isTypedArray:function(){return cd.Z},isUndefined:function(){return xv.Z},isWeakMap:function(){return bv},isWeakSet:function(){return Ev},iteratee:function(){return Cv},join:function(){return Sv},kebabCase:function(){return Av},keyBy:function(){return Tv},keys:function(){return g.Z},keysIn:function(){return Pt.Z},last:function(){return Ci},lastIndexOf:function(){return wv},lodash:function(){return pe},lowerCase:function(){return Mv},lowerFirst:function(){return Pv},lt:function(){return Lv},lte:function(){return Ov},map:function(){return gl.Z},mapKeys:function(){return Iv},mapValues:function(){return Rv},matches:function(){return Dv},matchesProperty:function(){return kv},max:function(){return Fv},maxBy:function(){return Bv},mean:function(){return zv},meanBy:function(){return Uv},memoize:function(){return Zv.Z},merge:function(){return jv.Z},mergeWith:function(){return Lo},method:function(){return Gv},methodOf:function(){return Vv},min:function(){return Hv},minBy:function(){return Wv},mixin:function(){return Td},multiply:function(){return Xv},negate:function(){return nd},next:function(){return Ld},noop:function(){return Cr},now:function(){return Yv.Z},nth:function(){return Kv},nthArg:function(){return qv},omit:function(){return Qv},omitBy:function(){return em},once:function(){return tm},orderBy:function(){return im},over:function(){return am},overArgs:function(){return om},overEvery:function(){return sm},overSome:function(){return lm},pad:function(){return ym},padEnd:function(){return _m},padStart:function(){return xm},parseInt:function(){return bm},partial:function(){return Nd},partialRight:function(){return Em},partition:function(){return Cm},pick:function(){return Sm},pickBy:function(){return Id},plant:function(){return Ud},property:function(){return Am.Z},propertyOf:function(){return Tm},pull:function(){return Mm},pullAll:function(){return jd},pullAllBy:function(){return Pm},pullAllWith:function(){return Lm},pullAt:function(){return Im},random:function(){return Rm},range:function(){return km},rangeRight:function(){return Fm},rearg:function(){return Bm},reduce:function(){return zm},reduceRight:function(){return Um},reject:function(){return Zm},remove:function(){return jm},repeat:function(){return Gm},replace:function(){return Vm},rest:function(){return Hm},result:function(){return Wm},reverse:function(){return dd},round:function(){return Xm},sample:function(){return $m},sampleSize:function(){return Km},set:function(){return qm},setWith:function(){return Qm},shuffle:function(){return Jm},size:function(){return e0},slice:function(){return t0},snakeCase:function(){return r0},some:function(){return n0},sortBy:function(){return i0},sortedIndex:function(){return a0},sortedIndexBy:function(){return o0},sortedIndexOf:function(){return s0},sortedLastIndex:function(){return u0},sortedLastIndexBy:function(){return l0},sortedLastIndexOf:function(){return c0},sortedUniq:function(){return h0},sortedUniqBy:function(){return p0},split:function(){return d0},spread:function(){return v0},startCase:function(){return m0},startsWith:function(){return g0},stubArray:function(){return yu.Z},stubFalse:function(){return Cd.Z},stubObject:function(){return y0},stubString:function(){return _0},stubTrue:function(){return x0},subtract:function(){return b0},sum:function(){return E0},sumBy:function(){return C0},tail:function(){return S0},take:function(){return A0},takeRight:function(){return T0},takeRightWhile:function(){return w0},takeWhile:function(){return M0},tap:function(){return P0},template:function(){return D0},templateSettings:function(){return gd},throttle:function(){return k0.Z},thru:function(){return ad},times:function(){return B0},toArray:function(){return Pd},toFinite:function(){return at},toInteger:function(){return Re},toIterator:function(){return Wd},toJSON:function(){return Yp},toLength:function(){return ot},toLower:function(){return z0},toNumber:function(){return N.Z},toPairs:function(){return Xh},toPairsIn:function(){return Ih},toPath:function(){return U0},toPlainObject:function(){return Z0.Z},toSafeInteger:function(){return G0},toString:function(){return ko.Z},toUpper:function(){return V0},transform:function(){return H0},trim:function(){return Y0},trimEnd:function(){return $0},trimStart:function(){return K0},truncate:function(){return q0},unary:function(){return Q0},unescape:function(){return eg},union:function(){return tg},unionBy:function(){return rg},unionWith:function(){return ng},uniq:function(){return ig},uniqBy:function(){return ag},uniqWith:function(){return og},uniqueId:function(){return sg},unset:function(){return ug},unzip:function(){return _d},unzipWith:function(){return Yd},update:function(){return cg},updateWith:function(){return fg},upperCase:function(){return hg},upperFirst:function(){return gf},value:function(){return Yp},valueOf:function(){return Yp},values:function(){return x},valuesIn:function(){return pg},without:function(){return dg},words:function(){return xt},wrap:function(){return vg},wrapperAt:function(){return mg},wrapperChain:function(){return gg},wrapperCommit:function(){return Vh},wrapperLodash:function(){return pe},wrapperNext:function(){return Ld},wrapperPlant:function(){return Ud},wrapperReverse:function(){return yg},wrapperToIterator:function(){return Wd},wrapperValue:function(){return Yp},xor:function(){return _g},xorBy:function(){return xg},xorWith:function(){return bg},zip:function(){return Eg},zipObject:function(){return Sg},zipObjectDeep:function(){return Ag},zipWith:function(){return Tg}});var v=y(97828),Z=0/0;function a(c){return typeof c=="number"?c:(0,v.Z)(c)?Z:+c}var P=a,L=y(43503);function O(c,T){return function(K,Ie){var At;if(K===void 0&&Ie===void 0)return T;if(K!==void 0&&(At=K),Ie!==void 0){if(At===void 0)return Ie;typeof K=="string"||typeof Ie=="string"?(K=(0,L.Z)(K),Ie=(0,L.Z)(Ie)):(K=P(K),Ie=P(Ie)),At=c(K,Ie)}return At}}var D=O,B=D(function(c,T){return c+T},0),V=B,N=y(47422),Y=1/0,H=17976931348623157e292;function ce(c){if(!c)return c===0?c:0;if(c=(0,N.Z)(c),c===Y||c===-Y){var T=c<0?-1:1;return T*H}return c===c?c:0}var at=ce;function rt(c){var T=at(c),K=T%1;return T===T?K?T-K:T:0}var Re=rt,vt="Expected a function";function wt(c,T){if(typeof T!="function")throw new TypeError(vt);return c=Re(c),function(){if(--c<1)return T.apply(this,arguments)}}var fe=wt,$e=y(63305),re=y(41743),Ge=re.Z&&new re.Z,Qe=Ge,Te=Qe?function(c,T){return Qe.set(c,T),c}:$e.Z,Le=Te,Ce=y(27569),Fe=y(89122);function Ke(c){return function(){var T=arguments;switch(T.length){case 0:return new c;case 1:return new c(T[0]);case 2:return new c(T[0],T[1]);case 3:return new c(T[0],T[1],T[2]);case 4:return new c(T[0],T[1],T[2],T[3]);case 5:return new c(T[0],T[1],T[2],T[3],T[4]);case 6:return new c(T[0],T[1],T[2],T[3],T[4],T[5]);case 7:return new c(T[0],T[1],T[2],T[3],T[4],T[5],T[6])}var K=(0,Ce.Z)(c.prototype),Ie=c.apply(K,T);return(0,Fe.Z)(Ie)?Ie:K}}var qt=Ke,ir=y(56169),Pe=1;function Ne(c,T,K){var Ie=T&Pe,At=qt(c);function dr(){var Qr=this&&this!==ir.Z&&this instanceof dr?At:c;return Qr.apply(Ie?K:this,arguments)}return dr}var Xe=Ne,kt=y(84370),rr=Math.max;function me(c,T,K,Ie){for(var At=-1,dr=c.length,Qr=K.length,kn=-1,Qn=T.length,Sa=rr(dr-Qr,0),fa=Array(Qn+Sa),La=!Ie;++kn<Qn;)fa[kn]=T[kn];for(;++At<Qr;)(La||At<dr)&&(fa[K[At]]=c[At]);for(;Sa--;)fa[kn++]=c[At++];return fa}var et=me,or=Math.max;function on(c,T,K,Ie){for(var At=-1,dr=c.length,Qr=-1,kn=K.length,Qn=-1,Sa=T.length,fa=or(dr-kn,0),La=Array(fa+Sa),ts=!Ie;++At<fa;)La[At]=c[At];for(var ms=At;++Qn<Sa;)La[ms+Qn]=T[Qn];for(;++Qr<kn;)(ts||At<dr)&&(La[ms+K[Qr]]=c[At++]);return La}var vr=on;function jr(c,T){for(var K=c.length,Ie=0;K--;)c[K]===T&&++Ie;return Ie}var xr=jr;function Ae(){}var De=Ae,ke=4294967295;function Bt(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ke,this.__views__=[]}Bt.prototype=(0,Ce.Z)(De.prototype),Bt.prototype.constructor=Bt;var mt=Bt;function Mr(){}var Cr=Mr,Nr=Qe?function(c){return Qe.get(c)}:Cr,nt=Nr,Ye={},M=Ye,W=Object.prototype,ue=W.hasOwnProperty;function X(c){for(var T=c.name+"",K=M[T],Ie=ue.call(M,T)?K.length:0;Ie--;){var At=K[Ie],dr=At.func;if(dr==null||dr==c)return At.name}return T}var ie=X;function ye(c,T){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!T,this.__index__=0,this.__values__=void 0}ye.prototype=(0,Ce.Z)(De.prototype),ye.prototype.constructor=ye;var J=ye,ht=y(39350),ze=y(23195),pt=y(65935);function Me(c){if(c instanceof mt)return c.clone();var T=new J(c.__wrapped__,c.__chain__);return T.__actions__=(0,pt.Z)(c.__actions__),T.__index__=c.__index__,T.__values__=c.__values__,T}var Ue=Me,yt=Object.prototype,gt=yt.hasOwnProperty;function nr(c){if((0,ze.Z)(c)&&!(0,ht.Z)(c)&&!(c instanceof mt)){if(c instanceof J)return c;if(gt.call(c,"__wrapped__"))return Ue(c)}return new J(c)}nr.prototype=De.prototype,nr.prototype.constructor=nr;var pe=nr;function lr(c){var T=ie(c),K=pe[T];if(typeof K!="function"||!(T in mt.prototype))return!1;if(c===K)return!0;var Ie=nt(K);return!!Ie&&c===Ie[0]}var Ur=lr,Hr=y(7402),un=(0,Hr.Z)(Le),bn=un,Gn=/\{\n\/\* \[wrapped with (.+)\] \*/,li=/,? & /;function $r(c){var T=c.match(Gn);return T?T[1].split(li):[]}var Zt=$r,it=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function ne(c,T){var K=T.length;if(!K)return c;var Ie=K-1;return T[Ie]=(K>1?"& ":"")+T[Ie],T=T.join(K>2?", ":" "),c.replace(it,`{
/* [wrapped with `+T+`] */
`)}var _e=ne,Oe=y(49182),je=y(85241);function dt(c,T,K,Ie){for(var At=c.length,dr=K+(Ie?1:-1);Ie?dr--:++dr<At;)if(T(c[dr],dr,c))return dr;return-1}var Ut=dt;function ur(c){return c!==c}var lt=ur;function Nt(c,T,K){for(var Ie=K-1,At=c.length;++Ie<At;)if(c[Ie]===T)return Ie;return-1}var Sr=Nt;function fn(c,T,K){return T===T?Sr(c,T,K):Ut(c,lt,K)}var Br=fn;function Jr(c,T){var K=c==null?0:c.length;return!!K&&Br(c,T,0)>-1}var Tn=Jr,hi=1,On=2,Pr=8,vi=16,Jn=32,ui=64,Da=128,Yn=256,wa=512,vo=[["ary",Da],["bind",hi],["bindKey",On],["curry",Pr],["curryRight",vi],["flip",wa],["partial",Jn],["partialRight",ui],["rearg",Yn]];function Ua(c,T){return(0,je.Z)(vo,function(K){var Ie="_."+K[0];T&K[1]&&!Tn(c,Ie)&&c.push(Ie)}),c.sort()}var Ka=Ua;function Ga(c,T,K){var Ie=T+"";return(0,Oe.Z)(c,_e(Ie,Ka(Zt(Ie),K)))}var ei=Ga,eo=1,ra=2,Rn=4,qa=8,ba=32,Na=64;function wo(c,T,K,Ie,At,dr,Qr,kn,Qn,Sa){var fa=T&qa,La=fa?Qr:void 0,ts=fa?void 0:Qr,ms=fa?dr:void 0,du=fa?void 0:dr;T|=fa?ba:Na,T&=~(fa?Na:ba),T&Rn||(T&=~(eo|ra));var _l=[c,T,At,ms,La,du,ts,kn,Qn,Sa],Rs=K.apply(void 0,_l);return Ur(c)&&bn(Rs,_l),Rs.placeholder=Ie,ei(Rs,c,T)}var ya=wo;function Gt(c){var T=c;return T.placeholder}var gs=Gt,Qi=y(93564),So=Math.min;function ll(c,T){for(var K=c.length,Ie=So(T.length,K),At=(0,pt.Z)(c);Ie--;){var dr=T[Ie];c[Ie]=(0,Qi.Z)(dr,K)?At[dr]:void 0}return c}var Ss=ll,rs="__lodash_placeholder__";function ls(c,T){for(var K=-1,Ie=c.length,At=0,dr=[];++K<Ie;){var Qr=c[K];(Qr===T||Qr===rs)&&(c[K]=rs,dr[At++]=K)}return dr}var Ia=ls,Ms=1,uo=2,Qs=8,Ao=16,Ts=128,ua=512;function cs(c,T,K,Ie,At,dr,Qr,kn,Qn,Sa){var fa=T&Ts,La=T&Ms,ts=T&uo,ms=T&(Qs|Ao),du=T&ua,_l=ts?void 0:qt(c);function Rs(){for(var Ql=arguments.length,Jl=Array(Ql),Up=Ql;Up--;)Jl[Up]=arguments[Up];if(ms)var Zp=gs(Rs),xd=xr(Jl,Zp);if(Ie&&(Jl=et(Jl,Ie,At,ms)),dr&&(Jl=vr(Jl,dr,Qr,ms)),Ql-=xd,ms&&Ql<Sa){var EE=Ia(Jl,Zp);return ya(c,T,cs,Rs.placeholder,K,Jl,EE,kn,Qn,Sa-Ql)}var Og=La?K:this,Qd=ts?Og[c]:c;return Ql=Jl.length,kn?Jl=Ss(Jl,kn):du&&Ql>1&&Jl.reverse(),fa&&Qn<Ql&&(Jl.length=Qn),this&&this!==ir.Z&&this instanceof Rs&&(Qd=_l||qt(Qd)),Qd.apply(Og,Jl)}return Rs}var Ds=cs;function Ro(c,T,K){var Ie=qt(c);function At(){for(var dr=arguments.length,Qr=Array(dr),kn=dr,Qn=gs(At);kn--;)Qr[kn]=arguments[kn];var Sa=dr<3&&Qr[0]!==Qn&&Qr[dr-1]!==Qn?[]:Ia(Qr,Qn);if(dr-=Sa.length,dr<K)return ya(c,T,Ds,At.placeholder,void 0,Qr,Sa,void 0,void 0,K-dr);var fa=this&&this!==ir.Z&&this instanceof At?Ie:c;return(0,kt.Z)(fa,this,Qr)}return At}var Eu=Ro,ec=1;function Gs(c,T,K,Ie){var At=T&ec,dr=qt(c);function Qr(){for(var kn=-1,Qn=arguments.length,Sa=-1,fa=Ie.length,La=Array(fa+Qn),ts=this&&this!==ir.Z&&this instanceof Qr?dr:c;++Sa<fa;)La[Sa]=Ie[Sa];for(;Qn--;)La[Sa++]=arguments[++kn];return(0,kt.Z)(ts,At?K:this,La)}return Qr}var ft=Gs,St="__lodash_placeholder__",_r=1,Or=2,$n=4,Gi=8,to=128,Je=256,It=Math.min;function Ot(c,T){var K=c[1],Ie=T[1],At=K|Ie,dr=At<(_r|Or|to),Qr=Ie==to&&K==Gi||Ie==to&&K==Je&&c[7].length<=T[8]||Ie==(to|Je)&&T[7].length<=T[8]&&K==Gi;if(!(dr||Qr))return c;Ie&_r&&(c[2]=T[2],At|=K&_r?0:$n);var kn=T[3];if(kn){var Qn=c[3];c[3]=Qn?et(Qn,kn,T[4]):kn,c[4]=Qn?Ia(c[3],St):T[4]}return kn=T[5],kn&&(Qn=c[5],c[5]=Qn?vr(Qn,kn,T[6]):kn,c[6]=Qn?Ia(c[5],St):T[6]),kn=T[7],kn&&(c[7]=kn),Ie&to&&(c[8]=c[8]==null?T[8]:It(c[8],T[8])),c[9]==null&&(c[9]=T[9]),c[0]=T[0],c[1]=At,c}var Xt=Ot,Dr="Expected a function",Lr=1,_n=2,Un=8,mn=16,mi=32,Oa=64,Fn=Math.max;function ci(c,T,K,Ie,At,dr,Qr,kn){var Qn=T&_n;if(!Qn&&typeof c!="function")throw new TypeError(Dr);var Sa=Ie?Ie.length:0;if(Sa||(T&=~(mi|Oa),Ie=At=void 0),Qr=Qr===void 0?Qr:Fn(Re(Qr),0),kn=kn===void 0?kn:Re(kn),Sa-=At?At.length:0,T&Oa){var fa=Ie,La=At;Ie=At=void 0}var ts=Qn?void 0:nt(c),ms=[c,T,K,Ie,At,fa,La,dr,Qr,kn];if(ts&&Xt(ms,ts),c=ms[0],T=ms[1],K=ms[2],Ie=ms[3],At=ms[4],kn=ms[9]=ms[9]===void 0?Qn?0:c.length:Fn(ms[9]-Sa,0),!kn&&T&(Un|mn)&&(T&=~(Un|mn)),!T||T==Lr)var du=Xe(c,T,K);else T==Un||T==mn?du=Eu(c,T,kn):(T==mi||T==(Lr|mi))&&!At.length?du=ft(c,T,K,Ie):du=Ds.apply(void 0,ms);var _l=ts?Le:bn;return ei(_l(du,ms),c,T)}var ia=ci,_a=128;function ao(c,T,K){return T=K?void 0:T,T=c&&T==null?c.length:T,ia(c,_a,void 0,void 0,void 0,void 0,T)}var Yo=ao,Vo=y(47701),Bo=y(52457),mo=y(68664),Do=y(5710),ps=y(9794),g=y(88130),U=Object.prototype,he=U.hasOwnProperty,te=(0,mo.Z)(function(c,T){if((0,ps.Z)(T)||(0,Do.Z)(T)){(0,Bo.Z)(T,(0,g.Z)(T),c);return}for(var K in T)he.call(T,K)&&(0,Vo.Z)(c,K,T[K])}),tt=te,Pt=y(54673),fr=(0,mo.Z)(function(c,T){(0,Bo.Z)(T,(0,Pt.Z)(T),c)}),Fr=fr,zr=(0,mo.Z)(function(c,T,K,Ie){(0,Bo.Z)(T,(0,Pt.Z)(T),c,Ie)}),En=zr,Dn=(0,mo.Z)(function(c,T,K,Ie){(0,Bo.Z)(T,(0,g.Z)(T),c,Ie)}),na=Dn,ka=y(77398);function ha(c,T){for(var K=-1,Ie=T.length,At=Array(Ie),dr=c==null;++K<Ie;)At[K]=dr?void 0:(0,ka.Z)(c,T[K]);return At}var Fa=ha,Mo=y(21059),Po=y(5876),go=y(56986),fu=Po.Z?Po.Z.isConcatSpreadable:void 0;function yo(c){return(0,ht.Z)(c)||(0,go.Z)(c)||!!(fu&&c&&c[fu])}var Zu=yo;function tc(c,T,K,Ie,At){var dr=-1,Qr=c.length;for(K||(K=Zu),At||(At=[]);++dr<Qr;){var kn=c[dr];T>0&&K(kn)?T>1?tc(kn,T-1,K,Ie,At):(0,Mo.Z)(At,kn):Ie||(At[At.length]=kn)}return At}var ws=tc;function Nc(c){var T=c==null?0:c.length;return T?ws(c,1):[]}var $u=Nc,Ku=y(48431);function xl(c){return(0,Oe.Z)((0,Ku.Z)(c,void 0,$u),c+"")}var qo=xl,rc=qo(Fa),Ec=rc,Va=y(8901),qu=y(26818),ys=y(30353),ss="[object DOMException]",bl="[object Error]";function El(c){if(!(0,ze.Z)(c))return!1;var T=(0,qu.Z)(c);return T==bl||T==ss||typeof c.message=="string"&&typeof c.name=="string"&&!(0,ys.Z)(c)}var To=El,Ps=(0,Va.Z)(function(c,T){try{return(0,kt.Z)(c,void 0,T)}catch(K){return To(K)?K:new Error(K)}}),hf=Ps,ju="Expected a function";function zc(c,T){var K;if(typeof T!="function")throw new TypeError(ju);return c=Re(c),function(){return--c>0&&(K=T.apply(this,arguments)),c<=1&&(T=void 0),K}}var Uc=zc,Bf=1,Jc=32,vu=(0,Va.Z)(function(c,T,K){var Ie=Bf;if(K.length){var At=Ia(K,gs(vu));Ie|=Jc}return ia(c,Ie,T,K,At)});vu.placeholder={};var Ul=vu,Qu=y(20192),Cu=y(35429),Zl=qo(function(c,T){return(0,je.Z)(T,function(K){K=(0,Cu.Z)(K),(0,Qu.Z)(c,K,Ul(c[K],c))}),c}),nc=Zl,ic=1,Gu=2,pf=32,Cc=(0,Va.Z)(function(c,T,K){var Ie=ic|Gu;if(K.length){var At=Ia(K,gs(Cc));Ie|=pf}return ia(T,Ie,c,K,At)});Cc.placeholder={};var ef=Cc,ko=y(13633);function Zc(c,T,K){var Ie=-1,At=c.length;T<0&&(T=-T>At?0:At+T),K=K>At?At:K,K<0&&(K+=At),At=T>K?0:K-T>>>0,T>>>=0;for(var dr=Array(At);++Ie<At;)dr[Ie]=c[Ie+T];return dr}var Su=Zc;function jl(c,T,K){var Ie=c.length;return K=K===void 0?Ie:K,!T&&K>=Ie?c:Su(c,T,K)}var cl=jl,tf="\\ud800-\\udfff",Gl="\\u0300-\\u036f",fl="\\ufe20-\\ufe2f",jc="\\u20d0-\\u20ff",Vl=Gl+fl+jc,Cl="\\ufe0e\\ufe0f",Nf="\\u200d",rf=RegExp("["+Nf+tf+Vl+Cl+"]");function le(c){return rf.test(c)}var Ve=le;function _t(c){return c.split("")}var ut=_t,Wt="\\ud800-\\udfff",hn="\\u0300-\\u036f",Mi="\\ufe20-\\ufe2f",da="\\u20d0-\\u20ff",oa=hn+Mi+da,za="\\ufe0e\\ufe0f",Xo="["+Wt+"]",Sc="["+oa+"]",hl="\\ud83c[\\udffb-\\udfff]",df="(?:"+Sc+"|"+hl+")",yh="[^"+Wt+"]",ih="(?:\\ud83c[\\udde6-\\uddff]){2}",Hl="[\\ud800-\\udbff][\\udc00-\\udfff]",Sl="\\u200d",ac=df+"?",Vs="["+za+"]?",Gc="(?:"+Sl+"(?:"+[yh,ih,Hl].join("|")+")"+Vs+ac+")*",vf=Vs+ac+Gc,Hs="(?:"+[yh+Sc+"?",Sc,ih,Hl,Xo].join("|")+")",zi=RegExp(hl+"(?="+hl+")|"+Hs+vf,"g");function ks(c){return c.match(zi)||[]}var Vc=ks;function nf(c){return Ve(c)?Vc(c):ut(c)}var Ws=nf;function Vu(c){return function(T){T=(0,ko.Z)(T);var K=Ve(T)?Ws(T):void 0,Ie=K?K[0]:T.charAt(0),At=K?cl(K,1).join(""):T.slice(1);return Ie[c]()+At}}var mf=Vu,_i=mf("toUpperCase"),gf=_i;function $f(c){return gf((0,ko.Z)(c).toLowerCase())}var Al=$f;function _s(c,T,K,Ie){var At=-1,dr=c==null?0:c.length;for(Ie&&dr&&(K=c[++At]);++At<dr;)K=T(K,c[At],At,c);return K}var Au=_s;function yf(c){return function(T){return c==null?void 0:c[T]}}var Tl=yf,Ru={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Ac=Tl(Ru),ah=Ac,zf=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Uf="\\u0300-\\u036f",oh="\\ufe20-\\ufe2f",wl="\\u20d0-\\u20ff",pl=Uf+oh+wl,fo="["+pl+"]",Ju=RegExp(fo,"g");function Ml(c){return c=(0,ko.Z)(c),c&&c.replace(zf,ah).replace(Ju,"")}var Xs=Ml,oc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Hc(c){return c.match(oc)||[]}var Tu=Hc,Hu=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Js(c){return Hu.test(c)}var la=Js,Vi="\\ud800-\\udfff",wf="\\u0300-\\u036f",wu="\\ufe20-\\ufe2f",Wl="\\u20d0-\\u20ff",mu=wf+wu+Wl,Pl="\\u2700-\\u27bf",Zf="a-z\\xdf-\\xf6\\xf8-\\xff",sc="\\xac\\xb1\\xd7\\xf7",$o="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fs="\\u2000-\\u206f",_f=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",uc="A-Z\\xc0-\\xd6\\xd8-\\xde",lc="\\ufe0e\\ufe0f",Ll=sc+$o+fs+_f,au="['\u2019]",Tc="["+Ll+"]",cc="["+mu+"]",xf="\\d+",fc="["+Pl+"]",Xl="["+Zf+"]",Mf="[^"+Vi+Ll+xf+Pl+Zf+uc+"]",af="\\ud83c[\\udffb-\\udfff]",Yl="(?:"+cc+"|"+af+")",of="[^"+Vi+"]",$l="(?:\\ud83c[\\udde6-\\uddff]){2}",Kl="[\\ud800-\\udbff][\\udc00-\\udfff]",hc="["+uc+"]",gu="\\u200d",el="(?:"+Xl+"|"+Mf+")",Wc="(?:"+hc+"|"+Mf+")",sf="(?:"+au+"(?:d|ll|m|re|s|t|ve))?",sh="(?:"+au+"(?:D|LL|M|RE|S|T|VE))?",Pf=Yl+"?",n="["+lc+"]?",o="(?:"+gu+"(?:"+[of,$l,Kl].join("|")+")"+n+Pf+")*",i="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",l="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",w=n+Pf+o,z="(?:"+[fc,$l,Kl].join("|")+")"+w,j=RegExp([hc+"?"+Xl+"+"+sf+"(?="+[Tc,hc,"$"].join("|")+")",Wc+"+"+sh+"(?="+[Tc,hc+el,"$"].join("|")+")",hc+"?"+el+"+"+sf,hc+"+"+sh,l,i,xf,z].join("|"),"g");function ae(c){return c.match(j)||[]}var Se=ae;function He(c,T,K){return c=(0,ko.Z)(c),T=K?void 0:T,T===void 0?la(c)?Se(c):Tu(c):c.match(T)||[]}var xt=He,Et="['\u2019]",Tt=RegExp(Et,"g");function Jt(c){return function(T){return Au(xt(Xs(T).replace(Tt,"")),c,"")}}var Yt=Jt,gr=Yt(function(c,T,K){return T=T.toLowerCase(),c+(K?Al(T):T)}),Vt=gr;function mr(){if(!arguments.length)return[];var c=arguments[0];return(0,ht.Z)(c)?c:[c]}var Ar=mr,Xr=ir.Z.isFinite,cn=Math.min;function nn(c){var T=Math[c];return function(K,Ie){if(K=(0,N.Z)(K),Ie=Ie==null?0:cn(Re(Ie),292),Ie&&Xr(K)){var At=((0,ko.Z)(K)+"e").split("e"),dr=T(At[0]+"e"+(+At[1]+Ie));return At=((0,ko.Z)(dr)+"e").split("e"),+(At[0]+"e"+(+At[1]-Ie))}return T(K)}}var pn=nn,Bn=pn("ceil"),Zn=Bn;function Vn(c){var T=pe(c);return T.__chain__=!0,T}var Si=Vn,Zi=y(40185),ca=Math.ceil,ma=Math.max;function Co(c,T,K){(K?(0,Zi.Z)(c,T,K):T===void 0)?T=1:T=ma(Re(T),0);var Ie=c==null?0:c.length;if(!Ie||T<1)return[];for(var At=0,dr=0,Qr=Array(ca(Ie/T));At<Ie;)Qr[dr++]=Su(c,At,At+=T);return Qr}var Pi=Co;function Ha(c,T,K){return c===c&&(K!==void 0&&(c=c<=K?c:K),T!==void 0&&(c=c>=T?c:T)),c}var Ma=Ha;function Ba(c,T,K){return K===void 0&&(K=T,T=void 0),K!==void 0&&(K=(0,N.Z)(K),K=K===K?K:0),T!==void 0&&(T=(0,N.Z)(T),T=T===T?T:0),Ma((0,N.Z)(c),T,K)}var Ea=Ba,oo=y(55615);function Pa(c,T){return c&&(0,Bo.Z)(T,(0,g.Z)(T),c)}var Aa=Pa;function eu(c,T){return c&&(0,Bo.Z)(T,(0,Pt.Z)(T),c)}var As=eu,tu=y(42896),Ls=y(68479);function Ho(c,T){return(0,Bo.Z)(c,(0,Ls.Z)(c),T)}var xs=Ho,zs=y(67290),yu=y(39756),Xc=Object.getOwnPropertySymbols,ou=Xc?function(c){for(var T=[];c;)(0,Mo.Z)(T,(0,Ls.Z)(c)),c=(0,zs.Z)(c);return T}:yu.Z,su=ou;function Fs(c,T){return(0,Bo.Z)(c,su(c),T)}var uf=Fs,tl=y(72975),Ol=y(72982);function wc(c){return(0,Ol.Z)(c,Pt.Z,su)}var Mc=wc,Us=y(49550),Yc=Object.prototype,Il=Yc.hasOwnProperty;function Bs(c){var T=c.length,K=new c.constructor(T);return T&&typeof c[0]=="string"&&Il.call(c,"index")&&(K.index=c.index,K.input=c.input),K}var pc=Bs,dc=y(87901);function ql(c,T){var K=T?(0,dc.Z)(c.buffer):c.buffer;return new c.constructor(K,c.byteOffset,c.byteLength)}var Uo=ql,rl=/\w*$/;function uu(c){var T=new c.constructor(c.source,rl.exec(c));return T.lastIndex=c.lastIndex,T}var vc=uu,jf=Po.Z?Po.Z.prototype:void 0,Pc=jf?jf.valueOf:void 0;function Lf(c){return Pc?Object(Pc.call(c)):{}}var Rl=Lf,Du=y(32404),ku="[object Boolean]",Lc="[object Date]",lf="[object Map]",Oc="[object Number]",hu="[object RegExp]",bf="[object Set]",Gf="[object String]",Kf="[object Symbol]",Ef="[object ArrayBuffer]",Cf="[object DataView]",_h="[object Float32Array]",$c="[object Float64Array]",Of="[object Int8Array]",If="[object Int16Array]",Rf="[object Int32Array]",dl="[object Uint8Array]",uh="[object Uint8ClampedArray]",xh="[object Uint16Array]",qf="[object Uint32Array]";function Vf(c,T,K){var Ie=c.constructor;switch(T){case Ef:return(0,dc.Z)(c);case ku:case Lc:return new Ie(+c);case Cf:return Uo(c,K);case _h:case $c:case Of:case If:case Rf:case dl:case uh:case xh:case qf:return(0,Du.Z)(c,K);case lf:return new Ie;case Oc:case Gf:return new Ie(c);case hu:return vc(c);case bf:return new Ie;case Kf:return Rl(c)}}var bh=Vf,gp=y(84136),lh=y(66329),Gh="[object Map]";function Ph(c){return(0,ze.Z)(c)&&(0,Us.Z)(c)==Gh}var ch=Ph,Fu=y(4827),Dl=y(79730),ns=Dl.Z&&Dl.Z.isMap,Qf=ns?(0,Fu.Z)(ns):ch,Df=Qf,Hf="[object Set]";function Wf(c){return(0,ze.Z)(c)&&(0,Us.Z)(c)==Hf}var Kc=Wf,kf=Dl.Z&&Dl.Z.isSet,qc=kf?(0,Fu.Z)(kf):Kc,Qc=qc,Ic=1,C=2,ve=4,$="[object Arguments]",ee="[object Array]",Ee="[object Boolean]",We="[object Date]",er="[object Error]",hr="[object Function]",Kt="[object GeneratorFunction]",kr="[object Map]",wn="[object Number]",Ai="[object Object]",Hi="[object RegExp]",$i="[object Set]",R="[object String]",m="[object Symbol]",u="[object WeakMap]",_="[object ArrayBuffer]",b="[object DataView]",q="[object Float32Array]",de="[object Float64Array]",ct="[object Int8Array]",st="[object Int16Array]",Mt="[object Int32Array]",Ir="[object Uint8Array]",Gr="[object Uint8ClampedArray]",xn="[object Uint16Array]",gn="[object Uint32Array]",Sn={};Sn[$]=Sn[ee]=Sn[_]=Sn[b]=Sn[Ee]=Sn[We]=Sn[q]=Sn[de]=Sn[ct]=Sn[st]=Sn[Mt]=Sn[kr]=Sn[wn]=Sn[Ai]=Sn[Hi]=Sn[$i]=Sn[R]=Sn[m]=Sn[Ir]=Sn[Gr]=Sn[xn]=Sn[gn]=!0,Sn[er]=Sn[hr]=Sn[u]=!1;function Wn(c,T,K,Ie,At,dr){var Qr,kn=T&Ic,Qn=T&C,Sa=T&ve;if(K&&(Qr=At?K(c,Ie,At,dr):K(c)),Qr!==void 0)return Qr;if(!(0,Fe.Z)(c))return c;var fa=(0,ht.Z)(c);if(fa){if(Qr=pc(c),!kn)return(0,pt.Z)(c,Qr)}else{var La=(0,Us.Z)(c),ts=La==hr||La==Kt;if((0,lh.Z)(c))return(0,tu.Z)(c,kn);if(La==Ai||La==$||ts&&!At){if(Qr=Qn||ts?{}:(0,gp.Z)(c),!kn)return Qn?uf(c,As(Qr,c)):xs(c,Aa(Qr,c))}else{if(!Sn[La])return At?c:{};Qr=bh(c,La,kn)}}dr||(dr=new oo.Z);var ms=dr.get(c);if(ms)return ms;dr.set(c,Qr),Qc(c)?c.forEach(function(Rs){Qr.add(Wn(Rs,T,K,Rs,c,dr))}):Df(c)&&c.forEach(function(Rs,Ql){Qr.set(Ql,Wn(Rs,T,K,Ql,c,dr))});var du=Sa?Qn?Mc:tl.Z:Qn?Pt.Z:g.Z,_l=fa?void 0:du(c);return(0,je.Z)(_l||c,function(Rs,Ql){_l&&(Ql=Rs,Rs=c[Ql]),(0,Vo.Z)(Qr,Ql,Wn(Rs,T,K,Ql,c,dr))}),Qr}var bi=Wn,pa=4;function Wa(c){return bi(c,pa)}var Qa=Wa,ro=1,Ko=4;function sa(c){return bi(c,ro|Ko)}var _o=sa,xa=1,xo=4;function ds(c,T){return T=typeof T=="function"?T:void 0,bi(c,xa|xo,T)}var ru=ds,Rc=4;function mc(c,T){return T=typeof T=="function"?T:void 0,bi(c,Rc,T)}var vl=mc;function Jf(){return new J(this.value(),this.__chain__)}var Vh=Jf;function Lh(c){for(var T=-1,K=c==null?0:c.length,Ie=0,At=[];++T<K;){var dr=c[T];dr&&(At[Ie++]=dr)}return At}var fh=Lh;function eh(){var c=arguments.length;if(!c)return[];for(var T=Array(c-1),K=arguments[0],Ie=c;Ie--;)T[Ie-1]=arguments[Ie];return(0,Mo.Z)((0,ht.Z)(K)?(0,pt.Z)(K):[K],ws(T,1))}var Eh=eh,Ns=y(80758),ki=y(83333),Oh="Expected a function";function Dc(c){var T=c==null?0:c.length,K=ki.Z;return c=T?(0,Ns.Z)(c,function(Ie){if(typeof Ie[1]!="function")throw new TypeError(Oh);return[K(Ie[0]),Ie[1]]}):[],(0,Va.Z)(function(Ie){for(var At=-1;++At<T;){var dr=c[At];if((0,kt.Z)(dr[0],this,Ie))return(0,kt.Z)(dr[1],this,Ie)}})}var Ys=Dc;function gc(c,T,K){var Ie=K.length;if(c==null)return!Ie;for(c=Object(c);Ie--;){var At=K[Ie],dr=T[At],Qr=c[At];if(Qr===void 0&&!(At in c)||!dr(Qr))return!1}return!0}var Hh=gc;function ge(c){var T=(0,g.Z)(c);return function(K){return Hh(K,c,T)}}var Lt=ge,sr=1;function an(c){return Lt(bi(c,sr))}var Pn=an;function rn(c,T){return T==null||Hh(c,T,(0,g.Z)(T))}var yn=rn,In=y(31955);function jn(c,T,K,Ie){for(var At=-1,dr=c==null?0:c.length;++At<dr;){var Qr=c[At];T(Ie,Qr,K(Qr),c)}return Ie}var Kn=jn,ti=y(60353);function ii(c,T,K,Ie){return(0,ti.Z)(c,function(At,dr,Qr){T(Ie,At,K(At),Qr)}),Ie}var Ei=ii;function Xn(c,T){return function(K,Ie){var At=(0,ht.Z)(K)?Kn:Ei,dr=T?T():{};return At(K,c,(0,ki.Z)(Ie,2),dr)}}var ai=Xn,Vr=Object.prototype,dn=Vr.hasOwnProperty,ri=ai(function(c,T,K){dn.call(c,K)?++c[K]:(0,Qu.Z)(c,K,1)}),xi=ri;function Nn(c,T){var K=(0,Ce.Z)(c);return T==null?K:Aa(K,T)}var fi=Nn,Li=8;function ga(c,T,K){T=K?void 0:T;var Ie=ia(c,Li,void 0,void 0,void 0,void 0,void 0,T);return Ie.placeholder=ga.placeholder,Ie}ga.placeholder={};var Cn=ga,Mn=16;function Ki(c,T,K){T=K?void 0:T;var Ie=ia(c,Mn,void 0,void 0,void 0,void 0,void 0,T);return Ie.placeholder=Ki.placeholder,Ie}Ki.placeholder={};var Ti=Ki,qn=y(90808);function Oi(c,T){return c==null||c!==c?T:c}var Ri=Oi,no=y(52373),io=Object.prototype,Ii=io.hasOwnProperty,Di=(0,Va.Z)(function(c,T){c=Object(c);var K=-1,Ie=T.length,At=Ie>2?T[2]:void 0;for(At&&(0,Zi.Z)(T[0],T[1],At)&&(Ie=1);++K<Ie;)for(var dr=T[K],Qr=(0,Pt.Z)(dr),kn=-1,Qn=Qr.length;++kn<Qn;){var Sa=Qr[kn],fa=c[Sa];(fa===void 0||(0,no.Z)(fa,io[Sa])&&!Ii.call(c,Sa))&&(c[Sa]=dr[Sa])}return c}),Xa=Di,lo=y(96641);function bo(c,T,K,Ie,At,dr){return(0,Fe.Z)(c)&&(0,Fe.Z)(T)&&(dr.set(T,c),(0,lo.Z)(c,T,void 0,bo,dr),dr.delete(T)),c}var nu=bo,$s=(0,mo.Z)(function(c,T,K,Ie){(0,lo.Z)(c,T,K,Ie)}),Lo=$s,ml=(0,Va.Z)(function(c){return c.push(void 0,nu),(0,kt.Z)(Lo,void 0,c)}),bs=ml,nl="Expected a function";function Mu(c,T,K){if(typeof c!="function")throw new TypeError(nl);return setTimeout(function(){c.apply(void 0,K)},T)}var il=Mu,al=(0,Va.Z)(function(c,T){return il(c,1,T)}),kl=al,_u=(0,Va.Z)(function(c,T,K){return il(c,(0,N.Z)(T)||0,K)}),ho=_u,Bu=y(41597);function is(c,T,K){for(var Ie=-1,At=c==null?0:c.length;++Ie<At;)if(K(T,c[Ie]))return!0;return!1}var Nu=is,Za=y(76273),Zo=200;function as(c,T,K,Ie){var At=-1,dr=Tn,Qr=!0,kn=c.length,Qn=[],Sa=T.length;if(!kn)return Qn;K&&(T=(0,Ns.Z)(T,(0,Fu.Z)(K))),Ie?(dr=Nu,Qr=!1):T.length>=Zo&&(dr=Za.Z,Qr=!1,T=new Bu.Z(T));e:for(;++At<kn;){var fa=c[At],La=K==null?fa:K(fa);if(fa=Ie||fa!==0?fa:0,Qr&&La===La){for(var ts=Sa;ts--;)if(T[ts]===La)continue e;Qn.push(fa)}else dr(T,La,Ie)||Qn.push(fa)}return Qn}var Os=as,Ks=y(34096),$t=(0,Va.Z)(function(c,T){return(0,Ks.Z)(c)?Os(c,ws(T,1,Ks.Z,!0)):[]}),sn=$t;function Kr(c){var T=c==null?0:c.length;return T?c[T-1]:void 0}var Ci=Kr,No=(0,Va.Z)(function(c,T){var K=Ci(T);return(0,Ks.Z)(K)&&(K=void 0),(0,Ks.Z)(c)?Os(c,ws(T,1,Ks.Z,!0),(0,ki.Z)(K,2)):[]}),Dt=No,Ct=(0,Va.Z)(function(c,T){var K=Ci(T);return(0,Ks.Z)(K)&&(K=void 0),(0,Ks.Z)(c)?Os(c,ws(T,1,Ks.Z,!0),void 0,K):[]}),yr=Ct,wr=D(function(c,T){return c/T},1),tn=wr;function Er(c,T,K){var Ie=c==null?0:c.length;return Ie?(T=K||T===void 0?1:Re(T),Su(c,T<0?0:T,Ie)):[]}var ar=Er;function Rr(c,T,K){var Ie=c==null?0:c.length;return Ie?(T=K||T===void 0?1:Re(T),T=Ie-T,Su(c,0,T<0?0:T)):[]}var Rt=Rr;function pr(c,T,K,Ie){for(var At=c.length,dr=Ie?At:-1;(Ie?dr--:++dr<At)&&T(c[dr],dr,c););return K?Su(c,Ie?0:dr,Ie?dr+1:At):Su(c,Ie?dr+1:0,Ie?At:dr)}var jt=pr;function Wr(c,T){return c&&c.length?jt(c,(0,ki.Z)(T,3),!0,!0):[]}var qr=Wr;function zn(c,T){return c&&c.length?jt(c,(0,ki.Z)(T,3),!0):[]}var yi=zn,gi=y(81277);function Bi(c,T){for(var K=c==null?0:c.length;K--&&T(c[K],K,c)!==!1;);return c}var pi=Bi,aa=y(51912),Ui=(0,aa.Z)(!0),Ji=Ui;function ea(c,T){return c&&Ji(c,T,g.Z)}var ji=ea,Ya=y(57912),Es=(0,Ya.Z)(ji,!0),ol=Es,os=y(27373);function us(c,T){var K=(0,ht.Z)(c)?pi:ol;return K(c,(0,os.Z)(T))}var Sf=us;function yc(c,T,K){c=(0,ko.Z)(c),T=(0,L.Z)(T);var Ie=c.length;K=K===void 0?Ie:Ma(Re(K),0,Ie);var At=K;return K-=T.length,K>=0&&c.slice(K,At)==T}var Ff=yc;function cf(c,T){return(0,Ns.Z)(T,function(K){return[K,c[K]]})}var yp=cf,ff=y(70924);function Ch(c){var T=-1,K=Array(c.size);return c.forEach(function(Ie){K[++T]=[Ie,Ie]}),K}var Wh=Ch,$p="[object Map]",sl="[object Set]";function rp(c){return function(T){var K=(0,Us.Z)(T);return K==$p?(0,ff.Z)(T):K==sl?Wh(T):yp(T,c(T))}}var Sh=rp,Op=Sh(g.Z),Xh=Op,jp=Sh(Pt.Z),Ih=jp,Rh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Kp=Tl(Rh),qp=Kp,Gp=/[&<>"']/g,Fl=RegExp(Gp.source);function Uh(c){return c=(0,ko.Z)(c),c&&Fl.test(c)?c.replace(Gp,qp):c}var Ip=Uh,e=/[\\^$.*+?()[\]{}|]/g,t=RegExp(e.source);function r(c){return c=(0,ko.Z)(c),c&&t.test(c)?c.replace(e,"\\$&"):c}var s=r;function d(c,T){for(var K=-1,Ie=c==null?0:c.length;++K<Ie;)if(!T(c[K],K,c))return!1;return!0}var E=d;function I(c,T){var K=!0;return(0,ti.Z)(c,function(Ie,At,dr){return K=!!T(Ie,At,dr),K}),K}var G=I;function se(c,T,K){var Ie=(0,ht.Z)(c)?E:G;return K&&(0,Zi.Z)(c,T,K)&&(T=void 0),Ie(c,(0,ki.Z)(T,3))}var be=se,we=4294967295;function Ze(c){return c?Ma(Re(c),0,we):0}var ot=Ze;function bt(c,T,K,Ie){var At=c.length;for(K=Re(K),K<0&&(K=-K>At?0:At+K),Ie=Ie===void 0||Ie>At?At:Re(Ie),Ie<0&&(Ie+=At),Ie=K>Ie?0:ot(Ie);K<Ie;)c[K++]=T;return c}var Qt=bt;function tr(c,T,K,Ie){var At=c==null?0:c.length;return At?(K&&typeof K!="number"&&(0,Zi.Z)(c,T,K)&&(K=0,Ie=At),Qt(c,T,K,Ie)):[]}var br=tr,cr=y(64513);function Zr(c,T){var K=[];return(0,ti.Z)(c,function(Ie,At,dr){T(Ie,At,dr)&&K.push(Ie)}),K}var Yr=Zr;function ln(c,T){var K=(0,ht.Z)(c)?cr.Z:Yr;return K(c,(0,ki.Z)(T,3))}var vn=ln;function Ln(c){return function(T,K,Ie){var At=Object(T);if(!(0,Do.Z)(T)){var dr=(0,ki.Z)(K,3);T=(0,g.Z)(T),K=function(kn){return dr(At[kn],kn,At)}}var Qr=c(T,K,Ie);return Qr>-1?At[dr?T[Qr]:Qr]:void 0}}var oi=Ln,wi=Math.max;function va(c,T,K){var Ie=c==null?0:c.length;if(!Ie)return-1;var At=K==null?0:Re(K);return At<0&&(At=wi(Ie+At,0)),Ut(c,(0,ki.Z)(T,3),At)}var Fi=va,Ca=oi(Fi),Ni=Ca;function Oo(c,T,K){var Ie;return K(c,function(At,dr,Qr){if(T(At,dr,Qr))return Ie=dr,!1}),Ie}var $a=Oo,Wi=y(99035);function jo(c,T){return $a(c,(0,ki.Z)(T,3),Wi.Z)}var Eo=jo,Qo=Math.max,Ra=Math.min;function vs(c,T,K){var Ie=c==null?0:c.length;if(!Ie)return-1;var At=Ie-1;return K!==void 0&&(At=Re(K),At=K<0?Qo(Ie+At,0):Ra(At,Ie-1)),Ut(c,(0,ki.Z)(T,3),At,!0)}var Is=vs,lu=oi(Is),pu=lu;function cu(c,T){return $a(c,(0,ki.Z)(T,3),ji)}var xu=cu;function ul(c){return c&&c.length?c[0]:void 0}var Wu=ul,gl=y(30014);function Xu(c,T){return ws((0,gl.Z)(c,T),1)}var _c=Xu,zu=1/0;function Bl(c,T){return ws((0,gl.Z)(c,T),zu)}var Go=Bl;function Zs(c,T,K){return K=K===void 0?1:Re(K),ws((0,gl.Z)(c,T),K)}var Wo=Zs,Jo=1/0;function kc(c){var T=c==null?0:c.length;return T?ws(c,Jo):[]}var Nl=kc;function js(c,T){var K=c==null?0:c.length;return K?(T=T===void 0?1:Re(T),ws(c,T)):[]}var Pu=js,xc=512;function hs(c){return ia(c,xc)}var hh=hs,Af=pn("floor"),th=Af,Lu="Expected a function",ph=8,Tf=32,Yh=128,Zh=256;function $h(c){return qo(function(T){var K=T.length,Ie=K,At=J.prototype.thru;for(c&&T.reverse();Ie--;){var dr=T[Ie];if(typeof dr!="function")throw new TypeError(Lu);if(At&&!Qr&&ie(dr)=="wrapper")var Qr=new J([],!0)}for(Ie=Qr?Ie:K;++Ie<K;){dr=T[Ie];var kn=ie(dr),Qn=kn=="wrapper"?nt(dr):void 0;Qn&&Ur(Qn[0])&&Qn[1]==(Yh|ph|Tf|Zh)&&!Qn[4].length&&Qn[9]==1?Qr=Qr[ie(Qn[0])].apply(Qr,Qn[3]):Qr=dr.length==1&&Ur(dr)?Qr[kn]():Qr.thru(dr)}return function(){var Sa=arguments,fa=Sa[0];if(Qr&&Sa.length==1&&(0,ht.Z)(fa))return Qr.plant(fa).value();for(var La=0,ts=K?T[La].apply(this,Sa):fa;++La<K;)ts=T[La].call(this,ts);return ts}})}var Ah=$h,np=Ah(),ip=np,Kh=Ah(!0),ap=Kh,_p=y(60332);function xp(c,T){return c==null?c:(0,_p.Z)(c,(0,os.Z)(T),Pt.Z)}var Th=xp;function bp(c,T){return c==null?c:Ji(c,(0,os.Z)(T),Pt.Z)}var jh=bp;function Dh(c,T){return c&&(0,Wi.Z)(c,(0,os.Z)(T))}var qh=Dh;function Ep(c,T){return c&&ji(c,(0,os.Z)(T))}var kh=Ep;function op(c){for(var T=-1,K=c==null?0:c.length,Ie={};++T<K;){var At=c[T];Ie[At[0]]=At[1]}return Ie}var sp=op,wh=y(25069);function Cp(c,T){return(0,cr.Z)(T,function(K){return(0,wh.Z)(c[K])})}var Qh=Cp;function Sp(c){return c==null?[]:Qh(c,(0,g.Z)(c))}var Ap=Sp;function up(c){return c==null?[]:Qh(c,(0,Pt.Z)(c))}var lp=up,Jh=Object.prototype,cp=Jh.hasOwnProperty,Fh=ai(function(c,T,K){cp.call(c,K)?c[K].push(T):(0,Qu.Z)(c,K,[T])}),ep=Fh;function fp(c,T){return c>T}var hp=fp;function Vp(c){return function(T,K){return typeof T=="string"&&typeof K=="string"||(T=(0,N.Z)(T),K=(0,N.Z)(K)),c(T,K)}}var Bh=Vp,Qp=Bh(hp),Tp=Qp,Jp=Bh(function(c,T){return c>=T}),pp=Jp,Ou=Object.prototype,rh=Ou.hasOwnProperty;function ed(c,T){return c!=null&&rh.call(c,T)}var Nh=ed,Rp=y(67754);function Hp(c,T){return c!=null&&(0,Rp.Z)(c,T,Nh)}var Mh=Hp,Xf=y(86980),wp=Math.max,dp=Math.min;function Mp(c,T,K){return c>=dp(T,K)&&c<wp(T,K)}var Dp=Mp;function kp(c,T,K){return T=at(T),K===void 0?(K=T,T=0):K=at(K),c=(0,N.Z)(c),Dp(c,T,K)}var Fp=kp,Pp="[object String]";function Wp(c){return typeof c=="string"||!(0,ht.Z)(c)&&(0,ze.Z)(c)&&(0,qu.Z)(c)==Pp}var tp=Wp;function td(c,T){return(0,Ns.Z)(T,function(K){return c[K]})}var f=td;function F(c){return c==null?[]:f(c,(0,g.Z)(c))}var x=F,p=Math.max;function h(c,T,K,Ie){c=(0,Do.Z)(c)?c:x(c),K=K&&!Ie?Re(K):0;var At=c.length;return K<0&&(K=p(At+K,0)),tp(c)?K<=At&&c.indexOf(T,K)>-1:!!At&&Br(c,T,K)>-1}var S=h,k=Math.max;function Q(c,T,K){var Ie=c==null?0:c.length;if(!Ie)return-1;var At=K==null?0:Re(K);return At<0&&(At=k(Ie+At,0)),Br(c,T,At)}var oe=Q;function xe(c){var T=c==null?0:c.length;return T?Su(c,0,-1):[]}var Be=xe,qe=Math.min;function zt(c,T,K){for(var Ie=K?Nu:Tn,At=c[0].length,dr=c.length,Qr=dr,kn=Array(dr),Qn=Infinity,Sa=[];Qr--;){var fa=c[Qr];Qr&&T&&(fa=(0,Ns.Z)(fa,(0,Fu.Z)(T))),Qn=qe(fa.length,Qn),kn[Qr]=!K&&(T||At>=120&&fa.length>=120)?new Bu.Z(Qr&&fa):void 0}fa=c[0];var La=-1,ts=kn[0];e:for(;++La<At&&Sa.length<Qn;){var ms=fa[La],du=T?T(ms):ms;if(ms=K||ms!==0?ms:0,!(ts?(0,Za.Z)(ts,du):Ie(Sa,du,K))){for(Qr=dr;--Qr;){var _l=kn[Qr];if(!(_l?(0,Za.Z)(_l,du):Ie(c[Qr],du,K)))continue e}ts&&ts.push(du),Sa.push(ms)}}return Sa}var Ht=zt;function Tr(c){return(0,Ks.Z)(c)?c:[]}var en=Tr,An=(0,Va.Z)(function(c){var T=(0,Ns.Z)(c,en);return T.length&&T[0]===c[0]?Ht(T):[]}),Hn=An,si=(0,Va.Z)(function(c){var T=Ci(c),K=(0,Ns.Z)(c,en);return T===Ci(K)?T=void 0:K.pop(),K.length&&K[0]===c[0]?Ht(K,(0,ki.Z)(T,2)):[]}),ni=si,di=(0,Va.Z)(function(c){var T=Ci(c),K=(0,Ns.Z)(c,en);return T=typeof T=="function"?T:void 0,T&&K.pop(),K.length&&K[0]===c[0]?Ht(K,void 0,T):[]}),qi=di;function ta(c,T,K,Ie){return(0,Wi.Z)(c,function(At,dr,Qr){T(Ie,K(At),dr,Qr)}),Ie}var Xi=ta;function Ja(c,T){return function(K,Ie){return Xi(K,c,T(Ie),{})}}var po=Ja,zo=Object.prototype,Ta=zo.toString,Io=po(function(c,T,K){T!=null&&typeof T.toString!="function"&&(T=Ta.call(T)),c[T]=K},(0,In.Z)($e.Z)),co=Io,qs=Object.prototype,yl=qs.hasOwnProperty,bc=qs.toString,Fc=po(function(c,T,K){T!=null&&typeof T.toString!="function"&&(T=bc.call(T)),yl.call(c,T)?c[T].push(K):c[T]=[K]},ki.Z),Yf=Fc,zl=y(58204),zh=y(23791);function Bp(c,T){return T.length<2?c:(0,zh.Z)(c,Su(T,0,-1))}var rd=Bp;function od(c,T,K){T=(0,zl.Z)(T,c),c=rd(c,T);var Ie=c==null?c:c[(0,Cu.Z)(Ci(T))];return Ie==null?void 0:(0,kt.Z)(Ie,c,K)}var Lp=od,sd=(0,Va.Z)(Lp),dh=sd,Np=(0,Va.Z)(function(c,T,K){var Ie=-1,At=typeof T=="function",dr=(0,Do.Z)(c)?Array(c.length):[];return(0,ti.Z)(c,function(Qr){dr[++Ie]=At?(0,kt.Z)(T,Qr,K):Lp(Qr,T,K)}),dr}),Xp=Np,ja="[object ArrayBuffer]";function Cs(c){return(0,ze.Z)(c)&&(0,qu.Z)(c)==ja}var iu=Cs,Yi=Dl.Z&&Dl.Z.isArrayBuffer,nh=Yi?(0,Fu.Z)(Yi):iu,Uu=nh,vh="[object Boolean]";function mh(c){return c===!0||c===!1||(0,ze.Z)(c)&&(0,qu.Z)(c)==vh}var vp=mh,ld="[object Date]";function Ig(c){return(0,ze.Z)(c)&&(0,qu.Z)(c)==ld}var Rg=Ig,Jd=Dl.Z&&Dl.Z.isDate,Dg=Jd?(0,Fu.Z)(Jd):Rg,ev=Dg;function kg(c){return(0,ze.Z)(c)&&c.nodeType===1&&!(0,ys.Z)(c)}var tv=kg,rv=y(9169),cd=y(40760),Fg="[object Map]",Bg="[object Set]",Ng=Object.prototype,zg=Ng.hasOwnProperty;function Ug(c){if(c==null)return!0;if((0,Do.Z)(c)&&((0,ht.Z)(c)||typeof c=="string"||typeof c.splice=="function"||(0,lh.Z)(c)||(0,cd.Z)(c)||(0,go.Z)(c)))return!c.length;var T=(0,Us.Z)(c);if(T==Fg||T==Bg)return!c.size;if((0,ps.Z)(c))return!(0,rv.Z)(c).length;for(var K in c)if(zg.call(c,K))return!1;return!0}var nv=Ug,iv=y(22755);function Zg(c,T){return(0,iv.Z)(c,T)}var av=Zg;function jg(c,T,K){K=typeof K=="function"?K:void 0;var Ie=K?K(c,T):void 0;return Ie===void 0?(0,iv.Z)(c,T,void 0,K):!!Ie}var ov=jg,Gg=ir.Z.isFinite;function Vg(c){return typeof c=="number"&&Gg(c)}var sv=Vg;function Hg(c){return typeof c=="number"&&c==Re(c)}var bd=Hg,uv=y(20523),lv=y(13551),cv=y(16727);function Wg(c,T){return c===T||(0,lv.Z)(c,T,(0,cv.Z)(T))}var fv=Wg;function Xg(c,T,K){return K=typeof K=="function"?K:void 0,(0,lv.Z)(c,T,(0,cv.Z)(T),K)}var hv=Xg,Yg="[object Number]";function $g(c){return typeof c=="number"||(0,ze.Z)(c)&&(0,qu.Z)(c)==Yg}var Ed=$g;function Kg(c){return Ed(c)&&c!=+c}var pv=Kg,qg=y(67722),Qg=y(84935),Cd=y(6826),Jg=Qg.Z?wh.Z:Cd.Z,ey=Jg,ty="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function ry(c){if(ey(c))throw new Error(ty);return(0,qg.Z)(c)}var dv=ry;function ny(c){return c==null}var vv=ny;function iy(c){return c===null}var mv=iy,ay="[object RegExp]";function oy(c){return(0,ze.Z)(c)&&(0,qu.Z)(c)==ay}var sy=oy,gv=Dl.Z&&Dl.Z.isRegExp,uy=gv?(0,Fu.Z)(gv):sy,fd=uy,yv=9007199254740991;function ly(c){return bd(c)&&c>=-yv&&c<=yv}var _v=ly,xv=y(99250),cy="[object WeakMap]";function fy(c){return(0,ze.Z)(c)&&(0,Us.Z)(c)==cy}var bv=fy,hy="[object WeakSet]";function py(c){return(0,ze.Z)(c)&&(0,qu.Z)(c)==hy}var Ev=py,dy=1;function vy(c){return(0,ki.Z)(typeof c=="function"?c:bi(c,dy))}var Cv=vy,gy=Array.prototype,yy=gy.join;function _y(c,T){return c==null?"":yy.call(c,T)}var Sv=_y,xy=Yt(function(c,T,K){return c+(K?"-":"")+T.toLowerCase()}),Av=xy,by=ai(function(c,T,K){(0,Qu.Z)(c,K,T)}),Tv=by;function Ey(c,T,K){for(var Ie=K+1;Ie--;)if(c[Ie]===T)return Ie;return Ie}var Cy=Ey,Sy=Math.max,Ay=Math.min;function Ty(c,T,K){var Ie=c==null?0:c.length;if(!Ie)return-1;var At=Ie;return K!==void 0&&(At=Re(K),At=At<0?Sy(Ie+At,0):Ay(At,Ie-1)),T===T?Cy(c,T,At):Ut(c,lt,At,!0)}var wv=Ty,wy=Yt(function(c,T,K){return c+(K?" ":"")+T.toLowerCase()}),Mv=wy,My=mf("toLowerCase"),Pv=My;function Py(c,T){return c<T}var Sd=Py,Ly=Bh(Sd),Lv=Ly,Oy=Bh(function(c,T){return c<=T}),Ov=Oy;function Iy(c,T){var K={};return T=(0,ki.Z)(T,3),(0,Wi.Z)(c,function(Ie,At,dr){(0,Qu.Z)(K,T(Ie,At,dr),Ie)}),K}var Iv=Iy;function Ry(c,T){var K={};return T=(0,ki.Z)(T,3),(0,Wi.Z)(c,function(Ie,At,dr){(0,Qu.Z)(K,At,T(Ie,At,dr))}),K}var Rv=Ry,Dy=y(25478),ky=1;function Fy(c){return(0,Dy.Z)(bi(c,ky))}var Dv=Fy,By=y(69060),Ny=1;function zy(c,T){return(0,By.Z)(c,bi(T,Ny))}var kv=zy;function Uy(c,T,K){for(var Ie=-1,At=c.length;++Ie<At;){var dr=c[Ie],Qr=T(dr);if(Qr!=null&&(kn===void 0?Qr===Qr&&!(0,v.Z)(Qr):K(Qr,kn)))var kn=Qr,Qn=dr}return Qn}var hd=Uy;function Zy(c){return c&&c.length?hd(c,$e.Z,hp):void 0}var Fv=Zy;function jy(c,T){return c&&c.length?hd(c,(0,ki.Z)(T,2),hp):void 0}var Bv=jy;function Gy(c,T){for(var K,Ie=-1,At=c.length;++Ie<At;){var dr=T(c[Ie]);dr!==void 0&&(K=K===void 0?dr:K+dr)}return K}var Ad=Gy,Vy=0/0;function Hy(c,T){var K=c==null?0:c.length;return K?Ad(c,T)/K:Vy}var Nv=Hy;function Wy(c){return Nv(c,$e.Z)}var zv=Wy;function Xy(c,T){return Nv(c,(0,ki.Z)(T,2))}var Uv=Xy,Zv=y(28408),jv=y(37729),Yy=(0,Va.Z)(function(c,T){return function(K){return Lp(K,c,T)}}),Gv=Yy,$y=(0,Va.Z)(function(c,T){return function(K){return Lp(c,K,T)}}),Vv=$y;function Ky(c){return c&&c.length?hd(c,$e.Z,Sd):void 0}var Hv=Ky;function qy(c,T){return c&&c.length?hd(c,(0,ki.Z)(T,2),Sd):void 0}var Wv=qy;function Qy(c,T,K){var Ie=(0,g.Z)(T),At=Qh(T,Ie),dr=!((0,Fe.Z)(K)&&"chain"in K)||!!K.chain,Qr=(0,wh.Z)(c);return(0,je.Z)(At,function(kn){var Qn=T[kn];c[kn]=Qn,Qr&&(c.prototype[kn]=function(){var Sa=this.__chain__;if(dr||Sa){var fa=c(this.__wrapped__),La=fa.__actions__=(0,pt.Z)(this.__actions__);return La.push({func:Qn,args:arguments,thisArg:c}),fa.__chain__=Sa,fa}return Qn.apply(c,(0,Mo.Z)([this.value()],arguments))})}),c}var Td=Qy,Jy=D(function(c,T){return c*T},1),Xv=Jy,e_="Expected a function";function t_(c){if(typeof c!="function")throw new TypeError(e_);return function(){var T=arguments;switch(T.length){case 0:return!c.call(this);case 1:return!c.call(this,T[0]);case 2:return!c.call(this,T[0],T[1]);case 3:return!c.call(this,T[0],T[1],T[2])}return!c.apply(this,T)}}var nd=t_;function r_(c){for(var T,K=[];!(T=c.next()).done;)K.push(T.value);return K}var n_=r_,wd=y(49679),i_="[object Map]",a_="[object Set]",Md=Po.Z?Po.Z.iterator:void 0;function o_(c){if(!c)return[];if((0,Do.Z)(c))return tp(c)?Ws(c):(0,pt.Z)(c);if(Md&&c[Md])return n_(c[Md]());var T=(0,Us.Z)(c),K=T==i_?ff.Z:T==a_?wd.Z:x;return K(c)}var Pd=o_;function s_(){this.__values__===void 0&&(this.__values__=Pd(this.value()));var c=this.__index__>=this.__values__.length,T=c?void 0:this.__values__[this.__index__++];return{done:c,value:T}}var Ld=s_,Yv=y(59641);function u_(c,T){var K=c.length;if(!!K)return T+=T<0?K:0,(0,Qi.Z)(T,K)?c[T]:void 0}var $v=u_;function l_(c,T){return c&&c.length?$v(c,Re(T)):void 0}var Kv=l_;function c_(c){return c=Re(c),(0,Va.Z)(function(T){return $v(T,c)})}var qv=c_;function f_(c,T){return T=(0,zl.Z)(T,c),c=rd(c,T),c==null||delete c[(0,Cu.Z)(Ci(T))]}var Od=f_;function h_(c){return(0,ys.Z)(c)?void 0:c}var p_=h_,d_=1,v_=2,m_=4,g_=qo(function(c,T){var K={};if(c==null)return K;var Ie=!1;T=(0,Ns.Z)(T,function(dr){return dr=(0,zl.Z)(dr,c),Ie||(Ie=dr.length>1),dr}),(0,Bo.Z)(c,Mc(c),K),Ie&&(K=bi(K,d_|v_|m_,p_));for(var At=T.length;At--;)Od(K,T[At]);return K}),Qv=g_;function y_(c,T,K,Ie){if(!(0,Fe.Z)(c))return c;T=(0,zl.Z)(T,c);for(var At=-1,dr=T.length,Qr=dr-1,kn=c;kn!=null&&++At<dr;){var Qn=(0,Cu.Z)(T[At]),Sa=K;if(Qn==="__proto__"||Qn==="constructor"||Qn==="prototype")return c;if(At!=Qr){var fa=kn[Qn];Sa=Ie?Ie(fa,Qn,kn):void 0,Sa===void 0&&(Sa=(0,Fe.Z)(fa)?fa:(0,Qi.Z)(T[At+1])?[]:{})}(0,Vo.Z)(kn,Qn,Sa),kn=kn[Qn]}return c}var ud=y_;function __(c,T,K){for(var Ie=-1,At=T.length,dr={};++Ie<At;){var Qr=T[Ie],kn=(0,zh.Z)(c,Qr);K(kn,Qr)&&ud(dr,(0,zl.Z)(Qr,c),kn)}return dr}var Jv=__;function x_(c,T){if(c==null)return{};var K=(0,Ns.Z)(Mc(c),function(Ie){return[Ie]});return T=(0,ki.Z)(T),Jv(c,K,function(Ie,At){return T(Ie,At[0])})}var Id=x_;function b_(c,T){return Id(c,nd((0,ki.Z)(T)))}var em=b_;function E_(c){return Uc(2,c)}var tm=E_,C_=y(89143);function S_(c,T){var K=c.length;for(c.sort(T);K--;)c[K]=c[K].value;return c}var A_=S_;function T_(c,T){if(c!==T){var K=c!==void 0,Ie=c===null,At=c===c,dr=(0,v.Z)(c),Qr=T!==void 0,kn=T===null,Qn=T===T,Sa=(0,v.Z)(T);if(!kn&&!Sa&&!dr&&c>T||dr&&Qr&&Qn&&!kn&&!Sa||Ie&&Qr&&Qn||!K&&Qn||!At)return 1;if(!Ie&&!dr&&!Sa&&c<T||Sa&&K&&At&&!Ie&&!dr||kn&&K&&At||!Qr&&At||!Qn)return-1}return 0}var rm=T_;function w_(c,T,K){for(var Ie=-1,At=c.criteria,dr=T.criteria,Qr=At.length,kn=K.length;++Ie<Qr;){var Qn=rm(At[Ie],dr[Ie]);if(Qn){if(Ie>=kn)return Qn;var Sa=K[Ie];return Qn*(Sa=="desc"?-1:1)}}return c.index-T.index}var M_=w_;function P_(c,T,K){T.length?T=(0,Ns.Z)(T,function(dr){return(0,ht.Z)(dr)?function(Qr){return(0,zh.Z)(Qr,dr.length===1?dr[0]:dr)}:dr}):T=[$e.Z];var Ie=-1;T=(0,Ns.Z)(T,(0,Fu.Z)(ki.Z));var At=(0,C_.Z)(c,function(dr,Qr,kn){var Qn=(0,Ns.Z)(T,function(Sa){return Sa(dr)});return{criteria:Qn,index:++Ie,value:dr}});return A_(At,function(dr,Qr){return M_(dr,Qr,K)})}var nm=P_;function L_(c,T,K,Ie){return c==null?[]:((0,ht.Z)(T)||(T=T==null?[]:[T]),K=Ie?void 0:K,(0,ht.Z)(K)||(K=K==null?[]:[K]),nm(c,T,K))}var im=L_;function O_(c){return qo(function(T){return T=(0,Ns.Z)(T,(0,Fu.Z)(ki.Z)),(0,Va.Z)(function(K){var Ie=this;return c(T,function(At){return(0,kt.Z)(At,Ie,K)})})})}var Rd=O_,I_=Rd(Ns.Z),am=I_,R_=Va.Z,D_=R_,k_=Math.min,F_=D_(function(c,T){T=T.length==1&&(0,ht.Z)(T[0])?(0,Ns.Z)(T[0],(0,Fu.Z)(ki.Z)):(0,Ns.Z)(ws(T,1),(0,Fu.Z)(ki.Z));var K=T.length;return(0,Va.Z)(function(Ie){for(var At=-1,dr=k_(Ie.length,K);++At<dr;)Ie[At]=T[At].call(this,Ie[At]);return(0,kt.Z)(c,this,Ie)})}),om=F_,B_=Rd(E),sm=B_,um=y(93585),N_=Rd(um.Z),lm=N_,z_=9007199254740991,U_=Math.floor;function Z_(c,T){var K="";if(!c||T<1||T>z_)return K;do T%2&&(K+=c),T=U_(T/2),T&&(c+=c);while(T);return K}var Dd=Z_,cm=y(67726),j_=(0,cm.Z)("length"),G_=j_,fm="\\ud800-\\udfff",V_="\\u0300-\\u036f",H_="\\ufe20-\\ufe2f",W_="\\u20d0-\\u20ff",X_=V_+H_+W_,Y_="\\ufe0e\\ufe0f",$_="["+fm+"]",kd="["+X_+"]",Fd="\\ud83c[\\udffb-\\udfff]",K_="(?:"+kd+"|"+Fd+")",hm="[^"+fm+"]",pm="(?:\\ud83c[\\udde6-\\uddff]){2}",dm="[\\ud800-\\udbff][\\udc00-\\udfff]",q_="\\u200d",vm=K_+"?",mm="["+Y_+"]?",Q_="(?:"+q_+"(?:"+[hm,pm,dm].join("|")+")"+mm+vm+")*",J_=mm+vm+Q_,e1="(?:"+[hm+kd+"?",kd,pm,dm,$_].join("|")+")",gm=RegExp(Fd+"(?="+Fd+")|"+e1+J_,"g");function t1(c){for(var T=gm.lastIndex=0;gm.test(c);)++T;return T}var r1=t1;function n1(c){return Ve(c)?r1(c):G_(c)}var id=n1,i1=Math.ceil;function a1(c,T){T=T===void 0?" ":(0,L.Z)(T);var K=T.length;if(K<2)return K?Dd(T,c):T;var Ie=Dd(T,i1(c/id(T)));return Ve(T)?cl(Ws(Ie),0,c).join(""):Ie.slice(0,c)}var pd=a1,o1=Math.ceil,s1=Math.floor;function u1(c,T,K){c=(0,ko.Z)(c),T=Re(T);var Ie=T?id(c):0;if(!T||Ie>=T)return c;var At=(T-Ie)/2;return pd(s1(At),K)+c+pd(o1(At),K)}var ym=u1;function l1(c,T,K){c=(0,ko.Z)(c),T=Re(T);var Ie=T?id(c):0;return T&&Ie<T?c+pd(T-Ie,K):c}var _m=l1;function c1(c,T,K){c=(0,ko.Z)(c),T=Re(T);var Ie=T?id(c):0;return T&&Ie<T?pd(T-Ie,K)+c:c}var xm=c1,f1=/^\s+/,h1=ir.Z.parseInt;function p1(c,T,K){return K||T==null?T=0:T&&(T=+T),h1((0,ko.Z)(c).replace(f1,""),T||0)}var bm=p1,d1=32,Bd=(0,Va.Z)(function(c,T){var K=Ia(T,gs(Bd));return ia(c,d1,void 0,T,K)});Bd.placeholder={};var Nd=Bd,v1=64,zd=(0,Va.Z)(function(c,T){var K=Ia(T,gs(zd));return ia(c,v1,void 0,T,K)});zd.placeholder={};var Em=zd,m1=ai(function(c,T,K){c[K?0:1].push(T)},function(){return[[],[]]}),Cm=m1;function g1(c,T){return Jv(c,T,function(K,Ie){return(0,Xf.Z)(c,Ie)})}var y1=g1,_1=qo(function(c,T){return c==null?{}:y1(c,T)}),Sm=_1;function x1(c){for(var T,K=this;K instanceof De;){var Ie=Ue(K);Ie.__index__=0,Ie.__values__=void 0,T?At.__wrapped__=Ie:T=Ie;var At=Ie;K=K.__wrapped__}return At.__wrapped__=c,T}var Ud=x1,Am=y(291);function b1(c){return function(T){return c==null?void 0:(0,zh.Z)(c,T)}}var Tm=b1;function E1(c,T,K,Ie){for(var At=K-1,dr=c.length;++At<dr;)if(Ie(c[At],T))return At;return-1}var C1=E1,S1=Array.prototype,wm=S1.splice;function A1(c,T,K,Ie){var At=Ie?C1:Br,dr=-1,Qr=T.length,kn=c;for(c===T&&(T=(0,pt.Z)(T)),K&&(kn=(0,Ns.Z)(c,(0,Fu.Z)(K)));++dr<Qr;)for(var Qn=0,Sa=T[dr],fa=K?K(Sa):Sa;(Qn=At(kn,fa,Qn,Ie))>-1;)kn!==c&&wm.call(kn,Qn,1),wm.call(c,Qn,1);return c}var Zd=A1;function T1(c,T){return c&&c.length&&T&&T.length?Zd(c,T):c}var jd=T1,w1=(0,Va.Z)(jd),Mm=w1;function M1(c,T,K){return c&&c.length&&T&&T.length?Zd(c,T,(0,ki.Z)(K,2)):c}var Pm=M1;function P1(c,T,K){return c&&c.length&&T&&T.length?Zd(c,T,void 0,K):c}var Lm=P1,L1=Array.prototype,O1=L1.splice;function I1(c,T){for(var K=c?T.length:0,Ie=K-1;K--;){var At=T[K];if(K==Ie||At!==dr){var dr=At;(0,Qi.Z)(At)?O1.call(c,At,1):Od(c,At)}}return c}var Om=I1,R1=qo(function(c,T){var K=c==null?0:c.length,Ie=Fa(c,T);return Om(c,(0,Ns.Z)(T,function(At){return(0,Qi.Z)(At,K)?+At:At}).sort(rm)),Ie}),Im=R1,D1=Math.floor,k1=Math.random;function F1(c,T){return c+D1(k1()*(T-c+1))}var Gd=F1,B1=parseFloat,N1=Math.min,z1=Math.random;function U1(c,T,K){if(K&&typeof K!="boolean"&&(0,Zi.Z)(c,T,K)&&(T=K=void 0),K===void 0&&(typeof T=="boolean"?(K=T,T=void 0):typeof c=="boolean"&&(K=c,c=void 0)),c===void 0&&T===void 0?(c=0,T=1):(c=at(c),T===void 0?(T=c,c=0):T=at(T)),c>T){var Ie=c;c=T,T=Ie}if(K||c%1||T%1){var At=z1();return N1(c+At*(T-c+B1("1e-"+((At+"").length-1))),T)}return Gd(c,T)}var Rm=U1,Z1=Math.ceil,j1=Math.max;function G1(c,T,K,Ie){for(var At=-1,dr=j1(Z1((T-c)/(K||1)),0),Qr=Array(dr);dr--;)Qr[Ie?dr:++At]=c,c+=K;return Qr}var V1=G1;function H1(c){return function(T,K,Ie){return Ie&&typeof Ie!="number"&&(0,Zi.Z)(T,K,Ie)&&(K=Ie=void 0),T=at(T),K===void 0?(K=T,T=0):K=at(K),Ie=Ie===void 0?T<K?1:-1:at(Ie),V1(T,K,Ie,c)}}var Dm=H1,W1=Dm(),km=W1,X1=Dm(!0),Fm=X1,Y1=256,$1=qo(function(c,T){return ia(c,Y1,void 0,void 0,void 0,T)}),Bm=$1;function K1(c,T,K,Ie,At){return At(c,function(dr,Qr,kn){K=Ie?(Ie=!1,dr):T(K,dr,Qr,kn)}),K}var Nm=K1;function q1(c,T,K){var Ie=(0,ht.Z)(c)?Au:Nm,At=arguments.length<3;return Ie(c,(0,ki.Z)(T,4),K,At,ti.Z)}var zm=q1;function Q1(c,T,K,Ie){var At=c==null?0:c.length;for(Ie&&At&&(K=c[--At]);At--;)K=T(K,c[At],At,c);return K}var J1=Q1;function ex(c,T,K){var Ie=(0,ht.Z)(c)?J1:Nm,At=arguments.length<3;return Ie(c,(0,ki.Z)(T,4),K,At,ol)}var Um=ex;function tx(c,T){var K=(0,ht.Z)(c)?cr.Z:Yr;return K(c,nd((0,ki.Z)(T,3)))}var Zm=tx;function rx(c,T){var K=[];if(!(c&&c.length))return K;var Ie=-1,At=[],dr=c.length;for(T=(0,ki.Z)(T,3);++Ie<dr;){var Qr=c[Ie];T(Qr,Ie,c)&&(K.push(Qr),At.push(Ie))}return Om(c,At),K}var jm=rx;function nx(c,T,K){return(K?(0,Zi.Z)(c,T,K):T===void 0)?T=1:T=Re(T),Dd((0,ko.Z)(c),T)}var Gm=nx;function ix(){var c=arguments,T=(0,ko.Z)(c[0]);return c.length<3?T:T.replace(c[1],c[2])}var Vm=ix,ax="Expected a function";function ox(c,T){if(typeof c!="function")throw new TypeError(ax);return T=T===void 0?T:Re(T),(0,Va.Z)(c,T)}var Hm=ox;function sx(c,T,K){T=(0,zl.Z)(T,c);var Ie=-1,At=T.length;for(At||(At=1,c=void 0);++Ie<At;){var dr=c==null?void 0:c[(0,Cu.Z)(T[Ie])];dr===void 0&&(Ie=At,dr=K),c=(0,wh.Z)(dr)?dr.call(c):dr}return c}var Wm=sx,ux=Array.prototype,lx=ux.reverse;function cx(c){return c==null?c:lx.call(c)}var dd=cx,fx=pn("round"),Xm=fx;function hx(c){var T=c.length;return T?c[Gd(0,T-1)]:void 0}var Ym=hx;function px(c){return Ym(x(c))}var dx=px;function vx(c){var T=(0,ht.Z)(c)?Ym:dx;return T(c)}var $m=vx;function mx(c,T){var K=-1,Ie=c.length,At=Ie-1;for(T=T===void 0?Ie:T;++K<T;){var dr=Gd(K,At),Qr=c[dr];c[dr]=c[K],c[K]=Qr}return c.length=T,c}var vd=mx;function gx(c,T){return vd((0,pt.Z)(c),Ma(T,0,c.length))}var yx=gx;function _x(c,T){var K=x(c);return vd(K,Ma(T,0,K.length))}var xx=_x;function bx(c,T,K){(K?(0,Zi.Z)(c,T,K):T===void 0)?T=1:T=Re(T);var Ie=(0,ht.Z)(c)?yx:xx;return Ie(c,T)}var Km=bx;function Ex(c,T,K){return c==null?c:ud(c,T,K)}var qm=Ex;function Cx(c,T,K,Ie){return Ie=typeof Ie=="function"?Ie:void 0,c==null?c:ud(c,T,K,Ie)}var Qm=Cx;function Sx(c){return vd((0,pt.Z)(c))}var Ax=Sx;function Tx(c){return vd(x(c))}var Mx=Tx;function Px(c){var T=(0,ht.Z)(c)?Ax:Mx;return T(c)}var Jm=Px,Lx="[object Map]",Ox="[object Set]";function Ix(c){if(c==null)return 0;if((0,Do.Z)(c))return tp(c)?id(c):c.length;var T=(0,Us.Z)(c);return T==Lx||T==Ox?c.size:(0,rv.Z)(c).length}var e0=Ix;function Rx(c,T,K){var Ie=c==null?0:c.length;return Ie?(K&&typeof K!="number"&&(0,Zi.Z)(c,T,K)?(T=0,K=Ie):(T=T==null?0:Re(T),K=K===void 0?Ie:Re(K)),Su(c,T,K)):[]}var t0=Rx,Dx=Yt(function(c,T,K){return c+(K?"_":"")+T.toLowerCase()}),r0=Dx;function kx(c,T){var K;return(0,ti.Z)(c,function(Ie,At,dr){return K=T(Ie,At,dr),!K}),!!K}var Fx=kx;function Bx(c,T,K){var Ie=(0,ht.Z)(c)?um.Z:Fx;return K&&(0,Zi.Z)(c,T,K)&&(T=void 0),Ie(c,(0,ki.Z)(T,3))}var n0=Bx,Nx=(0,Va.Z)(function(c,T){if(c==null)return[];var K=T.length;return K>1&&(0,Zi.Z)(c,T[0],T[1])?T=[]:K>2&&(0,Zi.Z)(T[0],T[1],T[2])&&(T=[T[0]]),nm(c,ws(T,1),[])}),i0=Nx,zx=4294967295,Ux=zx-1,Zx=Math.floor,jx=Math.min;function Gx(c,T,K,Ie){var At=0,dr=c==null?0:c.length;if(dr===0)return 0;T=K(T);for(var Qr=T!==T,kn=T===null,Qn=(0,v.Z)(T),Sa=T===void 0;At<dr;){var fa=Zx((At+dr)/2),La=K(c[fa]),ts=La!==void 0,ms=La===null,du=La===La,_l=(0,v.Z)(La);if(Qr)var Rs=Ie||du;else Sa?Rs=du&&(Ie||ts):kn?Rs=du&&ts&&(Ie||!ms):Qn?Rs=du&&ts&&!ms&&(Ie||!_l):ms||_l?Rs=!1:Rs=Ie?La<=T:La<T;Rs?At=fa+1:dr=fa}return jx(dr,Ux)}var Vd=Gx,Vx=4294967295,Hx=Vx>>>1;function Wx(c,T,K){var Ie=0,At=c==null?Ie:c.length;if(typeof T=="number"&&T===T&&At<=Hx){for(;Ie<At;){var dr=Ie+At>>>1,Qr=c[dr];Qr!==null&&!(0,v.Z)(Qr)&&(K?Qr<=T:Qr<T)?Ie=dr+1:At=dr}return At}return Vd(c,T,$e.Z,K)}var md=Wx;function Xx(c,T){return md(c,T)}var a0=Xx;function Yx(c,T,K){return Vd(c,T,(0,ki.Z)(K,2))}var o0=Yx;function $x(c,T){var K=c==null?0:c.length;if(K){var Ie=md(c,T);if(Ie<K&&(0,no.Z)(c[Ie],T))return Ie}return-1}var s0=$x;function Kx(c,T){return md(c,T,!0)}var u0=Kx;function qx(c,T,K){return Vd(c,T,(0,ki.Z)(K,2),!0)}var l0=qx;function Qx(c,T){var K=c==null?0:c.length;if(K){var Ie=md(c,T,!0)-1;if((0,no.Z)(c[Ie],T))return Ie}return-1}var c0=Qx;function Jx(c,T){for(var K=-1,Ie=c.length,At=0,dr=[];++K<Ie;){var Qr=c[K],kn=T?T(Qr):Qr;if(!K||!(0,no.Z)(kn,Qn)){var Qn=kn;dr[At++]=Qr===0?0:Qr}}return dr}var f0=Jx;function eb(c){return c&&c.length?f0(c):[]}var h0=eb;function tb(c,T){return c&&c.length?f0(c,(0,ki.Z)(T,2)):[]}var p0=tb,rb=4294967295;function nb(c,T,K){return K&&typeof K!="number"&&(0,Zi.Z)(c,T,K)&&(T=K=void 0),K=K===void 0?rb:K>>>0,K?(c=(0,ko.Z)(c),c&&(typeof T=="string"||T!=null&&!fd(T))&&(T=(0,L.Z)(T),!T&&Ve(c))?cl(Ws(c),0,K):c.split(T,K)):[]}var d0=nb,ib="Expected a function",ab=Math.max;function ob(c,T){if(typeof c!="function")throw new TypeError(ib);return T=T==null?0:ab(Re(T),0),(0,Va.Z)(function(K){var Ie=K[T],At=cl(K,0,T);return Ie&&(0,Mo.Z)(At,Ie),(0,kt.Z)(c,this,At)})}var v0=ob,sb=Yt(function(c,T,K){return c+(K?" ":"")+gf(T)}),m0=sb;function ub(c,T,K){return c=(0,ko.Z)(c),K=K==null?0:Ma(Re(K),0,c.length),T=(0,L.Z)(T),c.slice(K,K+T.length)==T}var g0=ub;function lb(){return{}}var y0=lb;function cb(){return""}var _0=cb;function fb(){return!0}var x0=fb,hb=D(function(c,T){return c-T},0),b0=hb;function pb(c){return c&&c.length?Ad(c,$e.Z):0}var E0=pb;function db(c,T){return c&&c.length?Ad(c,(0,ki.Z)(T,2)):0}var C0=db;function vb(c){var T=c==null?0:c.length;return T?Su(c,1,T):[]}var S0=vb;function mb(c,T,K){return c&&c.length?(T=K||T===void 0?1:Re(T),Su(c,0,T<0?0:T)):[]}var A0=mb;function gb(c,T,K){var Ie=c==null?0:c.length;return Ie?(T=K||T===void 0?1:Re(T),T=Ie-T,Su(c,T<0?0:T,Ie)):[]}var T0=gb;function yb(c,T){return c&&c.length?jt(c,(0,ki.Z)(T,3),!1,!0):[]}var w0=yb;function _b(c,T){return c&&c.length?jt(c,(0,ki.Z)(T,3)):[]}var M0=_b;function xb(c,T){return T(c),c}var P0=xb,L0=Object.prototype,bb=L0.hasOwnProperty;function Eb(c,T,K,Ie){return c===void 0||(0,no.Z)(c,L0[K])&&!bb.call(Ie,K)?T:c}var O0=Eb,Cb={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Sb(c){return"\\"+Cb[c]}var Ab=Sb,Tb=/<%=([\s\S]+?)%>/g,I0=Tb,wb=/<%-([\s\S]+?)%>/g,Mb=wb,Pb=/<%([\s\S]+?)%>/g,Lb=Pb,Ob={escape:Mb,evaluate:Lb,interpolate:I0,variable:"",imports:{_:{escape:Ip}}},gd=Ob,Ib="Invalid `variable` option passed into `_.template`",Rb=/\b__p \+= '';/g,Db=/\b(__p \+=) '' \+/g,kb=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Fb=/[()=,{}\[\]\/\s]/,Bb=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yd=/($^)/,Nb=/['\n\r\u2028\u2029\\]/g,zb=Object.prototype,R0=zb.hasOwnProperty;function Ub(c,T,K){var Ie=gd.imports._.templateSettings||gd;K&&(0,Zi.Z)(c,T,K)&&(T=void 0),c=(0,ko.Z)(c),T=En({},T,Ie,O0);var At=En({},T.imports,Ie.imports,O0),dr=(0,g.Z)(At),Qr=f(At,dr),kn,Qn,Sa=0,fa=T.interpolate||yd,La="__p += '",ts=RegExp((T.escape||yd).source+"|"+fa.source+"|"+(fa===I0?Bb:yd).source+"|"+(T.evaluate||yd).source+"|$","g"),ms=R0.call(T,"sourceURL")?"//# sourceURL="+(T.sourceURL+"").replace(/\s/g," ")+`
`:"";c.replace(ts,function(Rs,Ql,Jl,Up,Zp,xd){return Jl||(Jl=Up),La+=c.slice(Sa,xd).replace(Nb,Ab),Ql&&(kn=!0,La+=`' +
__e(`+Ql+`) +
'`),Zp&&(Qn=!0,La+=`';
`+Zp+`;
__p += '`),Jl&&(La+=`' +
((__t = (`+Jl+`)) == null ? '' : __t) +
'`),Sa=xd+Rs.length,Rs}),La+=`';
`;var du=R0.call(T,"variable")&&T.variable;if(!du)La=`with (obj) {
`+La+`
}
`;else if(Fb.test(du))throw new Error(Ib);La=(Qn?La.replace(Rb,""):La).replace(Db,"$1").replace(kb,"$1;"),La="function("+(du||"obj")+`) {
`+(du?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(kn?", __e = _.escape":"")+(Qn?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+La+`return __p
}`;var _l=hf(function(){return Function(dr,ms+"return "+La).apply(void 0,Qr)});if(_l.source=La,To(_l))throw _l;return _l}var D0=Ub,k0=y(58848);function Zb(c,T){return T(c)}var ad=Zb,F0=y(47754),jb=9007199254740991,Hd=4294967295,Gb=Math.min;function Vb(c,T){if(c=Re(c),c<1||c>jb)return[];var K=Hd,Ie=Gb(c,Hd);T=(0,os.Z)(T),c-=Hd;for(var At=(0,F0.Z)(Ie,T);++K<c;)T(K);return At}var B0=Vb;function Hb(){return this}var Wd=Hb;function Wb(c,T){var K=c;return K instanceof mt&&(K=K.value()),Au(T,function(Ie,At){return At.func.apply(At.thisArg,(0,Mo.Z)([Ie],At.args))},K)}var N0=Wb;function Xb(){return N0(this.__wrapped__,this.__actions__)}var Yp=Xb;function Yb(c){return(0,ko.Z)(c).toLowerCase()}var z0=Yb,$b=y(36427);function Kb(c){return(0,ht.Z)(c)?(0,Ns.Z)(c,Cu.Z):(0,v.Z)(c)?[c]:(0,pt.Z)((0,$b.Z)((0,ko.Z)(c)))}var U0=Kb,Z0=y(89900),j0=9007199254740991;function qb(c){return c?Ma(Re(c),-j0,j0):c===0?c:0}var G0=qb;function Qb(c){return(0,ko.Z)(c).toUpperCase()}var V0=Qb;function Jb(c,T,K){var Ie=(0,ht.Z)(c),At=Ie||(0,lh.Z)(c)||(0,cd.Z)(c);if(T=(0,ki.Z)(T,4),K==null){var dr=c&&c.constructor;At?K=Ie?new dr:[]:(0,Fe.Z)(c)?K=(0,wh.Z)(dr)?(0,Ce.Z)((0,zs.Z)(c)):{}:K={}}return(At?je.Z:Wi.Z)(c,function(Qr,kn,Qn){return T(K,Qr,kn,Qn)}),K}var H0=Jb,e2=y(47408);function t2(c,T){for(var K=c.length;K--&&Br(T,c[K],0)>-1;);return K}var W0=t2;function r2(c,T){for(var K=-1,Ie=c.length;++K<Ie&&Br(T,c[K],0)>-1;);return K}var X0=r2;function n2(c,T,K){if(c=(0,ko.Z)(c),c&&(K||T===void 0))return(0,e2.Z)(c);if(!c||!(T=(0,L.Z)(T)))return c;var Ie=Ws(c),At=Ws(T),dr=X0(Ie,At),Qr=W0(Ie,At)+1;return cl(Ie,dr,Qr).join("")}var Y0=n2,i2=y(51257);function a2(c,T,K){if(c=(0,ko.Z)(c),c&&(K||T===void 0))return c.slice(0,(0,i2.Z)(c)+1);if(!c||!(T=(0,L.Z)(T)))return c;var Ie=Ws(c),At=W0(Ie,Ws(T))+1;return cl(Ie,0,At).join("")}var $0=a2,o2=/^\s+/;function s2(c,T,K){if(c=(0,ko.Z)(c),c&&(K||T===void 0))return c.replace(o2,"");if(!c||!(T=(0,L.Z)(T)))return c;var Ie=Ws(c),At=X0(Ie,Ws(T));return cl(Ie,At).join("")}var K0=s2,u2=30,l2="...",c2=/\w*$/;function f2(c,T){var K=u2,Ie=l2;if((0,Fe.Z)(T)){var At="separator"in T?T.separator:At;K="length"in T?Re(T.length):K,Ie="omission"in T?(0,L.Z)(T.omission):Ie}c=(0,ko.Z)(c);var dr=c.length;if(Ve(c)){var Qr=Ws(c);dr=Qr.length}if(K>=dr)return c;var kn=K-id(Ie);if(kn<1)return Ie;var Qn=Qr?cl(Qr,0,kn).join(""):c.slice(0,kn);if(At===void 0)return Qn+Ie;if(Qr&&(kn+=Qn.length-kn),fd(At)){if(c.slice(kn).search(At)){var Sa,fa=Qn;for(At.global||(At=RegExp(At.source,(0,ko.Z)(c2.exec(At))+"g")),At.lastIndex=0;Sa=At.exec(fa);)var La=Sa.index;Qn=Qn.slice(0,La===void 0?kn:La)}}else if(c.indexOf((0,L.Z)(At),kn)!=kn){var ts=Qn.lastIndexOf(At);ts>-1&&(Qn=Qn.slice(0,ts))}return Qn+Ie}var q0=f2;function h2(c){return Yo(c,1)}var Q0=h2,p2={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},d2=Tl(p2),v2=d2,J0=/&(?:amp|lt|gt|quot|#39);/g,m2=RegExp(J0.source);function g2(c){return c=(0,ko.Z)(c),c&&m2.test(c)?c.replace(J0,v2):c}var eg=g2,Xd=y(81962),y2=1/0,_2=Xd.Z&&1/(0,wd.Z)(new Xd.Z([,-0]))[1]==y2?function(c){return new Xd.Z(c)}:Cr,x2=_2,b2=200;function E2(c,T,K){var Ie=-1,At=Tn,dr=c.length,Qr=!0,kn=[],Qn=kn;if(K)Qr=!1,At=Nu;else if(dr>=b2){var Sa=T?null:x2(c);if(Sa)return(0,wd.Z)(Sa);Qr=!1,At=Za.Z,Qn=new Bu.Z}else Qn=T?[]:kn;e:for(;++Ie<dr;){var fa=c[Ie],La=T?T(fa):fa;if(fa=K||fa!==0?fa:0,Qr&&La===La){for(var ts=Qn.length;ts--;)if(Qn[ts]===La)continue e;T&&Qn.push(La),kn.push(fa)}else At(Qn,La,K)||(Qn!==kn&&Qn.push(La),kn.push(fa))}return kn}var zp=E2,C2=(0,Va.Z)(function(c){return zp(ws(c,1,Ks.Z,!0))}),tg=C2,S2=(0,Va.Z)(function(c){var T=Ci(c);return(0,Ks.Z)(T)&&(T=void 0),zp(ws(c,1,Ks.Z,!0),(0,ki.Z)(T,2))}),rg=S2,A2=(0,Va.Z)(function(c){var T=Ci(c);return T=typeof T=="function"?T:void 0,zp(ws(c,1,Ks.Z,!0),void 0,T)}),ng=A2;function T2(c){return c&&c.length?zp(c):[]}var ig=T2;function w2(c,T){return c&&c.length?zp(c,(0,ki.Z)(T,2)):[]}var ag=w2;function M2(c,T){return T=typeof T=="function"?T:void 0,c&&c.length?zp(c,void 0,T):[]}var og=M2,P2=0;function L2(c){var T=++P2;return(0,ko.Z)(c)+T}var sg=L2;function O2(c,T){return c==null?!0:Od(c,T)}var ug=O2,I2=Math.max;function R2(c){if(!(c&&c.length))return[];var T=0;return c=(0,cr.Z)(c,function(K){if((0,Ks.Z)(K))return T=I2(K.length,T),!0}),(0,F0.Z)(T,function(K){return(0,Ns.Z)(c,(0,cm.Z)(K))})}var _d=R2;function D2(c,T){if(!(c&&c.length))return[];var K=_d(c);return T==null?K:(0,Ns.Z)(K,function(Ie){return(0,kt.Z)(T,void 0,Ie)})}var Yd=D2;function k2(c,T,K,Ie){return ud(c,T,K((0,zh.Z)(c,T)),Ie)}var lg=k2;function F2(c,T,K){return c==null?c:lg(c,T,(0,os.Z)(K))}var cg=F2;function B2(c,T,K,Ie){return Ie=typeof Ie=="function"?Ie:void 0,c==null?c:lg(c,T,(0,os.Z)(K),Ie)}var fg=B2,N2=Yt(function(c,T,K){return c+(K?" ":"")+T.toUpperCase()}),hg=N2;function z2(c){return c==null?[]:f(c,(0,Pt.Z)(c))}var pg=z2,U2=(0,Va.Z)(function(c,T){return(0,Ks.Z)(c)?Os(c,T):[]}),dg=U2;function Z2(c,T){return Nd((0,os.Z)(T),c)}var vg=Z2,j2=qo(function(c){var T=c.length,K=T?c[0]:0,Ie=this.__wrapped__,At=function(dr){return Fa(dr,c)};return T>1||this.__actions__.length||!(Ie instanceof mt)||!(0,Qi.Z)(K)?this.thru(At):(Ie=Ie.slice(K,+K+(T?1:0)),Ie.__actions__.push({func:ad,args:[At],thisArg:void 0}),new J(Ie,this.__chain__).thru(function(dr){return T&&!dr.length&&dr.push(void 0),dr}))}),mg=j2;function G2(){return Si(this)}var gg=G2;function V2(){var c=this.__wrapped__;if(c instanceof mt){var T=c;return this.__actions__.length&&(T=new mt(this)),T=T.reverse(),T.__actions__.push({func:ad,args:[dd],thisArg:void 0}),new J(T,this.__chain__)}return this.thru(dd)}var yg=V2;function H2(c,T,K){var Ie=c.length;if(Ie<2)return Ie?zp(c[0]):[];for(var At=-1,dr=Array(Ie);++At<Ie;)for(var Qr=c[At],kn=-1;++kn<Ie;)kn!=At&&(dr[At]=Os(dr[At]||Qr,c[kn],T,K));return zp(ws(dr,1),T,K)}var $d=H2,W2=(0,Va.Z)(function(c){return $d((0,cr.Z)(c,Ks.Z))}),_g=W2,X2=(0,Va.Z)(function(c){var T=Ci(c);return(0,Ks.Z)(T)&&(T=void 0),$d((0,cr.Z)(c,Ks.Z),(0,ki.Z)(T,2))}),xg=X2,Y2=(0,Va.Z)(function(c){var T=Ci(c);return T=typeof T=="function"?T:void 0,$d((0,cr.Z)(c,Ks.Z),void 0,T)}),bg=Y2,$2=(0,Va.Z)(_d),Eg=$2;function K2(c,T,K){for(var Ie=-1,At=c.length,dr=T.length,Qr={};++Ie<At;){var kn=Ie<dr?T[Ie]:void 0;K(Qr,c[Ie],kn)}return Qr}var Cg=K2;function q2(c,T){return Cg(c||[],T||[],Vo.Z)}var Sg=q2;function Q2(c,T){return Cg(c||[],T||[],ud)}var Ag=Q2,J2=(0,Va.Z)(function(c){var T=c.length,K=T>1?c[T-1]:void 0;return K=typeof K=="function"?(c.pop(),K):void 0,Yd(c,K)}),Tg=J2,so={chunk:Pi,compact:fh,concat:Eh,difference:sn,differenceBy:Dt,differenceWith:yr,drop:ar,dropRight:Rt,dropRightWhile:qr,dropWhile:yi,fill:br,findIndex:Fi,findLastIndex:Is,first:Wu,flatten:$u,flattenDeep:Nl,flattenDepth:Pu,fromPairs:sp,head:Wu,indexOf:oe,initial:Be,intersection:Hn,intersectionBy:ni,intersectionWith:qi,join:Sv,last:Ci,lastIndexOf:wv,nth:Kv,pull:Mm,pullAll:jd,pullAllBy:Pm,pullAllWith:Lm,pullAt:Im,remove:jm,reverse:dd,slice:t0,sortedIndex:a0,sortedIndexBy:o0,sortedIndexOf:s0,sortedLastIndex:u0,sortedLastIndexBy:l0,sortedLastIndexOf:c0,sortedUniq:h0,sortedUniqBy:p0,tail:S0,take:A0,takeRight:T0,takeRightWhile:w0,takeWhile:M0,union:tg,unionBy:rg,unionWith:ng,uniq:ig,uniqBy:ag,uniqWith:og,unzip:_d,unzipWith:Yd,without:dg,xor:_g,xorBy:xg,xorWith:bg,zip:Eg,zipObject:Sg,zipObjectDeep:Ag,zipWith:Tg},Yu={countBy:xi,each:gi.Z,eachRight:Sf,every:be,filter:vn,find:Ni,findLast:pu,flatMap:_c,flatMapDeep:Go,flatMapDepth:Wo,forEach:gi.Z,forEachRight:Sf,groupBy:ep,includes:S,invokeMap:Xp,keyBy:Tv,map:gl.Z,orderBy:im,partition:Cm,reduce:zm,reduceRight:Um,reject:Zm,sample:$m,sampleSize:Km,shuffle:Jm,size:e0,some:n0,sortBy:i0},eE={now:Yv.Z},Bc={after:fe,ary:Yo,before:Uc,bind:Ul,bindKey:ef,curry:Cn,curryRight:Ti,debounce:qn.Z,defer:kl,delay:ho,flip:hh,memoize:Zv.Z,negate:nd,once:tm,overArgs:om,partial:Nd,partialRight:Em,rearg:Bm,rest:Hm,spread:v0,throttle:k0.Z,unary:Q0,wrap:vg},Fo={castArray:Ar,clone:Qa,cloneDeep:_o,cloneDeepWith:ru,cloneWith:vl,conformsTo:yn,eq:no.Z,gt:Tp,gte:pp,isArguments:go.Z,isArray:ht.Z,isArrayBuffer:Uu,isArrayLike:Do.Z,isArrayLikeObject:Ks.Z,isBoolean:vp,isBuffer:lh.Z,isDate:ev,isElement:tv,isEmpty:nv,isEqual:av,isEqualWith:ov,isError:To,isFinite:sv,isFunction:wh.Z,isInteger:bd,isLength:uv.Z,isMap:Df,isMatch:fv,isMatchWith:hv,isNaN:pv,isNative:dv,isNil:vv,isNull:mv,isNumber:Ed,isObject:Fe.Z,isObjectLike:ze.Z,isPlainObject:ys.Z,isRegExp:fd,isSafeInteger:_v,isSet:Qc,isString:tp,isSymbol:v.Z,isTypedArray:cd.Z,isUndefined:xv.Z,isWeakMap:bv,isWeakSet:Ev,lt:Lv,lte:Ov,toArray:Pd,toFinite:at,toInteger:Re,toLength:ot,toNumber:N.Z,toPlainObject:Z0.Z,toSafeInteger:G0,toString:ko.Z},gh={add:V,ceil:Zn,divide:tn,floor:th,max:Fv,maxBy:Bv,mean:zv,meanBy:Uv,min:Hv,minBy:Wv,multiply:Xv,round:Xm,subtract:b0,sum:E0,sumBy:C0},Kd={clamp:Ea,inRange:Fp,random:Rm},es={assign:tt,assignIn:Fr,assignInWith:En,assignWith:na,at:Ec,create:fi,defaults:Xa,defaultsDeep:bs,entries:Xh,entriesIn:Ih,extend:Fr,extendWith:En,findKey:Eo,findLastKey:xu,forIn:Th,forInRight:jh,forOwn:qh,forOwnRight:kh,functions:Ap,functionsIn:lp,get:ka.Z,has:Mh,hasIn:Xf.Z,invert:co,invertBy:Yf,invoke:dh,keys:g.Z,keysIn:Pt.Z,mapKeys:Iv,mapValues:Rv,merge:jv.Z,mergeWith:Lo,omit:Qv,omitBy:em,pick:Sm,pickBy:Id,result:Wm,set:qm,setWith:Qm,toPairs:Xh,toPairsIn:Ih,transform:H0,unset:ug,update:cg,updateWith:fg,values:x,valuesIn:pg},mp={at:mg,chain:Si,commit:Vh,lodash:pe,next:Ld,plant:Ud,reverse:yg,tap:P0,thru:ad,toIterator:Wd,toJSON:Yp,value:Yp,valueOf:Yp,wrapperChain:gg},bu={camelCase:Vt,capitalize:Al,deburr:Xs,endsWith:Ff,escape:Ip,escapeRegExp:s,kebabCase:Av,lowerCase:Mv,lowerFirst:Pv,pad:ym,padEnd:_m,padStart:xm,parseInt:bm,repeat:Gm,replace:Vm,snakeCase:r0,split:d0,startCase:m0,startsWith:g0,template:D0,templateSettings:gd,toLower:z0,toUpper:V0,trim:Y0,trimEnd:$0,trimStart:K0,truncate:q0,unescape:eg,upperCase:hg,upperFirst:gf,words:xt},Iu={attempt:hf,bindAll:nc,cond:Ys,conforms:Pn,constant:In.Z,defaultTo:Ri,flow:ip,flowRight:ap,identity:$e.Z,iteratee:Cv,matches:Dv,matchesProperty:kv,method:Gv,methodOf:Vv,mixin:Td,noop:Cr,nthArg:qv,over:am,overEvery:sm,overSome:lm,property:Am.Z,propertyOf:Tm,range:km,rangeRight:Fm,stubArray:yu.Z,stubFalse:Cd.Z,stubObject:y0,stubString:_0,stubTrue:x0,times:B0,toPath:U0,uniqueId:sg};function tE(){var c=new mt(this.__wrapped__);return c.__actions__=(0,pt.Z)(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=(0,pt.Z)(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=(0,pt.Z)(this.__views__),c}var rE=tE;function nE(){if(this.__filtered__){var c=new mt(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}var iE=nE,aE=Math.max,oE=Math.min;function sE(c,T,K){for(var Ie=-1,At=K.length;++Ie<At;){var dr=K[Ie],Qr=dr.size;switch(dr.type){case"drop":c+=Qr;break;case"dropRight":T-=Qr;break;case"take":T=oE(T,c+Qr);break;case"takeRight":c=aE(c,T-Qr);break}}return{start:c,end:T}}var uE=sE,lE=1,cE=2,fE=Math.min;function hE(){var c=this.__wrapped__.value(),T=this.__dir__,K=(0,ht.Z)(c),Ie=T<0,At=K?c.length:0,dr=uE(0,At,this.__views__),Qr=dr.start,kn=dr.end,Qn=kn-Qr,Sa=Ie?kn:Qr-1,fa=this.__iteratees__,La=fa.length,ts=0,ms=fE(Qn,this.__takeCount__);if(!K||!Ie&&At==Qn&&ms==Qn)return N0(c,this.__actions__);var du=[];e:for(;Qn--&&ts<ms;){Sa+=T;for(var _l=-1,Rs=c[Sa];++_l<La;){var Ql=fa[_l],Jl=Ql.iteratee,Up=Ql.type,Zp=Jl(Rs);if(Up==cE)Rs=Zp;else if(!Zp){if(Up==lE)continue e;break e}}du[ts++]=Rs}return du}var pE=hE;/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var dE="4.17.21",vE=2,mE=1,gE=3,wg=4294967295,yE=Array.prototype,_E=Object.prototype,Mg=_E.hasOwnProperty,Pg=Po.Z?Po.Z.iterator:void 0,xE=Math.max,Lg=Math.min,qd=function(c){return function(T,K,Ie){if(Ie==null){var At=(0,Fe.Z)(K),dr=At&&(0,g.Z)(K),Qr=dr&&dr.length&&Qh(K,dr);(Qr?Qr.length:At)||(Ie=K,K=T,T=this)}return c(T,K,Ie)}}(Td);pe.after=Bc.after,pe.ary=Bc.ary,pe.assign=es.assign,pe.assignIn=es.assignIn,pe.assignInWith=es.assignInWith,pe.assignWith=es.assignWith,pe.at=es.at,pe.before=Bc.before,pe.bind=Bc.bind,pe.bindAll=Iu.bindAll,pe.bindKey=Bc.bindKey,pe.castArray=Fo.castArray,pe.chain=mp.chain,pe.chunk=so.chunk,pe.compact=so.compact,pe.concat=so.concat,pe.cond=Iu.cond,pe.conforms=Iu.conforms,pe.constant=Iu.constant,pe.countBy=Yu.countBy,pe.create=es.create,pe.curry=Bc.curry,pe.curryRight=Bc.curryRight,pe.debounce=Bc.debounce,pe.defaults=es.defaults,pe.defaultsDeep=es.defaultsDeep,pe.defer=Bc.defer,pe.delay=Bc.delay,pe.difference=so.difference,pe.differenceBy=so.differenceBy,pe.differenceWith=so.differenceWith,pe.drop=so.drop,pe.dropRight=so.dropRight,pe.dropRightWhile=so.dropRightWhile,pe.dropWhile=so.dropWhile,pe.fill=so.fill,pe.filter=Yu.filter,pe.flatMap=Yu.flatMap,pe.flatMapDeep=Yu.flatMapDeep,pe.flatMapDepth=Yu.flatMapDepth,pe.flatten=so.flatten,pe.flattenDeep=so.flattenDeep,pe.flattenDepth=so.flattenDepth,pe.flip=Bc.flip,pe.flow=Iu.flow,pe.flowRight=Iu.flowRight,pe.fromPairs=so.fromPairs,pe.functions=es.functions,pe.functionsIn=es.functionsIn,pe.groupBy=Yu.groupBy,pe.initial=so.initial,pe.intersection=so.intersection,pe.intersectionBy=so.intersectionBy,pe.intersectionWith=so.intersectionWith,pe.invert=es.invert,pe.invertBy=es.invertBy,pe.invokeMap=Yu.invokeMap,pe.iteratee=Iu.iteratee,pe.keyBy=Yu.keyBy,pe.keys=g.Z,pe.keysIn=es.keysIn,pe.map=Yu.map,pe.mapKeys=es.mapKeys,pe.mapValues=es.mapValues,pe.matches=Iu.matches,pe.matchesProperty=Iu.matchesProperty,pe.memoize=Bc.memoize,pe.merge=es.merge,pe.mergeWith=es.mergeWith,pe.method=Iu.method,pe.methodOf=Iu.methodOf,pe.mixin=qd,pe.negate=nd,pe.nthArg=Iu.nthArg,pe.omit=es.omit,pe.omitBy=es.omitBy,pe.once=Bc.once,pe.orderBy=Yu.orderBy,pe.over=Iu.over,pe.overArgs=Bc.overArgs,pe.overEvery=Iu.overEvery,pe.overSome=Iu.overSome,pe.partial=Bc.partial,pe.partialRight=Bc.partialRight,pe.partition=Yu.partition,pe.pick=es.pick,pe.pickBy=es.pickBy,pe.property=Iu.property,pe.propertyOf=Iu.propertyOf,pe.pull=so.pull,pe.pullAll=so.pullAll,pe.pullAllBy=so.pullAllBy,pe.pullAllWith=so.pullAllWith,pe.pullAt=so.pullAt,pe.range=Iu.range,pe.rangeRight=Iu.rangeRight,pe.rearg=Bc.rearg,pe.reject=Yu.reject,pe.remove=so.remove,pe.rest=Bc.rest,pe.reverse=so.reverse,pe.sampleSize=Yu.sampleSize,pe.set=es.set,pe.setWith=es.setWith,pe.shuffle=Yu.shuffle,pe.slice=so.slice,pe.sortBy=Yu.sortBy,pe.sortedUniq=so.sortedUniq,pe.sortedUniqBy=so.sortedUniqBy,pe.split=bu.split,pe.spread=Bc.spread,pe.tail=so.tail,pe.take=so.take,pe.takeRight=so.takeRight,pe.takeRightWhile=so.takeRightWhile,pe.takeWhile=so.takeWhile,pe.tap=mp.tap,pe.throttle=Bc.throttle,pe.thru=ad,pe.toArray=Fo.toArray,pe.toPairs=es.toPairs,pe.toPairsIn=es.toPairsIn,pe.toPath=Iu.toPath,pe.toPlainObject=Fo.toPlainObject,pe.transform=es.transform,pe.unary=Bc.unary,pe.union=so.union,pe.unionBy=so.unionBy,pe.unionWith=so.unionWith,pe.uniq=so.uniq,pe.uniqBy=so.uniqBy,pe.uniqWith=so.uniqWith,pe.unset=es.unset,pe.unzip=so.unzip,pe.unzipWith=so.unzipWith,pe.update=es.update,pe.updateWith=es.updateWith,pe.values=es.values,pe.valuesIn=es.valuesIn,pe.without=so.without,pe.words=bu.words,pe.wrap=Bc.wrap,pe.xor=so.xor,pe.xorBy=so.xorBy,pe.xorWith=so.xorWith,pe.zip=so.zip,pe.zipObject=so.zipObject,pe.zipObjectDeep=so.zipObjectDeep,pe.zipWith=so.zipWith,pe.entries=es.toPairs,pe.entriesIn=es.toPairsIn,pe.extend=es.assignIn,pe.extendWith=es.assignInWith,qd(pe,pe),pe.add=gh.add,pe.attempt=Iu.attempt,pe.camelCase=bu.camelCase,pe.capitalize=bu.capitalize,pe.ceil=gh.ceil,pe.clamp=Kd.clamp,pe.clone=Fo.clone,pe.cloneDeep=Fo.cloneDeep,pe.cloneDeepWith=Fo.cloneDeepWith,pe.cloneWith=Fo.cloneWith,pe.conformsTo=Fo.conformsTo,pe.deburr=bu.deburr,pe.defaultTo=Iu.defaultTo,pe.divide=gh.divide,pe.endsWith=bu.endsWith,pe.eq=Fo.eq,pe.escape=bu.escape,pe.escapeRegExp=bu.escapeRegExp,pe.every=Yu.every,pe.find=Yu.find,pe.findIndex=so.findIndex,pe.findKey=es.findKey,pe.findLast=Yu.findLast,pe.findLastIndex=so.findLastIndex,pe.findLastKey=es.findLastKey,pe.floor=gh.floor,pe.forEach=Yu.forEach,pe.forEachRight=Yu.forEachRight,pe.forIn=es.forIn,pe.forInRight=es.forInRight,pe.forOwn=es.forOwn,pe.forOwnRight=es.forOwnRight,pe.get=es.get,pe.gt=Fo.gt,pe.gte=Fo.gte,pe.has=es.has,pe.hasIn=es.hasIn,pe.head=so.head,pe.identity=$e.Z,pe.includes=Yu.includes,pe.indexOf=so.indexOf,pe.inRange=Kd.inRange,pe.invoke=es.invoke,pe.isArguments=Fo.isArguments,pe.isArray=ht.Z,pe.isArrayBuffer=Fo.isArrayBuffer,pe.isArrayLike=Fo.isArrayLike,pe.isArrayLikeObject=Fo.isArrayLikeObject,pe.isBoolean=Fo.isBoolean,pe.isBuffer=Fo.isBuffer,pe.isDate=Fo.isDate,pe.isElement=Fo.isElement,pe.isEmpty=Fo.isEmpty,pe.isEqual=Fo.isEqual,pe.isEqualWith=Fo.isEqualWith,pe.isError=Fo.isError,pe.isFinite=Fo.isFinite,pe.isFunction=Fo.isFunction,pe.isInteger=Fo.isInteger,pe.isLength=Fo.isLength,pe.isMap=Fo.isMap,pe.isMatch=Fo.isMatch,pe.isMatchWith=Fo.isMatchWith,pe.isNaN=Fo.isNaN,pe.isNative=Fo.isNative,pe.isNil=Fo.isNil,pe.isNull=Fo.isNull,pe.isNumber=Fo.isNumber,pe.isObject=Fe.Z,pe.isObjectLike=Fo.isObjectLike,pe.isPlainObject=Fo.isPlainObject,pe.isRegExp=Fo.isRegExp,pe.isSafeInteger=Fo.isSafeInteger,pe.isSet=Fo.isSet,pe.isString=Fo.isString,pe.isSymbol=Fo.isSymbol,pe.isTypedArray=Fo.isTypedArray,pe.isUndefined=Fo.isUndefined,pe.isWeakMap=Fo.isWeakMap,pe.isWeakSet=Fo.isWeakSet,pe.join=so.join,pe.kebabCase=bu.kebabCase,pe.last=Ci,pe.lastIndexOf=so.lastIndexOf,pe.lowerCase=bu.lowerCase,pe.lowerFirst=bu.lowerFirst,pe.lt=Fo.lt,pe.lte=Fo.lte,pe.max=gh.max,pe.maxBy=gh.maxBy,pe.mean=gh.mean,pe.meanBy=gh.meanBy,pe.min=gh.min,pe.minBy=gh.minBy,pe.stubArray=Iu.stubArray,pe.stubFalse=Iu.stubFalse,pe.stubObject=Iu.stubObject,pe.stubString=Iu.stubString,pe.stubTrue=Iu.stubTrue,pe.multiply=gh.multiply,pe.nth=so.nth,pe.noop=Iu.noop,pe.now=eE.now,pe.pad=bu.pad,pe.padEnd=bu.padEnd,pe.padStart=bu.padStart,pe.parseInt=bu.parseInt,pe.random=Kd.random,pe.reduce=Yu.reduce,pe.reduceRight=Yu.reduceRight,pe.repeat=bu.repeat,pe.replace=bu.replace,pe.result=es.result,pe.round=gh.round,pe.sample=Yu.sample,pe.size=Yu.size,pe.snakeCase=bu.snakeCase,pe.some=Yu.some,pe.sortedIndex=so.sortedIndex,pe.sortedIndexBy=so.sortedIndexBy,pe.sortedIndexOf=so.sortedIndexOf,pe.sortedLastIndex=so.sortedLastIndex,pe.sortedLastIndexBy=so.sortedLastIndexBy,pe.sortedLastIndexOf=so.sortedLastIndexOf,pe.startCase=bu.startCase,pe.startsWith=bu.startsWith,pe.subtract=gh.subtract,pe.sum=gh.sum,pe.sumBy=gh.sumBy,pe.template=bu.template,pe.times=Iu.times,pe.toFinite=Fo.toFinite,pe.toInteger=Re,pe.toLength=Fo.toLength,pe.toLower=bu.toLower,pe.toNumber=Fo.toNumber,pe.toSafeInteger=Fo.toSafeInteger,pe.toString=Fo.toString,pe.toUpper=bu.toUpper,pe.trim=bu.trim,pe.trimEnd=bu.trimEnd,pe.trimStart=bu.trimStart,pe.truncate=bu.truncate,pe.unescape=bu.unescape,pe.uniqueId=Iu.uniqueId,pe.upperCase=bu.upperCase,pe.upperFirst=bu.upperFirst,pe.each=Yu.forEach,pe.eachRight=Yu.forEachRight,pe.first=so.head,qd(pe,function(){var c={};return(0,Wi.Z)(pe,function(T,K){Mg.call(pe.prototype,K)||(c[K]=T)}),c}(),{chain:!1}),pe.VERSION=dE,(pe.templateSettings=bu.templateSettings).imports._=pe,(0,je.Z)(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){pe[c].placeholder=pe}),(0,je.Z)(["drop","take"],function(c,T){mt.prototype[c]=function(K){K=K===void 0?1:xE(Re(K),0);var Ie=this.__filtered__&&!T?new mt(this):this.clone();return Ie.__filtered__?Ie.__takeCount__=Lg(K,Ie.__takeCount__):Ie.__views__.push({size:Lg(K,wg),type:c+(Ie.__dir__<0?"Right":"")}),Ie},mt.prototype[c+"Right"]=function(K){return this.reverse()[c](K).reverse()}}),(0,je.Z)(["filter","map","takeWhile"],function(c,T){var K=T+1,Ie=K==mE||K==gE;mt.prototype[c]=function(At){var dr=this.clone();return dr.__iteratees__.push({iteratee:(0,ki.Z)(At,3),type:K}),dr.__filtered__=dr.__filtered__||Ie,dr}}),(0,je.Z)(["head","last"],function(c,T){var K="take"+(T?"Right":"");mt.prototype[c]=function(){return this[K](1).value()[0]}}),(0,je.Z)(["initial","tail"],function(c,T){var K="drop"+(T?"":"Right");mt.prototype[c]=function(){return this.__filtered__?new mt(this):this[K](1)}}),mt.prototype.compact=function(){return this.filter($e.Z)},mt.prototype.find=function(c){return this.filter(c).head()},mt.prototype.findLast=function(c){return this.reverse().find(c)},mt.prototype.invokeMap=(0,Va.Z)(function(c,T){return typeof c=="function"?new mt(this):this.map(function(K){return Lp(K,c,T)})}),mt.prototype.reject=function(c){return this.filter(nd((0,ki.Z)(c)))},mt.prototype.slice=function(c,T){c=Re(c);var K=this;return K.__filtered__&&(c>0||T<0)?new mt(K):(c<0?K=K.takeRight(-c):c&&(K=K.drop(c)),T!==void 0&&(T=Re(T),K=T<0?K.dropRight(-T):K.take(T-c)),K)},mt.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},mt.prototype.toArray=function(){return this.take(wg)},(0,Wi.Z)(mt.prototype,function(c,T){var K=/^(?:filter|find|map|reject)|While$/.test(T),Ie=/^(?:head|last)$/.test(T),At=pe[Ie?"take"+(T=="last"?"Right":""):T],dr=Ie||/^find/.test(T);!At||(pe.prototype[T]=function(){var Qr=this.__wrapped__,kn=Ie?[1]:arguments,Qn=Qr instanceof mt,Sa=kn[0],fa=Qn||(0,ht.Z)(Qr),La=function(Ql){var Jl=At.apply(pe,(0,Mo.Z)([Ql],kn));return Ie&&ts?Jl[0]:Jl};fa&&K&&typeof Sa=="function"&&Sa.length!=1&&(Qn=fa=!1);var ts=this.__chain__,ms=!!this.__actions__.length,du=dr&&!ts,_l=Qn&&!ms;if(!dr&&fa){Qr=_l?Qr:new mt(this);var Rs=c.apply(Qr,kn);return Rs.__actions__.push({func:ad,args:[La],thisArg:void 0}),new J(Rs,ts)}return du&&_l?c.apply(this,kn):(Rs=this.thru(La),du?Ie?Rs.value()[0]:Rs.value():Rs)})}),(0,je.Z)(["pop","push","shift","sort","splice","unshift"],function(c){var T=yE[c],K=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",Ie=/^(?:pop|shift)$/.test(c);pe.prototype[c]=function(){var At=arguments;if(Ie&&!this.__chain__){var dr=this.value();return T.apply((0,ht.Z)(dr)?dr:[],At)}return this[K](function(Qr){return T.apply((0,ht.Z)(Qr)?Qr:[],At)})}}),(0,Wi.Z)(mt.prototype,function(c,T){var K=pe[T];if(K){var Ie=K.name+"";Mg.call(M,Ie)||(M[Ie]=[]),M[Ie].push({name:T,func:K})}}),M[Ds(void 0,vE).name]=[{name:"wrapper",func:void 0}],mt.prototype.clone=rE,mt.prototype.reverse=iE,mt.prototype.value=pE,pe.prototype.at=mp.at,pe.prototype.chain=mp.wrapperChain,pe.prototype.commit=mp.commit,pe.prototype.next=mp.next,pe.prototype.plant=mp.plant,pe.prototype.reverse=mp.reverse,pe.prototype.toJSON=pe.prototype.valueOf=pe.prototype.value=mp.value,pe.prototype.first=pe.prototype.head,Pg&&(pe.prototype[Pg]=mp.toIterator);var bE=pe;/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */},96874:function(Ft){function A(y,v,Z){switch(Z.length){case 0:return y.call(v);case 1:return y.call(v,Z[0]);case 2:return y.call(v,Z[0],Z[1]);case 3:return y.call(v,Z[0],Z[1],Z[2])}return y.apply(v,Z)}Ft.exports=A},47443:function(Ft,A,y){var v=y(42118);function Z(a,P){var L=a==null?0:a.length;return!!L&&v(a,P,0)>-1}Ft.exports=Z},1196:function(Ft){function A(y,v,Z){for(var a=-1,P=y==null?0:y.length;++a<P;)if(Z(v,y[a]))return!0;return!1}Ft.exports=A},62663:function(Ft){function A(y,v,Z,a){var P=-1,L=y==null?0:y.length;for(a&&L&&(Z=y[++P]);++P<L;)Z=v(Z,y[P],P,y);return Z}Ft.exports=A},44286:function(Ft){function A(y){return y.split("")}Ft.exports=A},49029:function(Ft){var A=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function y(v){return v.match(A)||[]}Ft.exports=y},86556:function(Ft,A,y){var v=y(89465),Z=y(77813);function a(P,L,O){(O!==void 0&&!Z(P[L],O)||O===void 0&&!(L in P))&&v(P,L,O)}Ft.exports=a},29750:function(Ft){function A(y,v,Z){return y===y&&(Z!==void 0&&(y=y<=Z?y:Z),v!==void 0&&(y=y>=v?y:v)),y}Ft.exports=A},41848:function(Ft){function A(y,v,Z,a){for(var P=y.length,L=Z+(a?1:-1);a?L--:++L<P;)if(v(y[L],L,y))return L;return-1}Ft.exports=A},42118:function(Ft,A,y){var v=y(41848),Z=y(62722),a=y(42351);function P(L,O,D){return O===O?a(L,O,D):v(L,Z,D)}Ft.exports=P},62722:function(Ft){function A(y){return y!==y}Ft.exports=A},42980:function(Ft,A,y){var v=y(46384),Z=y(86556),a=y(28483),P=y(59783),L=y(13218),O=y(81704),D=y(36390);function B(V,N,Y,H,ce){V!==N&&a(N,function(at,rt){if(ce||(ce=new v),L(at))P(V,N,rt,Y,B,H,ce);else{var Re=H?H(D(V,rt),at,rt+"",V,N,ce):void 0;Re===void 0&&(Re=at),Z(V,rt,Re)}},O)}Ft.exports=B},59783:function(Ft,A,y){var v=y(86556),Z=y(64626),a=y(77133),P=y(278),L=y(38517),O=y(35694),D=y(1469),B=y(29246),V=y(44144),N=y(23560),Y=y(13218),H=y(68630),ce=y(36719),at=y(36390),rt=y(59881);function Re(vt,wt,fe,$e,re,Ge,Qe){var Te=at(vt,fe),Le=at(wt,fe),Ce=Qe.get(Le);if(Ce){v(vt,fe,Ce);return}var Fe=Ge?Ge(Te,Le,fe+"",vt,wt,Qe):void 0,Ke=Fe===void 0;if(Ke){var qt=D(Le),ir=!qt&&V(Le),Pe=!qt&&!ir&&ce(Le);Fe=Le,qt||ir||Pe?D(Te)?Fe=Te:B(Te)?Fe=P(Te):ir?(Ke=!1,Fe=Z(Le,!0)):Pe?(Ke=!1,Fe=a(Le,!0)):Fe=[]:H(Le)||O(Le)?(Fe=Te,O(Te)?Fe=rt(Te):(!Y(Te)||N(Te))&&(Fe=L(Le))):Ke=!1}Ke&&(Qe.set(Le,Fe),re(Fe,Le,$e,Ge,Qe),Qe.delete(Le)),v(vt,fe,Fe)}Ft.exports=Re},18674:function(Ft){function A(y){return function(v){return y==null?void 0:y[v]}}Ft.exports=A},5976:function(Ft,A,y){var v=y(6557),Z=y(45357),a=y(30061);function P(L,O){return a(Z(L,O,v),L+"")}Ft.exports=P},56560:function(Ft,A,y){var v=y(75703),Z=y(38777),a=y(6557),P=Z?function(L,O){return Z(L,"toString",{configurable:!0,enumerable:!1,value:v(O),writable:!0})}:a;Ft.exports=P},14259:function(Ft){function A(y,v,Z){var a=-1,P=y.length;v<0&&(v=-v>P?0:P+v),Z=Z>P?P:Z,Z<0&&(Z+=P),P=v>Z?0:Z-v>>>0,v>>>=0;for(var L=Array(P);++a<P;)L[a]=y[a+v];return L}Ft.exports=A},45652:function(Ft,A,y){var v=y(88668),Z=y(47443),a=y(1196),P=y(74757),L=y(23593),O=y(21814),D=200;function B(V,N,Y){var H=-1,ce=Z,at=V.length,rt=!0,Re=[],vt=Re;if(Y)rt=!1,ce=a;else if(at>=D){var wt=N?null:L(V);if(wt)return O(wt);rt=!1,ce=P,vt=new v}else vt=N?[]:Re;e:for(;++H<at;){var fe=V[H],$e=N?N(fe):fe;if(fe=Y||fe!==0?fe:0,rt&&$e===$e){for(var re=vt.length;re--;)if(vt[re]===$e)continue e;N&&vt.push($e),Re.push(fe)}else ce(vt,$e,Y)||(vt!==Re&&vt.push($e),Re.push(fe))}return Re}Ft.exports=B},40180:function(Ft,A,y){var v=y(14259);function Z(a,P,L){var O=a.length;return L=L===void 0?O:L,!P&&L>=O?a:v(a,P,L)}Ft.exports=Z},21463:function(Ft,A,y){var v=y(5976),Z=y(16612);function a(P){return v(function(L,O){var D=-1,B=O.length,V=B>1?O[B-1]:void 0,N=B>2?O[2]:void 0;for(V=P.length>3&&typeof V=="function"?(B--,V):void 0,N&&Z(O[0],O[1],N)&&(V=B<3?void 0:V,B=1),L=Object(L);++D<B;){var Y=O[D];Y&&P(L,Y,D,V)}return L})}Ft.exports=a},98805:function(Ft,A,y){var v=y(40180),Z=y(62689),a=y(83140),P=y(79833);function L(O){return function(D){D=P(D);var B=Z(D)?a(D):void 0,V=B?B[0]:D.charAt(0),N=B?v(B,1).join(""):D.slice(1);return V[O]()+N}}Ft.exports=L},35393:function(Ft,A,y){var v=y(62663),Z=y(53816),a=y(58748),P="['\u2019]",L=RegExp(P,"g");function O(D){return function(B){return v(a(Z(B).replace(L,"")),D,"")}}Ft.exports=O},23593:function(Ft,A,y){var v=y(58525),Z=y(50308),a=y(21814),P=1/0,L=v&&1/a(new v([,-0]))[1]==P?function(O){return new v(O)}:Z;Ft.exports=L},69389:function(Ft,A,y){var v=y(18674),Z={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},a=v(Z);Ft.exports=a},62689:function(Ft){var A="\\ud800-\\udfff",y="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",a=y+v+Z,P="\\ufe0e\\ufe0f",L="\\u200d",O=RegExp("["+L+A+a+P+"]");function D(B){return O.test(B)}Ft.exports=D},93157:function(Ft){var A=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function y(v){return A.test(v)}Ft.exports=y},16612:function(Ft,A,y){var v=y(77813),Z=y(98612),a=y(65776),P=y(13218);function L(O,D,B){if(!P(B))return!1;var V=typeof D;return(V=="number"?Z(B)&&a(D,B.length):V=="string"&&D in B)?v(B[D],O):!1}Ft.exports=L},45357:function(Ft,A,y){var v=y(96874),Z=Math.max;function a(P,L,O){return L=Z(L===void 0?P.length-1:L,0),function(){for(var D=arguments,B=-1,V=Z(D.length-L,0),N=Array(V);++B<V;)N[B]=D[L+B];B=-1;for(var Y=Array(L+1);++B<L;)Y[B]=D[B];return Y[L]=O(N),v(P,this,Y)}}Ft.exports=a},36390:function(Ft){function A(y,v){if(!(v==="constructor"&&typeof y[v]=="function")&&v!="__proto__")return y[v]}Ft.exports=A},30061:function(Ft,A,y){var v=y(56560),Z=y(21275),a=Z(v);Ft.exports=a},21275:function(Ft){var A=800,y=16,v=Date.now;function Z(a){var P=0,L=0;return function(){var O=v(),D=y-(O-L);if(L=O,D>0){if(++P>=A)return arguments[0]}else P=0;return a.apply(void 0,arguments)}}Ft.exports=Z},42351:function(Ft){function A(y,v,Z){for(var a=Z-1,P=y.length;++a<P;)if(y[a]===v)return a;return-1}Ft.exports=A},83140:function(Ft,A,y){var v=y(44286),Z=y(62689),a=y(676);function P(L){return Z(L)?a(L):v(L)}Ft.exports=P},676:function(Ft){var A="\\ud800-\\udfff",y="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",a=y+v+Z,P="\\ufe0e\\ufe0f",L="["+A+"]",O="["+a+"]",D="\\ud83c[\\udffb-\\udfff]",B="(?:"+O+"|"+D+")",V="[^"+A+"]",N="(?:\\ud83c[\\udde6-\\uddff]){2}",Y="[\\ud800-\\udbff][\\udc00-\\udfff]",H="\\u200d",ce=B+"?",at="["+P+"]?",rt="(?:"+H+"(?:"+[V,N,Y].join("|")+")"+at+ce+")*",Re=at+ce+rt,vt="(?:"+[V+O+"?",O,N,Y,L].join("|")+")",wt=RegExp(D+"(?="+D+")|"+vt+Re,"g");function fe($e){return $e.match(wt)||[]}Ft.exports=fe},2757:function(Ft){var A="\\ud800-\\udfff",y="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",a=y+v+Z,P="\\u2700-\\u27bf",L="a-z\\xdf-\\xf6\\xf8-\\xff",O="\\xac\\xb1\\xd7\\xf7",D="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",B="\\u2000-\\u206f",V=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",N="A-Z\\xc0-\\xd6\\xd8-\\xde",Y="\\ufe0e\\ufe0f",H=O+D+B+V,ce="['\u2019]",at="["+H+"]",rt="["+a+"]",Re="\\d+",vt="["+P+"]",wt="["+L+"]",fe="[^"+A+H+Re+P+L+N+"]",$e="\\ud83c[\\udffb-\\udfff]",re="(?:"+rt+"|"+$e+")",Ge="[^"+A+"]",Qe="(?:\\ud83c[\\udde6-\\uddff]){2}",Te="[\\ud800-\\udbff][\\udc00-\\udfff]",Le="["+N+"]",Ce="\\u200d",Fe="(?:"+wt+"|"+fe+")",Ke="(?:"+Le+"|"+fe+")",qt="(?:"+ce+"(?:d|ll|m|re|s|t|ve))?",ir="(?:"+ce+"(?:D|LL|M|RE|S|T|VE))?",Pe=re+"?",Ne="["+Y+"]?",Xe="(?:"+Ce+"(?:"+[Ge,Qe,Te].join("|")+")"+Ne+Pe+")*",kt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rr="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",me=Ne+Pe+Xe,et="(?:"+[vt,Qe,Te].join("|")+")"+me,or=RegExp([Le+"?"+wt+"+"+qt+"(?="+[at,Le,"$"].join("|")+")",Ke+"+"+ir+"(?="+[at,Le+Fe,"$"].join("|")+")",Le+"?"+Fe+"+"+qt,Le+"+"+ir,rr,kt,Re,et].join("|"),"g");function on(vr){return vr.match(or)||[]}Ft.exports=on},68929:function(Ft,A,y){var v=y(48403),Z=y(35393),a=Z(function(P,L,O){return L=L.toLowerCase(),P+(O?v(L):L)});Ft.exports=a},48403:function(Ft,A,y){var v=y(79833),Z=y(11700);function a(P){return Z(v(P).toLowerCase())}Ft.exports=a},74691:function(Ft,A,y){var v=y(29750),Z=y(14841);function a(P,L,O){return O===void 0&&(O=L,L=void 0),O!==void 0&&(O=Z(O),O=O===O?O:0),L!==void 0&&(L=Z(L),L=L===L?L:0),v(Z(P),L,O)}Ft.exports=a},75703:function(Ft){function A(y){return function(){return y}}Ft.exports=A},53816:function(Ft,A,y){var v=y(69389),Z=y(79833),a=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,P="\\u0300-\\u036f",L="\\ufe20-\\ufe2f",O="\\u20d0-\\u20ff",D=P+L+O,B="["+D+"]",V=RegExp(B,"g");function N(Y){return Y=Z(Y),Y&&Y.replace(a,v).replace(V,"")}Ft.exports=N},29246:function(Ft,A,y){var v=y(98612),Z=y(37005);function a(P){return Z(P)&&v(P)}Ft.exports=a},14293:function(Ft){function A(y){return y==null}Ft.exports=A},81763:function(Ft,A,y){var v=y(44239),Z=y(37005),a="[object Number]";function P(L){return typeof L=="number"||Z(L)&&v(L)==a}Ft.exports=P},52353:function(Ft){function A(y){return y===void 0}Ft.exports=A},82492:function(Ft,A,y){var v=y(42980),Z=y(21463),a=Z(function(P,L,O){v(P,L,O)});Ft.exports=a},30236:function(Ft,A,y){var v=y(42980),Z=y(21463),a=Z(function(P,L,O,D){v(P,L,O,D)});Ft.exports=a},50308:function(Ft){function A(){}Ft.exports=A},23493:function(Ft,A,y){var v=y(23279),Z=y(13218),a="Expected a function";function P(L,O,D){var B=!0,V=!0;if(typeof L!="function")throw new TypeError(a);return Z(D)&&(B="leading"in D?!!D.leading:B,V="trailing"in D?!!D.trailing:V),v(L,O,{leading:B,maxWait:O,trailing:V})}Ft.exports=P},59881:function(Ft,A,y){var v=y(98363),Z=y(81704);function a(P){return v(P,Z(P))}Ft.exports=a},44908:function(Ft,A,y){var v=y(45652);function Z(a){return a&&a.length?v(a):[]}Ft.exports=Z},11700:function(Ft,A,y){var v=y(98805),Z=v("toUpperCase");Ft.exports=Z},58748:function(Ft,A,y){var v=y(49029),Z=y(93157),a=y(79833),P=y(2757);function L(O,D,B){return O=a(O),D=B?void 0:D,D===void 0?Z(O)?P(O):v(O):O.match(D)||[]}Ft.exports=L},6158:function(Ft){(function(A,y){Ft.exports=y()})(this,function(){"use strict";var A,y,v;function Z(a,P){if(!A)A=P;else if(!y)y=P;else{var L="var sharedChunk = {}; ("+A+")(sharedChunk); ("+y+")(sharedChunk);",O={};A(O),v=P(O),typeof window!="undefined"&&(v.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}return Z(["exports"],function(a){"use strict";function P(e,t){return e(t={exports:{}},t.exports),t.exports}var L=O;function O(e,t,r,s){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=s,this.p2x=r,this.p2y=s}O.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},O.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},O.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},O.prototype.solveCurveX=function(e,t){var r,s,d,E,I;for(t===void 0&&(t=1e-6),d=e,I=0;I<8;I++){if(E=this.sampleCurveX(d)-e,Math.abs(E)<t)return d;var G=this.sampleCurveDerivativeX(d);if(Math.abs(G)<1e-6)break;d-=E/G}if((d=e)<(r=0))return r;if(d>(s=1))return s;for(;r<s;){if(E=this.sampleCurveX(d),Math.abs(E-e)<t)return d;e>E?r=d:s=d,d=.5*(s-r)+r}return d},O.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var D=B;function B(e,t){this.x=e,this.y=t}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),s=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=s,this},_rotateAround:function(e,t){var r=Math.cos(e),s=Math.sin(e),d=t.y+s*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-s*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(e){return e instanceof B?e:Array.isArray(e)?new B(e[0],e[1]):e};var V=typeof self!="undefined"?self:{},N=Math.pow(2,53)-1;function Y(e,t,r,s){var d=new L(e,t,r,s);return function(E){return d.solve(E)}}var H=Y(.25,.1,.25,1);function ce(e,t,r){return Math.min(r,Math.max(t,e))}function at(e,t,r){var s=r-t,d=((e-t)%s+s)%s+t;return d===t?r:d}function rt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var s=0,d=t;s<d.length;s+=1){var E=d[s];for(var I in E)e[I]=E[I]}return e}var Re=1;function vt(){return Re++}function wt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function fe(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function $e(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function re(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ge(e,t,r){var s={};for(var d in e)s[d]=t.call(r||this,e[d],d,e);return s}function Qe(e,t,r){var s={};for(var d in e)t.call(r||this,e[d],d,e)&&(s[d]=e[d]);return s}function Te(e){return Array.isArray(e)?e.map(Te):typeof e=="object"&&e?Ge(e,Te):e}var Le={};function Ce(e){Le[e]||(typeof console!="undefined"&&console.warn(e),Le[e]=!0)}function Fe(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Ke(e){for(var t=0,r=0,s=e.length,d=s-1,E=void 0,I=void 0;r<s;d=r++)t+=((I=e[d]).x-(E=e[r]).x)*(E.y+I.y);return t}function qt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ir(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(s,d,E,I){var G=E||I;return t[d]=!G||G.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var Pe=null;function Ne(e){if(Pe==null){var t=e.navigator?e.navigator.userAgent:null;Pe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Pe}function Xe(e){try{var t=V[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var kt,rr,me,et,or=V.performance&&V.performance.now?V.performance.now.bind(V.performance):Date.now.bind(Date),on=V.requestAnimationFrame||V.mozRequestAnimationFrame||V.webkitRequestAnimationFrame||V.msRequestAnimationFrame,vr=V.cancelAnimationFrame||V.mozCancelAnimationFrame||V.webkitCancelAnimationFrame||V.msCancelAnimationFrame,jr={now:or,frame:function(e){var t=on(e);return{cancel:function(){return vr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var r=V.document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,s.drawImage(e,0,0,e.width,e.height),s.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return kt||(kt=V.document.createElement("a")),kt.href=e,kt.href},hardwareConcurrency:V.navigator&&V.navigator.hardwareConcurrency||4,get devicePixelRatio(){return V.devicePixelRatio},get prefersReducedMotion(){return!!V.matchMedia&&(rr==null&&(rr=V.matchMedia("(prefers-reduced-motion: reduce)")),rr.matches)}},xr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ae={supported:!1,testSupport:function(e){!De&&et&&(ke?Bt(e):me=e)}},De=!1,ke=!1;function Bt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,et),e.isContextLost())return;Ae.supported=!0}catch(r){}e.deleteTexture(t),De=!0}V.document&&((et=V.document.createElement("img")).onload=function(){me&&Bt(me),me=null,ke=!0},et.onerror=function(){De=!0,me=null},et.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var mt="01",Mr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Cr(e){return e.indexOf("mapbox:")===0}Mr.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",mt,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Mr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Mr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Mr.prototype.normalizeStyleURL=function(e,t){if(!Cr(e))return e;var r=M(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Mr.prototype.normalizeGlyphsURL=function(e,t){if(!Cr(e))return e;var r=M(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Mr.prototype.normalizeSourceURL=function(e,t){if(!Cr(e))return e;var r=M(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},Mr.prototype.normalizeSpriteURL=function(e,t,r,s){var d=M(e);return Cr(e)?(d.path="/styles/v1"+d.path+"/sprite"+t+r,this._makeAPIURL(d,this._customAccessToken||s)):(d.path+=""+t+r,W(d))},Mr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Cr(e))return e;var r=M(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(jr.devicePixelRatio>=2||t===512?"@2x":"")+(Ae.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var s=this._customAccessToken||function(d){for(var E=0,I=d;E<I.length;E+=1){var G=I[E].match(/^access_token=(.*)$/);if(G)return G[1]}return null}(r.params)||xr.ACCESS_TOKEN;return xr.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,s)},Mr.prototype.canonicalizeTileURL=function(e,t){var r=M(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var s="mapbox://tiles/";s+=r.path.replace("/v4/","");var d=r.params;return t&&(d=d.filter(function(E){return!E.match(/^access_token=/)})),d.length&&(s+="?"+d.join("&")),s},Mr.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&Cr(t),s=[],d=0,E=e.tiles||[];d<E.length;d+=1){var I=E[d];nt(I)?s.push(this.canonicalizeTileURL(I,r)):s.push(I)}return s},Mr.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=M(xr.API_URL);if(e.protocol=s.protocol,e.authority=s.authority,e.protocol==="http"){var d=e.params.indexOf("secure");d>=0&&e.params.splice(d,1)}if(s.path!=="/"&&(e.path=""+s.path+e.path),!xr.REQUIRE_ACCESS_TOKEN)return W(e);if(!(t=t||xr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(E){return E.indexOf("access_token")===-1}),e.params.push("access_token="+t),W(e)};var Nr=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function nt(e){return Nr.test(e)}var Ye=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function M(e){var t=e.match(Ye);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function W(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function ue(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(V.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var X=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};X.prototype.getStorageKey=function(e){var t,r=ue(xr.ACCESS_TOKEN);return t=r&&r.u?V.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(s,d){return String.fromCharCode(Number("0x"+d))})):xr.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},X.prototype.fetchEventData=function(){var e=Xe("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var s=V.localStorage.getItem(t);s&&(this.eventData=JSON.parse(s));var d=V.localStorage.getItem(r);d&&(this.anonId=d)}catch(E){Ce("Unable to read from LocalStorage")}},X.prototype.saveEventData=function(){var e=Xe("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{V.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&V.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(s){Ce("Unable to write to LocalStorage")}},X.prototype.processRequests=function(e){},X.prototype.postEvent=function(e,t,r,s){var d=this;if(xr.EVENTS_URL){var E=M(xr.EVENTS_URL);E.params.push("access_token="+(s||xr.ACCESS_TOKEN||""));var I={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:mt,userId:this.anonId},G=t?rt(I,t):I,se={url:W(E),headers:{"Content-Type":"text/plain"},body:JSON.stringify([G])};this.pendingRequest=it(se,function(be){d.pendingRequest=null,r(be),d.saveEventData(),d.processRequests(s)})}},X.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var ie,ye,J=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,s,d,E){this.skuToken=d,(xr.EVENTS_URL&&E||xr.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(I){return Cr(I)||nt(I)}))&&this.queueRequest({id:s,timestamp:Date.now()},E)},t.prototype.processRequests=function(r){var s=this;if(!this.pendingRequest&&this.queue.length!==0){var d=this.queue.shift(),E=d.id,I=d.timestamp;E&&this.success[E]||(this.anonId||this.fetchEventData(),fe(this.anonId)||(this.anonId=wt()),this.postEvent(I,{skuToken:this.skuToken},function(G){G||E&&(s.success[E]=!0)},r))}},t}(X),ht=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,s){xr.EVENTS_URL&&xr.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(d){return Cr(d)||nt(d)})&&this.queueRequest(Date.now(),s)},t.prototype.processRequests=function(r){var s=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var d=ue(xr.ACCESS_TOKEN),E=d?d.u:xr.ACCESS_TOKEN,I=E!==this.eventData.tokenU;fe(this.anonId)||(this.anonId=wt(),I=!0);var G=this.queue.shift();if(this.eventData.lastSuccess){var se=new Date(this.eventData.lastSuccess),be=new Date(G),we=(G-this.eventData.lastSuccess)/864e5;I=I||we>=1||we<-1||se.getDate()!==be.getDate()}else I=!0;if(!I)return this.processRequests();this.postEvent(G,{"enabled.telemetry":!1},function(Ze){Ze||(s.eventData.lastSuccess=G,s.eventData.tokenU=E)},r)}},t}(X)),ze=ht.postTurnstileEvent.bind(ht),pt=new J,Me=pt.postMapLoadEvent.bind(pt),Ue=500,yt=50;function gt(){V.caches&&!ie&&(ie=V.caches.open("mapbox-tiles"))}function nr(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var pe,lr=1/0;function Ur(){return pe==null&&(pe=V.OffscreenCanvas&&new V.OffscreenCanvas(1,1).getContext("2d")&&typeof V.createImageBitmap=="function"),pe}var Hr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Hr);var un=function(e){function t(r,s,d){s===401&&nt(d)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=s,this.url=d,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),bn=qt()?function(){return self.worker&&self.worker.referrer}:function(){return(V.location.protocol==="blob:"?V.parent:V).location.href},Gn,li,$r=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(bn())&&!/^\w+:/.test(r))){if(V.fetch&&V.Request&&V.AbortController&&V.Request.prototype.hasOwnProperty("signal"))return function(s,d){var E,I=new V.AbortController,G=new V.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:bn(),signal:I.signal}),se=!1,be=!1,we=(E=G.url).indexOf("sku=")>0&&nt(E);s.type==="json"&&G.headers.set("Accept","application/json");var Ze=function(bt,Qt,tr){if(!be){if(bt&&bt.message!=="SecurityError"&&Ce(bt),Qt&&tr)return ot(Qt);var br=Date.now();V.fetch(G).then(function(cr){if(cr.ok){var Zr=we?cr.clone():null;return ot(cr,Zr,br)}return d(new un(cr.statusText,cr.status,s.url))}).catch(function(cr){cr.code!==20&&d(new Error(cr.message))})}},ot=function(bt,Qt,tr){(s.type==="arrayBuffer"?bt.arrayBuffer():s.type==="json"?bt.json():bt.text()).then(function(br){be||(Qt&&tr&&function(cr,Zr,Yr){if(gt(),ie){var ln={status:Zr.status,statusText:Zr.statusText,headers:new V.Headers};Zr.headers.forEach(function(Ln,oi){return ln.headers.set(oi,Ln)});var vn=ir(Zr.headers.get("Cache-Control")||"");vn["no-store"]||(vn["max-age"]&&ln.headers.set("Expires",new Date(Yr+1e3*vn["max-age"]).toUTCString()),new Date(ln.headers.get("Expires")).getTime()-Yr<42e4||function(Ln,oi){if(ye===void 0)try{new Response(new ReadableStream),ye=!0}catch(wi){ye=!1}ye?oi(Ln.body):Ln.blob().then(oi)}(Zr,function(Ln){var oi=new V.Response(Ln,ln);gt(),ie&&ie.then(function(wi){return wi.put(nr(cr.url),oi)}).catch(function(wi){return Ce(wi.message)})}))}}(G,Qt,tr),se=!0,d(null,br,bt.headers.get("Cache-Control"),bt.headers.get("Expires")))}).catch(function(br){be||d(new Error(br.message))})};return we?function(bt,Qt){if(gt(),!ie)return Qt(null);var tr=nr(bt.url);ie.then(function(br){br.match(tr).then(function(cr){var Zr=function(Yr){if(!Yr)return!1;var ln=new Date(Yr.headers.get("Expires")||0),vn=ir(Yr.headers.get("Cache-Control")||"");return ln>Date.now()&&!vn["no-cache"]}(cr);br.delete(tr),Zr&&br.put(tr,cr.clone()),Qt(null,cr,Zr)}).catch(Qt)}).catch(Qt)}(G,Ze):Ze(null,null),{cancel:function(){be=!0,se||I.abort()}}}(e,t);if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(s,d){var E=new V.XMLHttpRequest;for(var I in E.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(E.responseType="arraybuffer"),s.headers)E.setRequestHeader(I,s.headers[I]);return s.type==="json"&&(E.responseType="text",E.setRequestHeader("Accept","application/json")),E.withCredentials=s.credentials==="include",E.onerror=function(){d(new Error(E.statusText))},E.onload=function(){if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){var G=E.response;if(s.type==="json")try{G=JSON.parse(E.response)}catch(se){return d(se)}d(null,G,E.getResponseHeader("Cache-Control"),E.getResponseHeader("Expires"))}else d(new un(E.statusText,E.status,s.url))},E.send(s.body),{cancel:function(){return E.abort()}}}(e,t)},Zt=function(e,t){return $r(rt(e,{type:"arrayBuffer"}),t)},it=function(e,t){return $r(rt(e,{method:"POST"}),t)},ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Gn=[],li=0;var _e=function(e,t){if(Ae.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),li>=xr.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Gn.push(r),r}li++;var s=!1,d=function(){if(!s)for(s=!0,li--;Gn.length&&li<xr.MAX_PARALLEL_IMAGE_REQUESTS;){var I=Gn.shift();I.cancelled||(I.cancel=_e(I.requestParameters,I.callback).cancel)}},E=Zt(e,function(I,G,se,be){d(),I?t(I):G&&(Ur()?function(we,Ze){var ot=new V.Blob([new Uint8Array(we)],{type:"image/png"});V.createImageBitmap(ot).then(function(bt){Ze(null,bt)}).catch(function(bt){Ze(new Error("Could not load image because of "+bt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(G,t):function(we,Ze,ot,bt){var Qt=new V.Image,tr=V.URL;Qt.onload=function(){Ze(null,Qt),tr.revokeObjectURL(Qt.src),Qt.onload=null,V.requestAnimationFrame(function(){Qt.src=ne})},Qt.onerror=function(){return Ze(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var br=new V.Blob([new Uint8Array(we)],{type:"image/png"});Qt.cacheControl=ot,Qt.expires=bt,Qt.src=we.byteLength?tr.createObjectURL(br):ne}(G,t,se,be))});return{cancel:function(){E.cancel(),d()}}};function Oe(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function je(e,t,r){if(r&&r[e]){var s=r[e].indexOf(t);s!==-1&&r[e].splice(s,1)}}var dt=function(e,t){t===void 0&&(t={}),rt(this,t),this.type=e},Ut=function(e){function t(r,s){s===void 0&&(s={}),e.call(this,"error",rt({error:r},s))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(dt),ur=function(){};ur.prototype.on=function(e,t){return this._listeners=this._listeners||{},Oe(e,t,this._listeners),this},ur.prototype.off=function(e,t){return je(e,t,this._listeners),je(e,t,this._oneTimeListeners),this},ur.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},Oe(e,t,this._oneTimeListeners),this},ur.prototype.fire=function(e,t){typeof e=="string"&&(e=new dt(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var s=0,d=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];s<d.length;s+=1)d[s].call(this,e);for(var E=0,I=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];E<I.length;E+=1){var G=I[E];je(r,G,this._oneTimeListeners),G.call(this,e)}var se=this._eventedParent;se&&(rt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),se.fire(e))}else e instanceof Ut&&console.error(e.error);return this},ur.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},ur.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var lt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Nt=function(e,t,r,s){this.message=(e?e+": ":"")+r,s&&(this.identifier=s),t!=null&&t.__line__&&(this.line=t.__line__)};function Sr(e){var t=e.value;return t?[new Nt(e.key,t,"constants have been deprecated as of v8")]:[]}function fn(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var s=0,d=t;s<d.length;s+=1){var E=d[s];for(var I in E)e[I]=E[I]}return e}function Br(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Jr(e){if(Array.isArray(e))return e.map(Jr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=Jr(e[r]);return t}return Br(e)}var Tn=function(e){function t(r,s){e.call(this,s),this.message=s,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),hi=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var r=0,s=t;r<s.length;r+=1){var d=s[r];this.bindings[d[0]]=d[1]}};hi.prototype.concat=function(e){return new hi(this,e)},hi.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},hi.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var On={kind:"null"},Pr={kind:"number"},vi={kind:"string"},Jn={kind:"boolean"},ui={kind:"color"},Da={kind:"object"},Yn={kind:"value"},wa={kind:"collator"},vo={kind:"formatted"},Ua={kind:"resolvedImage"};function Ka(e,t){return{kind:"array",itemType:e,N:t}}function Ga(e){if(e.kind==="array"){var t=Ga(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ei=[On,Pr,vi,Jn,ui,vo,Da,Ka(Yn),Ua];function eo(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!eo(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,s=ei;r<s.length;r+=1)if(!eo(s[r],t))return null}}return"Expected "+Ga(e)+" but found "+Ga(t)+" instead."}function ra(e,t){return t.some(function(r){return r.kind===e.kind})}function Rn(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var qa=P(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(G){return(G=Math.round(G))<0?0:G>255?255:G}function d(G){return s(G[G.length-1]==="%"?parseFloat(G)/100*255:parseInt(G))}function E(G){return(se=G[G.length-1]==="%"?parseFloat(G)/100:parseFloat(G))<0?0:se>1?1:se;var se}function I(G,se,be){return be<0?be+=1:be>1&&(be-=1),6*be<1?G+(se-G)*be*6:2*be<1?se:3*be<2?G+(se-G)*(2/3-be)*6:G}try{t.parseCSSColor=function(G){var se,be=G.replace(/ /g,"").toLowerCase();if(be in r)return r[be].slice();if(be[0]==="#")return be.length===4?(se=parseInt(be.substr(1),16))>=0&&se<=4095?[(3840&se)>>4|(3840&se)>>8,240&se|(240&se)>>4,15&se|(15&se)<<4,1]:null:be.length===7&&(se=parseInt(be.substr(1),16))>=0&&se<=16777215?[(16711680&se)>>16,(65280&se)>>8,255&se,1]:null;var we=be.indexOf("("),Ze=be.indexOf(")");if(we!==-1&&Ze+1===be.length){var ot=be.substr(0,we),bt=be.substr(we+1,Ze-(we+1)).split(","),Qt=1;switch(ot){case"rgba":if(bt.length!==4)return null;Qt=E(bt.pop());case"rgb":return bt.length!==3?null:[d(bt[0]),d(bt[1]),d(bt[2]),Qt];case"hsla":if(bt.length!==4)return null;Qt=E(bt.pop());case"hsl":if(bt.length!==3)return null;var tr=(parseFloat(bt[0])%360+360)%360/360,br=E(bt[1]),cr=E(bt[2]),Zr=cr<=.5?cr*(br+1):cr+br-cr*br,Yr=2*cr-Zr;return[s(255*I(Yr,Zr,tr+1/3)),s(255*I(Yr,Zr,tr)),s(255*I(Yr,Zr,tr-1/3)),Qt];default:return null}}return null}}catch(G){}}).parseCSSColor,ba=function(e,t,r,s){s===void 0&&(s=1),this.r=e,this.g=t,this.b=r,this.a=s};ba.parse=function(e){if(e){if(e instanceof ba)return e;if(typeof e=="string"){var t=qa(e);if(t)return new ba(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ba.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],s=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+s+")"},ba.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ba.black=new ba(0,0,0,1),ba.white=new ba(1,1,1,1),ba.transparent=new ba(0,0,0,0),ba.red=new ba(1,0,0,1);var Na=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Na.prototype.compare=function(e,t){return this.collator.compare(e,t)},Na.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var wo=function(e,t,r,s,d){this.text=e,this.image=t,this.scale=r,this.fontStack=s,this.textColor=d},ya=function(e){this.sections=e};ya.fromString=function(e){return new ya([new wo(e,null,null,null,null)])},ya.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ya.factory=function(e){return e instanceof ya?e:ya.fromString(e)},ya.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ya.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var s=r[t];if(s.image)e.push(["image",s.image.name]);else{e.push(s.text);var d={};s.fontStack&&(d["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(d["font-scale"]=s.scale),s.textColor&&(d["text-color"]=["rgba"].concat(s.textColor.toArray())),e.push(d)}}return e};var Gt=function(e){this.name=e.name,this.available=e.available};function gs(e,t,r,s){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:"Invalid rgba value ["+[e,t,r,s].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof s=="number"?[e,t,r,s]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Qi(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ba||e instanceof Na||e instanceof ya||e instanceof Gt)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Qi(r[t]))return!1;return!0}if(typeof e=="object"){for(var s in e)if(!Qi(e[s]))return!1;return!0}return!1}function So(e){if(e===null)return On;if(typeof e=="string")return vi;if(typeof e=="boolean")return Jn;if(typeof e=="number")return Pr;if(e instanceof ba)return ui;if(e instanceof Na)return wa;if(e instanceof ya)return vo;if(e instanceof Gt)return Ua;if(Array.isArray(e)){for(var t,r=e.length,s=0,d=e;s<d.length;s+=1){var E=So(d[s]);if(t){if(t===E)continue;t=Yn;break}t=E}return Ka(t||Yn,r)}return Da}function ll(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ba||e instanceof ya||e instanceof Gt?e.toString():JSON.stringify(e)}Gt.prototype.toString=function(){return this.name},Gt.fromString=function(e){return e?new Gt({name:e,available:!1}):null},Gt.prototype.serialize=function(){return["image",this.name]};var Ss=function(e,t){this.type=e,this.value=t};Ss.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Qi(e[1]))return t.error("invalid value");var r=e[1],s=So(r),d=t.expectedType;return s.kind!=="array"||s.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(s=d),new Ss(s,r)},Ss.prototype.evaluate=function(){return this.value},Ss.prototype.eachChild=function(){},Ss.prototype.outputDefined=function(){return!0},Ss.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ba?["rgba"].concat(this.value.toArray()):this.value instanceof ya?this.value.serialize():this.value};var rs=function(e){this.name="ExpressionEvaluationError",this.message=e};rs.prototype.toJSON=function(){return this.message};var ls={string:vi,number:Pr,boolean:Jn,object:Da},Ia=function(e,t){this.type=e,this.args=t};Ia.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,s=1,d=e[0];if(d==="array"){var E,I;if(e.length>2){var G=e[1];if(typeof G!="string"||!(G in ls)||G==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);E=ls[G],s++}else E=Yn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);I=e[2],s++}r=Ka(E,I)}else r=ls[d];for(var se=[];s<e.length;s++){var be=t.parse(e[s],s,Yn);if(!be)return null;se.push(be)}return new Ia(r,se)},Ia.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!eo(this.type,So(r)))return r;if(t===this.args.length-1)throw new rs("Expected value to be of type "+Ga(this.type)+", but found "+Ga(So(r))+" instead.")}return null},Ia.prototype.eachChild=function(e){this.args.forEach(e)},Ia.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ia.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var s=e.N;(typeof s=="number"||this.args.length>1)&&t.push(s)}}return t.concat(this.args.map(function(d){return d.serialize()}))};var Ms=function(e){this.type=vo,this.sections=e};Ms.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var s=[],d=!1,E=1;E<=e.length-1;++E){var I=e[E];if(d&&typeof I=="object"&&!Array.isArray(I)){d=!1;var G=null;if(I["font-scale"]&&!(G=t.parse(I["font-scale"],1,Pr)))return null;var se=null;if(I["text-font"]&&!(se=t.parse(I["text-font"],1,Ka(vi))))return null;var be=null;if(I["text-color"]&&!(be=t.parse(I["text-color"],1,ui)))return null;var we=s[s.length-1];we.scale=G,we.font=se,we.textColor=be}else{var Ze=t.parse(e[E],1,Yn);if(!Ze)return null;var ot=Ze.type.kind;if(ot!=="string"&&ot!=="value"&&ot!=="null"&&ot!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,s.push({content:Ze,scale:null,font:null,textColor:null})}}return new Ms(s)},Ms.prototype.evaluate=function(e){return new ya(this.sections.map(function(t){var r=t.content.evaluate(e);return So(r)===Ua?new wo("",r,null,null,null):new wo(ll(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Ms.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var s=r[t];e(s.content),s.scale&&e(s.scale),s.font&&e(s.font),s.textColor&&e(s.textColor)}},Ms.prototype.outputDefined=function(){return!1},Ms.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var s=r[t];e.push(s.content.serialize());var d={};s.scale&&(d["font-scale"]=s.scale.serialize()),s.font&&(d["text-font"]=s.font.serialize()),s.textColor&&(d["text-color"]=s.textColor.serialize()),e.push(d)}return e};var uo=function(e){this.type=Ua,this.input=e};uo.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,vi);return r?new uo(r):t.error("No image name provided.")},uo.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Gt.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},uo.prototype.eachChild=function(e){e(this.input)},uo.prototype.outputDefined=function(){return!1},uo.prototype.serialize=function(){return["image",this.input.serialize()]};var Qs={"to-boolean":Jn,"to-color":ui,"to-number":Pr,"to-string":vi},Ao=function(e,t){this.type=e,this.args=t};Ao.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var s=Qs[r],d=[],E=1;E<e.length;E++){var I=t.parse(e[E],E,Yn);if(!I)return null;d.push(I)}return new Ao(s,d)},Ao.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,s=0,d=this.args;s<d.length;s+=1){if(r=null,(t=d[s].evaluate(e))instanceof ba)return t;if(typeof t=="string"){var E=e.parseColor(t);if(E)return E}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":gs(t[0],t[1],t[2],t[3])))return new ba(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new rs(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var I=null,G=0,se=this.args;G<se.length;G+=1){if((I=se[G].evaluate(e))===null)return 0;var be=Number(I);if(!isNaN(be))return be}throw new rs("Could not convert "+JSON.stringify(I)+" to number.")}return this.type.kind==="formatted"?ya.fromString(ll(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Gt.fromString(ll(this.args[0].evaluate(e))):ll(this.args[0].evaluate(e))},Ao.prototype.eachChild=function(e){this.args.forEach(e)},Ao.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ao.prototype.serialize=function(){if(this.type.kind==="formatted")return new Ms([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new uo(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ts=["Unknown","Point","LineString","Polygon"],ua=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ua.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ua.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Ts[this.feature.type]:this.feature.type:null},ua.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ua.prototype.canonicalID=function(){return this.canonical},ua.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ua.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ba.parse(e)),t};var cs=function(e,t,r,s){this.name=e,this.type=t,this._evaluate=r,this.args=s};cs.prototype.evaluate=function(e){return this._evaluate(e,this.args)},cs.prototype.eachChild=function(e){this.args.forEach(e)},cs.prototype.outputDefined=function(){return!1},cs.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},cs.parse=function(e,t){var r,s=e[0],d=cs.definitions[s];if(!d)return t.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0);for(var E=Array.isArray(d)?d[0]:d.type,I=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,G=I.filter(function(Ca){var Ni=Ca[0];return!Array.isArray(Ni)||Ni.length===e.length-1}),se=null,be=0,we=G;be<we.length;be+=1){var Ze=we[be],ot=Ze[0],bt=Ze[1];se=new mi(t.registry,t.path,null,t.scope);for(var Qt=[],tr=!1,br=1;br<e.length;br++){var cr=e[br],Zr=Array.isArray(ot)?ot[br-1]:ot.type,Yr=se.parse(cr,1+Qt.length,Zr);if(!Yr){tr=!0;break}Qt.push(Yr)}if(!tr)if(Array.isArray(ot)&&ot.length!==Qt.length)se.error("Expected "+ot.length+" arguments, but found "+Qt.length+" instead.");else{for(var ln=0;ln<Qt.length;ln++){var vn=Array.isArray(ot)?ot[ln]:ot.type,Ln=Qt[ln];se.concat(ln+1).checkSubtype(vn,Ln.type)}if(se.errors.length===0)return new cs(s,E,bt,Qt)}}if(G.length===1)(r=t.errors).push.apply(r,se.errors);else{for(var oi=(G.length?G:I).map(function(Ca){var Ni;return Ni=Ca[0],Array.isArray(Ni)?"("+Ni.map(Ga).join(", ")+")":"("+Ga(Ni.type)+"...)"}).join(" | "),wi=[],va=1;va<e.length;va++){var Fi=t.parse(e[va],1+wi.length);if(!Fi)return null;wi.push(Ga(Fi.type))}t.error("Expected arguments of type "+oi+", but found ("+wi.join(", ")+") instead.")}return null},cs.register=function(e,t){for(var r in cs.definitions=t,t)e[r]=cs};var Ds=function(e,t,r){this.type=wa,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function Ro(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Eu(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ec(e,t){var r=(180+e[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(r*d*8192),Math.round(s*d*8192)]}function Gs(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function ft(e,t){for(var r,s,d,E,I,G,se,be=!1,we=0,Ze=t.length;we<Ze;we++)for(var ot=t[we],bt=0,Qt=ot.length;bt<Qt-1;bt++){if((E=(r=e)[0]-(s=ot[bt])[0])*(se=r[1]-(d=ot[bt+1])[1])-(G=r[0]-d[0])*(I=r[1]-s[1])==0&&E*G<=0&&I*se<=0)return!1;Gs(e,ot[bt],ot[bt+1])&&(be=!be)}return be}function St(e,t){for(var r=0;r<t.length;r++)if(ft(e,t[r]))return!0;return!1}function _r(e,t,r,s){var d=s[0]-r[0],E=s[1]-r[1],I=(e[0]-r[0])*E-d*(e[1]-r[1]),G=(t[0]-r[0])*E-d*(t[1]-r[1]);return I>0&&G<0||I<0&&G>0}function Or(e,t,r){for(var s=0,d=r;s<d.length;s+=1)for(var E=d[s],I=0;I<E.length-1;++I)if((Ze=[(we=E[I+1])[0]-(be=E[I])[0],we[1]-be[1]])[0]*(ot=[(se=t)[0]-(G=e)[0],se[1]-G[1]])[1]-Ze[1]*ot[0]!=0&&_r(G,se,be,we)&&_r(be,we,G,se))return!0;var G,se,be,we,Ze,ot;return!1}function $n(e,t){for(var r=0;r<e.length;++r)if(!ft(e[r],t))return!1;for(var s=0;s<e.length-1;++s)if(Or(e[s],e[s+1],t))return!1;return!0}function Gi(e,t){for(var r=0;r<t.length;r++)if($n(e,t[r]))return!0;return!1}function to(e,t,r){for(var s=[],d=0;d<e.length;d++){for(var E=[],I=0;I<e[d].length;I++){var G=ec(e[d][I],r);Ro(t,G),E.push(G)}s.push(E)}return s}function Je(e,t,r){for(var s=[],d=0;d<e.length;d++){var E=to(e[d],t,r);s.push(E)}return s}function It(e,t,r,s){if(e[0]<r[0]||e[0]>r[2]){var d=.5*s,E=e[0]-r[0]>d?-s:r[0]-e[0]>d?s:0;E===0&&(E=e[0]-r[2]>d?-s:r[2]-e[0]>d?s:0),e[0]+=E}Ro(t,e)}function Ot(e,t,r,s){for(var d=8192*Math.pow(2,s.z),E=[8192*s.x,8192*s.y],I=[],G=0,se=e;G<se.length;G+=1)for(var be=0,we=se[G];be<we.length;be+=1){var Ze=we[be],ot=[Ze.x+E[0],Ze.y+E[1]];It(ot,t,r,d),I.push(ot)}return I}function Xt(e,t,r,s){for(var d,E=8192*Math.pow(2,s.z),I=[8192*s.x,8192*s.y],G=[],se=0,be=e;se<be.length;se+=1){for(var we=[],Ze=0,ot=be[se];Ze<ot.length;Ze+=1){var bt=ot[Ze],Qt=[bt.x+I[0],bt.y+I[1]];Ro(t,Qt),we.push(Qt)}G.push(we)}if(t[2]-t[0]<=E/2){(d=t)[0]=d[1]=1/0,d[2]=d[3]=-1/0;for(var tr=0,br=G;tr<br.length;tr+=1)for(var cr=0,Zr=br[tr];cr<Zr.length;cr+=1)It(Zr[cr],t,r,E)}return G}Ds.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var s=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,Jn);if(!s)return null;var d=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,Jn);if(!d)return null;var E=null;return r.locale&&!(E=t.parse(r.locale,1,vi))?null:new Ds(s,d,E)},Ds.prototype.evaluate=function(e){return new Na(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Ds.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Ds.prototype.outputDefined=function(){return!1},Ds.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Dr=function(e,t){this.type=Jn,this.geojson=e,this.geometries=t};function Lr(e){if(e instanceof cs&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Dr)return!1;var t=!0;return e.eachChild(function(r){t&&!Lr(r)&&(t=!1)}),t}function _n(e){if(e instanceof cs&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!_n(r)&&(t=!1)}),t}function Un(e,t){if(e instanceof cs&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(s){r&&!Un(s,t)&&(r=!1)}),r}Dr.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Qi(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var s=0;s<r.features.length;++s){var d=r.features[s].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Dr(r,r.features[s].geometry)}else if(r.type==="Feature"){var E=r.geometry.type;if(E==="Polygon"||E==="MultiPolygon")return new Dr(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Dr(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Dr.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var s=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],E=t.canonicalID();if(r.type==="Polygon"){var I=to(r.coordinates,d,E),G=Ot(t.geometry(),s,d,E);if(!Eu(s,d))return!1;for(var se=0,be=G;se<be.length;se+=1)if(!ft(be[se],I))return!1}if(r.type==="MultiPolygon"){var we=Je(r.coordinates,d,E),Ze=Ot(t.geometry(),s,d,E);if(!Eu(s,d))return!1;for(var ot=0,bt=Ze;ot<bt.length;ot+=1)if(!St(bt[ot],we))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var s=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],E=t.canonicalID();if(r.type==="Polygon"){var I=to(r.coordinates,d,E),G=Xt(t.geometry(),s,d,E);if(!Eu(s,d))return!1;for(var se=0,be=G;se<be.length;se+=1)if(!$n(be[se],I))return!1}if(r.type==="MultiPolygon"){var we=Je(r.coordinates,d,E),Ze=Xt(t.geometry(),s,d,E);if(!Eu(s,d))return!1;for(var ot=0,bt=Ze;ot<bt.length;ot+=1)if(!Gi(bt[ot],we))return!1}return!0}(e,this.geometries)}return!1},Dr.prototype.eachChild=function(){},Dr.prototype.outputDefined=function(){return!0},Dr.prototype.serialize=function(){return["within",this.geojson]};var mn=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};mn.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new mn(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},mn.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},mn.prototype.eachChild=function(){},mn.prototype.outputDefined=function(){return!1},mn.prototype.serialize=function(){return["var",this.name]};var mi=function(e,t,r,s,d){t===void 0&&(t=[]),s===void 0&&(s=new hi),d===void 0&&(d=[]),this.registry=e,this.path=t,this.key=t.map(function(E){return"["+E+"]"}).join(""),this.scope=s,this.errors=d,this.expectedType=r};function Oa(e,t){for(var r,s=e.length-1,d=0,E=s,I=0;d<=E;)if((r=e[I=Math.floor((d+E)/2)])<=t){if(I===s||t<e[I+1])return I;d=I+1}else{if(!(r>t))throw new rs("Input is not a number.");E=I-1}return 0}mi.prototype.parse=function(e,t,r,s,d){return d===void 0&&(d={}),t?this.concat(t,r,s)._parse(e,d):this._parse(e,d)},mi.prototype._parse=function(e,t){function r(be,we,Ze){return Ze==="assert"?new Ia(we,[be]):Ze==="coerce"?new Ao(we,[be]):be}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var s=e[0];if(typeof s!="string")return this.error("Expression name must be a string, but found "+typeof s+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var d=this.registry[s];if(d){var E=d.parse(e,this);if(!E)return null;if(this.expectedType){var I=this.expectedType,G=E.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||G.kind!=="value")if(I.kind!=="color"&&I.kind!=="formatted"&&I.kind!=="resolvedImage"||G.kind!=="value"&&G.kind!=="string"){if(this.checkSubtype(I,G))return null}else E=r(E,I,t.typeAnnotation||"coerce");else E=r(E,I,t.typeAnnotation||"assert")}if(!(E instanceof Ss)&&E.type.kind!=="resolvedImage"&&function be(we){if(we instanceof mn)return be(we.boundExpression);if(we instanceof cs&&we.name==="error"||we instanceof Ds||we instanceof Dr)return!1;var Ze=we instanceof Ao||we instanceof Ia,ot=!0;return we.eachChild(function(bt){ot=Ze?ot&&be(bt):ot&&bt instanceof Ss}),!!ot&&Lr(we)&&Un(we,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(E)){var se=new ua;try{E=new Ss(E.type,E.evaluate(se))}catch(be){return this.error(be.message),null}}return E}return this.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},mi.prototype.concat=function(e,t,r){var s=typeof e=="number"?this.path.concat(e):this.path,d=r?this.scope.concat(r):this.scope;return new mi(this.registry,s,t||null,d,this.errors)},mi.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var s=""+this.key+t.map(function(d){return"["+d+"]"}).join("");this.errors.push(new Tn(s,e))},mi.prototype.checkSubtype=function(e,t){var r=eo(e,t);return r&&this.error(r),r};var Fn=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var s=0,d=r;s<d.length;s+=1){var E=d[s],I=E[1];this.labels.push(E[0]),this.outputs.push(I)}};function ci(e,t,r){return e*(1-r)+t*r}Fn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Pr);if(!r)return null;var s=[],d=null;t.expectedType&&t.expectedType.kind!=="value"&&(d=t.expectedType);for(var E=1;E<e.length;E+=2){var I=E===1?-1/0:e[E],G=e[E+1],se=E,be=E+1;if(typeof I!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',se);if(s.length&&s[s.length-1][0]>=I)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',se);var we=t.parse(G,be,d);if(!we)return null;d=d||we.type,s.push([I,we])}return new Fn(d,r,s)},Fn.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var s=this.input.evaluate(e);if(s<=t[0])return r[0].evaluate(e);var d=t.length;return s>=t[d-1]?r[d-1].evaluate(e):r[Oa(t,s)].evaluate(e)},Fn.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Fn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Fn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ia=Object.freeze({__proto__:null,number:ci,color:function(e,t,r){return new ba(ci(e.r,t.r,r),ci(e.g,t.g,r),ci(e.b,t.b,r),ci(e.a,t.a,r))},array:function(e,t,r){return e.map(function(s,d){return ci(s,t[d],r)})}}),_a=6/29*3*(6/29),ao=Math.PI/180,Yo=180/Math.PI;function Vo(e){return e>.008856451679035631?Math.pow(e,1/3):e/_a+4/29}function Bo(e){return e>6/29?e*e*e:_a*(e-4/29)}function mo(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Do(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ps(e){var t=Do(e.r),r=Do(e.g),s=Do(e.b),d=Vo((.4124564*t+.3575761*r+.1804375*s)/.95047),E=Vo((.2126729*t+.7151522*r+.072175*s)/1);return{l:116*E-16,a:500*(d-E),b:200*(E-Vo((.0193339*t+.119192*r+.9503041*s)/1.08883)),alpha:e.a}}function g(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,s=isNaN(e.b)?t:t-e.b/200;return t=1*Bo(t),r=.95047*Bo(r),s=1.08883*Bo(s),new ba(mo(3.2404542*r-1.5371385*t-.4985314*s),mo(-.969266*r+1.8760108*t+.041556*s),mo(.0556434*r-.2040259*t+1.0572252*s),e.alpha)}function U(e,t,r){var s=t-e;return e+r*(s>180||s<-180?s-360*Math.round(s/360):s)}var he={forward:ps,reverse:g,interpolate:function(e,t,r){return{l:ci(e.l,t.l,r),a:ci(e.a,t.a,r),b:ci(e.b,t.b,r),alpha:ci(e.alpha,t.alpha,r)}}},te={forward:function(e){var t=ps(e),r=t.l,s=t.a,d=t.b,E=Math.atan2(d,s)*Yo;return{h:E<0?E+360:E,c:Math.sqrt(s*s+d*d),l:r,alpha:e.a}},reverse:function(e){var t=e.h*ao,r=e.c;return g({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:U(e.h,t.h,r),c:ci(e.c,t.c,r),l:ci(e.l,t.l,r),alpha:ci(e.alpha,t.alpha,r)}}},tt=Object.freeze({__proto__:null,lab:he,hcl:te}),Pt=function(e,t,r,s,d){this.type=e,this.operator=t,this.interpolation=r,this.input=s,this.labels=[],this.outputs=[];for(var E=0,I=d;E<I.length;E+=1){var G=I[E],se=G[1];this.labels.push(G[0]),this.outputs.push(se)}};function fr(e,t,r,s){var d=s-r,E=e-r;return d===0?0:t===1?E/d:(Math.pow(t,E)-1)/(Math.pow(t,d)-1)}Pt.interpolationFactor=function(e,t,r,s){var d=0;if(e.name==="exponential")d=fr(t,e.base,r,s);else if(e.name==="linear")d=fr(t,1,r,s);else if(e.name==="cubic-bezier"){var E=e.controlPoints;d=new L(E[0],E[1],E[2],E[3]).solve(fr(t,1,r,s))}return d},Pt.parse=function(e,t){var r=e[0],s=e[1],d=e[2],E=e.slice(3);if(!Array.isArray(s)||s.length===0)return t.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){var I=s[1];if(typeof I!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:I}}else{if(s[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(s[0]),1,0);var G=s.slice(1);if(G.length!==4||G.some(function(br){return typeof br!="number"||br<0||br>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:G}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(d=t.parse(d,2,Pr)))return null;var se=[],be=null;r==="interpolate-hcl"||r==="interpolate-lab"?be=ui:t.expectedType&&t.expectedType.kind!=="value"&&(be=t.expectedType);for(var we=0;we<E.length;we+=2){var Ze=E[we],ot=E[we+1],bt=we+3,Qt=we+4;if(typeof Ze!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',bt);if(se.length&&se[se.length-1][0]>=Ze)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',bt);var tr=t.parse(ot,Qt,be);if(!tr)return null;be=be||tr.type,se.push([Ze,tr])}return be.kind==="number"||be.kind==="color"||be.kind==="array"&&be.itemType.kind==="number"&&typeof be.N=="number"?new Pt(be,r,s,d,se):t.error("Type "+Ga(be)+" is not interpolatable.")},Pt.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var s=this.input.evaluate(e);if(s<=t[0])return r[0].evaluate(e);var d=t.length;if(s>=t[d-1])return r[d-1].evaluate(e);var E=Oa(t,s),I=Pt.interpolationFactor(this.interpolation,s,t[E],t[E+1]),G=r[E].evaluate(e),se=r[E+1].evaluate(e);return this.operator==="interpolate"?ia[this.type.kind.toLowerCase()](G,se,I):this.operator==="interpolate-hcl"?te.reverse(te.interpolate(te.forward(G),te.forward(se),I)):he.reverse(he.interpolate(he.forward(G),he.forward(se),I))},Pt.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Pt.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Pt.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var Fr=function(e,t){this.type=e,this.args=t};Fr.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,s=t.expectedType;s&&s.kind!=="value"&&(r=s);for(var d=[],E=0,I=e.slice(1);E<I.length;E+=1){var G=t.parse(I[E],1+d.length,r,void 0,{typeAnnotation:"omit"});if(!G)return null;r=r||G.type,d.push(G)}var se=s&&d.some(function(be){return eo(s,be.type)});return new Fr(se?Yn:r,d)},Fr.prototype.evaluate=function(e){for(var t,r=null,s=0,d=0,E=this.args;d<E.length&&(s++,(r=E[d].evaluate(e))&&r instanceof Gt&&!r.available&&(t||(t=r.name),r=null,s===this.args.length&&(r=t)),r===null);d+=1);return r},Fr.prototype.eachChild=function(e){this.args.forEach(e)},Fr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Fr.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var zr=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};zr.prototype.evaluate=function(e){return this.result.evaluate(e)},zr.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},zr.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],s=1;s<e.length-1;s+=2){var d=e[s];if(typeof d!="string")return t.error("Expected string, but found "+typeof d+" instead.",s);if(/[^a-zA-Z0-9_]/.test(d))return t.error("Variable names must contain only alphanumeric characters or '_'.",s);var E=t.parse(e[s+1],s+1);if(!E)return null;r.push([d,E])}var I=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return I?new zr(r,I):null},zr.prototype.outputDefined=function(){return this.result.outputDefined()},zr.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var s=r[t];e.push(s[0],s[1].serialize())}return e.push(this.result.serialize()),e};var En=function(e,t,r){this.type=e,this.index=t,this.input=r};En.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Pr),s=t.parse(e[2],2,Ka(t.expectedType||Yn));return r&&s?new En(s.type.itemType,r,s):null},En.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new rs("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new rs("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new rs("Array index must be an integer, but found "+t+" instead.");return r[t]},En.prototype.eachChild=function(e){e(this.index),e(this.input)},En.prototype.outputDefined=function(){return!1},En.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Dn=function(e,t){this.type=Jn,this.needle=e,this.haystack=t};Dn.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Yn),s=t.parse(e[2],2,Yn);return r&&s?ra(r.type,[Jn,vi,Pr,On,Yn])?new Dn(r,s):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ga(r.type)+" instead"):null},Dn.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Rn(t,["boolean","string","number","null"]))throw new rs("Expected first argument to be of type boolean, string, number or null, but found "+Ga(So(t))+" instead.");if(!Rn(r,["string","array"]))throw new rs("Expected second argument to be of type array or string, but found "+Ga(So(r))+" instead.");return r.indexOf(t)>=0},Dn.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Dn.prototype.outputDefined=function(){return!0},Dn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var na=function(e,t,r){this.type=Pr,this.needle=e,this.haystack=t,this.fromIndex=r};na.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Yn),s=t.parse(e[2],2,Yn);if(!r||!s)return null;if(!ra(r.type,[Jn,vi,Pr,On,Yn]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ga(r.type)+" instead");if(e.length===4){var d=t.parse(e[3],3,Pr);return d?new na(r,s,d):null}return new na(r,s)},na.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Rn(t,["boolean","string","number","null"]))throw new rs("Expected first argument to be of type boolean, string, number or null, but found "+Ga(So(t))+" instead.");if(!Rn(r,["string","array"]))throw new rs("Expected second argument to be of type array or string, but found "+Ga(So(r))+" instead.");if(this.fromIndex){var s=this.fromIndex.evaluate(e);return r.indexOf(t,s)}return r.indexOf(t)},na.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},na.prototype.outputDefined=function(){return!1},na.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ka=function(e,t,r,s,d,E){this.inputType=e,this.type=t,this.input=r,this.cases=s,this.outputs=d,this.otherwise=E};ka.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,s;t.expectedType&&t.expectedType.kind!=="value"&&(s=t.expectedType);for(var d={},E=[],I=2;I<e.length-1;I+=2){var G=e[I],se=e[I+1];Array.isArray(G)||(G=[G]);var be=t.concat(I);if(G.length===0)return be.error("Expected at least one branch label.");for(var we=0,Ze=G;we<Ze.length;we+=1){var ot=Ze[we];if(typeof ot!="number"&&typeof ot!="string")return be.error("Branch labels must be numbers or strings.");if(typeof ot=="number"&&Math.abs(ot)>Number.MAX_SAFE_INTEGER)return be.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof ot=="number"&&Math.floor(ot)!==ot)return be.error("Numeric branch labels must be integer values.");if(r){if(be.checkSubtype(r,So(ot)))return null}else r=So(ot);if(d[String(ot)]!==void 0)return be.error("Branch labels must be unique.");d[String(ot)]=E.length}var bt=t.parse(se,I,s);if(!bt)return null;s=s||bt.type,E.push(bt)}var Qt=t.parse(e[1],1,Yn);if(!Qt)return null;var tr=t.parse(e[e.length-1],e.length-1,s);return tr?Qt.type.kind!=="value"&&t.concat(1).checkSubtype(r,Qt.type)?null:new ka(r,s,Qt,d,E,tr):null},ka.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(So(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},ka.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},ka.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},ka.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],s={},d=0,E=Object.keys(this.cases).sort();d<E.length;d+=1){var I=E[d];(Ze=s[this.cases[I]])===void 0?(s[this.cases[I]]=r.length,r.push([this.cases[I],[I]])):r[Ze][1].push(I)}for(var G=function(bt){return e.inputType.kind==="number"?Number(bt):bt},se=0,be=r;se<be.length;se+=1){var we=be[se],Ze=we[0],ot=we[1];t.push(ot.length===1?G(ot[0]):ot.map(G)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var ha=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};ha.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var s=[],d=1;d<e.length-1;d+=2){var E=t.parse(e[d],d,Jn);if(!E)return null;var I=t.parse(e[d+1],d+1,r);if(!I)return null;s.push([E,I]),r=r||I.type}var G=t.parse(e[e.length-1],e.length-1,r);return G?new ha(r,s,G):null},ha.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var s=r[t],d=s[1];if(s[0].evaluate(e))return d.evaluate(e)}return this.otherwise.evaluate(e)},ha.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var s=r[t],d=s[1];e(s[0]),e(d)}e(this.otherwise)},ha.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},ha.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Fa=function(e,t,r,s){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=s};function Mo(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Po(e,t,r,s){return s.compare(t,r)===0}function go(e,t,r){var s=e!=="=="&&e!=="!=";return function(){function d(E,I,G){this.type=Jn,this.lhs=E,this.rhs=I,this.collator=G,this.hasUntypedArgument=E.type.kind==="value"||I.type.kind==="value"}return d.parse=function(E,I){if(E.length!==3&&E.length!==4)return I.error("Expected two or three arguments.");var G=E[0],se=I.parse(E[1],1,Yn);if(!se)return null;if(!Mo(G,se.type))return I.concat(1).error('"'+G+`" comparisons are not supported for type '`+Ga(se.type)+"'.");var be=I.parse(E[2],2,Yn);if(!be)return null;if(!Mo(G,be.type))return I.concat(2).error('"'+G+`" comparisons are not supported for type '`+Ga(be.type)+"'.");if(se.type.kind!==be.type.kind&&se.type.kind!=="value"&&be.type.kind!=="value")return I.error("Cannot compare types '"+Ga(se.type)+"' and '"+Ga(be.type)+"'.");s&&(se.type.kind==="value"&&be.type.kind!=="value"?se=new Ia(be.type,[se]):se.type.kind!=="value"&&be.type.kind==="value"&&(be=new Ia(se.type,[be])));var we=null;if(E.length===4){if(se.type.kind!=="string"&&be.type.kind!=="string"&&se.type.kind!=="value"&&be.type.kind!=="value")return I.error("Cannot use collator to compare non-string types.");if(!(we=I.parse(E[3],3,wa)))return null}return new d(se,be,we)},d.prototype.evaluate=function(E){var I=this.lhs.evaluate(E),G=this.rhs.evaluate(E);if(s&&this.hasUntypedArgument){var se=So(I),be=So(G);if(se.kind!==be.kind||se.kind!=="string"&&se.kind!=="number")throw new rs('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+se.kind+", "+be.kind+") instead.")}if(this.collator&&!s&&this.hasUntypedArgument){var we=So(I),Ze=So(G);if(we.kind!=="string"||Ze.kind!=="string")return t(E,I,G)}return this.collator?r(E,I,G,this.collator.evaluate(E)):t(E,I,G)},d.prototype.eachChild=function(E){E(this.lhs),E(this.rhs),this.collator&&E(this.collator)},d.prototype.outputDefined=function(){return!0},d.prototype.serialize=function(){var E=[e];return this.eachChild(function(I){E.push(I.serialize())}),E},d}()}Fa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Yn),s=t.parse(e[2],2,Pr);if(!r||!s)return null;if(!ra(r.type,[Ka(Yn),vi,Yn]))return t.error("Expected first argument to be of type array or string, but found "+Ga(r.type)+" instead");if(e.length===4){var d=t.parse(e[3],3,Pr);return d?new Fa(r.type,r,s,d):null}return new Fa(r.type,r,s)},Fa.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Rn(t,["string","array"]))throw new rs("Expected first argument to be of type array or string, but found "+Ga(So(t))+" instead.");if(this.endIndex){var s=this.endIndex.evaluate(e);return t.slice(r,s)}return t.slice(r)},Fa.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Fa.prototype.outputDefined=function(){return!1},Fa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var fu=go("==",function(e,t,r){return t===r},Po),yo=go("!=",function(e,t,r){return t!==r},function(e,t,r,s){return!Po(0,t,r,s)}),Zu=go("<",function(e,t,r){return t<r},function(e,t,r,s){return s.compare(t,r)<0}),tc=go(">",function(e,t,r){return t>r},function(e,t,r,s){return s.compare(t,r)>0}),ws=go("<=",function(e,t,r){return t<=r},function(e,t,r,s){return s.compare(t,r)<=0}),Nc=go(">=",function(e,t,r){return t>=r},function(e,t,r,s){return s.compare(t,r)>=0}),$u=function(e,t,r,s,d){this.type=vi,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=s,this.maxFractionDigits=d};$u.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Pr);if(!r)return null;var s=e[2];if(typeof s!="object"||Array.isArray(s))return t.error("NumberFormat options argument must be an object.");var d=null;if(s.locale&&!(d=t.parse(s.locale,1,vi)))return null;var E=null;if(s.currency&&!(E=t.parse(s.currency,1,vi)))return null;var I=null;if(s["min-fraction-digits"]&&!(I=t.parse(s["min-fraction-digits"],1,Pr)))return null;var G=null;return s["max-fraction-digits"]&&!(G=t.parse(s["max-fraction-digits"],1,Pr))?null:new $u(r,d,E,I,G)},$u.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},$u.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},$u.prototype.outputDefined=function(){return!1},$u.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ku=function(e){this.type=Pr,this.input=e};Ku.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ga(r.type)+" instead."):new Ku(r):null},Ku.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new rs("Expected value to be of type string or array, but found "+Ga(So(t))+" instead.")},Ku.prototype.eachChild=function(e){e(this.input)},Ku.prototype.outputDefined=function(){return!1},Ku.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var xl={"==":fu,"!=":yo,">":tc,"<":Zu,">=":Nc,"<=":ws,array:Ia,at:En,boolean:Ia,case:ha,coalesce:Fr,collator:Ds,format:Ms,image:uo,in:Dn,"index-of":na,interpolate:Pt,"interpolate-hcl":Pt,"interpolate-lab":Pt,length:Ku,let:zr,literal:Ss,match:ka,number:Ia,"number-format":$u,object:Ia,slice:Fa,step:Fn,string:Ia,"to-boolean":Ao,"to-color":Ao,"to-number":Ao,"to-string":Ao,var:mn,within:Dr};function qo(e,t){var r=t[0],s=t[1],d=t[2],E=t[3];r=r.evaluate(e),s=s.evaluate(e),d=d.evaluate(e);var I=E?E.evaluate(e):1,G=gs(r,s,d,I);if(G)throw new rs(G);return new ba(r/255*I,s/255*I,d/255*I,I)}function rc(e,t){return e in t}function Ec(e,t){var r=t[e];return r===void 0?null:r}function Va(e){return{type:e}}function qu(e){return{result:"success",value:e}}function ys(e){return{result:"error",value:e}}function ss(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function bl(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function El(e){return!!e.expression&&e.expression.interpolated}function To(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Ps(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function hf(e){return e}function ju(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function zc(e,t,r,s,d){return ju(typeof r===d?s[r]:void 0,e.default,t.default)}function Uc(e,t,r){if(To(r)!=="number")return ju(e.default,t.default);var s=e.stops.length;if(s===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[s-1][0])return e.stops[s-1][1];var d=Oa(e.stops.map(function(E){return E[0]}),r);return e.stops[d][1]}function Bf(e,t,r){var s=e.base!==void 0?e.base:1;if(To(r)!=="number")return ju(e.default,t.default);var d=e.stops.length;if(d===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[d-1][0])return e.stops[d-1][1];var E=Oa(e.stops.map(function(Ze){return Ze[0]}),r),I=function(Ze,ot,bt,Qt){var tr=Qt-bt,br=Ze-bt;return tr===0?0:ot===1?br/tr:(Math.pow(ot,br)-1)/(Math.pow(ot,tr)-1)}(r,s,e.stops[E][0],e.stops[E+1][0]),G=e.stops[E][1],se=e.stops[E+1][1],be=ia[t.type]||hf;if(e.colorSpace&&e.colorSpace!=="rgb"){var we=tt[e.colorSpace];be=function(Ze,ot){return we.reverse(we.interpolate(we.forward(Ze),we.forward(ot),I))}}return typeof G.evaluate=="function"?{evaluate:function(){for(var Ze=[],ot=arguments.length;ot--;)Ze[ot]=arguments[ot];var bt=G.evaluate.apply(void 0,Ze),Qt=se.evaluate.apply(void 0,Ze);if(bt!==void 0&&Qt!==void 0)return be(bt,Qt,I)}}:be(G,se,I)}function Jc(e,t,r){return t.type==="color"?r=ba.parse(r):t.type==="formatted"?r=ya.fromString(r.toString()):t.type==="resolvedImage"?r=Gt.fromString(r.toString()):To(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),ju(r,e.default,t.default)}cs.register(xl,{error:[{kind:"error"},[vi],function(e,t){throw new rs(t[0].evaluate(e))}],typeof:[vi,[Yn],function(e,t){return Ga(So(t[0].evaluate(e)))}],"to-rgba":[Ka(Pr,4),[ui],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[ui,[Pr,Pr,Pr],qo],rgba:[ui,[Pr,Pr,Pr,Pr],qo],has:{type:Jn,overloads:[[[vi],function(e,t){return rc(t[0].evaluate(e),e.properties())}],[[vi,Da],function(e,t){var r=t[1];return rc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:Yn,overloads:[[[vi],function(e,t){return Ec(t[0].evaluate(e),e.properties())}],[[vi,Da],function(e,t){var r=t[1];return Ec(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[Yn,[vi],function(e,t){return Ec(t[0].evaluate(e),e.featureState||{})}],properties:[Da,[],function(e){return e.properties()}],"geometry-type":[vi,[],function(e){return e.geometryType()}],id:[Yn,[],function(e){return e.id()}],zoom:[Pr,[],function(e){return e.globals.zoom}],"heatmap-density":[Pr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Pr,[],function(e){return e.globals.lineProgress||0}],accumulated:[Yn,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Pr,Va(Pr),function(e,t){for(var r=0,s=0,d=t;s<d.length;s+=1)r+=d[s].evaluate(e);return r}],"*":[Pr,Va(Pr),function(e,t){for(var r=1,s=0,d=t;s<d.length;s+=1)r*=d[s].evaluate(e);return r}],"-":{type:Pr,overloads:[[[Pr,Pr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Pr],function(e,t){return-t[0].evaluate(e)}]]},"/":[Pr,[Pr,Pr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Pr,[Pr,Pr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Pr,[],function(){return Math.LN2}],pi:[Pr,[],function(){return Math.PI}],e:[Pr,[],function(){return Math.E}],"^":[Pr,[Pr,Pr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Pr,[Pr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Pr,[Pr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Pr,[Pr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Pr,[Pr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Pr,[Pr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Pr,[Pr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Pr,[Pr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Pr,[Pr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Pr,[Pr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Pr,[Pr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Pr,Va(Pr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[Pr,Va(Pr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[Pr,[Pr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Pr,[Pr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Pr,[Pr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Pr,[Pr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Jn,[vi,Yn],function(e,t){var r=t[0],s=t[1];return e.properties()[r.value]===s.value}],"filter-id-==":[Jn,[Yn],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[Jn,[vi],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[Jn,[vi,Yn],function(e,t){var r=t[0],s=t[1],d=e.properties()[r.value],E=s.value;return typeof d==typeof E&&d<E}],"filter-id-<":[Jn,[Yn],function(e,t){var r=t[0],s=e.id(),d=r.value;return typeof s==typeof d&&s<d}],"filter->":[Jn,[vi,Yn],function(e,t){var r=t[0],s=t[1],d=e.properties()[r.value],E=s.value;return typeof d==typeof E&&d>E}],"filter-id->":[Jn,[Yn],function(e,t){var r=t[0],s=e.id(),d=r.value;return typeof s==typeof d&&s>d}],"filter-<=":[Jn,[vi,Yn],function(e,t){var r=t[0],s=t[1],d=e.properties()[r.value],E=s.value;return typeof d==typeof E&&d<=E}],"filter-id-<=":[Jn,[Yn],function(e,t){var r=t[0],s=e.id(),d=r.value;return typeof s==typeof d&&s<=d}],"filter->=":[Jn,[vi,Yn],function(e,t){var r=t[0],s=t[1],d=e.properties()[r.value],E=s.value;return typeof d==typeof E&&d>=E}],"filter-id->=":[Jn,[Yn],function(e,t){var r=t[0],s=e.id(),d=r.value;return typeof s==typeof d&&s>=d}],"filter-has":[Jn,[Yn],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Jn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Jn,[Ka(vi)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Jn,[Ka(Yn)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Jn,[vi,Ka(Yn)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[Jn,[vi,Ka(Yn)],function(e,t){var r=t[0],s=t[1];return function(d,E,I,G){for(;I<=G;){var se=I+G>>1;if(E[se]===d)return!0;E[se]>d?G=se-1:I=se+1}return!1}(e.properties()[r.value],s.value,0,s.value.length-1)}],all:{type:Jn,overloads:[[[Jn,Jn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Va(Jn),function(e,t){for(var r=0,s=t;r<s.length;r+=1)if(!s[r].evaluate(e))return!1;return!0}]]},any:{type:Jn,overloads:[[[Jn,Jn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Va(Jn),function(e,t){for(var r=0,s=t;r<s.length;r+=1)if(s[r].evaluate(e))return!0;return!1}]]},"!":[Jn,[Jn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Jn,[vi],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[vi,[vi],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[vi,[vi],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[vi,Va(Yn),function(e,t){return t.map(function(r){return ll(r.evaluate(e))}).join("")}],"resolved-locale":[vi,[wa],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var vu=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new ua,this._defaultValue=t?function(r){return r.type==="color"&&Ps(r.default)?new ba(0,0,0,0):r.type==="color"?ba.parse(r.default)||null:r.default===void 0?null:r.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function Ul(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in xl}function Qu(e,t){var r=new mi(xl,[],t?function(d){var E={color:ui,string:vi,number:Pr,enum:vi,boolean:Jn,formatted:vo,resolvedImage:Ua};return d.type==="array"?Ka(E[d.value]||Yn,d.length):E[d.type]}(t):void 0),s=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?qu(new vu(s,t)):ys(r.errors)}vu.prototype.evaluateWithoutErrorHandling=function(e,t,r,s,d,E){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=s,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)},vu.prototype.evaluate=function(e,t,r,s,d,E){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=s,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=E||null;try{var I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new rs("Expected value to be one of "+Object.keys(this._enumValues).map(function(G){return JSON.stringify(G)}).join(", ")+", but found "+JSON.stringify(I)+" instead.");return I}catch(G){return this._warningHistory[G.message]||(this._warningHistory[G.message]=!0,typeof console!="undefined"&&console.warn(G.message)),this._defaultValue}};var Cu=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!_n(t.expression)};Cu.prototype.evaluateWithoutErrorHandling=function(e,t,r,s,d,E){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,s,d,E)},Cu.prototype.evaluate=function(e,t,r,s,d,E){return this._styleExpression.evaluate(e,t,r,s,d,E)};var Zl=function(e,t,r,s){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!_n(t.expression),this.interpolationType=s};function nc(e,t){if((e=Qu(e,t)).result==="error")return e;var r=e.value.expression,s=Lr(r);if(!s&&!ss(t))return ys([new Tn("","data expressions not supported")]);var d=Un(r,["zoom"]);if(!d&&!bl(t))return ys([new Tn("","zoom expressions not supported")]);var E=function I(G){var se=null;if(G instanceof zr)se=I(G.result);else if(G instanceof Fr)for(var be=0,we=G.args;be<we.length&&!(se=I(we[be]));be+=1);else(G instanceof Fn||G instanceof Pt)&&G.input instanceof cs&&G.input.name==="zoom"&&(se=G);return se instanceof Tn||G.eachChild(function(Ze){var ot=I(Ze);ot instanceof Tn?se=ot:!se&&ot?se=new Tn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):se&&ot&&se!==ot&&(se=new Tn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),se}(r);return E||d?E instanceof Tn?ys([E]):E instanceof Pt&&!El(t)?ys([new Tn("",'"interpolate" expressions cannot be used with this property')]):qu(E?new Zl(s?"camera":"composite",e.value,E.labels,E instanceof Pt?E.interpolation:void 0):new Cu(s?"constant":"source",e.value)):ys([new Tn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Zl.prototype.evaluateWithoutErrorHandling=function(e,t,r,s,d,E){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,s,d,E)},Zl.prototype.evaluate=function(e,t,r,s,d,E){return this._styleExpression.evaluate(e,t,r,s,d,E)},Zl.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?Pt.interpolationFactor(this.interpolationType,e,t,r):0};var ic=function(e,t){this._parameters=e,this._specification=t,fn(this,function r(s,d){var E,I,G,se=d.type==="color",be=s.stops&&typeof s.stops[0][0]=="object",we=be||!(be||s.property!==void 0),Ze=s.type||(El(d)?"exponential":"interval");if(se&&((s=fn({},s)).stops&&(s.stops=s.stops.map(function(Fi){return[Fi[0],ba.parse(Fi[1])]})),s.default=ba.parse(s.default?s.default:d.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!tt[s.colorSpace])throw new Error("Unknown color space: "+s.colorSpace);if(Ze==="exponential")E=Bf;else if(Ze==="interval")E=Uc;else if(Ze==="categorical"){E=zc,I=Object.create(null);for(var ot=0,bt=s.stops;ot<bt.length;ot+=1){var Qt=bt[ot];I[Qt[0]]=Qt[1]}G=typeof s.stops[0][0]}else{if(Ze!=="identity")throw new Error('Unknown function type "'+Ze+'"');E=Jc}if(be){for(var tr={},br=[],cr=0;cr<s.stops.length;cr++){var Zr=s.stops[cr],Yr=Zr[0].zoom;tr[Yr]===void 0&&(tr[Yr]={zoom:Yr,type:s.type,property:s.property,default:s.default,stops:[]},br.push(Yr)),tr[Yr].stops.push([Zr[0].value,Zr[1]])}for(var ln=[],vn=0,Ln=br;vn<Ln.length;vn+=1){var oi=Ln[vn];ln.push([tr[oi].zoom,r(tr[oi],d)])}var wi={name:"linear"};return{kind:"composite",interpolationType:wi,interpolationFactor:Pt.interpolationFactor.bind(void 0,wi),zoomStops:ln.map(function(Fi){return Fi[0]}),evaluate:function(Fi,Ca){var Ni=Fi.zoom;return Bf({stops:ln,base:s.base},d,Ni).evaluate(Ni,Ca)}}}if(we){var va=Ze==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:va,interpolationFactor:Pt.interpolationFactor.bind(void 0,va),zoomStops:s.stops.map(function(Fi){return Fi[0]}),evaluate:function(Fi){return E(s,d,Fi.zoom,I,G)}}}return{kind:"source",evaluate:function(Fi,Ca){var Ni=Ca&&Ca.properties?Ca.properties[s.property]:void 0;return Ni===void 0?ju(s.default,d.default):E(s,d,Ni,I,G)}}}(this._parameters,this._specification))};function Gu(e){var t=e.key,r=e.value,s=e.valueSpec||{},d=e.objectElementValidators||{},E=e.style,I=e.styleSpec,G=[],se=To(r);if(se!=="object")return[new Nt(t,r,"object expected, "+se+" found")];for(var be in r){var we=be.split(".")[0],Ze=s[we]||s["*"],ot=void 0;if(d[we])ot=d[we];else if(s[we])ot=oa;else if(d["*"])ot=d["*"];else{if(!s["*"]){G.push(new Nt(t,r[be],'unknown property "'+be+'"'));continue}ot=oa}G=G.concat(ot({key:(t&&t+".")+be,value:r[be],valueSpec:Ze,style:E,styleSpec:I,object:r,objectKey:be},r))}for(var bt in s)d[bt]||s[bt].required&&s[bt].default===void 0&&r[bt]===void 0&&G.push(new Nt(t,r,'missing required property "'+bt+'"'));return G}function pf(e){var t=e.value,r=e.valueSpec,s=e.style,d=e.styleSpec,E=e.key,I=e.arrayElementValidator||oa;if(To(t)!=="array")return[new Nt(E,t,"array expected, "+To(t)+" found")];if(r.length&&t.length!==r.length)return[new Nt(E,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Nt(E,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var G={type:r.value,values:r.values};d.$version<7&&(G.function=r.function),To(r.value)==="object"&&(G=r.value);for(var se=[],be=0;be<t.length;be++)se=se.concat(I({array:t,arrayIndex:be,value:t[be],valueSpec:G,style:s,styleSpec:d,key:E+"["+be+"]"}));return se}function Cc(e){var t=e.key,r=e.value,s=e.valueSpec,d=To(r);return d==="number"&&r!=r&&(d="NaN"),d!=="number"?[new Nt(t,r,"number expected, "+d+" found")]:"minimum"in s&&r<s.minimum?[new Nt(t,r,r+" is less than the minimum value "+s.minimum)]:"maximum"in s&&r>s.maximum?[new Nt(t,r,r+" is greater than the maximum value "+s.maximum)]:[]}function ef(e){var t,r,s,d=e.valueSpec,E=Br(e.value.type),I={},G=E!=="categorical"&&e.value.property===void 0,se=!G,be=To(e.value.stops)==="array"&&To(e.value.stops[0])==="array"&&To(e.value.stops[0][0])==="object",we=Gu({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(bt){if(E==="identity")return[new Nt(bt.key,bt.value,'identity function may not have a "stops" property')];var Qt=[],tr=bt.value;return Qt=Qt.concat(pf({key:bt.key,value:tr,valueSpec:bt.valueSpec,style:bt.style,styleSpec:bt.styleSpec,arrayElementValidator:Ze})),To(tr)==="array"&&tr.length===0&&Qt.push(new Nt(bt.key,tr,"array must have at least one stop")),Qt},default:function(bt){return oa({key:bt.key,value:bt.value,valueSpec:d,style:bt.style,styleSpec:bt.styleSpec})}}});return E==="identity"&&G&&we.push(new Nt(e.key,e.value,'missing required property "property"')),E==="identity"||e.value.stops||we.push(new Nt(e.key,e.value,'missing required property "stops"')),E==="exponential"&&e.valueSpec.expression&&!El(e.valueSpec)&&we.push(new Nt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(se&&!ss(e.valueSpec)?we.push(new Nt(e.key,e.value,"property functions not supported")):G&&!bl(e.valueSpec)&&we.push(new Nt(e.key,e.value,"zoom functions not supported"))),E!=="categorical"&&!be||e.value.property!==void 0||we.push(new Nt(e.key,e.value,'"property" property is required')),we;function Ze(bt){var Qt=[],tr=bt.value,br=bt.key;if(To(tr)!=="array")return[new Nt(br,tr,"array expected, "+To(tr)+" found")];if(tr.length!==2)return[new Nt(br,tr,"array length 2 expected, length "+tr.length+" found")];if(be){if(To(tr[0])!=="object")return[new Nt(br,tr,"object expected, "+To(tr[0])+" found")];if(tr[0].zoom===void 0)return[new Nt(br,tr,"object stop key must have zoom")];if(tr[0].value===void 0)return[new Nt(br,tr,"object stop key must have value")];if(s&&s>Br(tr[0].zoom))return[new Nt(br,tr[0].zoom,"stop zoom values must appear in ascending order")];Br(tr[0].zoom)!==s&&(s=Br(tr[0].zoom),r=void 0,I={}),Qt=Qt.concat(Gu({key:br+"[0]",value:tr[0],valueSpec:{zoom:{}},style:bt.style,styleSpec:bt.styleSpec,objectElementValidators:{zoom:Cc,value:ot}}))}else Qt=Qt.concat(ot({key:br+"[0]",value:tr[0],valueSpec:{},style:bt.style,styleSpec:bt.styleSpec},tr));return Ul(Jr(tr[1]))?Qt.concat([new Nt(br+"[1]",tr[1],"expressions are not allowed in function stops.")]):Qt.concat(oa({key:br+"[1]",value:tr[1],valueSpec:d,style:bt.style,styleSpec:bt.styleSpec}))}function ot(bt,Qt){var tr=To(bt.value),br=Br(bt.value),cr=bt.value!==null?bt.value:Qt;if(t){if(tr!==t)return[new Nt(bt.key,cr,tr+" stop domain type must match previous stop domain type "+t)]}else t=tr;if(tr!=="number"&&tr!=="string"&&tr!=="boolean")return[new Nt(bt.key,cr,"stop domain value must be a number, string, or boolean")];if(tr!=="number"&&E!=="categorical"){var Zr="number expected, "+tr+" found";return ss(d)&&E===void 0&&(Zr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Nt(bt.key,cr,Zr)]}return E!=="categorical"||tr!=="number"||isFinite(br)&&Math.floor(br)===br?E!=="categorical"&&tr==="number"&&r!==void 0&&br<r?[new Nt(bt.key,cr,"stop domain values must appear in ascending order")]:(r=br,E==="categorical"&&br in I?[new Nt(bt.key,cr,"stop domain values must be unique")]:(I[br]=!0,[])):[new Nt(bt.key,cr,"integer expected, found "+br)]}}function ko(e){var t=(e.expressionContext==="property"?nc:Qu)(Jr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(s){return new Nt(""+e.key+s.key,e.value,s.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Nt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!_n(r))return[new Nt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!_n(r))return[new Nt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Un(r,["zoom","feature-state"]))return[new Nt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Lr(r))return[new Nt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zc(e){var t=e.key,r=e.value,s=e.valueSpec,d=[];return Array.isArray(s.values)?s.values.indexOf(Br(r))===-1&&d.push(new Nt(t,r,"expected one of ["+s.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(s.values).indexOf(Br(r))===-1&&d.push(new Nt(t,r,"expected one of ["+Object.keys(s.values).join(", ")+"], "+JSON.stringify(r)+" found")),d}function Su(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var s=r[t];if(!Su(s)&&typeof s!="boolean")return!1}return!0;default:return!0}}ic.deserialize=function(e){return new ic(e._parameters,e._specification)},ic.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var jl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cl(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Su(e)||(e=Gl(e));var t=Qu(e,jl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,s,d){return t.value.evaluate(r,s,{},d)},needGeometry:function r(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(var d=1;d<s.length;d++)if(r(s[d]))return!0;return!1}(e)}}function tf(e,t){return e<t?-1:e>t?1:0}function Gl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?fl(e[1],e[2],"=="):r==="!="?Cl(fl(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?fl(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(Gl))):r==="all"?["all"].concat(e.slice(1).map(Gl)):r==="none"?["all"].concat(e.slice(1).map(Gl).map(Cl)):r==="in"?jc(e[1],e.slice(2)):r==="!in"?Cl(jc(e[1],e.slice(2))):r==="has"?Vl(e[1]):r==="!has"?Cl(Vl(e[1])):r!=="within"||e}function fl(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function jc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(tf)]]:["filter-in-small",e,["literal",t]]}}function Vl(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Cl(e){return["!",e]}function Nf(e){return Su(Jr(e.value))?ko(fn({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var s=r.value,d=r.key;if(To(s)!=="array")return[new Nt(d,s,"array expected, "+To(s)+" found")];var E,I=r.styleSpec,G=[];if(s.length<1)return[new Nt(d,s,"filter array must have at least 1 element")];switch(G=G.concat(Zc({key:d+"[0]",value:s[0],valueSpec:I.filter_operator,style:r.style,styleSpec:r.styleSpec})),Br(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&Br(s[1])==="$type"&&G.push(new Nt(d,s,'"$type" cannot be use with operator "'+s[0]+'"'));case"==":case"!=":s.length!==3&&G.push(new Nt(d,s,'filter array for operator "'+s[0]+'" must have 3 elements'));case"in":case"!in":s.length>=2&&(E=To(s[1]))!=="string"&&G.push(new Nt(d+"[1]",s[1],"string expected, "+E+" found"));for(var se=2;se<s.length;se++)E=To(s[se]),Br(s[1])==="$type"?G=G.concat(Zc({key:d+"["+se+"]",value:s[se],valueSpec:I.geometry_type,style:r.style,styleSpec:r.styleSpec})):E!=="string"&&E!=="number"&&E!=="boolean"&&G.push(new Nt(d+"["+se+"]",s[se],"string, number, or boolean expected, "+E+" found"));break;case"any":case"all":case"none":for(var be=1;be<s.length;be++)G=G.concat(t({key:d+"["+be+"]",value:s[be],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":E=To(s[1]),s.length!==2?G.push(new Nt(d,s,'filter array for "'+s[0]+'" operator must have 2 elements')):E!=="string"&&G.push(new Nt(d+"[1]",s[1],"string expected, "+E+" found"));break;case"within":E=To(s[1]),s.length!==2?G.push(new Nt(d,s,'filter array for "'+s[0]+'" operator must have 2 elements')):E!=="object"&&G.push(new Nt(d+"[1]",s[1],"object expected, "+E+" found"))}return G}(e)}function rf(e,t){var r=e.key,s=e.style,d=e.styleSpec,E=e.value,I=e.objectKey,G=d[t+"_"+e.layerType];if(!G)return[];var se=I.match(/^(.*)-transition$/);if(t==="paint"&&se&&G[se[1]]&&G[se[1]].transition)return oa({key:r,value:E,valueSpec:d.transition,style:s,styleSpec:d});var be,we=e.valueSpec||G[I];if(!we)return[new Nt(r,E,'unknown property "'+I+'"')];if(To(E)==="string"&&ss(we)&&!we.tokens&&(be=/^{([^}]+)}$/.exec(E)))return[new Nt(r,E,'"'+I+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(be[1])+" }`.")];var Ze=[];return e.layerType==="symbol"&&(I==="text-field"&&s&&!s.glyphs&&Ze.push(new Nt(r,E,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&Ps(Jr(E))&&Br(E.type)==="identity"&&Ze.push(new Nt(r,E,'"text-font" does not support identity functions'))),Ze.concat(oa({key:e.key,value:E,valueSpec:we,style:s,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:I}))}function le(e){return rf(e,"paint")}function Ve(e){return rf(e,"layout")}function _t(e){var t=[],r=e.value,s=e.key,d=e.style,E=e.styleSpec;r.type||r.ref||t.push(new Nt(s,r,'either "type" or "ref" is required'));var I,G=Br(r.type),se=Br(r.ref);if(r.id)for(var be=Br(r.id),we=0;we<e.arrayIndex;we++){var Ze=d.layers[we];Br(Ze.id)===be&&t.push(new Nt(s,r.id,'duplicate layer id "'+r.id+'", previously used at line '+Ze.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Qt){Qt in r&&t.push(new Nt(s,r[Qt],'"'+Qt+'" is prohibited for ref layers'))}),d.layers.forEach(function(Qt){Br(Qt.id)===se&&(I=Qt)}),I?I.ref?t.push(new Nt(s,r.ref,"ref cannot reference another ref layer")):G=Br(I.type):t.push(new Nt(s,r.ref,'ref layer "'+se+'" not found'));else if(G!=="background")if(r.source){var ot=d.sources&&d.sources[r.source],bt=ot&&Br(ot.type);ot?bt==="vector"&&G==="raster"?t.push(new Nt(s,r.source,'layer "'+r.id+'" requires a raster source')):bt==="raster"&&G!=="raster"?t.push(new Nt(s,r.source,'layer "'+r.id+'" requires a vector source')):bt!=="vector"||r["source-layer"]?bt==="raster-dem"&&G!=="hillshade"?t.push(new Nt(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):G!=="line"||!r.paint||!r.paint["line-gradient"]||bt==="geojson"&&ot.lineMetrics||t.push(new Nt(s,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Nt(s,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Nt(s,r.source,'source "'+r.source+'" not found'))}else t.push(new Nt(s,r,'missing required property "source"'));return t=t.concat(Gu({key:s,value:r,valueSpec:E.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return oa({key:s+".type",value:r.type,valueSpec:E.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Nf,layout:function(Qt){return Gu({layer:r,key:Qt.key,value:Qt.value,style:Qt.style,styleSpec:Qt.styleSpec,objectElementValidators:{"*":function(tr){return Ve(fn({layerType:G},tr))}}})},paint:function(Qt){return Gu({layer:r,key:Qt.key,value:Qt.value,style:Qt.style,styleSpec:Qt.styleSpec,objectElementValidators:{"*":function(tr){return le(fn({layerType:G},tr))}}})}}}))}function ut(e){var t=e.value,r=e.key,s=To(t);return s!=="string"?[new Nt(r,t,"string expected, "+s+" found")]:[]}var Wt={promoteId:function(e){var t=e.key,r=e.value;if(To(r)==="string")return ut({key:t,value:r});var s=[];for(var d in r)s.push.apply(s,ut({key:t+"."+d,value:r[d]}));return s}};function hn(e){var t=e.value,r=e.key,s=e.styleSpec,d=e.style;if(!t.type)return[new Nt(r,t,'"type" is required')];var E,I=Br(t.type);switch(I){case"vector":case"raster":case"raster-dem":return Gu({key:r,value:t,valueSpec:s["source_"+I.replace("-","_")],style:e.style,styleSpec:s,objectElementValidators:Wt});case"geojson":if(E=Gu({key:r,value:t,valueSpec:s.source_geojson,style:d,styleSpec:s,objectElementValidators:Wt}),t.cluster)for(var G in t.clusterProperties){var se=t.clusterProperties[G],be=se[0],we=typeof be=="string"?[be,["accumulated"],["get",G]]:be;E.push.apply(E,ko({key:r+"."+G+".map",value:se[1],expressionContext:"cluster-map"})),E.push.apply(E,ko({key:r+"."+G+".reduce",value:we,expressionContext:"cluster-reduce"}))}return E;case"video":return Gu({key:r,value:t,valueSpec:s.source_video,style:d,styleSpec:s});case"image":return Gu({key:r,value:t,valueSpec:s.source_image,style:d,styleSpec:s});case"canvas":return[new Nt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zc({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:s})}}function Mi(e){var t=e.value,r=e.styleSpec,s=r.light,d=e.style,E=[],I=To(t);if(t===void 0)return E;if(I!=="object")return E.concat([new Nt("light",t,"object expected, "+I+" found")]);for(var G in t){var se=G.match(/^(.*)-transition$/);E=E.concat(se&&s[se[1]]&&s[se[1]].transition?oa({key:G,value:t[G],valueSpec:r.transition,style:d,styleSpec:r}):s[G]?oa({key:G,value:t[G],valueSpec:s[G],style:d,styleSpec:r}):[new Nt(G,t[G],'unknown property "'+G+'"')])}return E}var da={"*":function(){return[]},array:pf,boolean:function(e){var t=e.value,r=e.key,s=To(t);return s!=="boolean"?[new Nt(r,t,"boolean expected, "+s+" found")]:[]},number:Cc,color:function(e){var t=e.key,r=e.value,s=To(r);return s!=="string"?[new Nt(t,r,"color expected, "+s+" found")]:qa(r)===null?[new Nt(t,r,'color expected, "'+r+'" found')]:[]},constants:Sr,enum:Zc,filter:Nf,function:ef,layer:_t,object:Gu,source:hn,light:Mi,string:ut,formatted:function(e){return ut(e).length===0?[]:ko(e)},resolvedImage:function(e){return ut(e).length===0?[]:ko(e)}};function oa(e){var t=e.value,r=e.valueSpec,s=e.styleSpec;return r.expression&&Ps(Br(t))?ef(e):r.expression&&Ul(Jr(t))?ko(e):r.type&&da[r.type]?da[r.type](e):Gu(fn({},e,{valueSpec:r.type?s[r.type]:r}))}function za(e){var t=e.value,r=e.key,s=ut(e);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new Nt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new Nt(r,t,'"glyphs" url must include a "{range}" token'))),s}function Xo(e,t){t===void 0&&(t=lt);var r=[];return r=r.concat(oa({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:za,"*":function(){return[]}}})),e.constants&&(r=r.concat(Sr({key:"constants",value:e.constants,style:e,styleSpec:t}))),Sc(r)}function Sc(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function hl(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Sc(e.apply(this,t))}}Xo.source=hl(hn),Xo.light=hl(Mi),Xo.layer=hl(_t),Xo.filter=hl(Nf),Xo.paintProperty=hl(le),Xo.layoutProperty=hl(Ve);var df=Xo,yh=df.light,ih=df.paintProperty,Hl=df.layoutProperty;function Sl(e,t){var r=!1;if(t&&t.length)for(var s=0,d=t;s<d.length;s+=1)e.fire(new Ut(new Error(d[s].message))),r=!0;return r}var ac=Vs;function Vs(e,t,r){var s=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var d=new Int32Array(this.arrayBuffer);e=d[0],this.d=(t=d[1])+2*(r=d[2]);for(var E=0;E<this.d*this.d;E++){var I=d[3+E],G=d[3+E+1];s.push(I===G?null:d.subarray(I,G))}var se=d[3+s.length+1];this.keys=d.subarray(d[3+s.length],se),this.bboxes=d.subarray(se),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var be=0;be<this.d*this.d;be++)s.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var we=r/t*e;this.min=-we,this.max=e+we}Vs.prototype.insert=function(e,t,r,s,d){this._forEachCell(t,r,s,d,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(d)},Vs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Vs.prototype._insertCell=function(e,t,r,s,d,E){this.cells[d].push(E)},Vs.prototype.query=function(e,t,r,s,d){var E=this.min,I=this.max;if(e<=E&&t<=E&&I<=r&&I<=s&&!d)return Array.prototype.slice.call(this.keys);var G=[];return this._forEachCell(e,t,r,s,this._queryCell,G,{},d),G},Vs.prototype._queryCell=function(e,t,r,s,d,E,I,G){var se=this.cells[d];if(se!==null)for(var be=this.keys,we=this.bboxes,Ze=0;Ze<se.length;Ze++){var ot=se[Ze];if(I[ot]===void 0){var bt=4*ot;(G?G(we[bt+0],we[bt+1],we[bt+2],we[bt+3]):e<=we[bt+2]&&t<=we[bt+3]&&r>=we[bt+0]&&s>=we[bt+1])?(I[ot]=!0,E.push(be[ot])):I[ot]=!1}}},Vs.prototype._forEachCell=function(e,t,r,s,d,E,I,G){for(var se=this._convertToCellCoord(e),be=this._convertToCellCoord(t),we=this._convertToCellCoord(r),Ze=this._convertToCellCoord(s),ot=se;ot<=we;ot++)for(var bt=be;bt<=Ze;bt++){var Qt=this.d*bt+ot;if((!G||G(this._convertFromCellCoord(ot),this._convertFromCellCoord(bt),this._convertFromCellCoord(ot+1),this._convertFromCellCoord(bt+1)))&&d.call(this,e,t,r,s,Qt,E,I,G))return}},Vs.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Vs.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Vs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var d=new Int32Array(t+r+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var E=t,I=0;I<e.length;I++){var G=e[I];d[3+I]=E,d.set(G,E),E+=G.length}return d[3+e.length]=E,d.set(this.keys,E),d[3+e.length+1]=E+=this.keys.length,d.set(this.bboxes,E),E+=this.bboxes.length,d.buffer};var Gc=V.ImageData,vf=V.ImageBitmap,Hs={};function zi(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Hs[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var ks in zi("Object",Object),ac.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},ac.deserialize=function(e){return new ac(e.buffer)},zi("Grid",ac),zi("Color",ba),zi("Error",Error),zi("ResolvedImage",Gt),zi("StylePropertyFunction",ic),zi("StyleExpression",vu,{omit:["_evaluator"]}),zi("ZoomDependentExpression",Zl),zi("ZoomConstantExpression",Cu),zi("CompoundExpression",cs,{omit:["_evaluate"]}),xl)xl[ks]._classRegistryKey||zi("Expression_"+ks,xl[ks]);function Vc(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function nf(e){return vf&&e instanceof vf}function Ws(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Vc(e)||nf(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof Gc)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var s=[],d=0,E=e;d<E.length;d+=1)s.push(Ws(E[d],t));return s}if(typeof e=="object"){var I=e.constructor,G=I._classRegistryKey;if(!G)throw new Error("can't serialize object of unregistered class");var se=I.serialize?I.serialize(e,t):{};if(!I.serialize){for(var be in e)if(e.hasOwnProperty(be)&&!(Hs[G].omit.indexOf(be)>=0)){var we=e[be];se[be]=Hs[G].shallow.indexOf(be)>=0?we:Ws(we,t)}e instanceof Error&&(se.message=e.message)}if(se.$name)throw new Error("$name property is reserved for worker serialization logic.");return G!=="Object"&&(se.$name=G),se}throw new Error("can't serialize object of type "+typeof e)}function Vu(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Vc(e)||nf(e)||ArrayBuffer.isView(e)||e instanceof Gc)return e;if(Array.isArray(e))return e.map(Vu);if(typeof e=="object"){var t=e.$name||"Object",r=Hs[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var s=Object.create(r.prototype),d=0,E=Object.keys(e);d<E.length;d+=1){var I=E[d];if(I!=="$name"){var G=e[I];s[I]=Hs[t].shallow.indexOf(I)>=0?G:Vu(G)}}return s}throw new Error("can't deserialize object of type "+typeof e)}var mf=function(){this.first=!0};mf.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var _i={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function gf(e){for(var t=0,r=e;t<r.length;t+=1)if($f(r[t].charCodeAt(0)))return!0;return!1}function $f(e){return!(e!==746&&e!==747&&(e<4352||!(_i["Bopomofo Extended"](e)||_i.Bopomofo(e)||_i["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||_i["CJK Compatibility Ideographs"](e)||_i["CJK Compatibility"](e)||_i["CJK Radicals Supplement"](e)||_i["CJK Strokes"](e)||!(!_i["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||_i["CJK Unified Ideographs Extension A"](e)||_i["CJK Unified Ideographs"](e)||_i["Enclosed CJK Letters and Months"](e)||_i["Hangul Compatibility Jamo"](e)||_i["Hangul Jamo Extended-A"](e)||_i["Hangul Jamo Extended-B"](e)||_i["Hangul Jamo"](e)||_i["Hangul Syllables"](e)||_i.Hiragana(e)||_i["Ideographic Description Characters"](e)||_i.Kanbun(e)||_i["Kangxi Radicals"](e)||_i["Katakana Phonetic Extensions"](e)||_i.Katakana(e)&&e!==12540||!(!_i["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!_i["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||_i["Unified Canadian Aboriginal Syllabics"](e)||_i["Unified Canadian Aboriginal Syllabics Extended"](e)||_i["Vertical Forms"](e)||_i["Yijing Hexagram Symbols"](e)||_i["Yi Syllables"](e)||_i["Yi Radicals"](e))))}function Al(e){return!($f(e)||function(t){return!!(_i["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||_i["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||_i["Letterlike Symbols"](t)||_i["Number Forms"](t)||_i["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||_i["Control Pictures"](t)&&t!==9251||_i["Optical Character Recognition"](t)||_i["Enclosed Alphanumerics"](t)||_i["Geometric Shapes"](t)||_i["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||_i["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||_i["CJK Symbols and Punctuation"](t)||_i.Katakana(t)||_i["Private Use Area"](t)||_i["CJK Compatibility Forms"](t)||_i["Small Form Variants"](t)||_i["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function _s(e){return e>=1424&&e<=2303||_i["Arabic Presentation Forms-A"](e)||_i["Arabic Presentation Forms-B"](e)}function Au(e,t){return!(!t&&_s(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||_i.Khmer(e))}function yf(e){for(var t=0,r=e;t<r.length;t+=1)if(_s(r[t].charCodeAt(0)))return!0;return!1}var Tl=null,Ru="unavailable",Ac=null,ah=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Ru="error"),Tl&&Tl(e)};function zf(){Uf.fire(new dt("pluginStateChange",{pluginStatus:Ru,pluginURL:Ac}))}var Uf=new ur,oh=function(){return Ru},wl=function(){if(Ru!=="deferred"||!Ac)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ru="loading",zf(),Ac&&Zt({url:Ac},function(e){e?ah(e):(Ru="loaded",zf())})},pl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ru==="loaded"||pl.applyArabicShaping!=null},isLoading:function(){return Ru==="loading"},setState:function(e){Ru=e.pluginStatus,Ac=e.pluginURL},isParsed:function(){return pl.applyArabicShaping!=null&&pl.processBidirectionalText!=null&&pl.processStyledBidirectionalText!=null},getPluginURL:function(){return Ac}},fo=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new mf,this.transition={})};fo.prototype.isSupportedScript=function(e){return function(t,r){for(var s=0,d=t;s<d.length;s+=1)if(!Au(d[s].charCodeAt(0),r))return!1;return!0}(e,pl.isLoaded())},fo.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},fo.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var Ju=function(e,t){this.property=e,this.value=t,this.expression=function(r,s){if(Ps(r))return new ic(r,s);if(Ul(r)){var d=nc(r,s);if(d.result==="error")throw new Error(d.value.map(function(I){return I.key+": "+I.message}).join(", "));return d.value}var E=r;return typeof r=="string"&&s.type==="color"&&(E=ba.parse(r)),{kind:"constant",evaluate:function(){return E}}}(t===void 0?e.specification.default:t,e.specification)};Ju.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ju.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Ml=function(e){this.property=e,this.value=new Ju(e,void 0)};Ml.prototype.transitioned=function(e,t){return new oc(this.property,this.value,t,rt({},e.transition,this.transition),e.now)},Ml.prototype.untransitioned=function(){return new oc(this.property,this.value,null,{},0)};var Xs=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Xs.prototype.getValue=function(e){return Te(this._values[e].value.value)},Xs.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ml(this._values[e].property)),this._values[e].value=new Ju(this._values[e].property,t===null?void 0:Te(t))},Xs.prototype.getTransition=function(e){return Te(this._values[e].transition)},Xs.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ml(this._values[e].property)),this._values[e].transition=Te(t)||void 0},Xs.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var s=r[t],d=this.getValue(s);d!==void 0&&(e[s]=d);var E=this.getTransition(s);E!==void 0&&(e[s+"-transition"]=E)}return e},Xs.prototype.transitioned=function(e,t){for(var r=new Hc(this._properties),s=0,d=Object.keys(this._values);s<d.length;s+=1){var E=d[s];r._values[E]=this._values[E].transitioned(e,t._values[E])}return r},Xs.prototype.untransitioned=function(){for(var e=new Hc(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var s=r[t];e._values[s]=this._values[s].untransitioned()}return e};var oc=function(e,t,r,s,d){this.property=e,this.value=t,this.begin=d+s.delay||0,this.end=this.begin+s.duration||0,e.specification.transition&&(s.delay||s.duration)&&(this.prior=r)};oc.prototype.possiblyEvaluate=function(e,t,r){var s=e.now||0,d=this.value.possiblyEvaluate(e,t,r),E=this.prior;if(E){if(s>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(s<this.begin)return E.possiblyEvaluate(e,t,r);var I=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(e,t,r),d,function(G){if(G<=0)return 0;if(G>=1)return 1;var se=G*G,be=se*G;return 4*(G<.5?be:3*(G-se)+be-.75)}(I))}return d};var Hc=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Hc.prototype.possiblyEvaluate=function(e,t,r){for(var s=new Js(this._properties),d=0,E=Object.keys(this._values);d<E.length;d+=1){var I=E[d];s._values[I]=this._values[I].possiblyEvaluate(e,t,r)}return s},Hc.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var Tu=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Tu.prototype.getValue=function(e){return Te(this._values[e].value)},Tu.prototype.setValue=function(e,t){this._values[e]=new Ju(this._values[e].property,t===null?void 0:Te(t))},Tu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var s=r[t],d=this.getValue(s);d!==void 0&&(e[s]=d)}return e},Tu.prototype.possiblyEvaluate=function(e,t,r){for(var s=new Js(this._properties),d=0,E=Object.keys(this._values);d<E.length;d+=1){var I=E[d];s._values[I]=this._values[I].possiblyEvaluate(e,t,r)}return s};var Hu=function(e,t,r){this.property=e,this.value=t,this.parameters=r};Hu.prototype.isConstant=function(){return this.value.kind==="constant"},Hu.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Hu.prototype.evaluate=function(e,t,r,s){return this.property.evaluate(this.value,this.parameters,e,t,r,s)};var Js=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Js.prototype.get=function(e){return this._values[e]};var la=function(e){this.specification=e};la.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},la.prototype.interpolate=function(e,t,r){var s=ia[this.specification.type];return s?s(e,t,r):e};var Vi=function(e,t){this.specification=e,this.overrides=t};Vi.prototype.possiblyEvaluate=function(e,t,r,s){return new Hu(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,s)}:e.expression,t)},Vi.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Hu(this,{kind:"constant",value:void 0},e.parameters);var s=ia[this.specification.type];return s?new Hu(this,{kind:"constant",value:s(e.value.value,t.value.value,r)},e.parameters):e},Vi.prototype.evaluate=function(e,t,r,s,d,E){return e.kind==="constant"?e.value:e.evaluate(t,r,s,d,E)};var wf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,s,d,E){if(r.value===void 0)return new Hu(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){var I=r.expression.evaluate(s,null,{},d,E),G=r.property.specification.type==="resolvedImage"&&typeof I!="string"?I.name:I,se=this._calculate(G,G,G,s);return new Hu(this,{kind:"constant",value:se},s)}if(r.expression.kind==="camera"){var be=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new Hu(this,{kind:"constant",value:be},s)}return new Hu(this,r.expression,s)},t.prototype.evaluate=function(r,s,d,E,I,G){if(r.kind==="source"){var se=r.evaluate(s,d,E,I,G);return this._calculate(se,se,se,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},d,E),r.evaluate({zoom:Math.floor(s.zoom)},d,E),r.evaluate({zoom:Math.floor(s.zoom)+1},d,E),s):r.value},t.prototype._calculate=function(r,s,d,E){return E.zoom>E.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:d,to:s}},t.prototype.interpolate=function(r){return r},t}(Vi),wu=function(e){this.specification=e};wu.prototype.possiblyEvaluate=function(e,t,r,s){if(e.value!==void 0){if(e.expression.kind==="constant"){var d=e.expression.evaluate(t,null,{},r,s);return this._calculate(d,d,d,t)}return this._calculate(e.expression.evaluate(new fo(Math.floor(t.zoom-1),t)),e.expression.evaluate(new fo(Math.floor(t.zoom),t)),e.expression.evaluate(new fo(Math.floor(t.zoom+1),t)),t)}},wu.prototype._calculate=function(e,t,r,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},wu.prototype.interpolate=function(e){return e};var Wl=function(e){this.specification=e};Wl.prototype.possiblyEvaluate=function(e,t,r,s){return!!e.expression.evaluate(t,null,{},r,s)},Wl.prototype.interpolate=function(){return!1};var mu=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var s=this.defaultPropertyValues[t]=new Ju(r,void 0),d=this.defaultTransitionablePropertyValues[t]=new Ml(r);this.defaultTransitioningPropertyValues[t]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=s.possiblyEvaluate({})}};zi("DataDrivenProperty",Vi),zi("DataConstantProperty",la),zi("CrossFadedDataDrivenProperty",wf),zi("CrossFadedProperty",wu),zi("ColorRampProperty",Wl);var Pl=function(e){function t(r,s){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),s.layout&&(this._unevaluatedLayout=new Tu(s.layout)),s.paint)){for(var d in this._transitionablePaint=new Xs(s.paint),r.paint)this.setPaintProperty(d,r.paint[d],{validate:!1});for(var E in r.layout)this.setLayoutProperty(E,r.layout[E],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Js(s.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,s,d){d===void 0&&(d={}),s!=null&&this._validate(Hl,"layers."+this.id+".layout."+r,r,s,d)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)},t.prototype.getPaintProperty=function(r){return re(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,s,d){if(d===void 0&&(d={}),s!=null&&this._validate(ih,"layers."+this.id+".paint."+r,r,s,d))return!1;if(re(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),s||void 0),!1;var E=this._transitionablePaint._values[r],I=E.property.specification["property-type"]==="cross-faded-data-driven",G=E.value.isDataDriven(),se=E.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);var be=this._transitionablePaint._values[r].value;return be.isDataDriven()||G||I||this._handleOverridablePaintPropertyUpdate(r,se,be)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,s,d){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Qe(r,function(s,d){return!(s===void 0||d==="layout"&&!Object.keys(s).length||d==="paint"&&!Object.keys(s).length)})},t.prototype._validate=function(r,s,d,E,I){return I===void 0&&(I={}),(!I||I.validate!==!1)&&Sl(this,r.call(df,{key:s,layerType:this.type,objectKey:d,value:E,styleSpec:lt,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var s=this.paint.get(r);if(s instanceof Hu&&ss(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1},t}(ur),Zf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},sc=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},$o=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function fs(e,t){t===void 0&&(t=1);var r=0,s=0;return{members:e.map(function(d){var E=Zf[d.type].BYTES_PER_ELEMENT,I=r=_f(r,Math.max(t,E)),G=d.components||1;return s=Math.max(s,E),r+=E*G,{name:d.name,type:d.type,components:G,offset:I}}),size:_f(r,Math.max(s,t)),alignment:t}}function _f(e,t){return Math.ceil(e/t)*t}$o.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},$o.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},$o.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},$o.prototype.clear=function(){this.length=0},$o.prototype.resize=function(e){this.reserve(e),this.length=e},$o.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},$o.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var uc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s){var d=this.length;return this.resize(d+1),this.emplace(d,r,s)},t.prototype.emplace=function(r,s,d){var E=2*r;return this.int16[E+0]=s,this.int16[E+1]=d,r},t}($o);uc.prototype.bytesPerElement=4,zi("StructArrayLayout2i4",uc);var lc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E){var I=this.length;return this.resize(I+1),this.emplace(I,r,s,d,E)},t.prototype.emplace=function(r,s,d,E,I){var G=4*r;return this.int16[G+0]=s,this.int16[G+1]=d,this.int16[G+2]=E,this.int16[G+3]=I,r},t}($o);lc.prototype.bytesPerElement=8,zi("StructArrayLayout4i8",lc);var Ll=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G){var se=this.length;return this.resize(se+1),this.emplace(se,r,s,d,E,I,G)},t.prototype.emplace=function(r,s,d,E,I,G,se){var be=6*r;return this.int16[be+0]=s,this.int16[be+1]=d,this.int16[be+2]=E,this.int16[be+3]=I,this.int16[be+4]=G,this.int16[be+5]=se,r},t}($o);Ll.prototype.bytesPerElement=12,zi("StructArrayLayout2i4i12",Ll);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G){var se=this.length;return this.resize(se+1),this.emplace(se,r,s,d,E,I,G)},t.prototype.emplace=function(r,s,d,E,I,G,se){var be=4*r,we=8*r;return this.int16[be+0]=s,this.int16[be+1]=d,this.uint8[we+4]=E,this.uint8[we+5]=I,this.uint8[we+6]=G,this.uint8[we+7]=se,r},t}($o);au.prototype.bytesPerElement=8,zi("StructArrayLayout2i4ub8",au);var Tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s){var d=this.length;return this.resize(d+1),this.emplace(d,r,s)},t.prototype.emplace=function(r,s,d){var E=2*r;return this.float32[E+0]=s,this.float32[E+1]=d,r},t}($o);Tc.prototype.bytesPerElement=8,zi("StructArrayLayout2f8",Tc);var cc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G,se,be,we,Ze){var ot=this.length;return this.resize(ot+1),this.emplace(ot,r,s,d,E,I,G,se,be,we,Ze)},t.prototype.emplace=function(r,s,d,E,I,G,se,be,we,Ze,ot){var bt=10*r;return this.uint16[bt+0]=s,this.uint16[bt+1]=d,this.uint16[bt+2]=E,this.uint16[bt+3]=I,this.uint16[bt+4]=G,this.uint16[bt+5]=se,this.uint16[bt+6]=be,this.uint16[bt+7]=we,this.uint16[bt+8]=Ze,this.uint16[bt+9]=ot,r},t}($o);cc.prototype.bytesPerElement=20,zi("StructArrayLayout10ui20",cc);var xf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G,se,be,we,Ze,ot,bt){var Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,r,s,d,E,I,G,se,be,we,Ze,ot,bt)},t.prototype.emplace=function(r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt){var tr=12*r;return this.int16[tr+0]=s,this.int16[tr+1]=d,this.int16[tr+2]=E,this.int16[tr+3]=I,this.uint16[tr+4]=G,this.uint16[tr+5]=se,this.uint16[tr+6]=be,this.uint16[tr+7]=we,this.int16[tr+8]=Ze,this.int16[tr+9]=ot,this.int16[tr+10]=bt,this.int16[tr+11]=Qt,r},t}($o);xf.prototype.bytesPerElement=24,zi("StructArrayLayout4i4ui4i24",xf);var fc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d){var E=this.length;return this.resize(E+1),this.emplace(E,r,s,d)},t.prototype.emplace=function(r,s,d,E){var I=3*r;return this.float32[I+0]=s,this.float32[I+1]=d,this.float32[I+2]=E,r},t}($o);fc.prototype.bytesPerElement=12,zi("StructArrayLayout3f12",fc);var Xl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},t.prototype.emplace=function(r,s){return this.uint32[1*r+0]=s,r},t}($o);Xl.prototype.bytesPerElement=4,zi("StructArrayLayout1ul4",Xl);var Mf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G,se,be,we){var Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,r,s,d,E,I,G,se,be,we)},t.prototype.emplace=function(r,s,d,E,I,G,se,be,we,Ze){var ot=10*r,bt=5*r;return this.int16[ot+0]=s,this.int16[ot+1]=d,this.int16[ot+2]=E,this.int16[ot+3]=I,this.int16[ot+4]=G,this.int16[ot+5]=se,this.uint32[bt+3]=be,this.uint16[ot+8]=we,this.uint16[ot+9]=Ze,r},t}($o);Mf.prototype.bytesPerElement=20,zi("StructArrayLayout6i1ul2ui20",Mf);var af=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G){var se=this.length;return this.resize(se+1),this.emplace(se,r,s,d,E,I,G)},t.prototype.emplace=function(r,s,d,E,I,G,se){var be=6*r;return this.int16[be+0]=s,this.int16[be+1]=d,this.int16[be+2]=E,this.int16[be+3]=I,this.int16[be+4]=G,this.int16[be+5]=se,r},t}($o);af.prototype.bytesPerElement=12,zi("StructArrayLayout2i2i2i12",af);var Yl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I){var G=this.length;return this.resize(G+1),this.emplace(G,r,s,d,E,I)},t.prototype.emplace=function(r,s,d,E,I,G){var se=4*r,be=8*r;return this.float32[se+0]=s,this.float32[se+1]=d,this.float32[se+2]=E,this.int16[be+6]=I,this.int16[be+7]=G,r},t}($o);Yl.prototype.bytesPerElement=16,zi("StructArrayLayout2f1f2i16",Yl);var of=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E){var I=this.length;return this.resize(I+1),this.emplace(I,r,s,d,E)},t.prototype.emplace=function(r,s,d,E,I){var G=12*r,se=3*r;return this.uint8[G+0]=s,this.uint8[G+1]=d,this.float32[se+1]=E,this.float32[se+2]=I,r},t}($o);of.prototype.bytesPerElement=12,zi("StructArrayLayout2ub2f12",of);var $l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d){var E=this.length;return this.resize(E+1),this.emplace(E,r,s,d)},t.prototype.emplace=function(r,s,d,E){var I=3*r;return this.uint16[I+0]=s,this.uint16[I+1]=d,this.uint16[I+2]=E,r},t}($o);$l.prototype.bytesPerElement=6,zi("StructArrayLayout3ui6",$l);var Kl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr,br,cr,Zr){var Yr=this.length;return this.resize(Yr+1),this.emplace(Yr,r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr,br,cr,Zr)},t.prototype.emplace=function(r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr,br,cr,Zr,Yr){var ln=24*r,vn=12*r,Ln=48*r;return this.int16[ln+0]=s,this.int16[ln+1]=d,this.uint16[ln+2]=E,this.uint16[ln+3]=I,this.uint32[vn+2]=G,this.uint32[vn+3]=se,this.uint32[vn+4]=be,this.uint16[ln+10]=we,this.uint16[ln+11]=Ze,this.uint16[ln+12]=ot,this.float32[vn+7]=bt,this.float32[vn+8]=Qt,this.uint8[Ln+36]=tr,this.uint8[Ln+37]=br,this.uint8[Ln+38]=cr,this.uint32[vn+10]=Zr,this.int16[ln+22]=Yr,r},t}($o);Kl.prototype.bytesPerElement=48,zi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Kl);var hc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr,br,cr,Zr,Yr,ln,vn,Ln,oi,wi,va,Fi,Ca,Ni,Oo){var $a=this.length;return this.resize($a+1),this.emplace($a,r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr,br,cr,Zr,Yr,ln,vn,Ln,oi,wi,va,Fi,Ca,Ni,Oo)},t.prototype.emplace=function(r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr,br,cr,Zr,Yr,ln,vn,Ln,oi,wi,va,Fi,Ca,Ni,Oo,$a){var Wi=34*r,jo=17*r;return this.int16[Wi+0]=s,this.int16[Wi+1]=d,this.int16[Wi+2]=E,this.int16[Wi+3]=I,this.int16[Wi+4]=G,this.int16[Wi+5]=se,this.int16[Wi+6]=be,this.int16[Wi+7]=we,this.uint16[Wi+8]=Ze,this.uint16[Wi+9]=ot,this.uint16[Wi+10]=bt,this.uint16[Wi+11]=Qt,this.uint16[Wi+12]=tr,this.uint16[Wi+13]=br,this.uint16[Wi+14]=cr,this.uint16[Wi+15]=Zr,this.uint16[Wi+16]=Yr,this.uint16[Wi+17]=ln,this.uint16[Wi+18]=vn,this.uint16[Wi+19]=Ln,this.uint16[Wi+20]=oi,this.uint16[Wi+21]=wi,this.uint16[Wi+22]=va,this.uint32[jo+12]=Fi,this.float32[jo+13]=Ca,this.float32[jo+14]=Ni,this.float32[jo+15]=Oo,this.float32[jo+16]=$a,r},t}($o);hc.prototype.bytesPerElement=68,zi("StructArrayLayout8i15ui1ul4f68",hc);var gu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},t.prototype.emplace=function(r,s){return this.float32[1*r+0]=s,r},t}($o);gu.prototype.bytesPerElement=4,zi("StructArrayLayout1f4",gu);var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d){var E=this.length;return this.resize(E+1),this.emplace(E,r,s,d)},t.prototype.emplace=function(r,s,d,E){var I=3*r;return this.int16[I+0]=s,this.int16[I+1]=d,this.int16[I+2]=E,r},t}($o);el.prototype.bytesPerElement=6,zi("StructArrayLayout3i6",el);var Wc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d){var E=this.length;return this.resize(E+1),this.emplace(E,r,s,d)},t.prototype.emplace=function(r,s,d,E){var I=4*r;return this.uint32[2*r+0]=s,this.uint16[I+2]=d,this.uint16[I+3]=E,r},t}($o);Wc.prototype.bytesPerElement=8,zi("StructArrayLayout1ul2ui8",Wc);var sf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s){var d=this.length;return this.resize(d+1),this.emplace(d,r,s)},t.prototype.emplace=function(r,s,d){var E=2*r;return this.uint16[E+0]=s,this.uint16[E+1]=d,r},t}($o);sf.prototype.bytesPerElement=4,zi("StructArrayLayout2ui4",sf);var sh=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},t.prototype.emplace=function(r,s){return this.uint16[1*r+0]=s,r},t}($o);sh.prototype.bytesPerElement=2,zi("StructArrayLayout1ui2",sh);var Pf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,s,d,E){var I=this.length;return this.resize(I+1),this.emplace(I,r,s,d,E)},t.prototype.emplace=function(r,s,d,E,I){var G=4*r;return this.float32[G+0]=s,this.float32[G+1]=d,this.float32[G+2]=E,this.float32[G+3]=I,r},t}($o);Pf.prototype.bytesPerElement=16,zi("StructArrayLayout4f16",Pf);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new D(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(sc);n.prototype.size=20;var o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Mf);zi("CollisionBoxArray",o);var i=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(s){this._structArray.uint8[this._pos1+37]=s},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(s){this._structArray.uint8[this._pos1+38]=s},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(s){this._structArray.uint32[this._pos4+10]=s},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(sc);i.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new i(this,r)},t}(Kl);zi("PlacedSymbolArray",l);var w=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(s){this._structArray.uint32[this._pos4+12]=s},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(sc);w.prototype.size=68;var z=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new w(this,r)},t}(hc);zi("SymbolInstanceArray",z);var j=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(gu);zi("GlyphOffsetArray",j);var ae=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(el);zi("SymbolLineVertexArray",ae);var Se=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(sc);Se.prototype.size=8;var He=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new Se(this,r)},t}(Wc);zi("FeatureIndexArray",He);var xt=fs([{name:"a_pos",components:2,type:"Int16"}],4).members,Et=function(e){e===void 0&&(e=[]),this.segments=e};function Tt(e,t){return 256*(e=ce(Math.floor(e),0,255))+ce(Math.floor(t),0,255)}Et.prototype.prepareSegment=function(e,t,r,s){var d=this.segments[this.segments.length-1];return e>Et.MAX_VERTEX_ARRAY_LENGTH&&Ce("Max vertices per segment is "+Et.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!d||d.vertexLength+e>Et.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==s)&&(d={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},s!==void 0&&(d.sortKey=s),this.segments.push(d)),d},Et.prototype.get=function(){return this.segments},Et.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var s in r.vaos)r.vaos[s].destroy()}},Et.simpleSegment=function(e,t,r,s){return new Et([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:s,vaos:{},sortKey:0}])},Et.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zi("SegmentVector",Et);var Jt=fs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Yt=P(function(e){e.exports=function(t,r){var s,d,E,I,G,se,be,we;for(d=t.length-(s=3&t.length),E=r,G=3432918353,se=461845907,we=0;we<d;)be=255&t.charCodeAt(we)|(255&t.charCodeAt(++we))<<8|(255&t.charCodeAt(++we))<<16|(255&t.charCodeAt(++we))<<24,++we,E=27492+(65535&(I=5*(65535&(E=(E^=be=(65535&(be=(be=(65535&be)*G+(((be>>>16)*G&65535)<<16)&4294967295)<<15|be>>>17))*se+(((be>>>16)*se&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(I>>>16)&65535)<<16);switch(be=0,s){case 3:be^=(255&t.charCodeAt(we+2))<<16;case 2:be^=(255&t.charCodeAt(we+1))<<8;case 1:E^=be=(65535&(be=(be=(65535&(be^=255&t.charCodeAt(we)))*G+(((be>>>16)*G&65535)<<16)&4294967295)<<15|be>>>17))*se+(((be>>>16)*se&65535)<<16)&4294967295}return E^=t.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0}}),gr=P(function(e){e.exports=function(t,r){for(var s,d=t.length,E=r^d,I=0;d>=4;)s=1540483477*(65535&(s=255&t.charCodeAt(I)|(255&t.charCodeAt(++I))<<8|(255&t.charCodeAt(++I))<<16|(255&t.charCodeAt(++I))<<24))+((1540483477*(s>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),d-=4,++I;switch(d){case 3:E^=(255&t.charCodeAt(I+2))<<16;case 2:E^=(255&t.charCodeAt(I+1))<<8;case 1:E=1540483477*(65535&(E^=255&t.charCodeAt(I)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0}}),Vt=Yt,mr=gr;Vt.murmur3=Yt,Vt.murmur2=mr;var Ar=function(){this.ids=[],this.positions=[],this.indexed=!1};Ar.prototype.add=function(e,t,r,s){this.ids.push(cn(e)),this.positions.push(t,r,s)},Ar.prototype.getPositions=function(e){for(var t=cn(e),r=0,s=this.ids.length-1;r<s;){var d=r+s>>1;this.ids[d]>=t?s=d:r=d+1}for(var E=[];this.ids[r]===t;)E.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return E},Ar.serialize=function(e,t){var r=new Float64Array(e.ids),s=new Uint32Array(e.positions);return function d(E,I,G,se){for(;G<se;){for(var be=E[G+se>>1],we=G-1,Ze=se+1;;){do we++;while(E[we]<be);do Ze--;while(E[Ze]>be);if(we>=Ze)break;nn(E,we,Ze),nn(I,3*we,3*Ze),nn(I,3*we+1,3*Ze+1),nn(I,3*we+2,3*Ze+2)}Ze-G<se-Ze?(d(E,I,G,Ze),G=Ze+1):(d(E,I,Ze+1,se),se=Ze)}}(r,s,0,r.length-1),t&&t.push(r.buffer,s.buffer),{ids:r,positions:s}},Ar.deserialize=function(e){var t=new Ar;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Xr=Math.pow(2,53)-1;function cn(e){var t=+e;return!isNaN(t)&&t<=Xr?t:Vt(String(e))}function nn(e,t,r){var s=e[t];e[t]=e[r],e[r]=s}zi("FeaturePositionMap",Ar);var pn=function(e,t){this.gl=e.gl,this.location=t},Bn=function(e){function t(r,s){e.call(this,r,s),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(pn),Zn=function(e){function t(r,s){e.call(this,r,s),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(pn),Vn=function(e){function t(r,s){e.call(this,r,s),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(pn),Si=function(e){function t(r,s){e.call(this,r,s),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(pn),Zi=function(e){function t(r,s){e.call(this,r,s),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(pn),ca=function(e){function t(r,s){e.call(this,r,s),this.current=ba.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(pn),ma=new Float32Array(16),Co=function(e){function t(r,s){e.call(this,r,s),this.current=ma}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var s=1;s<16;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(pn);function Pi(e){return[Tt(255*e.r,255*e.g),Tt(255*e.b,255*e.a)]}var Ha=function(e,t,r){this.value=e,this.uniformNames=t.map(function(s){return"u_"+s}),this.type=r};Ha.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Ha.prototype.getBinding=function(e,t,r){return this.type==="color"?new ca(e,t):new Zn(e,t)};var Ma=function(e,t){this.uniformNames=t.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ma.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Ma.prototype.setUniform=function(e,t,r,s){var d=s==="u_pattern_to"?this.patternTo:s==="u_pattern_from"?this.patternFrom:s==="u_pixel_ratio_to"?this.pixelRatioTo:s==="u_pixel_ratio_from"?this.pixelRatioFrom:null;d&&e.set(d)},Ma.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Zi(e,t):new Zn(e,t)};var Ba=function(e,t,r,s){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(d){return{name:"a_"+d,type:"Float32",components:r==="color"?2:1,offset:0}}),this.paintVertexArray=new s};Ba.prototype.populatePaintArray=function(e,t,r,s,d){var E=this.paintVertexArray.length,I=this.expression.evaluate(new fo(0),t,{},s,[],d);this.paintVertexArray.resize(e),this._setPaintValue(E,e,I)},Ba.prototype.updatePaintArray=function(e,t,r,s){var d=this.expression.evaluate({zoom:0},r,s);this._setPaintValue(e,t,d)},Ba.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var s=Pi(r),d=e;d<t;d++)this.paintVertexArray.emplace(d,s[0],s[1]);else{for(var E=e;E<t;E++)this.paintVertexArray.emplace(E,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Ba.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ba.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ea=function(e,t,r,s,d,E){this.expression=e,this.uniformNames=t.map(function(I){return"u_"+I+"_t"}),this.type=r,this.useIntegerZoom=s,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=t.map(function(I){return{name:"a_"+I,type:"Float32",components:r==="color"?4:2,offset:0}}),this.paintVertexArray=new E};Ea.prototype.populatePaintArray=function(e,t,r,s,d){var E=this.expression.evaluate(new fo(this.zoom),t,{},s,[],d),I=this.expression.evaluate(new fo(this.zoom+1),t,{},s,[],d),G=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(G,e,E,I)},Ea.prototype.updatePaintArray=function(e,t,r,s){var d=this.expression.evaluate({zoom:this.zoom},r,s),E=this.expression.evaluate({zoom:this.zoom+1},r,s);this._setPaintValue(e,t,d,E)},Ea.prototype._setPaintValue=function(e,t,r,s){if(this.type==="color")for(var d=Pi(r),E=Pi(s),I=e;I<t;I++)this.paintVertexArray.emplace(I,d[0],d[1],E[0],E[1]);else{for(var G=e;G<t;G++)this.paintVertexArray.emplace(G,r,s);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(s))}},Ea.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ea.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ea.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,s=ce(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(s)},Ea.prototype.getBinding=function(e,t,r){return new Zn(e,t)};var oo=function(e,t,r,s,d,E){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=s,this.layerId=E,this.zoomInPaintVertexArray=new d,this.zoomOutPaintVertexArray=new d};oo.prototype.populatePaintArray=function(e,t,r){var s=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(s,e,t.patterns&&t.patterns[this.layerId],r)},oo.prototype.updatePaintArray=function(e,t,r,s,d){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],d)},oo.prototype._setPaintValues=function(e,t,r,s){if(s&&r){var d=s[r.min],E=s[r.mid],I=s[r.max];if(d&&E&&I)for(var G=e;G<t;G++)this.zoomInPaintVertexArray.emplace(G,E.tl[0],E.tl[1],E.br[0],E.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],E.pixelRatio,d.pixelRatio),this.zoomOutPaintVertexArray.emplace(G,E.tl[0],E.tl[1],E.br[0],E.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],E.pixelRatio,I.pixelRatio)}},oo.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Jt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Jt.members,this.expression.isStateDependent))},oo.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Pa=function(e,t,r){this.binders={},this._buffers=[];var s=[];for(var d in e.paint._values)if(r(d)){var E=e.paint.get(d);if(E instanceof Hu&&ss(E.property.specification)){var I=eu(d,e.type),G=E.value,se=E.property.specification.type,be=E.property.useIntegerZoom,we=E.property.specification["property-type"],Ze=we==="cross-faded"||we==="cross-faded-data-driven";if(G.kind==="constant")this.binders[d]=Ze?new Ma(G.value,I):new Ha(G.value,I,se),s.push("/u_"+d);else if(G.kind==="source"||Ze){var ot=As(d,se,"source");this.binders[d]=Ze?new oo(G,se,be,t,ot,e.id):new Ba(G,I,se,ot),s.push("/a_"+d)}else{var bt=As(d,se,"composite");this.binders[d]=new Ea(G,I,se,be,t,bt),s.push("/z_"+d)}}}this.cacheKey=s.sort().join("")};Pa.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Ba||t instanceof Ea?t.maxValue:0},Pa.prototype.populatePaintArrays=function(e,t,r,s,d){for(var E in this.binders){var I=this.binders[E];(I instanceof Ba||I instanceof Ea||I instanceof oo)&&I.populatePaintArray(e,t,r,s,d)}},Pa.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var s=this.binders[r];s instanceof Ma&&s.setConstantPatternPositions(e,t)}},Pa.prototype.updatePaintArrays=function(e,t,r,s,d){var E=!1;for(var I in e)for(var G=0,se=t.getPositions(I);G<se.length;G+=1){var be=se[G],we=r.feature(be.index);for(var Ze in this.binders){var ot=this.binders[Ze];if((ot instanceof Ba||ot instanceof Ea||ot instanceof oo)&&ot.expression.isStateDependent===!0){var bt=s.paint.get(Ze);ot.expression=bt.value,ot.updatePaintArray(be.start,be.end,we,e[I],d),E=!0}}}return E},Pa.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Ha||r instanceof Ma)&&e.push.apply(e,r.uniformNames.map(function(s){return"#define HAS_UNIFORM_"+s}))}return e},Pa.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Ba||r instanceof Ea)for(var s=0;s<r.paintVertexAttributes.length;s++)e.push(r.paintVertexAttributes[s].name);else if(r instanceof oo)for(var d=0;d<Jt.members.length;d++)e.push(Jt.members[d].name)}return e},Pa.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Ha||r instanceof Ma||r instanceof Ea)for(var s=0,d=r.uniformNames;s<d.length;s+=1)e.push(d[s])}return e},Pa.prototype.getPaintVertexBuffers=function(){return this._buffers},Pa.prototype.getUniforms=function(e,t){var r=[];for(var s in this.binders){var d=this.binders[s];if(d instanceof Ha||d instanceof Ma||d instanceof Ea)for(var E=0,I=d.uniformNames;E<I.length;E+=1){var G=I[E];if(t[G]){var se=d.getBinding(e,t[G],G);r.push({name:G,property:s,binding:se})}}}return r},Pa.prototype.setUniforms=function(e,t,r,s){for(var d=0,E=t;d<E.length;d+=1){var I=E[d],G=I.name,se=I.property;this.binders[se].setUniform(I.binding,s,r.get(se),G)}},Pa.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof oo){var s=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;s&&this._buffers.push(s)}else(r instanceof Ba||r instanceof Ea)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},Pa.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof Ba||r instanceof Ea||r instanceof oo)&&r.upload(e)}this.updatePaintBuffers()},Pa.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Ba||t instanceof Ea||t instanceof oo)&&t.destroy()}};var Aa=function(e,t,r){r===void 0&&(r=function(){return!0}),this.programConfigurations={};for(var s=0,d=e;s<d.length;s+=1){var E=d[s];this.programConfigurations[E.id]=new Pa(E,t,r)}this.needsUpload=!1,this._featureMap=new Ar,this._bufferOffset=0};function eu(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function As(e,t,r){var s={color:{source:Tc,composite:Pf},number:{source:gu,composite:Tc}},d=function(E){return{"line-pattern":{source:cc,composite:cc},"fill-pattern":{source:cc,composite:cc},"fill-extrusion-pattern":{source:cc,composite:cc}}[E]}(e);return d&&d[r]||s[t][r]}Aa.prototype.populatePaintArrays=function(e,t,r,s,d,E){for(var I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(e,t,s,d,E);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Aa.prototype.updatePaintArrays=function(e,t,r,s){for(var d=0,E=r;d<E.length;d+=1){var I=E[d];this.needsUpload=this.programConfigurations[I.id].updatePaintArrays(e,this._featureMap,t,I,s)||this.needsUpload}},Aa.prototype.get=function(e){return this.programConfigurations[e]},Aa.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Aa.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},zi("ConstantBinder",Ha),zi("CrossFadedConstantBinder",Ma),zi("SourceExpressionBinder",Ba),zi("CrossFadedCompositeBinder",oo),zi("CompositeExpressionBinder",Ea),zi("ProgramConfiguration",Pa,{omit:["_buffers"]}),zi("ProgramConfigurationSet",Aa);var tu=Math.pow(2,14)-1,Ls=-tu-1;function Ho(e){for(var t=8192/e.extent,r=e.loadGeometry(),s=0;s<r.length;s++)for(var d=r[s],E=0;E<d.length;E++){var I=d[E],G=Math.round(I.x*t),se=Math.round(I.y*t);I.x=ce(G,Ls,tu),I.y=ce(se,Ls,tu),(G<I.x||G>I.x+1||se<I.y||se>I.y+1)&&Ce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function xs(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ho(e):[]}}function zs(e,t,r,s,d){e.emplaceBack(2*t+(s+1)/2,2*r+(d+1)/2)}var yu=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new uc,this.indexArray=new $l,this.segments=new Et,this.programConfigurations=new Aa(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Xc(e,t){for(var r=0;r<e.length;r++)if(Us(t,e[r]))return!0;for(var s=0;s<t.length;s++)if(Us(e,t[s]))return!0;return!!uf(e,t)}function ou(e,t,r){return!!Us(e,t)||!!Ol(t,e,r)}function su(e,t){if(e.length===1)return Mc(t,e[0]);for(var r=0;r<t.length;r++)for(var s=t[r],d=0;d<s.length;d++)if(Us(e,s[d]))return!0;for(var E=0;E<e.length;E++)if(Mc(t,e[E]))return!0;for(var I=0;I<t.length;I++)if(uf(e,t[I]))return!0;return!1}function Fs(e,t,r){if(e.length>1){if(uf(e,t))return!0;for(var s=0;s<t.length;s++)if(Ol(t[s],e,r))return!0}for(var d=0;d<e.length;d++)if(Ol(e[d],t,r))return!0;return!1}function uf(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var s=e[r],d=e[r+1],E=0;E<t.length-1;E++)if(tl(s,d,t[E],t[E+1]))return!0;return!1}function tl(e,t,r,s){return Fe(e,r,s)!==Fe(t,r,s)&&Fe(e,t,r)!==Fe(e,t,s)}function Ol(e,t,r){var s=r*r;if(t.length===1)return e.distSqr(t[0])<s;for(var d=1;d<t.length;d++)if(wc(e,t[d-1],t[d])<s)return!0;return!1}function wc(e,t,r){var s=t.distSqr(r);if(s===0)return e.distSqr(t);var d=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/s;return e.distSqr(d<0?t:d>1?r:r.sub(t)._mult(d)._add(t))}function Mc(e,t){for(var r,s,d,E=!1,I=0;I<e.length;I++)for(var G=0,se=(r=e[I]).length-1;G<r.length;se=G++)(s=r[G]).y>t.y!=(d=r[se]).y>t.y&&t.x<(d.x-s.x)*(t.y-s.y)/(d.y-s.y)+s.x&&(E=!E);return E}function Us(e,t){for(var r=!1,s=0,d=e.length-1;s<e.length;d=s++){var E=e[s],I=e[d];E.y>t.y!=I.y>t.y&&t.x<(I.x-E.x)*(t.y-E.y)/(I.y-E.y)+E.x&&(r=!r)}return r}function Yc(e,t,r){var s=r[0],d=r[2];if(e.x<s.x&&t.x<s.x||e.x>d.x&&t.x>d.x||e.y<s.y&&t.y<s.y||e.y>d.y&&t.y>d.y)return!1;var E=Fe(e,t,r[0]);return E!==Fe(e,t,r[1])||E!==Fe(e,t,r[2])||E!==Fe(e,t,r[3])}function Il(e,t,r){var s=t.paint.get(e).value;return s.kind==="constant"?s.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Bs(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function pc(e,t,r,s,d){if(!t[0]&&!t[1])return e;var E=D.convert(t)._mult(d);r==="viewport"&&E._rotate(-s);for(var I=[],G=0;G<e.length;G++)I.push(e[G].sub(E));return I}yu.prototype.populate=function(e,t,r){var s=this.layers[0],d=[],E=null;s.type==="circle"&&(E=s.layout.get("circle-sort-key"));for(var I=0,G=e;I<G.length;I+=1){var se=G[I],be=se.feature,we=se.id,Ze=se.index,ot=se.sourceLayerIndex,bt=this.layers[0]._featureFilter.needGeometry,Qt=xs(be,bt);if(this.layers[0]._featureFilter.filter(new fo(this.zoom),Qt,r)){var tr=E?E.evaluate(Qt,{},r):void 0,br={id:we,properties:be.properties,type:be.type,sourceLayerIndex:ot,index:Ze,geometry:bt?Qt.geometry:Ho(be),patterns:{},sortKey:tr};d.push(br)}}E&&d.sort(function(wi,va){return wi.sortKey-va.sortKey});for(var cr=0,Zr=d;cr<Zr.length;cr+=1){var Yr=Zr[cr],ln=Yr.geometry,vn=Yr.index,Ln=Yr.sourceLayerIndex,oi=e[vn].feature;this.addFeature(Yr,ln,vn,r),t.featureIndex.insert(oi,ln,vn,Ln,this.index)}},yu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},yu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},yu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},yu.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xt),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},yu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},yu.prototype.addFeature=function(e,t,r,s){for(var d=0,E=t;d<E.length;d+=1)for(var I=0,G=E[d];I<G.length;I+=1){var se=G[I],be=se.x,we=se.y;if(!(be<0||be>=8192||we<0||we>=8192)){var Ze=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),ot=Ze.vertexLength;zs(this.layoutVertexArray,be,we,-1,-1),zs(this.layoutVertexArray,be,we,1,-1),zs(this.layoutVertexArray,be,we,1,1),zs(this.layoutVertexArray,be,we,-1,1),this.indexArray.emplaceBack(ot,ot+1,ot+2),this.indexArray.emplaceBack(ot,ot+3,ot+2),Ze.vertexLength+=4,Ze.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},s)},zi("CircleBucket",yu,{omit:["layers"]});var dc=new mu({"circle-sort-key":new Vi(lt.layout_circle["circle-sort-key"])}),ql={paint:new mu({"circle-radius":new Vi(lt.paint_circle["circle-radius"]),"circle-color":new Vi(lt.paint_circle["circle-color"]),"circle-blur":new Vi(lt.paint_circle["circle-blur"]),"circle-opacity":new Vi(lt.paint_circle["circle-opacity"]),"circle-translate":new la(lt.paint_circle["circle-translate"]),"circle-translate-anchor":new la(lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new la(lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new la(lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vi(lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vi(lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vi(lt.paint_circle["circle-stroke-opacity"])}),layout:dc},Uo=typeof Float32Array!="undefined"?Float32Array:Array;function rl(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function uu(e,t,r){var s=t[0],d=t[1],E=t[2],I=t[3],G=t[4],se=t[5],be=t[6],we=t[7],Ze=t[8],ot=t[9],bt=t[10],Qt=t[11],tr=t[12],br=t[13],cr=t[14],Zr=t[15],Yr=r[0],ln=r[1],vn=r[2],Ln=r[3];return e[0]=Yr*s+ln*G+vn*Ze+Ln*tr,e[1]=Yr*d+ln*se+vn*ot+Ln*br,e[2]=Yr*E+ln*be+vn*bt+Ln*cr,e[3]=Yr*I+ln*we+vn*Qt+Ln*Zr,e[4]=(Yr=r[4])*s+(ln=r[5])*G+(vn=r[6])*Ze+(Ln=r[7])*tr,e[5]=Yr*d+ln*se+vn*ot+Ln*br,e[6]=Yr*E+ln*be+vn*bt+Ln*cr,e[7]=Yr*I+ln*we+vn*Qt+Ln*Zr,e[8]=(Yr=r[8])*s+(ln=r[9])*G+(vn=r[10])*Ze+(Ln=r[11])*tr,e[9]=Yr*d+ln*se+vn*ot+Ln*br,e[10]=Yr*E+ln*be+vn*bt+Ln*cr,e[11]=Yr*I+ln*we+vn*Qt+Ln*Zr,e[12]=(Yr=r[12])*s+(ln=r[13])*G+(vn=r[14])*Ze+(Ln=r[15])*tr,e[13]=Yr*d+ln*se+vn*ot+Ln*br,e[14]=Yr*E+ln*be+vn*bt+Ln*cr,e[15]=Yr*I+ln*we+vn*Qt+Ln*Zr,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var vc,jf=uu;function Pc(e,t,r){var s=t[0],d=t[1],E=t[2],I=t[3];return e[0]=r[0]*s+r[4]*d+r[8]*E+r[12]*I,e[1]=r[1]*s+r[5]*d+r[9]*E+r[13]*I,e[2]=r[2]*s+r[6]*d+r[10]*E+r[14]*I,e[3]=r[3]*s+r[7]*d+r[11]*E+r[15]*I,e}vc=new Uo(3),Uo!=Float32Array&&(vc[0]=0,vc[1]=0,vc[2]=0),function(){var e=new Uo(4);Uo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Lf=(function(){var e=new Uo(2);Uo!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,ql)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new yu(r)},t.prototype.queryRadius=function(r){var s=r;return Il("circle-radius",this,s)+Il("circle-stroke-width",this,s)+Bs(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,s,d,E,I,G,se,be){for(var we=pc(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),G.angle,se),Ze=this.paint.get("circle-radius").evaluate(s,d)+this.paint.get("circle-stroke-width").evaluate(s,d),ot=this.paint.get("circle-pitch-alignment")==="map",bt=ot?we:function(oi,wi){return oi.map(function(va){return Rl(va,wi)})}(we,be),Qt=ot?Ze*se:Ze,tr=0,br=E;tr<br.length;tr+=1)for(var cr=0,Zr=br[tr];cr<Zr.length;cr+=1){var Yr=Zr[cr],ln=ot?Yr:Rl(Yr,be),vn=Qt,Ln=Pc([],[Yr.x,Yr.y,0,1],be);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?vn*=Ln[3]/G.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(vn*=G.cameraToCenterDistance/Ln[3]),ou(bt,ln,vn))return!0}return!1},t}(Pl));function Rl(e,t){var r=Pc([],[e.x,e.y,0,1],t);return new D(r[0]/r[3],r[1]/r[3])}var Du=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(yu);function ku(e,t,r,s){var d=t.width,E=t.height;if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==d*E*r)throw new RangeError("mismatched image size")}else s=new Uint8Array(d*E*r);return e.width=d,e.height=E,e.data=s,e}function Lc(e,t,r){var s=t.width,d=t.height;if(s!==e.width||d!==e.height){var E=ku({},{width:s,height:d},r);lf(e,E,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,s),height:Math.min(e.height,d)},r),e.width=s,e.height=d,e.data=E.data}}function lf(e,t,r,s,d,E){if(d.width===0||d.height===0)return t;if(d.width>e.width||d.height>e.height||r.x>e.width-d.width||r.y>e.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||s.x>t.width-d.width||s.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");for(var I=e.data,G=t.data,se=0;se<d.height;se++)for(var be=((r.y+se)*e.width+r.x)*E,we=((s.y+se)*t.width+s.x)*E,Ze=0;Ze<d.width*E;Ze++)G[we+Ze]=I[be+Ze];return t}zi("HeatmapBucket",Du,{omit:["layers"]});var Oc=function(e,t){ku(this,e,1,t)};Oc.prototype.resize=function(e){Lc(this,e,1)},Oc.prototype.clone=function(){return new Oc({width:this.width,height:this.height},new Uint8Array(this.data))},Oc.copy=function(e,t,r,s,d){lf(e,t,r,s,d,1)};var hu=function(e,t){ku(this,e,4,t)};hu.prototype.resize=function(e){Lc(this,e,4)},hu.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},hu.prototype.clone=function(){return new hu({width:this.width,height:this.height},new Uint8Array(this.data))},hu.copy=function(e,t,r,s,d){lf(e,t,r,s,d,4)},zi("AlphaImage",Oc),zi("RGBAImage",hu);var bf={paint:new mu({"heatmap-radius":new Vi(lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vi(lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new la(lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Wl(lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new la(lt.paint_heatmap["heatmap-opacity"])})};function Gf(e){var t={},r=e.resolution||256,s=e.clips?e.clips.length:1,d=e.image||new hu({width:r,height:s}),E=function(Qt,tr,br){t[e.evaluationKey]=br;var cr=e.expression.evaluate(t);d.data[Qt+tr+0]=Math.floor(255*cr.r/cr.a),d.data[Qt+tr+1]=Math.floor(255*cr.g/cr.a),d.data[Qt+tr+2]=Math.floor(255*cr.b/cr.a),d.data[Qt+tr+3]=Math.floor(255*cr.a)};if(e.clips)for(var I=0,G=0;I<s;++I,G+=4*r)for(var se=0,be=0;se<r;se++,be+=4){var we=se/(r-1),Ze=e.clips[I];E(G,be,Ze.start*(1-we)+Ze.end*we)}else for(var ot=0,bt=0;ot<r;ot++,bt+=4)E(0,bt,ot/(r-1));return d}var Kf=function(e){function t(r){e.call(this,r,bf),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Du(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Gf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Pl),Ef={paint:new mu({"hillshade-illumination-direction":new la(lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new la(lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new la(lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new la(lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new la(lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new la(lt.paint_hillshade["hillshade-accent-color"])})},Cf=function(e){function t(r){e.call(this,r,Ef)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Pl),_h=fs([{name:"a_pos",components:2,type:"Int16"}],4).members,$c=If,Of=If;function If(e,t,r){r=r||2;var s,d,E,I,G,se,be,we=t&&t.length,Ze=we?t[0]*r:e.length,ot=Rf(e,0,Ze,r,!0),bt=[];if(!ot||ot.next===ot.prev)return bt;if(we&&(ot=function(tr,br,cr,Zr){var Yr,ln,vn,Ln=[];for(Yr=0,ln=br.length;Yr<ln;Yr++)(vn=Rf(tr,br[Yr]*Zr,Yr<ln-1?br[Yr+1]*Zr:tr.length,Zr,!1))===vn.next&&(vn.steiner=!0),Ln.push(ch(vn));for(Ln.sort(gp),Yr=0;Yr<Ln.length;Yr++)lh(Ln[Yr],cr),cr=dl(cr,cr.next);return cr}(e,t,ot,r)),e.length>80*r){s=E=e[0],d=I=e[1];for(var Qt=r;Qt<Ze;Qt+=r)(G=e[Qt])<s&&(s=G),(se=e[Qt+1])<d&&(d=se),G>E&&(E=G),se>I&&(I=se);be=(be=Math.max(E-s,I-d))!==0?1/be:0}return uh(ot,bt,r,s,d,be),bt}function Rf(e,t,r,s,d){var E,I;if(d===C(e,t,r,s)>0)for(E=t;E<r;E+=s)I=qc(E,e[E],e[E+1],I);else for(E=r-s;E>=t;E-=s)I=qc(E,e[E],e[E+1],I);return I&&Qf(I,I.next)&&(Qc(I),I=I.next),I}function dl(e,t){if(!e)return e;t||(t=e);var r,s=e;do if(r=!1,s.steiner||!Qf(s,s.next)&&ns(s.prev,s,s.next)!==0)s=s.next;else{if(Qc(s),(s=t=s.prev)===s.next)break;r=!0}while(r||s!==t);return t}function uh(e,t,r,s,d,E,I){if(e){!I&&E&&function(we,Ze,ot,bt){var Qt=we;do Qt.z===null&&(Qt.z=Ph(Qt.x,Qt.y,Ze,ot,bt)),Qt.prevZ=Qt.prev,Qt.nextZ=Qt.next,Qt=Qt.next;while(Qt!==we);Qt.prevZ.nextZ=null,Qt.prevZ=null,function(tr){var br,cr,Zr,Yr,ln,vn,Ln,oi,wi=1;do{for(cr=tr,tr=null,ln=null,vn=0;cr;){for(vn++,Zr=cr,Ln=0,br=0;br<wi&&(Ln++,Zr=Zr.nextZ);br++);for(oi=wi;Ln>0||oi>0&&Zr;)Ln!==0&&(oi===0||!Zr||cr.z<=Zr.z)?(Yr=cr,cr=cr.nextZ,Ln--):(Yr=Zr,Zr=Zr.nextZ,oi--),ln?ln.nextZ=Yr:tr=Yr,Yr.prevZ=ln,ln=Yr;cr=Zr}ln.nextZ=null,wi*=2}while(vn>1)}(Qt)}(e,s,d,E);for(var G,se,be=e;e.prev!==e.next;)if(G=e.prev,se=e.next,E?qf(e,s,d,E):xh(e))t.push(G.i/r),t.push(e.i/r),t.push(se.i/r),Qc(e),e=se.next,be=se.next;else if((e=se)===be){I?I===1?uh(e=Vf(dl(e),t,r),t,r,s,d,E,2):I===2&&bh(e,t,r,s,d,E):uh(dl(e),t,r,s,d,E,1);break}}}function xh(e){var t=e.prev,r=e,s=e.next;if(ns(t,r,s)>=0)return!1;for(var d=e.next.next;d!==e.prev;){if(Fu(t.x,t.y,r.x,r.y,s.x,s.y,d.x,d.y)&&ns(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function qf(e,t,r,s){var d=e.prev,E=e,I=e.next;if(ns(d,E,I)>=0)return!1;for(var G=d.x>E.x?d.x>I.x?d.x:I.x:E.x>I.x?E.x:I.x,se=d.y>E.y?d.y>I.y?d.y:I.y:E.y>I.y?E.y:I.y,be=Ph(d.x<E.x?d.x<I.x?d.x:I.x:E.x<I.x?E.x:I.x,d.y<E.y?d.y<I.y?d.y:I.y:E.y<I.y?E.y:I.y,t,r,s),we=Ph(G,se,t,r,s),Ze=e.prevZ,ot=e.nextZ;Ze&&Ze.z>=be&&ot&&ot.z<=we;){if(Ze!==e.prev&&Ze!==e.next&&Fu(d.x,d.y,E.x,E.y,I.x,I.y,Ze.x,Ze.y)&&ns(Ze.prev,Ze,Ze.next)>=0||(Ze=Ze.prevZ,ot!==e.prev&&ot!==e.next&&Fu(d.x,d.y,E.x,E.y,I.x,I.y,ot.x,ot.y)&&ns(ot.prev,ot,ot.next)>=0))return!1;ot=ot.nextZ}for(;Ze&&Ze.z>=be;){if(Ze!==e.prev&&Ze!==e.next&&Fu(d.x,d.y,E.x,E.y,I.x,I.y,Ze.x,Ze.y)&&ns(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.prevZ}for(;ot&&ot.z<=we;){if(ot!==e.prev&&ot!==e.next&&Fu(d.x,d.y,E.x,E.y,I.x,I.y,ot.x,ot.y)&&ns(ot.prev,ot,ot.next)>=0)return!1;ot=ot.nextZ}return!0}function Vf(e,t,r){var s=e;do{var d=s.prev,E=s.next.next;!Qf(d,E)&&Df(d,s,s.next,E)&&Kc(d,E)&&Kc(E,d)&&(t.push(d.i/r),t.push(s.i/r),t.push(E.i/r),Qc(s),Qc(s.next),s=e=E),s=s.next}while(s!==e);return dl(s)}function bh(e,t,r,s,d,E){var I=e;do{for(var G=I.next.next;G!==I.prev;){if(I.i!==G.i&&Dl(I,G)){var se=kf(I,G);return I=dl(I,I.next),se=dl(se,se.next),uh(I,t,r,s,d,E),void uh(se,t,r,s,d,E)}G=G.next}I=I.next}while(I!==e)}function gp(e,t){return e.x-t.x}function lh(e,t){if(t=function(s,d){var E,I=d,G=s.x,se=s.y,be=-1/0;do{if(se<=I.y&&se>=I.next.y&&I.next.y!==I.y){var we=I.x+(se-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(we<=G&&we>be){if(be=we,we===G){if(se===I.y)return I;if(se===I.next.y)return I.next}E=I.x<I.next.x?I:I.next}}I=I.next}while(I!==d);if(!E)return null;if(G===be)return E;var Ze,ot=E,bt=E.x,Qt=E.y,tr=1/0;I=E;do G>=I.x&&I.x>=bt&&G!==I.x&&Fu(se<Qt?G:be,se,bt,Qt,se<Qt?be:G,se,I.x,I.y)&&(Ze=Math.abs(se-I.y)/(G-I.x),Kc(I,s)&&(Ze<tr||Ze===tr&&(I.x>E.x||I.x===E.x&&Gh(E,I)))&&(E=I,tr=Ze)),I=I.next;while(I!==ot);return E}(e,t)){var r=kf(t,e);dl(t,t.next),dl(r,r.next)}}function Gh(e,t){return ns(e.prev,e,t.prev)<0&&ns(t.next,e,e.next)<0}function Ph(e,t,r,s,d){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*d)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*d)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ch(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Fu(e,t,r,s,d,E,I,G){return(d-I)*(t-G)-(e-I)*(E-G)>=0&&(e-I)*(s-G)-(r-I)*(t-G)>=0&&(r-I)*(E-G)-(d-I)*(s-G)>=0}function Dl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,s){var d=r;do{if(d.i!==r.i&&d.next.i!==r.i&&d.i!==s.i&&d.next.i!==s.i&&Df(d,d.next,r,s))return!0;d=d.next}while(d!==r);return!1}(e,t)&&(Kc(e,t)&&Kc(t,e)&&function(r,s){var d=r,E=!1,I=(r.x+s.x)/2,G=(r.y+s.y)/2;do d.y>G!=d.next.y>G&&d.next.y!==d.y&&I<(d.next.x-d.x)*(G-d.y)/(d.next.y-d.y)+d.x&&(E=!E),d=d.next;while(d!==r);return E}(e,t)&&(ns(e.prev,e,t.prev)||ns(e,t.prev,t))||Qf(e,t)&&ns(e.prev,e,e.next)>0&&ns(t.prev,t,t.next)>0)}function ns(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Qf(e,t){return e.x===t.x&&e.y===t.y}function Df(e,t,r,s){var d=Wf(ns(e,t,r)),E=Wf(ns(e,t,s)),I=Wf(ns(r,s,e)),G=Wf(ns(r,s,t));return d!==E&&I!==G||!(d!==0||!Hf(e,r,t))||!(E!==0||!Hf(e,s,t))||!(I!==0||!Hf(r,e,s))||!(G!==0||!Hf(r,t,s))}function Hf(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Wf(e){return e>0?1:e<0?-1:0}function Kc(e,t){return ns(e.prev,e,e.next)<0?ns(e,t,e.next)>=0&&ns(e,e.prev,t)>=0:ns(e,t,e.prev)<0||ns(e,e.next,t)<0}function kf(e,t){var r=new Ic(e.i,e.x,e.y),s=new Ic(t.i,t.x,t.y),d=e.next,E=t.prev;return e.next=t,t.prev=e,r.next=d,d.prev=r,s.next=r,r.prev=s,E.next=s,s.prev=E,s}function qc(e,t,r,s){var d=new Ic(e,t,r);return s?(d.next=s.next,d.prev=s,s.next.prev=d,s.next=d):(d.prev=d,d.next=d),d}function Qc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ic(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(e,t,r,s){for(var d=0,E=t,I=r-s;E<r;E+=s)d+=(e[I]-e[E])*(e[E+1]+e[I+1]),I=E;return d}function ve(e,t,r,s,d){(function E(I,G,se,be,we){for(;be>se;){if(be-se>600){var Ze=be-se+1,ot=G-se+1,bt=Math.log(Ze),Qt=.5*Math.exp(2*bt/3),tr=.5*Math.sqrt(bt*Qt*(Ze-Qt)/Ze)*(ot-Ze/2<0?-1:1);E(I,G,Math.max(se,Math.floor(G-ot*Qt/Ze+tr)),Math.min(be,Math.floor(G+(Ze-ot)*Qt/Ze+tr)),we)}var br=I[G],cr=se,Zr=be;for($(I,se,G),we(I[be],br)>0&&$(I,se,be);cr<Zr;){for($(I,cr,Zr),cr++,Zr--;we(I[cr],br)<0;)cr++;for(;we(I[Zr],br)>0;)Zr--}we(I[se],br)===0?$(I,se,Zr):$(I,++Zr,be),Zr<=G&&(se=Zr+1),G<=Zr&&(be=Zr-1)}})(e,t,r||0,s||e.length-1,d||ee)}function $(e,t,r){var s=e[t];e[t]=e[r],e[r]=s}function ee(e,t){return e<t?-1:e>t?1:0}function Ee(e,t){var r=e.length;if(r<=1)return[e];for(var s,d,E=[],I=0;I<r;I++){var G=Ke(e[I]);G!==0&&(e[I].area=Math.abs(G),d===void 0&&(d=G<0),d===G<0?(s&&E.push(s),s=[e[I]]):s.push(e[I]))}if(s&&E.push(s),t>1)for(var se=0;se<E.length;se++)E[se].length<=t||(ve(E[se],t,1,E[se].length-1,We),E[se]=E[se].slice(0,t));return E}function We(e,t){return t.area-e.area}function er(e,t,r){for(var s=r.patternDependencies,d=!1,E=0,I=t;E<I.length;E+=1){var G=I[E].paint.get(e+"-pattern");G.isConstant()||(d=!0);var se=G.constantOr(null);se&&(d=!0,s[se.to]=!0,s[se.from]=!0)}return d}function hr(e,t,r,s,d){for(var E=d.patternDependencies,I=0,G=t;I<G.length;I+=1){var se=G[I],be=se.paint.get(e+"-pattern").value;if(be.kind!=="constant"){var we=be.evaluate({zoom:s-1},r,{},d.availableImages),Ze=be.evaluate({zoom:s},r,{},d.availableImages),ot=be.evaluate({zoom:s+1},r,{},d.availableImages);Ze=Ze&&Ze.name?Ze.name:Ze,ot=ot&&ot.name?ot.name:ot,E[we=we&&we.name?we.name:we]=!0,E[Ze]=!0,E[ot]=!0,r.patterns[se.id]={min:we,mid:Ze,max:ot}}}return r}If.deviation=function(e,t,r,s){var d=t&&t.length,E=Math.abs(C(e,0,d?t[0]*r:e.length,r));if(d)for(var I=0,G=t.length;I<G;I++)E-=Math.abs(C(e,t[I]*r,I<G-1?t[I+1]*r:e.length,r));var se=0;for(I=0;I<s.length;I+=3){var be=s[I]*r,we=s[I+1]*r,Ze=s[I+2]*r;se+=Math.abs((e[be]-e[Ze])*(e[we+1]-e[be+1])-(e[be]-e[we])*(e[Ze+1]-e[be+1]))}return E===0&&se===0?0:Math.abs((se-E)/E)},If.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,d=0;d<e.length;d++){for(var E=0;E<e[d].length;E++)for(var I=0;I<t;I++)r.vertices.push(e[d][E][I]);d>0&&r.holes.push(s+=e[d-1].length)}return r},$c.default=Of;var Kt=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new uc,this.indexArray=new $l,this.indexArray2=new sf,this.programConfigurations=new Aa(e.layers,e.zoom),this.segments=new Et,this.segments2=new Et,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Kt.prototype.populate=function(e,t,r){this.hasPattern=er("fill",this.layers,t);for(var s=this.layers[0].layout.get("fill-sort-key"),d=[],E=0,I=e;E<I.length;E+=1){var G=I[E],se=G.feature,be=G.id,we=G.index,Ze=G.sourceLayerIndex,ot=this.layers[0]._featureFilter.needGeometry,bt=xs(se,ot);if(this.layers[0]._featureFilter.filter(new fo(this.zoom),bt,r)){var Qt=s?s.evaluate(bt,{},r,t.availableImages):void 0,tr={id:be,properties:se.properties,type:se.type,sourceLayerIndex:Ze,index:we,geometry:ot?bt.geometry:Ho(se),patterns:{},sortKey:Qt};d.push(tr)}}s&&d.sort(function(oi,wi){return oi.sortKey-wi.sortKey});for(var br=0,cr=d;br<cr.length;br+=1){var Zr=cr[br],Yr=Zr.geometry,ln=Zr.index,vn=Zr.sourceLayerIndex;if(this.hasPattern){var Ln=hr("fill",this.layers,Zr,this.zoom,t);this.patternFeatures.push(Ln)}else this.addFeature(Zr,Yr,ln,r,{});t.featureIndex.insert(e[ln].feature,Yr,ln,vn,this.index)}},Kt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Kt.prototype.addFeatures=function(e,t,r){for(var s=0,d=this.patternFeatures;s<d.length;s+=1){var E=d[s];this.addFeature(E,E.geometry,E.index,t,r)}},Kt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Kt.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Kt.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_h),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Kt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Kt.prototype.addFeature=function(e,t,r,s,d){for(var E=0,I=Ee(t,500);E<I.length;E+=1){for(var G=I[E],se=0,be=0,we=G;be<we.length;be+=1)se+=we[be].length;for(var Ze=this.segments.prepareSegment(se,this.layoutVertexArray,this.indexArray),ot=Ze.vertexLength,bt=[],Qt=[],tr=0,br=G;tr<br.length;tr+=1){var cr=br[tr];if(cr.length!==0){cr!==G[0]&&Qt.push(bt.length/2);var Zr=this.segments2.prepareSegment(cr.length,this.layoutVertexArray,this.indexArray2),Yr=Zr.vertexLength;this.layoutVertexArray.emplaceBack(cr[0].x,cr[0].y),this.indexArray2.emplaceBack(Yr+cr.length-1,Yr),bt.push(cr[0].x),bt.push(cr[0].y);for(var ln=1;ln<cr.length;ln++)this.layoutVertexArray.emplaceBack(cr[ln].x,cr[ln].y),this.indexArray2.emplaceBack(Yr+ln-1,Yr+ln),bt.push(cr[ln].x),bt.push(cr[ln].y);Zr.vertexLength+=cr.length,Zr.primitiveLength+=cr.length}}for(var vn=$c(bt,Qt),Ln=0;Ln<vn.length;Ln+=3)this.indexArray.emplaceBack(ot+vn[Ln],ot+vn[Ln+1],ot+vn[Ln+2]);Ze.vertexLength+=se,Ze.primitiveLength+=vn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,s)},zi("FillBucket",Kt,{omit:["layers","patternFeatures"]});var kr=new mu({"fill-sort-key":new Vi(lt.layout_fill["fill-sort-key"])}),wn={paint:new mu({"fill-antialias":new la(lt.paint_fill["fill-antialias"]),"fill-opacity":new Vi(lt.paint_fill["fill-opacity"]),"fill-color":new Vi(lt.paint_fill["fill-color"]),"fill-outline-color":new Vi(lt.paint_fill["fill-outline-color"]),"fill-translate":new la(lt.paint_fill["fill-translate"]),"fill-translate-anchor":new la(lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new wf(lt.paint_fill["fill-pattern"])}),layout:kr},Ai=function(e){function t(r){e.call(this,r,wn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,s){e.prototype.recalculate.call(this,r,s);var d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Kt(r)},t.prototype.queryRadius=function(){return Bs(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,s,d,E,I,G,se){return su(pc(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),G.angle,se),E)},t.prototype.isTileClipped=function(){return!0},t}(Pl),Hi=fs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,$i=R;function R(e,t,r,s,d){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=s,this._values=d,e.readFields(m,this,t)}function m(e,t,r){e==1?t.id=r.readVarint():e==2?function(s,d){for(var E=s.readVarint()+s.pos;s.pos<E;){var I=d._keys[s.readVarint()],G=d._values[s.readVarint()];d.properties[I]=G}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function u(e){for(var t,r,s=0,d=0,E=e.length,I=E-1;d<E;I=d++)s+=((r=e[I]).x-(t=e[d]).x)*(t.y+r.y);return s}R.types=["Unknown","Point","LineString","Polygon"],R.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,s=1,d=0,E=0,I=0,G=[];e.pos<r;){if(d<=0){var se=e.readVarint();s=7&se,d=se>>3}if(d--,s===1||s===2)E+=e.readSVarint(),I+=e.readSVarint(),s===1&&(t&&G.push(t),t=[]),t.push(new D(E,I));else{if(s!==7)throw new Error("unknown command "+s);t&&t.push(t[0].clone())}}return t&&G.push(t),G},R.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,s=0,d=0,E=0,I=1/0,G=-1/0,se=1/0,be=-1/0;e.pos<t;){if(s<=0){var we=e.readVarint();r=7&we,s=we>>3}if(s--,r===1||r===2)(d+=e.readSVarint())<I&&(I=d),d>G&&(G=d),(E+=e.readSVarint())<se&&(se=E),E>be&&(be=E);else if(r!==7)throw new Error("unknown command "+r)}return[I,se,G,be]},R.prototype.toGeoJSON=function(e,t,r){var s,d,E=this.extent*Math.pow(2,r),I=this.extent*e,G=this.extent*t,se=this.loadGeometry(),be=R.types[this.type];function we(bt){for(var Qt=0;Qt<bt.length;Qt++){var tr=bt[Qt];bt[Qt]=[360*(tr.x+I)/E-180,360/Math.PI*Math.atan(Math.exp((180-360*(tr.y+G)/E)*Math.PI/180))-90]}}switch(this.type){case 1:var Ze=[];for(s=0;s<se.length;s++)Ze[s]=se[s][0];we(se=Ze);break;case 2:for(s=0;s<se.length;s++)we(se[s]);break;case 3:for(se=function(bt){var Qt=bt.length;if(Qt<=1)return[bt];for(var tr,br,cr=[],Zr=0;Zr<Qt;Zr++){var Yr=u(bt[Zr]);Yr!==0&&(br===void 0&&(br=Yr<0),br===Yr<0?(tr&&cr.push(tr),tr=[bt[Zr]]):tr.push(bt[Zr]))}return tr&&cr.push(tr),cr}(se),s=0;s<se.length;s++)for(d=0;d<se[s].length;d++)we(se[s][d])}se.length===1?se=se[0]:be="Multi"+be;var ot={type:"Feature",geometry:{type:be,coordinates:se},properties:this.properties};return"id"in this&&(ot.id=this.id),ot};var _=b;function b(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(q,this,t),this.length=this._features.length}function q(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(s){for(var d=null,E=s.readVarint()+s.pos;s.pos<E;){var I=s.readVarint()>>3;d=I===1?s.readString():I===2?s.readFloat():I===3?s.readDouble():I===4?s.readVarint64():I===5?s.readVarint():I===6?s.readSVarint():I===7?s.readBoolean():null}return d}(r))}function de(e,t,r){if(e===3){var s=new _(r,r.readVarint()+r.pos);s.length&&(t[s.name]=s)}}b.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new $i(this._pbf,t,this.extent,this._keys,this._values)};var ct={VectorTile:function(e,t){this.layers=e.readFields(de,{},t)},VectorTileFeature:$i,VectorTileLayer:_},st=ct.VectorTileFeature.types,Mt=Math.pow(2,13);function Ir(e,t,r,s,d,E,I,G){e.emplaceBack(t,r,2*Math.floor(s*Mt)+I,d*Mt*2,E*Mt*2,Math.round(G))}var Gr=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ll,this.indexArray=new $l,this.programConfigurations=new Aa(e.layers,e.zoom),this.segments=new Et,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function xn(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Gr.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=er("fill-extrusion",this.layers,t);for(var s=0,d=e;s<d.length;s+=1){var E=d[s],I=E.feature,G=E.id,se=E.index,be=E.sourceLayerIndex,we=this.layers[0]._featureFilter.needGeometry,Ze=xs(I,we);if(this.layers[0]._featureFilter.filter(new fo(this.zoom),Ze,r)){var ot={id:G,sourceLayerIndex:be,index:se,geometry:we?Ze.geometry:Ho(I),properties:I.properties,type:I.type,patterns:{}};this.hasPattern?this.features.push(hr("fill-extrusion",this.layers,ot,this.zoom,t)):this.addFeature(ot,ot.geometry,se,r,{}),t.featureIndex.insert(I,ot.geometry,se,be,this.index,!0)}}},Gr.prototype.addFeatures=function(e,t,r){for(var s=0,d=this.features;s<d.length;s+=1){var E=d[s];this.addFeature(E,E.geometry,E.index,t,r)}},Gr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Gr.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Gr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Gr.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Hi),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Gr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Gr.prototype.addFeature=function(e,t,r,s,d){for(var E=0,I=Ee(t,500);E<I.length;E+=1){for(var G=I[E],se=0,be=0,we=G;be<we.length;be+=1)se+=we[be].length;for(var Ze=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ot=0,bt=G;ot<bt.length;ot+=1){var Qt=bt[ot];if(Qt.length!==0&&!((jo=Qt).every(function(Eo){return Eo.x<0})||jo.every(function(Eo){return Eo.x>8192})||jo.every(function(Eo){return Eo.y<0})||jo.every(function(Eo){return Eo.y>8192})))for(var tr=0,br=0;br<Qt.length;br++){var cr=Qt[br];if(br>=1){var Zr=Qt[br-1];if(!xn(cr,Zr)){Ze.vertexLength+4>Et.MAX_VERTEX_ARRAY_LENGTH&&(Ze=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Yr=cr.sub(Zr)._perp()._unit(),ln=Zr.dist(cr);tr+ln>32768&&(tr=0),Ir(this.layoutVertexArray,cr.x,cr.y,Yr.x,Yr.y,0,0,tr),Ir(this.layoutVertexArray,cr.x,cr.y,Yr.x,Yr.y,0,1,tr),Ir(this.layoutVertexArray,Zr.x,Zr.y,Yr.x,Yr.y,0,0,tr+=ln),Ir(this.layoutVertexArray,Zr.x,Zr.y,Yr.x,Yr.y,0,1,tr);var vn=Ze.vertexLength;this.indexArray.emplaceBack(vn,vn+2,vn+1),this.indexArray.emplaceBack(vn+1,vn+2,vn+3),Ze.vertexLength+=4,Ze.primitiveLength+=2}}}}if(Ze.vertexLength+se>Et.MAX_VERTEX_ARRAY_LENGTH&&(Ze=this.segments.prepareSegment(se,this.layoutVertexArray,this.indexArray)),st[e.type]==="Polygon"){for(var Ln=[],oi=[],wi=Ze.vertexLength,va=0,Fi=G;va<Fi.length;va+=1){var Ca=Fi[va];if(Ca.length!==0){Ca!==G[0]&&oi.push(Ln.length/2);for(var Ni=0;Ni<Ca.length;Ni++){var Oo=Ca[Ni];Ir(this.layoutVertexArray,Oo.x,Oo.y,0,0,1,1,0),Ln.push(Oo.x),Ln.push(Oo.y)}}}for(var $a=$c(Ln,oi),Wi=0;Wi<$a.length;Wi+=3)this.indexArray.emplaceBack(wi+$a[Wi],wi+$a[Wi+2],wi+$a[Wi+1]);Ze.primitiveLength+=$a.length/3,Ze.vertexLength+=se}}var jo;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,s)},zi("FillExtrusionBucket",Gr,{omit:["layers","features"]});var gn={paint:new mu({"fill-extrusion-opacity":new la(lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vi(lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new la(lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new la(lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wf(lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vi(lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vi(lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new la(lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Sn=function(e){function t(r){e.call(this,r,gn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Gr(r)},t.prototype.queryRadius=function(){return Bs(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,s,d,E,I,G,se,be){var we=pc(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),G.angle,se),Ze=this.paint.get("fill-extrusion-height").evaluate(s,d),ot=this.paint.get("fill-extrusion-base").evaluate(s,d),bt=function(tr,br,cr,Zr){for(var Yr=[],ln=0,vn=tr;ln<vn.length;ln+=1){var Ln=vn[ln],oi=[Ln.x,Ln.y,0,1];Pc(oi,oi,br),Yr.push(new D(oi[0]/oi[3],oi[1]/oi[3]))}return Yr}(we,be),Qt=function(tr,br,cr,Zr){for(var Yr=[],ln=[],vn=Zr[8]*br,Ln=Zr[9]*br,oi=Zr[10]*br,wi=Zr[11]*br,va=Zr[8]*cr,Fi=Zr[9]*cr,Ca=Zr[10]*cr,Ni=Zr[11]*cr,Oo=0,$a=tr;Oo<$a.length;Oo+=1){for(var Wi=[],jo=[],Eo=0,Qo=$a[Oo];Eo<Qo.length;Eo+=1){var Ra=Qo[Eo],vs=Ra.x,Is=Ra.y,lu=Zr[0]*vs+Zr[4]*Is+Zr[12],pu=Zr[1]*vs+Zr[5]*Is+Zr[13],cu=Zr[2]*vs+Zr[6]*Is+Zr[14],xu=Zr[3]*vs+Zr[7]*Is+Zr[15],ul=cu+oi,Wu=xu+wi,gl=lu+va,Xu=pu+Fi,_c=cu+Ca,zu=xu+Ni,Bl=new D((lu+vn)/Wu,(pu+Ln)/Wu);Bl.z=ul/Wu,Wi.push(Bl);var Go=new D(gl/zu,Xu/zu);Go.z=_c/zu,jo.push(Go)}Yr.push(Wi),ln.push(jo)}return[Yr,ln]}(E,ot,Ze,be);return function(tr,br,cr){var Zr=1/0;su(cr,br)&&(Zr=bi(cr,br[0]));for(var Yr=0;Yr<br.length;Yr++)for(var ln=br[Yr],vn=tr[Yr],Ln=0;Ln<ln.length-1;Ln++){var oi=ln[Ln],wi=[oi,ln[Ln+1],vn[Ln+1],vn[Ln],oi];Xc(cr,wi)&&(Zr=Math.min(Zr,bi(cr,wi)))}return Zr!==1/0&&Zr}(Qt[0],Qt[1],bt)},t}(Pl);function Wn(e,t){return e.x*t.x+e.y*t.y}function bi(e,t){if(e.length===1){for(var r,s=0,d=t[s++];!r||d.equals(r);)if(!(r=t[s++]))return 1/0;for(;s<t.length;s++){var E=t[s],I=e[0],G=r.sub(d),se=E.sub(d),be=I.sub(d),we=Wn(G,G),Ze=Wn(G,se),ot=Wn(se,se),bt=Wn(be,G),Qt=Wn(be,se),tr=we*ot-Ze*Ze,br=(ot*bt-Ze*Qt)/tr,cr=(we*Qt-Ze*bt)/tr,Zr=d.z*(1-br-cr)+r.z*br+E.z*cr;if(isFinite(Zr))return Zr}return 1/0}for(var Yr=1/0,ln=0,vn=t;ln<vn.length;ln+=1)Yr=Math.min(Yr,vn[ln].z);return Yr}var pa=fs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Wa=fs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Qa=ct.VectorTileFeature.types,ro=Math.cos(Math.PI/180*37.5),Ko=Math.pow(2,14)/.5,sa=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){t.gradients[r.id]={}}),this.layoutVertexArray=new au,this.layoutVertexArray2=new Tc,this.indexArray=new $l,this.programConfigurations=new Aa(e.layers,e.zoom),this.segments=new Et,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};sa.prototype.populate=function(e,t,r){this.hasPattern=er("line",this.layers,t);for(var s=this.layers[0].layout.get("line-sort-key"),d=[],E=0,I=e;E<I.length;E+=1){var G=I[E],se=G.feature,be=G.id,we=G.index,Ze=G.sourceLayerIndex,ot=this.layers[0]._featureFilter.needGeometry,bt=xs(se,ot);if(this.layers[0]._featureFilter.filter(new fo(this.zoom),bt,r)){var Qt=s?s.evaluate(bt,{},r):void 0,tr={id:be,properties:se.properties,type:se.type,sourceLayerIndex:Ze,index:we,geometry:ot?bt.geometry:Ho(se),patterns:{},sortKey:Qt};d.push(tr)}}s&&d.sort(function(oi,wi){return oi.sortKey-wi.sortKey});for(var br=0,cr=d;br<cr.length;br+=1){var Zr=cr[br],Yr=Zr.geometry,ln=Zr.index,vn=Zr.sourceLayerIndex;if(this.hasPattern){var Ln=hr("line",this.layers,Zr,this.zoom,t);this.patternFeatures.push(Ln)}else this.addFeature(Zr,Yr,ln,r,{});t.featureIndex.insert(e[ln].feature,Yr,ln,vn,this.index)}},sa.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},sa.prototype.addFeatures=function(e,t,r){for(var s=0,d=this.patternFeatures;s<d.length;s+=1){var E=d[s];this.addFeature(E,E.geometry,E.index,t,r)}},sa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},sa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},sa.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Wa)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,pa),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},sa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},sa.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},sa.prototype.addFeature=function(e,t,r,s,d){var E=this.layers[0].layout,I=E.get("line-join").evaluate(e,{}),G=E.get("line-cap"),se=E.get("line-miter-limit"),be=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var we=0,Ze=t;we<Ze.length;we+=1)this.addLine(Ze[we],e,I,G,se,be);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,s)},sa.prototype.addLine=function(e,t,r,s,d,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var I=0;I<e.length-1;I++)this.totalDistance+=e[I].dist(e[I+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var G=Qa[t.type]==="Polygon",se=e.length;se>=2&&e[se-1].equals(e[se-2]);)se--;for(var be=0;be<se-1&&e[be].equals(e[be+1]);)be++;if(!(se<(G?3:2))){r==="bevel"&&(d=1.05);var we,Ze=this.overscaling<=16?122880/(512*this.overscaling):0,ot=this.segments.prepareSegment(10*se,this.layoutVertexArray,this.indexArray),bt=void 0,Qt=void 0,tr=void 0,br=void 0;this.e1=this.e2=-1,G&&(br=e[be].sub(we=e[se-2])._unit()._perp());for(var cr=be;cr<se;cr++)if(!(Qt=cr===se-1?G?e[be+1]:void 0:e[cr+1])||!e[cr].equals(Qt)){br&&(tr=br),we&&(bt=we),we=e[cr],br=Qt?Qt.sub(we)._unit()._perp():tr;var Zr=(tr=tr||br).add(br);Zr.x===0&&Zr.y===0||Zr._unit();var Yr=tr.x*br.x+tr.y*br.y,ln=Zr.x*br.x+Zr.y*br.y,vn=ln!==0?1/ln:1/0,Ln=2*Math.sqrt(2-2*ln),oi=ln<ro&&bt&&Qt,wi=tr.x*br.y-tr.y*br.x>0;if(oi&&cr>be){var va=we.dist(bt);if(va>2*Ze){var Fi=we.sub(we.sub(bt)._mult(Ze/va)._round());this.updateDistance(bt,Fi),this.addCurrentVertex(Fi,tr,0,0,ot),bt=Fi}}var Ca=bt&&Qt,Ni=Ca?r:G?"butt":s;if(Ca&&Ni==="round"&&(vn<E?Ni="miter":vn<=2&&(Ni="fakeround")),Ni==="miter"&&vn>d&&(Ni="bevel"),Ni==="bevel"&&(vn>2&&(Ni="flipbevel"),vn<d&&(Ni="miter")),bt&&this.updateDistance(bt,we),Ni==="miter")Zr._mult(vn),this.addCurrentVertex(we,Zr,0,0,ot);else if(Ni==="flipbevel"){if(vn>100)Zr=br.mult(-1);else{var Oo=vn*tr.add(br).mag()/tr.sub(br).mag();Zr._perp()._mult(Oo*(wi?-1:1))}this.addCurrentVertex(we,Zr,0,0,ot),this.addCurrentVertex(we,Zr.mult(-1),0,0,ot)}else if(Ni==="bevel"||Ni==="fakeround"){var $a=-Math.sqrt(vn*vn-1),Wi=wi?$a:0,jo=wi?0:$a;if(bt&&this.addCurrentVertex(we,tr,Wi,jo,ot),Ni==="fakeround")for(var Eo=Math.round(180*Ln/Math.PI/20),Qo=1;Qo<Eo;Qo++){var Ra=Qo/Eo;if(Ra!==.5){var vs=Ra-.5;Ra+=Ra*vs*(Ra-1)*((1.0904+Yr*(Yr*(3.55645-1.43519*Yr)-3.2452))*vs*vs+(.848013+Yr*(.215638*Yr-1.06021)))}var Is=br.sub(tr)._mult(Ra)._add(tr)._unit()._mult(wi?-1:1);this.addHalfVertex(we,Is.x,Is.y,!1,wi,0,ot)}Qt&&this.addCurrentVertex(we,br,-Wi,-jo,ot)}else if(Ni==="butt")this.addCurrentVertex(we,Zr,0,0,ot);else if(Ni==="square"){var lu=bt?1:-1;this.addCurrentVertex(we,Zr,lu,lu,ot)}else Ni==="round"&&(bt&&(this.addCurrentVertex(we,tr,0,0,ot),this.addCurrentVertex(we,tr,1,1,ot,!0)),Qt&&(this.addCurrentVertex(we,br,-1,-1,ot,!0),this.addCurrentVertex(we,br,0,0,ot)));if(oi&&cr<se-1){var pu=we.dist(Qt);if(pu>2*Ze){var cu=we.add(Qt.sub(we)._mult(Ze/pu)._round());this.updateDistance(we,cu),this.addCurrentVertex(cu,br,0,0,ot),we=cu}}}}},sa.prototype.addCurrentVertex=function(e,t,r,s,d,E){E===void 0&&(E=!1);var I=t.y*s-t.x,G=-t.y-t.x*s;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,E,!1,r,d),this.addHalfVertex(e,I,G,E,!0,-s,d),this.distance>Ko/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,s,d,E))},sa.prototype.addHalfVertex=function(e,t,r,s,d,E,I){var G=.5*(this.lineClips?this.scaledDistance*(Ko-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(s?1:0),(e.y<<1)+(d?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(E===0?0:E<0?-1:1)|(63&G)<<2,G>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var se=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,se),I.primitiveLength++),d?this.e2=se:this.e1=se},sa.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},sa.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},zi("LineBucket",sa,{omit:["layers","patternFeatures"]});var _o=new mu({"line-cap":new la(lt.layout_line["line-cap"]),"line-join":new Vi(lt.layout_line["line-join"]),"line-miter-limit":new la(lt.layout_line["line-miter-limit"]),"line-round-limit":new la(lt.layout_line["line-round-limit"]),"line-sort-key":new Vi(lt.layout_line["line-sort-key"])}),xa={paint:new mu({"line-opacity":new Vi(lt.paint_line["line-opacity"]),"line-color":new Vi(lt.paint_line["line-color"]),"line-translate":new la(lt.paint_line["line-translate"]),"line-translate-anchor":new la(lt.paint_line["line-translate-anchor"]),"line-width":new Vi(lt.paint_line["line-width"]),"line-gap-width":new Vi(lt.paint_line["line-gap-width"]),"line-offset":new Vi(lt.paint_line["line-offset"]),"line-blur":new Vi(lt.paint_line["line-blur"]),"line-dasharray":new wu(lt.paint_line["line-dasharray"]),"line-pattern":new wf(lt.paint_line["line-pattern"]),"line-gradient":new Wl(lt.paint_line["line-gradient"])}),layout:_o},xo=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,s){return s=new fo(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),e.prototype.possiblyEvaluate.call(this,r,s)},t.prototype.evaluate=function(r,s,d,E){return s=rt({},s,{zoom:Math.floor(s.zoom)}),e.prototype.evaluate.call(this,r,s,d,E)},t}(Vi))(xa.paint.properties["line-width"].specification);xo.useIntegerZoom=!0;var ds=function(e){function t(r){e.call(this,r,xa),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Fn,this.gradientVersion=(this.gradientVersion+1)%N)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,s){e.prototype.recalculate.call(this,r,s),this.paint._values["line-floorwidth"]=xo.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new sa(r)},t.prototype.queryRadius=function(r){var s=r,d=ru(Il("line-width",this,s),Il("line-gap-width",this,s)),E=Il("line-offset",this,s);return d/2+Math.abs(E)+Bs(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,s,d,E,I,G,se){var be=pc(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),G.angle,se),we=se/2*ru(this.paint.get("line-width").evaluate(s,d),this.paint.get("line-gap-width").evaluate(s,d)),Ze=this.paint.get("line-offset").evaluate(s,d);return Ze&&(E=function(ot,bt){for(var Qt=[],tr=new D(0,0),br=0;br<ot.length;br++){for(var cr=ot[br],Zr=[],Yr=0;Yr<cr.length;Yr++){var ln=cr[Yr],vn=cr[Yr+1],Ln=Yr===0?tr:ln.sub(cr[Yr-1])._unit()._perp(),oi=Yr===cr.length-1?tr:vn.sub(ln)._unit()._perp(),wi=Ln._add(oi)._unit();wi._mult(1/(wi.x*oi.x+wi.y*oi.y)),Zr.push(wi._mult(bt)._add(ln))}Qt.push(Zr)}return Qt}(E,Ze*se)),function(ot,bt,Qt){for(var tr=0;tr<bt.length;tr++){var br=bt[tr];if(ot.length>=3){for(var cr=0;cr<br.length;cr++)if(Us(ot,br[cr]))return!0}if(Fs(ot,br,Qt))return!0}return!1}(be,E,we)},t.prototype.isTileClipped=function(){return!0},t}(Pl);function ru(e,t){return t>0?t+2*e:e}var Rc=fs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mc=fs([{name:"a_projected_pos",components:3,type:"Float32"}],4),vl=(fs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),fs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Jf=(fs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),fs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Vh=fs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Lh(e,t,r){return e.sections.forEach(function(s){s.text=function(d,E,I){var G=E.layout.get("text-transform").evaluate(I,{});return G==="uppercase"?d=d.toLocaleUpperCase():G==="lowercase"&&(d=d.toLocaleLowerCase()),pl.applyArabicShaping&&(d=pl.applyArabicShaping(d)),d}(s.text,t,r)}),e}fs([{name:"triangle",components:3,type:"Uint16"}]),fs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),fs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),fs([{type:"Float32",name:"offsetX"}]),fs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var fh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},eh=function(e,t,r,s,d){var E,I,G=8*d-s-1,se=(1<<G)-1,be=se>>1,we=-7,Ze=r?d-1:0,ot=r?-1:1,bt=e[t+Ze];for(Ze+=ot,E=bt&(1<<-we)-1,bt>>=-we,we+=G;we>0;E=256*E+e[t+Ze],Ze+=ot,we-=8);for(I=E&(1<<-we)-1,E>>=-we,we+=s;we>0;I=256*I+e[t+Ze],Ze+=ot,we-=8);if(E===0)E=1-be;else{if(E===se)return I?NaN:1/0*(bt?-1:1);I+=Math.pow(2,s),E-=be}return(bt?-1:1)*I*Math.pow(2,E-s)},Eh=function(e,t,r,s,d,E){var I,G,se,be=8*E-d-1,we=(1<<be)-1,Ze=we>>1,ot=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,bt=s?0:E-1,Qt=s?1:-1,tr=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(G=isNaN(t)?1:0,I=we):(I=Math.floor(Math.log(t)/Math.LN2),t*(se=Math.pow(2,-I))<1&&(I--,se*=2),(t+=I+Ze>=1?ot/se:ot*Math.pow(2,1-Ze))*se>=2&&(I++,se/=2),I+Ze>=we?(G=0,I=we):I+Ze>=1?(G=(t*se-1)*Math.pow(2,d),I+=Ze):(G=t*Math.pow(2,Ze-1)*Math.pow(2,d),I=0));d>=8;e[r+bt]=255&G,bt+=Qt,G/=256,d-=8);for(I=I<<d|G,be+=d;be>0;e[r+bt]=255&I,bt+=Qt,I/=256,be-=8);e[r+bt-Qt]|=128*tr},Ns=ki;function ki(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}ki.Varint=0,ki.Fixed64=1,ki.Bytes=2,ki.Fixed32=5;var Oh=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Dc(e){return e.type===ki.Bytes?e.readVarint()+e.pos:e.pos+1}function Ys(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function gc(e,t,r){var s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(s);for(var d=r.pos-1;d>=e;d--)r.buf[d+s]=r.buf[d]}function Hh(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function ge(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Lt(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function sr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function an(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Pn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function rn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function yn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function In(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function jn(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Kn(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function ti(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function ii(e,t,r){e===1&&r.readMessage(Ei,t)}function Ei(e,t,r){if(e===3){var s=r.readMessage(Xn,{}),d=s.width,E=s.height,I=s.left,G=s.top,se=s.advance;t.push({id:s.id,bitmap:new Oc({width:d+6,height:E+6},s.bitmap),metrics:{width:d,height:E,left:I,top:G,advance:se}})}}function Xn(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function ai(e){for(var t=0,r=0,s=0,d=e;s<d.length;s+=1){var E=d[s];t+=E.w*E.h,r=Math.max(r,E.w)}e.sort(function(tr,br){return br.h-tr.h});for(var I=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],G=0,se=0,be=0,we=e;be<we.length;be+=1)for(var Ze=we[be],ot=I.length-1;ot>=0;ot--){var bt=I[ot];if(!(Ze.w>bt.w||Ze.h>bt.h)){if(Ze.x=bt.x,Ze.y=bt.y,se=Math.max(se,Ze.y+Ze.h),G=Math.max(G,Ze.x+Ze.w),Ze.w===bt.w&&Ze.h===bt.h){var Qt=I.pop();ot<I.length&&(I[ot]=Qt)}else Ze.h===bt.h?(bt.x+=Ze.w,bt.w-=Ze.w):Ze.w===bt.w?(bt.y+=Ze.h,bt.h-=Ze.h):(I.push({x:bt.x+Ze.w,y:bt.y,w:bt.w-Ze.w,h:Ze.h}),bt.y+=Ze.h,bt.h-=Ze.h);break}}return{w:G,h:se,fill:t/(G*se)||0}}ki.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),d=s>>3,E=this.pos;this.type=7&s,e(d,t,this),this.pos===E&&this.skip(s)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=jn(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=ti(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=jn(this.buf,this.pos)+4294967296*jn(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=jn(this.buf,this.pos)+4294967296*ti(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=eh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=eh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,s=this.buf;return t=127&(r=s[this.pos++]),r<128?t:(t|=(127&(r=s[this.pos++]))<<7,r<128?t:(t|=(127&(r=s[this.pos++]))<<14,r<128?t:(t|=(127&(r=s[this.pos++]))<<21,r<128?t:function(d,E,I){var G,se,be=I.buf;if(G=(112&(se=be[I.pos++]))>>4,se<128||(G|=(127&(se=be[I.pos++]))<<3,se<128)||(G|=(127&(se=be[I.pos++]))<<10,se<128)||(G|=(127&(se=be[I.pos++]))<<17,se<128)||(G|=(127&(se=be[I.pos++]))<<24,se<128)||(G|=(1&(se=be[I.pos++]))<<31,se<128))return Ys(d,G,E);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=s[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Oh?function(r,s,d){return Oh.decode(r.subarray(s,d))}(this.buf,t,e):function(r,s,d){for(var E="",I=s;I<d;){var G,se,be,we=r[I],Ze=null,ot=we>239?4:we>223?3:we>191?2:1;if(I+ot>d)break;ot===1?we<128&&(Ze=we):ot===2?(192&(G=r[I+1]))==128&&(Ze=(31&we)<<6|63&G)<=127&&(Ze=null):ot===3?(se=r[I+2],(192&(G=r[I+1]))==128&&(192&se)==128&&((Ze=(15&we)<<12|(63&G)<<6|63&se)<=2047||Ze>=55296&&Ze<=57343)&&(Ze=null)):ot===4&&(se=r[I+2],be=r[I+3],(192&(G=r[I+1]))==128&&(192&se)==128&&(192&be)==128&&((Ze=(15&we)<<18|(63&G)<<12|(63&se)<<6|63&be)<=65535||Ze>=1114112)&&(Ze=null)),Ze===null?(Ze=65533,ot=1):Ze>65535&&(Ze-=65536,E+=String.fromCharCode(Ze>>>10&1023|55296),Ze=56320|1023&Ze),E+=String.fromCharCode(Ze),I+=ot}return E}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==ki.Bytes)return e.push(this.readVarint(t));var r=Dc(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==ki.Bytes)return e.push(this.readSVarint());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==ki.Bytes)return e.push(this.readBoolean());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==ki.Bytes)return e.push(this.readFloat());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==ki.Bytes)return e.push(this.readDouble());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==ki.Bytes)return e.push(this.readFixed32());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==ki.Bytes)return e.push(this.readSFixed32());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==ki.Bytes)return e.push(this.readFixed64());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==ki.Bytes)return e.push(this.readSFixed64());var t=Dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===ki.Varint)for(;this.buf[this.pos++]>127;);else if(t===ki.Bytes)this.pos=this.readVarint()+this.pos;else if(t===ki.Fixed32)this.pos+=4;else{if(t!==ki.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Kn(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Kn(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Kn(this.buf,-1&e,this.pos),Kn(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Kn(this.buf,-1&e,this.pos),Kn(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var s,d;if(t>=0?(s=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(s=~(-t%4294967296))?s=s+1|0:(s=0,d=d+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(E,I,G){G.buf[G.pos++]=127&E|128,E>>>=7,G.buf[G.pos++]=127&E|128,E>>>=7,G.buf[G.pos++]=127&E|128,E>>>=7,G.buf[G.pos++]=127&E|128,G.buf[G.pos]=127&(E>>>=7)}(s,0,r),function(E,I){var G=(7&E)<<4;I.buf[I.pos++]|=G|((E>>>=3)?128:0),E&&(I.buf[I.pos++]=127&E|((E>>>=7)?128:0),E&&(I.buf[I.pos++]=127&E|((E>>>=7)?128:0),E&&(I.buf[I.pos++]=127&E|((E>>>=7)?128:0),E&&(I.buf[I.pos++]=127&E|((E>>>=7)?128:0),E&&(I.buf[I.pos++]=127&E)))))}(d,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(s,d,E){for(var I,G,se=0;se<d.length;se++){if((I=d.charCodeAt(se))>55295&&I<57344){if(!G){I>56319||se+1===d.length?(s[E++]=239,s[E++]=191,s[E++]=189):G=I;continue}if(I<56320){s[E++]=239,s[E++]=191,s[E++]=189,G=I;continue}I=G-55296<<10|I-56320|65536,G=null}else G&&(s[E++]=239,s[E++]=191,s[E++]=189,G=null);I<128?s[E++]=I:(I<2048?s[E++]=I>>6|192:(I<65536?s[E++]=I>>12|224:(s[E++]=I>>18|240,s[E++]=I>>12&63|128),s[E++]=I>>6&63|128),s[E++]=63&I|128)}return E}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&gc(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Eh(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Eh(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var s=this.pos-r;s>=128&&gc(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(e,t,r){this.writeTag(e,ki.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Hh,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,ge,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,an,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Lt,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,sr,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Pn,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,rn,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,yn,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,In,t)},writeBytesField:function(e,t){this.writeTag(e,ki.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,ki.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,ki.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,ki.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,ki.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,ki.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,ki.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,ki.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,ki.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,ki.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Vr=function(e,t){var r=t.pixelRatio,s=t.version,d=t.stretchX,E=t.stretchY,I=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=d,this.stretchY=E,this.content=I,this.version=s},dn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};dn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},dn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},dn.tlbr.get=function(){return this.tl.concat(this.br)},dn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Vr.prototype,dn);var ri=function(e,t){var r={},s={};this.haveRenderCallbacks=[];var d=[];this.addImages(e,r,d),this.addImages(t,s,d);var E=ai(d),I=new hu({width:E.w||1,height:E.h||1});for(var G in e){var se=e[G],be=r[G].paddedRect;hu.copy(se.data,I,{x:0,y:0},{x:be.x+1,y:be.y+1},se.data)}for(var we in t){var Ze=t[we],ot=s[we].paddedRect,bt=ot.x+1,Qt=ot.y+1,tr=Ze.data.width,br=Ze.data.height;hu.copy(Ze.data,I,{x:0,y:0},{x:bt,y:Qt},Ze.data),hu.copy(Ze.data,I,{x:0,y:br-1},{x:bt,y:Qt-1},{width:tr,height:1}),hu.copy(Ze.data,I,{x:0,y:0},{x:bt,y:Qt+br},{width:tr,height:1}),hu.copy(Ze.data,I,{x:tr-1,y:0},{x:bt-1,y:Qt},{width:1,height:br}),hu.copy(Ze.data,I,{x:0,y:0},{x:bt+tr,y:Qt},{width:1,height:br})}this.image=I,this.iconPositions=r,this.patternPositions=s};ri.prototype.addImages=function(e,t,r){for(var s in e){var d=e[s],E={x:0,y:0,w:d.data.width+2,h:d.data.height+2};r.push(E),t[s]=new Vr(E,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(s)}},ri.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},ri.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var s=e.tl;r.update(t.data,void 0,{x:s[0],y:s[1]})}},zi("ImagePosition",Vr),zi("ImageAtlas",ri);var xi={horizontal:1,vertical:2,horizontalOnly:3},Nn=function(){this.scale=1,this.fontStack="",this.imageName=null};Nn.forText=function(e,t){var r=new Nn;return r.scale=e||1,r.fontStack=t,r},Nn.forImage=function(e){var t=new Nn;return t.imageName=e,t};var fi=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Li(e,t,r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr){var br,cr=fi.fromFeature(e,d);Ze===xi.vertical&&cr.verticalizePunctuation();var Zr=pl.processBidirectionalText,Yr=pl.processStyledBidirectionalText;if(Zr&&cr.sections.length===1){br=[];for(var ln=0,vn=Zr(cr.toString(),Oi(cr,be,E,t,s,bt,Qt));ln<vn.length;ln+=1){var Ln=vn[ln],oi=new fi;oi.text=Ln,oi.sections=cr.sections;for(var wi=0;wi<Ln.length;wi++)oi.sectionIndex.push(0);br.push(oi)}}else if(Yr){br=[];for(var va=0,Fi=Yr(cr.text,cr.sectionIndex,Oi(cr,be,E,t,s,bt,Qt));va<Fi.length;va+=1){var Ca=Fi[va],Ni=new fi;Ni.text=Ca[0],Ni.sectionIndex=Ca[1],Ni.sections=cr.sections,br.push(Ni)}}else br=function(Wi,jo){for(var Eo=[],Qo=Wi.text,Ra=0,vs=0,Is=jo;vs<Is.length;vs+=1){var lu=Is[vs];Eo.push(Wi.substring(Ra,lu)),Ra=lu}return Ra<Qo.length&&Eo.push(Wi.substring(Ra,Qo.length)),Eo}(cr,Oi(cr,be,E,t,s,bt,Qt));var Oo=[],$a={positionedLines:Oo,text:cr.toString(),top:we[1],bottom:we[1],left:we[0],right:we[0],writingMode:Ze,iconsInText:!1,verticalizable:!1};return function(Wi,jo,Eo,Qo,Ra,vs,Is,lu,pu,cu,xu,ul){for(var Wu=0,gl=-17,Xu=0,_c=0,zu=lu==="right"?1:lu==="left"?0:.5,Bl=0,Go=0,Zs=Ra;Go<Zs.length;Go+=1){var Wo=Zs[Go];Wo.trim();var Jo=Wo.getMaxScale(),kc=24*(Jo-1),Nl={positionedGlyphs:[],lineOffset:0};Wi.positionedLines[Bl]=Nl;var js=Nl.positionedGlyphs,Pu=0;if(Wo.length()){for(var xc=0;xc<Wo.length();xc++){var hs=Wo.getSection(xc),hh=Wo.getSectionIndex(xc),Af=Wo.getCharCode(xc),th=0,Lu=null,ph=null,Tf=null,Yh=24,Zh=!(pu===xi.horizontal||!xu&&!$f(Af)||xu&&(ga[Af]||(Th=Af,_i.Arabic(Th)||_i["Arabic Supplement"](Th)||_i["Arabic Extended-A"](Th)||_i["Arabic Presentation Forms-A"](Th)||_i["Arabic Presentation Forms-B"](Th))));if(hs.imageName){var $h=Qo[hs.imageName];if(!$h)continue;Tf=hs.imageName,Wi.iconsInText=Wi.iconsInText||!0,ph=$h.paddedRect;var Ah=$h.displaySize;hs.scale=24*hs.scale/ul,th=kc+(24-Ah[1]*hs.scale),Yh=(Lu={width:Ah[0],height:Ah[1],left:1,top:-3,advance:Zh?Ah[1]:Ah[0]}).advance;var np=Zh?Ah[0]*hs.scale-24*Jo:Ah[1]*hs.scale-24*Jo;np>0&&np>Pu&&(Pu=np)}else{var ip=Eo[hs.fontStack],Kh=ip&&ip[Af];if(Kh&&Kh.rect)ph=Kh.rect,Lu=Kh.metrics;else{var ap=jo[hs.fontStack],_p=ap&&ap[Af];if(!_p)continue;Lu=_p.metrics}th=24*(Jo-hs.scale)}Zh?(Wi.verticalizable=!0,js.push({glyph:Af,imageName:Tf,x:Wu,y:gl+th,vertical:Zh,scale:hs.scale,fontStack:hs.fontStack,sectionIndex:hh,metrics:Lu,rect:ph}),Wu+=Yh*hs.scale+cu):(js.push({glyph:Af,imageName:Tf,x:Wu,y:gl+th,vertical:Zh,scale:hs.scale,fontStack:hs.fontStack,sectionIndex:hh,metrics:Lu,rect:ph}),Wu+=Lu.advance*hs.scale+cu)}js.length!==0&&(Xu=Math.max(Wu-cu,Xu),no(js,0,js.length-1,zu,Pu)),Wu=0;var xp=vs*Jo+Pu;Nl.lineOffset=Math.max(Pu,kc),gl+=xp,_c=Math.max(xp,_c),++Bl}else gl+=vs,++Bl}var Th,bp=gl- -17,jh=Ri(Is),Dh=jh.horizontalAlign,qh=jh.verticalAlign;(function(Ep,kh,op,sp,wh,Cp,Qh,Sp,Ap){var up,lp=(kh-op)*wh;up=Cp!==Qh?-Sp*sp- -17:(-sp*Ap+.5)*Qh;for(var Jh=0,cp=Ep;Jh<cp.length;Jh+=1)for(var Fh=0,ep=cp[Jh].positionedGlyphs;Fh<ep.length;Fh+=1){var fp=ep[Fh];fp.x+=lp,fp.y+=up}})(Wi.positionedLines,zu,Dh,qh,Xu,_c,vs,bp,Ra.length),Wi.top+=-qh*bp,Wi.bottom=Wi.top+bp,Wi.left+=-Dh*Xu,Wi.right=Wi.left+Xu}($a,t,r,s,br,I,G,se,Ze,be,ot,tr),!function(Wi){for(var jo=0,Eo=Wi;jo<Eo.length;jo+=1)if(Eo[jo].positionedGlyphs.length!==0)return!1;return!0}(Oo)&&$a}fi.fromFeature=function(e,t){for(var r=new fi,s=0;s<e.sections.length;s++){var d=e.sections[s];d.image?r.addImageSection(d):r.addTextSection(d,t)}return r},fi.prototype.length=function(){return this.text.length},fi.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},fi.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},fi.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},fi.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var s=e.charCodeAt(r+1)||null,d=e.charCodeAt(r-1)||null;t+=s&&Al(s)&&!fh[e[r+1]]||d&&Al(d)&&!fh[e[r-1]]||!fh[e[r]]?e[r]:fh[e[r]]}return t}(this.text)},fi.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&ga[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,s=this.text.length-1;s>=0&&s>=e&&ga[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},fi.prototype.substring=function(e,t){var r=new fi;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},fi.prototype.toString=function(){return this.text},fi.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},fi.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(Nn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,s=0;s<e.text.length;++s)this.sectionIndex.push(r)},fi.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(Nn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Ce("Reached maximum number of images 6401")}else Ce("Can't add FormattedSection with an empty image.")},fi.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ga={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Cn={};function Mn(e,t,r,s,d,E){if(t.imageName){var I=s[t.imageName];return I?I.displaySize[0]*t.scale*24/E+d:0}var G=r[t.fontStack],se=G&&G[e];return se?se.metrics.advance*t.scale+d:0}function Ki(e,t,r,s){var d=Math.pow(e-t,2);return s?e<t?d/2:2*d:d+Math.abs(r)*r}function Ti(e,t,r){var s=0;return e===10&&(s-=1e4),r&&(s+=150),e!==40&&e!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function qn(e,t,r,s,d,E){for(var I=null,G=Ki(t,r,d,E),se=0,be=s;se<be.length;se+=1){var we=be[se],Ze=Ki(t-we.x,r,d,E)+we.badness;Ze<=G&&(I=we,G=Ze)}return{index:e,x:t,priorBreak:I,badness:G}}function Oi(e,t,r,s,d,E,I){if(E!=="point")return[];if(!e)return[];for(var G,se=[],be=function(br,cr,Zr,Yr,ln,vn){for(var Ln=0,oi=0;oi<br.length();oi++){var wi=br.getSection(oi);Ln+=Mn(br.getCharCode(oi),wi,Yr,ln,cr,vn)}return Ln/Math.max(1,Math.ceil(Ln/Zr))}(e,t,r,s,d,I),we=e.text.indexOf("\u200B")>=0,Ze=0,ot=0;ot<e.length();ot++){var bt=e.getSection(ot),Qt=e.getCharCode(ot);if(ga[Qt]||(Ze+=Mn(Qt,bt,s,d,t,I)),ot<e.length()-1){var tr=!((G=Qt)<11904||!(_i["Bopomofo Extended"](G)||_i.Bopomofo(G)||_i["CJK Compatibility Forms"](G)||_i["CJK Compatibility Ideographs"](G)||_i["CJK Compatibility"](G)||_i["CJK Radicals Supplement"](G)||_i["CJK Strokes"](G)||_i["CJK Symbols and Punctuation"](G)||_i["CJK Unified Ideographs Extension A"](G)||_i["CJK Unified Ideographs"](G)||_i["Enclosed CJK Letters and Months"](G)||_i["Halfwidth and Fullwidth Forms"](G)||_i.Hiragana(G)||_i["Ideographic Description Characters"](G)||_i["Kangxi Radicals"](G)||_i["Katakana Phonetic Extensions"](G)||_i.Katakana(G)||_i["Vertical Forms"](G)||_i["Yi Radicals"](G)||_i["Yi Syllables"](G)));(Cn[Qt]||tr||bt.imageName)&&se.push(qn(ot+1,Ze,be,se,Ti(Qt,e.getCharCode(ot+1),tr&&we),!1))}}return function br(cr){return cr?br(cr.priorBreak).concat(cr.index):[]}(qn(e.length(),Ze,be,se,0,!0))}function Ri(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function no(e,t,r,s,d){if(s||d)for(var E=e[r],I=(e[r].x+E.metrics.advance*E.scale)*s,G=t;G<=r;G++)e[G].x-=I,e[G].y+=d}function io(e,t,r,s,d,E){var I,G=e.image;if(G.content){var se=G.content,be=G.pixelRatio||1;I=[se[0]/be,se[1]/be,G.displaySize[0]-se[2]/be,G.displaySize[1]-se[3]/be]}var we,Ze,ot,bt,Qt=t.left*E,tr=t.right*E;r==="width"||r==="both"?(bt=d[0]+Qt-s[3],Ze=d[0]+tr+s[1]):Ze=(bt=d[0]+(Qt+tr-G.displaySize[0])/2)+G.displaySize[0];var br=t.top*E,cr=t.bottom*E;return r==="height"||r==="both"?(we=d[1]+br-s[0],ot=d[1]+cr+s[2]):ot=(we=d[1]+(br+cr-G.displaySize[1])/2)+G.displaySize[1],{image:G,top:we,right:Ze,bottom:ot,left:bt,collisionPadding:I}}Cn[10]=!0,Cn[32]=!0,Cn[38]=!0,Cn[40]=!0,Cn[41]=!0,Cn[43]=!0,Cn[45]=!0,Cn[47]=!0,Cn[173]=!0,Cn[183]=!0,Cn[8203]=!0,Cn[8208]=!0,Cn[8211]=!0,Cn[8231]=!0;var Ii=function(e){function t(r,s,d,E){e.call(this,r,s),this.angle=d,E!==void 0&&(this.segment=E)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(D);function Di(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new fo(e+1))};if(r.kind==="source")return{kind:"source"};for(var s=r.zoomStops,d=r.interpolationType,E=0;E<s.length&&s[E]<=e;)E++;for(var I=E=Math.max(0,E-1);I<s.length&&s[I]<e+1;)I++;I=Math.min(s.length-1,I);var G=s[E],se=s[I];return r.kind==="composite"?{kind:"composite",minZoom:G,maxZoom:se,interpolationType:d}:{kind:"camera",minZoom:G,maxZoom:se,minSize:r.evaluate(new fo(G)),maxSize:r.evaluate(new fo(se)),interpolationType:d}}function Xa(e,t,r){var s=t.uSize,d=r.lowerSize;return e.kind==="source"?d/128:e.kind==="composite"?ci(d/128,r.upperSize/128,t.uSizeT):s}function lo(e,t){var r=0,s=0;if(e.kind==="constant")s=e.layoutSize;else if(e.kind!=="source"){var d=e.interpolationType,E=d?ce(Pt.interpolationFactor(d,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?s=ci(e.minSize,e.maxSize,E):r=E}return{uSizeT:r,uSize:s}}zi("Anchor",Ii);var bo=Object.freeze({__proto__:null,getSizeData:Di,evaluateSizeForFeature:Xa,evaluateSizeForZoom:lo,SIZE_PACK_FACTOR:128});function nu(e,t,r,s,d){if(t.segment===void 0)return!0;for(var E=t,I=t.segment+1,G=0;G>-r/2;){if(--I<0)return!1;G-=e[I].dist(E),E=e[I]}G+=e[I].dist(e[I+1]),I++;for(var se=[],be=0;G<r/2;){var we=e[I],Ze=e[I+1];if(!Ze)return!1;var ot=e[I-1].angleTo(we)-we.angleTo(Ze);for(ot=Math.abs((ot+3*Math.PI)%(2*Math.PI)-Math.PI),se.push({distance:G,angleDelta:ot}),be+=ot;G-se[0].distance>s;)be-=se.shift().angleDelta;if(be>d)return!1;I++,G+=we.dist(Ze)}return!0}function $s(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Lo(e,t,r){return e?.6*t*r:0}function ml(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function bs(e,t,r,s,d,E){for(var I=Lo(r,d,E),G=ml(r,s)*E,se=0,be=$s(e)/2,we=0;we<e.length-1;we++){var Ze=e[we],ot=e[we+1],bt=Ze.dist(ot);if(se+bt>be){var Qt=(be-se)/bt,tr=ci(Ze.x,ot.x,Qt),br=ci(Ze.y,ot.y,Qt),cr=new Ii(tr,br,ot.angleTo(Ze),we);return cr._round(),!I||nu(e,cr,G,I,t)?cr:void 0}se+=bt}}function nl(e,t,r,s,d,E,I,G,se){var be=Lo(s,E,I),we=ml(s,d),Ze=we*I,ot=e[0].x===0||e[0].x===se||e[0].y===0||e[0].y===se;return t-Ze<t/4&&(t=Ze+t/4),function bt(Qt,tr,br,cr,Zr,Yr,ln,vn,Ln){for(var oi=Yr/2,wi=$s(Qt),va=0,Fi=tr-br,Ca=[],Ni=0;Ni<Qt.length-1;Ni++){for(var Oo=Qt[Ni],$a=Qt[Ni+1],Wi=Oo.dist($a),jo=$a.angleTo(Oo);Fi+br<va+Wi;){var Eo=((Fi+=br)-va)/Wi,Qo=ci(Oo.x,$a.x,Eo),Ra=ci(Oo.y,$a.y,Eo);if(Qo>=0&&Qo<Ln&&Ra>=0&&Ra<Ln&&Fi-oi>=0&&Fi+oi<=wi){var vs=new Ii(Qo,Ra,jo,Ni);vs._round(),cr&&!nu(Qt,vs,Yr,cr,Zr)||Ca.push(vs)}}va+=Wi}return vn||Ca.length||ln||(Ca=bt(Qt,va/2,br,cr,Zr,Yr,ln,!0,Ln)),Ca}(e,ot?t/2*G%t:(we/2+2*E)*I*G%t,t,be,r,Ze,ot,!1,se)}function Mu(e,t,r,s,d){for(var E=[],I=0;I<e.length;I++)for(var G=e[I],se=void 0,be=0;be<G.length-1;be++){var we=G[be],Ze=G[be+1];we.x<t&&Ze.x<t||(we.x<t?we=new D(t,we.y+(t-we.x)/(Ze.x-we.x)*(Ze.y-we.y))._round():Ze.x<t&&(Ze=new D(t,we.y+(t-we.x)/(Ze.x-we.x)*(Ze.y-we.y))._round()),we.y<r&&Ze.y<r||(we.y<r?we=new D(we.x+(r-we.y)/(Ze.y-we.y)*(Ze.x-we.x),r)._round():Ze.y<r&&(Ze=new D(we.x+(r-we.y)/(Ze.y-we.y)*(Ze.x-we.x),r)._round()),we.x>=s&&Ze.x>=s||(we.x>=s?we=new D(s,we.y+(s-we.x)/(Ze.x-we.x)*(Ze.y-we.y))._round():Ze.x>=s&&(Ze=new D(s,we.y+(s-we.x)/(Ze.x-we.x)*(Ze.y-we.y))._round()),we.y>=d&&Ze.y>=d||(we.y>=d?we=new D(we.x+(d-we.y)/(Ze.y-we.y)*(Ze.x-we.x),d)._round():Ze.y>=d&&(Ze=new D(we.x+(d-we.y)/(Ze.y-we.y)*(Ze.x-we.x),d)._round()),se&&we.equals(se[se.length-1])||E.push(se=[we]),se.push(Ze)))))}return E}function il(e,t,r,s){var d=[],E=e.image,I=E.pixelRatio,G=E.paddedRect.w-2,se=E.paddedRect.h-2,be=e.right-e.left,we=e.bottom-e.top,Ze=E.stretchX||[[0,G]],ot=E.stretchY||[[0,se]],bt=function(Qo,Ra){return Qo+Ra[1]-Ra[0]},Qt=Ze.reduce(bt,0),tr=ot.reduce(bt,0),br=G-Qt,cr=se-tr,Zr=0,Yr=Qt,ln=0,vn=tr,Ln=0,oi=br,wi=0,va=cr;if(E.content&&s){var Fi=E.content;Zr=al(Ze,0,Fi[0]),ln=al(ot,0,Fi[1]),Yr=al(Ze,Fi[0],Fi[2]),vn=al(ot,Fi[1],Fi[3]),Ln=Fi[0]-Zr,wi=Fi[1]-ln,oi=Fi[2]-Fi[0]-Yr,va=Fi[3]-Fi[1]-vn}var Ca=function(Qo,Ra,vs,Is){var lu=_u(Qo.stretch-Zr,Yr,be,e.left),pu=ho(Qo.fixed-Ln,oi,Qo.stretch,Qt),cu=_u(Ra.stretch-ln,vn,we,e.top),xu=ho(Ra.fixed-wi,va,Ra.stretch,tr),ul=_u(vs.stretch-Zr,Yr,be,e.left),Wu=ho(vs.fixed-Ln,oi,vs.stretch,Qt),gl=_u(Is.stretch-ln,vn,we,e.top),Xu=ho(Is.fixed-wi,va,Is.stretch,tr),_c=new D(lu,cu),zu=new D(ul,cu),Bl=new D(ul,gl),Go=new D(lu,gl),Zs=new D(pu/I,xu/I),Wo=new D(Wu/I,Xu/I),Jo=t*Math.PI/180;if(Jo){var kc=Math.sin(Jo),Nl=Math.cos(Jo),js=[Nl,-kc,kc,Nl];_c._matMult(js),zu._matMult(js),Go._matMult(js),Bl._matMult(js)}var Pu=Qo.stretch+Qo.fixed,xc=Ra.stretch+Ra.fixed;return{tl:_c,tr:zu,bl:Go,br:Bl,tex:{x:E.paddedRect.x+1+Pu,y:E.paddedRect.y+1+xc,w:vs.stretch+vs.fixed-Pu,h:Is.stretch+Is.fixed-xc},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Zs,pixelOffsetBR:Wo,minFontScaleX:oi/I/be,minFontScaleY:va/I/we,isSDF:r}};if(s&&(E.stretchX||E.stretchY))for(var Ni=kl(Ze,br,Qt),Oo=kl(ot,cr,tr),$a=0;$a<Ni.length-1;$a++)for(var Wi=Ni[$a],jo=Ni[$a+1],Eo=0;Eo<Oo.length-1;Eo++)d.push(Ca(Wi,Oo[Eo],jo,Oo[Eo+1]));else d.push(Ca({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:G+1},{fixed:0,stretch:se+1}));return d}function al(e,t,r){for(var s=0,d=0,E=e;d<E.length;d+=1){var I=E[d];s+=Math.max(t,Math.min(r,I[1]))-Math.max(t,Math.min(r,I[0]))}return s}function kl(e,t,r){for(var s=[{fixed:-1,stretch:0}],d=0,E=e;d<E.length;d+=1){var I=E[d],G=I[0],se=I[1],be=s[s.length-1];s.push({fixed:G-be.stretch,stretch:be.stretch}),s.push({fixed:G-be.stretch,stretch:be.stretch+(se-G)})}return s.push({fixed:t+1,stretch:r}),s}function _u(e,t,r,s){return e/t*r+s}function ho(e,t,r,s){return e-t*r/s}var Bu=function(e,t,r,s,d,E,I,G,se,be){if(this.boxStartIndex=e.length,se){var we=E.top,Ze=E.bottom,ot=E.collisionPadding;ot&&(we-=ot[1],Ze+=ot[3]);var bt=Ze-we;bt>0&&(bt=Math.max(10,bt),this.circleDiameter=bt)}else{var Qt=E.top*I-G,tr=E.bottom*I+G,br=E.left*I-G,cr=E.right*I+G,Zr=E.collisionPadding;if(Zr&&(br-=Zr[0]*I,Qt-=Zr[1]*I,cr+=Zr[2]*I,tr+=Zr[3]*I),be){var Yr=new D(br,Qt),ln=new D(cr,Qt),vn=new D(br,tr),Ln=new D(cr,tr),oi=be*Math.PI/180;Yr._rotate(oi),ln._rotate(oi),vn._rotate(oi),Ln._rotate(oi),br=Math.min(Yr.x,ln.x,vn.x,Ln.x),cr=Math.max(Yr.x,ln.x,vn.x,Ln.x),Qt=Math.min(Yr.y,ln.y,vn.y,Ln.y),tr=Math.max(Yr.y,ln.y,vn.y,Ln.y)}e.emplaceBack(t.x,t.y,br,Qt,cr,tr,r,s,d)}this.boxEndIndex=e.length},is=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Nu),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Nu(e,t){return e<t?-1:e>t?1:0}function Za(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var s=1/0,d=1/0,E=-1/0,I=-1/0,G=e[0],se=0;se<G.length;se++){var be=G[se];(!se||be.x<s)&&(s=be.x),(!se||be.y<d)&&(d=be.y),(!se||be.x>E)&&(E=be.x),(!se||be.y>I)&&(I=be.y)}var we=Math.min(E-s,I-d),Ze=we/2,ot=new is([],Zo);if(we===0)return new D(s,d);for(var bt=s;bt<E;bt+=we)for(var Qt=d;Qt<I;Qt+=we)ot.push(new as(bt+Ze,Qt+Ze,Ze,e));for(var tr=function(Zr){for(var Yr=0,ln=0,vn=0,Ln=Zr[0],oi=0,wi=Ln.length,va=wi-1;oi<wi;va=oi++){var Fi=Ln[oi],Ca=Ln[va],Ni=Fi.x*Ca.y-Ca.x*Fi.y;ln+=(Fi.x+Ca.x)*Ni,vn+=(Fi.y+Ca.y)*Ni,Yr+=3*Ni}return new as(ln/Yr,vn/Yr,0,Zr)}(e),br=ot.length;ot.length;){var cr=ot.pop();(cr.d>tr.d||!tr.d)&&(tr=cr,r&&console.log("found best %d after %d probes",Math.round(1e4*cr.d)/1e4,br)),cr.max-tr.d<=t||(ot.push(new as(cr.p.x-(Ze=cr.h/2),cr.p.y-Ze,Ze,e)),ot.push(new as(cr.p.x+Ze,cr.p.y-Ze,Ze,e)),ot.push(new as(cr.p.x-Ze,cr.p.y+Ze,Ze,e)),ot.push(new as(cr.p.x+Ze,cr.p.y+Ze,Ze,e)),br+=4)}return r&&(console.log("num probes: "+br),console.log("best distance: "+tr.d)),tr.p}function Zo(e,t){return t.max-e.max}function as(e,t,r,s){this.p=new D(e,t),this.h=r,this.d=function(d,E){for(var I=!1,G=1/0,se=0;se<E.length;se++)for(var be=E[se],we=0,Ze=be.length,ot=Ze-1;we<Ze;ot=we++){var bt=be[we],Qt=be[ot];bt.y>d.y!=Qt.y>d.y&&d.x<(Qt.x-bt.x)*(d.y-bt.y)/(Qt.y-bt.y)+bt.x&&(I=!I),G=Math.min(G,wc(d,bt,Qt))}return(I?1:-1)*Math.sqrt(G)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}is.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},is.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},is.prototype.peek=function(){return this.data[0]},is.prototype._up=function(e){for(var t=this.data,r=this.compare,s=t[e];e>0;){var d=e-1>>1,E=t[d];if(r(s,E)>=0)break;t[e]=E,e=d}t[e]=s},is.prototype._down=function(e){for(var t=this.data,r=this.compare,s=this.length>>1,d=t[e];e<s;){var E=1+(e<<1),I=t[E],G=E+1;if(G<this.length&&r(t[G],I)<0&&(E=G,I=t[G]),r(I,d)>=0)break;t[e]=I,e=E}t[e]=d};var Os=Number.POSITIVE_INFINITY;function Ks(e,t){return t[1]!==Os?function(r,s,d){var E=0,I=0;switch(s=Math.abs(s),d=Math.abs(d),r){case"top-right":case"top-left":case"top":I=d-7;break;case"bottom-right":case"bottom-left":case"bottom":I=7-d}switch(r){case"top-right":case"bottom-right":case"right":E=-s;break;case"top-left":case"bottom-left":case"left":E=s}return[E,I]}(e,t[0],t[1]):function(r,s){var d=0,E=0;s<0&&(s=0);var I=s/Math.sqrt(2);switch(r){case"top-right":case"top-left":E=I-7;break;case"bottom-right":case"bottom-left":E=7-I;break;case"bottom":E=7-s;break;case"top":E=s-7}switch(r){case"top-right":case"bottom-right":d=-I;break;case"top-left":case"bottom-left":d=I;break;case"left":d=s;break;case"right":d=-s}return[d,E]}(e,t[0])}function $t(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function sn(e,t,r,s,d,E,I,G,se,be,we,Ze,ot,bt,Qt){var tr=function(ln,vn,Ln,oi,wi,va,Fi,Ca){for(var Ni=oi.layout.get("text-rotate").evaluate(va,{})*Math.PI/180,Oo=[],$a=0,Wi=vn.positionedLines;$a<Wi.length;$a+=1)for(var jo=Wi[$a],Eo=0,Qo=jo.positionedGlyphs;Eo<Qo.length;Eo+=1){var Ra=Qo[Eo];if(Ra.rect){var vs=Ra.rect||{},Is=4,lu=!0,pu=1,cu=0,xu=(wi||Ca)&&Ra.vertical,ul=Ra.metrics.advance*Ra.scale/2;if(Ca&&vn.verticalizable&&(cu=jo.lineOffset/2-(Ra.imageName?-(24-Ra.metrics.width*Ra.scale)/2:24*(Ra.scale-1))),Ra.imageName){var Wu=Fi[Ra.imageName];lu=Wu.sdf,Is=1/(pu=Wu.pixelRatio)}var gl=wi?[Ra.x+ul,Ra.y]:[0,0],Xu=wi?[0,0]:[Ra.x+ul+Ln[0],Ra.y+Ln[1]-cu],_c=[0,0];xu&&(_c=Xu,Xu=[0,0]);var zu=(Ra.metrics.left-Is)*Ra.scale-ul+Xu[0],Bl=(-Ra.metrics.top-Is)*Ra.scale+Xu[1],Go=zu+vs.w*Ra.scale/pu,Zs=Bl+vs.h*Ra.scale/pu,Wo=new D(zu,Bl),Jo=new D(Go,Bl),kc=new D(zu,Zs),Nl=new D(Go,Zs);if(xu){var js=new D(-ul,ul- -17),Pu=-Math.PI/2,xc=12-ul,hs=new D(22-xc,-(Ra.imageName?xc:0)),hh=new(Function.prototype.bind.apply(D,[null].concat(_c)));Wo._rotateAround(Pu,js)._add(hs)._add(hh),Jo._rotateAround(Pu,js)._add(hs)._add(hh),kc._rotateAround(Pu,js)._add(hs)._add(hh),Nl._rotateAround(Pu,js)._add(hs)._add(hh)}if(Ni){var Af=Math.sin(Ni),th=Math.cos(Ni),Lu=[th,-Af,Af,th];Wo._matMult(Lu),Jo._matMult(Lu),kc._matMult(Lu),Nl._matMult(Lu)}var ph=new D(0,0),Tf=new D(0,0);Oo.push({tl:Wo,tr:Jo,bl:kc,br:Nl,tex:vs,writingMode:vn.writingMode,glyphOffset:gl,sectionIndex:Ra.sectionIndex,isSDF:lu,pixelOffsetTL:ph,pixelOffsetBR:Tf,minFontScaleX:0,minFontScaleY:0})}}return Oo}(0,r,G,d,E,I,s,e.allowVerticalPlacement),br=e.textSizeData,cr=null;br.kind==="source"?(cr=[128*d.layout.get("text-size").evaluate(I,{})])[0]>32640&&Ce(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):br.kind==="composite"&&((cr=[128*bt.compositeTextSizes[0].evaluate(I,{},Qt),128*bt.compositeTextSizes[1].evaluate(I,{},Qt)])[0]>32640||cr[1]>32640)&&Ce(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,tr,cr,G,E,I,be,t,se.lineStartIndex,se.lineLength,ot,Qt);for(var Zr=0,Yr=we;Zr<Yr.length;Zr+=1)Ze[Yr[Zr]]=e.text.placedSymbolArray.length-1;return 4*tr.length}function Kr(e){for(var t in e)return e[t];return null}function Ci(e,t,r,s){var d=e.compareText;if(t in d){for(var E=d[t],I=E.length-1;I>=0;I--)if(s.dist(E[I])<r)return!0}else d[t]=[];return d[t].push(s),!1}var No=ct.VectorTileFeature.types,Dt=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ct(e,t,r,s,d,E,I,G,se,be,we,Ze,ot){var bt=G?Math.min(32640,Math.round(G[0])):0,Qt=G?Math.min(32640,Math.round(G[1])):0;e.emplaceBack(t,r,Math.round(32*s),Math.round(32*d),E,I,(bt<<1)+(se?1:0),Qt,16*be,16*we,256*Ze,256*ot)}function yr(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function wr(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(yf(r[t].text))return!0;return!1}var tn=function(e){this.layoutVertexArray=new xf,this.indexArray=new $l,this.programConfigurations=e,this.segments=new Et,this.dynamicLayoutVertexArray=new fc,this.opacityVertexArray=new Xl,this.placedSymbolArray=new l};tn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},tn.prototype.upload=function(e,t,r,s){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rc.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,mc.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Dt,!0),this.opacityVertexBuffer.itemSize=1),(r||s)&&this.programConfigurations.upload(e))},tn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},zi("SymbolBuffers",tn);var Er=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new Et,this.collisionVertexArray=new of};Er.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,vl.members,!0)},Er.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},zi("CollisionBuffers",Er);var ar=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(E){return E.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=rl([]),this.placementViewportMatrix=rl([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Di(this.zoom,t["text-size"]),this.iconSizeData=Di(this.zoom,t["icon-size"]);var r=this.layers[0].layout,s=r.get("symbol-sort-key"),d=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&s.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(function(E){return xi[E]})),this.stateDependentLayerIds=this.layers.filter(function(E){return E.isStateDependent()}).map(function(E){return E.id}),this.sourceID=e.sourceID};ar.prototype.createArrays=function(){this.text=new tn(new Aa(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new tn(new Aa(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new j,this.lineVertexArray=new ae,this.symbolInstances=new z},ar.prototype.calculateGlyphDependencies=function(e,t,r,s,d){for(var E=0;E<e.length;E++)if(t[e.charCodeAt(E)]=!0,(r||s)&&d){var I=fh[e.charAt(E)];I&&(t[I.charCodeAt(0)]=!0)}},ar.prototype.populate=function(e,t,r){var s=this.layers[0],d=s.layout,E=d.get("text-font"),I=d.get("text-field"),G=d.get("icon-image"),se=(I.value.kind!=="constant"||I.value.value instanceof ya&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),be=G.value.kind!=="constant"||!!G.value.value||Object.keys(G.parameters).length>0,we=d.get("symbol-sort-key");if(this.features=[],se||be){for(var Ze=t.iconDependencies,ot=t.glyphDependencies,bt=t.availableImages,Qt=new fo(this.zoom),tr=0,br=e;tr<br.length;tr+=1){var cr=br[tr],Zr=cr.feature,Yr=cr.id,ln=cr.index,vn=cr.sourceLayerIndex,Ln=s._featureFilter.needGeometry,oi=xs(Zr,Ln);if(s._featureFilter.filter(Qt,oi,r)){Ln||(oi.geometry=Ho(Zr));var wi=void 0;if(se){var va=s.getValueAndResolveTokens("text-field",oi,r,bt),Fi=ya.factory(va);wr(Fi)&&(this.hasRTLText=!0),(!this.hasRTLText||oh()==="unavailable"||this.hasRTLText&&pl.isParsed())&&(wi=Lh(Fi,s,oi))}var Ca=void 0;if(be){var Ni=s.getValueAndResolveTokens("icon-image",oi,r,bt);Ca=Ni instanceof Gt?Ni:Gt.fromString(Ni)}if(wi||Ca){var Oo=this.sortFeaturesByKey?we.evaluate(oi,{},r):void 0;if(this.features.push({id:Yr,text:wi,icon:Ca,index:ln,sourceLayerIndex:vn,geometry:oi.geometry,properties:Zr.properties,type:No[Zr.type],sortKey:Oo}),Ca&&(Ze[Ca.name]=!0),wi){var $a=E.evaluate(oi,{},r).join(","),Wi=d.get("text-rotation-alignment")==="map"&&d.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(xi.vertical)>=0;for(var jo=0,Eo=wi.sections;jo<Eo.length;jo+=1){var Qo=Eo[jo];if(Qo.image)Ze[Qo.image.name]=!0;else{var Ra=gf(wi.toString()),vs=Qo.fontStack||$a,Is=ot[vs]=ot[vs]||{};this.calculateGlyphDependencies(Qo.text,Is,Wi,this.allowVerticalPlacement,Ra)}}}}}}d.get("symbol-placement")==="line"&&(this.features=function(lu){var pu={},cu={},xu=[],ul=0;function Wu(js){xu.push(lu[js]),ul++}function gl(js,Pu,xc){var hs=cu[js];return delete cu[js],cu[Pu]=hs,xu[hs].geometry[0].pop(),xu[hs].geometry[0]=xu[hs].geometry[0].concat(xc[0]),hs}function Xu(js,Pu,xc){var hs=pu[Pu];return delete pu[Pu],pu[js]=hs,xu[hs].geometry[0].shift(),xu[hs].geometry[0]=xc[0].concat(xu[hs].geometry[0]),hs}function _c(js,Pu,xc){var hs=xc?Pu[0][Pu[0].length-1]:Pu[0][0];return js+":"+hs.x+":"+hs.y}for(var zu=0;zu<lu.length;zu++){var Bl=lu[zu],Go=Bl.geometry,Zs=Bl.text?Bl.text.toString():null;if(Zs){var Wo=_c(Zs,Go),Jo=_c(Zs,Go,!0);if(Wo in cu&&Jo in pu&&cu[Wo]!==pu[Jo]){var kc=Xu(Wo,Jo,Go),Nl=gl(Wo,Jo,xu[kc].geometry);delete pu[Wo],delete cu[Jo],cu[_c(Zs,xu[Nl].geometry,!0)]=Nl,xu[kc].geometry=null}else Wo in cu?gl(Wo,Jo,Go):Jo in pu?Xu(Wo,Jo,Go):(Wu(zu),pu[Wo]=ul-1,cu[Jo]=ul-1)}else Wu(zu)}return xu.filter(function(js){return js.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(lu,pu){return lu.sortKey-pu.sortKey})}},ar.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},ar.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ar.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ar.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ar.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ar.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ar.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var s=e.dist(t[e.segment+1]),d=e.dist(t[e.segment]),E={},I=e.segment+1;I<t.length;I++)E[I]={x:t[I].x,y:t[I].y,tileUnitDistanceFromAnchor:s},I<t.length-1&&(s+=t[I+1].dist(t[I]));for(var G=e.segment||0;G>=0;G--)E[G]={x:t[G].x,y:t[G].y,tileUnitDistanceFromAnchor:d},G>0&&(d+=t[G-1].dist(t[G]));for(var se=0;se<t.length;se++){var be=E[se];this.lineVertexArray.emplaceBack(be.x,be.y,be.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},ar.prototype.addSymbols=function(e,t,r,s,d,E,I,G,se,be,we,Ze){for(var ot=e.indexArray,bt=e.layoutVertexArray,Qt=e.segments.prepareSegment(4*t.length,bt,ot,this.canOverlap?E.sortKey:void 0),tr=this.glyphOffsetArray.length,br=Qt.vertexLength,cr=this.allowVerticalPlacement&&I===xi.vertical?Math.PI/2:0,Zr=E.text&&E.text.sections,Yr=0;Yr<t.length;Yr++){var ln=t[Yr],vn=ln.tl,Ln=ln.tr,oi=ln.bl,wi=ln.br,va=ln.tex,Fi=ln.pixelOffsetTL,Ca=ln.pixelOffsetBR,Ni=ln.minFontScaleX,Oo=ln.minFontScaleY,$a=ln.glyphOffset,Wi=ln.isSDF,jo=ln.sectionIndex,Eo=Qt.vertexLength,Qo=$a[1];Ct(bt,G.x,G.y,vn.x,Qo+vn.y,va.x,va.y,r,Wi,Fi.x,Fi.y,Ni,Oo),Ct(bt,G.x,G.y,Ln.x,Qo+Ln.y,va.x+va.w,va.y,r,Wi,Ca.x,Fi.y,Ni,Oo),Ct(bt,G.x,G.y,oi.x,Qo+oi.y,va.x,va.y+va.h,r,Wi,Fi.x,Ca.y,Ni,Oo),Ct(bt,G.x,G.y,wi.x,Qo+wi.y,va.x+va.w,va.y+va.h,r,Wi,Ca.x,Ca.y,Ni,Oo),yr(e.dynamicLayoutVertexArray,G,cr),ot.emplaceBack(Eo,Eo+1,Eo+2),ot.emplaceBack(Eo+1,Eo+2,Eo+3),Qt.vertexLength+=4,Qt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($a[0]),Yr!==t.length-1&&jo===t[Yr+1].sectionIndex||e.programConfigurations.populatePaintArrays(bt.length,E,E.index,{},Ze,Zr&&Zr[jo])}e.placedSymbolArray.emplaceBack(G.x,G.y,tr,this.glyphOffsetArray.length-tr,br,se,be,G.segment,r?r[0]:0,r?r[1]:0,s[0],s[1],I,0,!1,0,we)},ar.prototype._addCollisionDebugVertex=function(e,t,r,s,d,E){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,s,d,Math.round(E.x),Math.round(E.y))},ar.prototype.addCollisionDebugVertices=function(e,t,r,s,d,E,I){var G=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),se=G.vertexLength,be=d.layoutVertexArray,we=d.collisionVertexArray,Ze=I.anchorX,ot=I.anchorY;this._addCollisionDebugVertex(be,we,E,Ze,ot,new D(e,t)),this._addCollisionDebugVertex(be,we,E,Ze,ot,new D(r,t)),this._addCollisionDebugVertex(be,we,E,Ze,ot,new D(r,s)),this._addCollisionDebugVertex(be,we,E,Ze,ot,new D(e,s)),G.vertexLength+=4;var bt=d.indexArray;bt.emplaceBack(se,se+1),bt.emplaceBack(se+1,se+2),bt.emplaceBack(se+2,se+3),bt.emplaceBack(se+3,se),G.primitiveLength+=4},ar.prototype.addDebugCollisionBoxes=function(e,t,r,s){for(var d=e;d<t;d++){var E=this.collisionBoxArray.get(d);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,s?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,r)}},ar.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Er(af,Jf.members,sf),this.iconCollisionBox=new Er(af,Jf.members,sf);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},ar.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,s,d,E,I,G,se){for(var be={},we=t;we<r;we++){var Ze=e.get(we);be.textBox={x1:Ze.x1,y1:Ze.y1,x2:Ze.x2,y2:Ze.y2,anchorPointX:Ze.anchorPointX,anchorPointY:Ze.anchorPointY},be.textFeatureIndex=Ze.featureIndex;break}for(var ot=s;ot<d;ot++){var bt=e.get(ot);be.verticalTextBox={x1:bt.x1,y1:bt.y1,x2:bt.x2,y2:bt.y2,anchorPointX:bt.anchorPointX,anchorPointY:bt.anchorPointY},be.verticalTextFeatureIndex=bt.featureIndex;break}for(var Qt=E;Qt<I;Qt++){var tr=e.get(Qt);be.iconBox={x1:tr.x1,y1:tr.y1,x2:tr.x2,y2:tr.y2,anchorPointX:tr.anchorPointX,anchorPointY:tr.anchorPointY},be.iconFeatureIndex=tr.featureIndex;break}for(var br=G;br<se;br++){var cr=e.get(br);be.verticalIconBox={x1:cr.x1,y1:cr.y1,x2:cr.x2,y2:cr.y2,anchorPointX:cr.anchorPointX,anchorPointY:cr.anchorPointY},be.verticalIconFeatureIndex=cr.featureIndex;break}return be},ar.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},ar.prototype.hasTextData=function(){return this.text.segments.get().length>0},ar.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ar.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ar.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ar.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ar.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),s=r.vertexStartIndex+4*r.numGlyphs,d=r.vertexStartIndex;d<s;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)},ar.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),s=[],d=[],E=[],I=0;I<this.symbolInstances.length;++I){E.push(I);var G=this.symbolInstances.get(I);s.push(0|Math.round(t*G.anchorX+r*G.anchorY)),d.push(G.featureIndex)}return E.sort(function(se,be){return s[se]-s[be]||d[be]-d[se]}),E},ar.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},ar.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,s=this.symbolInstanceIndexes;r<s.length;r+=1){var d=this.symbolInstances.get(s[r]);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach(function(E,I,G){E>=0&&G.indexOf(E)===I&&t.addIndicesForPlacedSymbol(t.text,E)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},zi("SymbolBucket",ar,{omit:["layers","collisionBoxArray","features","compareText"]}),ar.MAX_GLYPHS=65535,ar.addDynamicAttributes=yr;var Rr=new mu({"symbol-placement":new la(lt.layout_symbol["symbol-placement"]),"symbol-spacing":new la(lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new la(lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Vi(lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new la(lt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new la(lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new la(lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new la(lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new la(lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vi(lt.layout_symbol["icon-size"]),"icon-text-fit":new la(lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new la(lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vi(lt.layout_symbol["icon-image"]),"icon-rotate":new Vi(lt.layout_symbol["icon-rotate"]),"icon-padding":new la(lt.layout_symbol["icon-padding"]),"icon-keep-upright":new la(lt.layout_symbol["icon-keep-upright"]),"icon-offset":new Vi(lt.layout_symbol["icon-offset"]),"icon-anchor":new Vi(lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new la(lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new la(lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new la(lt.layout_symbol["text-rotation-alignment"]),"text-field":new Vi(lt.layout_symbol["text-field"]),"text-font":new Vi(lt.layout_symbol["text-font"]),"text-size":new Vi(lt.layout_symbol["text-size"]),"text-max-width":new Vi(lt.layout_symbol["text-max-width"]),"text-line-height":new la(lt.layout_symbol["text-line-height"]),"text-letter-spacing":new Vi(lt.layout_symbol["text-letter-spacing"]),"text-justify":new Vi(lt.layout_symbol["text-justify"]),"text-radial-offset":new Vi(lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new la(lt.layout_symbol["text-variable-anchor"]),"text-anchor":new Vi(lt.layout_symbol["text-anchor"]),"text-max-angle":new la(lt.layout_symbol["text-max-angle"]),"text-writing-mode":new la(lt.layout_symbol["text-writing-mode"]),"text-rotate":new Vi(lt.layout_symbol["text-rotate"]),"text-padding":new la(lt.layout_symbol["text-padding"]),"text-keep-upright":new la(lt.layout_symbol["text-keep-upright"]),"text-transform":new Vi(lt.layout_symbol["text-transform"]),"text-offset":new Vi(lt.layout_symbol["text-offset"]),"text-allow-overlap":new la(lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new la(lt.layout_symbol["text-ignore-placement"]),"text-optional":new la(lt.layout_symbol["text-optional"])}),Rt={paint:new mu({"icon-opacity":new Vi(lt.paint_symbol["icon-opacity"]),"icon-color":new Vi(lt.paint_symbol["icon-color"]),"icon-halo-color":new Vi(lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vi(lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vi(lt.paint_symbol["icon-halo-blur"]),"icon-translate":new la(lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new la(lt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vi(lt.paint_symbol["text-opacity"]),"text-color":new Vi(lt.paint_symbol["text-color"],{runtimeType:ui,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new Vi(lt.paint_symbol["text-halo-color"]),"text-halo-width":new Vi(lt.paint_symbol["text-halo-width"]),"text-halo-blur":new Vi(lt.paint_symbol["text-halo-blur"]),"text-translate":new la(lt.paint_symbol["text-translate"]),"text-translate-anchor":new la(lt.paint_symbol["text-translate-anchor"])}),layout:Rr},pr=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:On,this.defaultValue=e};pr.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},pr.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},pr.prototype.outputDefined=function(){return!1},pr.prototype.serialize=function(){return null},zi("FormatSectionOverride",pr,{omit:["defaultValue"]});var jt=function(e){function t(r){e.call(this,r,Rt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,s){if(e.prototype.recalculate.call(this,r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var d=this.layout.get("text-writing-mode");if(d){for(var E=[],I=0,G=d;I<G.length;I+=1){var se=G[I];E.indexOf(se)<0&&E.push(se)}this.layout._values["text-writing-mode"]=E}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,s,d,E){var I=this.layout.get(r).evaluate(s,{},d,E),G=this._unevaluatedLayout._values[r];return G.isDataDriven()||Ul(G.value)||!I?I:function(se,be){return be.replace(/{([^{}]+)}/g,function(we,Ze){return Ze in se?String(se[Ze]):""})}(s.properties,I)},t.prototype.createBucket=function(r){return new ar(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,s=Rt.paint.overridableProperties;r<s.length;r+=1){var d=s[r];if(t.hasPaintOverride(this.layout,d)){var E,I=this.paint.get(d),G=new pr(I),se=new vu(G,I.property.specification);E=I.value.kind==="constant"||I.value.kind==="source"?new Cu("source",se):new Zl("composite",se,I.value.zoomStops,I.value._interpolationType),this.paint._values[d]=new Hu(I.property,E,I.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,s,d){return!(!this.layout||s.isDataDriven()||d.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,s){var d=r.get("text-field"),E=Rt.paint.properties[s],I=!1,G=function(we){for(var Ze=0,ot=we;Ze<ot.length;Ze+=1)if(E.overrides&&E.overrides.hasOverride(ot[Ze]))return void(I=!0)};if(d.value.kind==="constant"&&d.value.value instanceof ya)G(d.value.value.sections);else if(d.value.kind==="source"){var se=function(we){I||(we instanceof Ss&&So(we.value)===vo?G(we.value.sections):we instanceof Ms?G(we.sections):we.eachChild(se))},be=d.value;be._styleExpression&&se(be._styleExpression.expression)}return I},t}(Pl),Wr={paint:new mu({"background-color":new la(lt.paint_background["background-color"]),"background-pattern":new wu(lt.paint_background["background-pattern"]),"background-opacity":new la(lt.paint_background["background-opacity"])})},qr=function(e){function t(r){e.call(this,r,Wr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Pl),zn={paint:new mu({"raster-opacity":new la(lt.paint_raster["raster-opacity"]),"raster-hue-rotate":new la(lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new la(lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new la(lt.paint_raster["raster-brightness-max"]),"raster-saturation":new la(lt.paint_raster["raster-saturation"]),"raster-contrast":new la(lt.paint_raster["raster-contrast"]),"raster-resampling":new la(lt.paint_raster["raster-resampling"]),"raster-fade-duration":new la(lt.paint_raster["raster-fade-duration"])})},yi=function(e){function t(r){e.call(this,r,zn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Pl),gi=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(Pl),Bi={circle:Lf,heatmap:Kf,hillshade:Cf,fill:Ai,"fill-extrusion":Sn,line:ds,symbol:jt,background:qr,raster:yi},pi=V.HTMLImageElement,aa=V.HTMLCanvasElement,Ui=V.HTMLVideoElement,Ji=V.ImageData,ea=V.ImageBitmap,ji=function(e,t,r,s){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,s)};ji.prototype.update=function(e,t,r){var s=e.width,d=e.height,E=!(this.size&&this.size[0]===s&&this.size[1]===d||r),I=this.context,G=I.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),G.bindTexture(G.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===G.RGBA&&(!t||t.premultiply!==!1)),E)this.size=[s,d],e instanceof pi||e instanceof aa||e instanceof Ui||e instanceof Ji||ea&&e instanceof ea?G.texImage2D(G.TEXTURE_2D,0,this.format,this.format,G.UNSIGNED_BYTE,e):G.texImage2D(G.TEXTURE_2D,0,this.format,s,d,0,this.format,G.UNSIGNED_BYTE,e.data);else{var se=r||{x:0,y:0},be=se.x,we=se.y;e instanceof pi||e instanceof aa||e instanceof Ui||e instanceof Ji||ea&&e instanceof ea?G.texSubImage2D(G.TEXTURE_2D,0,be,we,G.RGBA,G.UNSIGNED_BYTE,e):G.texSubImage2D(G.TEXTURE_2D,0,be,we,s,d,G.RGBA,G.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&G.generateMipmap(G.TEXTURE_2D)},ji.prototype.bind=function(e,t,r){var s=this.context.gl;s.bindTexture(s.TEXTURE_2D,this.texture),r!==s.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=s.LINEAR),e!==this.filter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,t),this.wrap=t)},ji.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ji.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ya=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};Ya.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Ya.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Es=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},$e(["receive","process"],this),this.invoker=new Ya(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=qt()?e:V};function ol(e,t,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[e*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}Es.prototype.send=function(e,t,r,s,d){var E=this;d===void 0&&(d=!1);var I=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[I]=r);var G=Ne(this.globalScope)?void 0:[];return this.target.postMessage({id:I,type:e,hasCallback:!!r,targetMapId:s,mustQueue:d,sourceMapId:this.mapId,data:Ws(t,G)},G),{cancel:function(){r&&delete E.callbacks[I],E.target.postMessage({id:I,type:"<cancel>",targetMapId:s,sourceMapId:E.mapId})}}},Es.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var s=this.cancelCallbacks[r];delete this.cancelCallbacks[r],s&&s()}else qt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Es.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Es.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var s=this.callbacks[e];delete this.callbacks[e],s&&(t.error?s(Vu(t.error)):s(null,Vu(t.data)))}else{var d=!1,E=Ne(this.globalScope)?void 0:[],I=t.hasCallback?function(we,Ze){d=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:we?Ws(we):null,data:Ws(Ze,E)},E)}:function(we){d=!0},G=null,se=Vu(t.data);if(this.parent[t.type])G=this.parent[t.type](t.sourceMapId,se,I);else if(this.parent.getWorkerSource){var be=t.type.split(".");G=this.parent.getWorkerSource(t.sourceMapId,be[0],se.source)[be[1]](se,I)}else I(new Error("Could not find function "+t.type));!d&&G&&G.cancel&&(this.cancelCallbacks[e]=G.cancel)}},Es.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var os=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};os.prototype.setNorthEast=function(e){return this._ne=e instanceof us?new us(e.lng,e.lat):us.convert(e),this},os.prototype.setSouthWest=function(e){return this._sw=e instanceof us?new us(e.lng,e.lat):us.convert(e),this},os.prototype.extend=function(e){var t,r,s=this._sw,d=this._ne;if(e instanceof us)t=e,r=e;else{if(!(e instanceof os))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(os.convert(e)):this.extend(us.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return s||d?(s.lng=Math.min(t.lng,s.lng),s.lat=Math.min(t.lat,s.lat),d.lng=Math.max(r.lng,d.lng),d.lat=Math.max(r.lat,d.lat)):(this._sw=new us(t.lng,t.lat),this._ne=new us(r.lng,r.lat)),this},os.prototype.getCenter=function(){return new us((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},os.prototype.getSouthWest=function(){return this._sw},os.prototype.getNorthEast=function(){return this._ne},os.prototype.getNorthWest=function(){return new us(this.getWest(),this.getNorth())},os.prototype.getSouthEast=function(){return new us(this.getEast(),this.getSouth())},os.prototype.getWest=function(){return this._sw.lng},os.prototype.getSouth=function(){return this._sw.lat},os.prototype.getEast=function(){return this._ne.lng},os.prototype.getNorth=function(){return this._ne.lat},os.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},os.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},os.prototype.isEmpty=function(){return!(this._sw&&this._ne)},os.prototype.contains=function(e){var t=us.convert(e),r=t.lng,s=t.lat,d=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&d},os.convert=function(e){return!e||e instanceof os?e:new os(e)};var us=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};us.prototype.wrap=function(){return new us(at(this.lng,-180,180),this.lat)},us.prototype.toArray=function(){return[this.lng,this.lat]},us.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},us.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,s=e.lat*t,d=Math.sin(r)*Math.sin(s)+Math.cos(r)*Math.cos(s)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(d,1))},us.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new os(new us(this.lng-r,this.lat-t),new us(this.lng+r,this.lat+t))},us.convert=function(e){if(e instanceof us)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new us(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new us(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Sf=2*Math.PI*63710088e-1;function yc(e){return Sf*Math.cos(e*Math.PI/180)}function Ff(e){return(180+e)/360}function cf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function yp(e,t){return e/yc(t)}function ff(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Ch=function(e,t,r){r===void 0&&(r=0),this.x=+e,this.y=+t,this.z=+r};Ch.fromLngLat=function(e,t){t===void 0&&(t=0);var r=us.convert(e);return new Ch(Ff(r.lng),cf(r.lat),yp(t,r.lat))},Ch.prototype.toLngLat=function(){return new us(360*this.x-180,ff(this.y))},Ch.prototype.toAltitude=function(){return this.z*yc(ff(this.y))},Ch.prototype.meterInMercatorCoordinateUnits=function(){return 1/Sf*(e=ff(this.y),1/Math.cos(e*Math.PI/180));var e};var Wh=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=rp(0,e,e,t,r)};Wh.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Wh.prototype.url=function(e,t){var r,s,d,E,I,G=(s=this.y,d=this.z,E=ol(256*(r=this.x),256*(s=Math.pow(2,d)-s-1),d),I=ol(256*(r+1),256*(s+1),d),E[0]+","+E[1]+","+I[0]+","+I[1]),se=function(be,we,Ze){for(var ot,bt="",Qt=be;Qt>0;Qt--)bt+=(we&(ot=1<<Qt-1)?1:0)+(Ze&ot?2:0);return bt}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",se).replace("{bbox-epsg-3857}",G)},Wh.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new D(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Wh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var $p=function(e,t){this.wrap=e,this.canonical=t,this.key=rp(e,t.z,t.z,t.x,t.y)},sl=function(e,t,r,s,d){this.overscaledZ=e,this.wrap=t,this.canonical=new Wh(r,+s,+d),this.key=rp(t,e,r,s,d)};function rp(e,t,r,s,d){(e*=2)<0&&(e=-1*e-1);var E=1<<r;return(E*E*e+E*d+s).toString(36)+r.toString(36)+t.toString(36)}sl.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},sl.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new sl(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sl(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},sl.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?rp(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):rp(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},sl.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},sl.prototype.children=function(e){if(this.overscaledZ>=e)return[new sl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,s=2*this.canonical.y;return[new sl(t,this.wrap,t,r,s),new sl(t,this.wrap,t,r+1,s),new sl(t,this.wrap,t,r,s+1),new sl(t,this.wrap,t,r+1,s+1)]},sl.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},sl.prototype.wrapped=function(){return new sl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},sl.prototype.unwrapTo=function(e){return new sl(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},sl.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},sl.prototype.toUnwrapped=function(){return new $p(this.wrap,this.canonical)},sl.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},sl.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Ch(e.x-this.wrap,e.y))},zi("CanonicalTileID",Wh),zi("OverscaledTileID",sl,{omit:["posMatrix"]});var Sh=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return Ce('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var s=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var d=0;d<s;d++)this.data[this._idx(-1,d)]=this.data[this._idx(0,d)],this.data[this._idx(s,d)]=this.data[this._idx(s-1,d)],this.data[this._idx(d,-1)]=this.data[this._idx(d,0)],this.data[this._idx(d,s)]=this.data[this._idx(d,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)]};Sh.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),s=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[s],r[s+1],r[s+2])},Sh.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Sh.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Sh.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Sh.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Sh.prototype.getPixels=function(){return new hu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Sh.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var s=t*this.dim,d=t*this.dim+this.dim,E=r*this.dim,I=r*this.dim+this.dim;switch(t){case-1:s=d-1;break;case 1:d=s+1}switch(r){case-1:E=I-1;break;case 1:I=E+1}for(var G=-t*this.dim,se=-r*this.dim,be=E;be<I;be++)for(var we=s;we<d;we++)this.data[this._idx(we,be)]=e.data[this._idx(we+G,be+se)]},zi("DEMData",Sh);var Op=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};Op.prototype.encode=function(e){return this._stringToNumber[e]},Op.prototype.decode=function(e){return this._numberToString[e]};var Xh=function(e,t,r,s,d){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=s,this.properties=e.properties,this.id=d},jp={geometry:{configurable:!0}};jp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},jp.geometry.set=function(e){this._geometry=e},Xh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Xh.prototype,jp);var Ih=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ih.prototype.updateState=function(e,t,r){var s=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][s]=this.stateChanges[e][s]||{},rt(this.stateChanges[e][s],r),this.deletedStates[e]===null)for(var d in this.deletedStates[e]={},this.state[e])d!==s&&(this.deletedStates[e][d]=null);else if(this.deletedStates[e]&&this.deletedStates[e][s]===null)for(var E in this.deletedStates[e][s]={},this.state[e][s])r[E]||(this.deletedStates[e][s][E]=null);else for(var I in r)this.deletedStates[e]&&this.deletedStates[e][s]&&this.deletedStates[e][s][I]===null&&delete this.deletedStates[e][s][I]},Ih.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var s=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][s]!==null&&(this.deletedStates[e][s]=this.deletedStates[e][s]||{},this.deletedStates[e][s][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][s])for(r in this.deletedStates[e][s]={},this.stateChanges[e][s])this.deletedStates[e][s][r]=null;else this.deletedStates[e][s]=null;else this.deletedStates[e]=null}},Ih.prototype.getState=function(e,t){var r=String(t),s=rt({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var d=this.deletedStates[e][t];if(d===null)return{};for(var E in d)delete s[E]}return s},Ih.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Ih.prototype.coalesceChanges=function(e,t){var r={};for(var s in this.stateChanges){this.state[s]=this.state[s]||{};var d={};for(var E in this.stateChanges[s])this.state[s][E]||(this.state[s][E]={}),rt(this.state[s][E],this.stateChanges[s][E]),d[E]=this.state[s][E];r[s]=d}for(var I in this.deletedStates){this.state[I]=this.state[I]||{};var G={};if(this.deletedStates[I]===null)for(var se in this.state[I])G[se]={},this.state[I][se]={};else for(var be in this.deletedStates[I]){if(this.deletedStates[I][be]===null)this.state[I][be]={};else for(var we=0,Ze=Object.keys(this.deletedStates[I][be]);we<Ze.length;we+=1)delete this.state[I][be][Ze[we]];G[be]=this.state[I][be]}r[I]=r[I]||{},rt(r[I],G)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var ot in e)e[ot].setFeatureState(r,t)};var Rh=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ac(8192,16,0),this.grid3D=new ac(8192,16,0),this.featureIndexArray=new He,this.promoteId=t};function Kp(e,t,r,s,d){return Ge(e,function(E,I){var G=t instanceof Js?t.get(I):null;return G&&G.evaluate?G.evaluate(r,s,d):G})}function qp(e){for(var t=1/0,r=1/0,s=-1/0,d=-1/0,E=0,I=e;E<I.length;E+=1){var G=I[E];t=Math.min(t,G.x),r=Math.min(r,G.y),s=Math.max(s,G.x),d=Math.max(d,G.y)}return{minX:t,minY:r,maxX:s,maxY:d}}function Gp(e,t){return t-e}Rh.prototype.insert=function(e,t,r,s,d,E){var I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,s,d);for(var G=E?this.grid3D:this.grid,se=0;se<t.length;se++){for(var be=t[se],we=[1/0,1/0,-1/0,-1/0],Ze=0;Ze<be.length;Ze++){var ot=be[Ze];we[0]=Math.min(we[0],ot.x),we[1]=Math.min(we[1],ot.y),we[2]=Math.max(we[2],ot.x),we[3]=Math.max(we[3],ot.y)}we[0]<8192&&we[1]<8192&&we[2]>=0&&we[3]>=0&&G.insert(I,we[0],we[1],we[2],we[3])}},Rh.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ct.VectorTile(new Ns(this.rawTileData)).layers,this.sourceLayerCoder=new Op(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Rh.prototype.query=function(e,t,r,s){var d=this;this.loadVTLayers();for(var E=e.params||{},I=8192/e.tileSize/e.scale,G=cl(E.filter),se=e.queryGeometry,be=e.queryPadding*I,we=qp(se),Ze=this.grid.query(we.minX-be,we.minY-be,we.maxX+be,we.maxY+be),ot=qp(e.cameraQueryGeometry),bt=this.grid3D.query(ot.minX-be,ot.minY-be,ot.maxX+be,ot.maxY+be,function(ln,vn,Ln,oi){return function(wi,va,Fi,Ca,Ni){for(var Oo=0,$a=wi;Oo<$a.length;Oo+=1){var Wi=$a[Oo];if(va<=Wi.x&&Fi<=Wi.y&&Ca>=Wi.x&&Ni>=Wi.y)return!0}var jo=[new D(va,Fi),new D(va,Ni),new D(Ca,Ni),new D(Ca,Fi)];if(wi.length>2){for(var Eo=0,Qo=jo;Eo<Qo.length;Eo+=1)if(Us(wi,Qo[Eo]))return!0}for(var Ra=0;Ra<wi.length-1;Ra++)if(Yc(wi[Ra],wi[Ra+1],jo))return!0;return!1}(e.cameraQueryGeometry,ln-be,vn-be,Ln+be,oi+be)}),Qt=0,tr=bt;Qt<tr.length;Qt+=1)Ze.push(tr[Qt]);Ze.sort(Gp);for(var br,cr={},Zr=function(ln){var vn=Ze[ln];if(vn!==br){br=vn;var Ln=d.featureIndexArray.get(vn),oi=null;d.loadMatchingFeature(cr,Ln.bucketIndex,Ln.sourceLayerIndex,Ln.featureIndex,G,E.layers,E.availableImages,t,r,s,function(wi,va,Fi){return oi||(oi=Ho(wi)),va.queryIntersectsFeature(se,wi,Fi,oi,d.z,e.transform,I,e.pixelPosMatrix)})}},Yr=0;Yr<Ze.length;Yr++)Zr(Yr);return cr},Rh.prototype.loadMatchingFeature=function(e,t,r,s,d,E,I,G,se,be,we){var Ze=this.bucketLayerIDs[t];if(!E||function(wi,va){for(var Fi=0;Fi<wi.length;Fi++)if(va.indexOf(wi[Fi])>=0)return!0;return!1}(E,Ze)){var ot=this.sourceLayerCoder.decode(r),bt=this.vtLayers[ot].feature(s);if(d.needGeometry){var Qt=xs(bt,!0);if(!d.filter(new fo(this.tileID.overscaledZ),Qt,this.tileID.canonical))return}else if(!d.filter(new fo(this.tileID.overscaledZ),bt))return;for(var tr=this.getId(bt,ot),br=0;br<Ze.length;br++){var cr=Ze[br];if(!(E&&E.indexOf(cr)<0)){var Zr=G[cr];if(Zr){var Yr={};tr!==void 0&&be&&(Yr=be.getState(Zr.sourceLayer||"_geojsonTileLayer",tr));var ln=rt({},se[cr]);ln.paint=Kp(ln.paint,Zr.paint,bt,Yr,I),ln.layout=Kp(ln.layout,Zr.layout,bt,Yr,I);var vn=!we||we(bt,Zr,Yr);if(vn){var Ln=new Xh(bt,this.z,this.x,this.y,tr);Ln.layer=ln;var oi=e[cr];oi===void 0&&(oi=e[cr]=[]),oi.push({featureIndex:s,feature:Ln,intersectionZ:vn})}}}}}},Rh.prototype.lookupSymbolFeatures=function(e,t,r,s,d,E,I,G){var se={};this.loadVTLayers();for(var be=cl(d),we=0,Ze=e;we<Ze.length;we+=1)this.loadMatchingFeature(se,r,s,Ze[we],be,E,I,G,t);return se},Rh.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var s=0,d=r[t];s<d.length;s+=1)if(e===d[s])return!0;return!1},Rh.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},zi("FeatureIndex",Rh,{omit:["rawTileData","sourceLayerCoder"]});var Fl=function(e,t){this.tileID=e,this.uid=vt(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Fl.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<jr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Fl.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Fl.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var s in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(be,we){var Ze={};if(!we)return Ze;for(var ot=function(){var tr=Qt[bt],br=tr.layerIds.map(function(Yr){return we.getLayer(Yr)}).filter(Boolean);if(br.length!==0){tr.layers=br,tr.stateDependentLayerIds&&(tr.stateDependentLayers=tr.stateDependentLayerIds.map(function(Yr){return br.filter(function(ln){return ln.id===Yr})[0]}));for(var cr=0,Zr=br;cr<Zr.length;cr+=1)Ze[Zr[cr].id]=tr}},bt=0,Qt=be;bt<Qt.length;bt+=1)ot();return Ze}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var d=this.buckets[s];if(d instanceof ar){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var E in this.buckets){var I=this.buckets[E];if(I instanceof ar&&I.hasRTLText){this.hasRTLText=!0,pl.isLoading()||pl.isLoaded()||oh()!=="deferred"||wl();break}}for(var G in this.queryPadding=0,this.buckets){var se=this.buckets[G];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(G).queryRadius(se))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new o},Fl.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Fl.prototype.getBucket=function(e){return this.buckets[e.id]},Fl.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ji(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ji(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)},Fl.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Fl.prototype.queryRenderedFeatures=function(e,t,r,s,d,E,I,G,se,be){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:s,cameraQueryGeometry:d,scale:E,tileSize:this.tileSize,pixelPosMatrix:be,transform:G,params:I,queryPadding:this.queryPadding*se},e,t,r):{}},Fl.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var s=r.loadVTLayers(),d=t?t.sourceLayer:"",E=s._geojsonTileLayer||s[d];if(E)for(var I=cl(t&&t.filter),G=this.tileID.canonical,se=G.z,be=G.x,we=G.y,Ze={z:se,x:be,y:we},ot=0;ot<E.length;ot++){var bt=E.feature(ot);if(I.needGeometry){var Qt=xs(bt,!0);if(!I.filter(new fo(this.tileID.overscaledZ),Qt,this.tileID.canonical))continue}else if(!I.filter(new fo(this.tileID.overscaledZ),bt))continue;var tr=r.getId(bt,d),br=new Xh(bt,se,be,we,tr);br.tile=Ze,e.push(br)}}},Fl.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Fl.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Fl.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ir(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var s=Date.now(),d=!1;if(this.expirationTime>s)d=!1;else if(t)if(this.expirationTime<t)d=!0;else{var E=this.expirationTime-t;E?this.expirationTime=s+Math.max(E,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Fl.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Fl.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var s in this.buckets)if(t.style.hasLayer(s)){var d=this.buckets[s],E=d.layers[0].sourceLayer||"_geojsonTileLayer",I=r[E],G=e[E];if(I&&G&&Object.keys(G).length!==0){d.update(G,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});var se=t&&t.style&&t.style.getLayer(s);se&&(this.queryPadding=Math.max(this.queryPadding,se.queryRadius(d)))}}}},Fl.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Fl.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<jr.now()},Fl.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Fl.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=jr.now()+e},Fl.prototype.setDependencies=function(e,t){for(var r={},s=0,d=t;s<d.length;s+=1)r[d[s]]=!0;this.dependencies[e]=r},Fl.prototype.hasDependency=function(e,t){for(var r=0,s=e;r<s.length;r+=1){var d=this.dependencies[s[r]];if(d){for(var E=0,I=t;E<I.length;E+=1)if(d[I[E]])return!0}}return!1};var Uh=V.performance,Ip=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Uh.mark(this._marks.start)};Ip.prototype.finish=function(){Uh.mark(this._marks.end);var e=Uh.getEntriesByName(this._marks.measure);return e.length===0&&(Uh.measure(this._marks.measure,this._marks.start,this._marks.end),e=Uh.getEntriesByName(this._marks.measure),Uh.clearMarks(this._marks.start),Uh.clearMarks(this._marks.end),Uh.clearMeasures(this._marks.measure)),e},a.Actor=Es,a.AlphaImage=Oc,a.CanonicalTileID=Wh,a.CollisionBoxArray=o,a.Color=ba,a.DEMData=Sh,a.DataConstantProperty=la,a.DictionaryCoder=Op,a.EXTENT=8192,a.ErrorEvent=Ut,a.EvaluationParameters=fo,a.Event=dt,a.Evented=ur,a.FeatureIndex=Rh,a.FillBucket=Kt,a.FillExtrusionBucket=Gr,a.ImageAtlas=ri,a.ImagePosition=Vr,a.LineBucket=sa,a.LngLat=us,a.LngLatBounds=os,a.MercatorCoordinate=Ch,a.ONE_EM=24,a.OverscaledTileID=sl,a.Point=D,a.Point$1=D,a.Properties=mu,a.Protobuf=Ns,a.RGBAImage=hu,a.RequestManager=Mr,a.RequestPerformance=Ip,a.ResourceType=Hr,a.SegmentVector=Et,a.SourceFeatureState=Ih,a.StructArrayLayout1ui2=sh,a.StructArrayLayout2f1f2i16=Yl,a.StructArrayLayout2i4=uc,a.StructArrayLayout3ui6=$l,a.StructArrayLayout4i8=lc,a.SymbolBucket=ar,a.Texture=ji,a.Tile=Fl,a.Transitionable=Xs,a.Uniform1f=Zn,a.Uniform1i=Bn,a.Uniform2f=Vn,a.Uniform3f=Si,a.Uniform4f=Zi,a.UniformColor=ca,a.UniformMatrix4f=Co,a.UnwrappedTileID=$p,a.ValidationError=Nt,a.WritingMode=xi,a.ZoomHistory=mf,a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},a.addDynamicAttributes=yr,a.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var s=e.length,d=new Array(e.length),E=null;e.forEach(function(I,G){t(I,function(se,be){se&&(E=se),d[G]=be,--s==0&&r(E,d)})})},a.bezier=Y,a.bindAll=$e,a.browser=jr,a.cacheEntryPossiblyAdded=function(e){++lr>yt&&(e.getActor().send("enforceCacheSizeLimit",Ue),lr=0)},a.clamp=ce,a.clearTileCache=function(e){var t=V.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=Mu,a.clone=function(e){var t=new Uo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=Te,a.clone$2=function(e){var t=new Uo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=Vh,a.config=xr,a.create=function(){var e=new Uo(16);return Uo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Uo(9);return Uo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Uo(4);return Uo!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=P,a.createExpression=Qu,a.createLayout=fs,a.createStyleLayer=function(e){return e.type==="custom"?new gi(e):new Bi[e.type](e)},a.cross=function(e,t,r){var s=t[0],d=t[1],E=t[2],I=r[0],G=r[1],se=r[2];return e[0]=d*se-E*G,e[1]=E*I-s*se,e[2]=s*G-d*I,e},a.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var s=0;s<t.length;s++)if(!e(t[s],r[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var d in t)if(!e(t[d],r[d]))return!1;return!0}return t===r},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=H,a.emitValidationErrors=Sl,a.endsWith=re,a.enforceCacheSizeLimit=function(e){gt(),ie&&ie.then(function(t){t.keys().then(function(r){for(var s=0;s<r.length-e;s++)t.delete(r[s])})})},a.evaluateSizeForFeature=Xa,a.evaluateSizeForZoom=lo,a.evaluateVariableOffset=Ks,a.evented=Uf,a.extend=rt,a.featureFilter=cl,a.filterObject=Qe,a.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=0,e[3]=-r,e[4]=s,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=Ri,a.getAnchorJustification=$t,a.getArrayBuffer=Zt,a.getImage=_e,a.getJSON=function(e,t){return $r(rt(e,{type:"json"}),t)},a.getRTLTextPluginStatus=oh,a.getReferrer=bn,a.getVideo=function(e,t){var r,s,d=V.document.createElement("video");d.muted=!0,d.onloadstart=function(){t(null,d)};for(var E=0;E<e.length;E++){var I=V.document.createElement("source");r=e[E],s=void 0,(s=V.document.createElement("a")).href=r,(s.protocol!==V.document.location.protocol||s.host!==V.document.location.host)&&(d.crossOrigin="Anonymous"),I.src=e[E],d.appendChild(I)}return{cancel:function(){}}},a.identity=rl,a.invert=function(e,t){var r=t[0],s=t[1],d=t[2],E=t[3],I=t[4],G=t[5],se=t[6],be=t[7],we=t[8],Ze=t[9],ot=t[10],bt=t[11],Qt=t[12],tr=t[13],br=t[14],cr=t[15],Zr=r*G-s*I,Yr=r*se-d*I,ln=r*be-E*I,vn=s*se-d*G,Ln=s*be-E*G,oi=d*be-E*se,wi=we*tr-Ze*Qt,va=we*br-ot*Qt,Fi=we*cr-bt*Qt,Ca=Ze*br-ot*tr,Ni=Ze*cr-bt*tr,Oo=ot*cr-bt*br,$a=Zr*Oo-Yr*Ni+ln*Ca+vn*Fi-Ln*va+oi*wi;return $a?(e[0]=(G*Oo-se*Ni+be*Ca)*($a=1/$a),e[1]=(d*Ni-s*Oo-E*Ca)*$a,e[2]=(tr*oi-br*Ln+cr*vn)*$a,e[3]=(ot*Ln-Ze*oi-bt*vn)*$a,e[4]=(se*Fi-I*Oo-be*va)*$a,e[5]=(r*Oo-d*Fi+E*va)*$a,e[6]=(br*ln-Qt*oi-cr*Yr)*$a,e[7]=(we*oi-ot*ln+bt*Yr)*$a,e[8]=(I*Ni-G*Fi+be*wi)*$a,e[9]=(s*Fi-r*Ni-E*wi)*$a,e[10]=(Qt*Ln-tr*ln+cr*Zr)*$a,e[11]=(Ze*ln-we*Ln-bt*Zr)*$a,e[12]=(G*va-I*Ca-se*wi)*$a,e[13]=(r*Ca-s*va+d*wi)*$a,e[14]=(tr*Yr-Qt*vn-br*Zr)*$a,e[15]=(we*vn-Ze*Yr+ot*Zr)*$a,e):null},a.isChar=_i,a.isMapboxURL=Cr,a.keysDifference=function(e,t){var r=[];for(var s in e)s in t||r.push(s);return r},a.makeRequest=$r,a.mapObject=Ge,a.mercatorXfromLng=Ff,a.mercatorYfromLat=cf,a.mercatorZfromAltitude=yp,a.mul=jf,a.multiply=uu,a.mvt=ct,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var r=t[0],s=t[1],d=t[2],E=r*r+s*s+d*d;return E>0&&(E=1/Math.sqrt(E)),e[0]=t[0]*E,e[1]=t[1]*E,e[2]=t[2]*E,e},a.number=ci,a.offscreenCanvasSupported=Ur,a.ortho=function(e,t,r,s,d,E,I){var G=1/(t-r),se=1/(s-d),be=1/(E-I);return e[0]=-2*G,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*se,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*be,e[11]=0,e[12]=(t+r)*G,e[13]=(d+s)*se,e[14]=(I+E)*be,e[15]=1,e},a.parseGlyphPBF=function(e){return new Ns(e).readFields(ii,[])},a.pbf=Ns,a.performSymbolLayout=function(e,t,r,s,d,E,I){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var G=e.layers[0].layout,se=e.layers[0]._unevaluatedLayout._values,be={};if(e.textSizeData.kind==="composite"){var we=e.textSizeData,Ze=we.maxZoom;be.compositeTextSizes=[se["text-size"].possiblyEvaluate(new fo(we.minZoom),I),se["text-size"].possiblyEvaluate(new fo(Ze),I)]}if(e.iconSizeData.kind==="composite"){var ot=e.iconSizeData,bt=ot.maxZoom;be.compositeIconSizes=[se["icon-size"].possiblyEvaluate(new fo(ot.minZoom),I),se["icon-size"].possiblyEvaluate(new fo(bt),I)]}be.layoutTextSize=se["text-size"].possiblyEvaluate(new fo(e.zoom+1),I),be.layoutIconSize=se["icon-size"].possiblyEvaluate(new fo(e.zoom+1),I),be.textMaxSize=se["text-size"].possiblyEvaluate(new fo(18));for(var Qt=24*G.get("text-line-height"),tr=G.get("text-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",br=G.get("text-keep-upright"),cr=G.get("text-size"),Zr=function(){var vn=ln[Yr],Ln=G.get("text-font").evaluate(vn,{},I).join(","),oi=cr.evaluate(vn,{},I),wi=be.layoutTextSize.evaluate(vn,{},I),va=be.layoutIconSize.evaluate(vn,{},I),Fi={horizontal:{},vertical:void 0},Ca=vn.text,Ni=[0,0];if(Ca){var Oo=Ca.toString(),$a=24*G.get("text-letter-spacing").evaluate(vn,{},I),Wi=function(Go){for(var Zs=0,Wo=Go;Zs<Wo.length;Zs+=1)if(Jo=Wo[Zs].charCodeAt(0),_i.Arabic(Jo)||_i["Arabic Supplement"](Jo)||_i["Arabic Extended-A"](Jo)||_i["Arabic Presentation Forms-A"](Jo)||_i["Arabic Presentation Forms-B"](Jo))return!1;var Jo;return!0}(Oo)?$a:0,jo=G.get("text-anchor").evaluate(vn,{},I),Eo=G.get("text-variable-anchor");if(!Eo){var Qo=G.get("text-radial-offset").evaluate(vn,{},I);Ni=Qo?Ks(jo,[24*Qo,Os]):G.get("text-offset").evaluate(vn,{},I).map(function(Go){return 24*Go})}var Ra=tr?"center":G.get("text-justify").evaluate(vn,{},I),vs=G.get("symbol-placement"),Is=vs==="point"?24*G.get("text-max-width").evaluate(vn,{},I):0,lu=function(){e.allowVerticalPlacement&&gf(Oo)&&(Fi.vertical=Li(Ca,t,r,d,Ln,Is,Qt,jo,"left",Wi,Ni,xi.vertical,!0,vs,wi,oi))};if(!tr&&Eo){for(var pu=Ra==="auto"?Eo.map(function(Go){return $t(Go)}):[Ra],cu=!1,xu=0;xu<pu.length;xu++){var ul=pu[xu];if(!Fi.horizontal[ul])if(cu)Fi.horizontal[ul]=Fi.horizontal[0];else{var Wu=Li(Ca,t,r,d,Ln,Is,Qt,"center",ul,Wi,Ni,xi.horizontal,!1,vs,wi,oi);Wu&&(Fi.horizontal[ul]=Wu,cu=Wu.positionedLines.length===1)}}lu()}else{Ra==="auto"&&(Ra=$t(jo));var gl=Li(Ca,t,r,d,Ln,Is,Qt,jo,Ra,Wi,Ni,xi.horizontal,!1,vs,wi,oi);gl&&(Fi.horizontal[Ra]=gl),lu(),gf(Oo)&&tr&&br&&(Fi.vertical=Li(Ca,t,r,d,Ln,Is,Qt,jo,Ra,Wi,Ni,xi.vertical,!1,vs,wi,oi))}}var Xu=void 0,_c=!1;if(vn.icon&&vn.icon.name){var zu=s[vn.icon.name];zu&&(Xu=function(Go,Zs,Wo){var Jo=Ri(Wo),kc=Zs[0]-Go.displaySize[0]*Jo.horizontalAlign,Nl=Zs[1]-Go.displaySize[1]*Jo.verticalAlign;return{image:Go,top:Nl,bottom:Nl+Go.displaySize[1],left:kc,right:kc+Go.displaySize[0]}}(d[vn.icon.name],G.get("icon-offset").evaluate(vn,{},I),G.get("icon-anchor").evaluate(vn,{},I)),_c=zu.sdf,e.sdfIcons===void 0?e.sdfIcons=zu.sdf:e.sdfIcons!==zu.sdf&&Ce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(zu.pixelRatio!==e.pixelRatio||G.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Bl=Kr(Fi.horizontal)||Fi.vertical;e.iconsInText=!!Bl&&Bl.iconsInText,(Bl||Xu)&&function(Go,Zs,Wo,Jo,kc,Nl,js,Pu,xc,hs,hh){var Af=Nl.textMaxSize.evaluate(Zs,{});Af===void 0&&(Af=js);var th,Lu=Go.layers[0].layout,ph=Lu.get("icon-offset").evaluate(Zs,{},hh),Tf=Kr(Wo.horizontal),Yh=js/24,Zh=Go.tilePixelRatio*Yh,$h=Go.tilePixelRatio*Af/24,Ah=Go.tilePixelRatio*Pu,np=Go.tilePixelRatio*Lu.get("symbol-spacing"),ip=Lu.get("text-padding")*Go.tilePixelRatio,Kh=Lu.get("icon-padding")*Go.tilePixelRatio,ap=Lu.get("text-max-angle")/180*Math.PI,_p=Lu.get("text-rotation-alignment")==="map"&&Lu.get("symbol-placement")!=="point",xp=Lu.get("icon-rotation-alignment")==="map"&&Lu.get("symbol-placement")!=="point",Th=Lu.get("symbol-placement"),bp=np/2,jh=Lu.get("icon-text-fit");Jo&&jh!=="none"&&(Go.allowVerticalPlacement&&Wo.vertical&&(th=io(Jo,Wo.vertical,jh,Lu.get("icon-text-fit-padding"),ph,Yh)),Tf&&(Jo=io(Jo,Tf,jh,Lu.get("icon-text-fit-padding"),ph,Yh)));var Dh=function(Jp,pp){pp.x<0||pp.x>=8192||pp.y<0||pp.y>=8192||function(Ou,rh,ed,Nh,Rp,Hp,Mh,Xf,wp,dp,Mp,Dp,kp,Fp,Pp,Wp,tp,td,f,F,x,p,h,S,k){var Q,oe,xe,Be,qe,zt=Ou.addToLineVertexArray(rh,ed),Ht=0,Tr=0,en=0,An=0,Hn=-1,si=-1,ni={},di=Vt(""),qi=0,ta=0;if(Xf._unevaluatedLayout.getValue("text-radial-offset")===void 0?(qi=(Q=Xf.layout.get("text-offset").evaluate(x,{},S).map(function(ja){return 24*ja}))[0],ta=Q[1]):(qi=24*Xf.layout.get("text-radial-offset").evaluate(x,{},S),ta=Os),Ou.allowVerticalPlacement&&Nh.vertical){var Xi=Xf.layout.get("text-rotate").evaluate(x,{},S)+90;Be=new Bu(wp,rh,dp,Mp,Dp,Nh.vertical,kp,Fp,Pp,Xi),Mh&&(qe=new Bu(wp,rh,dp,Mp,Dp,Mh,tp,td,Pp,Xi))}if(Rp){var Ja=Xf.layout.get("icon-rotate").evaluate(x,{}),po=Xf.layout.get("icon-text-fit")!=="none",zo=il(Rp,Ja,h,po),Ta=Mh?il(Mh,Ja,h,po):void 0;xe=new Bu(wp,rh,dp,Mp,Dp,Rp,tp,td,!1,Ja),Ht=4*zo.length;var Io=Ou.iconSizeData,co=null;Io.kind==="source"?(co=[128*Xf.layout.get("icon-size").evaluate(x,{})])[0]>32640&&Ce(Ou.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Io.kind==="composite"&&((co=[128*p.compositeIconSizes[0].evaluate(x,{},S),128*p.compositeIconSizes[1].evaluate(x,{},S)])[0]>32640||co[1]>32640)&&Ce(Ou.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ou.addSymbols(Ou.icon,zo,co,F,f,x,!1,rh,zt.lineStartIndex,zt.lineLength,-1,S),Hn=Ou.icon.placedSymbolArray.length-1,Ta&&(Tr=4*Ta.length,Ou.addSymbols(Ou.icon,Ta,co,F,f,x,xi.vertical,rh,zt.lineStartIndex,zt.lineLength,-1,S),si=Ou.icon.placedSymbolArray.length-1)}for(var qs in Nh.horizontal){var yl=Nh.horizontal[qs];if(!oe){di=Vt(yl.text);var bc=Xf.layout.get("text-rotate").evaluate(x,{},S);oe=new Bu(wp,rh,dp,Mp,Dp,yl,kp,Fp,Pp,bc)}var Fc=yl.positionedLines.length===1;if(en+=sn(Ou,rh,yl,Hp,Xf,Pp,x,Wp,zt,Nh.vertical?xi.horizontal:xi.horizontalOnly,Fc?Object.keys(Nh.horizontal):[qs],ni,Hn,p,S),Fc)break}Nh.vertical&&(An+=sn(Ou,rh,Nh.vertical,Hp,Xf,Pp,x,Wp,zt,xi.vertical,["vertical"],ni,si,p,S));var Yf=oe?oe.boxStartIndex:Ou.collisionBoxArray.length,zl=oe?oe.boxEndIndex:Ou.collisionBoxArray.length,zh=Be?Be.boxStartIndex:Ou.collisionBoxArray.length,Bp=Be?Be.boxEndIndex:Ou.collisionBoxArray.length,rd=xe?xe.boxStartIndex:Ou.collisionBoxArray.length,od=xe?xe.boxEndIndex:Ou.collisionBoxArray.length,Lp=qe?qe.boxStartIndex:Ou.collisionBoxArray.length,sd=qe?qe.boxEndIndex:Ou.collisionBoxArray.length,dh=-1,Np=function(ja,Cs){return ja&&ja.circleDiameter?Math.max(ja.circleDiameter,Cs):Cs};dh=Np(oe,dh),dh=Np(Be,dh),dh=Np(xe,dh);var Xp=(dh=Np(qe,dh))>-1?1:0;Xp&&(dh*=k/24),Ou.glyphOffsetArray.length>=ar.MAX_GLYPHS&&Ce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),x.sortKey!==void 0&&Ou.addToSortKeyRanges(Ou.symbolInstances.length,x.sortKey),Ou.symbolInstances.emplaceBack(rh.x,rh.y,ni.right>=0?ni.right:-1,ni.center>=0?ni.center:-1,ni.left>=0?ni.left:-1,ni.vertical||-1,Hn,si,di,Yf,zl,zh,Bp,rd,od,Lp,sd,dp,en,An,Ht,Tr,Xp,0,kp,qi,ta,dh)}(Go,pp,Jp,Wo,Jo,kc,th,Go.layers[0],Go.collisionBoxArray,Zs.index,Zs.sourceLayerIndex,Go.index,Zh,ip,_p,xc,Ah,Kh,xp,ph,Zs,Nl,hs,hh,js)};if(Th==="line")for(var qh=0,Ep=Mu(Zs.geometry,0,0,8192,8192);qh<Ep.length;qh+=1)for(var kh=Ep[qh],op=0,sp=nl(kh,np,ap,Wo.vertical||Tf,Jo,24,$h,Go.overscaling,8192);op<sp.length;op+=1){var wh=sp[op];Tf&&Ci(Go,Tf.text,bp,wh)||Dh(kh,wh)}else if(Th==="line-center")for(var Cp=0,Qh=Zs.geometry;Cp<Qh.length;Cp+=1){var Sp=Qh[Cp];if(Sp.length>1){var Ap=bs(Sp,ap,Wo.vertical||Tf,Jo,24,$h);Ap&&Dh(Sp,Ap)}}else if(Zs.type==="Polygon")for(var up=0,lp=Ee(Zs.geometry,0);up<lp.length;up+=1){var Jh=lp[up],cp=Za(Jh,16);Dh(Jh[0],new Ii(cp.x,cp.y,0))}else if(Zs.type==="LineString")for(var Fh=0,ep=Zs.geometry;Fh<ep.length;Fh+=1){var fp=ep[Fh];Dh(fp,new Ii(fp[0].x,fp[0].y,0))}else if(Zs.type==="Point")for(var hp=0,Vp=Zs.geometry;hp<Vp.length;hp+=1)for(var Bh=0,Qp=Vp[hp];Bh<Qp.length;Bh+=1){var Tp=Qp[Bh];Dh([Tp],new Ii(Tp.x,Tp.y,0))}}(e,vn,Fi,Xu,s,be,wi,va,Ni,_c,I)},Yr=0,ln=e.features;Yr<ln.length;Yr+=1)Zr();E&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,r,s,d){var E,I=1/Math.tan(t/2);return e[0]=I/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,d!=null&&d!==1/0?(e[10]=(d+s)*(E=1/(s-d)),e[14]=2*d*s*E):(e[10]=-1,e[14]=-2*s),e},a.pick=function(e,t){for(var r={},s=0;s<t.length;s++){var d=t[s];d in e&&(r[d]=e[d])}return r},a.plugin=pl,a.polygonIntersectsPolygon=Xc,a.postMapLoadEvent=Me,a.postTurnstileEvent=ze,a.potpack=ai,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=zi,a.registerForPluginStateChange=function(e){return e({pluginStatus:Ru,pluginURL:Ac}),Uf.on("pluginStateChange",e),e},a.renderColorRamp=Gf,a.rotate=function(e,t,r){var s=t[0],d=t[1],E=t[2],I=t[3],G=Math.sin(r),se=Math.cos(r);return e[0]=s*se+E*G,e[1]=d*se+I*G,e[2]=s*-G+E*se,e[3]=d*-G+I*se,e},a.rotateX=function(e,t,r){var s=Math.sin(r),d=Math.cos(r),E=t[4],I=t[5],G=t[6],se=t[7],be=t[8],we=t[9],Ze=t[10],ot=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=E*d+be*s,e[5]=I*d+we*s,e[6]=G*d+Ze*s,e[7]=se*d+ot*s,e[8]=be*d-E*s,e[9]=we*d-I*s,e[10]=Ze*d-G*s,e[11]=ot*d-se*s,e},a.rotateZ=function(e,t,r){var s=Math.sin(r),d=Math.cos(r),E=t[0],I=t[1],G=t[2],se=t[3],be=t[4],we=t[5],Ze=t[6],ot=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=E*d+be*s,e[1]=I*d+we*s,e[2]=G*d+Ze*s,e[3]=se*d+ot*s,e[4]=be*d-E*s,e[5]=we*d-I*s,e[6]=Ze*d-G*s,e[7]=ot*d-se*s,e},a.scale=function(e,t,r){var s=r[0],d=r[1],E=r[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*d,e[5]=t[5]*d,e[6]=t[6]*d,e[7]=t[7]*d,e[8]=t[8]*E,e[9]=t[9]*E,e[10]=t[10]*E,e[11]=t[11]*E,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},a.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},a.setCacheLimits=function(e,t){Ue=e,yt=t},a.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Ru==="deferred"||Ru==="loading"||Ru==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ac=jr.resolveURL(e),Ru="deferred",Tl=t,zf(),r||wl()},a.sphericalToCartesian=function(e){var t=e[0],r=e[1],s=e[2];return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(s),y:t*Math.sin(r)*Math.sin(s),z:t*Math.cos(s)}},a.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},a.styleSpec=lt,a.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},a.symbolSize=bo,a.transformMat3=function(e,t,r){var s=t[0],d=t[1],E=t[2];return e[0]=s*r[0]+d*r[3]+E*r[6],e[1]=s*r[1]+d*r[4]+E*r[7],e[2]=s*r[2]+d*r[5]+E*r[8],e},a.transformMat4=Pc,a.translate=function(e,t,r){var s,d,E,I,G,se,be,we,Ze,ot,bt,Qt,tr=r[0],br=r[1],cr=r[2];return t===e?(e[12]=t[0]*tr+t[4]*br+t[8]*cr+t[12],e[13]=t[1]*tr+t[5]*br+t[9]*cr+t[13],e[14]=t[2]*tr+t[6]*br+t[10]*cr+t[14],e[15]=t[3]*tr+t[7]*br+t[11]*cr+t[15]):(d=t[1],E=t[2],I=t[3],G=t[4],se=t[5],be=t[6],we=t[7],Ze=t[8],ot=t[9],bt=t[10],Qt=t[11],e[0]=s=t[0],e[1]=d,e[2]=E,e[3]=I,e[4]=G,e[5]=se,e[6]=be,e[7]=we,e[8]=Ze,e[9]=ot,e[10]=bt,e[11]=Qt,e[12]=s*tr+G*br+Ze*cr+t[12],e[13]=d*tr+se*br+ot*cr+t[13],e[14]=E*tr+be*br+bt*cr+t[14],e[15]=I*tr+we*br+Qt*cr+t[15]),e},a.triggerPluginCompletionEvent=ah,a.uniqueId=vt,a.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=yh,a.validateStyle=df,a.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},a.vectorTile=ct,a.version="1.13.2",a.warnOnce=Ce,a.webpSupported=Ae,a.window=V,a.wrap=at}),Z(["./shared"],function(a){"use strict";function P(ne){var _e=typeof ne;if(_e==="number"||_e==="boolean"||_e==="string"||ne==null)return JSON.stringify(ne);if(Array.isArray(ne)){for(var Oe="[",je=0,dt=ne;je<dt.length;je+=1)Oe+=P(dt[je])+",";return Oe+"]"}for(var Ut=Object.keys(ne).sort(),ur="{",lt=0;lt<Ut.length;lt++)ur+=JSON.stringify(Ut[lt])+":"+P(ne[Ut[lt]])+",";return ur+"}"}function L(ne){for(var _e="",Oe=0,je=a.refProperties;Oe<je.length;Oe+=1)_e+="/"+P(ne[je[Oe]]);return _e}var O=function(ne){this.keyCache={},ne&&this.replace(ne)};O.prototype.replace=function(ne){this._layerConfigs={},this._layers={},this.update(ne,[])},O.prototype.update=function(ne,_e){for(var Oe=this,je=0,dt=ne;je<dt.length;je+=1){var Ut=dt[je];this._layerConfigs[Ut.id]=Ut;var ur=this._layers[Ut.id]=a.createStyleLayer(Ut);ur._featureFilter=a.featureFilter(ur.filter),this.keyCache[Ut.id]&&delete this.keyCache[Ut.id]}for(var lt=0,Nt=_e;lt<Nt.length;lt+=1){var Sr=Nt[lt];delete this.keyCache[Sr],delete this._layerConfigs[Sr],delete this._layers[Sr]}this.familiesBySource={};for(var fn=0,Br=function(Jn,ui){for(var Da={},Yn=0;Yn<Jn.length;Yn++){var wa=ui&&ui[Jn[Yn].id]||L(Jn[Yn]);ui&&(ui[Jn[Yn].id]=wa);var vo=Da[wa];vo||(vo=Da[wa]=[]),vo.push(Jn[Yn])}var Ua=[];for(var Ka in Da)Ua.push(Da[Ka]);return Ua}(a.values(this._layerConfigs),this.keyCache);fn<Br.length;fn+=1){var Jr=Br[fn].map(function(Jn){return Oe._layers[Jn.id]}),Tn=Jr[0];if(Tn.visibility!=="none"){var hi=Tn.source||"",On=this.familiesBySource[hi];On||(On=this.familiesBySource[hi]={});var Pr=Tn.sourceLayer||"_geojsonTileLayer",vi=On[Pr];vi||(vi=On[Pr]=[]),vi.push(Jr)}}};var D=function(ne){var _e={},Oe=[];for(var je in ne){var dt=ne[je],Ut=_e[je]={};for(var ur in dt){var lt=dt[+ur];if(lt&&lt.bitmap.width!==0&&lt.bitmap.height!==0){var Nt={x:0,y:0,w:lt.bitmap.width+2,h:lt.bitmap.height+2};Oe.push(Nt),Ut[ur]={rect:Nt,metrics:lt.metrics}}}}var Sr=a.potpack(Oe),fn=new a.AlphaImage({width:Sr.w||1,height:Sr.h||1});for(var Br in ne){var Jr=ne[Br];for(var Tn in Jr){var hi=Jr[+Tn];if(hi&&hi.bitmap.width!==0&&hi.bitmap.height!==0){var On=_e[Br][Tn].rect;a.AlphaImage.copy(hi.bitmap,fn,{x:0,y:0},{x:On.x+1,y:On.y+1},hi.bitmap)}}}this.image=fn,this.positions=_e};a.register("GlyphAtlas",D);var B=function(ne){this.tileID=new a.OverscaledTileID(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.uid=ne.uid,this.zoom=ne.zoom,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.returnDependencies=!!ne.returnDependencies,this.promoteId=ne.promoteId};function V(ne,_e,Oe){for(var je=new a.EvaluationParameters(_e),dt=0,Ut=ne;dt<Ut.length;dt+=1)Ut[dt].recalculate(je,Oe)}function N(ne,_e){var Oe=a.getArrayBuffer(ne.request,function(je,dt,Ut,ur){je?_e(je):dt&&_e(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(dt)),rawData:dt,cacheControl:Ut,expires:ur})});return function(){Oe.cancel(),_e()}}B.prototype.parse=function(ne,_e,Oe,je,dt){var Ut=this;this.status="parsing",this.data=ne,this.collisionBoxArray=new a.CollisionBoxArray;var ur=new a.DictionaryCoder(Object.keys(ne.layers).sort()),lt=new a.FeatureIndex(this.tileID,this.promoteId);lt.bucketLayerIDs=[];var Nt,Sr,fn,Br,Jr={},Tn={featureIndex:lt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Oe},hi=_e.familiesBySource[this.source];for(var On in hi){var Pr=ne.layers[On];if(Pr){Pr.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+On+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var vi=ur.encode(On),Jn=[],ui=0;ui<Pr.length;ui++){var Da=Pr.feature(ui),Yn=lt.getId(Da,On);Jn.push({feature:Da,id:Yn,index:ui,sourceLayerIndex:vi})}for(var wa=0,vo=hi[On];wa<vo.length;wa+=1){var Ua=vo[wa],Ka=Ua[0];Ka.minzoom&&this.zoom<Math.floor(Ka.minzoom)||Ka.maxzoom&&this.zoom>=Ka.maxzoom||Ka.visibility!=="none"&&(V(Ua,this.zoom,Oe),(Jr[Ka.id]=Ka.createBucket({index:lt.bucketLayerIDs.length,layers:Ua,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vi,sourceID:this.source})).populate(Jn,Tn,this.tileID.canonical),lt.bucketLayerIDs.push(Ua.map(function(Rn){return Rn.id})))}}}var Ga=a.mapObject(Tn.glyphDependencies,function(Rn){return Object.keys(Rn).map(Number)});Object.keys(Ga).length?je.send("getGlyphs",{uid:this.uid,stacks:Ga},function(Rn,qa){Nt||(Nt=Rn,Sr=qa,ra.call(Ut))}):Sr={};var ei=Object.keys(Tn.iconDependencies);ei.length?je.send("getImages",{icons:ei,source:this.source,tileID:this.tileID,type:"icons"},function(Rn,qa){Nt||(Nt=Rn,fn=qa,ra.call(Ut))}):fn={};var eo=Object.keys(Tn.patternDependencies);function ra(){if(Nt)return dt(Nt);if(Sr&&fn&&Br){var Rn=new D(Sr),qa=new a.ImageAtlas(fn,Br);for(var ba in Jr){var Na=Jr[ba];Na instanceof a.SymbolBucket?(V(Na.layers,this.zoom,Oe),a.performSymbolLayout(Na,Sr,Rn.positions,fn,qa.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Na.hasPattern&&(Na instanceof a.LineBucket||Na instanceof a.FillBucket||Na instanceof a.FillExtrusionBucket)&&(V(Na.layers,this.zoom,Oe),Na.addFeatures(Tn,this.tileID.canonical,qa.patternPositions))}this.status="done",dt(null,{buckets:a.values(Jr).filter(function(wo){return!wo.isEmpty()}),featureIndex:lt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rn.image,imageAtlas:qa,glyphMap:this.returnDependencies?Sr:null,iconMap:this.returnDependencies?fn:null,glyphPositions:this.returnDependencies?Rn.positions:null})}}eo.length?je.send("getImages",{icons:eo,source:this.source,tileID:this.tileID,type:"patterns"},function(Rn,qa){Nt||(Nt=Rn,Br=qa,ra.call(Ut))}):Br={},ra.call(this)};var Y=function(ne,_e,Oe,je){this.actor=ne,this.layerIndex=_e,this.availableImages=Oe,this.loadVectorData=je||N,this.loading={},this.loaded={}};Y.prototype.loadTile=function(ne,_e){var Oe=this,je=ne.uid;this.loading||(this.loading={});var dt=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new a.RequestPerformance(ne.request),Ut=this.loading[je]=new B(ne);Ut.abort=this.loadVectorData(ne,function(ur,lt){if(delete Oe.loading[je],ur||!lt)return Ut.status="done",Oe.loaded[je]=Ut,_e(ur);var Nt=lt.rawData,Sr={};lt.expires&&(Sr.expires=lt.expires),lt.cacheControl&&(Sr.cacheControl=lt.cacheControl);var fn={};if(dt){var Br=dt.finish();Br&&(fn.resourceTiming=JSON.parse(JSON.stringify(Br)))}Ut.vectorTile=lt.vectorTile,Ut.parse(lt.vectorTile,Oe.layerIndex,Oe.availableImages,Oe.actor,function(Jr,Tn){if(Jr||!Tn)return _e(Jr);_e(null,a.extend({rawTileData:Nt.slice(0)},Tn,Sr,fn))}),Oe.loaded=Oe.loaded||{},Oe.loaded[je]=Ut})},Y.prototype.reloadTile=function(ne,_e){var Oe=this,je=this.loaded,dt=ne.uid,Ut=this;if(je&&je[dt]){var ur=je[dt];ur.showCollisionBoxes=ne.showCollisionBoxes;var lt=function(Nt,Sr){var fn=ur.reloadCallback;fn&&(delete ur.reloadCallback,ur.parse(ur.vectorTile,Ut.layerIndex,Oe.availableImages,Ut.actor,fn)),_e(Nt,Sr)};ur.status==="parsing"?ur.reloadCallback=lt:ur.status==="done"&&(ur.vectorTile?ur.parse(ur.vectorTile,this.layerIndex,this.availableImages,this.actor,lt):lt())}},Y.prototype.abortTile=function(ne,_e){var Oe=this.loading,je=ne.uid;Oe&&Oe[je]&&Oe[je].abort&&(Oe[je].abort(),delete Oe[je]),_e()},Y.prototype.removeTile=function(ne,_e){var Oe=this.loaded,je=ne.uid;Oe&&Oe[je]&&delete Oe[je],_e()};var H=a.window.ImageBitmap,ce=function(){this.loaded={}};function at(ne,_e){if(ne.length!==0){rt(ne[0],_e);for(var Oe=1;Oe<ne.length;Oe++)rt(ne[Oe],!_e)}}function rt(ne,_e){for(var Oe=0,je=0,dt=ne.length,Ut=dt-1;je<dt;Ut=je++)Oe+=(ne[je][0]-ne[Ut][0])*(ne[Ut][1]+ne[je][1]);Oe>=0!=!!_e&&ne.reverse()}ce.prototype.loadTile=function(ne,_e){var Oe=ne.uid,je=ne.encoding,dt=ne.rawImageData,Ut=H&&dt instanceof H?this.getImageData(dt):dt,ur=new a.DEMData(Oe,Ut,je);this.loaded=this.loaded||{},this.loaded[Oe]=ur,_e(null,ur)},ce.prototype.getImageData=function(ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);var _e=this.offscreenCanvasContext.getImageData(-1,-1,ne.width+2,ne.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:_e.width,height:_e.height},_e.data)},ce.prototype.removeTile=function(ne){var _e=this.loaded,Oe=ne.uid;_e&&_e[Oe]&&delete _e[Oe]};var Re=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,vt=function(ne){this._feature=ne,this.extent=a.EXTENT,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))};vt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var ne=[],_e=0,Oe=this._feature.geometry;_e<Oe.length;_e+=1){var je=Oe[_e];ne.push([new a.Point$1(je[0],je[1])])}return ne}for(var dt=[],Ut=0,ur=this._feature.geometry;Ut<ur.length;Ut+=1){for(var lt=[],Nt=0,Sr=ur[Ut];Nt<Sr.length;Nt+=1){var fn=Sr[Nt];lt.push(new a.Point$1(fn[0],fn[1]))}dt.push(lt)}return dt},vt.prototype.toGeoJSON=function(ne,_e,Oe){return Re.call(this,ne,_e,Oe)};var wt=function(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=ne.length,this._features=ne};wt.prototype.feature=function(ne){return new vt(this._features[ne])};var fe=a.vectorTile.VectorTileFeature,$e=re;function re(ne,_e){this.options=_e||{},this.features=ne,this.length=ne.length}function Ge(ne,_e){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=_e||4096}re.prototype.feature=function(ne){return new Ge(this.features[ne],this.options.extent)},Ge.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var _e=0;_e<ne.length;_e++){for(var Oe=ne[_e],je=[],dt=0;dt<Oe.length;dt++)je.push(new a.Point$1(Oe[dt][0],Oe[dt][1]));this.geometry.push(je)}return this.geometry},Ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,_e=1/0,Oe=-1/0,je=1/0,dt=-1/0,Ut=0;Ut<ne.length;Ut++)for(var ur=ne[Ut],lt=0;lt<ur.length;lt++){var Nt=ur[lt];_e=Math.min(_e,Nt.x),Oe=Math.max(Oe,Nt.x),je=Math.min(je,Nt.y),dt=Math.max(dt,Nt.y)}return[_e,je,Oe,dt]},Ge.prototype.toGeoJSON=fe.prototype.toGeoJSON;var Qe=Le,Te=$e;function Le(ne){var _e=new a.pbf;return function(Oe,je){for(var dt in Oe.layers)je.writeMessage(3,Ce,Oe.layers[dt])}(ne,_e),_e.finish()}function Ce(ne,_e){var Oe;_e.writeVarintField(15,ne.version||1),_e.writeStringField(1,ne.name||""),_e.writeVarintField(5,ne.extent||4096);var je={keys:[],values:[],keycache:{},valuecache:{}};for(Oe=0;Oe<ne.length;Oe++)je.feature=ne.feature(Oe),_e.writeMessage(2,Fe,je);var dt=je.keys;for(Oe=0;Oe<dt.length;Oe++)_e.writeStringField(3,dt[Oe]);var Ut=je.values;for(Oe=0;Oe<Ut.length;Oe++)_e.writeMessage(4,Ne,Ut[Oe])}function Fe(ne,_e){var Oe=ne.feature;Oe.id!==void 0&&_e.writeVarintField(1,Oe.id),_e.writeMessage(2,Ke,ne),_e.writeVarintField(3,Oe.type),_e.writeMessage(4,Pe,Oe)}function Ke(ne,_e){var Oe=ne.feature,je=ne.keys,dt=ne.values,Ut=ne.keycache,ur=ne.valuecache;for(var lt in Oe.properties){var Nt=Ut[lt];Nt===void 0&&(je.push(lt),Ut[lt]=Nt=je.length-1),_e.writeVarint(Nt);var Sr=Oe.properties[lt],fn=typeof Sr;fn!=="string"&&fn!=="boolean"&&fn!=="number"&&(Sr=JSON.stringify(Sr));var Br=fn+":"+Sr,Jr=ur[Br];Jr===void 0&&(dt.push(Sr),ur[Br]=Jr=dt.length-1),_e.writeVarint(Jr)}}function qt(ne,_e){return(_e<<3)+(7&ne)}function ir(ne){return ne<<1^ne>>31}function Pe(ne,_e){for(var Oe=ne.loadGeometry(),je=ne.type,dt=0,Ut=0,ur=Oe.length,lt=0;lt<ur;lt++){var Nt=Oe[lt],Sr=1;je===1&&(Sr=Nt.length),_e.writeVarint(qt(1,Sr));for(var fn=je===3?Nt.length-1:Nt.length,Br=0;Br<fn;Br++){Br===1&&je!==1&&_e.writeVarint(qt(2,fn-1));var Jr=Nt[Br].x-dt,Tn=Nt[Br].y-Ut;_e.writeVarint(ir(Jr)),_e.writeVarint(ir(Tn)),dt+=Jr,Ut+=Tn}je===3&&_e.writeVarint(qt(7,1))}}function Ne(ne,_e){var Oe=typeof ne;Oe==="string"?_e.writeStringField(1,ne):Oe==="boolean"?_e.writeBooleanField(7,ne):Oe==="number"&&(ne%1!=0?_e.writeDoubleField(3,ne):ne<0?_e.writeSVarintField(6,ne):_e.writeVarintField(5,ne))}function Xe(ne,_e,Oe,je){kt(ne,Oe,je),kt(_e,2*Oe,2*je),kt(_e,2*Oe+1,2*je+1)}function kt(ne,_e,Oe){var je=ne[_e];ne[_e]=ne[Oe],ne[Oe]=je}function rr(ne,_e,Oe,je){var dt=ne-Oe,Ut=_e-je;return dt*dt+Ut*Ut}Qe.fromVectorTileJs=Le,Qe.fromGeojsonVt=function(ne,_e){_e=_e||{};var Oe={};for(var je in ne)Oe[je]=new $e(ne[je].features,_e),Oe[je].name=je,Oe[je].version=_e.version,Oe[je].extent=_e.extent;return Le({layers:Oe})},Qe.GeoJSONWrapper=Te;var me=function(ne){return ne[0]},et=function(ne){return ne[1]},or=function(ne,_e,Oe,je,dt){_e===void 0&&(_e=me),Oe===void 0&&(Oe=et),je===void 0&&(je=64),dt===void 0&&(dt=Float64Array),this.nodeSize=je,this.points=ne;for(var Ut=ne.length<65536?Uint16Array:Uint32Array,ur=this.ids=new Ut(ne.length),lt=this.coords=new dt(2*ne.length),Nt=0;Nt<ne.length;Nt++)ur[Nt]=Nt,lt[2*Nt]=_e(ne[Nt]),lt[2*Nt+1]=Oe(ne[Nt]);(function Sr(fn,Br,Jr,Tn,hi,On){if(!(hi-Tn<=Jr)){var Pr=Tn+hi>>1;(function vi(Jn,ui,Da,Yn,wa,vo){for(;wa>Yn;){if(wa-Yn>600){var Ua=wa-Yn+1,Ka=Da-Yn+1,Ga=Math.log(Ua),ei=.5*Math.exp(2*Ga/3),eo=.5*Math.sqrt(Ga*ei*(Ua-ei)/Ua)*(Ka-Ua/2<0?-1:1);vi(Jn,ui,Da,Math.max(Yn,Math.floor(Da-Ka*ei/Ua+eo)),Math.min(wa,Math.floor(Da+(Ua-Ka)*ei/Ua+eo)),vo)}var ra=ui[2*Da+vo],Rn=Yn,qa=wa;for(Xe(Jn,ui,Yn,Da),ui[2*wa+vo]>ra&&Xe(Jn,ui,Yn,wa);Rn<qa;){for(Xe(Jn,ui,Rn,qa),Rn++,qa--;ui[2*Rn+vo]<ra;)Rn++;for(;ui[2*qa+vo]>ra;)qa--}ui[2*Yn+vo]===ra?Xe(Jn,ui,Yn,qa):Xe(Jn,ui,++qa,wa),qa<=Da&&(Yn=qa+1),Da<=qa&&(wa=qa-1)}})(fn,Br,Pr,Tn,hi,On%2),Sr(fn,Br,Jr,Tn,Pr-1,On+1),Sr(fn,Br,Jr,Pr+1,hi,On+1)}})(ur,lt,je,0,ur.length-1,0)};or.prototype.range=function(ne,_e,Oe,je){return function(dt,Ut,ur,lt,Nt,Sr,fn){for(var Br,Jr,Tn=[0,dt.length-1,0],hi=[];Tn.length;){var On=Tn.pop(),Pr=Tn.pop(),vi=Tn.pop();if(Pr-vi<=fn)for(var Jn=vi;Jn<=Pr;Jn++)Jr=Ut[2*Jn+1],(Br=Ut[2*Jn])>=ur&&Br<=Nt&&Jr>=lt&&Jr<=Sr&&hi.push(dt[Jn]);else{var ui=Math.floor((vi+Pr)/2);Jr=Ut[2*ui+1],(Br=Ut[2*ui])>=ur&&Br<=Nt&&Jr>=lt&&Jr<=Sr&&hi.push(dt[ui]);var Da=(On+1)%2;(On===0?ur<=Br:lt<=Jr)&&(Tn.push(vi),Tn.push(ui-1),Tn.push(Da)),(On===0?Nt>=Br:Sr>=Jr)&&(Tn.push(ui+1),Tn.push(Pr),Tn.push(Da))}}return hi}(this.ids,this.coords,ne,_e,Oe,je,this.nodeSize)},or.prototype.within=function(ne,_e,Oe){return function(je,dt,Ut,ur,lt,Nt){for(var Sr=[0,je.length-1,0],fn=[],Br=lt*lt;Sr.length;){var Jr=Sr.pop(),Tn=Sr.pop(),hi=Sr.pop();if(Tn-hi<=Nt)for(var On=hi;On<=Tn;On++)rr(dt[2*On],dt[2*On+1],Ut,ur)<=Br&&fn.push(je[On]);else{var Pr=Math.floor((hi+Tn)/2),vi=dt[2*Pr],Jn=dt[2*Pr+1];rr(vi,Jn,Ut,ur)<=Br&&fn.push(je[Pr]);var ui=(Jr+1)%2;(Jr===0?Ut-lt<=vi:ur-lt<=Jn)&&(Sr.push(hi),Sr.push(Pr-1),Sr.push(ui)),(Jr===0?Ut+lt>=vi:ur+lt>=Jn)&&(Sr.push(Pr+1),Sr.push(Tn),Sr.push(ui))}}return fn}(this.ids,this.coords,ne,_e,Oe,this.nodeSize)};var on={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ne){return ne}},vr=function(ne){this.options=mt(Object.create(on),ne),this.trees=new Array(this.options.maxZoom+1)};function jr(ne,_e,Oe,je,dt){return{x:ne,y:_e,zoom:1/0,id:Oe,parentId:-1,numPoints:je,properties:dt}}function xr(ne,_e){var Oe=ne.geometry.coordinates,je=Oe[1];return{x:ke(Oe[0]),y:Bt(je),zoom:1/0,index:_e,parentId:-1}}function Ae(ne){return{type:"Feature",id:ne.id,properties:De(ne),geometry:{type:"Point",coordinates:[(je=ne.x,360*(je-.5)),(_e=ne.y,Oe=(180-360*_e)*Math.PI/180,360*Math.atan(Math.exp(Oe))/Math.PI-90)]}};var _e,Oe,je}function De(ne){var _e=ne.numPoints,Oe=_e>=1e4?Math.round(_e/1e3)+"k":_e>=1e3?Math.round(_e/100)/10+"k":_e;return mt(mt({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:_e,point_count_abbreviated:Oe})}function ke(ne){return ne/360+.5}function Bt(ne){var _e=Math.sin(ne*Math.PI/180),Oe=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return Oe<0?0:Oe>1?1:Oe}function mt(ne,_e){for(var Oe in _e)ne[Oe]=_e[Oe];return ne}function Mr(ne){return ne.x}function Cr(ne){return ne.y}function Nr(ne,_e,Oe,je,dt,Ut){var ur=dt-Oe,lt=Ut-je;if(ur!==0||lt!==0){var Nt=((ne-Oe)*ur+(_e-je)*lt)/(ur*ur+lt*lt);Nt>1?(Oe=dt,je=Ut):Nt>0&&(Oe+=ur*Nt,je+=lt*Nt)}return(ur=ne-Oe)*ur+(lt=_e-je)*lt}function nt(ne,_e,Oe,je){var dt={id:ne===void 0?null:ne,type:_e,geometry:Oe,tags:je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ut){var ur=Ut.geometry,lt=Ut.type;if(lt==="Point"||lt==="MultiPoint"||lt==="LineString")Ye(Ut,ur);else if(lt==="Polygon"||lt==="MultiLineString")for(var Nt=0;Nt<ur.length;Nt++)Ye(Ut,ur[Nt]);else if(lt==="MultiPolygon")for(Nt=0;Nt<ur.length;Nt++)for(var Sr=0;Sr<ur[Nt].length;Sr++)Ye(Ut,ur[Nt][Sr])}(dt),dt}function Ye(ne,_e){for(var Oe=0;Oe<_e.length;Oe+=3)ne.minX=Math.min(ne.minX,_e[Oe]),ne.minY=Math.min(ne.minY,_e[Oe+1]),ne.maxX=Math.max(ne.maxX,_e[Oe]),ne.maxY=Math.max(ne.maxY,_e[Oe+1])}function M(ne,_e,Oe,je){if(_e.geometry){var dt=_e.geometry.coordinates,Ut=_e.geometry.type,ur=Math.pow(Oe.tolerance/((1<<Oe.maxZoom)*Oe.extent),2),lt=[],Nt=_e.id;if(Oe.promoteId?Nt=_e.properties[Oe.promoteId]:Oe.generateId&&(Nt=je||0),Ut==="Point")W(dt,lt);else if(Ut==="MultiPoint")for(var Sr=0;Sr<dt.length;Sr++)W(dt[Sr],lt);else if(Ut==="LineString")ue(dt,lt,ur,!1);else if(Ut==="MultiLineString"){if(Oe.lineMetrics){for(Sr=0;Sr<dt.length;Sr++)ue(dt[Sr],lt=[],ur,!1),ne.push(nt(Nt,"LineString",lt,_e.properties));return}X(dt,lt,ur,!1)}else if(Ut==="Polygon")X(dt,lt,ur,!0);else{if(Ut!=="MultiPolygon"){if(Ut==="GeometryCollection"){for(Sr=0;Sr<_e.geometry.geometries.length;Sr++)M(ne,{id:Nt,geometry:_e.geometry.geometries[Sr],properties:_e.properties},Oe,je);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Sr=0;Sr<dt.length;Sr++){var fn=[];X(dt[Sr],fn,ur,!0),lt.push(fn)}}ne.push(nt(Nt,Ut,lt,_e.properties))}}function W(ne,_e){_e.push(ie(ne[0])),_e.push(ye(ne[1])),_e.push(0)}function ue(ne,_e,Oe,je){for(var dt,Ut,ur=0,lt=0;lt<ne.length;lt++){var Nt=ie(ne[lt][0]),Sr=ye(ne[lt][1]);_e.push(Nt),_e.push(Sr),_e.push(0),lt>0&&(ur+=je?(dt*Sr-Nt*Ut)/2:Math.sqrt(Math.pow(Nt-dt,2)+Math.pow(Sr-Ut,2))),dt=Nt,Ut=Sr}var fn=_e.length-3;_e[2]=1,function Br(Jr,Tn,hi,On){for(var Pr,vi=On,Jn=hi-Tn>>1,ui=hi-Tn,Da=Jr[Tn],Yn=Jr[Tn+1],wa=Jr[hi],vo=Jr[hi+1],Ua=Tn+3;Ua<hi;Ua+=3){var Ka=Nr(Jr[Ua],Jr[Ua+1],Da,Yn,wa,vo);if(Ka>vi)Pr=Ua,vi=Ka;else if(Ka===vi){var Ga=Math.abs(Ua-Jn);Ga<ui&&(Pr=Ua,ui=Ga)}}vi>On&&(Pr-Tn>3&&Br(Jr,Tn,Pr,On),Jr[Pr+2]=vi,hi-Pr>3&&Br(Jr,Pr,hi,On))}(_e,0,fn,Oe),_e[fn+2]=1,_e.size=Math.abs(ur),_e.start=0,_e.end=_e.size}function X(ne,_e,Oe,je){for(var dt=0;dt<ne.length;dt++){var Ut=[];ue(ne[dt],Ut,Oe,je),_e.push(Ut)}}function ie(ne){return ne/360+.5}function ye(ne){var _e=Math.sin(ne*Math.PI/180),Oe=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return Oe<0?0:Oe>1?1:Oe}function J(ne,_e,Oe,je,dt,Ut,ur,lt){if(je/=_e,Ut>=(Oe/=_e)&&ur<je)return ne;if(ur<Oe||Ut>=je)return null;for(var Nt=[],Sr=0;Sr<ne.length;Sr++){var fn=ne[Sr],Br=fn.geometry,Jr=fn.type,Tn=dt===0?fn.minX:fn.minY,hi=dt===0?fn.maxX:fn.maxY;if(Tn>=Oe&&hi<je)Nt.push(fn);else if(!(hi<Oe||Tn>=je)){var On=[];if(Jr==="Point"||Jr==="MultiPoint")ht(Br,On,Oe,je,dt);else if(Jr==="LineString")ze(Br,On,Oe,je,dt,!1,lt.lineMetrics);else if(Jr==="MultiLineString")Me(Br,On,Oe,je,dt,!1);else if(Jr==="Polygon")Me(Br,On,Oe,je,dt,!0);else if(Jr==="MultiPolygon")for(var Pr=0;Pr<Br.length;Pr++){var vi=[];Me(Br[Pr],vi,Oe,je,dt,!0),vi.length&&On.push(vi)}if(On.length){if(lt.lineMetrics&&Jr==="LineString"){for(Pr=0;Pr<On.length;Pr++)Nt.push(nt(fn.id,Jr,On[Pr],fn.tags));continue}Jr!=="LineString"&&Jr!=="MultiLineString"||(On.length===1?(Jr="LineString",On=On[0]):Jr="MultiLineString"),Jr!=="Point"&&Jr!=="MultiPoint"||(Jr=On.length===3?"Point":"MultiPoint"),Nt.push(nt(fn.id,Jr,On,fn.tags))}}}return Nt.length?Nt:null}function ht(ne,_e,Oe,je,dt){for(var Ut=0;Ut<ne.length;Ut+=3){var ur=ne[Ut+dt];ur>=Oe&&ur<=je&&(_e.push(ne[Ut]),_e.push(ne[Ut+1]),_e.push(ne[Ut+2]))}}function ze(ne,_e,Oe,je,dt,Ut,ur){for(var lt,Nt,Sr=pt(ne),fn=dt===0?yt:gt,Br=ne.start,Jr=0;Jr<ne.length-3;Jr+=3){var Tn=ne[Jr],hi=ne[Jr+1],On=ne[Jr+2],Pr=ne[Jr+3],vi=ne[Jr+4],Jn=dt===0?Tn:hi,ui=dt===0?Pr:vi,Da=!1;ur&&(lt=Math.sqrt(Math.pow(Tn-Pr,2)+Math.pow(hi-vi,2))),Jn<Oe?ui>Oe&&(Nt=fn(Sr,Tn,hi,Pr,vi,Oe),ur&&(Sr.start=Br+lt*Nt)):Jn>je?ui<je&&(Nt=fn(Sr,Tn,hi,Pr,vi,je),ur&&(Sr.start=Br+lt*Nt)):Ue(Sr,Tn,hi,On),ui<Oe&&Jn>=Oe&&(Nt=fn(Sr,Tn,hi,Pr,vi,Oe),Da=!0),ui>je&&Jn<=je&&(Nt=fn(Sr,Tn,hi,Pr,vi,je),Da=!0),!Ut&&Da&&(ur&&(Sr.end=Br+lt*Nt),_e.push(Sr),Sr=pt(ne)),ur&&(Br+=lt)}var Yn=ne.length-3;Tn=ne[Yn],hi=ne[Yn+1],On=ne[Yn+2],(Jn=dt===0?Tn:hi)>=Oe&&Jn<=je&&Ue(Sr,Tn,hi,On),Yn=Sr.length-3,Ut&&Yn>=3&&(Sr[Yn]!==Sr[0]||Sr[Yn+1]!==Sr[1])&&Ue(Sr,Sr[0],Sr[1],Sr[2]),Sr.length&&_e.push(Sr)}function pt(ne){var _e=[];return _e.size=ne.size,_e.start=ne.start,_e.end=ne.end,_e}function Me(ne,_e,Oe,je,dt,Ut){for(var ur=0;ur<ne.length;ur++)ze(ne[ur],_e,Oe,je,dt,Ut,!1)}function Ue(ne,_e,Oe,je){ne.push(_e),ne.push(Oe),ne.push(je)}function yt(ne,_e,Oe,je,dt,Ut){var ur=(Ut-_e)/(je-_e);return ne.push(Ut),ne.push(Oe+(dt-Oe)*ur),ne.push(1),ur}function gt(ne,_e,Oe,je,dt,Ut){var ur=(Ut-Oe)/(dt-Oe);return ne.push(_e+(je-_e)*ur),ne.push(Ut),ne.push(1),ur}function nr(ne,_e){for(var Oe=[],je=0;je<ne.length;je++){var dt,Ut=ne[je],ur=Ut.type;if(ur==="Point"||ur==="MultiPoint"||ur==="LineString")dt=pe(Ut.geometry,_e);else if(ur==="MultiLineString"||ur==="Polygon"){dt=[];for(var lt=0;lt<Ut.geometry.length;lt++)dt.push(pe(Ut.geometry[lt],_e))}else if(ur==="MultiPolygon")for(dt=[],lt=0;lt<Ut.geometry.length;lt++){for(var Nt=[],Sr=0;Sr<Ut.geometry[lt].length;Sr++)Nt.push(pe(Ut.geometry[lt][Sr],_e));dt.push(Nt)}Oe.push(nt(Ut.id,ur,dt,Ut.tags))}return Oe}function pe(ne,_e){var Oe=[];Oe.size=ne.size,ne.start!==void 0&&(Oe.start=ne.start,Oe.end=ne.end);for(var je=0;je<ne.length;je+=3)Oe.push(ne[je]+_e,ne[je+1],ne[je+2]);return Oe}function lr(ne,_e){if(ne.transformed)return ne;var Oe,je,dt,Ut=1<<ne.z,ur=ne.x,lt=ne.y;for(Oe=0;Oe<ne.features.length;Oe++){var Nt=ne.features[Oe],Sr=Nt.geometry,fn=Nt.type;if(Nt.geometry=[],fn===1)for(je=0;je<Sr.length;je+=2)Nt.geometry.push(Ur(Sr[je],Sr[je+1],_e,Ut,ur,lt));else for(je=0;je<Sr.length;je++){var Br=[];for(dt=0;dt<Sr[je].length;dt+=2)Br.push(Ur(Sr[je][dt],Sr[je][dt+1],_e,Ut,ur,lt));Nt.geometry.push(Br)}}return ne.transformed=!0,ne}function Ur(ne,_e,Oe,je,dt,Ut){return[Math.round(Oe*(ne*je-dt)),Math.round(Oe*(_e*je-Ut))]}function Hr(ne,_e,Oe,je,dt){for(var Ut=_e===dt.maxZoom?0:dt.tolerance/((1<<_e)*dt.extent),ur={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Oe,y:je,z:_e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},lt=0;lt<ne.length;lt++){ur.numFeatures++,un(ur,ne[lt],Ut,dt);var Nt=ne[lt].minX,Sr=ne[lt].minY,fn=ne[lt].maxX,Br=ne[lt].maxY;Nt<ur.minX&&(ur.minX=Nt),Sr<ur.minY&&(ur.minY=Sr),fn>ur.maxX&&(ur.maxX=fn),Br>ur.maxY&&(ur.maxY=Br)}return ur}function un(ne,_e,Oe,je){var dt=_e.geometry,Ut=_e.type,ur=[];if(Ut==="Point"||Ut==="MultiPoint")for(var lt=0;lt<dt.length;lt+=3)ur.push(dt[lt]),ur.push(dt[lt+1]),ne.numPoints++,ne.numSimplified++;else if(Ut==="LineString")bn(ur,dt,ne,Oe,!1,!1);else if(Ut==="MultiLineString"||Ut==="Polygon")for(lt=0;lt<dt.length;lt++)bn(ur,dt[lt],ne,Oe,Ut==="Polygon",lt===0);else if(Ut==="MultiPolygon")for(var Nt=0;Nt<dt.length;Nt++){var Sr=dt[Nt];for(lt=0;lt<Sr.length;lt++)bn(ur,Sr[lt],ne,Oe,!0,lt===0)}if(ur.length){var fn=_e.tags||null;if(Ut==="LineString"&&je.lineMetrics){for(var Br in fn={},_e.tags)fn[Br]=_e.tags[Br];fn.mapbox_clip_start=dt.start/dt.size,fn.mapbox_clip_end=dt.end/dt.size}var Jr={geometry:ur,type:Ut==="Polygon"||Ut==="MultiPolygon"?3:Ut==="LineString"||Ut==="MultiLineString"?2:1,tags:fn};_e.id!==null&&(Jr.id=_e.id),ne.features.push(Jr)}}function bn(ne,_e,Oe,je,dt,Ut){var ur=je*je;if(je>0&&_e.size<(dt?ur:je))Oe.numPoints+=_e.length/3;else{for(var lt=[],Nt=0;Nt<_e.length;Nt+=3)(je===0||_e[Nt+2]>ur)&&(Oe.numSimplified++,lt.push(_e[Nt]),lt.push(_e[Nt+1])),Oe.numPoints++;dt&&function(Sr,fn){for(var Br=0,Jr=0,Tn=Sr.length,hi=Tn-2;Jr<Tn;hi=Jr,Jr+=2)Br+=(Sr[Jr]-Sr[hi])*(Sr[Jr+1]+Sr[hi+1]);if(Br>0===fn)for(Jr=0,Tn=Sr.length;Jr<Tn/2;Jr+=2){var On=Sr[Jr],Pr=Sr[Jr+1];Sr[Jr]=Sr[Tn-2-Jr],Sr[Jr+1]=Sr[Tn-1-Jr],Sr[Tn-2-Jr]=On,Sr[Tn-1-Jr]=Pr}}(lt,Ut),ne.push(lt)}}function Gn(ne,_e){var Oe=(_e=this.options=function(dt,Ut){for(var ur in Ut)dt[ur]=Ut[ur];return dt}(Object.create(this.options),_e)).debug;if(Oe&&console.time("preprocess data"),_e.maxZoom<0||_e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(_e.promoteId&&_e.generateId)throw new Error("promoteId and generateId cannot be used together.");var je=function(dt,Ut){var ur=[];if(dt.type==="FeatureCollection")for(var lt=0;lt<dt.features.length;lt++)M(ur,dt.features[lt],Ut,lt);else M(ur,dt.type==="Feature"?dt:{geometry:dt},Ut);return ur}(ne,_e);this.tiles={},this.tileCoords=[],Oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",_e.indexMaxZoom,_e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(je=function(dt,Ut){var ur=Ut.buffer/Ut.extent,lt=dt,Nt=J(dt,1,-1-ur,ur,0,-1,2,Ut),Sr=J(dt,1,1-ur,2+ur,0,-1,2,Ut);return(Nt||Sr)&&(lt=J(dt,1,-ur,1+ur,0,-1,2,Ut)||[],Nt&&(lt=nr(Nt,1).concat(lt)),Sr&&(lt=lt.concat(nr(Sr,-1)))),lt}(je,_e)).length&&this.splitTile(je,0,0,0),Oe&&(je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function li(ne,_e,Oe){return 32*((1<<ne)*Oe+_e)+ne}function $r(ne,_e){var Oe=ne.tileID.canonical;if(!this._geoJSONIndex)return _e(null,null);var je=this._geoJSONIndex.getTile(Oe.z,Oe.x,Oe.y);if(!je)return _e(null,null);var dt=new wt(je.features),Ut=Qe(dt);Ut.byteOffset===0&&Ut.byteLength===Ut.buffer.byteLength||(Ut=new Uint8Array(Ut)),_e(null,{vectorTile:dt,rawData:Ut.buffer})}vr.prototype.load=function(ne){var _e=this.options,Oe=_e.log,je=_e.minZoom,dt=_e.maxZoom,Ut=_e.nodeSize;Oe&&console.time("total time");var ur="prepare "+ne.length+" points";Oe&&console.time(ur),this.points=ne;for(var lt=[],Nt=0;Nt<ne.length;Nt++)ne[Nt].geometry&&lt.push(xr(ne[Nt],Nt));this.trees[dt+1]=new or(lt,Mr,Cr,Ut,Float32Array),Oe&&console.timeEnd(ur);for(var Sr=dt;Sr>=je;Sr--){var fn=+Date.now();lt=this._cluster(lt,Sr),this.trees[Sr]=new or(lt,Mr,Cr,Ut,Float32Array),Oe&&console.log("z%d: %d clusters in %dms",Sr,lt.length,+Date.now()-fn)}return Oe&&console.timeEnd("total time"),this},vr.prototype.getClusters=function(ne,_e){var Oe=((ne[0]+180)%360+360)%360-180,je=Math.max(-90,Math.min(90,ne[1])),dt=ne[2]===180?180:((ne[2]+180)%360+360)%360-180,Ut=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)Oe=-180,dt=180;else if(Oe>dt){var ur=this.getClusters([Oe,je,180,Ut],_e),lt=this.getClusters([-180,je,dt,Ut],_e);return ur.concat(lt)}for(var Nt=this.trees[this._limitZoom(_e)],Sr=[],fn=0,Br=Nt.range(ke(Oe),Bt(Ut),ke(dt),Bt(je));fn<Br.length;fn+=1){var Jr=Nt.points[Br[fn]];Sr.push(Jr.numPoints?Ae(Jr):this.points[Jr.index])}return Sr},vr.prototype.getChildren=function(ne){var _e=this._getOriginId(ne),Oe=this._getOriginZoom(ne),je="No cluster with the specified id.",dt=this.trees[Oe];if(!dt)throw new Error(je);var Ut=dt.points[_e];if(!Ut)throw new Error(je);for(var ur=this.options.radius/(this.options.extent*Math.pow(2,Oe-1)),lt=[],Nt=0,Sr=dt.within(Ut.x,Ut.y,ur);Nt<Sr.length;Nt+=1){var fn=dt.points[Sr[Nt]];fn.parentId===ne&&lt.push(fn.numPoints?Ae(fn):this.points[fn.index])}if(lt.length===0)throw new Error(je);return lt},vr.prototype.getLeaves=function(ne,_e,Oe){var je=[];return this._appendLeaves(je,ne,_e=_e||10,Oe=Oe||0,0),je},vr.prototype.getTile=function(ne,_e,Oe){var je=this.trees[this._limitZoom(ne)],dt=Math.pow(2,ne),Ut=this.options,ur=Ut.radius/Ut.extent,lt=(Oe-ur)/dt,Nt=(Oe+1+ur)/dt,Sr={features:[]};return this._addTileFeatures(je.range((_e-ur)/dt,lt,(_e+1+ur)/dt,Nt),je.points,_e,Oe,dt,Sr),_e===0&&this._addTileFeatures(je.range(1-ur/dt,lt,1,Nt),je.points,dt,Oe,dt,Sr),_e===dt-1&&this._addTileFeatures(je.range(0,lt,ur/dt,Nt),je.points,-1,Oe,dt,Sr),Sr.features.length?Sr:null},vr.prototype.getClusterExpansionZoom=function(ne){for(var _e=this._getOriginZoom(ne)-1;_e<=this.options.maxZoom;){var Oe=this.getChildren(ne);if(_e++,Oe.length!==1)break;ne=Oe[0].properties.cluster_id}return _e},vr.prototype._appendLeaves=function(ne,_e,Oe,je,dt){for(var Ut=0,ur=this.getChildren(_e);Ut<ur.length;Ut+=1){var lt=ur[Ut],Nt=lt.properties;if(Nt&&Nt.cluster?dt+Nt.point_count<=je?dt+=Nt.point_count:dt=this._appendLeaves(ne,Nt.cluster_id,Oe,je,dt):dt<je?dt++:ne.push(lt),ne.length===Oe)break}return dt},vr.prototype._addTileFeatures=function(ne,_e,Oe,je,dt,Ut){for(var ur=0,lt=ne;ur<lt.length;ur+=1){var Nt=_e[lt[ur]],Sr=Nt.numPoints,fn={type:1,geometry:[[Math.round(this.options.extent*(Nt.x*dt-Oe)),Math.round(this.options.extent*(Nt.y*dt-je))]],tags:Sr?De(Nt):this.points[Nt.index].properties},Br=void 0;Sr?Br=Nt.id:this.options.generateId?Br=Nt.index:this.points[Nt.index].id&&(Br=this.points[Nt.index].id),Br!==void 0&&(fn.id=Br),Ut.features.push(fn)}},vr.prototype._limitZoom=function(ne){return Math.max(this.options.minZoom,Math.min(+ne,this.options.maxZoom+1))},vr.prototype._cluster=function(ne,_e){for(var Oe=[],je=this.options,dt=je.reduce,Ut=je.minPoints,ur=je.radius/(je.extent*Math.pow(2,_e)),lt=0;lt<ne.length;lt++){var Nt=ne[lt];if(!(Nt.zoom<=_e)){Nt.zoom=_e;for(var Sr=this.trees[_e+1],fn=Sr.within(Nt.x,Nt.y,ur),Br=Nt.numPoints||1,Jr=Br,Tn=0,hi=fn;Tn<hi.length;Tn+=1){var On=Sr.points[hi[Tn]];On.zoom>_e&&(Jr+=On.numPoints||1)}if(Jr>=Ut){for(var Pr=Nt.x*Br,vi=Nt.y*Br,Jn=dt&&Br>1?this._map(Nt,!0):null,ui=(lt<<5)+(_e+1)+this.points.length,Da=0,Yn=fn;Da<Yn.length;Da+=1){var wa=Sr.points[Yn[Da]];if(!(wa.zoom<=_e)){wa.zoom=_e;var vo=wa.numPoints||1;Pr+=wa.x*vo,vi+=wa.y*vo,wa.parentId=ui,dt&&(Jn||(Jn=this._map(Nt,!0)),dt(Jn,this._map(wa)))}}Nt.parentId=ui,Oe.push(jr(Pr/Jr,vi/Jr,ui,Jr,Jn))}else if(Oe.push(Nt),Jr>1)for(var Ua=0,Ka=fn;Ua<Ka.length;Ua+=1){var Ga=Sr.points[Ka[Ua]];Ga.zoom<=_e||(Ga.zoom=_e,Oe.push(Ga))}}}return Oe},vr.prototype._getOriginId=function(ne){return ne-this.points.length>>5},vr.prototype._getOriginZoom=function(ne){return(ne-this.points.length)%32},vr.prototype._map=function(ne,_e){if(ne.numPoints)return _e?mt({},ne.properties):ne.properties;var Oe=this.points[ne.index].properties,je=this.options.map(Oe);return _e&&je===Oe?mt({},je):je},Gn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gn.prototype.splitTile=function(ne,_e,Oe,je,dt,Ut,ur){for(var lt=[ne,_e,Oe,je],Nt=this.options,Sr=Nt.debug;lt.length;){je=lt.pop(),Oe=lt.pop(),_e=lt.pop(),ne=lt.pop();var fn=1<<_e,Br=li(_e,Oe,je),Jr=this.tiles[Br];if(!Jr&&(Sr>1&&console.time("creation"),Jr=this.tiles[Br]=Hr(ne,_e,Oe,je,Nt),this.tileCoords.push({z:_e,x:Oe,y:je}),Sr)){Sr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",_e,Oe,je,Jr.numFeatures,Jr.numPoints,Jr.numSimplified),console.timeEnd("creation"));var Tn="z"+_e;this.stats[Tn]=(this.stats[Tn]||0)+1,this.total++}if(Jr.source=ne,dt){if(_e===Nt.maxZoom||_e===dt)continue;var hi=1<<dt-_e;if(Oe!==Math.floor(Ut/hi)||je!==Math.floor(ur/hi))continue}else if(_e===Nt.indexMaxZoom||Jr.numPoints<=Nt.indexMaxPoints)continue;if(Jr.source=null,ne.length!==0){Sr>1&&console.time("clipping");var On,Pr,vi,Jn,ui,Da,Yn=.5*Nt.buffer/Nt.extent,wa=.5-Yn,vo=.5+Yn,Ua=1+Yn;On=Pr=vi=Jn=null,ui=J(ne,fn,Oe-Yn,Oe+vo,0,Jr.minX,Jr.maxX,Nt),Da=J(ne,fn,Oe+wa,Oe+Ua,0,Jr.minX,Jr.maxX,Nt),ne=null,ui&&(On=J(ui,fn,je-Yn,je+vo,1,Jr.minY,Jr.maxY,Nt),Pr=J(ui,fn,je+wa,je+Ua,1,Jr.minY,Jr.maxY,Nt),ui=null),Da&&(vi=J(Da,fn,je-Yn,je+vo,1,Jr.minY,Jr.maxY,Nt),Jn=J(Da,fn,je+wa,je+Ua,1,Jr.minY,Jr.maxY,Nt),Da=null),Sr>1&&console.timeEnd("clipping"),lt.push(On||[],_e+1,2*Oe,2*je),lt.push(Pr||[],_e+1,2*Oe,2*je+1),lt.push(vi||[],_e+1,2*Oe+1,2*je),lt.push(Jn||[],_e+1,2*Oe+1,2*je+1)}}},Gn.prototype.getTile=function(ne,_e,Oe){var je=this.options,dt=je.extent,Ut=je.debug;if(ne<0||ne>24)return null;var ur=1<<ne,lt=li(ne,_e=(_e%ur+ur)%ur,Oe);if(this.tiles[lt])return lr(this.tiles[lt],dt);Ut>1&&console.log("drilling down to z%d-%d-%d",ne,_e,Oe);for(var Nt,Sr=ne,fn=_e,Br=Oe;!Nt&&Sr>0;)Sr--,fn=Math.floor(fn/2),Br=Math.floor(Br/2),Nt=this.tiles[li(Sr,fn,Br)];return Nt&&Nt.source?(Ut>1&&console.log("found parent tile z%d-%d-%d",Sr,fn,Br),Ut>1&&console.time("drilling down"),this.splitTile(Nt.source,Sr,fn,Br,ne,_e,Oe),Ut>1&&console.timeEnd("drilling down"),this.tiles[lt]?lr(this.tiles[lt],dt):null):null};var Zt=function(ne){function _e(Oe,je,dt,Ut){ne.call(this,Oe,je,dt,$r),Ut&&(this.loadGeoJSON=Ut)}return ne&&(_e.__proto__=ne),(_e.prototype=Object.create(ne&&ne.prototype)).constructor=_e,_e.prototype.loadData=function(Oe,je){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=je,this._pendingLoadDataParams=Oe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},_e.prototype._loadData=function(){var Oe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var je=this._pendingCallback,dt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ut=!!(dt&&dt.request&&dt.request.collectResourceTiming)&&new a.RequestPerformance(dt.request);this.loadGeoJSON(dt,function(ur,lt){if(ur||!lt)return je(ur);if(typeof lt!="object")return je(new Error("Input data given to '"+dt.source+"' is not a valid GeoJSON object."));(function Jr(Tn,hi){var On,Pr=Tn&&Tn.type;if(Pr==="FeatureCollection")for(On=0;On<Tn.features.length;On++)Jr(Tn.features[On],hi);else if(Pr==="GeometryCollection")for(On=0;On<Tn.geometries.length;On++)Jr(Tn.geometries[On],hi);else if(Pr==="Feature")Jr(Tn.geometry,hi);else if(Pr==="Polygon")at(Tn.coordinates,hi);else if(Pr==="MultiPolygon")for(On=0;On<Tn.coordinates.length;On++)at(Tn.coordinates[On],hi);return Tn})(lt,!0);try{if(dt.filter){var Nt=a.createExpression(dt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Nt.result==="error")throw new Error(Nt.value.map(function(Jr){return Jr.key+": "+Jr.message}).join(", "));var Sr=lt.features.filter(function(Jr){return Nt.value.evaluate({zoom:0},Jr)});lt={type:"FeatureCollection",features:Sr}}Oe._geoJSONIndex=dt.cluster?new vr(function(Jr){var Tn=Jr.superclusterOptions,hi=Jr.clusterProperties;if(!hi||!Tn)return Tn;for(var On={},Pr={},vi={accumulated:null,zoom:0},Jn={properties:null},ui=Object.keys(hi),Da=0,Yn=ui;Da<Yn.length;Da+=1){var wa=Yn[Da],vo=hi[wa],Ua=vo[0],Ka=a.createExpression(vo[1]),Ga=a.createExpression(typeof Ua=="string"?[Ua,["accumulated"],["get",wa]]:Ua);On[wa]=Ka.value,Pr[wa]=Ga.value}return Tn.map=function(ei){Jn.properties=ei;for(var eo={},ra=0,Rn=ui;ra<Rn.length;ra+=1){var qa=Rn[ra];eo[qa]=On[qa].evaluate(vi,Jn)}return eo},Tn.reduce=function(ei,eo){Jn.properties=eo;for(var ra=0,Rn=ui;ra<Rn.length;ra+=1){var qa=Rn[ra];vi.accumulated=ei[qa],ei[qa]=Pr[qa].evaluate(vi,Jn)}},Tn}(dt)).load(lt.features):function(Jr,Tn){return new Gn(Jr,Tn)}(lt,dt.geojsonVtOptions)}catch(Jr){return je(Jr)}Oe.loaded={};var fn={};if(Ut){var Br=Ut.finish();Br&&(fn.resourceTiming={},fn.resourceTiming[dt.source]=JSON.parse(JSON.stringify(Br)))}je(null,fn)})}},_e.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},_e.prototype.reloadTile=function(Oe,je){var dt=this.loaded;return dt&&dt[Oe.uid]?ne.prototype.reloadTile.call(this,Oe,je):this.loadTile(Oe,je)},_e.prototype.loadGeoJSON=function(Oe,je){if(Oe.request)a.getJSON(Oe.request,je);else{if(typeof Oe.data!="string")return je(new Error("Input data given to '"+Oe.source+"' is not a valid GeoJSON object."));try{return je(null,JSON.parse(Oe.data))}catch(dt){return je(new Error("Input data given to '"+Oe.source+"' is not a valid GeoJSON object."))}}},_e.prototype.removeSource=function(Oe,je){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),je()},_e.prototype.getClusterExpansionZoom=function(Oe,je){try{je(null,this._geoJSONIndex.getClusterExpansionZoom(Oe.clusterId))}catch(dt){je(dt)}},_e.prototype.getClusterChildren=function(Oe,je){try{je(null,this._geoJSONIndex.getChildren(Oe.clusterId))}catch(dt){je(dt)}},_e.prototype.getClusterLeaves=function(Oe,je){try{je(null,this._geoJSONIndex.getLeaves(Oe.clusterId,Oe.limit,Oe.offset))}catch(dt){je(dt)}},_e}(Y),it=function(ne){var _e=this;this.self=ne,this.actor=new a.Actor(ne,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Y,geojson:Zt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Oe,je){if(_e.workerSourceTypes[Oe])throw new Error('Worker source with name "'+Oe+'" already registered.');_e.workerSourceTypes[Oe]=je},this.self.registerRTLTextPlugin=function(Oe){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=Oe.applyArabicShaping,a.plugin.processBidirectionalText=Oe.processBidirectionalText,a.plugin.processStyledBidirectionalText=Oe.processStyledBidirectionalText}};return it.prototype.setReferrer=function(ne,_e){this.referrer=_e},it.prototype.setImages=function(ne,_e,Oe){for(var je in this.availableImages[ne]=_e,this.workerSources[ne]){var dt=this.workerSources[ne][je];for(var Ut in dt)dt[Ut].availableImages=_e}Oe()},it.prototype.setLayers=function(ne,_e,Oe){this.getLayerIndex(ne).replace(_e),Oe()},it.prototype.updateLayers=function(ne,_e,Oe){this.getLayerIndex(ne).update(_e.layers,_e.removedIds),Oe()},it.prototype.loadTile=function(ne,_e,Oe){this.getWorkerSource(ne,_e.type,_e.source).loadTile(_e,Oe)},it.prototype.loadDEMTile=function(ne,_e,Oe){this.getDEMWorkerSource(ne,_e.source).loadTile(_e,Oe)},it.prototype.reloadTile=function(ne,_e,Oe){this.getWorkerSource(ne,_e.type,_e.source).reloadTile(_e,Oe)},it.prototype.abortTile=function(ne,_e,Oe){this.getWorkerSource(ne,_e.type,_e.source).abortTile(_e,Oe)},it.prototype.removeTile=function(ne,_e,Oe){this.getWorkerSource(ne,_e.type,_e.source).removeTile(_e,Oe)},it.prototype.removeDEMTile=function(ne,_e){this.getDEMWorkerSource(ne,_e.source).removeTile(_e)},it.prototype.removeSource=function(ne,_e,Oe){if(this.workerSources[ne]&&this.workerSources[ne][_e.type]&&this.workerSources[ne][_e.type][_e.source]){var je=this.workerSources[ne][_e.type][_e.source];delete this.workerSources[ne][_e.type][_e.source],je.removeSource!==void 0?je.removeSource(_e,Oe):Oe()}},it.prototype.loadWorkerSource=function(ne,_e,Oe){try{this.self.importScripts(_e.url),Oe()}catch(je){Oe(je.toString())}},it.prototype.syncRTLPluginState=function(ne,_e,Oe){try{a.plugin.setState(_e);var je=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&je!=null){this.self.importScripts(je);var dt=a.plugin.isParsed();Oe(dt?void 0:new Error("RTL Text Plugin failed to import scripts from "+je),dt)}}catch(Ut){Oe(Ut.toString())}},it.prototype.getAvailableImages=function(ne){var _e=this.availableImages[ne];return _e||(_e=[]),_e},it.prototype.getLayerIndex=function(ne){var _e=this.layerIndexes[ne];return _e||(_e=this.layerIndexes[ne]=new O),_e},it.prototype.getWorkerSource=function(ne,_e,Oe){var je=this;return this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][_e]||(this.workerSources[ne][_e]={}),this.workerSources[ne][_e][Oe]||(this.workerSources[ne][_e][Oe]=new this.workerSourceTypes[_e]({send:function(dt,Ut,ur){je.actor.send(dt,Ut,ur,ne)}},this.getLayerIndex(ne),this.getAvailableImages(ne))),this.workerSources[ne][_e][Oe]},it.prototype.getDEMWorkerSource=function(ne,_e){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][_e]||(this.demWorkerSources[ne][_e]=new ce),this.demWorkerSources[ne][_e]},it.prototype.enforceCacheSizeLimit=function(ne,_e){a.enforceCacheSizeLimit(_e)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new it(self)),it}),Z(["./shared"],function(a){"use strict";var P=a.createCommonjsModule(function(n){function o(w){return!i(w)}function i(w){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var j,ae,Se=new Blob([""],{type:"text/javascript"}),He=URL.createObjectURL(Se);try{ae=new Worker(He),j=!0}catch(xt){j=!1}return ae&&ae.terminate(),URL.revokeObjectURL(He),j}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var j=document.createElement("canvas");j.width=j.height=1;var ae=j.getContext("2d");if(!ae)return!1;var Se=ae.getImageData(0,0,1,1);return Se&&Se.width===j.width}()?(l[z=w&&w.failIfMajorPerformanceCaveat]===void 0&&(l[z]=function(j){var ae=function(He){var xt=document.createElement("canvas"),Et=Object.create(o.webGLContextAttributes);return Et.failIfMajorPerformanceCaveat=He,xt.probablySupportsContext?xt.probablySupportsContext("webgl",Et)||xt.probablySupportsContext("experimental-webgl",Et):xt.supportsContext?xt.supportsContext("webgl",Et)||xt.supportsContext("experimental-webgl",Et):xt.getContext("webgl",Et)||xt.getContext("experimental-webgl",Et)}(j);if(!ae)return!1;var Se=ae.createShader(ae.VERTEX_SHADER);return!(!Se||ae.isContextLost())&&(ae.shaderSource(Se,"void main() {}"),ae.compileShader(Se),ae.getShaderParameter(Se,ae.COMPILE_STATUS)===!0)}(z)),l[z]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var z}n.exports?n.exports=o:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=o,window.mapboxgl.notSupportedReason=i);var l={};o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),L={create:function(n,o,i){var l=a.window.document.createElement(n);return o!==void 0&&(l.className=o),i&&i.appendChild(l),l},createNS:function(n,o){return a.window.document.createElementNS(n,o)}},O=a.window.document&&a.window.document.documentElement.style;function D(n){if(!O)return n[0];for(var o=0;o<n.length;o++)if(n[o]in O)return n[o];return n[0]}var B,V=D(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);L.disableDrag=function(){O&&V&&(B=O[V],O[V]="none")},L.enableDrag=function(){O&&V&&(O[V]=B)};var N=D(["transform","WebkitTransform"]);L.setTransform=function(n,o){n.style[N]=o};var Y=!1;try{var H=Object.defineProperty({},"passive",{get:function(){Y=!0}});a.window.addEventListener("test",H,H),a.window.removeEventListener("test",H,H)}catch(n){Y=!1}L.addEventListener=function(n,o,i,l){l===void 0&&(l={}),n.addEventListener(o,i,"passive"in l&&Y?l:l.capture)},L.removeEventListener=function(n,o,i,l){l===void 0&&(l={}),n.removeEventListener(o,i,"passive"in l&&Y?l:l.capture)};var ce=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",ce,!0)};function at(n){var o=n.userImage;return!!(o&&o.render&&o.render())&&(n.data.replace(new Uint8Array(o.data.buffer)),!0)}L.suppressClick=function(){a.window.addEventListener("click",ce,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",ce,!0)},0)},L.mousePos=function(n,o){var i=n.getBoundingClientRect();return new a.Point(o.clientX-i.left-n.clientLeft,o.clientY-i.top-n.clientTop)},L.touchPos=function(n,o){for(var i=n.getBoundingClientRect(),l=[],w=0;w<o.length;w++)l.push(new a.Point(o[w].clientX-i.left-n.clientLeft,o[w].clientY-i.top-n.clientTop));return l},L.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},L.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var rt=function(n){function o(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.isLoaded=function(){return this.loaded},o.prototype.setLoaded=function(i){if(this.loaded!==i&&(this.loaded=i,i)){for(var l=0,w=this.requestors;l<w.length;l+=1){var z=w[l];this._notify(z.ids,z.callback)}this.requestors=[]}},o.prototype.getImage=function(i){return this.images[i]},o.prototype.addImage=function(i,l){this._validate(i,l)&&(this.images[i]=l)},o.prototype._validate=function(i,l){var w=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchX" value'))),w=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchY" value'))),w=!1),this._validateContent(l.content,l)||(this.fire(new a.ErrorEvent(new Error('Image "'+i+'" has invalid "content" value'))),w=!1),w},o.prototype._validateStretch=function(i,l){if(!i)return!0;for(var w=0,z=0,j=i;z<j.length;z+=1){var ae=j[z];if(ae[0]<w||ae[1]<ae[0]||l<ae[1])return!1;w=ae[1]}return!0},o.prototype._validateContent=function(i,l){return!(i&&(i.length!==4||i[0]<0||l.data.width<i[0]||i[1]<0||l.data.height<i[1]||i[2]<0||l.data.width<i[2]||i[3]<0||l.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))},o.prototype.updateImage=function(i,l){l.version=this.images[i].version+1,this.images[i]=l,this.updatedImages[i]=!0},o.prototype.removeImage=function(i){var l=this.images[i];delete this.images[i],delete this.patterns[i],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},o.prototype.listImages=function(){return Object.keys(this.images)},o.prototype.getImages=function(i,l){var w=!0;if(!this.isLoaded())for(var z=0,j=i;z<j.length;z+=1)this.images[j[z]]||(w=!1);this.isLoaded()||w?this._notify(i,l):this.requestors.push({ids:i,callback:l})},o.prototype._notify=function(i,l){for(var w={},z=0,j=i;z<j.length;z+=1){var ae=j[z];this.images[ae]||this.fire(new a.Event("styleimagemissing",{id:ae}));var Se=this.images[ae];Se?w[ae]={data:Se.data.clone(),pixelRatio:Se.pixelRatio,sdf:Se.sdf,version:Se.version,stretchX:Se.stretchX,stretchY:Se.stretchY,content:Se.content,hasRenderCallback:Boolean(Se.userImage&&Se.userImage.render)}:a.warnOnce('Image "'+ae+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,w)},o.prototype.getPixelSize=function(){var i=this.atlasImage;return{width:i.width,height:i.height}},o.prototype.getPattern=function(i){var l=this.patterns[i],w=this.getImage(i);if(!w)return null;if(l&&l.position.version===w.version)return l.position;if(l)l.position.version=w.version;else{var z={w:w.data.width+2,h:w.data.height+2,x:0,y:0},j=new a.ImagePosition(z,w);this.patterns[i]={bin:z,position:j}}return this._updatePatternAtlas(),this.patterns[i].position},o.prototype.bind=function(i){var l=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(i,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},o.prototype._updatePatternAtlas=function(){var i=[];for(var l in this.patterns)i.push(this.patterns[l].bin);var w=a.potpack(i),z=w.w,j=w.h,ae=this.atlasImage;for(var Se in ae.resize({width:z||1,height:j||1}),this.patterns){var He=this.patterns[Se].bin,xt=He.x+1,Et=He.y+1,Tt=this.images[Se].data,Jt=Tt.width,Yt=Tt.height;a.RGBAImage.copy(Tt,ae,{x:0,y:0},{x:xt,y:Et},{width:Jt,height:Yt}),a.RGBAImage.copy(Tt,ae,{x:0,y:Yt-1},{x:xt,y:Et-1},{width:Jt,height:1}),a.RGBAImage.copy(Tt,ae,{x:0,y:0},{x:xt,y:Et+Yt},{width:Jt,height:1}),a.RGBAImage.copy(Tt,ae,{x:Jt-1,y:0},{x:xt-1,y:Et},{width:1,height:Yt}),a.RGBAImage.copy(Tt,ae,{x:0,y:0},{x:xt+Jt,y:Et},{width:1,height:Yt})}this.dirty=!0},o.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},o.prototype.dispatchRenderCallbacks=function(i){for(var l=0,w=i;l<w.length;l+=1){var z=w[l];if(!this.callbackDispatchedThisFrame[z]){this.callbackDispatchedThisFrame[z]=!0;var j=this.images[z];at(j)&&this.updateImage(z,j)}}},o}(a.Evented),Re=fe,vt=fe,wt=1e20;function fe(n,o,i,l,w,z){this.fontSize=n||24,this.buffer=o===void 0?3:o,this.cutoff=l||.25,this.fontFamily=w||"sans-serif",this.fontWeight=z||"normal",this.radius=i||8;var j=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=j,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(j*j),this.gridInner=new Float64Array(j*j),this.f=new Float64Array(j),this.d=new Float64Array(j),this.z=new Float64Array(j+1),this.v=new Int16Array(j),this.middle=Math.round(j/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function $e(n,o,i,l,w,z,j){for(var ae=0;ae<o;ae++){for(var Se=0;Se<i;Se++)l[Se]=n[Se*o+ae];for(re(l,w,z,j,i),Se=0;Se<i;Se++)n[Se*o+ae]=w[Se]}for(Se=0;Se<i;Se++){for(ae=0;ae<o;ae++)l[ae]=n[Se*o+ae];for(re(l,w,z,j,o),ae=0;ae<o;ae++)n[Se*o+ae]=Math.sqrt(w[ae])}}function re(n,o,i,l,w){i[0]=0,l[0]=-wt,l[1]=+wt;for(var z=1,j=0;z<w;z++){for(var ae=(n[z]+z*z-(n[i[j]]+i[j]*i[j]))/(2*z-2*i[j]);ae<=l[j];)j--,ae=(n[z]+z*z-(n[i[j]]+i[j]*i[j]))/(2*z-2*i[j]);i[++j]=z,l[j]=ae,l[j+1]=+wt}for(z=0,j=0;z<w;z++){for(;l[j+1]<z;)j++;o[z]=(z-i[j])*(z-i[j])+n[i[j]]}}fe.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var o=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var w=o.data[4*l+3]/255;this.gridOuter[l]=w===1?0:w===0?wt:Math.pow(Math.max(0,.5-w),2),this.gridInner[l]=w===1?wt:w===0?0:Math.pow(Math.max(0,w-.5),2)}for($e(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),$e(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)i[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return i},Re.default=vt;var Ge=function(n,o){this.requestManager=n,this.localIdeographFontFamily=o,this.entries={}};Ge.prototype.setURL=function(n){this.url=n},Ge.prototype.getGlyphs=function(n,o){var i=this,l=[];for(var w in n)for(var z=0,j=n[w];z<j.length;z+=1)l.push({stack:w,id:j[z]});a.asyncAll(l,function(ae,Se){var He=ae.stack,xt=ae.id,Et=i.entries[He];Et||(Et=i.entries[He]={glyphs:{},requests:{},ranges:{}});var Tt=Et.glyphs[xt];if(Tt===void 0){if(Tt=i._tinySDF(Et,He,xt))return Et.glyphs[xt]=Tt,void Se(null,{stack:He,id:xt,glyph:Tt});var Jt=Math.floor(xt/256);if(256*Jt>65535)Se(new Error("glyphs > 65535 not supported"));else if(Et.ranges[Jt])Se(null,{stack:He,id:xt,glyph:Tt});else{var Yt=Et.requests[Jt];Yt||(Yt=Et.requests[Jt]=[],Ge.loadGlyphRange(He,Jt,i.url,i.requestManager,function(gr,Vt){if(Vt){for(var mr in Vt)i._doesCharSupportLocalGlyph(+mr)||(Et.glyphs[+mr]=Vt[+mr]);Et.ranges[Jt]=!0}for(var Ar=0,Xr=Yt;Ar<Xr.length;Ar+=1)(0,Xr[Ar])(gr,Vt);delete Et.requests[Jt]})),Yt.push(function(gr,Vt){gr?Se(gr):Vt&&Se(null,{stack:He,id:xt,glyph:Vt[xt]||null})})}}else Se(null,{stack:He,id:xt,glyph:Tt})},function(ae,Se){if(ae)o(ae);else if(Se){for(var He={},xt=0,Et=Se;xt<Et.length;xt+=1){var Tt=Et[xt],Jt=Tt.stack,Yt=Tt.id,gr=Tt.glyph;(He[Jt]||(He[Jt]={}))[Yt]=gr&&{id:gr.id,bitmap:gr.bitmap.clone(),metrics:gr.metrics}}o(null,He)}})},Ge.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},Ge.prototype._tinySDF=function(n,o,i){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(i)){var w=n.tinySDF;if(!w){var z="400";/bold/i.test(o)?z="900":/medium/i.test(o)?z="500":/light/i.test(o)&&(z="200"),w=n.tinySDF=new Ge.TinySDF(24,3,8,.25,l,z)}return{id:i,bitmap:new a.AlphaImage({width:30,height:30},w.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ge.loadGlyphRange=function(n,o,i,l,w){var z=256*o,j=z+255,ae=l.transformRequest(l.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",z+"-"+j),a.ResourceType.Glyphs);a.getArrayBuffer(ae,function(Se,He){if(Se)w(Se);else if(He){for(var xt={},Et=0,Tt=a.parseGlyphPBF(He);Et<Tt.length;Et+=1){var Jt=Tt[Et];xt[Jt.id]=Jt}w(null,xt)}})},Ge.TinySDF=Re;var Qe=function(){this.specification=a.styleSpec.light.position};Qe.prototype.possiblyEvaluate=function(n,o){return a.sphericalToCartesian(n.expression.evaluate(o))},Qe.prototype.interpolate=function(n,o,i){return{x:a.number(n.x,o.x,i),y:a.number(n.y,o.y,i),z:a.number(n.z,o.z,i)}};var Te=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new Qe,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Le=function(n){function o(i){n.call(this),this._transitionable=new a.Transitionable(Te),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getLight=function(){return this._transitionable.serialize()},o.prototype.setLight=function(i,l){if(l===void 0&&(l={}),!this._validate(a.validateLight,i,l))for(var w in i){var z=i[w];a.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-"-transition".length),z):this._transitionable.setValue(w,z)}},o.prototype.updateTransitions=function(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)},o.prototype.hasTransition=function(){return this._transitioning.hasTransition()},o.prototype.recalculate=function(i){this.properties=this._transitioning.possiblyEvaluate(i)},o.prototype._validate=function(i,l,w){return(!w||w.validate!==!1)&&a.emitValidationErrors(this,i.call(a.validateStyle,a.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},o}(a.Evented),Ce=function(n,o){this.width=n,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ce.prototype.getDash=function(n,o){var i=n.join(",")+String(o);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(n,o)),this.dashEntry[i]},Ce.prototype.getDashRanges=function(n,o,i){var l=[],w=n.length%2==1?-n[n.length-1]*i:0,z=n[0]*i,j=!0;l.push({left:w,right:z,isDash:j,zeroLength:n[0]===0});for(var ae=n[0],Se=1;Se<n.length;Se++){var He=n[Se];l.push({left:w=ae*i,right:z=(ae+=He)*i,isDash:j=!j,zeroLength:He===0})}return l},Ce.prototype.addRoundDash=function(n,o,i){for(var l=o/2,w=-i;w<=i;w++)for(var z=this.width*(this.nextRow+i+w),j=0,ae=n[j],Se=0;Se<this.width;Se++){Se/ae.right>1&&(ae=n[++j]);var He=Math.abs(Se-ae.left),xt=Math.abs(Se-ae.right),Et=Math.min(He,xt),Tt=void 0,Jt=w/i*(l+1);if(ae.isDash){var Yt=l-Math.abs(Jt);Tt=Math.sqrt(Et*Et+Yt*Yt)}else Tt=l-Math.sqrt(Et*Et+Jt*Jt);this.data[z+Se]=Math.max(0,Math.min(255,Tt+128))}},Ce.prototype.addRegularDash=function(n){for(var o=n.length-1;o>=0;--o){var i=n[o],l=n[o+1];i.zeroLength?n.splice(o,1):l&&l.isDash===i.isDash&&(l.left=i.left,n.splice(o,1))}var w=n[0],z=n[n.length-1];w.isDash===z.isDash&&(w.left=z.left-this.width,z.right=w.right+this.width);for(var j=this.width*this.nextRow,ae=0,Se=n[ae],He=0;He<this.width;He++){He/Se.right>1&&(Se=n[++ae]);var xt=Math.abs(He-Se.left),Et=Math.abs(He-Se.right),Tt=Math.min(xt,Et);this.data[j+He]=Math.max(0,Math.min(255,(Se.isDash?Tt:-Tt)+128))}},Ce.prototype.addDash=function(n,o){var i=o?7:0,l=2*i+1;if(this.nextRow+l>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var w=0,z=0;z<n.length;z++)w+=n[z];if(w!==0){var j=this.width/w,ae=this.getDashRanges(n,this.width,j);o?this.addRoundDash(ae,j,i):this.addRegularDash(ae)}var Se={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:w};return this.nextRow+=l,this.dirty=!0,Se},Ce.prototype.bind=function(n){var o=n.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))};var Fe=function n(o,i){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var l=this.workerPool.acquire(this.id),w=0;w<l.length;w++){var z=new n.Actor(l[w],i,this.id);z.name="Worker "+w,this.actors.push(z)}};function Ke(n,o,i){var l=function(w,z){if(w)return i(w);if(z){var j=a.pick(a.extend(z,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);z.vector_layers&&(j.vectorLayers=z.vector_layers,j.vectorLayerIds=j.vectorLayers.map(function(ae){return ae.id})),j.tiles=o.canonicalizeTileset(j,n.url),i(null,j)}};return n.url?a.getJSON(o.transformRequest(o.normalizeSourceURL(n.url),a.ResourceType.Source),l):a.browser.frame(function(){return l(null,n)})}Fe.prototype.broadcast=function(n,o,i){a.asyncAll(this.actors,function(l,w){l.send(n,o,w)},i=i||function(){})},Fe.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Fe.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},Fe.Actor=a.Actor;var qt=function(n,o,i){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=o||0,this.maxzoom=i||24};qt.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},qt.prototype.contains=function(n){var o=Math.pow(2,n.z),i=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*o),l=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*o),w=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*o),z=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*o);return n.x>=i&&n.x<w&&n.y>=l&&n.y<z};var ir=function(n){function o(i,l,w,z){if(n.call(this),this.id=i,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(l,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(z)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ke(this._options,this.map._requestManager,function(l,w){i._tileJSONRequest=null,i._loaded=!0,l?i.fire(new a.ErrorEvent(l)):w&&(a.extend(i,w),w.bounds&&(i.tileBounds=new qt(w.bounds,i.minzoom,i.maxzoom)),a.postTurnstileEvent(w.tiles,i.map._requestManager._customAccessToken),a.postMapLoadEvent(w.tiles,i.map._getMapId(),i.map._requestManager._skuToken,i.map._requestManager._customAccessToken),i.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setSourceProperty=function(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},o.prototype.setTiles=function(i){var l=this;return this.setSourceProperty(function(){l._options.tiles=i}),this},o.prototype.setUrl=function(i){var l=this;return this.setSourceProperty(function(){l.url=i,l._options.url=i}),this},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return a.extend({},this._options)},o.prototype.loadTile=function(i,l){var w=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),z={request:this.map._requestManager.transformRequest(w,a.ResourceType.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function j(ae,Se){return delete i.request,i.aborted?l(null):ae&&ae.status!==404?l(ae):(Se&&Se.resourceTiming&&(i.resourceTiming=Se.resourceTiming),this.map._refreshExpiredTiles&&Se&&i.setExpiryData(Se),i.loadVectorData(Se,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}z.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=l:i.request=i.actor.send("reloadTile",z,j.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",z,j.bind(this)))},o.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)},o.prototype.unloadTile=function(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)},o.prototype.hasTransition=function(){return!1},o}(a.Evented),Pe=function(n){function o(i,l,w,z){n.call(this),this.id=i,this.dispatcher=w,this.setEventedParent(z),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},l),a.extend(this,a.pick(l,["url","scheme","tileSize"]))}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ke(this._options,this.map._requestManager,function(l,w){i._tileJSONRequest=null,i._loaded=!0,l?i.fire(new a.ErrorEvent(l)):w&&(a.extend(i,w),w.bounds&&(i.tileBounds=new qt(w.bounds,i.minzoom,i.maxzoom)),a.postTurnstileEvent(w.tiles),a.postMapLoadEvent(w.tiles,i.map._getMapId(),i.map._requestManager._skuToken),i.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return a.extend({},this._options)},o.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},o.prototype.loadTile=function(i,l){var w=this,z=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);i.request=a.getImage(this.map._requestManager.transformRequest(z,a.ResourceType.Tile),function(j,ae){if(delete i.request,i.aborted)i.state="unloaded",l(null);else if(j)i.state="errored",l(j);else if(ae){w.map._refreshExpiredTiles&&i.setExpiryData(ae),delete ae.cacheControl,delete ae.expires;var Se=w.map.painter.context,He=Se.gl;i.texture=w.map.painter.getTileTexture(ae.width),i.texture?i.texture.update(ae,{useMipmap:!0}):(i.texture=new a.Texture(Se,ae,He.RGBA,{useMipmap:!0}),i.texture.bind(He.LINEAR,He.CLAMP_TO_EDGE,He.LINEAR_MIPMAP_NEAREST),Se.extTextureFilterAnisotropic&&He.texParameterf(He.TEXTURE_2D,Se.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Se.extTextureFilterAnisotropicMax)),i.state="loaded",a.cacheEntryPossiblyAdded(w.dispatcher),l(null)}})},o.prototype.abortTile=function(i,l){i.request&&(i.request.cancel(),delete i.request),l()},o.prototype.unloadTile=function(i,l){i.texture&&this.map.painter.saveTileTexture(i.texture),l()},o.prototype.hasTransition=function(){return!1},o}(a.Evented),Ne=function(n){function o(i,l,w,z){n.call(this,i,l,w,z),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},o.prototype.loadTile=function(i,l){var w=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function z(j,ae){j&&(i.state="errored",l(j)),ae&&(i.dem=ae,i.needsHillshadePrepare=!0,i.state="loaded",l(null))}i.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),function(j,ae){if(delete i.request,i.aborted)i.state="unloaded",l(null);else if(j)i.state="errored",l(j);else if(ae){this.map._refreshExpiredTiles&&i.setExpiryData(ae),delete ae.cacheControl,delete ae.expires;var Se=a.window.ImageBitmap&&ae instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?ae:a.browser.getImageData(ae,1),He={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:Se,encoding:this.encoding};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",He,z.bind(this)))}}.bind(this)),i.neighboringTiles=this._getNeighboringTiles(i.tileID)},o.prototype._getNeighboringTiles=function(i){var l=i.canonical,w=Math.pow(2,l.z),z=(l.x-1+w)%w,j=l.x===0?i.wrap-1:i.wrap,ae=(l.x+1+w)%w,Se=l.x+1===w?i.wrap+1:i.wrap,He={};return He[new a.OverscaledTileID(i.overscaledZ,j,l.z,z,l.y).key]={backfilled:!1},He[new a.OverscaledTileID(i.overscaledZ,Se,l.z,ae,l.y).key]={backfilled:!1},l.y>0&&(He[new a.OverscaledTileID(i.overscaledZ,j,l.z,z,l.y-1).key]={backfilled:!1},He[new a.OverscaledTileID(i.overscaledZ,i.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},He[new a.OverscaledTileID(i.overscaledZ,Se,l.z,ae,l.y-1).key]={backfilled:!1}),l.y+1<w&&(He[new a.OverscaledTileID(i.overscaledZ,j,l.z,z,l.y+1).key]={backfilled:!1},He[new a.OverscaledTileID(i.overscaledZ,i.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},He[new a.OverscaledTileID(i.overscaledZ,Se,l.z,ae,l.y+1).key]={backfilled:!1}),He},o.prototype.unloadTile=function(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})},o}(Pe),Xe=function(n){function o(i,l,w,z){n.call(this),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=w.getActor(),this.setEventedParent(z),this._data=l.data,this._options=a.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var j=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*j,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*j,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:a.EXTENT,radius:(l.clusterRadius||50)*j,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)i.fire(new a.ErrorEvent(l));else{var w={dataType:"source",sourceDataType:"metadata"};i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0&&(w.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new a.Event("data",w))}})},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setData=function(i){var l=this;return this._data=i,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(w){if(w)l.fire(new a.ErrorEvent(w));else{var z={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(z.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new a.Event("data",z))}}),this},o.prototype.getClusterExpansionZoom=function(i,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},l),this},o.prototype.getClusterChildren=function(i,l){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},l),this},o.prototype.getClusterLeaves=function(i,l,w,z){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:l,offset:w},z),this},o.prototype._updateWorkerData=function(i){var l=this;this._loaded=!1;var w=a.extend({},this.workerOptions),z=this._data;typeof z=="string"?(w.request=this.map._requestManager.transformRequest(a.browser.resolveURL(z),a.ResourceType.Source),w.request.collectResourceTiming=this._collectResourceTiming):w.data=JSON.stringify(z),this.actor.send(this.type+".loadData",w,function(j,ae){l._removed||ae&&ae.abandoned||(l._loaded=!0,ae&&ae.resourceTiming&&ae.resourceTiming[l.id]&&(l._resourceTiming=ae.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:w.source},null),i(j))})},o.prototype.loaded=function(){return this._loaded},o.prototype.loadTile=function(i,l){var w=this,z=i.actor?"reloadTile":"loadTile";i.actor=this.actor,i.request=this.actor.send(z,{type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(j,ae){return delete i.request,i.unloadVectorData(),i.aborted?l(null):j?l(j):(i.loadVectorData(ae,w.map.painter,z==="reloadTile"),l(null))})},o.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0},o.prototype.unloadTile=function(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})},o.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},o.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},o.prototype.hasTransition=function(){return!1},o}(a.Evented),kt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),rr=function(n){function o(i,l,w,z){n.call(this),this.id=i,this.dispatcher=w,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(z),this.options=l}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(i,l){var w=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(z,j){w._loaded=!0,z?w.fire(new a.ErrorEvent(z)):j&&(w.image=j,i&&(w.coordinates=i),l&&l(),w._finishLoading())})},o.prototype.loaded=function(){return this._loaded},o.prototype.updateImage=function(i){var l=this;return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,function(){l.texture=null}),this):this},o.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setCoordinates=function(i){var l=this;this.coordinates=i;var w=i.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(j){for(var ae=1/0,Se=1/0,He=-1/0,xt=-1/0,Et=0,Tt=j;Et<Tt.length;Et+=1){var Jt=Tt[Et];ae=Math.min(ae,Jt.x),Se=Math.min(Se,Jt.y),He=Math.max(He,Jt.x),xt=Math.max(xt,Jt.y)}var Yt=Math.max(He-ae,xt-Se),gr=Math.max(0,Math.floor(-Math.log(Yt)/Math.LN2)),Vt=Math.pow(2,gr);return new a.CanonicalTileID(gr,Math.floor((ae+He)/2*Vt),Math.floor((Se+xt)/2*Vt))}(w),this.minzoom=this.maxzoom=this.tileID.z;var z=w.map(function(j){return l.tileID.getTilePoint(j)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(z[0].x,z[0].y,0,0),this._boundsArray.emplaceBack(z[1].x,z[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(z[3].x,z[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(z[2].x,z[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},o.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var i=this.map.painter.context,l=i.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,kt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(i,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var z=this.tiles[w];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture)}}},o.prototype.loadTile=function(i,l){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},l(null)):(i.state="errored",l(null))},o.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return!1},o}(a.Evented),me=function(n){function o(i,l,w,z){n.call(this,i,l,w,z),this.roundZoom=!0,this.type="video",this.options=l}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1;var l=this.options;this.urls=[];for(var w=0,z=l.urls;w<z.length;w+=1)this.urls.push(this.map._requestManager.transformRequest(z[w],a.ResourceType.Source).url);a.getVideo(this.urls,function(j,ae){i._loaded=!0,j?i.fire(new a.ErrorEvent(j)):ae&&(i.video=ae,i.video.loop=!0,i.video.addEventListener("playing",function(){i.map.triggerRepaint()}),i.map&&i.video.play(),i._finishLoading())})},o.prototype.pause=function(){this.video&&this.video.pause()},o.prototype.play=function(){this.video&&this.video.play()},o.prototype.seek=function(i){if(this.video){var l=this.video.seekable;i<l.start(0)||i>l.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=i}},o.prototype.getVideo=function(){return this.video},o.prototype.onAdd=function(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},o.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var i=this.map.painter.context,l=i.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,kt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(i,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var z=this.tiles[w];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this.video&&!this.video.paused},o}(rr),et=function(n){function o(i,l,w,z){n.call(this,i,l,w,z),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(j){return!Array.isArray(j)||j.length!==2||j.some(function(ae){return typeof ae!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+i,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+i,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+i,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},o.prototype.getCanvas=function(){return this.canvas},o.prototype.onAdd=function(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()},o.prototype.onRemove=function(){this.pause()},o.prototype.prepare=function(){var i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,w=l.gl;for(var z in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,kt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(l,this.canvas,w.RGBA,{premultiply:!0}),this.tiles){var j=this.tiles[z];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this._playing},o.prototype._hasInvalidDimensions=function(){for(var i=0,l=[this.canvas.width,this.canvas.height];i<l.length;i+=1){var w=l[i];if(isNaN(w)||w<=0)return!0}return!1},o}(rr),or={vector:ir,raster:Pe,"raster-dem":Ne,geojson:Xe,video:me,image:rr,canvas:et};function on(n,o){var i=a.identity([]);return a.translate(i,i,[1,1,0]),a.scale(i,i,[.5*n.width,.5*n.height,1]),a.multiply(i,i,n.calculatePosMatrix(o.toUnwrapped()))}function vr(n,o,i,l,w,z){var j=function(gr,Vt,mr){if(gr)for(var Ar=0,Xr=gr;Ar<Xr.length;Ar+=1){var cn=Vt[Xr[Ar]];if(cn&&cn.source===mr&&cn.type==="fill-extrusion")return!0}else for(var nn in Vt){var pn=Vt[nn];if(pn.source===mr&&pn.type==="fill-extrusion")return!0}return!1}(w&&w.layers,o,n.id),ae=z.maxPitchScaleFactor(),Se=n.tilesIn(l,ae,j);Se.sort(jr);for(var He=[],xt=0,Et=Se;xt<Et.length;xt+=1){var Tt=Et[xt];He.push({wrappedTileID:Tt.tileID.wrapped().key,queryResults:Tt.tile.queryRenderedFeatures(o,i,n._state,Tt.queryGeometry,Tt.cameraQueryGeometry,Tt.scale,w,z,ae,on(n.transform,Tt.tileID))})}var Jt=function(gr){for(var Vt={},mr={},Ar=0,Xr=gr;Ar<Xr.length;Ar+=1){var cn=Xr[Ar],nn=cn.queryResults,pn=cn.wrappedTileID,Bn=mr[pn]=mr[pn]||{};for(var Zn in nn)for(var Vn=nn[Zn],Si=Bn[Zn]=Bn[Zn]||{},Zi=Vt[Zn]=Vt[Zn]||[],ca=0,ma=Vn;ca<ma.length;ca+=1){var Co=ma[ca];Si[Co.featureIndex]||(Si[Co.featureIndex]=!0,Zi.push(Co))}}return Vt}(He);for(var Yt in Jt)Jt[Yt].forEach(function(gr){var Vt=gr.feature,mr=n.getFeatureState(Vt.layer["source-layer"],Vt.id);Vt.source=Vt.layer.source,Vt.layer["source-layer"]&&(Vt.sourceLayer=Vt.layer["source-layer"]),Vt.state=mr});return Jt}function jr(n,o){var i=n.tileID,l=o.tileID;return i.overscaledZ-l.overscaledZ||i.canonical.y-l.canonical.y||i.wrap-l.wrap||i.canonical.x-l.canonical.x}var xr=function(n,o){this.max=n,this.onRemove=o,this.reset()};xr.prototype.reset=function(){for(var n in this.data)for(var o=0,i=this.data[n];o<i.length;o+=1){var l=i[o];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},xr.prototype.add=function(n,o,i){var l=this,w=n.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);var z={value:o,timeout:void 0};if(i!==void 0&&(z.timeout=setTimeout(function(){l.remove(n,z)},i)),this.data[w].push(z),this.order.push(w),this.order.length>this.max){var j=this._getAndRemoveByKey(this.order[0]);j&&this.onRemove(j)}return this},xr.prototype.has=function(n){return n.wrapped().key in this.data},xr.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},xr.prototype._getAndRemoveByKey=function(n){var o=this.data[n].shift();return o.timeout&&clearTimeout(o.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),o.value},xr.prototype.getByKey=function(n){var o=this.data[n];return o?o[0].value:null},xr.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},xr.prototype.remove=function(n,o){if(!this.has(n))return this;var i=n.wrapped().key,l=o===void 0?0:this.data[i].indexOf(o),w=this.data[i][l];return this.data[i].splice(l,1),w.timeout&&clearTimeout(w.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(w.value),this.order.splice(this.order.indexOf(i),1),this},xr.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},xr.prototype.filter=function(n){var o=[];for(var i in this.data)for(var l=0,w=this.data[i];l<w.length;l+=1){var z=w[l];n(z.value)||o.push(z)}for(var j=0,ae=o;j<ae.length;j+=1){var Se=ae[j];this.remove(Se.value.tileID,Se)}};var Ae=function(n,o,i){this.context=n;var l=n.gl;this.buffer=l.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};Ae.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ae.prototype.updateData=function(n){var o=this.context.gl;this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Ae.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var De={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ke=function(n,o,i,l){this.length=o.length,this.attributes=i,this.itemSize=o.bytesPerElement,this.dynamicDraw=l,this.context=n;var w=n.gl;this.buffer=w.createBuffer(),n.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};ke.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ke.prototype.updateData=function(n){var o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,n.arrayBuffer)},ke.prototype.enableAttributes=function(n,o){for(var i=0;i<this.attributes.length;i++){var l=o.attributes[this.attributes[i].name];l!==void 0&&n.enableVertexAttribArray(l)}},ke.prototype.setVertexAttribPointers=function(n,o,i){for(var l=0;l<this.attributes.length;l++){var w=this.attributes[l],z=o.attributes[w.name];z!==void 0&&n.vertexAttribPointer(z,w.components,n[De[w.type]],!1,this.itemSize,w.offset+this.itemSize*(i||0))}},ke.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Bt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Bt.prototype.get=function(){return this.current},Bt.prototype.set=function(n){},Bt.prototype.getDefault=function(){return this.default},Bt.prototype.setDefault=function(){this.set(this.default)};var mt=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return a.Color.transparent},o.prototype.set=function(i){var l=this.current;(i.r!==l.r||i.g!==l.g||i.b!==l.b||i.a!==l.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},o}(Bt),Mr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 1},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)},o}(Bt),Cr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)},o}(Bt),Nr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return[!0,!0,!0,!0]},o.prototype.set=function(i){var l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||i[3]!==l[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},o}(Bt),nt=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)},o}(Bt),Ye=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 255},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)},o}(Bt),M=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},o.prototype.set=function(i){var l=this.current;(i.func!==l.func||i.ref!==l.ref||i.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)},o}(Bt),W=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]},o.prototype.set=function(i){var l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)},o}(Bt),ue=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;i?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=i,this.dirty=!1}},o}(Bt),X=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return[0,1]},o.prototype.set=function(i){var l=this.current;(i[0]!==l[0]||i[1]!==l[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)},o}(Bt),ie=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;i?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=i,this.dirty=!1}},o}(Bt),ye=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.LESS},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)},o}(Bt),J=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;i?l.enable(l.BLEND):l.disable(l.BLEND),this.current=i,this.dirty=!1}},o}(Bt),ht=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[i.ONE,i.ZERO]},o.prototype.set=function(i){var l=this.current;(i[0]!==l[0]||i[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)},o}(Bt),ze=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return a.Color.transparent},o.prototype.set=function(i){var l=this.current;(i.r!==l.r||i.g!==l.g||i.b!==l.b||i.a!==l.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},o}(Bt),pt=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.FUNC_ADD},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)},o}(Bt),Me=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;i?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=i,this.dirty=!1}},o}(Bt),Ue=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.BACK},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)},o}(Bt),yt=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.CCW},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)},o}(Bt),gt=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)},o}(Bt),nr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.TEXTURE0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)},o}(Bt),pe=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]},o.prototype.set=function(i){var l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||i[3]!==l[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},o}(Bt),lr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,i),this.current=i,this.dirty=!1}},o}(Bt),Ur=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,i),this.current=i,this.dirty=!1}},o}(Bt),Hr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,i),this.current=i,this.dirty=!1}},o}(Bt),un=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}},o}(Bt),bn=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1},o}(Bt),Gn=function(n){function o(i){n.call(this,i),this.vao=i.extVertexArrayObject}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)},o}(Bt),li=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 4},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}},o}(Bt),$r=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}},o}(Bt),Zt=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}},o}(Bt),it=function(n){function o(i,l){n.call(this,i),this.context=i,this.parent=l}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o}(Bt),ne=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.setDirty=function(){this.dirty=!0},o.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}},o}(it),_e=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,i),this.current=i,this.dirty=!1}},o}(it),Oe=function(n,o,i,l){this.context=n,this.width=o,this.height=i;var w=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new ne(n,w),l&&(this.depthAttachment=new _e(n,w))};Oe.prototype.destroy=function(){var n=this.context.gl,o=this.colorAttachment.get();if(o&&n.deleteTexture(o),this.depthAttachment){var i=this.depthAttachment.get();i&&n.deleteRenderbuffer(i)}n.deleteFramebuffer(this.framebuffer)};var je=function(n,o,i){this.func=n,this.mask=o,this.range=i};je.ReadOnly=!1,je.ReadWrite=!0,je.disabled=new je(519,je.ReadOnly,[0,1]);var dt=function(n,o,i,l,w,z){this.test=n,this.ref=o,this.mask=i,this.fail=l,this.depthFail=w,this.pass=z};dt.disabled=new dt({func:519,mask:0},0,0,7680,7680,7680);var Ut=function(n,o,i){this.blendFunction=n,this.blendColor=o,this.mask=i};Ut.disabled=new Ut(Ut.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),Ut.unblended=new Ut(Ut.Replace,a.Color.transparent,[!0,!0,!0,!0]),Ut.alphaBlended=new Ut([1,771],a.Color.transparent,[!0,!0,!0,!0]);var ur=function(n,o,i){this.enable=n,this.mode=o,this.frontFace=i};ur.disabled=new ur(!1,1029,2305),ur.backCCW=new ur(!0,1029,2305);var lt=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new mt(this),this.clearDepth=new Mr(this),this.clearStencil=new Cr(this),this.colorMask=new Nr(this),this.depthMask=new nt(this),this.stencilMask=new Ye(this),this.stencilFunc=new M(this),this.stencilOp=new W(this),this.stencilTest=new ue(this),this.depthRange=new X(this),this.depthTest=new ie(this),this.depthFunc=new ye(this),this.blend=new J(this),this.blendFunc=new ht(this),this.blendColor=new ze(this),this.blendEquation=new pt(this),this.cullFace=new Me(this),this.cullFaceSide=new Ue(this),this.frontFace=new yt(this),this.program=new gt(this),this.activeTexture=new nr(this),this.viewport=new pe(this),this.bindFramebuffer=new lr(this),this.bindRenderbuffer=new Ur(this),this.bindTexture=new Hr(this),this.bindVertexBuffer=new un(this),this.bindElementBuffer=new bn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Gn(this),this.pixelStoreUnpack=new li(this),this.pixelStoreUnpackPremultiplyAlpha=new $r(this),this.pixelStoreUnpackFlipY=new Zt(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};lt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},lt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},lt.prototype.createIndexBuffer=function(n,o){return new Ae(this,n,o)},lt.prototype.createVertexBuffer=function(n,o,i){return new ke(this,n,o,i)},lt.prototype.createRenderbuffer=function(n,o,i){var l=this.gl,w=l.createRenderbuffer();return this.bindRenderbuffer.set(w),l.renderbufferStorage(l.RENDERBUFFER,n,o,i),this.bindRenderbuffer.set(null),w},lt.prototype.createFramebuffer=function(n,o,i){return new Oe(this,n,o,i)},lt.prototype.clear=function(n){var o=n.color,i=n.depth,l=this.gl,w=0;o&&(w|=l.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(w|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),l.clear(w)},lt.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},lt.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},lt.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},lt.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,Ut.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},lt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Nt=function(n){function o(i,l,w){var z=this;n.call(this),this.id=i,this.dispatcher=w,this.on("data",function(j){j.dataType==="source"&&j.sourceDataType==="metadata"&&(z._sourceLoaded=!0),z._sourceLoaded&&!z._paused&&j.dataType==="source"&&j.sourceDataType==="content"&&(z.reload(),z.transform&&z.update(z.transform))}),this.on("error",function(){z._sourceErrored=!0}),this._source=function(j,ae,Se,He){var xt=new or[ae.type](j,ae,Se,He);if(xt.id!==j)throw new Error("Expected Source id to be "+j+" instead of "+xt.id);return a.bindAll(["load","abort","unload","serialize","prepare"],xt),xt}(i,l,w,this),this._tiles={},this._cache=new xr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.onAdd=function(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(i)},o.prototype.onRemove=function(i){this._source&&this._source.onRemove&&this._source.onRemove(i)},o.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var i in this._tiles){var l=this._tiles[i];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},o.prototype.getSource=function(){return this._source},o.prototype.pause=function(){this._paused=!0},o.prototype.resume=function(){if(this._paused){var i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}},o.prototype._loadTile=function(i,l){return this._source.loadTile(i,l)},o.prototype._unloadTile=function(i){if(this._source.unloadTile)return this._source.unloadTile(i,function(){})},o.prototype._abortTile=function(i){if(this._source.abortTile)return this._source.abortTile(i,function(){})},o.prototype.serialize=function(){return this._source.serialize()},o.prototype.prepare=function(i){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var w=this._tiles[l];w.upload(i),w.prepare(this.map.style.imageManager)}},o.prototype.getIds=function(){return a.values(this._tiles).map(function(i){return i.tileID}).sort(Sr).map(function(i){return i.key})},o.prototype.getRenderableIds=function(i){var l=this,w=[];for(var z in this._tiles)this._isIdRenderable(z,i)&&w.push(this._tiles[z]);return i?w.sort(function(j,ae){var Se=j.tileID,He=ae.tileID,xt=new a.Point(Se.canonical.x,Se.canonical.y)._rotate(l.transform.angle),Et=new a.Point(He.canonical.x,He.canonical.y)._rotate(l.transform.angle);return Se.overscaledZ-He.overscaledZ||Et.y-xt.y||Et.x-xt.x}).map(function(j){return j.tileID.key}):w.map(function(j){return j.tileID}).sort(Sr).map(function(j){return j.key})},o.prototype.hasRenderableParent=function(i){var l=this.findLoadedParent(i,0);return!!l&&this._isIdRenderable(l.tileID.key)},o.prototype._isIdRenderable=function(i,l){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(l||!this._tiles[i].holdingForFade())},o.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var i in this._cache.reset(),this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")},o.prototype._reloadTile=function(i,l){var w=this._tiles[i];w&&(w.state!=="loading"&&(w.state=l),this._loadTile(w,this._tileLoaded.bind(this,w,i,l)))},o.prototype._tileLoaded=function(i,l,w,z){if(z)return i.state="errored",void(z.status!==404?this._source.fire(new a.ErrorEvent(z,{tile:i})):this.update(this.transform));i.timeAdded=a.browser.now(),w==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(l,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:i,coord:i.tileID}))},o.prototype._backfillDEM=function(i){for(var l=this.getRenderableIds(),w=0;w<l.length;w++){var z=l[w];if(i.neighboringTiles&&i.neighboringTiles[z]){var j=this.getTileByID(z);ae(i,j),ae(j,i)}}function ae(Se,He){Se.needsHillshadePrepare=!0;var xt=He.tileID.canonical.x-Se.tileID.canonical.x,Et=He.tileID.canonical.y-Se.tileID.canonical.y,Tt=Math.pow(2,Se.tileID.canonical.z),Jt=He.tileID.key;xt===0&&Et===0||Math.abs(Et)>1||(Math.abs(xt)>1&&(Math.abs(xt+Tt)===1?xt+=Tt:Math.abs(xt-Tt)===1&&(xt-=Tt)),He.dem&&Se.dem&&(Se.dem.backfillBorder(He.dem,xt,Et),Se.neighboringTiles&&Se.neighboringTiles[Jt]&&(Se.neighboringTiles[Jt].backfilled=!0)))}},o.prototype.getTile=function(i){return this.getTileByID(i.key)},o.prototype.getTileByID=function(i){return this._tiles[i]},o.prototype._retainLoadedChildren=function(i,l,w,z){for(var j in this._tiles){var ae=this._tiles[j];if(!(z[j]||!ae.hasData()||ae.tileID.overscaledZ<=l||ae.tileID.overscaledZ>w)){for(var Se=ae.tileID;ae&&ae.tileID.overscaledZ>l+1;){var He=ae.tileID.scaledTo(ae.tileID.overscaledZ-1);(ae=this._tiles[He.key])&&ae.hasData()&&(Se=He)}for(var xt=Se;xt.overscaledZ>l;)if(i[(xt=xt.scaledTo(xt.overscaledZ-1)).key]){z[Se.key]=Se;break}}}},o.prototype.findLoadedParent=function(i,l){if(i.key in this._loadedParentTiles){var w=this._loadedParentTiles[i.key];return w&&w.tileID.overscaledZ>=l?w:null}for(var z=i.overscaledZ-1;z>=l;z--){var j=i.scaledTo(z),ae=this._getLoadedTile(j);if(ae)return ae}},o.prototype._getLoadedTile=function(i){var l=this._tiles[i.key];return l&&l.hasData()?l:this._cache.getByKey(i.wrapped().key)},o.prototype.updateCacheSize=function(i){var l=Math.ceil(i.width/this._source.tileSize)+1,w=Math.ceil(i.height/this._source.tileSize)+1,z=Math.floor(l*w*5),j=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,z):z;this._cache.setMaxSize(j)},o.prototype.handleWrapJump=function(i){var l=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,l){var w={};for(var z in this._tiles){var j=this._tiles[z];j.tileID=j.tileID.unwrapTo(j.tileID.wrap+l),w[j.tileID.key]=j}for(var ae in this._tiles=w,this._timers)clearTimeout(this._timers[ae]),delete this._timers[ae];for(var Se in this._tiles)this._setTileReloadTimer(Se,this._tiles[Se])}},o.prototype.update=function(i){var l=this;if(this.transform=i,this._sourceLoaded&&!this._paused){var w;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?w=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Bn){return new a.OverscaledTileID(Bn.canonical.z,Bn.wrap,Bn.canonical.z,Bn.canonical.x,Bn.canonical.y)}):(w=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(w=w.filter(function(Bn){return l._source.hasTile(Bn)}))):w=[];var z=i.coveringZoomLevel(this._source),j=Math.max(z-o.maxOverzooming,this._source.minzoom),ae=Math.max(z+o.maxUnderzooming,this._source.minzoom),Se=this._updateRetainedTiles(w,z);if(fn(this._source.type)){for(var He={},xt={},Et=0,Tt=Object.keys(Se);Et<Tt.length;Et+=1){var Jt=Tt[Et],Yt=Se[Jt],gr=this._tiles[Jt];if(gr&&!(gr.fadeEndTime&&gr.fadeEndTime<=a.browser.now())){var Vt=this.findLoadedParent(Yt,j);Vt&&(this._addTile(Vt.tileID),He[Vt.tileID.key]=Vt.tileID),xt[Jt]=Yt}}for(var mr in this._retainLoadedChildren(xt,z,ae,Se),He)Se[mr]||(this._coveredTiles[mr]=!0,Se[mr]=He[mr])}for(var Ar in Se)this._tiles[Ar].clearFadeHold();for(var Xr=0,cn=a.keysDifference(this._tiles,Se);Xr<cn.length;Xr+=1){var nn=cn[Xr],pn=this._tiles[nn];pn.hasSymbolBuckets&&!pn.holdingForFade()?pn.setHoldDuration(this.map._fadeDuration):pn.hasSymbolBuckets&&!pn.symbolFadeFinished()||this._removeTile(nn)}this._updateLoadedParentTileCache()}},o.prototype.releaseSymbolFadeTiles=function(){for(var i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)},o.prototype._updateRetainedTiles=function(i,l){for(var w={},z={},j=Math.max(l-o.maxOverzooming,this._source.minzoom),ae=Math.max(l+o.maxUnderzooming,this._source.minzoom),Se={},He=0,xt=i;He<xt.length;He+=1){var Et=xt[He],Tt=this._addTile(Et);w[Et.key]=Et,Tt.hasData()||l<this._source.maxzoom&&(Se[Et.key]=Et)}this._retainLoadedChildren(Se,l,ae,w);for(var Jt=0,Yt=i;Jt<Yt.length;Jt+=1){var gr=Yt[Jt],Vt=this._tiles[gr.key];if(!Vt.hasData()){if(l+1>this._source.maxzoom){var mr=gr.children(this._source.maxzoom)[0],Ar=this.getTile(mr);if(Ar&&Ar.hasData()){w[mr.key]=mr;continue}}else{var Xr=gr.children(this._source.maxzoom);if(w[Xr[0].key]&&w[Xr[1].key]&&w[Xr[2].key]&&w[Xr[3].key])continue}for(var cn=Vt.wasRequested(),nn=gr.overscaledZ-1;nn>=j;--nn){var pn=gr.scaledTo(nn);if(z[pn.key]||(z[pn.key]=!0,!(Vt=this.getTile(pn))&&cn&&(Vt=this._addTile(pn)),Vt&&(w[pn.key]=pn,cn=Vt.wasRequested(),Vt.hasData())))break}}}return w},o.prototype._updateLoadedParentTileCache=function(){for(var i in this._loadedParentTiles={},this._tiles){for(var l=[],w=void 0,z=this._tiles[i].tileID;z.overscaledZ>0;){if(z.key in this._loadedParentTiles){w=this._loadedParentTiles[z.key];break}l.push(z.key);var j=z.scaledTo(z.overscaledZ-1);if(w=this._getLoadedTile(j))break;z=j}for(var ae=0,Se=l;ae<Se.length;ae+=1)this._loadedParentTiles[Se[ae]]=w}},o.prototype._addTile=function(i){var l=this._tiles[i.key];if(l)return l;(l=this._cache.getAndRemove(i))&&(this._setTileReloadTimer(i.key,l),l.tileID=i,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,l)));var w=Boolean(l);return w||(l=new a.Tile(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,i.key,l.state))),l?(l.uses++,this._tiles[i.key]=l,w||this._source.fire(new a.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},o.prototype._setTileReloadTimer=function(i,l){var w=this;i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);var z=l.getExpiryTimeout();z&&(this._timers[i]=setTimeout(function(){w._reloadTile(i,"expired"),delete w._timers[i]},z))},o.prototype._removeTile=function(i){var l=this._tiles[i];l&&(l.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},o.prototype.clearTiles=function(){for(var i in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(i);this._cache.reset()},o.prototype.tilesIn=function(i,l,w){var z=this,j=[],ae=this.transform;if(!ae)return j;for(var Se=w?ae.getCameraQueryGeometry(i):i,He=i.map(function(nn){return ae.pointCoordinate(nn)}),xt=Se.map(function(nn){return ae.pointCoordinate(nn)}),Et=this.getIds(),Tt=1/0,Jt=1/0,Yt=-1/0,gr=-1/0,Vt=0,mr=xt;Vt<mr.length;Vt+=1){var Ar=mr[Vt];Tt=Math.min(Tt,Ar.x),Jt=Math.min(Jt,Ar.y),Yt=Math.max(Yt,Ar.x),gr=Math.max(gr,Ar.y)}for(var Xr=function(nn){var pn=z._tiles[Et[nn]];if(!pn.holdingForFade()){var Bn=pn.tileID,Zn=Math.pow(2,ae.zoom-pn.tileID.overscaledZ),Vn=l*pn.queryPadding*a.EXTENT/pn.tileSize/Zn,Si=[Bn.getTilePoint(new a.MercatorCoordinate(Tt,Jt)),Bn.getTilePoint(new a.MercatorCoordinate(Yt,gr))];if(Si[0].x-Vn<a.EXTENT&&Si[0].y-Vn<a.EXTENT&&Si[1].x+Vn>=0&&Si[1].y+Vn>=0){var Zi=He.map(function(ma){return Bn.getTilePoint(ma)}),ca=xt.map(function(ma){return Bn.getTilePoint(ma)});j.push({tile:pn,tileID:Bn,queryGeometry:Zi,cameraQueryGeometry:ca,scale:Zn})}}},cn=0;cn<Et.length;cn++)Xr(cn);return j},o.prototype.getVisibleCoordinates=function(i){for(var l=this,w=this.getRenderableIds(i).map(function(Se){return l._tiles[Se].tileID}),z=0,j=w;z<j.length;z+=1){var ae=j[z];ae.posMatrix=this.transform.calculatePosMatrix(ae.toUnwrapped())}return w},o.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(fn(this._source.type))for(var i in this._tiles){var l=this._tiles[i];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=a.browser.now())return!0}return!1},o.prototype.setFeatureState=function(i,l,w){this._state.updateState(i=i||"_geojsonTileLayer",l,w)},o.prototype.removeFeatureState=function(i,l,w){this._state.removeFeatureState(i=i||"_geojsonTileLayer",l,w)},o.prototype.getFeatureState=function(i,l){return this._state.getState(i=i||"_geojsonTileLayer",l)},o.prototype.setDependencies=function(i,l,w){var z=this._tiles[i];z&&z.setDependencies(l,w)},o.prototype.reloadTilesForDependencies=function(i,l){for(var w in this._tiles)this._tiles[w].hasDependency(i,l)&&this._reloadTile(w,"reloading");this._cache.filter(function(z){return!z.hasDependency(i,l)})},o}(a.Evented);function Sr(n,o){var i=Math.abs(2*n.wrap)-+(n.wrap<0),l=Math.abs(2*o.wrap)-+(o.wrap<0);return n.overscaledZ-o.overscaledZ||l-i||o.canonical.y-n.canonical.y||o.canonical.x-n.canonical.x}function fn(n){return n==="raster"||n==="image"||n==="video"}function Br(){return new a.window.Worker(Pf.workerUrl)}Nt.maxOverzooming=10,Nt.maxUnderzooming=3;var Jr="mapboxgl_preloaded_worker_pool",Tn=function(){this.active={}};Tn.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Tn.workerCount;)this.workers.push(new Br);return this.active[n]=!0,this.workers.slice()},Tn.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(o){o.terminate()}),this.workers=null)},Tn.prototype.isPreloaded=function(){return!!this.active[Jr]},Tn.prototype.numActive=function(){return Object.keys(this.active).length};var hi,On=Math.floor(a.browser.hardwareConcurrency/2);function Pr(){return hi||(hi=new Tn),hi}function vi(n,o){var i={};for(var l in n)l!=="ref"&&(i[l]=n[l]);return a.refProperties.forEach(function(w){w in o&&(i[w]=o[w])}),i}function Jn(n){n=n.slice();for(var o=Object.create(null),i=0;i<n.length;i++)o[n[i].id]=n[i];for(var l=0;l<n.length;l++)"ref"in n[l]&&(n[l]=vi(n[l],o[n[l].ref]));return n}Tn.workerCount=Math.max(Math.min(On,6),1);var ui={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Da(n,o,i){i.push({command:ui.addSource,args:[n,o[n]]})}function Yn(n,o,i){o.push({command:ui.removeSource,args:[n]}),i[n]=!0}function wa(n,o,i,l){Yn(n,i,l),Da(n,o,i)}function vo(n,o,i){var l;for(l in n[i])if(n[i].hasOwnProperty(l)&&l!=="data"&&!a.deepEqual(n[i][l],o[i][l]))return!1;for(l in o[i])if(o[i].hasOwnProperty(l)&&l!=="data"&&!a.deepEqual(n[i][l],o[i][l]))return!1;return!0}function Ua(n,o,i,l,w,z){var j;for(j in o=o||{},n=n||{})n.hasOwnProperty(j)&&(a.deepEqual(n[j],o[j])||i.push({command:z,args:[l,j,o[j],w]}));for(j in o)o.hasOwnProperty(j)&&!n.hasOwnProperty(j)&&(a.deepEqual(n[j],o[j])||i.push({command:z,args:[l,j,o[j],w]}))}function Ka(n){return n.id}function Ga(n,o){return n[o.id]=o,n}var ei=function(n,o){this.reset(n,o)};ei.prototype.reset=function(n,o){this.points=n||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ei.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var o=1,i=this._distances[o],l=n*this.paddedLength+this.padding;i<l&&o<this._distances.length;)i=this._distances[++o];var w=o-1,z=this._distances[w],j=i-z,ae=j>0?(l-z)/j:0;return this.points[w].mult(1-ae).add(this.points[o].mult(ae))};var eo=function(n,o,i){var l=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(n/i),this.yCellCount=Math.ceil(o/i);for(var z=0;z<this.xCellCount*this.yCellCount;z++)l.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=o,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0};function ra(n,o,i,l,w){var z=a.create();return o?(a.scale(z,z,[1/w,1/w,1]),i||a.rotateZ(z,z,l.angle)):a.multiply(z,l.labelPlaneMatrix,n),z}function Rn(n,o,i,l,w){if(o){var z=a.clone(n);return a.scale(z,z,[w,w,1]),i||a.rotateZ(z,z,-l.angle),z}return l.glCoordMatrix}function qa(n,o){var i=[n.x,n.y,0,1];rs(i,i,o);var l=i[3];return{point:new a.Point(i[0]/l,i[1]/l),signedDistanceFromCamera:l}}function ba(n,o){return .5+n/o*.5}function Na(n,o){var i=n[0]/n[3],l=n[1]/n[3];return i>=-o[0]&&i<=o[0]&&l>=-o[1]&&l<=o[1]}function wo(n,o,i,l,w,z,j,ae){var Se=l?n.textSizeData:n.iconSizeData,He=a.evaluateSizeForZoom(Se,i.transform.zoom),xt=[256/i.width*2+1,256/i.height*2+1],Et=l?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;Et.clear();for(var Tt=n.lineVertexArray,Jt=l?n.text.placedSymbolArray:n.icon.placedSymbolArray,Yt=i.transform.width/i.transform.height,gr=!1,Vt=0;Vt<Jt.length;Vt++){var mr=Jt.get(Vt);if(mr.hidden||mr.writingMode===a.WritingMode.vertical&&!gr)Ss(mr.numGlyphs,Et);else{gr=!1;var Ar=[mr.anchorX,mr.anchorY,0,1];if(a.transformMat4(Ar,Ar,o),Na(Ar,xt)){var Xr=ba(i.transform.cameraToCenterDistance,Ar[3]),cn=a.evaluateSizeForFeature(Se,He,mr),nn=j?cn/Xr:cn*Xr,pn=new a.Point(mr.anchorX,mr.anchorY),Bn=qa(pn,w).point,Zn={},Vn=gs(mr,nn,!1,ae,o,w,z,n.glyphOffsetArray,Tt,Et,Bn,pn,Zn,Yt);gr=Vn.useVertical,(Vn.notEnoughRoom||gr||Vn.needsFlipping&&gs(mr,nn,!0,ae,o,w,z,n.glyphOffsetArray,Tt,Et,Bn,pn,Zn,Yt).notEnoughRoom)&&Ss(mr.numGlyphs,Et)}else Ss(mr.numGlyphs,Et)}}l?n.text.dynamicLayoutVertexBuffer.updateData(Et):n.icon.dynamicLayoutVertexBuffer.updateData(Et)}function ya(n,o,i,l,w,z,j,ae,Se,He,xt){var Et=ae.glyphStartIndex+ae.numGlyphs,Tt=ae.lineStartIndex,Jt=ae.lineStartIndex+ae.lineLength,Yt=o.getoffsetX(ae.glyphStartIndex),gr=o.getoffsetX(Et-1),Vt=So(n*Yt,i,l,w,z,j,ae.segment,Tt,Jt,Se,He,xt);if(!Vt)return null;var mr=So(n*gr,i,l,w,z,j,ae.segment,Tt,Jt,Se,He,xt);return mr?{first:Vt,last:mr}:null}function Gt(n,o,i,l){return n===a.WritingMode.horizontal&&Math.abs(i.y-o.y)>Math.abs(i.x-o.x)*l?{useVertical:!0}:(n===a.WritingMode.vertical?o.y<i.y:o.x>i.x)?{needsFlipping:!0}:null}function gs(n,o,i,l,w,z,j,ae,Se,He,xt,Et,Tt,Jt){var Yt,gr=o/24,Vt=n.lineOffsetX*gr,mr=n.lineOffsetY*gr;if(n.numGlyphs>1){var Ar=n.glyphStartIndex+n.numGlyphs,Xr=n.lineStartIndex,cn=n.lineStartIndex+n.lineLength,nn=ya(gr,ae,Vt,mr,i,xt,Et,n,Se,z,Tt);if(!nn)return{notEnoughRoom:!0};var pn=qa(nn.first.point,j).point,Bn=qa(nn.last.point,j).point;if(l&&!i){var Zn=Gt(n.writingMode,pn,Bn,Jt);if(Zn)return Zn}Yt=[nn.first];for(var Vn=n.glyphStartIndex+1;Vn<Ar-1;Vn++)Yt.push(So(gr*ae.getoffsetX(Vn),Vt,mr,i,xt,Et,n.segment,Xr,cn,Se,z,Tt));Yt.push(nn.last)}else{if(l&&!i){var Si=qa(Et,w).point,Zi=n.lineStartIndex+n.segment+1,ca=new a.Point(Se.getx(Zi),Se.gety(Zi)),ma=qa(ca,w),Co=ma.signedDistanceFromCamera>0?ma.point:Qi(Et,ca,Si,1,w),Pi=Gt(n.writingMode,Si,Co,Jt);if(Pi)return Pi}var Ha=So(gr*ae.getoffsetX(n.glyphStartIndex),Vt,mr,i,xt,Et,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,Se,z,Tt);if(!Ha)return{notEnoughRoom:!0};Yt=[Ha]}for(var Ma=0,Ba=Yt;Ma<Ba.length;Ma+=1){var Ea=Ba[Ma];a.addDynamicAttributes(He,Ea.point,Ea.angle)}return{}}function Qi(n,o,i,l,w){var z=qa(n.add(n.sub(o)._unit()),w).point,j=i.sub(z);return i.add(j._mult(l/j.mag()))}function So(n,o,i,l,w,z,j,ae,Se,He,xt,Et){var Tt=l?n-o:n+o,Jt=Tt>0?1:-1,Yt=0;l&&(Jt*=-1,Yt=Math.PI),Jt<0&&(Yt+=Math.PI);for(var gr=Jt>0?ae+j:ae+j+1,Vt=w,mr=w,Ar=0,Xr=0,cn=Math.abs(Tt),nn=[];Ar+Xr<=cn;){if((gr+=Jt)<ae||gr>=Se)return null;if(mr=Vt,nn.push(Vt),(Vt=Et[gr])===void 0){var pn=new a.Point(He.getx(gr),He.gety(gr)),Bn=qa(pn,xt);if(Bn.signedDistanceFromCamera>0)Vt=Et[gr]=Bn.point;else{var Zn=gr-Jt;Vt=Qi(Ar===0?z:new a.Point(He.getx(Zn),He.gety(Zn)),pn,mr,cn-Ar+1,xt)}}Ar+=Xr,Xr=mr.dist(Vt)}var Vn=(cn-Ar)/Xr,Si=Vt.sub(mr),Zi=Si.mult(Vn)._add(mr);Zi._add(Si._unit()._perp()._mult(i*Jt));var ca=Yt+Math.atan2(Vt.y-mr.y,Vt.x-mr.x);return nn.push(Zi),{point:Zi,angle:ca,path:nn}}eo.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},eo.prototype.insert=function(n,o,i,l,w){this._forEachCell(o,i,l,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(o),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(w)},eo.prototype.insertCircle=function(n,o,i,l){this._forEachCell(o-l,i-l,o+l,i+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(o),this.circles.push(i),this.circles.push(l)},eo.prototype._insertBoxCell=function(n,o,i,l,w,z){this.boxCells[w].push(z)},eo.prototype._insertCircleCell=function(n,o,i,l,w,z){this.circleCells[w].push(z)},eo.prototype._query=function(n,o,i,l,w,z){if(i<0||n>this.width||l<0||o>this.height)return!w&&[];var j=[];if(n<=0&&o<=0&&this.width<=i&&this.height<=l){if(w)return!0;for(var ae=0;ae<this.boxKeys.length;ae++)j.push({key:this.boxKeys[ae],x1:this.bboxes[4*ae],y1:this.bboxes[4*ae+1],x2:this.bboxes[4*ae+2],y2:this.bboxes[4*ae+3]});for(var Se=0;Se<this.circleKeys.length;Se++){var He=this.circles[3*Se],xt=this.circles[3*Se+1],Et=this.circles[3*Se+2];j.push({key:this.circleKeys[Se],x1:He-Et,y1:xt-Et,x2:He+Et,y2:xt+Et})}return z?j.filter(z):j}return this._forEachCell(n,o,i,l,this._queryCell,j,{hitTest:w,seenUids:{box:{},circle:{}}},z),w?j.length>0:j},eo.prototype._queryCircle=function(n,o,i,l,w){var z=n-i,j=n+i,ae=o-i,Se=o+i;if(j<0||z>this.width||Se<0||ae>this.height)return!l&&[];var He=[];return this._forEachCell(z,ae,j,Se,this._queryCellCircle,He,{hitTest:l,circle:{x:n,y:o,radius:i},seenUids:{box:{},circle:{}}},w),l?He.length>0:He},eo.prototype.query=function(n,o,i,l,w){return this._query(n,o,i,l,!1,w)},eo.prototype.hitTest=function(n,o,i,l,w){return this._query(n,o,i,l,!0,w)},eo.prototype.hitTestCircle=function(n,o,i,l){return this._queryCircle(n,o,i,!0,l)},eo.prototype._queryCell=function(n,o,i,l,w,z,j,ae){var Se=j.seenUids,He=this.boxCells[w];if(He!==null)for(var xt=this.bboxes,Et=0,Tt=He;Et<Tt.length;Et+=1){var Jt=Tt[Et];if(!Se.box[Jt]){Se.box[Jt]=!0;var Yt=4*Jt;if(n<=xt[Yt+2]&&o<=xt[Yt+3]&&i>=xt[Yt+0]&&l>=xt[Yt+1]&&(!ae||ae(this.boxKeys[Jt]))){if(j.hitTest)return z.push(!0),!0;z.push({key:this.boxKeys[Jt],x1:xt[Yt],y1:xt[Yt+1],x2:xt[Yt+2],y2:xt[Yt+3]})}}}var gr=this.circleCells[w];if(gr!==null)for(var Vt=this.circles,mr=0,Ar=gr;mr<Ar.length;mr+=1){var Xr=Ar[mr];if(!Se.circle[Xr]){Se.circle[Xr]=!0;var cn=3*Xr;if(this._circleAndRectCollide(Vt[cn],Vt[cn+1],Vt[cn+2],n,o,i,l)&&(!ae||ae(this.circleKeys[Xr]))){if(j.hitTest)return z.push(!0),!0;var nn=Vt[cn],pn=Vt[cn+1],Bn=Vt[cn+2];z.push({key:this.circleKeys[Xr],x1:nn-Bn,y1:pn-Bn,x2:nn+Bn,y2:pn+Bn})}}}},eo.prototype._queryCellCircle=function(n,o,i,l,w,z,j,ae){var Se=j.circle,He=j.seenUids,xt=this.boxCells[w];if(xt!==null)for(var Et=this.bboxes,Tt=0,Jt=xt;Tt<Jt.length;Tt+=1){var Yt=Jt[Tt];if(!He.box[Yt]){He.box[Yt]=!0;var gr=4*Yt;if(this._circleAndRectCollide(Se.x,Se.y,Se.radius,Et[gr+0],Et[gr+1],Et[gr+2],Et[gr+3])&&(!ae||ae(this.boxKeys[Yt])))return z.push(!0),!0}}var Vt=this.circleCells[w];if(Vt!==null)for(var mr=this.circles,Ar=0,Xr=Vt;Ar<Xr.length;Ar+=1){var cn=Xr[Ar];if(!He.circle[cn]){He.circle[cn]=!0;var nn=3*cn;if(this._circlesCollide(mr[nn],mr[nn+1],mr[nn+2],Se.x,Se.y,Se.radius)&&(!ae||ae(this.circleKeys[cn])))return z.push(!0),!0}}},eo.prototype._forEachCell=function(n,o,i,l,w,z,j,ae){for(var Se=this._convertToXCellCoord(n),He=this._convertToYCellCoord(o),xt=this._convertToXCellCoord(i),Et=this._convertToYCellCoord(l),Tt=Se;Tt<=xt;Tt++)for(var Jt=He;Jt<=Et;Jt++)if(w.call(this,n,o,i,l,this.xCellCount*Jt+Tt,z,j,ae))return},eo.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},eo.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},eo.prototype._circlesCollide=function(n,o,i,l,w,z){var j=l-n,ae=w-o,Se=i+z;return Se*Se>j*j+ae*ae},eo.prototype._circleAndRectCollide=function(n,o,i,l,w,z,j){var ae=(z-l)/2,Se=Math.abs(n-(l+ae));if(Se>ae+i)return!1;var He=(j-w)/2,xt=Math.abs(o-(w+He));if(xt>He+i)return!1;if(Se<=ae||xt<=He)return!0;var Et=Se-ae,Tt=xt-He;return Et*Et+Tt*Tt<=i*i};var ll=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ss(n,o){for(var i=0;i<n;i++){var l=o.length;o.resize(l+4),o.float32.set(ll,3*l)}}function rs(n,o,i){var l=o[0],w=o[1];return n[0]=i[0]*l+i[4]*w+i[12],n[1]=i[1]*l+i[5]*w+i[13],n[3]=i[3]*l+i[7]*w+i[15],n}var ls=function(n,o,i){o===void 0&&(o=new eo(n.width+200,n.height+200,25)),i===void 0&&(i=new eo(n.width+200,n.height+200,25)),this.transform=n,this.grid=o,this.ignoredGrid=i,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Ia(n,o,i){return o*(a.EXTENT/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}ls.prototype.placeCollisionBox=function(n,o,i,l,w){var z=this.projectAndGetPerspectiveRatio(l,n.anchorPointX,n.anchorPointY),j=i*z.perspectiveRatio,ae=n.x1*j+z.point.x,Se=n.y1*j+z.point.y,He=n.x2*j+z.point.x,xt=n.y2*j+z.point.y;return!this.isInsideGrid(ae,Se,He,xt)||!o&&this.grid.hitTest(ae,Se,He,xt,w)?{box:[],offscreen:!1}:{box:[ae,Se,He,xt],offscreen:this.isOffscreen(ae,Se,He,xt)}},ls.prototype.placeCollisionCircles=function(n,o,i,l,w,z,j,ae,Se,He,xt,Et,Tt){var Jt=[],Yt=new a.Point(o.anchorX,o.anchorY),gr=qa(Yt,z),Vt=ba(this.transform.cameraToCenterDistance,gr.signedDistanceFromCamera),mr=(He?w/Vt:w*Vt)/a.ONE_EM,Ar=qa(Yt,j).point,Xr=ya(mr,l,o.lineOffsetX*mr,o.lineOffsetY*mr,!1,Ar,Yt,o,i,j,{}),cn=!1,nn=!1,pn=!0;if(Xr){for(var Bn=.5*Et*Vt+Tt,Zn=new a.Point(-100,-100),Vn=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),Si=new ei,Zi=Xr.first,ca=Xr.last,ma=[],Co=Zi.path.length-1;Co>=1;Co--)ma.push(Zi.path[Co]);for(var Pi=1;Pi<ca.path.length;Pi++)ma.push(ca.path[Pi]);var Ha=2.5*Bn;if(ae){var Ma=ma.map(function(Fs){return qa(Fs,ae)});ma=Ma.some(function(Fs){return Fs.signedDistanceFromCamera<=0})?[]:Ma.map(function(Fs){return Fs.point})}var Ba=[];if(ma.length>0){for(var Ea=ma[0].clone(),oo=ma[0].clone(),Pa=1;Pa<ma.length;Pa++)Ea.x=Math.min(Ea.x,ma[Pa].x),Ea.y=Math.min(Ea.y,ma[Pa].y),oo.x=Math.max(oo.x,ma[Pa].x),oo.y=Math.max(oo.y,ma[Pa].y);Ba=Ea.x>=Zn.x&&oo.x<=Vn.x&&Ea.y>=Zn.y&&oo.y<=Vn.y?[ma]:oo.x<Zn.x||Ea.x>Vn.x||oo.y<Zn.y||Ea.y>Vn.y?[]:a.clipLine([ma],Zn.x,Zn.y,Vn.x,Vn.y)}for(var Aa=0,eu=Ba;Aa<eu.length;Aa+=1){var As;Si.reset(eu[Aa],.25*Bn),As=Si.length<=.5*Bn?1:Math.ceil(Si.paddedLength/Ha)+1;for(var tu=0;tu<As;tu++){var Ls=tu/Math.max(As-1,1),Ho=Si.lerp(Ls),xs=Ho.x+100,zs=Ho.y+100;Jt.push(xs,zs,Bn,0);var yu=xs-Bn,Xc=zs-Bn,ou=xs+Bn,su=zs+Bn;if(pn=pn&&this.isOffscreen(yu,Xc,ou,su),nn=nn||this.isInsideGrid(yu,Xc,ou,su),!n&&this.grid.hitTestCircle(xs,zs,Bn,xt)&&(cn=!0,!Se))return{circles:[],offscreen:!1,collisionDetected:cn}}}}return{circles:!Se&&cn||!nn?[]:Jt,offscreen:pn,collisionDetected:cn}},ls.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var o=[],i=1/0,l=1/0,w=-1/0,z=-1/0,j=0,ae=n;j<ae.length;j+=1){var Se=ae[j],He=new a.Point(Se.x+100,Se.y+100);i=Math.min(i,He.x),l=Math.min(l,He.y),w=Math.max(w,He.x),z=Math.max(z,He.y),o.push(He)}for(var xt={},Et={},Tt=0,Jt=this.grid.query(i,l,w,z).concat(this.ignoredGrid.query(i,l,w,z));Tt<Jt.length;Tt+=1){var Yt=Jt[Tt],gr=Yt.key;if(xt[gr.bucketInstanceId]===void 0&&(xt[gr.bucketInstanceId]={}),!xt[gr.bucketInstanceId][gr.featureIndex]){var Vt=[new a.Point(Yt.x1,Yt.y1),new a.Point(Yt.x2,Yt.y1),new a.Point(Yt.x2,Yt.y2),new a.Point(Yt.x1,Yt.y2)];a.polygonIntersectsPolygon(o,Vt)&&(xt[gr.bucketInstanceId][gr.featureIndex]=!0,Et[gr.bucketInstanceId]===void 0&&(Et[gr.bucketInstanceId]=[]),Et[gr.bucketInstanceId].push(gr.featureIndex))}}return Et},ls.prototype.insertCollisionBox=function(n,o,i,l,w){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:l,collisionGroupID:w},n[0],n[1],n[2],n[3])},ls.prototype.insertCollisionCircles=function(n,o,i,l,w){for(var z=o?this.ignoredGrid:this.grid,j={bucketInstanceId:i,featureIndex:l,collisionGroupID:w},ae=0;ae<n.length;ae+=4)z.insertCircle(j,n[ae],n[ae+1],n[ae+2])},ls.prototype.projectAndGetPerspectiveRatio=function(n,o,i){var l=[o,i,0,1];return rs(l,l,n),{point:new a.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},ls.prototype.isOffscreen=function(n,o,i,l){return i<100||n>=this.screenRightBoundary||l<100||o>this.screenBottomBoundary},ls.prototype.isInsideGrid=function(n,o,i,l){return i>=0&&n<this.gridRightBoundary&&l>=0&&o<this.gridBottomBoundary},ls.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var Ms=function(n,o,i,l){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?o:-o))):l&&i?1:0,this.placed=i};Ms.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var uo=function(n,o,i,l,w){this.text=new Ms(n?n.text:null,o,i,w),this.icon=new Ms(n?n.icon:null,o,l,w)};uo.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Qs=function(n,o,i){this.text=n,this.icon=o,this.skipFade=i},Ao=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},Ts=function(n,o,i,l,w){this.bucketInstanceId=n,this.featureIndex=o,this.sourceLayerIndex=i,this.bucketIndex=l,this.tileID=w},ua=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function cs(n,o,i,l,w){var z=a.getAnchorAlignment(n),j=-(z.horizontalAlign-.5)*o,ae=-(z.verticalAlign-.5)*i,Se=a.evaluateVariableOffset(n,l);return new a.Point(j+Se[0]*w,ae+Se[1]*w)}function Ds(n,o,i,l,w,z){var j=n.x1,ae=n.x2,Se=n.y1,He=n.y2,xt=n.anchorPointX,Et=n.anchorPointY,Tt=new a.Point(o,i);return l&&Tt._rotate(w?z:-z),{x1:j+Tt.x,y1:Se+Tt.y,x2:ae+Tt.x,y2:He+Tt.y,anchorPointX:xt,anchorPointY:Et}}ua.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var o=++this.maxGroupID;this.collisionGroups[n]={ID:o,predicate:function(i){return i.collisionGroupID===o}}}return this.collisionGroups[n]};var Ro=function(n,o,i,l){this.transform=n.clone(),this.collisionIndex=new ls(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=o,this.retainedQueryData={},this.collisionGroups=new ua(i),this.collisionCircleArrays={},this.prevPlacement=l,l&&(l.prevPlacement=void 0),this.placedOrientations={}};function Eu(n,o,i,l,w){n.emplaceBack(o?1:0,i?1:0,l||0,w||0),n.emplaceBack(o?1:0,i?1:0,l||0,w||0),n.emplaceBack(o?1:0,i?1:0,l||0,w||0),n.emplaceBack(o?1:0,i?1:0,l||0,w||0)}Ro.prototype.getBucketParts=function(n,o,i,l){var w=i.getBucket(o),z=i.latestFeatureIndex;if(w&&z&&o.id===w.layerIds[0]){var j=i.collisionBoxArray,ae=w.layers[0].layout,Se=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),He=i.tileSize/a.EXTENT,xt=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),Et=ae.get("text-pitch-alignment")==="map",Tt=ae.get("text-rotation-alignment")==="map",Jt=Ia(i,1,this.transform.zoom),Yt=ra(xt,Et,Tt,this.transform,Jt),gr=null;if(Et){var Vt=Rn(xt,Et,Tt,this.transform,Jt);gr=a.multiply([],this.transform.labelPlaneMatrix,Vt)}this.retainedQueryData[w.bucketInstanceId]=new Ts(w.bucketInstanceId,z,w.sourceLayerIndex,w.index,i.tileID);var mr={bucket:w,layout:ae,posMatrix:xt,textLabelPlaneMatrix:Yt,labelToScreenMatrix:gr,scale:Se,textPixelRatio:He,holdingForFade:i.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(l)for(var Ar=0,Xr=w.sortKeyRanges;Ar<Xr.length;Ar+=1){var cn=Xr[Ar];n.push({sortKey:cn.sortKey,symbolInstanceStart:cn.symbolInstanceStart,symbolInstanceEnd:cn.symbolInstanceEnd,parameters:mr})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:mr})}},Ro.prototype.attemptAnchorPlacement=function(n,o,i,l,w,z,j,ae,Se,He,xt,Et,Tt,Jt,Yt){var gr,Vt=[Et.textOffset0,Et.textOffset1],mr=cs(n,i,l,Vt,w),Ar=this.collisionIndex.placeCollisionBox(Ds(o,mr.x,mr.y,z,j,this.transform.angle),xt,ae,Se,He.predicate);if(!Yt||this.collisionIndex.placeCollisionBox(Ds(Yt,mr.x,mr.y,z,j,this.transform.angle),xt,ae,Se,He.predicate).box.length!==0)return Ar.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Et.crossTileID]&&this.prevPlacement.placements[Et.crossTileID]&&this.prevPlacement.placements[Et.crossTileID].text&&(gr=this.prevPlacement.variableOffsets[Et.crossTileID].anchor),this.variableOffsets[Et.crossTileID]={textOffset:Vt,width:i,height:l,anchor:n,textBoxScale:w,prevAnchor:gr},this.markUsedJustification(Tt,n,Et,Jt),Tt.allowVerticalPlacement&&(this.markUsedOrientation(Tt,Jt,Et),this.placedOrientations[Et.crossTileID]=Jt),{shift:mr,placedGlyphBoxes:Ar}):void 0},Ro.prototype.placeLayerBucketPart=function(n,o,i){var l=this,w=n.parameters,z=w.bucket,j=w.layout,ae=w.posMatrix,Se=w.textLabelPlaneMatrix,He=w.labelToScreenMatrix,xt=w.textPixelRatio,Et=w.holdingForFade,Tt=w.collisionBoxArray,Jt=w.partiallyEvaluatedTextSize,Yt=w.collisionGroup,gr=j.get("text-optional"),Vt=j.get("icon-optional"),mr=j.get("text-allow-overlap"),Ar=j.get("icon-allow-overlap"),Xr=j.get("text-rotation-alignment")==="map",cn=j.get("text-pitch-alignment")==="map",nn=j.get("icon-text-fit")!=="none",pn=j.get("symbol-z-order")==="viewport-y",Bn=mr&&(Ar||!z.hasIconData()||Vt),Zn=Ar&&(mr||!z.hasTextData()||gr);!z.collisionArrays&&Tt&&z.deserializeCollisionBoxes(Tt);var Vn=function(Pi,Ha){if(!o[Pi.crossTileID])if(Et)l.placements[Pi.crossTileID]=new Qs(!1,!1,!1);else{var Ma,Ba=!1,Ea=!1,oo=!0,Pa=null,Aa={box:null,offscreen:null},eu={box:null,offscreen:null},As=null,tu=null,Ls=0,Ho=0,xs=0;Ha.textFeatureIndex?Ls=Ha.textFeatureIndex:Pi.useRuntimeCollisionCircles&&(Ls=Pi.featureIndex),Ha.verticalTextFeatureIndex&&(Ho=Ha.verticalTextFeatureIndex);var zs=Ha.textBox;if(zs){var yu=function(Uo){var rl=a.WritingMode.horizontal;if(z.allowVerticalPlacement&&!Uo&&l.prevPlacement){var uu=l.prevPlacement.placedOrientations[Pi.crossTileID];uu&&(l.placedOrientations[Pi.crossTileID]=uu,l.markUsedOrientation(z,rl=uu,Pi))}return rl},Xc=function(Uo,rl){if(z.allowVerticalPlacement&&Pi.numVerticalGlyphVertices>0&&Ha.verticalTextBox)for(var uu=0,vc=z.writingModes;uu<vc.length&&(vc[uu]===a.WritingMode.vertical?(Aa=rl(),eu=Aa):Aa=Uo(),!(Aa&&Aa.box&&Aa.box.length));uu+=1);else Aa=Uo()};if(j.get("text-variable-anchor")){var ou=j.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[Pi.crossTileID]){var su=l.prevPlacement.variableOffsets[Pi.crossTileID];ou.indexOf(su.anchor)>0&&(ou=ou.filter(function(Uo){return Uo!==su.anchor})).unshift(su.anchor)}var Fs=function(Uo,rl,uu){for(var vc=Uo.x2-Uo.x1,jf=Uo.y2-Uo.y1,Pc=Pi.textBoxScale,Lf=nn&&!Ar?rl:null,Rl={box:[],offscreen:!1},Du=mr?2*ou.length:ou.length,ku=0;ku<Du;++ku){var Lc=l.attemptAnchorPlacement(ou[ku%ou.length],Uo,vc,jf,Pc,Xr,cn,xt,ae,Yt,ku>=ou.length,Pi,z,uu,Lf);if(Lc&&(Rl=Lc.placedGlyphBoxes)&&Rl.box&&Rl.box.length){Ba=!0,Pa=Lc.shift;break}}return Rl};Xc(function(){return Fs(zs,Ha.iconBox,a.WritingMode.horizontal)},function(){var Uo=Ha.verticalTextBox;return z.allowVerticalPlacement&&!(Aa&&Aa.box&&Aa.box.length)&&Pi.numVerticalGlyphVertices>0&&Uo?Fs(Uo,Ha.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),Aa&&(Ba=Aa.box,oo=Aa.offscreen);var uf=yu(Aa&&Aa.box);if(!Ba&&l.prevPlacement){var tl=l.prevPlacement.variableOffsets[Pi.crossTileID];tl&&(l.variableOffsets[Pi.crossTileID]=tl,l.markUsedJustification(z,tl.anchor,Pi,uf))}}else{var Ol=function(Uo,rl){var uu=l.collisionIndex.placeCollisionBox(Uo,mr,xt,ae,Yt.predicate);return uu&&uu.box&&uu.box.length&&(l.markUsedOrientation(z,rl,Pi),l.placedOrientations[Pi.crossTileID]=rl),uu};Xc(function(){return Ol(zs,a.WritingMode.horizontal)},function(){var Uo=Ha.verticalTextBox;return z.allowVerticalPlacement&&Pi.numVerticalGlyphVertices>0&&Uo?Ol(Uo,a.WritingMode.vertical):{box:null,offscreen:null}}),yu(Aa&&Aa.box&&Aa.box.length)}}if(Ba=(Ma=Aa)&&Ma.box&&Ma.box.length>0,oo=Ma&&Ma.offscreen,Pi.useRuntimeCollisionCircles){var wc=z.text.placedSymbolArray.get(Pi.centerJustifiedTextSymbolIndex),Mc=a.evaluateSizeForFeature(z.textSizeData,Jt,wc),Us=j.get("text-padding");As=l.collisionIndex.placeCollisionCircles(mr,wc,z.lineVertexArray,z.glyphOffsetArray,Mc,ae,Se,He,i,cn,Yt.predicate,Pi.collisionCircleDiameter,Us),Ba=mr||As.circles.length>0&&!As.collisionDetected,oo=oo&&As.offscreen}if(Ha.iconFeatureIndex&&(xs=Ha.iconFeatureIndex),Ha.iconBox){var Yc=function(Uo){var rl=nn&&Pa?Ds(Uo,Pa.x,Pa.y,Xr,cn,l.transform.angle):Uo;return l.collisionIndex.placeCollisionBox(rl,Ar,xt,ae,Yt.predicate)};Ea=eu&&eu.box&&eu.box.length&&Ha.verticalIconBox?(tu=Yc(Ha.verticalIconBox)).box.length>0:(tu=Yc(Ha.iconBox)).box.length>0,oo=oo&&tu.offscreen}var Il=gr||Pi.numHorizontalGlyphVertices===0&&Pi.numVerticalGlyphVertices===0,Bs=Vt||Pi.numIconVertices===0;if(Il||Bs?Bs?Il||(Ea=Ea&&Ba):Ba=Ea&&Ba:Ea=Ba=Ea&&Ba,Ba&&Ma&&Ma.box&&l.collisionIndex.insertCollisionBox(Ma.box,j.get("text-ignore-placement"),z.bucketInstanceId,eu&&eu.box&&Ho?Ho:Ls,Yt.ID),Ea&&tu&&l.collisionIndex.insertCollisionBox(tu.box,j.get("icon-ignore-placement"),z.bucketInstanceId,xs,Yt.ID),As&&(Ba&&l.collisionIndex.insertCollisionCircles(As.circles,j.get("text-ignore-placement"),z.bucketInstanceId,Ls,Yt.ID),i)){var pc=z.bucketInstanceId,dc=l.collisionCircleArrays[pc];dc===void 0&&(dc=l.collisionCircleArrays[pc]=new Ao);for(var ql=0;ql<As.circles.length;ql+=4)dc.circles.push(As.circles[ql+0]),dc.circles.push(As.circles[ql+1]),dc.circles.push(As.circles[ql+2]),dc.circles.push(As.collisionDetected?1:0)}l.placements[Pi.crossTileID]=new Qs(Ba||Bn,Ea||Zn,oo||z.justReloaded),o[Pi.crossTileID]=!0}};if(pn)for(var Si=z.getSortedSymbolIndexes(this.transform.angle),Zi=Si.length-1;Zi>=0;--Zi){var ca=Si[Zi];Vn(z.symbolInstances.get(ca),z.collisionArrays[ca])}else for(var ma=n.symbolInstanceStart;ma<n.symbolInstanceEnd;ma++)Vn(z.symbolInstances.get(ma),z.collisionArrays[ma]);if(i&&z.bucketInstanceId in this.collisionCircleArrays){var Co=this.collisionCircleArrays[z.bucketInstanceId];a.invert(Co.invProjMatrix,ae),Co.viewportMatrix=this.collisionIndex.getViewportMatrix()}z.justReloaded=!1},Ro.prototype.markUsedJustification=function(n,o,i,l){var w;w=l===a.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(o)];for(var z=0,j=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];z<j.length;z+=1){var ae=j[z];ae>=0&&(n.text.placedSymbolArray.get(ae).crossTileID=w>=0&&ae!==w?0:i.crossTileID)}},Ro.prototype.markUsedOrientation=function(n,o,i){for(var l=o===a.WritingMode.horizontal||o===a.WritingMode.horizontalOnly?o:0,w=o===a.WritingMode.vertical?o:0,z=0,j=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];z<j.length;z+=1)n.text.placedSymbolArray.get(j[z]).placedOrientation=l;i.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=w)},Ro.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var o=this.prevPlacement,i=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;var l=o?o.symbolFadeChange(n):1,w=o?o.opacities:{},z=o?o.variableOffsets:{},j=o?o.placedOrientations:{};for(var ae in this.placements){var Se=this.placements[ae],He=w[ae];He?(this.opacities[ae]=new uo(He,l,Se.text,Se.icon),i=i||Se.text!==He.text.placed||Se.icon!==He.icon.placed):(this.opacities[ae]=new uo(null,l,Se.text,Se.icon,Se.skipFade),i=i||Se.text||Se.icon)}for(var xt in w){var Et=w[xt];if(!this.opacities[xt]){var Tt=new uo(Et,l,!1,!1);Tt.isHidden()||(this.opacities[xt]=Tt,i=i||Et.text.placed||Et.icon.placed)}}for(var Jt in z)this.variableOffsets[Jt]||!this.opacities[Jt]||this.opacities[Jt].isHidden()||(this.variableOffsets[Jt]=z[Jt]);for(var Yt in j)this.placedOrientations[Yt]||!this.opacities[Yt]||this.opacities[Yt].isHidden()||(this.placedOrientations[Yt]=j[Yt]);i?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:n)},Ro.prototype.updateLayerOpacities=function(n,o){for(var i={},l=0,w=o;l<w.length;l+=1){var z=w[l],j=z.getBucket(n);j&&z.latestFeatureIndex&&n.id===j.layerIds[0]&&this.updateBucketOpacities(j,i,z.collisionBoxArray)}},Ro.prototype.updateBucketOpacities=function(n,o,i){var l=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var w=n.layers[0].layout,z=new uo(null,0,!1,!1,!0),j=w.get("text-allow-overlap"),ae=w.get("icon-allow-overlap"),Se=w.get("text-variable-anchor"),He=w.get("text-rotation-alignment")==="map",xt=w.get("text-pitch-alignment")==="map",Et=w.get("icon-text-fit")!=="none",Tt=new uo(null,0,j&&(ae||!n.hasIconData()||w.get("icon-optional")),ae&&(j||!n.hasTextData()||w.get("text-optional")),!0);!n.collisionArrays&&i&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(i);for(var Jt=function(mr,Ar,Xr){for(var cn=0;cn<Ar/4;cn++)mr.opacityVertexArray.emplaceBack(Xr)},Yt=function(mr){var Ar=n.symbolInstances.get(mr),Xr=Ar.numHorizontalGlyphVertices,cn=Ar.numVerticalGlyphVertices,nn=Ar.crossTileID,pn=l.opacities[nn];o[nn]?pn=z:pn||(l.opacities[nn]=pn=Tt),o[nn]=!0;var Bn=Ar.numIconVertices>0,Zn=l.placedOrientations[Ar.crossTileID],Vn=Zn===a.WritingMode.vertical,Si=Zn===a.WritingMode.horizontal||Zn===a.WritingMode.horizontalOnly;if(Xr>0||cn>0){var Zi=Gi(pn.text);Jt(n.text,Xr,Vn?to:Zi),Jt(n.text,cn,Si?to:Zi);var ca=pn.text.isHidden();[Ar.rightJustifiedTextSymbolIndex,Ar.centerJustifiedTextSymbolIndex,Ar.leftJustifiedTextSymbolIndex].forEach(function(Aa){Aa>=0&&(n.text.placedSymbolArray.get(Aa).hidden=ca||Vn?1:0)}),Ar.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(Ar.verticalPlacedTextSymbolIndex).hidden=ca||Si?1:0);var ma=l.variableOffsets[Ar.crossTileID];ma&&l.markUsedJustification(n,ma.anchor,Ar,Zn);var Co=l.placedOrientations[Ar.crossTileID];Co&&(l.markUsedJustification(n,"left",Ar,Co),l.markUsedOrientation(n,Co,Ar))}if(Bn){var Pi=Gi(pn.icon),Ha=!(Et&&Ar.verticalPlacedIconSymbolIndex&&Vn);Ar.placedIconSymbolIndex>=0&&(Jt(n.icon,Ar.numIconVertices,Ha?Pi:to),n.icon.placedSymbolArray.get(Ar.placedIconSymbolIndex).hidden=pn.icon.isHidden()),Ar.verticalPlacedIconSymbolIndex>=0&&(Jt(n.icon,Ar.numVerticalIconVertices,Ha?to:Pi),n.icon.placedSymbolArray.get(Ar.verticalPlacedIconSymbolIndex).hidden=pn.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Ma=n.collisionArrays[mr];if(Ma){var Ba=new a.Point(0,0);if(Ma.textBox||Ma.verticalTextBox){var Ea=!0;if(Se){var oo=l.variableOffsets[nn];oo?(Ba=cs(oo.anchor,oo.width,oo.height,oo.textOffset,oo.textBoxScale),He&&Ba._rotate(xt?l.transform.angle:-l.transform.angle)):Ea=!1}Ma.textBox&&Eu(n.textCollisionBox.collisionVertexArray,pn.text.placed,!Ea||Vn,Ba.x,Ba.y),Ma.verticalTextBox&&Eu(n.textCollisionBox.collisionVertexArray,pn.text.placed,!Ea||Si,Ba.x,Ba.y)}var Pa=Boolean(!Si&&Ma.verticalIconBox);Ma.iconBox&&Eu(n.iconCollisionBox.collisionVertexArray,pn.icon.placed,Pa,Et?Ba.x:0,Et?Ba.y:0),Ma.verticalIconBox&&Eu(n.iconCollisionBox.collisionVertexArray,pn.icon.placed,!Pa,Et?Ba.x:0,Et?Ba.y:0)}}},gr=0;gr<n.symbolInstances.length;gr++)Yt(gr);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Vt=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Vt.invProjMatrix,n.placementViewportMatrix=Vt.viewportMatrix,n.collisionCircleArray=Vt.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Ro.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ro.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Ro.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Ro.prototype.stillRecent=function(n,o){var i=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*i>n},Ro.prototype.setStale=function(){this.stale=!0};var ec=Math.pow(2,25),Gs=Math.pow(2,24),ft=Math.pow(2,17),St=Math.pow(2,16),_r=Math.pow(2,9),Or=Math.pow(2,8),$n=Math.pow(2,1);function Gi(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var o=n.placed?1:0,i=Math.floor(127*n.opacity);return i*ec+o*Gs+i*ft+o*St+i*_r+o*Or+i*$n+o}var to=0,Je=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Je.prototype.continuePlacement=function(n,o,i,l,w){for(var z=this._bucketParts;this._currentTileIndex<n.length;)if(o.getBucketParts(z,l,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort(function(j,ae){return j.sortKey-ae.sortKey}));this._currentPartIndex<z.length;)if(o.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,w())return!0;return!1};var It=function(n,o,i,l,w,z,j){this.placement=new Ro(n,w,z,j),this._currentPlacementIndex=o.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=l,this._done=!1};It.prototype.isDone=function(){return this._done},It.prototype.continuePlacement=function(n,o,i){for(var l=this,w=a.browser.now(),z=function(){var Se=a.browser.now()-w;return!l._forceFullPlacement&&Se>2};this._currentPlacementIndex>=0;){var j=o[n[this._currentPlacementIndex]],ae=this.placement.collisionIndex.transform.zoom;if(j.type==="symbol"&&(!j.minzoom||j.minzoom<=ae)&&(!j.maxzoom||j.maxzoom>ae)){if(this._inProgressLayer||(this._inProgressLayer=new Je(j)),this._inProgressLayer.continuePlacement(i[j.source],this.placement,this._showCollisionBoxes,j,z))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},It.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Ot=512/a.EXTENT/2,Xt=function(n,o,i){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(var l=0;l<o.length;l++){var w=o.get(l),z=w.key;this.indexedSymbolInstances[z]||(this.indexedSymbolInstances[z]=[]),this.indexedSymbolInstances[z].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,n)})}};Xt.prototype.getScaledCoordinates=function(n,o){var i=Ot/Math.pow(2,o.canonical.z-this.tileID.canonical.z);return{x:Math.floor((o.canonical.x*a.EXTENT+n.anchorX)*i),y:Math.floor((o.canonical.y*a.EXTENT+n.anchorY)*i)}},Xt.prototype.findMatches=function(n,o,i){for(var l=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z),w=0;w<n.length;w++){var z=n.get(w);if(!z.crossTileID){var j=this.indexedSymbolInstances[z.key];if(j)for(var ae=this.getScaledCoordinates(z,o),Se=0,He=j;Se<He.length;Se+=1){var xt=He[Se];if(Math.abs(xt.coord.x-ae.x)<=l&&Math.abs(xt.coord.y-ae.y)<=l&&!i[xt.crossTileID]){i[xt.crossTileID]=!0,z.crossTileID=xt.crossTileID;break}}}}};var Dr=function(){this.maxCrossTileID=0};Dr.prototype.generate=function(){return++this.maxCrossTileID};var Lr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Lr.prototype.handleWrapJump=function(n){var o=Math.round((n-this.lng)/360);if(o!==0)for(var i in this.indexes){var l=this.indexes[i],w={};for(var z in l){var j=l[z];j.tileID=j.tileID.unwrapTo(j.tileID.wrap+o),w[j.tileID.key]=j}this.indexes[i]=w}this.lng=n},Lr.prototype.addBucket=function(n,o,i){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var l=0;l<o.symbolInstances.length;l++)o.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var w=this.usedCrossTileIDs[n.overscaledZ];for(var z in this.indexes){var j=this.indexes[z];if(Number(z)>n.overscaledZ)for(var ae in j){var Se=j[ae];Se.tileID.isChildOf(n)&&Se.findMatches(o.symbolInstances,n,w)}else{var He=j[n.scaledTo(Number(z)).key];He&&He.findMatches(o.symbolInstances,n,w)}}for(var xt=0;xt<o.symbolInstances.length;xt++){var Et=o.symbolInstances.get(xt);Et.crossTileID||(Et.crossTileID=i.generate(),w[Et.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Xt(n,o.symbolInstances,o.bucketInstanceId),!0},Lr.prototype.removeBucketCrossTileIDs=function(n,o){for(var i in o.indexedSymbolInstances)for(var l=0,w=o.indexedSymbolInstances[i];l<w.length;l+=1)delete this.usedCrossTileIDs[n][w[l].crossTileID]},Lr.prototype.removeStaleBuckets=function(n){var o=!1;for(var i in this.indexes){var l=this.indexes[i];for(var w in l)n[l[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,l[w]),delete l[w],o=!0)}return o};var _n=function(){this.layerIndexes={},this.crossTileIDs=new Dr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};_n.prototype.addLayer=function(n,o,i){var l=this.layerIndexes[n.id];l===void 0&&(l=this.layerIndexes[n.id]=new Lr);var w=!1,z={};l.handleWrapJump(i);for(var j=0,ae=o;j<ae.length;j+=1){var Se=ae[j],He=Se.getBucket(n);He&&n.id===He.layerIds[0]&&(He.bucketInstanceId||(He.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(Se.tileID,He,this.crossTileIDs)&&(w=!0),z[He.bucketInstanceId]=!0)}return l.removeStaleBuckets(z)&&(w=!0),w},_n.prototype.pruneUnusedLayers=function(n){var o={};for(var i in n.forEach(function(l){o[l]=!0}),this.layerIndexes)o[i]||delete this.layerIndexes[i]};var Un=function(n,o){return a.emitValidationErrors(n,o&&o.filter(function(i){return i.identifier!=="source.canvas"}))},mn=a.pick(ui,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),mi=a.pick(ui,["setCenter","setZoom","setBearing","setPitch"]),Oa=function(){var n={},o=a.styleSpec.$version;for(var i in a.styleSpec.$root){var l,w=a.styleSpec.$root[i];w.required&&(l=i==="version"?o:w.type==="array"?[]:{})!=null&&(n[i]=l)}return n}(),Fn=function(n){function o(i,l){var w=this;l===void 0&&(l={}),n.call(this),this.map=i,this.dispatcher=new Fe(Pr(),this),this.imageManager=new rt,this.imageManager.setEventedParent(this),this.glyphManager=new Ge(i._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Ce(256,512),this.crossTileSymbolIndex=new _n,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var z=this;this._rtlTextPluginCallback=o.registerForPluginStateChange(function(j){z.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:j.pluginStatus,pluginURL:j.pluginURL},function(ae,Se){if(a.triggerPluginCompletionEvent(ae),Se&&Se.every(function(xt){return xt}))for(var He in z.sourceCaches)z.sourceCaches[He].reload()})}),this.on("data",function(j){if(j.dataType==="source"&&j.sourceDataType==="metadata"){var ae=w.sourceCaches[j.sourceId];if(ae){var Se=ae.getSource();if(Se&&Se.vectorLayerIds)for(var He in w._layers){var xt=w._layers[He];xt.source===Se.id&&w._validateLayer(xt)}}}})}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.loadURL=function(i,l){var w=this;l===void 0&&(l={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var z=typeof l.validate=="boolean"?l.validate:!a.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,l.accessToken);var j=this.map._requestManager.transformRequest(i,a.ResourceType.Style);this._request=a.getJSON(j,function(ae,Se){w._request=null,ae?w.fire(new a.ErrorEvent(ae)):Se&&w._load(Se,z)})},o.prototype.loadJSON=function(i,l){var w=this;l===void 0&&(l={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){w._request=null,w._load(i,l.validate!==!1)})},o.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Oa,!1)},o.prototype._load=function(i,l){if(!l||!Un(this,a.validateStyle(i))){for(var w in this._loaded=!0,this.stylesheet=i,i.sources)this.addSource(w,i.sources[w],{validate:!1});i.sprite?this._loadSprite(i.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(i.glyphs);var z=Jn(this.stylesheet.layers);this._order=z.map(function(He){return He.id}),this._layers={},this._serializedLayers={};for(var j=0,ae=z;j<ae.length;j+=1){var Se=ae[j];(Se=a.createStyleLayer(Se)).setEventedParent(this,{layer:{id:Se.id}}),this._layers[Se.id]=Se,this._serializedLayers[Se.id]=Se.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Le(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},o.prototype._loadSprite=function(i){var l=this;this._spriteRequest=function(w,z,j){var ae,Se,He,xt=a.browser.devicePixelRatio>1?"@2x":"",Et=a.getJSON(z.transformRequest(z.normalizeSpriteURL(w,xt,".json"),a.ResourceType.SpriteJSON),function(Yt,gr){Et=null,He||(He=Yt,ae=gr,Jt())}),Tt=a.getImage(z.transformRequest(z.normalizeSpriteURL(w,xt,".png"),a.ResourceType.SpriteImage),function(Yt,gr){Tt=null,He||(He=Yt,Se=gr,Jt())});function Jt(){if(He)j(He);else if(ae&&Se){var Yt=a.browser.getImageData(Se),gr={};for(var Vt in ae){var mr=ae[Vt],Ar=mr.width,Xr=mr.height,cn=mr.x,nn=mr.y,pn=mr.sdf,Bn=mr.pixelRatio,Zn=mr.stretchX,Vn=mr.stretchY,Si=mr.content,Zi=new a.RGBAImage({width:Ar,height:Xr});a.RGBAImage.copy(Yt,Zi,{x:cn,y:nn},{x:0,y:0},{width:Ar,height:Xr}),gr[Vt]={data:Zi,pixelRatio:Bn,sdf:pn,stretchX:Zn,stretchY:Vn,content:Si}}j(null,gr)}}return{cancel:function(){Et&&(Et.cancel(),Et=null),Tt&&(Tt.cancel(),Tt=null)}}}(i,this.map._requestManager,function(w,z){if(l._spriteRequest=null,w)l.fire(new a.ErrorEvent(w));else if(z)for(var j in z)l.imageManager.addImage(j,z[j]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new a.Event("data",{dataType:"style"}))})},o.prototype._validateLayer=function(i){var l=this.sourceCaches[i.source];if(l){var w=i.sourceLayer;if(w){var z=l.getSource();(z.type==="geojson"||z.vectorLayerIds&&z.vectorLayerIds.indexOf(w)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+w+'" does not exist on source "'+z.id+'" as specified by style layer "'+i.id+'"')))}}},o.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()},o.prototype._serializeLayers=function(i){for(var l=[],w=0,z=i;w<z.length;w+=1){var j=this._layers[z[w]];j.type!=="custom"&&l.push(j.serialize())}return l},o.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},o.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},o.prototype.update=function(i){if(this._loaded){var l=this._changed;if(this._changed){var w=Object.keys(this._updatedLayers),z=Object.keys(this._removedLayers);for(var j in(w.length||z.length)&&this._updateWorkerLayers(w,z),this._updatedSources){var ae=this._updatedSources[j];ae==="reload"?this._reloadSource(j):ae==="clear"&&this._clearSource(j)}for(var Se in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Se].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}var He={};for(var xt in this.sourceCaches){var Et=this.sourceCaches[xt];He[xt]=Et.used,Et.used=!1}for(var Tt=0,Jt=this._order;Tt<Jt.length;Tt+=1){var Yt=this._layers[Jt[Tt]];Yt.recalculate(i,this._availableImages),!Yt.isHidden(i.zoom)&&Yt.source&&(this.sourceCaches[Yt.source].used=!0)}for(var gr in He){var Vt=this.sourceCaches[gr];He[gr]!==Vt.used&&Vt.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:gr}))}this.light.recalculate(i),this.z=i.zoom,l&&this.fire(new a.Event("data",{dataType:"style"}))}},o.prototype._updateTilesForChangedImages=function(){var i=Object.keys(this._changedImages);if(i.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}},o.prototype._updateWorkerLayers=function(i,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:l})},o.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},o.prototype.setState=function(i){var l=this;if(this._checkLoaded(),Un(this,a.validateStyle(i)))return!1;(i=a.clone$1(i)).layers=Jn(i.layers);var w=function(j,ae){if(!j)return[{command:ui.setStyle,args:[ae]}];var Se=[];try{if(!a.deepEqual(j.version,ae.version))return[{command:ui.setStyle,args:[ae]}];a.deepEqual(j.center,ae.center)||Se.push({command:ui.setCenter,args:[ae.center]}),a.deepEqual(j.zoom,ae.zoom)||Se.push({command:ui.setZoom,args:[ae.zoom]}),a.deepEqual(j.bearing,ae.bearing)||Se.push({command:ui.setBearing,args:[ae.bearing]}),a.deepEqual(j.pitch,ae.pitch)||Se.push({command:ui.setPitch,args:[ae.pitch]}),a.deepEqual(j.sprite,ae.sprite)||Se.push({command:ui.setSprite,args:[ae.sprite]}),a.deepEqual(j.glyphs,ae.glyphs)||Se.push({command:ui.setGlyphs,args:[ae.glyphs]}),a.deepEqual(j.transition,ae.transition)||Se.push({command:ui.setTransition,args:[ae.transition]}),a.deepEqual(j.light,ae.light)||Se.push({command:ui.setLight,args:[ae.light]});var He={},xt=[];(function(Tt,Jt,Yt,gr){var Vt;for(Vt in Jt=Jt||{},Tt=Tt||{})Tt.hasOwnProperty(Vt)&&(Jt.hasOwnProperty(Vt)||Yn(Vt,Yt,gr));for(Vt in Jt)Jt.hasOwnProperty(Vt)&&(Tt.hasOwnProperty(Vt)?a.deepEqual(Tt[Vt],Jt[Vt])||(Tt[Vt].type==="geojson"&&Jt[Vt].type==="geojson"&&vo(Tt,Jt,Vt)?Yt.push({command:ui.setGeoJSONSourceData,args:[Vt,Jt[Vt].data]}):wa(Vt,Jt,Yt,gr)):Da(Vt,Jt,Yt))})(j.sources,ae.sources,xt,He);var Et=[];j.layers&&j.layers.forEach(function(Tt){He[Tt.source]?Se.push({command:ui.removeLayer,args:[Tt.id]}):Et.push(Tt)}),Se=Se.concat(xt),function(Tt,Jt,Yt){Jt=Jt||[];var gr,Vt,mr,Ar,Xr,cn,nn,pn=(Tt=Tt||[]).map(Ka),Bn=Jt.map(Ka),Zn=Tt.reduce(Ga,{}),Vn=Jt.reduce(Ga,{}),Si=pn.slice(),Zi=Object.create(null);for(gr=0,Vt=0;gr<pn.length;gr++)Vn.hasOwnProperty(mr=pn[gr])?Vt++:(Yt.push({command:ui.removeLayer,args:[mr]}),Si.splice(Si.indexOf(mr,Vt),1));for(gr=0,Vt=0;gr<Bn.length;gr++)Si[Si.length-1-gr]!==(mr=Bn[Bn.length-1-gr])&&(Zn.hasOwnProperty(mr)?(Yt.push({command:ui.removeLayer,args:[mr]}),Si.splice(Si.lastIndexOf(mr,Si.length-Vt),1)):Vt++,Yt.push({command:ui.addLayer,args:[Vn[mr],cn=Si[Si.length-gr]]}),Si.splice(Si.length-gr,0,mr),Zi[mr]=!0);for(gr=0;gr<Bn.length;gr++)if(Ar=Zn[mr=Bn[gr]],Xr=Vn[mr],!Zi[mr]&&!a.deepEqual(Ar,Xr))if(a.deepEqual(Ar.source,Xr.source)&&a.deepEqual(Ar["source-layer"],Xr["source-layer"])&&a.deepEqual(Ar.type,Xr.type)){for(nn in Ua(Ar.layout,Xr.layout,Yt,mr,null,ui.setLayoutProperty),Ua(Ar.paint,Xr.paint,Yt,mr,null,ui.setPaintProperty),a.deepEqual(Ar.filter,Xr.filter)||Yt.push({command:ui.setFilter,args:[mr,Xr.filter]}),a.deepEqual(Ar.minzoom,Xr.minzoom)&&a.deepEqual(Ar.maxzoom,Xr.maxzoom)||Yt.push({command:ui.setLayerZoomRange,args:[mr,Xr.minzoom,Xr.maxzoom]}),Ar)Ar.hasOwnProperty(nn)&&nn!=="layout"&&nn!=="paint"&&nn!=="filter"&&nn!=="metadata"&&nn!=="minzoom"&&nn!=="maxzoom"&&(nn.indexOf("paint.")===0?Ua(Ar[nn],Xr[nn],Yt,mr,nn.slice(6),ui.setPaintProperty):a.deepEqual(Ar[nn],Xr[nn])||Yt.push({command:ui.setLayerProperty,args:[mr,nn,Xr[nn]]}));for(nn in Xr)Xr.hasOwnProperty(nn)&&!Ar.hasOwnProperty(nn)&&nn!=="layout"&&nn!=="paint"&&nn!=="filter"&&nn!=="metadata"&&nn!=="minzoom"&&nn!=="maxzoom"&&(nn.indexOf("paint.")===0?Ua(Ar[nn],Xr[nn],Yt,mr,nn.slice(6),ui.setPaintProperty):a.deepEqual(Ar[nn],Xr[nn])||Yt.push({command:ui.setLayerProperty,args:[mr,nn,Xr[nn]]}))}else Yt.push({command:ui.removeLayer,args:[mr]}),cn=Si[Si.lastIndexOf(mr)+1],Yt.push({command:ui.addLayer,args:[Xr,cn]})}(Et,ae.layers,Se)}catch(Tt){console.warn("Unable to compute style diff:",Tt),Se=[{command:ui.setStyle,args:[ae]}]}return Se}(this.serialize(),i).filter(function(j){return!(j.command in mi)});if(w.length===0)return!1;var z=w.filter(function(j){return!(j.command in mn)});if(z.length>0)throw new Error("Unimplemented: "+z.map(function(j){return j.command}).join(", ")+".");return w.forEach(function(j){j.command!=="setTransition"&&l[j.command].apply(l,j.args)}),this.stylesheet=i,!0},o.prototype.addImage=function(i,l){if(this.getImage(i))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(i,l),this._afterImageUpdated(i)},o.prototype.updateImage=function(i,l){this.imageManager.updateImage(i,l)},o.prototype.getImage=function(i){return this.imageManager.getImage(i)},o.prototype.removeImage=function(i){if(!this.getImage(i))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(i),this._afterImageUpdated(i)},o.prototype._afterImageUpdated=function(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},o.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},o.prototype.addSource=function(i,l,w){var z=this;if(w===void 0&&(w={}),this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(a.validateStyle.source,"sources."+i,l,null,w))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var j=this.sourceCaches[i]=new Nt(i,l,this.dispatcher);j.style=this,j.setEventedParent(this,function(){return{isSourceLoaded:z.loaded(),source:j.serialize(),sourceId:i}}),j.onAdd(this.map),this._changed=!0}},o.prototype.removeSource=function(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===i)return this.fire(new a.ErrorEvent(new Error('Source "'+i+'" cannot be removed while layer "'+l+'" is using it.')));var w=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],w.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),w.setEventedParent(null),w.clearTiles(),w.onRemove&&w.onRemove(this.map),this._changed=!0},o.prototype.setGeoJSONSourceData=function(i,l){this._checkLoaded(),this.sourceCaches[i].getSource().setData(l),this._changed=!0},o.prototype.getSource=function(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()},o.prototype.addLayer=function(i,l,w){w===void 0&&(w={}),this._checkLoaded();var z=i.id;if(this.getLayer(z))this.fire(new a.ErrorEvent(new Error('Layer with id "'+z+'" already exists on this map')));else{var j;if(i.type==="custom"){if(Un(this,a.validateCustomStyleLayer(i)))return;j=a.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(z,i.source),i=a.clone$1(i),i=a.extend(i,{source:z})),this._validate(a.validateStyle.layer,"layers."+z,i,{arrayIndex:-1},w))return;j=a.createStyleLayer(i),this._validateLayer(j),j.setEventedParent(this,{layer:{id:z}}),this._serializedLayers[j.id]=j.serialize()}var ae=l?this._order.indexOf(l):this._order.length;if(l&&ae===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(ae,0,z),this._layerOrderChanged=!0,this._layers[z]=j,this._removedLayers[z]&&j.source&&j.type!=="custom"){var Se=this._removedLayers[z];delete this._removedLayers[z],Se.type!==j.type?this._updatedSources[j.source]="clear":(this._updatedSources[j.source]="reload",this.sourceCaches[j.source].pause())}this._updateLayer(j),j.onAdd&&j.onAdd(this.map)}}},o.prototype.moveLayer=function(i,l){if(this._checkLoaded(),this._changed=!0,this._layers[i]){if(i!==l){var w=this._order.indexOf(i);this._order.splice(w,1);var z=l?this._order.indexOf(l):this._order.length;l&&z===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(z,0,i),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be moved.")))},o.prototype.removeLayer=function(i){this._checkLoaded();var l=this._layers[i];if(l){l.setEventedParent(null);var w=this._order.indexOf(i);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=l,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],l.onRemove&&l.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be removed.")))},o.prototype.getLayer=function(i){return this._layers[i]},o.prototype.hasLayer=function(i){return i in this._layers},o.prototype.setLayerZoomRange=function(i,l,w){this._checkLoaded();var z=this.getLayer(i);z?z.minzoom===l&&z.maxzoom===w||(l!=null&&(z.minzoom=l),w!=null&&(z.maxzoom=w),this._updateLayer(z)):this.fire(new a.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot have zoom extent.")))},o.prototype.setFilter=function(i,l,w){w===void 0&&(w={}),this._checkLoaded();var z=this.getLayer(i);if(z){if(!a.deepEqual(z.filter,l))return l==null?(z.filter=void 0,void this._updateLayer(z)):void(this._validate(a.validateStyle.filter,"layers."+z.id+".filter",l,null,w)||(z.filter=a.clone$1(l),this._updateLayer(z)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be filtered.")))},o.prototype.getFilter=function(i){return a.clone$1(this.getLayer(i).filter)},o.prototype.setLayoutProperty=function(i,l,w,z){z===void 0&&(z={}),this._checkLoaded();var j=this.getLayer(i);j?a.deepEqual(j.getLayoutProperty(l),w)||(j.setLayoutProperty(l,w,z),this._updateLayer(j)):this.fire(new a.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getLayoutProperty=function(i,l){var w=this.getLayer(i);if(w)return w.getLayoutProperty(l);this.fire(new a.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style.")))},o.prototype.setPaintProperty=function(i,l,w,z){z===void 0&&(z={}),this._checkLoaded();var j=this.getLayer(i);j?a.deepEqual(j.getPaintProperty(l),w)||(j.setPaintProperty(l,w,z)&&this._updateLayer(j),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getPaintProperty=function(i,l){return this.getLayer(i).getPaintProperty(l)},o.prototype.setFeatureState=function(i,l){this._checkLoaded();var w=i.source,z=i.sourceLayer,j=this.sourceCaches[w];if(j!==void 0){var ae=j.getSource().type;ae==="geojson"&&z?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ae!=="vector"||z?(i.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),j.setFeatureState(z,i.id,l)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},o.prototype.removeFeatureState=function(i,l){this._checkLoaded();var w=i.source,z=this.sourceCaches[w];if(z!==void 0){var j=z.getSource().type,ae=j==="vector"?i.sourceLayer:void 0;j!=="vector"||ae?l&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):z.removeFeatureState(ae,i.id,l):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},o.prototype.getFeatureState=function(i){this._checkLoaded();var l=i.source,w=i.sourceLayer,z=this.sourceCaches[l];if(z!==void 0){if(z.getSource().type!=="vector"||w)return i.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),z.getFeatureState(w,i.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},o.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},o.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(i){return i.serialize()}),layers:this._serializeLayers(this._order)},function(i){return i!==void 0})},o.prototype._updateLayer=function(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._changed=!0},o.prototype._flattenAndSortRenderedFeatures=function(i){for(var l=this,w=function(Zn){return l._layers[Zn].type==="fill-extrusion"},z={},j=[],ae=this._order.length-1;ae>=0;ae--){var Se=this._order[ae];if(w(Se)){z[Se]=ae;for(var He=0,xt=i;He<xt.length;He+=1){var Et=xt[He][Se];if(Et)for(var Tt=0,Jt=Et;Tt<Jt.length;Tt+=1)j.push(Jt[Tt])}}}j.sort(function(Zn,Vn){return Vn.intersectionZ-Zn.intersectionZ});for(var Yt=[],gr=this._order.length-1;gr>=0;gr--){var Vt=this._order[gr];if(w(Vt))for(var mr=j.length-1;mr>=0;mr--){var Ar=j[mr].feature;if(z[Ar.layer.id]<gr)break;Yt.push(Ar),j.pop()}else for(var Xr=0,cn=i;Xr<cn.length;Xr+=1){var nn=cn[Xr][Vt];if(nn)for(var pn=0,Bn=nn;pn<Bn.length;pn+=1)Yt.push(Bn[pn].feature)}}return Yt},o.prototype.queryRenderedFeatures=function(i,l,w){l&&l.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var z={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var j=0,ae=l.layers;j<ae.length;j+=1){var Se=ae[j],He=this._layers[Se];if(!He)return this.fire(new a.ErrorEvent(new Error("The layer '"+Se+"' does not exist in the map's style and cannot be queried for features."))),[];z[He.source]=!0}}var xt=[];for(var Et in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!z[Et]||xt.push(vr(this.sourceCaches[Et],this._layers,this._serializedLayers,i,l,w));return this.placement&&xt.push(function(Tt,Jt,Yt,gr,Vt,mr,Ar){for(var Xr={},cn=mr.queryRenderedSymbols(gr),nn=[],pn=0,Bn=Object.keys(cn).map(Number);pn<Bn.length;pn+=1)nn.push(Ar[Bn[pn]]);nn.sort(jr);for(var Zn=function(){var ma=Si[Vn],Co=ma.featureIndex.lookupSymbolFeatures(cn[ma.bucketInstanceId],Jt,ma.bucketIndex,ma.sourceLayerIndex,Vt.filter,Vt.layers,Vt.availableImages,Tt);for(var Pi in Co){var Ha=Xr[Pi]=Xr[Pi]||[],Ma=Co[Pi];Ma.sort(function(oo,Pa){var Aa=ma.featureSortOrder;if(Aa){var eu=Aa.indexOf(oo.featureIndex);return Aa.indexOf(Pa.featureIndex)-eu}return Pa.featureIndex-oo.featureIndex});for(var Ba=0,Ea=Ma;Ba<Ea.length;Ba+=1)Ha.push(Ea[Ba])}},Vn=0,Si=nn;Vn<Si.length;Vn+=1)Zn();var Zi=function(ma){Xr[ma].forEach(function(Co){var Pi=Co.feature,Ha=Yt[Tt[ma].source].getFeatureState(Pi.layer["source-layer"],Pi.id);Pi.source=Pi.layer.source,Pi.layer["source-layer"]&&(Pi.sourceLayer=Pi.layer["source-layer"]),Pi.state=Ha})};for(var ca in Xr)Zi(ca);return Xr}(this._layers,this._serializedLayers,this.sourceCaches,i,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(xt)},o.prototype.querySourceFeatures=function(i,l){l&&l.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var w=this.sourceCaches[i];return w?function(z,j){for(var ae=z.getRenderableIds().map(function(Jt){return z.getTileByID(Jt)}),Se=[],He={},xt=0;xt<ae.length;xt++){var Et=ae[xt],Tt=Et.tileID.canonical.key;He[Tt]||(He[Tt]=!0,Et.querySourceFeatures(Se,j))}return Se}(w,l):[]},o.prototype.addSourceType=function(i,l,w){return o.getSourceType(i)?w(new Error('A source type called "'+i+'" already exists.')):(o.setSourceType(i,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:l.workerSourceURL},w):w(null,null))},o.prototype.getLight=function(){return this.light.getLight()},o.prototype.setLight=function(i,l){l===void 0&&(l={}),this._checkLoaded();var w=this.light.getLight(),z=!1;for(var j in i)if(!a.deepEqual(i[j],w[j])){z=!0;break}if(z){var ae={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,l),this.light.updateTransitions(ae)}},o.prototype._validate=function(i,l,w,z,j){return j===void 0&&(j={}),(!j||j.validate!==!1)&&Un(this,i.call(a.validateStyle,a.extend({key:l,style:this.serialize(),value:w,styleSpec:a.styleSpec},z)))},o.prototype._remove=function(){for(var i in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[i].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},o.prototype._clearSource=function(i){this.sourceCaches[i].clearTiles()},o.prototype._reloadSource=function(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()},o.prototype._updateSources=function(i){for(var l in this.sourceCaches)this.sourceCaches[l].update(i)},o.prototype._generateCollisionBoxes=function(){for(var i in this.sourceCaches)this._reloadSource(i)},o.prototype._updatePlacement=function(i,l,w,z,j){j===void 0&&(j=!1);for(var ae=!1,Se=!1,He={},xt=0,Et=this._order;xt<Et.length;xt+=1){var Tt=this._layers[Et[xt]];if(Tt.type==="symbol"){if(!He[Tt.source]){var Jt=this.sourceCaches[Tt.source];He[Tt.source]=Jt.getRenderableIds(!0).map(function(Ar){return Jt.getTileByID(Ar)}).sort(function(Ar,Xr){return Xr.tileID.overscaledZ-Ar.tileID.overscaledZ||(Ar.tileID.isLessThan(Xr.tileID)?-1:1)})}var Yt=this.crossTileSymbolIndex.addLayer(Tt,He[Tt.source],i.center.lng);ae=ae||Yt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((j=j||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),i.zoom))&&(this.pauseablePlacement=new It(i,this._order,j,l,w,z,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,He),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),Se=!0),ae&&this.pauseablePlacement.placement.setStale()),Se||ae)for(var gr=0,Vt=this._order;gr<Vt.length;gr+=1){var mr=this._layers[Vt[gr]];mr.type==="symbol"&&this.placement.updateLayerOpacities(mr,He[mr.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},o.prototype._releaseSymbolFadeTiles=function(){for(var i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()},o.prototype.getImages=function(i,l,w){this.imageManager.getImages(l.icons,w),this._updateTilesForChangedImages();var z=this.sourceCaches[l.source];z&&z.setDependencies(l.tileID.key,l.type,l.icons)},o.prototype.getGlyphs=function(i,l,w){this.glyphManager.getGlyphs(l.stacks,w)},o.prototype.getResource=function(i,l,w){return a.makeRequest(l,w)},o}(a.Evented);Fn.getSourceType=function(n){return or[n]},Fn.setSourceType=function(n,o){or[n]=o},Fn.registerForPluginStateChange=a.registerForPluginStateChange;var ci=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),ia=go(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),_a=go(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ao=go(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Yo=go(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Vo=go("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Bo=go(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),mo=go(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Do=go("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ps=go("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),g=go("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),U=go(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),he=go(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),te=go(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),tt=go(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Pt=go(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fr=go(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Fr=go(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),zr=go(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),En=go(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Dn=go(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),na=go(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),ka=go(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ha=go(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Fa=go(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Mo=go(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Po=go(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function go(n,o){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=o.match(/attribute ([\w]+) ([\w]+)/g),w=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),j=z?z.concat(w):w,ae={};return{fragmentSource:n=n.replace(i,function(Se,He,xt,Et,Tt){return ae[Tt]=!0,He==="define"?`
#ifndef HAS_UNIFORM_u_`+Tt+`
varying `+xt+" "+Et+" "+Tt+`;
#else
uniform `+xt+" "+Et+" u_"+Tt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Tt+`
    `+xt+" "+Et+" "+Tt+" = u_"+Tt+`;
#endif
`}),vertexSource:o=o.replace(i,function(Se,He,xt,Et,Tt){var Jt=Et==="float"?"vec2":"vec4",Yt=Tt.match(/color/)?"color":Jt;return ae[Tt]?He==="define"?`
#ifndef HAS_UNIFORM_u_`+Tt+`
uniform lowp float u_`+Tt+`_t;
attribute `+xt+" "+Jt+" a_"+Tt+`;
varying `+xt+" "+Et+" "+Tt+`;
#else
uniform `+xt+" "+Et+" u_"+Tt+`;
#endif
`:Yt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Tt+`
    `+Tt+" = a_"+Tt+`;
#else
    `+xt+" "+Et+" "+Tt+" = u_"+Tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Tt+`
    `+Tt+" = unpack_mix_"+Yt+"(a_"+Tt+", u_"+Tt+`_t);
#else
    `+xt+" "+Et+" "+Tt+" = u_"+Tt+`;
#endif
`:He==="define"?`
#ifndef HAS_UNIFORM_u_`+Tt+`
uniform lowp float u_`+Tt+`_t;
attribute `+xt+" "+Jt+" a_"+Tt+`;
#else
uniform `+xt+" "+Et+" u_"+Tt+`;
#endif
`:Yt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Tt+`
    `+xt+" "+Et+" "+Tt+" = a_"+Tt+`;
#else
    `+xt+" "+Et+" "+Tt+" = u_"+Tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Tt+`
    `+xt+" "+Et+" "+Tt+" = unpack_mix_"+Yt+"(a_"+Tt+", u_"+Tt+`_t);
#else
    `+xt+" "+Et+" "+Tt+" = u_"+Tt+`;
#endif
`}),staticAttributes:l,staticUniforms:j}}var fu=Object.freeze({__proto__:null,prelude:ia,background:_a,backgroundPattern:ao,circle:Yo,clippingMask:Vo,heatmap:Bo,heatmapTexture:mo,collisionBox:Do,collisionCircle:ps,debug:g,fill:U,fillOutline:he,fillOutlinePattern:te,fillPattern:tt,fillExtrusion:Pt,fillExtrusionPattern:fr,hillshadePrepare:Fr,hillshade:zr,line:En,lineGradient:Dn,linePattern:na,lineSDF:ka,raster:ha,symbolIcon:Fa,symbolSDF:Mo,symbolTextAndIcon:Po}),yo=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Zu(n){for(var o=[],i=0;i<n.length;i++)if(n[i]!==null){var l=n[i].split(" ");o.push(l.pop())}return o}yo.prototype.bind=function(n,o,i,l,w,z,j,ae){this.context=n;for(var Se=this.boundPaintVertexBuffers.length!==l.length,He=0;!Se&&He<l.length;He++)this.boundPaintVertexBuffers[He]!==l[He]&&(Se=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===o&&this.boundLayoutVertexBuffer===i&&!Se&&this.boundIndexBuffer===w&&this.boundVertexOffset===z&&this.boundDynamicVertexBuffer===j&&this.boundDynamicVertexBuffer2===ae?(n.bindVertexArrayOES.set(this.vao),j&&j.bind(),w&&w.dynamicDraw&&w.bind(),ae&&ae.bind()):this.freshBind(o,i,l,w,z,j,ae)},yo.prototype.freshBind=function(n,o,i,l,w,z,j){var ae,Se=n.numAttributes,He=this.context,xt=He.gl;if(He.extVertexArrayObject)this.vao&&this.destroy(),this.vao=He.extVertexArrayObject.createVertexArrayOES(),He.bindVertexArrayOES.set(this.vao),ae=0,this.boundProgram=n,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=l,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=j;else{ae=He.currentNumAttributes||0;for(var Et=Se;Et<ae;Et++)xt.disableVertexAttribArray(Et)}o.enableAttributes(xt,n);for(var Tt=0,Jt=i;Tt<Jt.length;Tt+=1)Jt[Tt].enableAttributes(xt,n);z&&z.enableAttributes(xt,n),j&&j.enableAttributes(xt,n),o.bind(),o.setVertexAttribPointers(xt,n,w);for(var Yt=0,gr=i;Yt<gr.length;Yt+=1){var Vt=gr[Yt];Vt.bind(),Vt.setVertexAttribPointers(xt,n,w)}z&&(z.bind(),z.setVertexAttribPointers(xt,n,w)),l&&l.bind(),j&&(j.bind(),j.setVertexAttribPointers(xt,n,w)),He.currentNumAttributes=Se},yo.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var tc=function(n,o,i,l,w,z){var j=n.gl;this.program=j.createProgram();for(var ae=Zu(i.staticAttributes),Se=l?l.getBinderAttributes():[],He=ae.concat(Se),xt=i.staticUniforms?Zu(i.staticUniforms):[],Et=l?l.getBinderUniforms():[],Tt=[],Jt=0,Yt=xt.concat(Et);Jt<Yt.length;Jt+=1){var gr=Yt[Jt];Tt.indexOf(gr)<0&&Tt.push(gr)}var Vt=l?l.defines():[];z&&Vt.push("#define OVERDRAW_INSPECTOR;");var mr=Vt.concat(ia.fragmentSource,i.fragmentSource).join(`
`),Ar=Vt.concat(ia.vertexSource,i.vertexSource).join(`
`),Xr=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(Xr,mr),j.compileShader(Xr),j.attachShader(this.program,Xr);var cn=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(cn,Ar),j.compileShader(cn),j.attachShader(this.program,cn),this.attributes={};var nn={};this.numAttributes=He.length;for(var pn=0;pn<this.numAttributes;pn++)He[pn]&&(j.bindAttribLocation(this.program,pn,He[pn]),this.attributes[He[pn]]=pn);j.linkProgram(this.program),j.deleteShader(cn),j.deleteShader(Xr);for(var Bn=0;Bn<Tt.length;Bn++){var Zn=Tt[Bn];if(Zn&&!nn[Zn]){var Vn=j.getUniformLocation(this.program,Zn);Vn&&(nn[Zn]=Vn)}}this.fixedUniforms=w(n,nn),this.binderUniforms=l?l.getUniforms(n,nn):[]}}};function ws(n,o,i){var l=1/Ia(i,1,o.transform.tileZoom),w=Math.pow(2,i.tileID.overscaledZ),z=i.tileSize*Math.pow(2,o.transform.tileZoom)/w,j=z*(i.tileID.canonical.x+i.tileID.wrap*w),ae=z*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[l,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[j>>16,ae>>16],u_pixel_coord_lower:[65535&j,65535&ae]}}tc.prototype.draw=function(n,o,i,l,w,z,j,ae,Se,He,xt,Et,Tt,Jt,Yt,gr){var Vt,mr=n.gl;if(!this.failedToCreate){for(var Ar in n.program.set(this.program),n.setDepthMode(i),n.setStencilMode(l),n.setColorMode(w),n.setCullFace(z),this.fixedUniforms)this.fixedUniforms[Ar].set(j[Ar]);Jt&&Jt.setUniforms(n,this.binderUniforms,Et,{zoom:Tt});for(var Xr=(Vt={},Vt[mr.LINES]=2,Vt[mr.TRIANGLES]=3,Vt[mr.LINE_STRIP]=1,Vt)[o],cn=0,nn=xt.get();cn<nn.length;cn+=1){var pn=nn[cn],Bn=pn.vaos||(pn.vaos={});(Bn[ae]||(Bn[ae]=new yo)).bind(n,this,Se,Jt?Jt.getPaintVertexBuffers():[],He,pn.vertexOffset,Yt,gr),mr.drawElements(o,pn.primitiveLength*Xr,mr.UNSIGNED_SHORT,pn.primitiveOffset*Xr*2)}}};var Nc=function(n,o,i,l){var w=o.style.light,z=w.properties.get("position"),j=[z.x,z.y,z.z],ae=a.create$1();w.properties.get("anchor")==="viewport"&&a.fromRotation(ae,-o.transform.angle),a.transformMat3(j,j,ae);var Se=w.properties.get("color");return{u_matrix:n,u_lightpos:j,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[Se.r,Se.g,Se.b],u_vertical_gradient:+i,u_opacity:l}},$u=function(n,o,i,l,w,z,j){return a.extend(Nc(n,o,i,l),ws(z,o,j),{u_height_factor:-Math.pow(2,w.overscaledZ)/j.tileSize/8})},Ku=function(n){return{u_matrix:n}},xl=function(n,o,i,l){return a.extend(Ku(n),ws(i,o,l))},qo=function(n,o){return{u_matrix:n,u_world:o}},rc=function(n,o,i,l,w){return a.extend(xl(n,o,i,l),{u_world:w})},Ec=function(n,o,i,l){var w,z,j=n.transform;if(l.paint.get("circle-pitch-alignment")==="map"){var ae=Ia(i,1,j.zoom);w=!0,z=[ae,ae]}else w=!1,z=j.pixelsToGLUnits;return{u_camera_to_center_distance:j.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(o.posMatrix,i,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:z}},Va=function(n,o,i){var l=Ia(i,1,o.zoom),w=Math.pow(2,o.zoom-i.tileID.overscaledZ),z=i.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:l,u_extrude_scale:[o.pixelsToGLUnits[0]/(l*w),o.pixelsToGLUnits[1]/(l*w)],u_overscale_factor:z}},qu=function(n,o,i){return{u_matrix:n,u_inv_matrix:o,u_camera_to_center_distance:i.cameraToCenterDistance,u_viewport_size:[i.width,i.height]}},ys=function(n,o,i){return i===void 0&&(i=1),{u_matrix:n,u_color:o,u_overlay:0,u_overlay_scale:i}},ss=function(n){return{u_matrix:n}},bl=function(n,o,i,l){return{u_matrix:n,u_extrude_scale:Ia(o,1,i),u_intensity:l}},El=function(n,o,i){var l=n.transform;return{u_matrix:zc(n,o,i),u_ratio:1/Ia(o,1,l.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},To=function(n,o,i,l){return a.extend(El(n,o,i),{u_image:0,u_image_height:l})},Ps=function(n,o,i,l){var w=n.transform,z=ju(o,w);return{u_matrix:zc(n,o,i),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Ia(o,1,w.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[z,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},hf=function(n,o,i,l,w){var z=n.lineAtlas,j=ju(o,n.transform),ae=i.layout.get("line-cap")==="round",Se=z.getDash(l.from,ae),He=z.getDash(l.to,ae),xt=Se.width*w.fromScale,Et=He.width*w.toScale;return a.extend(El(n,o,i),{u_patternscale_a:[j/xt,-Se.height/2],u_patternscale_b:[j/Et,-He.height/2],u_sdfgamma:z.width/(256*Math.min(xt,Et)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Se.y,u_tex_y_b:He.y,u_mix:w.t})};function ju(n,o){return 1/Ia(n,1,o.tileZoom)}function zc(n,o,i){return n.translatePosMatrix(o.tileID.posMatrix,o,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}var Uc=function(n,o,i,l,w){return{u_matrix:n,u_tl_parent:o,u_scale_parent:i,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(j=w.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(z=w.paint.get("raster-contrast"),z>0?1/(1-z):1+z),u_spin_weights:Bf(w.paint.get("raster-hue-rotate"))};var z,j};function Bf(n){n*=Math.PI/180;var o=Math.sin(n),i=Math.cos(n);return[(2*i+1)/3,(-Math.sqrt(3)*o-i+1)/3,(Math.sqrt(3)*o-i+1)/3]}var Jc,vu=function(n,o,i,l,w,z,j,ae,Se,He){var xt=w.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:xt.cameraToCenterDistance,u_pitch:xt.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:xt.width/xt.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:z,u_label_plane_matrix:j,u_coord_matrix:ae,u_is_text:+Se,u_pitch_with_map:+l,u_texsize:He,u_texture:0}},Ul=function(n,o,i,l,w,z,j,ae,Se,He,xt){var Et=w.transform;return a.extend(vu(n,o,i,l,w,z,j,ae,Se,He),{u_gamma_scale:l?Math.cos(Et._pitch)*Et.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+xt})},Qu=function(n,o,i,l,w,z,j,ae,Se,He){return a.extend(Ul(n,o,i,l,w,z,j,ae,!0,Se,!0),{u_texsize_icon:He,u_texture_icon:1})},Cu=function(n,o,i){return{u_matrix:n,u_opacity:o,u_color:i}},Zl=function(n,o,i,l,w,z){return a.extend(function(j,ae,Se,He){var xt=Se.imageManager.getPattern(j.from.toString()),Et=Se.imageManager.getPattern(j.to.toString()),Tt=Se.imageManager.getPixelSize(),Jt=Tt.width,Yt=Tt.height,gr=Math.pow(2,He.tileID.overscaledZ),Vt=He.tileSize*Math.pow(2,Se.transform.tileZoom)/gr,mr=Vt*(He.tileID.canonical.x+He.tileID.wrap*gr),Ar=Vt*He.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:xt.tl,u_pattern_br_a:xt.br,u_pattern_tl_b:Et.tl,u_pattern_br_b:Et.br,u_texsize:[Jt,Yt],u_mix:ae.t,u_pattern_size_a:xt.displaySize,u_pattern_size_b:Et.displaySize,u_scale_a:ae.fromScale,u_scale_b:ae.toScale,u_tile_units_to_pixels:1/Ia(He,1,Se.transform.tileZoom),u_pixel_coord_upper:[mr>>16,Ar>>16],u_pixel_coord_lower:[65535&mr,65535&Ar]}}(l,z,i,w),{u_matrix:n,u_opacity:o})},nc={fillExtrusion:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_lightpos:new a.Uniform3f(n,o.u_lightpos),u_lightintensity:new a.Uniform1f(n,o.u_lightintensity),u_lightcolor:new a.Uniform3f(n,o.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,o.u_vertical_gradient),u_opacity:new a.Uniform1f(n,o.u_opacity)}},fillExtrusionPattern:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_lightpos:new a.Uniform3f(n,o.u_lightpos),u_lightintensity:new a.Uniform1f(n,o.u_lightintensity),u_lightcolor:new a.Uniform3f(n,o.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,o.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,o.u_height_factor),u_image:new a.Uniform1i(n,o.u_image),u_texsize:new a.Uniform2f(n,o.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,o.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,o.u_scale),u_fade:new a.Uniform1f(n,o.u_fade),u_opacity:new a.Uniform1f(n,o.u_opacity)}},fill:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix)}},fillPattern:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_image:new a.Uniform1i(n,o.u_image),u_texsize:new a.Uniform2f(n,o.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,o.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,o.u_scale),u_fade:new a.Uniform1f(n,o.u_fade)}},fillOutline:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_world:new a.Uniform2f(n,o.u_world)}},fillOutlinePattern:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_world:new a.Uniform2f(n,o.u_world),u_image:new a.Uniform1i(n,o.u_image),u_texsize:new a.Uniform2f(n,o.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,o.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,o.u_scale),u_fade:new a.Uniform1f(n,o.u_fade)}},circle:function(n,o){return{u_camera_to_center_distance:new a.Uniform1f(n,o.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,o.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,o.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,o.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,o.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,o.u_matrix)}},collisionBox:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,o.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,o.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,o.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,o.u_overscale_factor)}},collisionCircle:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,o.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,o.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,o.u_viewport_size)}},debug:function(n,o){return{u_color:new a.UniformColor(n,o.u_color),u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_overlay:new a.Uniform1i(n,o.u_overlay),u_overlay_scale:new a.Uniform1f(n,o.u_overlay_scale)}},clippingMask:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix)}},heatmap:function(n,o){return{u_extrude_scale:new a.Uniform1f(n,o.u_extrude_scale),u_intensity:new a.Uniform1f(n,o.u_intensity),u_matrix:new a.UniformMatrix4f(n,o.u_matrix)}},heatmapTexture:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_world:new a.Uniform2f(n,o.u_world),u_image:new a.Uniform1i(n,o.u_image),u_color_ramp:new a.Uniform1i(n,o.u_color_ramp),u_opacity:new a.Uniform1f(n,o.u_opacity)}},hillshade:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_image:new a.Uniform1i(n,o.u_image),u_latrange:new a.Uniform2f(n,o.u_latrange),u_light:new a.Uniform2f(n,o.u_light),u_shadow:new a.UniformColor(n,o.u_shadow),u_highlight:new a.UniformColor(n,o.u_highlight),u_accent:new a.UniformColor(n,o.u_accent)}},hillshadePrepare:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_image:new a.Uniform1i(n,o.u_image),u_dimension:new a.Uniform2f(n,o.u_dimension),u_zoom:new a.Uniform1f(n,o.u_zoom),u_unpack:new a.Uniform4f(n,o.u_unpack)}},line:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_ratio:new a.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,o.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,o.u_units_to_pixels)}},lineGradient:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_ratio:new a.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,o.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,o.u_units_to_pixels),u_image:new a.Uniform1i(n,o.u_image),u_image_height:new a.Uniform1f(n,o.u_image_height)}},linePattern:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_texsize:new a.Uniform2f(n,o.u_texsize),u_ratio:new a.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,o.u_device_pixel_ratio),u_image:new a.Uniform1i(n,o.u_image),u_units_to_pixels:new a.Uniform2f(n,o.u_units_to_pixels),u_scale:new a.Uniform3f(n,o.u_scale),u_fade:new a.Uniform1f(n,o.u_fade)}},lineSDF:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_ratio:new a.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,o.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,o.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,o.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,o.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,o.u_sdfgamma),u_image:new a.Uniform1i(n,o.u_image),u_tex_y_a:new a.Uniform1f(n,o.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,o.u_tex_y_b),u_mix:new a.Uniform1f(n,o.u_mix)}},raster:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_tl_parent:new a.Uniform2f(n,o.u_tl_parent),u_scale_parent:new a.Uniform1f(n,o.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,o.u_buffer_scale),u_fade_t:new a.Uniform1f(n,o.u_fade_t),u_opacity:new a.Uniform1f(n,o.u_opacity),u_image0:new a.Uniform1i(n,o.u_image0),u_image1:new a.Uniform1i(n,o.u_image1),u_brightness_low:new a.Uniform1f(n,o.u_brightness_low),u_brightness_high:new a.Uniform1f(n,o.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,o.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,o.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,o.u_spin_weights)}},symbolIcon:function(n,o){return{u_is_size_zoom_constant:new a.Uniform1i(n,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,o.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,o.u_size_t),u_size:new a.Uniform1f(n,o.u_size),u_camera_to_center_distance:new a.Uniform1f(n,o.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,o.u_pitch),u_rotate_symbol:new a.Uniform1i(n,o.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,o.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,o.u_fade_change),u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,o.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,o.u_coord_matrix),u_is_text:new a.Uniform1i(n,o.u_is_text),u_pitch_with_map:new a.Uniform1i(n,o.u_pitch_with_map),u_texsize:new a.Uniform2f(n,o.u_texsize),u_texture:new a.Uniform1i(n,o.u_texture)}},symbolSDF:function(n,o){return{u_is_size_zoom_constant:new a.Uniform1i(n,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,o.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,o.u_size_t),u_size:new a.Uniform1f(n,o.u_size),u_camera_to_center_distance:new a.Uniform1f(n,o.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,o.u_pitch),u_rotate_symbol:new a.Uniform1i(n,o.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,o.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,o.u_fade_change),u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,o.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,o.u_coord_matrix),u_is_text:new a.Uniform1i(n,o.u_is_text),u_pitch_with_map:new a.Uniform1i(n,o.u_pitch_with_map),u_texsize:new a.Uniform2f(n,o.u_texsize),u_texture:new a.Uniform1i(n,o.u_texture),u_gamma_scale:new a.Uniform1f(n,o.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,o.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,o.u_is_halo)}},symbolTextAndIcon:function(n,o){return{u_is_size_zoom_constant:new a.Uniform1i(n,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,o.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,o.u_size_t),u_size:new a.Uniform1f(n,o.u_size),u_camera_to_center_distance:new a.Uniform1f(n,o.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,o.u_pitch),u_rotate_symbol:new a.Uniform1i(n,o.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,o.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,o.u_fade_change),u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,o.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,o.u_coord_matrix),u_is_text:new a.Uniform1i(n,o.u_is_text),u_pitch_with_map:new a.Uniform1i(n,o.u_pitch_with_map),u_texsize:new a.Uniform2f(n,o.u_texsize),u_texsize_icon:new a.Uniform2f(n,o.u_texsize_icon),u_texture:new a.Uniform1i(n,o.u_texture),u_texture_icon:new a.Uniform1i(n,o.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,o.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,o.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,o.u_is_halo)}},background:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_opacity:new a.Uniform1f(n,o.u_opacity),u_color:new a.UniformColor(n,o.u_color)}},backgroundPattern:function(n,o){return{u_matrix:new a.UniformMatrix4f(n,o.u_matrix),u_opacity:new a.Uniform1f(n,o.u_opacity),u_image:new a.Uniform1i(n,o.u_image),u_pattern_tl_a:new a.Uniform2f(n,o.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,o.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,o.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,o.u_pattern_br_b),u_texsize:new a.Uniform2f(n,o.u_texsize),u_mix:new a.Uniform1f(n,o.u_mix),u_pattern_size_a:new a.Uniform2f(n,o.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,o.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,o.u_scale_a),u_scale_b:new a.Uniform1f(n,o.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,o.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,o.u_tile_units_to_pixels)}}};function ic(n,o,i,l,w,z,j){for(var ae=n.context,Se=ae.gl,He=n.useProgram("collisionBox"),xt=[],Et=0,Tt=0,Jt=0;Jt<l.length;Jt++){var Yt=l[Jt],gr=o.getTile(Yt),Vt=gr.getBucket(i);if(Vt){var mr=Yt.posMatrix;w[0]===0&&w[1]===0||(mr=n.translatePosMatrix(Yt.posMatrix,gr,w,z));var Ar=j?Vt.textCollisionBox:Vt.iconCollisionBox,Xr=Vt.collisionCircleArray;if(Xr.length>0){var cn=a.create(),nn=mr;a.mul(cn,Vt.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(cn,cn,Vt.placementViewportMatrix),xt.push({circleArray:Xr,circleOffset:Tt,transform:nn,invTransform:cn}),Tt=Et+=Xr.length/4}Ar&&He.draw(ae,Se.LINES,je.disabled,dt.disabled,n.colorModeForRenderPass(),ur.disabled,Va(mr,n.transform,gr),i.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,null,n.transform.zoom,null,null,Ar.collisionVertexBuffer)}}if(j&&xt.length){var pn=n.useProgram("collisionCircle"),Bn=new a.StructArrayLayout2f1f2i16;Bn.resize(4*Et),Bn._trim();for(var Zn=0,Vn=0,Si=xt;Vn<Si.length;Vn+=1)for(var Zi=Si[Vn],ca=0;ca<Zi.circleArray.length/4;ca++){var ma=4*ca,Co=Zi.circleArray[ma+0],Pi=Zi.circleArray[ma+1],Ha=Zi.circleArray[ma+2],Ma=Zi.circleArray[ma+3];Bn.emplace(Zn++,Co,Pi,Ha,Ma,0),Bn.emplace(Zn++,Co,Pi,Ha,Ma,1),Bn.emplace(Zn++,Co,Pi,Ha,Ma,2),Bn.emplace(Zn++,Co,Pi,Ha,Ma,3)}(!Jc||Jc.length<2*Et)&&(Jc=function(As){var tu=2*As,Ls=new a.StructArrayLayout3ui6;Ls.resize(tu),Ls._trim();for(var Ho=0;Ho<tu;Ho++){var xs=6*Ho;Ls.uint16[xs+0]=4*Ho+0,Ls.uint16[xs+1]=4*Ho+1,Ls.uint16[xs+2]=4*Ho+2,Ls.uint16[xs+3]=4*Ho+2,Ls.uint16[xs+4]=4*Ho+3,Ls.uint16[xs+5]=4*Ho+0}return Ls}(Et));for(var Ba=ae.createIndexBuffer(Jc,!0),Ea=ae.createVertexBuffer(Bn,a.collisionCircleLayout.members,!0),oo=0,Pa=xt;oo<Pa.length;oo+=1){var Aa=Pa[oo],eu=qu(Aa.transform,Aa.invTransform,n.transform);pn.draw(ae,Se.TRIANGLES,je.disabled,dt.disabled,n.colorModeForRenderPass(),ur.disabled,eu,i.id,Ea,Ba,a.SegmentVector.simpleSegment(0,2*Aa.circleOffset,Aa.circleArray.length,Aa.circleArray.length/2),null,n.transform.zoom,null,null,null)}Ea.destroy(),Ba.destroy()}}var Gu=a.identity(new Float32Array(16));function pf(n,o,i,l,w,z){var j=a.getAnchorAlignment(n),ae=-(j.horizontalAlign-.5)*o,Se=-(j.verticalAlign-.5)*i,He=a.evaluateVariableOffset(n,l);return new a.Point((ae/w+He[0])*z,(Se/w+He[1])*z)}function Cc(n,o,i,l,w,z,j,ae,Se,He,xt){var Et=n.text.placedSymbolArray,Tt=n.text.dynamicLayoutVertexArray,Jt=n.icon.dynamicLayoutVertexArray,Yt={};Tt.clear();for(var gr=0;gr<Et.length;gr++){var Vt=Et.get(gr),mr=Vt.hidden||!Vt.crossTileID||n.allowVerticalPlacement&&!Vt.placedOrientation?null:l[Vt.crossTileID];if(mr){var Ar=new a.Point(Vt.anchorX,Vt.anchorY),Xr=qa(Ar,i?ae:j),cn=ba(z.cameraToCenterDistance,Xr.signedDistanceFromCamera),nn=w.evaluateSizeForFeature(n.textSizeData,He,Vt)*cn/a.ONE_EM;i&&(nn*=n.tilePixelRatio/Se);for(var pn=pf(mr.anchor,mr.width,mr.height,mr.textOffset,mr.textBoxScale,nn),Bn=i?qa(Ar.add(pn),j).point:Xr.point.add(o?pn.rotate(-z.angle):pn),Zn=n.allowVerticalPlacement&&Vt.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Vn=0;Vn<Vt.numGlyphs;Vn++)a.addDynamicAttributes(Tt,Bn,Zn);xt&&Vt.associatedIconIndex>=0&&(Yt[Vt.associatedIconIndex]={shiftedAnchor:Bn,angle:Zn})}else Ss(Vt.numGlyphs,Tt)}if(xt){Jt.clear();for(var Si=n.icon.placedSymbolArray,Zi=0;Zi<Si.length;Zi++){var ca=Si.get(Zi);if(ca.hidden)Ss(ca.numGlyphs,Jt);else{var ma=Yt[Zi];if(ma)for(var Co=0;Co<ca.numGlyphs;Co++)a.addDynamicAttributes(Jt,ma.shiftedAnchor,ma.angle);else Ss(ca.numGlyphs,Jt)}}n.icon.dynamicLayoutVertexBuffer.updateData(Jt)}n.text.dynamicLayoutVertexBuffer.updateData(Tt)}function ef(n,o,i){return i.iconsInText&&o?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function ko(n,o,i,l,w,z,j,ae,Se,He,xt,Et){for(var Tt=n.context,Jt=Tt.gl,Yt=n.transform,gr=ae==="map",Vt=Se==="map",mr=gr&&i.layout.get("symbol-placement")!=="point",Ar=gr&&!Vt&&!mr,Xr=i.layout.get("symbol-sort-key").constantOr(1)!==void 0,cn=!1,nn=n.depthModeForSublayer(0,je.ReadOnly),pn=i.layout.get("text-variable-anchor"),Bn=[],Zn=0,Vn=l;Zn<Vn.length;Zn+=1){var Si=Vn[Zn],Zi=o.getTile(Si),ca=Zi.getBucket(i);if(ca){var ma=w?ca.text:ca.icon;if(ma&&ma.segments.get().length){var Co=ma.programConfigurations.get(i.id),Pi=w||ca.sdfIcons,Ha=w?ca.textSizeData:ca.iconSizeData,Ma=Vt||Yt.pitch!==0,Ba=n.useProgram(ef(Pi,w,ca),Co),Ea=a.evaluateSizeForZoom(Ha,Yt.zoom),oo=void 0,Pa=[0,0],Aa=void 0,eu=void 0,As=null,tu=void 0;if(w)Aa=Zi.glyphAtlasTexture,eu=Jt.LINEAR,oo=Zi.glyphAtlasTexture.size,ca.iconsInText&&(Pa=Zi.imageAtlasTexture.size,As=Zi.imageAtlasTexture,tu=Ma||n.options.rotating||n.options.zooming||Ha.kind==="composite"||Ha.kind==="camera"?Jt.LINEAR:Jt.NEAREST);else{var Ls=i.layout.get("icon-size").constantOr(0)!==1||ca.iconsNeedLinear;Aa=Zi.imageAtlasTexture,eu=Pi||n.options.rotating||n.options.zooming||Ls||Ma?Jt.LINEAR:Jt.NEAREST,oo=Zi.imageAtlasTexture.size}var Ho=Ia(Zi,1,n.transform.zoom),xs=ra(Si.posMatrix,Vt,gr,n.transform,Ho),zs=Rn(Si.posMatrix,Vt,gr,n.transform,Ho),yu=pn&&ca.hasTextData(),Xc=i.layout.get("icon-text-fit")!=="none"&&yu&&ca.hasIconData();mr&&wo(ca,Si.posMatrix,n,w,xs,zs,Vt,He);var ou=n.translatePosMatrix(Si.posMatrix,Zi,z,j),su=mr||w&&pn||Xc?Gu:xs,Fs=n.translatePosMatrix(zs,Zi,z,j,!0),uf=Pi&&i.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0,tl={program:Ba,buffers:ma,uniformValues:Pi?ca.iconsInText?Qu(Ha.kind,Ea,Ar,Vt,n,ou,su,Fs,oo,Pa):Ul(Ha.kind,Ea,Ar,Vt,n,ou,su,Fs,w,oo,!0):vu(Ha.kind,Ea,Ar,Vt,n,ou,su,Fs,w,oo),atlasTexture:Aa,atlasTextureIcon:As,atlasInterpolation:eu,atlasInterpolationIcon:tu,isSDF:Pi,hasHalo:uf};if(Xr&&ca.canOverlap){cn=!0;for(var Ol=0,wc=ma.segments.get();Ol<wc.length;Ol+=1){var Mc=wc[Ol];Bn.push({segments:new a.SegmentVector([Mc]),sortKey:Mc.sortKey,state:tl})}}else Bn.push({segments:ma.segments,sortKey:0,state:tl})}}}cn&&Bn.sort(function(dc,ql){return dc.sortKey-ql.sortKey});for(var Us=0,Yc=Bn;Us<Yc.length;Us+=1){var Il=Yc[Us],Bs=Il.state;if(Tt.activeTexture.set(Jt.TEXTURE0),Bs.atlasTexture.bind(Bs.atlasInterpolation,Jt.CLAMP_TO_EDGE),Bs.atlasTextureIcon&&(Tt.activeTexture.set(Jt.TEXTURE1),Bs.atlasTextureIcon&&Bs.atlasTextureIcon.bind(Bs.atlasInterpolationIcon,Jt.CLAMP_TO_EDGE)),Bs.isSDF){var pc=Bs.uniformValues;Bs.hasHalo&&(pc.u_is_halo=1,Zc(Bs.buffers,Il.segments,i,n,Bs.program,nn,xt,Et,pc)),pc.u_is_halo=0}Zc(Bs.buffers,Il.segments,i,n,Bs.program,nn,xt,Et,Bs.uniformValues)}}function Zc(n,o,i,l,w,z,j,ae,Se){var He=l.context;w.draw(He,He.gl.TRIANGLES,z,j,ae,ur.disabled,Se,i.id,n.layoutVertexBuffer,n.indexBuffer,o,i.paint,l.transform.zoom,n.programConfigurations.get(i.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Su(n,o,i,l,w,z,j){var ae,Se,He,xt,Et,Tt=n.context.gl,Jt=i.paint.get("fill-pattern"),Yt=Jt&&Jt.constantOr(1),gr=i.getCrossfadeParameters();j?(Se=Yt&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ae=Tt.LINES):(Se=Yt?"fillPattern":"fill",ae=Tt.TRIANGLES);for(var Vt=0,mr=l;Vt<mr.length;Vt+=1){var Ar=mr[Vt],Xr=o.getTile(Ar);if(!Yt||Xr.patternsLoaded()){var cn=Xr.getBucket(i);if(cn){var nn=cn.programConfigurations.get(i.id),pn=n.useProgram(Se,nn);Yt&&(n.context.activeTexture.set(Tt.TEXTURE0),Xr.imageAtlasTexture.bind(Tt.LINEAR,Tt.CLAMP_TO_EDGE),nn.updatePaintBuffers(gr));var Bn=Jt.constantOr(null);if(Bn&&Xr.imageAtlas){var Zn=Xr.imageAtlas,Vn=Zn.patternPositions[Bn.to.toString()],Si=Zn.patternPositions[Bn.from.toString()];Vn&&Si&&nn.setConstantPatternPositions(Vn,Si)}var Zi=n.translatePosMatrix(Ar.posMatrix,Xr,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(j){xt=cn.indexBuffer2,Et=cn.segments2;var ca=[Tt.drawingBufferWidth,Tt.drawingBufferHeight];He=Se==="fillOutlinePattern"&&Yt?rc(Zi,n,gr,Xr,ca):qo(Zi,ca)}else xt=cn.indexBuffer,Et=cn.segments,He=Yt?xl(Zi,n,gr,Xr):Ku(Zi);pn.draw(n.context,ae,w,n.stencilModeForClipping(Ar),z,ur.disabled,He,i.id,cn.layoutVertexBuffer,xt,Et,i.paint,n.transform.zoom,nn)}}}}function jl(n,o,i,l,w,z,j){for(var ae=n.context,Se=ae.gl,He=i.paint.get("fill-extrusion-pattern"),xt=He.constantOr(1),Et=i.getCrossfadeParameters(),Tt=i.paint.get("fill-extrusion-opacity"),Jt=0,Yt=l;Jt<Yt.length;Jt+=1){var gr=Yt[Jt],Vt=o.getTile(gr),mr=Vt.getBucket(i);if(mr){var Ar=mr.programConfigurations.get(i.id),Xr=n.useProgram(xt?"fillExtrusionPattern":"fillExtrusion",Ar);xt&&(n.context.activeTexture.set(Se.TEXTURE0),Vt.imageAtlasTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),Ar.updatePaintBuffers(Et));var cn=He.constantOr(null);if(cn&&Vt.imageAtlas){var nn=Vt.imageAtlas,pn=nn.patternPositions[cn.to.toString()],Bn=nn.patternPositions[cn.from.toString()];pn&&Bn&&Ar.setConstantPatternPositions(pn,Bn)}var Zn=n.translatePosMatrix(gr.posMatrix,Vt,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Vn=i.paint.get("fill-extrusion-vertical-gradient"),Si=xt?$u(Zn,n,Vn,Tt,gr,Et,Vt):Nc(Zn,n,Vn,Tt);Xr.draw(ae,ae.gl.TRIANGLES,w,z,j,ur.backCCW,Si,i.id,mr.layoutVertexBuffer,mr.indexBuffer,mr.segments,i.paint,n.transform.zoom,Ar)}}}function cl(n,o,i,l,w,z){var j=n.context,ae=j.gl,Se=o.fbo;if(Se){var He=n.useProgram("hillshade");j.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,Se.colorAttachment.get());var xt=function(Et,Tt,Jt){var Yt=Jt.paint.get("hillshade-shadow-color"),gr=Jt.paint.get("hillshade-highlight-color"),Vt=Jt.paint.get("hillshade-accent-color"),mr=Jt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Jt.paint.get("hillshade-illumination-anchor")==="viewport"&&(mr-=Et.transform.angle);var Ar,Xr,cn,nn=!Et.options.moving;return{u_matrix:Et.transform.calculatePosMatrix(Tt.tileID.toUnwrapped(),nn),u_image:0,u_latrange:(Ar=Tt.tileID,Xr=Math.pow(2,Ar.canonical.z),cn=Ar.canonical.y,[new a.MercatorCoordinate(0,cn/Xr).toLngLat().lat,new a.MercatorCoordinate(0,(cn+1)/Xr).toLngLat().lat]),u_light:[Jt.paint.get("hillshade-exaggeration"),mr],u_shadow:Yt,u_highlight:gr,u_accent:Vt}}(n,o,i);He.draw(j,ae.TRIANGLES,l,w,z,ur.disabled,xt,i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function tf(n,o,i,l,w,z){var j=n.context,ae=j.gl,Se=o.dem;if(Se&&Se.data){var He=Se.dim,xt=Se.stride,Et=Se.getPixels();if(j.activeTexture.set(ae.TEXTURE1),j.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||n.getTileTexture(xt),o.demTexture){var Tt=o.demTexture;Tt.update(Et,{premultiply:!1}),Tt.bind(ae.NEAREST,ae.CLAMP_TO_EDGE)}else o.demTexture=new a.Texture(j,Et,ae.RGBA,{premultiply:!1}),o.demTexture.bind(ae.NEAREST,ae.CLAMP_TO_EDGE);j.activeTexture.set(ae.TEXTURE0);var Jt=o.fbo;if(!Jt){var Yt=new a.Texture(j,{width:He,height:He,data:null},ae.RGBA);Yt.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),(Jt=o.fbo=j.createFramebuffer(He,He,!0)).colorAttachment.set(Yt.texture)}j.bindFramebuffer.set(Jt.framebuffer),j.viewport.set([0,0,He,He]),n.useProgram("hillshadePrepare").draw(j,ae.TRIANGLES,l,w,z,ur.disabled,function(gr,Vt){var mr=Vt.stride,Ar=a.create();return a.ortho(Ar,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Ar,Ar,[0,-a.EXTENT,0]),{u_matrix:Ar,u_image:1,u_dimension:[mr,mr],u_zoom:gr.overscaledZ,u_unpack:Vt.getUnpackVector()}}(o.tileID,Se),i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Gl(n,o,i,l,w){var z=l.paint.get("raster-fade-duration");if(z>0){var j=a.browser.now(),ae=(j-n.timeAdded)/z,Se=o?(j-o.timeAdded)/z:-1,He=i.getSource(),xt=w.coveringZoomLevel({tileSize:He.tileSize,roundZoom:He.roundZoom}),Et=!o||Math.abs(o.tileID.overscaledZ-xt)>Math.abs(n.tileID.overscaledZ-xt),Tt=Et&&n.refreshedUponExpiration?1:a.clamp(Et?ae:1-Se,0,1);return n.refreshedUponExpiration&&ae>=1&&(n.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Tt}:{opacity:Tt,mix:0}}return{opacity:1,mix:0}}var fl=new a.Color(1,0,0,1),jc=new a.Color(0,1,0,1),Vl=new a.Color(0,0,1,1),Cl=new a.Color(1,0,1,1),Nf=new a.Color(0,1,1,1);function rf(n,o,i,l){Ve(n,0,o+i/2,n.transform.width,i,l)}function le(n,o,i,l){Ve(n,o-i/2,0,i,n.transform.height,l)}function Ve(n,o,i,l,w,z){var j=n.context,ae=j.gl;ae.enable(ae.SCISSOR_TEST),ae.scissor(o*a.browser.devicePixelRatio,i*a.browser.devicePixelRatio,l*a.browser.devicePixelRatio,w*a.browser.devicePixelRatio),j.clear({color:z}),ae.disable(ae.SCISSOR_TEST)}function _t(n,o,i){var l=n.context,w=l.gl,z=i.posMatrix,j=n.useProgram("debug"),ae=je.disabled,Se=dt.disabled,He=n.colorModeForRenderPass();l.activeTexture.set(w.TEXTURE0),n.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),j.draw(l,w.LINE_STRIP,ae,Se,He,ur.disabled,ys(z,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var xt=o.getTileByID(i.key).latestRawTileData,Et=Math.floor((xt&&xt.byteLength||0)/1024),Tt=o.getTile(i).tileSize,Jt=512/Math.min(Tt,512)*(i.overscaledZ/n.transform.zoom)*.5,Yt=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(Yt+=" => "+i.overscaledZ),function(gr,Vt){gr.initDebugOverlayCanvas();var mr=gr.debugOverlayCanvas,Ar=gr.context.gl,Xr=gr.debugOverlayCanvas.getContext("2d");Xr.clearRect(0,0,mr.width,mr.height),Xr.shadowColor="white",Xr.shadowBlur=2,Xr.lineWidth=1.5,Xr.strokeStyle="white",Xr.textBaseline="top",Xr.font="bold 36px Open Sans, sans-serif",Xr.fillText(Vt,5,5),Xr.strokeText(Vt,5,5),gr.debugOverlayTexture.update(mr),gr.debugOverlayTexture.bind(Ar.LINEAR,Ar.CLAMP_TO_EDGE)}(n,Yt+" "+Et+"kb"),j.draw(l,w.TRIANGLES,ae,Se,Ut.alphaBlended,ur.disabled,ys(z,a.Color.transparent,Jt),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var ut={symbol:function(n,o,i,l,w){if(n.renderPass==="translucent"){var z=dt.disabled,j=n.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(ae,Se,He,xt,Et,Tt,Jt){for(var Yt=Se.transform,gr=Et==="map",Vt=Tt==="map",mr=0,Ar=ae;mr<Ar.length;mr+=1){var Xr=Ar[mr],cn=xt.getTile(Xr),nn=cn.getBucket(He);if(nn&&nn.text&&nn.text.segments.get().length){var pn=a.evaluateSizeForZoom(nn.textSizeData,Yt.zoom),Bn=Ia(cn,1,Se.transform.zoom),Zn=ra(Xr.posMatrix,Vt,gr,Se.transform,Bn),Vn=He.layout.get("icon-text-fit")!=="none"&&nn.hasIconData();if(pn){var Si=Math.pow(2,Yt.zoom-cn.tileID.overscaledZ);Cc(nn,gr,Vt,Jt,a.symbolSize,Yt,Zn,Xr.posMatrix,Si,pn,Vn)}}}}(l,n,i,o,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),w),i.paint.get("icon-opacity").constantOr(1)!==0&&ko(n,o,i,l,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),z,j),i.paint.get("text-opacity").constantOr(1)!==0&&ko(n,o,i,l,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),z,j),o.map.showCollisionBoxes&&(ic(n,o,i,l,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),ic(n,o,i,l,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(n,o,i,l){if(n.renderPass==="translucent"){var w=i.paint.get("circle-opacity"),z=i.paint.get("circle-stroke-width"),j=i.paint.get("circle-stroke-opacity"),ae=i.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)!==0||z.constantOr(1)!==0&&j.constantOr(1)!==0){for(var Se=n.context,He=Se.gl,xt=n.depthModeForSublayer(0,je.ReadOnly),Et=dt.disabled,Tt=n.colorModeForRenderPass(),Jt=[],Yt=0;Yt<l.length;Yt++){var gr=l[Yt],Vt=o.getTile(gr),mr=Vt.getBucket(i);if(mr){var Ar=mr.programConfigurations.get(i.id),Xr={programConfiguration:Ar,program:n.useProgram("circle",Ar),layoutVertexBuffer:mr.layoutVertexBuffer,indexBuffer:mr.indexBuffer,uniformValues:Ec(n,gr,Vt,i)};if(ae)for(var cn=0,nn=mr.segments.get();cn<nn.length;cn+=1){var pn=nn[cn];Jt.push({segments:new a.SegmentVector([pn]),sortKey:pn.sortKey,state:Xr})}else Jt.push({segments:mr.segments,sortKey:0,state:Xr})}}ae&&Jt.sort(function(Zi,ca){return Zi.sortKey-ca.sortKey});for(var Bn=0,Zn=Jt;Bn<Zn.length;Bn+=1){var Vn=Zn[Bn],Si=Vn.state;Si.program.draw(Se,He.TRIANGLES,xt,Et,Tt,ur.disabled,Si.uniformValues,i.id,Si.layoutVertexBuffer,Si.indexBuffer,Vn.segments,i.paint,n.transform.zoom,Si.programConfiguration)}}}},heatmap:function(n,o,i,l){if(i.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var w=n.context,z=w.gl,j=dt.disabled,ae=new Ut([z.ONE,z.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(Jt,Yt,gr){var Vt=Jt.gl;Jt.activeTexture.set(Vt.TEXTURE1),Jt.viewport.set([0,0,Yt.width/4,Yt.height/4]);var mr=gr.heatmapFbo;if(mr)Vt.bindTexture(Vt.TEXTURE_2D,mr.colorAttachment.get()),Jt.bindFramebuffer.set(mr.framebuffer);else{var Ar=Vt.createTexture();Vt.bindTexture(Vt.TEXTURE_2D,Ar),Vt.texParameteri(Vt.TEXTURE_2D,Vt.TEXTURE_WRAP_S,Vt.CLAMP_TO_EDGE),Vt.texParameteri(Vt.TEXTURE_2D,Vt.TEXTURE_WRAP_T,Vt.CLAMP_TO_EDGE),Vt.texParameteri(Vt.TEXTURE_2D,Vt.TEXTURE_MIN_FILTER,Vt.LINEAR),Vt.texParameteri(Vt.TEXTURE_2D,Vt.TEXTURE_MAG_FILTER,Vt.LINEAR),mr=gr.heatmapFbo=Jt.createFramebuffer(Yt.width/4,Yt.height/4,!1),function(Xr,cn,nn,pn){var Bn=Xr.gl;Bn.texImage2D(Bn.TEXTURE_2D,0,Bn.RGBA,cn.width/4,cn.height/4,0,Bn.RGBA,Xr.extRenderToTextureHalfFloat?Xr.extTextureHalfFloat.HALF_FLOAT_OES:Bn.UNSIGNED_BYTE,null),pn.colorAttachment.set(nn)}(Jt,Yt,Ar,mr)}})(w,n,i),w.clear({color:a.Color.transparent});for(var Se=0;Se<l.length;Se++){var He=l[Se];if(!o.hasRenderableParent(He)){var xt=o.getTile(He),Et=xt.getBucket(i);if(Et){var Tt=Et.programConfigurations.get(i.id);n.useProgram("heatmap",Tt).draw(w,z.TRIANGLES,je.disabled,j,ae,ur.disabled,bl(He.posMatrix,xt,n.transform.zoom,i.paint.get("heatmap-intensity")),i.id,Et.layoutVertexBuffer,Et.indexBuffer,Et.segments,i.paint,n.transform.zoom,Tt)}}}w.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(Jt,Yt){var gr=Jt.context,Vt=gr.gl,mr=Yt.heatmapFbo;if(mr){gr.activeTexture.set(Vt.TEXTURE0),Vt.bindTexture(Vt.TEXTURE_2D,mr.colorAttachment.get()),gr.activeTexture.set(Vt.TEXTURE1);var Ar=Yt.colorRampTexture;Ar||(Ar=Yt.colorRampTexture=new a.Texture(gr,Yt.colorRamp,Vt.RGBA)),Ar.bind(Vt.LINEAR,Vt.CLAMP_TO_EDGE),Jt.useProgram("heatmapTexture").draw(gr,Vt.TRIANGLES,je.disabled,dt.disabled,Jt.colorModeForRenderPass(),ur.disabled,function(Xr,cn,nn,pn){var Bn=a.create();a.ortho(Bn,0,Xr.width,Xr.height,0,0,1);var Zn=Xr.context.gl;return{u_matrix:Bn,u_world:[Zn.drawingBufferWidth,Zn.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:cn.paint.get("heatmap-opacity")}}(Jt,Yt),Yt.id,Jt.viewportBuffer,Jt.quadTriangleIndexBuffer,Jt.viewportSegments,Yt.paint,Jt.transform.zoom)}}(n,i))},line:function(n,o,i,l){if(n.renderPass==="translucent"){var w=i.paint.get("line-opacity"),z=i.paint.get("line-width");if(w.constantOr(1)!==0&&z.constantOr(1)!==0)for(var j=n.depthModeForSublayer(0,je.ReadOnly),ae=n.colorModeForRenderPass(),Se=i.paint.get("line-dasharray"),He=i.paint.get("line-pattern"),xt=He.constantOr(1),Et=i.paint.get("line-gradient"),Tt=i.getCrossfadeParameters(),Jt=xt?"linePattern":Se?"lineSDF":Et?"lineGradient":"line",Yt=n.context,gr=Yt.gl,Vt=!0,mr=0,Ar=l;mr<Ar.length;mr+=1){var Xr=Ar[mr],cn=o.getTile(Xr);if(!xt||cn.patternsLoaded()){var nn=cn.getBucket(i);if(nn){var pn=nn.programConfigurations.get(i.id),Bn=n.context.program.get(),Zn=n.useProgram(Jt,pn),Vn=Vt||Zn.program!==Bn,Si=He.constantOr(null);if(Si&&cn.imageAtlas){var Zi=cn.imageAtlas,ca=Zi.patternPositions[Si.to.toString()],ma=Zi.patternPositions[Si.from.toString()];ca&&ma&&pn.setConstantPatternPositions(ca,ma)}var Co=xt?Ps(n,cn,i,Tt):Se?hf(n,cn,i,Se,Tt):Et?To(n,cn,i,nn.lineClipsArray.length):El(n,cn,i);if(xt)Yt.activeTexture.set(gr.TEXTURE0),cn.imageAtlasTexture.bind(gr.LINEAR,gr.CLAMP_TO_EDGE),pn.updatePaintBuffers(Tt);else if(Se&&(Vn||n.lineAtlas.dirty))Yt.activeTexture.set(gr.TEXTURE0),n.lineAtlas.bind(Yt);else if(Et){var Pi=nn.gradients[i.id],Ha=Pi.texture;if(i.gradientVersion!==Pi.version){var Ma=256;if(i.stepInterpolant){var Ba=o.getSource().maxzoom,Ea=Xr.canonical.z===Ba?Math.ceil(1<<n.transform.maxZoom-Xr.canonical.z):1;Ma=a.clamp(a.nextPowerOfTwo(nn.maxLineLength/a.EXTENT*1024*Ea),256,Yt.maxTextureSize)}Pi.gradient=a.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Ma,image:Pi.gradient||void 0,clips:nn.lineClipsArray}),Pi.texture?Pi.texture.update(Pi.gradient):Pi.texture=new a.Texture(Yt,Pi.gradient,gr.RGBA),Pi.version=i.gradientVersion,Ha=Pi.texture}Yt.activeTexture.set(gr.TEXTURE0),Ha.bind(i.stepInterpolant?gr.NEAREST:gr.LINEAR,gr.CLAMP_TO_EDGE)}Zn.draw(Yt,gr.TRIANGLES,j,n.stencilModeForClipping(Xr),ae,ur.disabled,Co,i.id,nn.layoutVertexBuffer,nn.indexBuffer,nn.segments,i.paint,n.transform.zoom,pn,nn.layoutVertexBuffer2),Vt=!1}}}}},fill:function(n,o,i,l){var w=i.paint.get("fill-color"),z=i.paint.get("fill-opacity");if(z.constantOr(1)!==0){var j=n.colorModeForRenderPass(),ae=i.paint.get("fill-pattern"),Se=n.opaquePassEnabledForLayer()&&!ae.constantOr(1)&&w.constantOr(a.Color.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===Se){var He=n.depthModeForSublayer(1,n.renderPass==="opaque"?je.ReadWrite:je.ReadOnly);Su(n,o,i,l,He,j,!1)}if(n.renderPass==="translucent"&&i.paint.get("fill-antialias")){var xt=n.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,je.ReadOnly);Su(n,o,i,l,xt,j,!0)}}},"fill-extrusion":function(n,o,i,l){var w=i.paint.get("fill-extrusion-opacity");if(w!==0&&n.renderPass==="translucent"){var z=new je(n.context.gl.LEQUAL,je.ReadWrite,n.depthRangeFor3D);if(w!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))jl(n,o,i,l,z,dt.disabled,Ut.disabled),jl(n,o,i,l,z,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var j=n.colorModeForRenderPass();jl(n,o,i,l,z,dt.disabled,j)}}},hillshade:function(n,o,i,l){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var w=n.context,z=n.depthModeForSublayer(0,je.ReadOnly),j=n.colorModeForRenderPass(),ae=n.renderPass==="translucent"?n.stencilConfigForOverlap(l):[{},l],Se=ae[0],He=0,xt=ae[1];He<xt.length;He+=1){var Et=xt[He],Tt=o.getTile(Et);Tt.needsHillshadePrepare&&n.renderPass==="offscreen"?tf(n,Tt,i,z,dt.disabled,j):n.renderPass==="translucent"&&cl(n,Tt,i,z,Se[Et.overscaledZ],j)}w.viewport.set([0,0,n.width,n.height])}},raster:function(n,o,i,l){if(n.renderPass==="translucent"&&i.paint.get("raster-opacity")!==0&&l.length)for(var w=n.context,z=w.gl,j=o.getSource(),ae=n.useProgram("raster"),Se=n.colorModeForRenderPass(),He=j instanceof rr?[{},l]:n.stencilConfigForOverlap(l),xt=He[0],Et=He[1],Tt=Et[Et.length-1].overscaledZ,Jt=!n.options.moving,Yt=0,gr=Et;Yt<gr.length;Yt+=1){var Vt=gr[Yt],mr=n.depthModeForSublayer(Vt.overscaledZ-Tt,i.paint.get("raster-opacity")===1?je.ReadWrite:je.ReadOnly,z.LESS),Ar=o.getTile(Vt),Xr=n.transform.calculatePosMatrix(Vt.toUnwrapped(),Jt);Ar.registerFadeDuration(i.paint.get("raster-fade-duration"));var cn=o.findLoadedParent(Vt,0),nn=Gl(Ar,cn,o,i,n.transform),pn=void 0,Bn=void 0,Zn=i.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;w.activeTexture.set(z.TEXTURE0),Ar.texture.bind(Zn,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(z.TEXTURE1),cn?(cn.texture.bind(Zn,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),pn=Math.pow(2,cn.tileID.overscaledZ-Ar.tileID.overscaledZ),Bn=[Ar.tileID.canonical.x*pn%1,Ar.tileID.canonical.y*pn%1]):Ar.texture.bind(Zn,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);var Vn=Uc(Xr,Bn||[0,0],pn||1,nn,i);j instanceof rr?ae.draw(w,z.TRIANGLES,mr,dt.disabled,Se,ur.disabled,Vn,i.id,j.boundsBuffer,n.quadTriangleIndexBuffer,j.boundsSegments):ae.draw(w,z.TRIANGLES,mr,xt[Vt.overscaledZ],Se,ur.disabled,Vn,i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,o,i){var l=i.paint.get("background-color"),w=i.paint.get("background-opacity");if(w!==0){var z=n.context,j=z.gl,ae=n.transform,Se=ae.tileSize,He=i.paint.get("background-pattern");if(!n.isPatternMissing(He)){var xt=!He&&l.a===1&&w===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===xt){var Et=dt.disabled,Tt=n.depthModeForSublayer(0,xt==="opaque"?je.ReadWrite:je.ReadOnly),Jt=n.colorModeForRenderPass(),Yt=n.useProgram(He?"backgroundPattern":"background"),gr=ae.coveringTiles({tileSize:Se});He&&(z.activeTexture.set(j.TEXTURE0),n.imageManager.bind(n.context));for(var Vt=i.getCrossfadeParameters(),mr=0,Ar=gr;mr<Ar.length;mr+=1){var Xr=Ar[mr],cn=n.transform.calculatePosMatrix(Xr.toUnwrapped()),nn=He?Zl(cn,w,n,He,{tileID:Xr,tileSize:Se},Vt):Cu(cn,w,l);Yt.draw(z,j.TRIANGLES,Tt,Et,Jt,ur.disabled,nn,i.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,o,i){for(var l=0;l<i.length;l++)_t(n,o,i[l])},custom:function(n,o,i){var l=n.context,w=i.implementation;if(n.renderPass==="offscreen"){var z=w.prerender;z&&(n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),z.call(w,l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),l.setStencilMode(dt.disabled);var j=w.renderingMode==="3d"?new je(n.context.gl.LEQUAL,je.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,je.ReadOnly);l.setDepthMode(j),w.render(l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState(),l.bindFramebuffer.set(null)}}},Wt=function(n,o){this.context=new lt(n),this.transform=o,this._tileTextures={},this.setup(),this.numSublayers=Nt.maxUnderzooming+Nt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _n,this.gpuTimers={}};Wt.prototype.resize=function(n,o){if(this.width=n*a.browser.devicePixelRatio,this.height=o*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,l=this.style._order;i<l.length;i+=1)this.style._layers[l[i]].resize()},Wt.prototype.setup=function(){var n=this.context,o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(o,ci.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var i=new a.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(a.EXTENT,0),i.emplaceBack(0,a.EXTENT),i.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(i,ci.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var l=new a.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(a.EXTENT,0,a.EXTENT,0),l.emplaceBack(0,a.EXTENT,0,a.EXTENT),l.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(l,kt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var w=new a.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(w,ci.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var z=new a.StructArrayLayout1ui2;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(z);var j=new a.StructArrayLayout3ui6;j.emplaceBack(0,1,2),j.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(j),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var ae=this.context.gl;this.stencilClearMode=new dt({func:ae.ALWAYS,mask:0},0,255,ae.ZERO,ae.ZERO,ae.ZERO)},Wt.prototype.clearStencil=function(){var n=this.context,o=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=a.create();a.ortho(i,0,this.width,this.height,0,0,1),a.scale(i,i,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,o.TRIANGLES,je.disabled,this.stencilClearMode,Ut.disabled,ur.disabled,ss(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Wt.prototype._renderTileClippingMasks=function(n,o){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&o&&o.length){this.currentStencilSource=n.source;var i=this.context,l=i.gl;this.nextStencilID+o.length>256&&this.clearStencil(),i.setColorMode(Ut.disabled),i.setDepthMode(je.disabled);var w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var z=0,j=o;z<j.length;z+=1){var ae=j[z],Se=this._tileClippingMaskIDs[ae.key]=this.nextStencilID++;w.draw(i,l.TRIANGLES,je.disabled,new dt({func:l.ALWAYS,mask:0},Se,255,l.KEEP,l.KEEP,l.REPLACE),Ut.disabled,ur.disabled,ss(ae.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Wt.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,o=this.context.gl;return new dt({func:o.NOTEQUAL,mask:255},n,255,o.KEEP,o.KEEP,o.REPLACE)},Wt.prototype.stencilModeForClipping=function(n){var o=this.context.gl;return new dt({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,o.KEEP,o.KEEP,o.REPLACE)},Wt.prototype.stencilConfigForOverlap=function(n){var o,i=this.context.gl,l=n.sort(function(Se,He){return He.overscaledZ-Se.overscaledZ}),w=l[l.length-1].overscaledZ,z=l[0].overscaledZ-w+1;if(z>1){this.currentStencilSource=void 0,this.nextStencilID+z>256&&this.clearStencil();for(var j={},ae=0;ae<z;ae++)j[ae+w]=new dt({func:i.GEQUAL,mask:255},ae+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=z,[j,l]}return[(o={},o[w]=dt.disabled,o),l]},Wt.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new Ut([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ut.unblended:Ut.alphaBlended},Wt.prototype.depthModeForSublayer=function(n,o,i){if(!this.opaquePassEnabledForLayer())return je.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new je(i||this.context.gl.LEQUAL,o,[l,l])},Wt.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Wt.prototype.render=function(n,o){var i=this;this.style=n,this.options=o,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var l=this.style._order,w=this.style.sourceCaches;for(var z in w){var j=w[z];j.used&&j.prepare(this.context)}var ae,Se,He={},xt={},Et={};for(var Tt in w){var Jt=w[Tt];He[Tt]=Jt.getVisibleCoordinates(),xt[Tt]=He[Tt].slice().reverse(),Et[Tt]=Jt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Yt=0;Yt<l.length;Yt++)if(this.style._layers[l[Yt]].is3D()){this.opaquePassCutoff=Yt;break}this.renderPass="offscreen";for(var gr=0,Vt=l;gr<Vt.length;gr+=1){var mr=this.style._layers[Vt[gr]];if(mr.hasOffscreenPass()&&!mr.isHidden(this.transform.zoom)){var Ar=xt[mr.source];(mr.type==="custom"||Ar.length)&&this.renderLayer(this,w[mr.source],mr,Ar)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var Xr=this.style._layers[l[this.currentLayer]],cn=w[Xr.source],nn=He[Xr.source];this._renderTileClippingMasks(Xr,nn),this.renderLayer(this,cn,Xr,nn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var pn=this.style._layers[l[this.currentLayer]],Bn=w[pn.source],Zn=(pn.type==="symbol"?Et:xt)[pn.source];this._renderTileClippingMasks(pn,He[pn.source]),this.renderLayer(this,Bn,pn,Zn)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Vn){Vn.source&&!Vn.isHidden(i.transform.zoom)&&(Vn.source!==(Se&&Se.id)&&(Se=i.style.sourceCaches[Vn.source]),(!ae||ae.getSource().maxzoom<Se.getSource().maxzoom)&&(ae=Se))}),ae&&ut.debug(this,ae,ae.getVisibleCoordinates())),this.options.showPadding&&function(Vn){var Si=Vn.transform.padding;rf(Vn,Vn.transform.height-(Si.top||0),3,fl),rf(Vn,Si.bottom||0,3,jc),le(Vn,Si.left||0,3,Vl),le(Vn,Vn.transform.width-(Si.right||0),3,Cl);var Zi=Vn.transform.centerPoint;(function(ca,ma,Co,Pi){Ve(ca,ma-1,Co-10,2,20,Pi),Ve(ca,ma-10,Co-1,20,2,Pi)})(Vn,Zi.x,Vn.transform.height-Zi.y,Nf)}(this),this.context.setDefault()},Wt.prototype.renderLayer=function(n,o,i,l){i.isHidden(this.transform.zoom)||(i.type==="background"||i.type==="custom"||l.length)&&(this.id=i.id,this.gpuTimingStart(i),ut[i.type](n,o,i,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},Wt.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var o=this.context.extTimerQuery,i=this.gpuTimers[n.id];i||(i=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:o.createQueryEXT()}),i.calls++,o.beginQueryEXT(o.TIME_ELAPSED_EXT,i.query)}},Wt.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Wt.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Wt.prototype.queryGpuTimers=function(n){var o={};for(var i in n){var l=n[i],w=this.context.extTimerQuery,z=w.getQueryObjectEXT(l.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(l.query),o[i]=z}return o},Wt.prototype.translatePosMatrix=function(n,o,i,l,w){if(!i[0]&&!i[1])return n;var z=w?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(z){var j=Math.sin(z),ae=Math.cos(z);i=[i[0]*ae-i[1]*j,i[0]*j+i[1]*ae]}var Se=[w?i[0]:Ia(o,i[0],this.transform.zoom),w?i[1]:Ia(o,i[1],this.transform.zoom),0],He=new Float32Array(16);return a.translate(He,n,Se),He},Wt.prototype.saveTileTexture=function(n){var o=this._tileTextures[n.size[0]];o?o.push(n):this._tileTextures[n.size[0]]=[n]},Wt.prototype.getTileTexture=function(n){var o=this._tileTextures[n];return o&&o.length>0?o.pop():null},Wt.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var o=this.imageManager.getPattern(n.from.toString()),i=this.imageManager.getPattern(n.to.toString());return!o||!i},Wt.prototype.useProgram=function(n,o){this.cache=this.cache||{};var i=""+n+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new tc(this.context,n,fu[n],o,nc[n],this._showOverdrawInspector)),this.cache[i]},Wt.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Wt.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Wt.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Wt.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var hn=function(n,o){this.points=n,this.planes=o};hn.fromInvProjectionMatrix=function(n,o,i){var l=Math.pow(2,i),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(j){return a.transformMat4([],j,n)}).map(function(j){return a.scale$1([],j,1/j[3]/o*l)}),z=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(j){var ae=a.sub([],w[j[0]],w[j[1]]),Se=a.sub([],w[j[2]],w[j[1]]),He=a.normalize([],a.cross([],ae,Se)),xt=-a.dot(He,w[j[1]]);return He.concat(xt)});return new hn(w,z)};var Mi=function(n,o){this.min=n,this.max=o,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};Mi.prototype.quadrant=function(n){for(var o=[n%2==0,n<2],i=a.clone$2(this.min),l=a.clone$2(this.max),w=0;w<o.length;w++)i[w]=o[w]?this.min[w]:this.center[w],l[w]=o[w]?this.center[w]:this.max[w];return l[2]=this.max[2],new Mi(i,l)},Mi.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},Mi.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},Mi.prototype.intersects=function(n){for(var o=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,l=0;l<n.planes.length;l++){for(var w=n.planes[l],z=0,j=0;j<o.length;j++)z+=a.dot$1(w,o[j])>=0;if(z===0)return 0;z!==o.length&&(i=!1)}if(i)return 2;for(var ae=0;ae<3;ae++){for(var Se=Number.MAX_VALUE,He=-Number.MAX_VALUE,xt=0;xt<n.points.length;xt++){var Et=n.points[xt][ae]-this.min[ae];Se=Math.min(Se,Et),He=Math.max(He,Et)}if(He<0||Se>this.max[ae]-this.min[ae])return 0}return 1};var da=function(n,o,i,l){if(n===void 0&&(n=0),o===void 0&&(o=0),i===void 0&&(i=0),l===void 0&&(l=0),isNaN(n)||n<0||isNaN(o)||o<0||isNaN(i)||i<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=o,this.left=i,this.right=l};da.prototype.interpolate=function(n,o,i){return o.top!=null&&n.top!=null&&(this.top=a.number(n.top,o.top,i)),o.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,o.bottom,i)),o.left!=null&&n.left!=null&&(this.left=a.number(n.left,o.left,i)),o.right!=null&&n.right!=null&&(this.right=a.number(n.right,o.right,i)),this},da.prototype.getCenter=function(n,o){var i=a.clamp((this.left+n-this.right)/2,0,n),l=a.clamp((this.top+o-this.bottom)/2,0,o);return new a.Point(i,l)},da.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},da.prototype.clone=function(){return new da(this.top,this.bottom,this.left,this.right)},da.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var oa=function(n,o,i,l,w){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=w===void 0||w,this._minZoom=n||0,this._maxZoom=o||22,this._minPitch=i==null?0:i,this._maxPitch=l==null?60:l,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new da,this._posMatrixCache={},this._alignedPosMatrixCache={}},za={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};oa.prototype.clone=function(){var n=new oa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},za.minZoom.get=function(){return this._minZoom},za.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},za.maxZoom.get=function(){return this._maxZoom},za.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},za.minPitch.get=function(){return this._minPitch},za.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},za.maxPitch.get=function(){return this._maxPitch},za.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},za.renderWorldCopies.get=function(){return this._renderWorldCopies},za.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},za.worldSize.get=function(){return this.tileSize*this.scale},za.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},za.size.get=function(){return new a.Point(this.width,this.height)},za.bearing.get=function(){return-this.angle/Math.PI*180},za.bearing.set=function(n){var o=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},za.pitch.get=function(){return this._pitch/Math.PI*180},za.pitch.set=function(n){var o=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())},za.fov.get=function(){return this._fov/Math.PI*180},za.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},za.zoom.get=function(){return this._zoom},za.zoom.set=function(n){var o=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom,this._constrain(),this._calcMatrices())},za.center.get=function(){return this._center},za.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},za.padding.get=function(){return this._edgeInsets.toJSON()},za.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},za.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},oa.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},oa.prototype.interpolatePadding=function(n,o,i){this._unmodified=!1,this._edgeInsets.interpolate(n,o,i),this._constrain(),this._calcMatrices()},oa.prototype.coveringZoomLevel=function(n){var o=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,o)},oa.prototype.getVisibleUnwrappedCoordinates=function(n){var o=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new a.Point(0,0)),l=this.pointCoordinate(new a.Point(this.width,0)),w=this.pointCoordinate(new a.Point(this.width,this.height)),z=this.pointCoordinate(new a.Point(0,this.height)),j=Math.floor(Math.min(i.x,l.x,w.x,z.x)),ae=Math.floor(Math.max(i.x,l.x,w.x,z.x)),Se=j-1;Se<=ae+1;Se++)Se!==0&&o.push(new a.UnwrappedTileID(Se,n));return o},oa.prototype.coveringTiles=function(n){var o=this.coveringZoomLevel(n),i=o;if(n.minzoom!==void 0&&o<n.minzoom)return[];n.maxzoom!==void 0&&o>n.maxzoom&&(o=n.maxzoom);var l=a.MercatorCoordinate.fromLngLat(this.center),w=Math.pow(2,o),z=[w*l.x,w*l.y,0],j=hn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o),ae=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ae=o);var Se=function(Vn){return{aabb:new Mi([Vn*w,0,0],[(Vn+1)*w,w,0]),zoom:0,x:0,y:0,wrap:Vn,fullyVisible:!1}},He=[],xt=[],Et=o,Tt=n.reparseOverscaled?i:o;if(this._renderWorldCopies)for(var Jt=1;Jt<=3;Jt++)He.push(Se(-Jt)),He.push(Se(Jt));for(He.push(Se(0));He.length>0;){var Yt=He.pop(),gr=Yt.x,Vt=Yt.y,mr=Yt.fullyVisible;if(!mr){var Ar=Yt.aabb.intersects(j);if(Ar===0)continue;mr=Ar===2}var Xr=Yt.aabb.distanceX(z),cn=Yt.aabb.distanceY(z),nn=Math.max(Math.abs(Xr),Math.abs(cn));if(Yt.zoom===Et||nn>3+(1<<Et-Yt.zoom)-2&&Yt.zoom>=ae)xt.push({tileID:new a.OverscaledTileID(Yt.zoom===Et?Tt:Yt.zoom,Yt.wrap,Yt.zoom,gr,Vt),distanceSq:a.sqrLen([z[0]-.5-gr,z[1]-.5-Vt])});else for(var pn=0;pn<4;pn++){var Bn=(gr<<1)+pn%2,Zn=(Vt<<1)+(pn>>1);He.push({aabb:Yt.aabb.quadrant(pn),zoom:Yt.zoom+1,x:Bn,y:Zn,wrap:Yt.wrap,fullyVisible:mr})}}return xt.sort(function(Vn,Si){return Vn.distanceSq-Si.distanceSq}).map(function(Vn){return Vn.tileID})},oa.prototype.resize=function(n,o){this.width=n,this.height=o,this.pixelsToGLUnits=[2/n,-2/o],this._constrain(),this._calcMatrices()},za.unmodified.get=function(){return this._unmodified},oa.prototype.zoomScale=function(n){return Math.pow(2,n)},oa.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},oa.prototype.project=function(n){var o=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(o)*this.worldSize)},oa.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},za.point.get=function(){return this.project(this.center)},oa.prototype.setLocationAtPoint=function(n,o){var i=this.pointCoordinate(o),l=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(n),z=new a.MercatorCoordinate(w.x-(i.x-l.x),w.y-(i.y-l.y));this.center=this.coordinateLocation(z),this._renderWorldCopies&&(this.center=this.center.wrap())},oa.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},oa.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},oa.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},oa.prototype.coordinateLocation=function(n){return n.toLngLat()},oa.prototype.pointCoordinate=function(n){var o=[n.x,n.y,0,1],i=[n.x,n.y,1,1];a.transformMat4(o,o,this.pixelMatrixInverse),a.transformMat4(i,i,this.pixelMatrixInverse);var l=o[3],w=i[3],z=o[1]/l,j=i[1]/w,ae=o[2]/l,Se=i[2]/w,He=ae===Se?0:(0-ae)/(Se-ae);return new a.MercatorCoordinate(a.number(o[0]/l,i[0]/w,He)/this.worldSize,a.number(z,j,He)/this.worldSize)},oa.prototype.coordinatePoint=function(n){var o=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(o,o,this.pixelMatrix),new a.Point(o[0]/o[3],o[1]/o[3])},oa.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},oa.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},oa.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},oa.prototype.calculatePosMatrix=function(n,o){o===void 0&&(o=!1);var i=n.key,l=o?this._alignedPosMatrixCache:this._posMatrixCache;if(l[i])return l[i];var w=n.canonical,z=this.worldSize/this.zoomScale(w.z),j=w.x+Math.pow(2,w.z)*n.wrap,ae=a.identity(new Float64Array(16));return a.translate(ae,ae,[j*z,w.y*z,0]),a.scale(ae,ae,[z/a.EXTENT,z/a.EXTENT,1]),a.multiply(ae,o?this.alignedProjMatrix:this.projMatrix,ae),l[i]=new Float32Array(ae),l[i]},oa.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},oa.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,o,i,l,w=-90,z=90,j=-180,ae=180,Se=this.size,He=this._unmodified;if(this.latRange){var xt=this.latRange;w=a.mercatorYfromLat(xt[1])*this.worldSize,n=(z=a.mercatorYfromLat(xt[0])*this.worldSize)-w<Se.y?Se.y/(z-w):0}if(this.lngRange){var Et=this.lngRange;j=a.mercatorXfromLng(Et[0])*this.worldSize,o=(ae=a.mercatorXfromLng(Et[1])*this.worldSize)-j<Se.x?Se.x/(ae-j):0}var Tt=this.point,Jt=Math.max(o||0,n||0);if(Jt)return this.center=this.unproject(new a.Point(o?(ae+j)/2:Tt.x,n?(z+w)/2:Tt.y)),this.zoom+=this.scaleZoom(Jt),this._unmodified=He,void(this._constraining=!1);if(this.latRange){var Yt=Tt.y,gr=Se.y/2;Yt-gr<w&&(l=w+gr),Yt+gr>z&&(l=z-gr)}if(this.lngRange){var Vt=Tt.x,mr=Se.x/2;Vt-mr<j&&(i=j+mr),Vt+mr>ae&&(i=ae-mr)}i===void 0&&l===void 0||(this.center=this.unproject(new a.Point(i!==void 0?i:Tt.x,l!==void 0?l:Tt.y))),this._unmodified=He,this._constraining=!1}},oa.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var o=Math.PI/2+this._pitch,i=this._fov*(.5+n.y/this.height),l=Math.sin(i)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-o-i,.01,Math.PI-.01)),w=this.point,z=w.x,j=w.y,ae=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),Se=this.height/50,He=new Float64Array(16);a.perspective(He,this._fov,this.width/this.height,Se,ae),He[8]=2*-n.x/this.width,He[9]=2*n.y/this.height,a.scale(He,He,[1,-1,1]),a.translate(He,He,[0,0,-this.cameraToCenterDistance]),a.rotateX(He,He,this._pitch),a.rotateZ(He,He,this.angle),a.translate(He,He,[-z,-j,0]),this.mercatorMatrix=a.scale([],He,[this.worldSize,this.worldSize,this.worldSize]),a.scale(He,He,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=He,this.invProjMatrix=a.invert([],this.projMatrix);var xt=this.width%2/2,Et=this.height%2/2,Tt=Math.cos(this.angle),Jt=Math.sin(this.angle),Yt=z-Math.round(z)+Tt*xt+Jt*Et,gr=j-Math.round(j)+Tt*Et+Jt*xt,Vt=new Float64Array(He);if(a.translate(Vt,Vt,[Yt>.5?Yt-1:Yt,gr>.5?gr-1:gr,0]),this.alignedProjMatrix=Vt,He=a.create(),a.scale(He,He,[this.width/2,-this.height/2,1]),a.translate(He,He,[1,-1,0]),this.labelPlaneMatrix=He,He=a.create(),a.scale(He,He,[1,-1,1]),a.translate(He,He,[-1,-1,0]),a.scale(He,He,[2/this.width,2/this.height,1]),this.glCoordMatrix=He,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(He=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=He,this._posMatrixCache={},this._alignedPosMatrixCache={}}},oa.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),o=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance},oa.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},oa.prototype.getCameraQueryGeometry=function(n){var o=this.getCameraPoint();if(n.length===1)return[n[0],o];for(var i=o.x,l=o.y,w=o.x,z=o.y,j=0,ae=n;j<ae.length;j+=1){var Se=ae[j];i=Math.min(i,Se.x),l=Math.min(l,Se.y),w=Math.max(w,Se.x),z=Math.max(z,Se.y)}return[new a.Point(i,l),new a.Point(w,l),new a.Point(w,z),new a.Point(i,z),new a.Point(i,l)]},Object.defineProperties(oa.prototype,za);var Xo=function(n){var o,i,l,w;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(o=this._updateHashUnthrottled.bind(this),i=!1,l=null,w=function(){l=null,i&&(o(),l=setTimeout(w,300),i=!1)},function(){return i=!0,l||w(),l})};Xo.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Xo.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Xo.prototype.getHashString=function(n){var o=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,l=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,l),z=Math.round(o.lng*w)/w,j=Math.round(o.lat*w)/w,ae=this._map.getBearing(),Se=this._map.getPitch(),He="";if(He+=n?"/"+z+"/"+j+"/"+i:i+"/"+j+"/"+z,(ae||Se)&&(He+="/"+Math.round(10*ae)/10),Se&&(He+="/"+Math.round(Se)),this._hashName){var xt=this._hashName,Et=!1,Tt=a.window.location.hash.slice(1).split("&").map(function(Jt){var Yt=Jt.split("=")[0];return Yt===xt?(Et=!0,Yt+"="+He):Jt}).filter(function(Jt){return Jt});return Et||Tt.push(xt+"="+He),"#"+Tt.join("&")}return"#"+He},Xo.prototype._getCurrentHash=function(){var n,o=this,i=a.window.location.hash.replace("#","");return this._hashName?(i.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===o._hashName&&(n=l)}),(n&&n[1]||"").split("/")):i.split("/")},Xo.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(i){return isNaN(i)})){var o=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:o,pitch:+(n[4]||0)}),!0}return!1},Xo.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch(o){}};var Sc={linearity:.3,easing:a.bezier(0,0,.3,1)},hl=a.extend({deceleration:2500,maxSpeed:1400},Sc),df=a.extend({deceleration:20,maxSpeed:1400},Sc),yh=a.extend({deceleration:1e3,maxSpeed:360},Sc),ih=a.extend({deceleration:1e3,maxSpeed:90},Sc),Hl=function(n){this._map=n,this.clear()};function Sl(n,o){(!n.duration||n.duration<o.duration)&&(n.duration=o.duration,n.easing=o.easing)}function ac(n,o,i){var l=i.maxSpeed,w=i.linearity,z=i.deceleration,j=a.clamp(n*w/(o/1e3),-l,l),ae=Math.abs(j)/(z*w);return{easing:i.easing,duration:1e3*ae,amount:j*(ae/2)}}Hl.prototype.clear=function(){this._inertiaBuffer=[]},Hl.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},Hl.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,o=a.browser.now();n.length>0&&o-n[0].time>160;)n.shift()},Hl.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var o={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},i=0,l=this._inertiaBuffer;i<l.length;i+=1){var w=l[i].settings;o.zoom+=w.zoomDelta||0,o.bearing+=w.bearingDelta||0,o.pitch+=w.pitchDelta||0,w.panDelta&&o.pan._add(w.panDelta),w.around&&(o.around=w.around),w.pinchAround&&(o.pinchAround=w.pinchAround)}var z=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,j={};if(o.pan.mag()){var ae=ac(o.pan.mag(),z,a.extend({},hl,n||{}));j.offset=o.pan.mult(ae.amount/o.pan.mag()),j.center=this._map.transform.center,Sl(j,ae)}if(o.zoom){var Se=ac(o.zoom,z,df);j.zoom=this._map.transform.zoom+Se.amount,Sl(j,Se)}if(o.bearing){var He=ac(o.bearing,z,yh);j.bearing=this._map.transform.bearing+a.clamp(He.amount,-179,179),Sl(j,He)}if(o.pitch){var xt=ac(o.pitch,z,ih);j.pitch=this._map.transform.pitch+xt.amount,Sl(j,xt)}if(j.zoom||j.bearing){var Et=o.pinchAround===void 0?o.around:o.pinchAround;j.around=Et?this._map.unproject(Et):this._map.getCenter()}return this.clear(),a.extend(j,{noMoveStart:!0})}};var Vs=function(n){function o(l,w,z,j){j===void 0&&(j={});var ae=L.mousePos(w.getCanvasContainer(),z),Se=w.unproject(ae);n.call(this,l,a.extend({point:ae,lngLat:Se,originalEvent:z},j)),this._defaultPrevented=!1,this.target=w}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(a.Event),Gc=function(n){function o(l,w,z){var j=l==="touchend"?z.changedTouches:z.touches,ae=L.touchPos(w.getCanvasContainer(),j),Se=ae.map(function(Et){return w.unproject(Et)}),He=ae.reduce(function(Et,Tt,Jt,Yt){return Et.add(Tt.div(Yt.length))},new a.Point(0,0)),xt=w.unproject(He);n.call(this,l,{points:ae,point:He,lngLats:Se,lngLat:xt,originalEvent:z}),this._defaultPrevented=!1}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(a.Event),vf=function(n){function o(l,w,z){n.call(this,l,{originalEvent:z}),this._defaultPrevented=!1}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(a.Event),Hs=function(n,o){this._map=n,this._clickTolerance=o.clickTolerance};Hs.prototype.reset=function(){delete this._mousedownPos},Hs.prototype.wheel=function(n){return this._firePreventable(new vf(n.type,this._map,n))},Hs.prototype.mousedown=function(n,o){return this._mousedownPos=o,this._firePreventable(new Vs(n.type,this._map,n))},Hs.prototype.mouseup=function(n){this._map.fire(new Vs(n.type,this._map,n))},Hs.prototype.click=function(n,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Vs(n.type,this._map,n))},Hs.prototype.dblclick=function(n){return this._firePreventable(new Vs(n.type,this._map,n))},Hs.prototype.mouseover=function(n){this._map.fire(new Vs(n.type,this._map,n))},Hs.prototype.mouseout=function(n){this._map.fire(new Vs(n.type,this._map,n))},Hs.prototype.touchstart=function(n){return this._firePreventable(new Gc(n.type,this._map,n))},Hs.prototype.touchmove=function(n){this._map.fire(new Gc(n.type,this._map,n))},Hs.prototype.touchend=function(n){this._map.fire(new Gc(n.type,this._map,n))},Hs.prototype.touchcancel=function(n){this._map.fire(new Gc(n.type,this._map,n))},Hs.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},Hs.prototype.isEnabled=function(){return!0},Hs.prototype.isActive=function(){return!1},Hs.prototype.enable=function(){},Hs.prototype.disable=function(){};var zi=function(n){this._map=n};zi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},zi.prototype.mousemove=function(n){this._map.fire(new Vs(n.type,this._map,n))},zi.prototype.mousedown=function(){this._delayContextMenu=!0},zi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Vs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},zi.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Vs(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},zi.prototype.isEnabled=function(){return!0},zi.prototype.isActive=function(){return!1},zi.prototype.enable=function(){},zi.prototype.disable=function(){};var ks=function(n,o){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=o.clickTolerance||1};function Vc(n,o){for(var i={},l=0;l<n.length;l++)i[n[l].identifier]=o[l];return i}ks.prototype.isEnabled=function(){return!!this._enabled},ks.prototype.isActive=function(){return!!this._active},ks.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ks.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ks.prototype.mousedown=function(n,o){this.isEnabled()&&n.shiftKey&&n.button===0&&(L.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)},ks.prototype.mousemoveWindow=function(n,o){if(this._active){var i=o;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=i,this._box||(this._box=L.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var w=Math.min(l.x,i.x),z=Math.max(l.x,i.x),j=Math.min(l.y,i.y),ae=Math.max(l.y,i.y);L.setTransform(this._box,"translate("+w+"px,"+j+"px)"),this._box.style.width=z-w+"px",this._box.style.height=ae-j+"px"}}},ks.prototype.mouseupWindow=function(n,o){var i=this;if(this._active&&n.button===0){var l=this._startPos,w=o;if(this.reset(),L.suppressClick(),l.x!==w.x||l.y!==w.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(z){return z.fitScreenCoordinates(l,w,i._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},ks.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},ks.prototype.blur=function(){this.reset()},ks.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos},ks.prototype._fireEvent=function(n,o){return this._map.fire(new a.Event(n,{originalEvent:o}))};var nf=function(n){this.reset(),this.numTouches=n.numTouches};nf.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},nf.prototype.touchstart=function(n,o,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),i.length===this.numTouches&&(this.centroid=function(l){for(var w=new a.Point(0,0),z=0,j=l;z<j.length;z+=1)w._add(j[z]);return w.div(l.length)}(o),this.touches=Vc(i,o)))},nf.prototype.touchmove=function(n,o,i){if(!this.aborted&&this.centroid){var l=Vc(i,o);for(var w in this.touches){var z=l[w];(!z||z.dist(this.touches[w])>30)&&(this.aborted=!0)}}},nf.prototype.touchend=function(n,o,i){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),i.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var Ws=function(n){this.singleTap=new nf(n),this.numTaps=n.numTaps,this.reset()};Ws.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ws.prototype.touchstart=function(n,o,i){this.singleTap.touchstart(n,o,i)},Ws.prototype.touchmove=function(n,o,i){this.singleTap.touchmove(n,o,i)},Ws.prototype.touchend=function(n,o,i){var l=this.singleTap.touchend(n,o,i);if(l){var w=n.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(l)<30;if(w&&z||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Vu=function(){this._zoomIn=new Ws({numTouches:1,numTaps:2}),this._zoomOut=new Ws({numTouches:2,numTaps:1}),this.reset()};Vu.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Vu.prototype.touchstart=function(n,o,i){this._zoomIn.touchstart(n,o,i),this._zoomOut.touchstart(n,o,i)},Vu.prototype.touchmove=function(n,o,i){this._zoomIn.touchmove(n,o,i),this._zoomOut.touchmove(n,o,i)},Vu.prototype.touchend=function(n,o,i){var l=this,w=this._zoomIn.touchend(n,o,i),z=this._zoomOut.touchend(n,o,i);return w?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()+1,around:j.unproject(w)},{originalEvent:n})}}):z?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()-1,around:j.unproject(z)},{originalEvent:n})}}):void 0},Vu.prototype.touchcancel=function(){this.reset()},Vu.prototype.enable=function(){this._enabled=!0},Vu.prototype.disable=function(){this._enabled=!1,this.reset()},Vu.prototype.isEnabled=function(){return this._enabled},Vu.prototype.isActive=function(){return this._active};var mf={0:1,2:2},_i=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};_i.prototype.blur=function(){this.reset()},_i.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},_i.prototype._correctButton=function(n,o){return!1},_i.prototype._move=function(n,o){return{}},_i.prototype.mousedown=function(n,o){if(!this._lastPoint){var i=L.mouseButton(n);this._correctButton(n,i)&&(this._lastPoint=o,this._eventButton=i)}},_i.prototype.mousemoveWindow=function(n,o){var i=this._lastPoint;if(i){if(n.preventDefault(),function(l,w){var z=mf[w];return l.buttons===void 0||(l.buttons&z)!==z}(n,this._eventButton))this.reset();else if(this._moved||!(o.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(i,o)}},_i.prototype.mouseupWindow=function(n){this._lastPoint&&L.mouseButton(n)===this._eventButton&&(this._moved&&L.suppressClick(),this.reset())},_i.prototype.enable=function(){this._enabled=!0},_i.prototype.disable=function(){this._enabled=!1,this.reset()},_i.prototype.isEnabled=function(){return this._enabled},_i.prototype.isActive=function(){return this._active};var gf=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.mousedown=function(i,l){n.prototype.mousedown.call(this,i,l),this._lastPoint&&(this._active=!0)},o.prototype._correctButton=function(i,l){return l===0&&!i.ctrlKey},o.prototype._move=function(i,l){return{around:l,panDelta:l.sub(i)}},o}(_i),$f=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype._correctButton=function(i,l){return l===0&&i.ctrlKey||l===2},o.prototype._move=function(i,l){var w=.8*(l.x-i.x);if(w)return this._active=!0,{bearingDelta:w}},o.prototype.contextmenu=function(i){i.preventDefault()},o}(_i),Al=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype._correctButton=function(i,l){return l===0&&i.ctrlKey||l===2},o.prototype._move=function(i,l){var w=-.5*(l.y-i.y);if(w)return this._active=!0,{pitchDelta:w}},o.prototype.contextmenu=function(i){i.preventDefault()},o}(_i),_s=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};_s.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},_s.prototype.touchstart=function(n,o,i){return this._calculateTransform(n,o,i)},_s.prototype.touchmove=function(n,o,i){if(this._active&&!(i.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,o,i)},_s.prototype.touchend=function(n,o,i){this._calculateTransform(n,o,i),this._active&&i.length<this._minTouches&&this.reset()},_s.prototype.touchcancel=function(){this.reset()},_s.prototype._calculateTransform=function(n,o,i){i.length>0&&(this._active=!0);var l=Vc(i,o),w=new a.Point(0,0),z=new a.Point(0,0),j=0;for(var ae in l){var Se=l[ae],He=this._touches[ae];He&&(w._add(Se),z._add(Se.sub(He)),j++,l[ae]=Se)}if(this._touches=l,!(j<this._minTouches)&&z.mag()){var xt=z.div(j);if(this._sum._add(xt),!(this._sum.mag()<this._clickTolerance))return{around:w.div(j),panDelta:xt}}},_s.prototype.enable=function(){this._enabled=!0},_s.prototype.disable=function(){this._enabled=!1,this.reset()},_s.prototype.isEnabled=function(){return this._enabled},_s.prototype.isActive=function(){return this._active};var Au=function(){this.reset()};function yf(n,o,i){for(var l=0;l<n.length;l++)if(n[l].identifier===i)return o[l]}function Tl(n,o){return Math.log(n/o)/Math.LN2}Au.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Au.prototype._start=function(n){},Au.prototype._move=function(n,o,i){return{}},Au.prototype.touchstart=function(n,o,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([o[0],o[1]]))},Au.prototype.touchmove=function(n,o,i){if(this._firstTwoTouches){n.preventDefault();var l=this._firstTwoTouches,w=l[1],z=yf(i,o,l[0]),j=yf(i,o,w);if(z&&j){var ae=this._aroundCenter?null:z.add(j).div(2);return this._move([z,j],ae,n)}}},Au.prototype.touchend=function(n,o,i){if(this._firstTwoTouches){var l=this._firstTwoTouches,w=l[1],z=yf(i,o,l[0]),j=yf(i,o,w);z&&j||(this._active&&L.suppressClick(),this.reset())}},Au.prototype.touchcancel=function(){this.reset()},Au.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Au.prototype.disable=function(){this._enabled=!1,this.reset()},Au.prototype.isEnabled=function(){return this._enabled},Au.prototype.isActive=function(){return this._active};var Ru=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},o.prototype._start=function(i){this._startDistance=this._distance=i[0].dist(i[1])},o.prototype._move=function(i,l){var w=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Tl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Tl(this._distance,w),pinchAround:l}},o}(Au);function Ac(n,o){return 180*n.angleWith(o)/Math.PI}var ah=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},o.prototype._start=function(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])},o.prototype._move=function(i,l){var w=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ac(this._vector,w),pinchAround:l}},o.prototype._isBelowThreshold=function(i){this._minDiameter=Math.min(this._minDiameter,i.mag());var l=25/(Math.PI*this._minDiameter)*360,w=Ac(i,this._startVector);return Math.abs(w)<l},o}(Au);function zf(n){return Math.abs(n.y)>Math.abs(n.x)}var Uf=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},o.prototype._start=function(i){this._lastPoints=i,zf(i[0].sub(i[1]))&&(this._valid=!1)},o.prototype._move=function(i,l,w){var z=i[0].sub(this._lastPoints[0]),j=i[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(z,j,w.timeStamp),this._valid)return this._lastPoints=i,this._active=!0,{pitchDelta:(z.y+j.y)/2*-.5}},o.prototype.gestureBeginsVertically=function(i,l,w){if(this._valid!==void 0)return this._valid;var z=i.mag()>=2,j=l.mag()>=2;if(z||j){if(!z||!j)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;var ae=i.y>0==l.y>0;return zf(i)&&zf(l)&&ae}},o}(Au),oh={panStep:100,bearingStep:15,pitchStep:10},wl=function(){var n=oh;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function pl(n){return n*(2-n)}wl.prototype.blur=function(){this.reset()},wl.prototype.reset=function(){this._active=!1},wl.prototype.keydown=function(n){var o=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var i=0,l=0,w=0,z=0,j=0;switch(n.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:n.shiftKey?l=-1:(n.preventDefault(),z=-1);break;case 39:n.shiftKey?l=1:(n.preventDefault(),z=1);break;case 38:n.shiftKey?w=1:(n.preventDefault(),j=-1);break;case 40:n.shiftKey?w=-1:(n.preventDefault(),j=1);break;default:return}return this._rotationDisabled&&(l=0,w=0),{cameraAnimation:function(ae){var Se=ae.getZoom();ae.easeTo({duration:300,easeId:"keyboardHandler",easing:pl,zoom:i?Math.round(Se)+i*(n.shiftKey?2:1):Se,bearing:ae.getBearing()+l*o._bearingStep,pitch:ae.getPitch()+w*o._pitchStep,offset:[-z*o._panStep,-j*o._panStep],center:ae.getCenter()},{originalEvent:n})}}}},wl.prototype.enable=function(){this._enabled=!0},wl.prototype.disable=function(){this._enabled=!1,this.reset()},wl.prototype.isEnabled=function(){return this._enabled},wl.prototype.isActive=function(){return this._active},wl.prototype.disableRotation=function(){this._rotationDisabled=!0},wl.prototype.enableRotation=function(){this._rotationDisabled=!1};var fo=function(n,o){this._map=n,this._el=n.getCanvasContainer(),this._handler=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};fo.prototype.setZoomRate=function(n){this._defaultZoomRate=n},fo.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},fo.prototype.isEnabled=function(){return!!this._enabled},fo.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},fo.prototype.isZooming=function(){return!!this._zooming},fo.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},fo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},fo.prototype.wheel=function(n){if(this.isEnabled()){var o=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,i=a.browser.now(),l=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,o!==0&&o%4.000244140625==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(l*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),n.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=n,this._delta-=o,this._active||this._start(n)),n.preventDefault()}},fo.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},fo.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var o=L.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(o)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},fo.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var o=this._map.transform;if(this._delta!==0){var i=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&l!==0&&(l=1/l);var w=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(w*l))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var z,j=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,ae=this._startZoom,Se=this._easing,He=!1;if(this._type==="wheel"&&ae&&Se){var xt=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),Et=Se(xt);z=a.number(ae,j,Et),xt<1?this._frameId||(this._frameId=!0):He=!0}else z=j,He=!0;return this._active=!0,He&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!He,zoomDelta:z-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},fo.prototype._smoothOutEasing=function(n){var o=a.ease;if(this._prevEase){var i=this._prevEase,l=(a.browser.now()-i.start)/i.duration,w=i.easing(l+.01)-i.easing(l),z=.27/Math.sqrt(w*w+1e-4)*.01,j=Math.sqrt(.0729-z*z);o=a.bezier(z,j,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:o},o},fo.prototype.blur=function(){this.reset()},fo.prototype.reset=function(){this._active=!1};var Ju=function(n,o){this._clickZoom=n,this._tapZoom=o};Ju.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ju.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ju.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ju.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ml=function(){this.reset()};Ml.prototype.reset=function(){this._active=!1},Ml.prototype.blur=function(){this.reset()},Ml.prototype.dblclick=function(n,o){return n.preventDefault(),{cameraAnimation:function(i){i.easeTo({duration:300,zoom:i.getZoom()+(n.shiftKey?-1:1),around:i.unproject(o)},{originalEvent:n})}}},Ml.prototype.enable=function(){this._enabled=!0},Ml.prototype.disable=function(){this._enabled=!1,this.reset()},Ml.prototype.isEnabled=function(){return this._enabled},Ml.prototype.isActive=function(){return this._active};var Xs=function(){this._tap=new Ws({numTouches:1,numTaps:1}),this.reset()};Xs.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Xs.prototype.touchstart=function(n,o,i){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=o[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(n,o,i))},Xs.prototype.touchmove=function(n,o,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;var l=o[0],w=l.y-this._swipePoint.y;return this._swipePoint=l,n.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(n,o,i)},Xs.prototype.touchend=function(n,o,i){this._tapTime?this._swipePoint&&i.length===0&&this.reset():this._tap.touchend(n,o,i)&&(this._tapTime=n.timeStamp)},Xs.prototype.touchcancel=function(){this.reset()},Xs.prototype.enable=function(){this._enabled=!0},Xs.prototype.disable=function(){this._enabled=!1,this.reset()},Xs.prototype.isEnabled=function(){return this._enabled},Xs.prototype.isActive=function(){return this._active};var oc=function(n,o,i){this._el=n,this._mousePan=o,this._touchPan=i};oc.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},oc.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},oc.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},oc.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Hc=function(n,o,i){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=o,this._mousePitch=i};Hc.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Hc.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Hc.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Hc.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Tu=function(n,o,i,l){this._el=n,this._touchZoom=o,this._touchRotate=i,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0};Tu.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Tu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Tu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Tu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Tu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Tu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Hu=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Js=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o}(a.Event);function la(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var Vi=function(n,o){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Hl(n),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o),a.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[a.window,"blur",void 0]];for(var l=0,w=this._listeners;l<w.length;l+=1){var z=w[l],j=z[0];L.addEventListener(j,z[1],j===a.window.document?this.handleWindowEvent:this.handleEvent,z[2])}};Vi.prototype.destroy=function(){for(var n=0,o=this._listeners;n<o.length;n+=1){var i=o[n],l=i[0];L.removeEventListener(l,i[1],l===a.window.document?this.handleWindowEvent:this.handleEvent,i[2])}},Vi.prototype._addDefaultHandlers=function(n){var o=this._map,i=o.getCanvasContainer();this._add("mapEvent",new Hs(o,n));var l=o.boxZoom=new ks(o,n);this._add("boxZoom",l);var w=new Vu,z=new Ml;o.doubleClickZoom=new Ju(z,w),this._add("tapZoom",w),this._add("clickZoom",z);var j=new Xs;this._add("tapDragZoom",j);var ae=o.touchPitch=new Uf;this._add("touchPitch",ae);var Se=new $f(n),He=new Al(n);o.dragRotate=new Hc(n,Se,He),this._add("mouseRotate",Se,["mousePitch"]),this._add("mousePitch",He,["mouseRotate"]);var xt=new gf(n),Et=new _s(n);o.dragPan=new oc(i,xt,Et),this._add("mousePan",xt),this._add("touchPan",Et,["touchZoom","touchRotate"]);var Tt=new ah,Jt=new Ru;o.touchZoomRotate=new Tu(i,Jt,Tt,j),this._add("touchRotate",Tt,["touchPan","touchZoom"]),this._add("touchZoom",Jt,["touchPan","touchRotate"]);var Yt=o.scrollZoom=new fo(o,this);this._add("scrollZoom",Yt,["mousePan"]);var gr=o.keyboard=new wl;this._add("keyboard",gr),this._add("blockableMapEvent",new zi(o));for(var Vt=0,mr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Vt<mr.length;Vt+=1){var Ar=mr[Vt];n.interactive&&n[Ar]&&o[Ar].enable(n[Ar])}},Vi.prototype._add=function(n,o,i){this._handlers.push({handlerName:n,handler:o,allowed:i}),this._handlersById[n]=o},Vi.prototype.stop=function(n){if(!this._updatingCamera){for(var o=0,i=this._handlers;o<i.length;o+=1)i[o].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},Vi.prototype.isActive=function(){for(var n=0,o=this._handlers;n<o.length;n+=1)if(o[n].handler.isActive())return!0;return!1},Vi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Vi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Vi.prototype.isMoving=function(){return Boolean(Hu(this._eventsInProgress))||this.isZooming()},Vi.prototype._blockedByActive=function(n,o,i){for(var l in n)if(l!==i&&(!o||o.indexOf(l)<0))return!0;return!1},Vi.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},Vi.prototype._getMapTouches=function(n){for(var o=[],i=0,l=n;i<l.length;i+=1){var w=l[i];this._el.contains(w.target)&&o.push(w)}return o},Vi.prototype.handleEvent=function(n,o){this._updatingCamera=!0;for(var i=n.type==="renderFrame"?void 0:n,l={needsRenderFrame:!1},w={},z={},j=n.touches?this._getMapTouches(n.touches):void 0,ae=j?L.touchPos(this._el,j):L.mousePos(this._el,n),Se=0,He=this._handlers;Se<He.length;Se+=1){var xt=He[Se],Et=xt.handlerName,Tt=xt.handler,Jt=xt.allowed;if(Tt.isEnabled()){var Yt=void 0;this._blockedByActive(z,Jt,Et)?Tt.reset():Tt[o||n.type]&&(Yt=Tt[o||n.type](n,ae,j),this.mergeHandlerResult(l,w,Yt,Et,i),Yt&&Yt.needsRenderFrame&&this._triggerRenderFrame()),(Yt||Tt.isActive())&&(z[Et]=Tt)}}var gr={};for(var Vt in this._previousActiveHandlers)z[Vt]||(gr[Vt]=i);this._previousActiveHandlers=z,(Object.keys(gr).length||la(l))&&(this._changes.push([l,w,gr]),this._triggerRenderFrame()),(Object.keys(z).length||la(l))&&this._map._stop(!0),this._updatingCamera=!1;var mr=l.cameraAnimation;mr&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],mr(this._map))},Vi.prototype.mergeHandlerResult=function(n,o,i,l,w){if(i){a.extend(n,i);var z={handlerName:l,originalEvent:i.originalEvent||w};i.zoomDelta!==void 0&&(o.zoom=z),i.panDelta!==void 0&&(o.drag=z),i.pitchDelta!==void 0&&(o.pitch=z),i.bearingDelta!==void 0&&(o.rotate=z)}},Vi.prototype._applyChanges=function(){for(var n={},o={},i={},l=0,w=this._changes;l<w.length;l+=1){var z=w[l],j=z[0],ae=z[1],Se=z[2];j.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(j.panDelta)),j.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+j.zoomDelta),j.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+j.bearingDelta),j.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+j.pitchDelta),j.around!==void 0&&(n.around=j.around),j.pinchAround!==void 0&&(n.pinchAround=j.pinchAround),j.noInertia&&(n.noInertia=j.noInertia),a.extend(o,ae),a.extend(i,Se)}this._updateMapTransform(n,o,i),this._changes=[]},Vi.prototype._updateMapTransform=function(n,o,i){var l=this._map,w=l.transform;if(!la(n))return this._fireEvents(o,i,!0);var z=n.panDelta,j=n.zoomDelta,ae=n.bearingDelta,Se=n.pitchDelta,He=n.around,xt=n.pinchAround;xt!==void 0&&(He=xt),l._stop(!0),He=He||l.transform.centerPoint;var Et=w.pointLocation(z?He.sub(z):He);ae&&(w.bearing+=ae),Se&&(w.pitch+=Se),j&&(w.zoom+=j),w.setLocationAtPoint(Et,He),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(o,i,!0)},Vi.prototype._fireEvents=function(n,o,i){var l=this,w=Hu(this._eventsInProgress),z=Hu(n),j={};for(var ae in n)this._eventsInProgress[ae]||(j[ae+"start"]=n[ae].originalEvent),this._eventsInProgress[ae]=n[ae];for(var Se in!w&&z&&this._fireEvent("movestart",z.originalEvent),j)this._fireEvent(Se,j[Se]);for(var He in z&&this._fireEvent("move",z.originalEvent),n)this._fireEvent(He,n[He].originalEvent);var xt,Et={};for(var Tt in this._eventsInProgress){var Jt=this._eventsInProgress[Tt],Yt=Jt.handlerName,gr=Jt.originalEvent;this._handlersById[Yt].isActive()||(delete this._eventsInProgress[Tt],Et[Tt+"end"]=xt=o[Yt]||gr)}for(var Vt in Et)this._fireEvent(Vt,Et[Vt]);var mr=Hu(this._eventsInProgress);if(i&&(w||z)&&!mr){this._updatingCamera=!0;var Ar=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Xr=function(cn){return cn!==0&&-l._bearingSnap<cn&&cn<l._bearingSnap};Ar?(Xr(Ar.bearing||this._map.getBearing())&&(Ar.bearing=0),this._map.easeTo(Ar,{originalEvent:xt})):(this._map.fire(new a.Event("moveend",{originalEvent:xt})),Xr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Vi.prototype._fireEvent=function(n,o){this._map.fire(new a.Event(n,o?{originalEvent:o}:{}))},Vi.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(o){delete n._frameId,n.handleEvent(new Js("renderFrame",{timeStamp:o})),n._applyChanges()})},Vi.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var wf=function(n){function o(i,l){n.call(this),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=l.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},o.prototype.setCenter=function(i,l){return this.jumpTo({center:i},l)},o.prototype.panBy=function(i,l,w){return i=a.Point.convert(i).mult(-1),this.panTo(this.transform.center,a.extend({offset:i},l),w)},o.prototype.panTo=function(i,l,w){return this.easeTo(a.extend({center:i},l),w)},o.prototype.getZoom=function(){return this.transform.zoom},o.prototype.setZoom=function(i,l){return this.jumpTo({zoom:i},l),this},o.prototype.zoomTo=function(i,l,w){return this.easeTo(a.extend({zoom:i},l),w)},o.prototype.zoomIn=function(i,l){return this.zoomTo(this.getZoom()+1,i,l),this},o.prototype.zoomOut=function(i,l){return this.zoomTo(this.getZoom()-1,i,l),this},o.prototype.getBearing=function(){return this.transform.bearing},o.prototype.setBearing=function(i,l){return this.jumpTo({bearing:i},l),this},o.prototype.getPadding=function(){return this.transform.padding},o.prototype.setPadding=function(i,l){return this.jumpTo({padding:i},l),this},o.prototype.rotateTo=function(i,l,w){return this.easeTo(a.extend({bearing:i},l),w)},o.prototype.resetNorth=function(i,l){return this.rotateTo(0,a.extend({duration:1e3},i),l),this},o.prototype.resetNorthPitch=function(i,l){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},i),l),this},o.prototype.snapToNorth=function(i,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,l):this},o.prototype.getPitch=function(){return this.transform.pitch},o.prototype.setPitch=function(i,l){return this.jumpTo({pitch:i},l),this},o.prototype.cameraForBounds=function(i,l){i=a.LngLatBounds.convert(i);var w=l&&l.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),w,l)},o.prototype._cameraForBoxAndBearing=function(i,l,w,z){var j={top:0,bottom:0,right:0,left:0};if(typeof(z=a.extend({padding:j,offset:[0,0],maxZoom:this.transform.maxZoom},z)).padding=="number"){var ae=z.padding;z.padding={top:ae,bottom:ae,right:ae,left:ae}}z.padding=a.extend(j,z.padding);var Se=this.transform,He=Se.padding,xt=Se.project(a.LngLat.convert(i)),Et=Se.project(a.LngLat.convert(l)),Tt=xt.rotate(-w*Math.PI/180),Jt=Et.rotate(-w*Math.PI/180),Yt=new a.Point(Math.max(Tt.x,Jt.x),Math.max(Tt.y,Jt.y)),gr=new a.Point(Math.min(Tt.x,Jt.x),Math.min(Tt.y,Jt.y)),Vt=Yt.sub(gr),mr=(Se.width-(He.left+He.right+z.padding.left+z.padding.right))/Vt.x,Ar=(Se.height-(He.top+He.bottom+z.padding.top+z.padding.bottom))/Vt.y;if(!(Ar<0||mr<0)){var Xr=Math.min(Se.scaleZoom(Se.scale*Math.min(mr,Ar)),z.maxZoom),cn=typeof z.offset.x=="number"?new a.Point(z.offset.x,z.offset.y):a.Point.convert(z.offset),nn=new a.Point((z.padding.left-z.padding.right)/2,(z.padding.top-z.padding.bottom)/2).rotate(w*Math.PI/180),pn=cn.add(nn).mult(Se.scale/Se.zoomScale(Xr));return{center:Se.unproject(xt.add(Et).div(2).sub(pn)),zoom:Xr,bearing:w}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},o.prototype.fitBounds=function(i,l,w){return this._fitInternal(this.cameraForBounds(i,l),l,w)},o.prototype.fitScreenCoordinates=function(i,l,w,z,j){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(i)),this.transform.pointLocation(a.Point.convert(l)),w,z),z,j)},o.prototype._fitInternal=function(i,l,w){return i?(delete(l=a.extend(i,l)).padding,l.linear?this.easeTo(l,w):this.flyTo(l,w)):this},o.prototype.jumpTo=function(i,l){this.stop();var w=this.transform,z=!1,j=!1,ae=!1;return"zoom"in i&&w.zoom!==+i.zoom&&(z=!0,w.zoom=+i.zoom),i.center!==void 0&&(w.center=a.LngLat.convert(i.center)),"bearing"in i&&w.bearing!==+i.bearing&&(j=!0,w.bearing=+i.bearing),"pitch"in i&&w.pitch!==+i.pitch&&(ae=!0,w.pitch=+i.pitch),i.padding==null||w.isPaddingEqual(i.padding)||(w.padding=i.padding),this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),z&&this.fire(new a.Event("zoomstart",l)).fire(new a.Event("zoom",l)).fire(new a.Event("zoomend",l)),j&&this.fire(new a.Event("rotatestart",l)).fire(new a.Event("rotate",l)).fire(new a.Event("rotateend",l)),ae&&this.fire(new a.Event("pitchstart",l)).fire(new a.Event("pitch",l)).fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l))},o.prototype.easeTo=function(i,l){var w=this;this._stop(!1,i.easeId),((i=a.extend({offset:[0,0],duration:500,easing:a.ease},i)).animate===!1||!i.essential&&a.browser.prefersReducedMotion)&&(i.duration=0);var z=this.transform,j=this.getZoom(),ae=this.getBearing(),Se=this.getPitch(),He=this.getPadding(),xt="zoom"in i?+i.zoom:j,Et="bearing"in i?this._normalizeBearing(i.bearing,ae):ae,Tt="pitch"in i?+i.pitch:Se,Jt="padding"in i?i.padding:z.padding,Yt=a.Point.convert(i.offset),gr=z.centerPoint.add(Yt),Vt=z.pointLocation(gr),mr=a.LngLat.convert(i.center||Vt);this._normalizeCenter(mr);var Ar,Xr,cn=z.project(Vt),nn=z.project(mr).sub(cn),pn=z.zoomScale(xt-j);i.around&&(Ar=a.LngLat.convert(i.around),Xr=z.locationPoint(Ar));var Bn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||xt!==j,this._rotating=this._rotating||ae!==Et,this._pitching=this._pitching||Tt!==Se,this._padding=!z.isPaddingEqual(Jt),this._easeId=i.easeId,this._prepareEase(l,i.noMoveStart,Bn),this._ease(function(Zn){if(w._zooming&&(z.zoom=a.number(j,xt,Zn)),w._rotating&&(z.bearing=a.number(ae,Et,Zn)),w._pitching&&(z.pitch=a.number(Se,Tt,Zn)),w._padding&&(z.interpolatePadding(He,Jt,Zn),gr=z.centerPoint.add(Yt)),Ar)z.setLocationAtPoint(Ar,Xr);else{var Vn=z.zoomScale(z.zoom-j),Si=xt>j?Math.min(2,pn):Math.max(.5,pn),Zi=Math.pow(Si,1-Zn),ca=z.unproject(cn.add(nn.mult(Zn*Zi)).mult(Vn));z.setLocationAtPoint(z.renderWorldCopies?ca.wrap():ca,gr)}w._fireMoveEvents(l)},function(Zn){w._afterEase(l,Zn)},i),this},o.prototype._prepareEase=function(i,l,w){w===void 0&&(w={}),this._moving=!0,l||w.moving||this.fire(new a.Event("movestart",i)),this._zooming&&!w.zooming&&this.fire(new a.Event("zoomstart",i)),this._rotating&&!w.rotating&&this.fire(new a.Event("rotatestart",i)),this._pitching&&!w.pitching&&this.fire(new a.Event("pitchstart",i))},o.prototype._fireMoveEvents=function(i){this.fire(new a.Event("move",i)),this._zooming&&this.fire(new a.Event("zoom",i)),this._rotating&&this.fire(new a.Event("rotate",i)),this._pitching&&this.fire(new a.Event("pitch",i))},o.prototype._afterEase=function(i,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var w=this._zooming,z=this._rotating,j=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new a.Event("zoomend",i)),z&&this.fire(new a.Event("rotateend",i)),j&&this.fire(new a.Event("pitchend",i)),this.fire(new a.Event("moveend",i))}},o.prototype.flyTo=function(i,l){var w=this;if(!i.essential&&a.browser.prefersReducedMotion){var z=a.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(z,l)}this.stop(),i=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},i);var j=this.transform,ae=this.getZoom(),Se=this.getBearing(),He=this.getPitch(),xt=this.getPadding(),Et="zoom"in i?a.clamp(+i.zoom,j.minZoom,j.maxZoom):ae,Tt="bearing"in i?this._normalizeBearing(i.bearing,Se):Se,Jt="pitch"in i?+i.pitch:He,Yt="padding"in i?i.padding:j.padding,gr=j.zoomScale(Et-ae),Vt=a.Point.convert(i.offset),mr=j.centerPoint.add(Vt),Ar=j.pointLocation(mr),Xr=a.LngLat.convert(i.center||Ar);this._normalizeCenter(Xr);var cn=j.project(Ar),nn=j.project(Xr).sub(cn),pn=i.curve,Bn=Math.max(j.width,j.height),Zn=Bn/gr,Vn=nn.mag();if("minZoom"in i){var Si=a.clamp(Math.min(i.minZoom,ae,Et),j.minZoom,j.maxZoom),Zi=Bn/j.zoomScale(Si-ae);pn=Math.sqrt(Zi/Vn*2)}var ca=pn*pn;function ma(Pa){var Aa=(Zn*Zn-Bn*Bn+(Pa?-1:1)*ca*ca*Vn*Vn)/(2*(Pa?Zn:Bn)*ca*Vn);return Math.log(Math.sqrt(Aa*Aa+1)-Aa)}function Co(Pa){return(Math.exp(Pa)-Math.exp(-Pa))/2}function Pi(Pa){return(Math.exp(Pa)+Math.exp(-Pa))/2}var Ha=ma(0),Ma=function(Pa){return Pi(Ha)/Pi(Ha+pn*Pa)},Ba=function(Pa){return Bn*((Pi(Ha)*(Co(Aa=Ha+pn*Pa)/Pi(Aa))-Co(Ha))/ca)/Vn;var Aa},Ea=(ma(1)-Ha)/pn;if(Math.abs(Vn)<1e-6||!isFinite(Ea)){if(Math.abs(Bn-Zn)<1e-6)return this.easeTo(i,l);var oo=Zn<Bn?-1:1;Ea=Math.abs(Math.log(Zn/Bn))/pn,Ba=function(){return 0},Ma=function(Pa){return Math.exp(oo*pn*Pa)}}return i.duration="duration"in i?+i.duration:1e3*Ea/("screenSpeed"in i?+i.screenSpeed/pn:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=Se!==Tt,this._pitching=Jt!==He,this._padding=!j.isPaddingEqual(Yt),this._prepareEase(l,!1),this._ease(function(Pa){var Aa=Pa*Ea,eu=1/Ma(Aa);j.zoom=Pa===1?Et:ae+j.scaleZoom(eu),w._rotating&&(j.bearing=a.number(Se,Tt,Pa)),w._pitching&&(j.pitch=a.number(He,Jt,Pa)),w._padding&&(j.interpolatePadding(xt,Yt,Pa),mr=j.centerPoint.add(Vt));var As=Pa===1?Xr:j.unproject(cn.add(nn.mult(Ba(Aa))).mult(eu));j.setLocationAtPoint(j.renderWorldCopies?As.wrap():As,mr),w._fireMoveEvents(l)},function(){return w._afterEase(l)},i),this},o.prototype.isEasing=function(){return!!this._easeFrameId},o.prototype.stop=function(){return this._stop()},o.prototype._stop=function(i,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,l)}if(!i){var z=this.handlers;z&&z.stop(!1)}return this},o.prototype._ease=function(i,l,w){w.animate===!1||w.duration===0?(i(1),l()):(this._easeStart=a.browser.now(),this._easeOptions=w,this._onEaseFrame=i,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},o.prototype._renderFrameCallback=function(){var i=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},o.prototype._normalizeBearing=function(i,l){i=a.wrap(i,-180,180);var w=Math.abs(i-l);return Math.abs(i-360-l)<w&&(i-=360),Math.abs(i+360-l)<w&&(i+=360),i},o.prototype._normalizeCenter=function(i){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var w=i.lng-l.center.lng;i.lng+=w>180?-360:w<-180?360:0}},o}(a.Evented),wu=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};wu.prototype.getDefaultPosition=function(){return"bottom-right"},wu.prototype.onAdd=function(n){var o=this.options&&this.options.compact;return this._map=n,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),o&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},wu.prototype.onRemove=function(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},wu.prototype._setElementTitle=function(n,o){var i=this._map._getUIString("AttributionControl."+o);n.title=i,n.setAttribute("aria-label",i)},wu.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},wu.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var i=o.reduce(function(l,w,z){return w.value&&(l+=w.key+"="+w.value+(z<o.length-1?"&":"")),l},"?");n.href=a.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},wu.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},wu.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(ae){return typeof ae!="string"?"":ae})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var o=this._map.style.stylesheet;this.styleOwner=o.owner,this.styleId=o.id}var i=this._map.style.sourceCaches;for(var l in i){var w=i[l];if(w.used){var z=w.getSource();z.attribution&&n.indexOf(z.attribution)<0&&n.push(z.attribution)}}n.sort(function(ae,Se){return ae.length-Se.length});var j=(n=n.filter(function(ae,Se){for(var He=Se+1;He<n.length;He++)if(n[He].indexOf(ae)>=0)return!1;return!0})).join(" | ");j!==this._attribHTML&&(this._attribHTML=j,n.length?(this._innerContainer.innerHTML=j,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},wu.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Wl=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};Wl.prototype.onAdd=function(n){this._map=n,this._container=L.create("div","mapboxgl-ctrl");var o=L.create("a","mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://www.mapbox.com/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Wl.prototype.onRemove=function(){L.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Wl.prototype.getDefaultPosition=function(){return"bottom-left"},Wl.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Wl.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var o in n)if(n[o].getSource().mapbox_logo)return!0;return!1}},Wl.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var o=n[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("mapboxgl-compact"):o.classList.remove("mapboxgl-compact")}};var mu=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};mu.prototype.add=function(n){var o=++this._id;return this._queue.push({callback:n,id:o,cancelled:!1}),o},mu.prototype.remove=function(n){for(var o=this._currentlyRunning,i=0,l=o?this._queue.concat(o):this._queue;i<l.length;i+=1){var w=l[i];if(w.id===n)return void(w.cancelled=!0)}},mu.prototype.run=function(n){n===void 0&&(n=0);var o=this._currentlyRunning=this._queue;this._queue=[];for(var i=0,l=o;i<l.length;i+=1){var w=l[i];if(!w.cancelled&&(w.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},mu.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Pl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Zf=a.window.HTMLImageElement,sc=a.window.HTMLElement,$o=a.window.ImageBitmap,fs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},_f=function(n){function o(l){var w=this;if((l=a.extend({},fs,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var z=new oa(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(n.call(this,z,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new mu,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Pl,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new a.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=a.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof sc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return w._update(!1)}),this.on("moveend",function(){return w._update(!1)}),this.on("zoom",function(){return w._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Vi(this,l),this._hash=l.hash&&new Xo(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,a.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new wu({customAttribution:l.customAttribution})),this.addControl(new Wl,l.logoPosition),this.on("style.load",function(){w.transform.unmodified&&w.jumpTo(w.style.stylesheet)}),this.on("data",function(j){w._update(j.dataType==="style"),w.fire(new a.Event(j.dataType+"data",j))}),this.on("dataloading",function(j){w.fire(new a.Event(j.dataType+"dataloading",j))})}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(l,w){if(w===void 0&&(w=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var z=l.onAdd(this);this._controls.push(l);var j=this._controlPositions[w];return w.indexOf("bottom")!==-1?j.insertBefore(z,j.firstChild):j.appendChild(z),this},o.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var w=this._controls.indexOf(l);return w>-1&&this._controls.splice(w,1),l.onRemove(this),this},o.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},o.prototype.resize=function(l){var w=this._containerDimensions(),z=w[0],j=w[1];if(z===this.transform.width&&j===this.transform.height)return this;this._resizeCanvas(z,j),this.transform.resize(z,j),this.painter.resize(z,j);var ae=!this._moving;return ae&&this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),this.fire(new a.Event("resize",l)),ae&&this.fire(new a.Event("moveend",l)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(a.LngLatBounds.convert(l)),this._update()},o.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},o.prototype.project=function(l){return this.transform.locationPoint(a.LngLat.convert(l))},o.prototype.unproject=function(l){return this.transform.pointLocation(a.Point.convert(l))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(l,w,z){var j,ae=this;if(l==="mouseenter"||l==="mouseover"){var Se=!1;return{layer:w,listener:z,delegates:{mousemove:function(xt){var Et=ae.getLayer(w)?ae.queryRenderedFeatures(xt.point,{layers:[w]}):[];Et.length?Se||(Se=!0,z.call(ae,new Vs(l,ae,xt.originalEvent,{features:Et}))):Se=!1},mouseout:function(){Se=!1}}}}if(l==="mouseleave"||l==="mouseout"){var He=!1;return{layer:w,listener:z,delegates:{mousemove:function(xt){(ae.getLayer(w)?ae.queryRenderedFeatures(xt.point,{layers:[w]}):[]).length?He=!0:He&&(He=!1,z.call(ae,new Vs(l,ae,xt.originalEvent)))},mouseout:function(xt){He&&(He=!1,z.call(ae,new Vs(l,ae,xt.originalEvent)))}}}}return{layer:w,listener:z,delegates:(j={},j[l]=function(xt){var Et=ae.getLayer(w)?ae.queryRenderedFeatures(xt.point,{layers:[w]}):[];Et.length&&(xt.features=Et,z.call(ae,xt),delete xt.features)},j)}},o.prototype.on=function(l,w,z){if(z===void 0)return n.prototype.on.call(this,l,w);var j=this._createDelegatedListener(l,w,z);for(var ae in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(j),j.delegates)this.on(ae,j.delegates[ae]);return this},o.prototype.once=function(l,w,z){if(z===void 0)return n.prototype.once.call(this,l,w);var j=this._createDelegatedListener(l,w,z);for(var ae in j.delegates)this.once(ae,j.delegates[ae]);return this},o.prototype.off=function(l,w,z){var j=this;return z===void 0?n.prototype.off.call(this,l,w):(this._delegatedListeners&&this._delegatedListeners[l]&&function(ae){for(var Se=ae[l],He=0;He<Se.length;He++){var xt=Se[He];if(xt.layer===w&&xt.listener===z){for(var Et in xt.delegates)j.off(Et,xt.delegates[Et]);return Se.splice(He,1),j}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(l,w){if(!this.style)return[];var z;if(w!==void 0||l===void 0||l instanceof a.Point||Array.isArray(l)||(w=l,l=void 0),w=w||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof l[0]=="number")z=[a.Point.convert(l)];else{var j=a.Point.convert(l[0]),ae=a.Point.convert(l[1]);z=[j,new a.Point(ae.x,j.y),ae,new a.Point(j.x,ae.y),j]}return this.style.queryRenderedFeatures(z,w,this.transform)},o.prototype.querySourceFeatures=function(l,w){return this.style.querySourceFeatures(l,w)},o.prototype.setStyle=function(l,w){return(w=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},w)).diff!==!1&&w.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,w),this):(this._localIdeographFontFamily=w.localIdeographFontFamily,this._updateStyle(l,w))},o.prototype._getUIString=function(l){var w=this._locale[l];if(w==null)throw new Error("Missing UI string '"+l+"'");return w},o.prototype._updateStyle=function(l,w){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new Fn(this,w||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Fn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(l,w){var z=this;if(typeof l=="string"){var j=this._requestManager.normalizeStyleURL(l),ae=this._requestManager.transformRequest(j,a.ResourceType.Style);a.getJSON(ae,function(Se,He){Se?z.fire(new a.ErrorEvent(Se)):He&&z._updateDiff(He,w)})}else typeof l=="object"&&this._updateDiff(l,w)},o.prototype._updateDiff=function(l,w){try{this.style.setState(l)&&this._update(!0)}catch(z){a.warnOnce("Unable to perform style diff: "+(z.message||z.error||z)+".  Rebuilding the style from scratch."),this._updateStyle(l,w)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(l,w){return this._lazyInitEmptyStyle(),this.style.addSource(l,w),this._update(!0)},o.prototype.isSourceLoaded=function(l){var w=this.style&&this.style.sourceCaches[l];if(w!==void 0)return w.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},o.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var w in l){var z=l[w]._tiles;for(var j in z){var ae=z[j];if(ae.state!=="loaded"&&ae.state!=="errored")return!1}}return!0},o.prototype.addSourceType=function(l,w,z){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,w,z)},o.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},o.prototype.getSource=function(l){return this.style.getSource(l)},o.prototype.addImage=function(l,w,z){z===void 0&&(z={});var j=z.pixelRatio;j===void 0&&(j=1);var ae=z.sdf;ae===void 0&&(ae=!1);var Se=z.stretchX,He=z.stretchY,xt=z.content;if(this._lazyInitEmptyStyle(),w instanceof Zf||$o&&w instanceof $o){var Et=a.browser.getImageData(w);this.style.addImage(l,{data:new a.RGBAImage({width:Et.width,height:Et.height},Et.data),pixelRatio:j,stretchX:Se,stretchY:He,content:xt,sdf:ae,version:0})}else{if(w.width===void 0||w.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Tt=w;this.style.addImage(l,{data:new a.RGBAImage({width:w.width,height:w.height},new Uint8Array(w.data)),pixelRatio:j,stretchX:Se,stretchY:He,content:xt,sdf:ae,version:0,userImage:Tt}),Tt.onAdd&&Tt.onAdd(this,l)}},o.prototype.updateImage=function(l,w){var z=this.style.getImage(l);if(!z)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var j=w instanceof Zf||$o&&w instanceof $o?a.browser.getImageData(w):w,ae=j.width,Se=j.height,He=j.data;return ae===void 0||Se===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ae!==z.data.width||Se!==z.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(z.data.replace(He,!(w instanceof Zf||$o&&w instanceof $o)),void this.style.updateImage(l,z))},o.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},o.prototype.removeImage=function(l){this.style.removeImage(l)},o.prototype.loadImage=function(l,w){a.getImage(this._requestManager.transformRequest(l,a.ResourceType.Image),w)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(l,w){return this._lazyInitEmptyStyle(),this.style.addLayer(l,w),this._update(!0)},o.prototype.moveLayer=function(l,w){return this.style.moveLayer(l,w),this._update(!0)},o.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},o.prototype.getLayer=function(l){return this.style.getLayer(l)},o.prototype.setLayerZoomRange=function(l,w,z){return this.style.setLayerZoomRange(l,w,z),this._update(!0)},o.prototype.setFilter=function(l,w,z){return z===void 0&&(z={}),this.style.setFilter(l,w,z),this._update(!0)},o.prototype.getFilter=function(l){return this.style.getFilter(l)},o.prototype.setPaintProperty=function(l,w,z,j){return j===void 0&&(j={}),this.style.setPaintProperty(l,w,z,j),this._update(!0)},o.prototype.getPaintProperty=function(l,w){return this.style.getPaintProperty(l,w)},o.prototype.setLayoutProperty=function(l,w,z,j){return j===void 0&&(j={}),this.style.setLayoutProperty(l,w,z,j),this._update(!0)},o.prototype.getLayoutProperty=function(l,w){return this.style.getLayoutProperty(l,w)},o.prototype.setLight=function(l,w){return w===void 0&&(w={}),this._lazyInitEmptyStyle(),this.style.setLight(l,w),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(l,w){return this.style.setFeatureState(l,w),this._update()},o.prototype.removeFeatureState=function(l,w){return this.style.removeFeatureState(l,w),this._update()},o.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var l=0,w=0;return this._container&&(l=this._container.clientWidth||400,w=this._container.clientHeight||300),[l,w]},o.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},o.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=L.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var w=this._canvasContainer=L.create("div","mapboxgl-canvas-container",l);this._interactive&&w.classList.add("mapboxgl-interactive"),this._canvas=L.create("canvas","mapboxgl-canvas",w),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var z=this._containerDimensions();this._resizeCanvas(z[0],z[1]);var j=this._controlContainer=L.create("div","mapboxgl-control-container",l),ae=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Se){ae[Se]=L.create("div","mapboxgl-ctrl-"+Se,j)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},o.prototype._resizeCanvas=function(l,w){var z=a.browser.devicePixelRatio||1;this._canvas.width=z*l,this._canvas.height=z*w,this._canvas.style.width=l+"px",this._canvas.style.height=w+"px"},o.prototype._setupPainter=function(){var l=a.extend({},P.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),w=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);w?(this.painter=new Wt(w,this.transform),a.webpSupported.testSupport(w)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:l}))},o.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:l}))},o.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},o.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},o.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},o.prototype._render=function(l){var w,z=this,j=0,ae=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(w=ae.createQueryEXT(),ae.beginQueryEXT(ae.TIME_ELAPSED_EXT,w),j=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var Se=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var He=this.transform.zoom,xt=a.browser.now();this.style.zoomHistory.update(He,xt);var Et=new a.EvaluationParameters(He,{now:xt,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Tt=Et.crossFadingFactor();Tt===1&&Tt===this._crossFadingFactor||(Se=!0,this._crossFadingFactor=Tt),this.style.update(Et)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||Se)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Jt=a.browser.now()-j;ae.endQueryEXT(ae.TIME_ELAPSED_EXT,w),setTimeout(function(){var Vt=ae.getQueryObjectEXT(w,ae.QUERY_RESULT_EXT)/1e6;ae.deleteQueryEXT(w),z.fire(new a.Event("gpu-timing-frame",{cpuTime:Jt,gpuTime:Vt}))},50)}if(this.listens("gpu-timing-layer")){var Yt=this.painter.collectGpuTimers();setTimeout(function(){var Vt=z.painter.queryGpuTimers(Yt);z.fire(new a.Event("gpu-timing-layer",{layerTimes:Vt}))},50)}var gr=this._sourcesDirty||this._styleDirty||this._placementDirty;return gr||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||gr||(this._fullyLoaded=!0),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,w=this._controls;l<w.length;l+=1)w[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var z=this.painter.context.gl.getExtension("WEBGL_lose_context");z&&z.loseContext(),uc(this._canvasContainer),uc(this._controlContainer),uc(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},o.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(w){l._frame=null,l._render(w)}))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},i.showPadding.get=function(){return!!this._showPadding},i.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(l){this._vertices=l,this._update()},o.prototype._setCacheLimits=function(l,w){a.setCacheLimits(l,w)},i.version.get=function(){return a.version},Object.defineProperties(o.prototype,i),o}(wf);function uc(n){n.parentNode&&n.parentNode.removeChild(n)}var lc={showCompass:!0,showZoom:!0,visualizePitch:!1},Ll=function(n){var o=this;this.options=a.extend({},lc,n),this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(i){return i.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(i){return o._map.zoomIn({},{originalEvent:i})}),L.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(i){return o._map.zoomOut({},{originalEvent:i})}),L.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(i){o.options.visualizePitch?o._map.resetNorthPitch({},{originalEvent:i}):o._map.resetNorth({},{originalEvent:i})}),this._compassIcon=L.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ll.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),o=n===this._map.getMaxZoom(),i=n===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},Ll.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Ll.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new au(this._map,this._compass,this.options.visualizePitch)),this._container},Ll.prototype.onRemove=function(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ll.prototype._createButton=function(n,o){var i=L.create("button",n,this._container);return i.type="button",i.addEventListener("click",o),i},Ll.prototype._setButtonTitle=function(n,o){var i=this._map._getUIString("NavigationControl."+o);n.title=i,n.setAttribute("aria-label",i)};var au=function(n,o,i){i===void 0&&(i=!1),this._clickTolerance=10,this.element=o,this.mouseRotate=new $f({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,i&&(this.mousePitch=new Al({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),L.addEventListener(o,"mousedown",this.mousedown),L.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(o,"touchmove",this.touchmove),L.addEventListener(o,"touchend",this.touchend),L.addEventListener(o,"touchcancel",this.reset)};function Tc(n,o,i){if(n=new a.LngLat(n.lng,n.lat),o){var l=new a.LngLat(n.lng-360,n.lat),w=new a.LngLat(n.lng+360,n.lat),z=i.locationPoint(n).distSqr(o);i.locationPoint(l).distSqr(o)<z?n=l:i.locationPoint(w).distSqr(o)<z&&(n=w)}for(;Math.abs(n.lng-i.center.lng)>180;){var j=i.locationPoint(n);if(j.x>=0&&j.y>=0&&j.x<=i.width&&j.y<=i.height)break;n.lng>i.center.lng?n.lng-=360:n.lng+=360}return n}au.prototype.down=function(n,o){this.mouseRotate.mousedown(n,o),this.mousePitch&&this.mousePitch.mousedown(n,o),L.disableDrag()},au.prototype.move=function(n,o){var i=this.map,l=this.mouseRotate.mousemoveWindow(n,o);if(l&&l.bearingDelta&&i.setBearing(i.getBearing()+l.bearingDelta),this.mousePitch){var w=this.mousePitch.mousemoveWindow(n,o);w&&w.pitchDelta&&i.setPitch(i.getPitch()+w.pitchDelta)}},au.prototype.off=function(){var n=this.element;L.removeEventListener(n,"mousedown",this.mousedown),L.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(n,"touchmove",this.touchmove),L.removeEventListener(n,"touchend",this.touchend),L.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},au.prototype.offTemp=function(){L.enableDrag(),L.removeEventListener(a.window,"mousemove",this.mousemove),L.removeEventListener(a.window,"mouseup",this.mouseup)},au.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),L.mousePos(this.element,n)),L.addEventListener(a.window,"mousemove",this.mousemove),L.addEventListener(a.window,"mouseup",this.mouseup)},au.prototype.mousemove=function(n){this.move(n,L.mousePos(this.element,n))},au.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},au.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},au.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},au.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},au.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var cc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xf(n,o,i){var l=n.classList;for(var w in cc)l.remove("mapboxgl-"+i+"-anchor-"+w);l.add("mapboxgl-"+i+"-anchor-"+o)}var fc,Xl=function(n){function o(i,l){if(n.call(this),(i instanceof a.window.HTMLElement||l)&&(i=a.extend({element:i},l)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=a.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div"),this._element.setAttribute("aria-label","Map marker");var w=L.createNS("http://www.w3.org/2000/svg","svg");w.setAttributeNS(null,"display","block"),w.setAttributeNS(null,"height","41px"),w.setAttributeNS(null,"width","27px"),w.setAttributeNS(null,"viewBox","0 0 27 41");var z=L.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"stroke","none"),z.setAttributeNS(null,"stroke-width","1"),z.setAttributeNS(null,"fill","none"),z.setAttributeNS(null,"fill-rule","evenodd");var j=L.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill-rule","nonzero");var ae=L.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ae.setAttributeNS(null,"fill","#000000");for(var Se=0,He=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Se<He.length;Se+=1){var xt=He[Se],Et=L.createNS("http://www.w3.org/2000/svg","ellipse");Et.setAttributeNS(null,"opacity","0.04"),Et.setAttributeNS(null,"cx","10.5"),Et.setAttributeNS(null,"cy","5.80029008"),Et.setAttributeNS(null,"rx",xt.rx),Et.setAttributeNS(null,"ry",xt.ry),ae.appendChild(Et)}var Tt=L.createNS("http://www.w3.org/2000/svg","g");Tt.setAttributeNS(null,"fill",this._color);var Jt=L.createNS("http://www.w3.org/2000/svg","path");Jt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Tt.appendChild(Jt);var Yt=L.createNS("http://www.w3.org/2000/svg","g");Yt.setAttributeNS(null,"opacity","0.25"),Yt.setAttributeNS(null,"fill","#000000");var gr=L.createNS("http://www.w3.org/2000/svg","path");gr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Yt.appendChild(gr);var Vt=L.createNS("http://www.w3.org/2000/svg","g");Vt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Vt.setAttributeNS(null,"fill","#FFFFFF");var mr=L.createNS("http://www.w3.org/2000/svg","g");mr.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ar=L.createNS("http://www.w3.org/2000/svg","circle");Ar.setAttributeNS(null,"fill","#000000"),Ar.setAttributeNS(null,"opacity","0.25"),Ar.setAttributeNS(null,"cx","5.5"),Ar.setAttributeNS(null,"cy","5.5"),Ar.setAttributeNS(null,"r","5.4999962");var Xr=L.createNS("http://www.w3.org/2000/svg","circle");Xr.setAttributeNS(null,"fill","#FFFFFF"),Xr.setAttributeNS(null,"cx","5.5"),Xr.setAttributeNS(null,"cy","5.5"),Xr.setAttributeNS(null,"r","5.4999962"),mr.appendChild(Ar),mr.appendChild(Xr),j.appendChild(ae),j.appendChild(Tt),j.appendChild(Yt),j.appendChild(Vt),j.appendChild(mr),w.appendChild(j),w.setAttributeNS(null,"height",41*this._scale+"px"),w.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(w),this._offset=a.Point.convert(i&&i.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(cn){cn.preventDefault()}),this._element.addEventListener("mousedown",function(cn){cn.preventDefault()}),xf(this._element,this._anchor,"marker"),this._popup=null}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.addTo=function(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},o.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(i){return this._lngLat=a.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},o.prototype.getElement=function(){return this._element},o.prototype.setPopup=function(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},o.prototype._onKeyPress=function(i){var l=i.code,w=i.charCode||i.keyCode;l!=="Space"&&l!=="Enter"&&w!==32&&w!==13||this.togglePopup()},o.prototype._onMapClick=function(i){var l=i.originalEvent.target,w=this._element;this._popup&&(l===w||w.contains(l))&&this.togglePopup()},o.prototype.getPopup=function(){return this._popup},o.prototype.togglePopup=function(){var i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this},o.prototype._update=function(i){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Tc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w="rotateX("+this._map.getPitch()+"deg)"),i&&i.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,cc[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+w+" "+l)}},o.prototype.getOffset=function(){return this._offset},o.prototype.setOffset=function(i){return this._offset=a.Point.convert(i),this._update(),this},o.prototype._onMove=function(i){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},o.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},o.prototype._addDragHandler=function(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},o.prototype.setDraggable=function(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},o.prototype.isDraggable=function(){return this._draggable},o.prototype.setRotation=function(i){return this._rotation=i||0,this._update(),this},o.prototype.getRotation=function(){return this._rotation},o.prototype.setRotationAlignment=function(i){return this._rotationAlignment=i||"auto",this._update(),this},o.prototype.getRotationAlignment=function(){return this._rotationAlignment},o.prototype.setPitchAlignment=function(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this},o.prototype.getPitchAlignment=function(){return this._pitchAlignment},o}(a.Evented),Mf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},af=0,Yl=!1,of=function(n){function o(i){n.call(this),this.options=a.extend({},Mf,i),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.onAdd=function(i){var l;return this._map=i,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,fc!==void 0?l(fc):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(w){l(fc=w.state!=="denied")}):l(fc=!!a.window.navigator.geolocation),this._container},o.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,af=0,Yl=!1},o.prototype._isOutOfMapMaxBounds=function(i){var l=this._map.getMaxBounds(),w=i.coords;return l&&(w.longitude<l.getWest()||w.longitude>l.getEast()||w.latitude<l.getSouth()||w.latitude>l.getNorth())},o.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},o.prototype._onSuccess=function(i){if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",i)),this._finish()}},o.prototype._updateCamera=function(i){var l=new a.LngLat(i.coords.longitude,i.coords.latitude),w=i.coords.accuracy,z=this._map.getBearing(),j=a.extend({bearing:z},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(w),j,{geolocateSource:!0})},o.prototype._updateMarker=function(i){if(i){var l=new a.LngLat(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},o.prototype._updateCircleRadius=function(){var i=this._map._container.clientHeight/2,l=this._map.unproject([0,i]),w=this._map.unproject([1,i]),z=l.distanceTo(w),j=Math.ceil(2*this._accuracy/z);this._circleElement.style.width=j+"px",this._circleElement.style.height=j+"px"},o.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},o.prototype._onError=function(i){if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&Yl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",i)),this._finish()}},o.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},o.prototype._setupUI=function(i){var l=this;if(this._container.addEventListener("contextmenu",function(j){return j.preventDefault()}),this._geolocateButton=L.create("button","mapboxgl-ctrl-geolocate",this._container),L.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",i===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var w=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}else{var z=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=z,this._geolocateButton.setAttribute("aria-label",z)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Xl(this._dotElement),this._circleElement=L.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Xl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(j){j.geolocateSource||l._watchState!=="ACTIVE_LOCK"||j.originalEvent&&j.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new a.Event("trackuserlocationend")))})},o.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":af--,Yl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var i;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++af>1?(i={maximumAge:6e5,timeout:0},Yl=!0):(i=this.options.positionOptions,Yl=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,i)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},o.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},o}(a.Evented),$l={maxWidth:100,unit:"metric"},Kl=function(n){this.options=a.extend({},$l,n),a.bindAll(["_onMove","setUnit"],this)};function hc(n,o,i){var l=i&&i.maxWidth||100,w=n._container.clientHeight/2,z=n.unproject([0,w]),j=n.unproject([l,w]),ae=z.distanceTo(j);if(i&&i.unit==="imperial"){var Se=3.2808*ae;Se>5280?gu(o,l,Se/5280,n._getUIString("ScaleControl.Miles")):gu(o,l,Se,n._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?gu(o,l,ae/1852,n._getUIString("ScaleControl.NauticalMiles")):ae>=1e3?gu(o,l,ae/1e3,n._getUIString("ScaleControl.Kilometers")):gu(o,l,ae,n._getUIString("ScaleControl.Meters"))}function gu(n,o,i,l){var w,z,j,ae=(w=i,(z=Math.pow(10,(""+Math.floor(w)).length-1))*(j=(j=w/z)>=10?10:j>=5?5:j>=3?3:j>=2?2:j>=1?1:function(Se){var He=Math.pow(10,Math.ceil(-Math.log(Se)/Math.LN10));return Math.round(Se*He)/He}(j)));n.style.width=o*(ae/i)+"px",n.innerHTML=ae+"&nbsp;"+l}Kl.prototype.getDefaultPosition=function(){return"bottom-left"},Kl.prototype._onMove=function(){hc(this._map,this._container,this.options)},Kl.prototype.onAdd=function(n){return this._map=n,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Kl.prototype.onRemove=function(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Kl.prototype.setUnit=function(n){this.options.unit=n,hc(this._map,this._container,this.options)};var el=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};el.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},el.prototype.onRemove=function(){L.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},el.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},el.prototype._setupUI=function(){var n=this._fullscreenButton=L.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},el.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},el.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},el.prototype._isFullscreen=function(){return this._fullscreen},el.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},el.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Wc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},sf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),sh=function(n){function o(i){n.call(this),this.options=a.extend(Object.create(Wc),i),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.addTo=function(i){return this._map&&this.remove(),this._map=i,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},o.prototype.isOpen=function(){return!!this._map},o.prototype.remove=function(){return this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(i){return this._lngLat=a.LngLat.convert(i),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},o.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},o.prototype.getElement=function(){return this._container},o.prototype.setText=function(i){return this.setDOMContent(a.window.document.createTextNode(i))},o.prototype.setHTML=function(i){var l,w=a.window.document.createDocumentFragment(),z=a.window.document.createElement("body");for(z.innerHTML=i;l=z.firstChild;)w.appendChild(l);return this.setDOMContent(w)},o.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},o.prototype.setMaxWidth=function(i){return this.options.maxWidth=i,this._update(),this},o.prototype.setDOMContent=function(i){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(i),this._createCloseButton(),this._update(),this._focusFirstElement(),this},o.prototype.addClassName=function(i){this._container&&this._container.classList.add(i)},o.prototype.removeClassName=function(i){this._container&&this._container.classList.remove(i)},o.prototype.setOffset=function(i){return this.options.offset=i,this._update(),this},o.prototype.toggleClassName=function(i){if(this._container)return this._container.classList.toggle(i)},o.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=L.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},o.prototype._onMouseUp=function(i){this._update(i.point)},o.prototype._onMouseMove=function(i){this._update(i.point)},o.prototype._onDrag=function(i){this._update(i.point)},o.prototype._update=function(i){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=L.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=L.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Et){return l._container.classList.add(Et)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||i)){var w=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat),z=this.options.anchor,j=function Et(Tt){if(Tt){if(typeof Tt=="number"){var Jt=Math.round(Math.sqrt(.5*Math.pow(Tt,2)));return{center:new a.Point(0,0),top:new a.Point(0,Tt),"top-left":new a.Point(Jt,Jt),"top-right":new a.Point(-Jt,Jt),bottom:new a.Point(0,-Tt),"bottom-left":new a.Point(Jt,-Jt),"bottom-right":new a.Point(-Jt,-Jt),left:new a.Point(Tt,0),right:new a.Point(-Tt,0)}}if(Tt instanceof a.Point||Array.isArray(Tt)){var Yt=a.Point.convert(Tt);return{center:Yt,top:Yt,"top-left":Yt,"top-right":Yt,bottom:Yt,"bottom-left":Yt,"bottom-right":Yt,left:Yt,right:Yt}}return{center:a.Point.convert(Tt.center||[0,0]),top:a.Point.convert(Tt.top||[0,0]),"top-left":a.Point.convert(Tt["top-left"]||[0,0]),"top-right":a.Point.convert(Tt["top-right"]||[0,0]),bottom:a.Point.convert(Tt.bottom||[0,0]),"bottom-left":a.Point.convert(Tt["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(Tt["bottom-right"]||[0,0]),left:a.Point.convert(Tt.left||[0,0]),right:a.Point.convert(Tt.right||[0,0])}}return Et(new a.Point(0,0))}(this.options.offset);if(!z){var ae,Se=this._container.offsetWidth,He=this._container.offsetHeight;ae=w.y+j.bottom.y<He?["top"]:w.y>this._map.transform.height-He?["bottom"]:[],w.x<Se/2?ae.push("left"):w.x>this._map.transform.width-Se/2&&ae.push("right"),z=ae.length===0?"bottom":ae.join("-")}var xt=w.add(j[z]).round();L.setTransform(this._container,cc[z]+" translate("+xt.x+"px,"+xt.y+"px)"),xf(this._container,z,"popup")}},o.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var i=this._container.querySelector(sf);i&&i.focus()}},o.prototype._onClose=function(){this.remove()},o}(a.Evented),Pf={version:a.version,supported:P,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:_f,NavigationControl:Ll,GeolocateControl:of,AttributionControl:wu,ScaleControl:Kl,FullscreenControl:el,Popup:sh,Marker:Xl,Style:Fn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Pr().acquire(Jr)},clearPrewarmedResources:function(){var n=hi;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Jr),hi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return Tn.workerCount},set workerCount(n){Tn.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return Pf}),v})},28660:function(Ft,A,y){var v=y(34155);/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Z;(function(a){(function(P){var L=typeof y.g=="object"?y.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),O=D(a);typeof L.Reflect=="undefined"?L.Reflect=a:O=D(L.Reflect,O),P(O);function D(B,V){return function(N,Y){typeof B[N]!="function"&&Object.defineProperty(B,N,{configurable:!0,writable:!0,value:Y}),V&&V(N,Y)}}})(function(P){var L=Object.prototype.hasOwnProperty,O=typeof Symbol=="function",D=O&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",B=O&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",V=typeof Object.create=="function",N={__proto__:[]}instanceof Array,Y=!V&&!N,H={create:V?function(){return pt(Object.create(null))}:N?function(){return pt({__proto__:null})}:function(){return pt({})},has:Y?function(Me,Ue){return L.call(Me,Ue)}:function(Me,Ue){return Ue in Me},get:Y?function(Me,Ue){return L.call(Me,Ue)?Me[Ue]:void 0}:function(Me,Ue){return Me[Ue]}},ce=Object.getPrototypeOf(Function),at=typeof v=="object"&&{NODE_ENV:"production"}&&{NODE_ENV:"production"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",rt=!at&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:J(),Re=!at&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:ht(),vt=!at&&typeof WeakMap=="function"?WeakMap:ze(),wt=new vt;function fe(Me,Ue,yt,gt){if(vr(yt)){if(!Cr(Me))throw new TypeError;if(!nt(Ue))throw new TypeError;return qt(Me,Ue)}else{if(!Cr(Me))throw new TypeError;if(!Ae(Ue))throw new TypeError;if(!Ae(gt)&&!vr(gt)&&!jr(gt))throw new TypeError;return jr(gt)&&(gt=void 0),yt=Mr(yt),ir(Me,Ue,yt,gt)}}P("decorate",fe);function $e(Me,Ue){function yt(gt,nr){if(!Ae(gt))throw new TypeError;if(!vr(nr)&&!Ye(nr))throw new TypeError;me(Me,Ue,gt,nr)}return yt}P("metadata",$e);function re(Me,Ue,yt,gt){if(!Ae(yt))throw new TypeError;return vr(gt)||(gt=Mr(gt)),me(Me,Ue,yt,gt)}P("defineMetadata",re);function Ge(Me,Ue,yt){if(!Ae(Ue))throw new TypeError;return vr(yt)||(yt=Mr(yt)),Ne(Me,Ue,yt)}P("hasMetadata",Ge);function Qe(Me,Ue,yt){if(!Ae(Ue))throw new TypeError;return vr(yt)||(yt=Mr(yt)),Xe(Me,Ue,yt)}P("hasOwnMetadata",Qe);function Te(Me,Ue,yt){if(!Ae(Ue))throw new TypeError;return vr(yt)||(yt=Mr(yt)),kt(Me,Ue,yt)}P("getMetadata",Te);function Le(Me,Ue,yt){if(!Ae(Ue))throw new TypeError;return vr(yt)||(yt=Mr(yt)),rr(Me,Ue,yt)}P("getOwnMetadata",Le);function Ce(Me,Ue){if(!Ae(Me))throw new TypeError;return vr(Ue)||(Ue=Mr(Ue)),et(Me,Ue)}P("getMetadataKeys",Ce);function Fe(Me,Ue){if(!Ae(Me))throw new TypeError;return vr(Ue)||(Ue=Mr(Ue)),or(Me,Ue)}P("getOwnMetadataKeys",Fe);function Ke(Me,Ue,yt){if(!Ae(Ue))throw new TypeError;vr(yt)||(yt=Mr(yt));var gt=Pe(Ue,yt,!1);if(vr(gt)||!gt.delete(Me))return!1;if(gt.size>0)return!0;var nr=wt.get(Ue);return nr.delete(yt),nr.size>0||wt.delete(Ue),!0}P("deleteMetadata",Ke);function qt(Me,Ue){for(var yt=Me.length-1;yt>=0;--yt){var gt=Me[yt],nr=gt(Ue);if(!vr(nr)&&!jr(nr)){if(!nt(nr))throw new TypeError;Ue=nr}}return Ue}function ir(Me,Ue,yt,gt){for(var nr=Me.length-1;nr>=0;--nr){var pe=Me[nr],lr=pe(Ue,yt,gt);if(!vr(lr)&&!jr(lr)){if(!Ae(lr))throw new TypeError;gt=lr}}return gt}function Pe(Me,Ue,yt){var gt=wt.get(Me);if(vr(gt)){if(!yt)return;gt=new rt,wt.set(Me,gt)}var nr=gt.get(Ue);if(vr(nr)){if(!yt)return;nr=new rt,gt.set(Ue,nr)}return nr}function Ne(Me,Ue,yt){var gt=Xe(Me,Ue,yt);if(gt)return!0;var nr=ye(Ue);return jr(nr)?!1:Ne(Me,nr,yt)}function Xe(Me,Ue,yt){var gt=Pe(Ue,yt,!1);return vr(gt)?!1:Bt(gt.has(Me))}function kt(Me,Ue,yt){var gt=Xe(Me,Ue,yt);if(gt)return rr(Me,Ue,yt);var nr=ye(Ue);if(!jr(nr))return kt(Me,nr,yt)}function rr(Me,Ue,yt){var gt=Pe(Ue,yt,!1);if(!vr(gt))return gt.get(Me)}function me(Me,Ue,yt,gt){var nr=Pe(yt,gt,!0);nr.set(Me,Ue)}function et(Me,Ue){var yt=or(Me,Ue),gt=ye(Me);if(gt===null)return yt;var nr=et(gt,Ue);if(nr.length<=0)return yt;if(yt.length<=0)return nr;for(var pe=new Re,lr=[],Ur=0,Hr=yt;Ur<Hr.length;Ur++){var un=Hr[Ur],bn=pe.has(un);bn||(pe.add(un),lr.push(un))}for(var Gn=0,li=nr;Gn<li.length;Gn++){var un=li[Gn],bn=pe.has(un);bn||(pe.add(un),lr.push(un))}return lr}function or(Me,Ue){var yt=[],gt=Pe(Me,Ue,!1);if(vr(gt))return yt;for(var nr=gt.keys(),pe=W(nr),lr=0;;){var Ur=X(pe);if(!Ur)return yt.length=lr,yt;var Hr=ue(Ur);try{yt[lr]=Hr}catch(un){try{ie(pe)}finally{throw un}}lr++}}function on(Me){if(Me===null)return 1;switch(typeof Me){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Me===null?1:6;default:return 6}}function vr(Me){return Me===void 0}function jr(Me){return Me===null}function xr(Me){return typeof Me=="symbol"}function Ae(Me){return typeof Me=="object"?Me!==null:typeof Me=="function"}function De(Me,Ue){switch(on(Me)){case 0:return Me;case 1:return Me;case 2:return Me;case 3:return Me;case 4:return Me;case 5:return Me}var yt=Ue===3?"string":Ue===5?"number":"default",gt=M(Me,D);if(gt!==void 0){var nr=gt.call(Me,yt);if(Ae(nr))throw new TypeError;return nr}return ke(Me,yt==="default"?"number":yt)}function ke(Me,Ue){if(Ue==="string"){var yt=Me.toString;if(Nr(yt)){var gt=yt.call(Me);if(!Ae(gt))return gt}var nr=Me.valueOf;if(Nr(nr)){var gt=nr.call(Me);if(!Ae(gt))return gt}}else{var nr=Me.valueOf;if(Nr(nr)){var gt=nr.call(Me);if(!Ae(gt))return gt}var pe=Me.toString;if(Nr(pe)){var gt=pe.call(Me);if(!Ae(gt))return gt}}throw new TypeError}function Bt(Me){return!!Me}function mt(Me){return""+Me}function Mr(Me){var Ue=De(Me,3);return xr(Ue)?Ue:mt(Ue)}function Cr(Me){return Array.isArray?Array.isArray(Me):Me instanceof Object?Me instanceof Array:Object.prototype.toString.call(Me)==="[object Array]"}function Nr(Me){return typeof Me=="function"}function nt(Me){return typeof Me=="function"}function Ye(Me){switch(on(Me)){case 3:return!0;case 4:return!0;default:return!1}}function M(Me,Ue){var yt=Me[Ue];if(yt!=null){if(!Nr(yt))throw new TypeError;return yt}}function W(Me){var Ue=M(Me,B);if(!Nr(Ue))throw new TypeError;var yt=Ue.call(Me);if(!Ae(yt))throw new TypeError;return yt}function ue(Me){return Me.value}function X(Me){var Ue=Me.next();return Ue.done?!1:Ue}function ie(Me){var Ue=Me.return;Ue&&Ue.call(Me)}function ye(Me){var Ue=Object.getPrototypeOf(Me);if(typeof Me!="function"||Me===ce||Ue!==ce)return Ue;var yt=Me.prototype,gt=yt&&Object.getPrototypeOf(yt);if(gt==null||gt===Object.prototype)return Ue;var nr=gt.constructor;return typeof nr!="function"||nr===Me?Ue:nr}function J(){var Me={},Ue=[],yt=function(){function lr(Ur,Hr,un){this._index=0,this._keys=Ur,this._values=Hr,this._selector=un}return lr.prototype["@@iterator"]=function(){return this},lr.prototype[B]=function(){return this},lr.prototype.next=function(){var Ur=this._index;if(Ur>=0&&Ur<this._keys.length){var Hr=this._selector(this._keys[Ur],this._values[Ur]);return Ur+1>=this._keys.length?(this._index=-1,this._keys=Ue,this._values=Ue):this._index++,{value:Hr,done:!1}}return{value:void 0,done:!0}},lr.prototype.throw=function(Ur){throw this._index>=0&&(this._index=-1,this._keys=Ue,this._values=Ue),Ur},lr.prototype.return=function(Ur){return this._index>=0&&(this._index=-1,this._keys=Ue,this._values=Ue),{value:Ur,done:!0}},lr}();return function(){function lr(){this._keys=[],this._values=[],this._cacheKey=Me,this._cacheIndex=-2}return Object.defineProperty(lr.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),lr.prototype.has=function(Ur){return this._find(Ur,!1)>=0},lr.prototype.get=function(Ur){var Hr=this._find(Ur,!1);return Hr>=0?this._values[Hr]:void 0},lr.prototype.set=function(Ur,Hr){var un=this._find(Ur,!0);return this._values[un]=Hr,this},lr.prototype.delete=function(Ur){var Hr=this._find(Ur,!1);if(Hr>=0){for(var un=this._keys.length,bn=Hr+1;bn<un;bn++)this._keys[bn-1]=this._keys[bn],this._values[bn-1]=this._values[bn];return this._keys.length--,this._values.length--,Ur===this._cacheKey&&(this._cacheKey=Me,this._cacheIndex=-2),!0}return!1},lr.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Me,this._cacheIndex=-2},lr.prototype.keys=function(){return new yt(this._keys,this._values,gt)},lr.prototype.values=function(){return new yt(this._keys,this._values,nr)},lr.prototype.entries=function(){return new yt(this._keys,this._values,pe)},lr.prototype["@@iterator"]=function(){return this.entries()},lr.prototype[B]=function(){return this.entries()},lr.prototype._find=function(Ur,Hr){return this._cacheKey!==Ur&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ur)),this._cacheIndex<0&&Hr&&(this._cacheIndex=this._keys.length,this._keys.push(Ur),this._values.push(void 0)),this._cacheIndex},lr}();function gt(lr,Ur){return lr}function nr(lr,Ur){return Ur}function pe(lr,Ur){return[lr,Ur]}}function ht(){return function(){function Me(){this._map=new rt}return Object.defineProperty(Me.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Me.prototype.has=function(Ue){return this._map.has(Ue)},Me.prototype.add=function(Ue){return this._map.set(Ue,Ue),this},Me.prototype.delete=function(Ue){return this._map.delete(Ue)},Me.prototype.clear=function(){this._map.clear()},Me.prototype.keys=function(){return this._map.keys()},Me.prototype.values=function(){return this._map.values()},Me.prototype.entries=function(){return this._map.entries()},Me.prototype["@@iterator"]=function(){return this.keys()},Me.prototype[B]=function(){return this.keys()},Me}()}function ze(){var Me=16,Ue=H.create(),yt=gt();return function(){function Hr(){this._key=gt()}return Hr.prototype.has=function(un){var bn=nr(un,!1);return bn!==void 0?H.has(bn,this._key):!1},Hr.prototype.get=function(un){var bn=nr(un,!1);return bn!==void 0?H.get(bn,this._key):void 0},Hr.prototype.set=function(un,bn){var Gn=nr(un,!0);return Gn[this._key]=bn,this},Hr.prototype.delete=function(un){var bn=nr(un,!1);return bn!==void 0?delete bn[this._key]:!1},Hr.prototype.clear=function(){this._key=gt()},Hr}();function gt(){var Hr;do Hr="@@WeakMap@@"+Ur();while(H.has(Ue,Hr));return Ue[Hr]=!0,Hr}function nr(Hr,un){if(!L.call(Hr,yt)){if(!un)return;Object.defineProperty(Hr,yt,{value:H.create()})}return Hr[yt]}function pe(Hr,un){for(var bn=0;bn<un;++bn)Hr[bn]=Math.random()*255|0;return Hr}function lr(Hr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Hr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Hr)):pe(new Uint8Array(Hr),Hr):pe(new Array(Hr),Hr)}function Ur(){var Hr=lr(Me);Hr[6]=Hr[6]&79|64,Hr[8]=Hr[8]&191|128;for(var un="",bn=0;bn<Me;++bn){var Gn=Hr[bn];(bn===4||bn===6||bn===8)&&(un+="-"),Gn<16&&(un+="0"),un+=Gn.toString(16).toLowerCase()}return un}}function pt(Me){return Me.__=void 0,delete Me.__,Me}})})(Z||(Z={}))},69848:function(Ft){(function(A,y){Ft.exports=y()})(this,function(){"use strict";function A(Qe,Te,Le,Ce,Fe,Ke){if(!(Fe-Ce<=Le)){var qt=Ce+Fe>>1;y(Qe,Te,qt,Ce,Fe,Ke%2),A(Qe,Te,Le,Ce,qt-1,Ke+1),A(Qe,Te,Le,qt+1,Fe,Ke+1)}}function y(Qe,Te,Le,Ce,Fe,Ke){for(;Fe>Ce;){if(Fe-Ce>600){var qt=Fe-Ce+1,ir=Le-Ce+1,Pe=Math.log(qt),Ne=.5*Math.exp(2*Pe/3),Xe=.5*Math.sqrt(Pe*Ne*(qt-Ne)/qt)*(ir-qt/2<0?-1:1),kt=Math.max(Ce,Math.floor(Le-ir*Ne/qt+Xe)),rr=Math.min(Fe,Math.floor(Le+(qt-ir)*Ne/qt+Xe));y(Qe,Te,Le,kt,rr,Ke)}var me=Te[2*Le+Ke],et=Ce,or=Fe;for(v(Qe,Te,Ce,Le),Te[2*Fe+Ke]>me&&v(Qe,Te,Ce,Fe);et<or;){for(v(Qe,Te,et,or),et++,or--;Te[2*et+Ke]<me;)et++;for(;Te[2*or+Ke]>me;)or--}Te[2*Ce+Ke]===me?v(Qe,Te,Ce,or):(or++,v(Qe,Te,or,Fe)),or<=Le&&(Ce=or+1),Le<=or&&(Fe=or-1)}}function v(Qe,Te,Le,Ce){Z(Qe,Le,Ce),Z(Te,2*Le,2*Ce),Z(Te,2*Le+1,2*Ce+1)}function Z(Qe,Te,Le){var Ce=Qe[Te];Qe[Te]=Qe[Le],Qe[Le]=Ce}function a(Qe,Te,Le,Ce,Fe,Ke,qt){for(var ir=[0,Qe.length-1,0],Pe=[],Ne,Xe;ir.length;){var kt=ir.pop(),rr=ir.pop(),me=ir.pop();if(rr-me<=qt){for(var et=me;et<=rr;et++)Ne=Te[2*et],Xe=Te[2*et+1],Ne>=Le&&Ne<=Fe&&Xe>=Ce&&Xe<=Ke&&Pe.push(Qe[et]);continue}var or=Math.floor((me+rr)/2);Ne=Te[2*or],Xe=Te[2*or+1],Ne>=Le&&Ne<=Fe&&Xe>=Ce&&Xe<=Ke&&Pe.push(Qe[or]);var on=(kt+1)%2;(kt===0?Le<=Ne:Ce<=Xe)&&(ir.push(me),ir.push(or-1),ir.push(on)),(kt===0?Fe>=Ne:Ke>=Xe)&&(ir.push(or+1),ir.push(rr),ir.push(on))}return Pe}function P(Qe,Te,Le,Ce,Fe,Ke){for(var qt=[0,Qe.length-1,0],ir=[],Pe=Fe*Fe;qt.length;){var Ne=qt.pop(),Xe=qt.pop(),kt=qt.pop();if(Xe-kt<=Ke){for(var rr=kt;rr<=Xe;rr++)L(Te[2*rr],Te[2*rr+1],Le,Ce)<=Pe&&ir.push(Qe[rr]);continue}var me=Math.floor((kt+Xe)/2),et=Te[2*me],or=Te[2*me+1];L(et,or,Le,Ce)<=Pe&&ir.push(Qe[me]);var on=(Ne+1)%2;(Ne===0?Le-Fe<=et:Ce-Fe<=or)&&(qt.push(kt),qt.push(me-1),qt.push(on)),(Ne===0?Le+Fe>=et:Ce+Fe>=or)&&(qt.push(me+1),qt.push(Xe),qt.push(on))}return ir}function L(Qe,Te,Le,Ce){var Fe=Qe-Le,Ke=Te-Ce;return Fe*Fe+Ke*Ke}var O=function(Qe){return Qe[0]},D=function(Qe){return Qe[1]},B=function(Te,Le,Ce,Fe,Ke){Le===void 0&&(Le=O),Ce===void 0&&(Ce=D),Fe===void 0&&(Fe=64),Ke===void 0&&(Ke=Float64Array),this.nodeSize=Fe,this.points=Te;for(var qt=Te.length<65536?Uint16Array:Uint32Array,ir=this.ids=new qt(Te.length),Pe=this.coords=new Ke(Te.length*2),Ne=0;Ne<Te.length;Ne++)ir[Ne]=Ne,Pe[2*Ne]=Le(Te[Ne]),Pe[2*Ne+1]=Ce(Te[Ne]);A(ir,Pe,Fe,0,ir.length-1,0)};B.prototype.range=function(Te,Le,Ce,Fe){return a(this.ids,this.coords,Te,Le,Ce,Fe,this.nodeSize)},B.prototype.within=function(Te,Le,Ce){return P(this.ids,this.coords,Te,Le,Ce,this.nodeSize)};var V={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Qe){return Qe}},N=Math.fround||function(Qe){return function(Te){return Qe[0]=+Te,Qe[0]}}(new Float32Array(1)),Y=function(Te){this.options=$e(Object.create(V),Te),this.trees=new Array(this.options.maxZoom+1)};Y.prototype.load=function(Te){var Le=this.options,Ce=Le.log,Fe=Le.minZoom,Ke=Le.maxZoom,qt=Le.nodeSize;Ce&&console.time("total time");var ir="prepare "+Te.length+" points";Ce&&console.time(ir),this.points=Te;for(var Pe=[],Ne=0;Ne<Te.length;Ne++)!Te[Ne].geometry||Pe.push(ce(Te[Ne],Ne));this.trees[Ke+1]=new B(Pe,re,Ge,qt,Float32Array),Ce&&console.timeEnd(ir);for(var Xe=Ke;Xe>=Fe;Xe--){var kt=+Date.now();Pe=this._cluster(Pe,Xe),this.trees[Xe]=new B(Pe,re,Ge,qt,Float32Array),Ce&&console.log("z%d: %d clusters in %dms",Xe,Pe.length,+Date.now()-kt)}return Ce&&console.timeEnd("total time"),this},Y.prototype.getClusters=function(Te,Le){var Ce=((Te[0]+180)%360+360)%360-180,Fe=Math.max(-90,Math.min(90,Te[1])),Ke=Te[2]===180?180:((Te[2]+180)%360+360)%360-180,qt=Math.max(-90,Math.min(90,Te[3]));if(Te[2]-Te[0]>=360)Ce=-180,Ke=180;else if(Ce>Ke){var ir=this.getClusters([Ce,Fe,180,qt],Le),Pe=this.getClusters([-180,Fe,Ke,qt],Le);return ir.concat(Pe)}for(var Ne=this.trees[this._limitZoom(Le)],Xe=Ne.range(Re(Ce),vt(qt),Re(Ke),vt(Fe)),kt=[],rr=0,me=Xe;rr<me.length;rr+=1){var et=me[rr],or=Ne.points[et];kt.push(or.numPoints?at(or):this.points[or.index])}return kt},Y.prototype.getChildren=function(Te){var Le=this._getOriginId(Te),Ce=this._getOriginZoom(Te),Fe="No cluster with the specified id.",Ke=this.trees[Ce];if(!Ke)throw new Error(Fe);var qt=Ke.points[Le];if(!qt)throw new Error(Fe);for(var ir=this.options.radius/(this.options.extent*Math.pow(2,Ce-1)),Pe=Ke.within(qt.x,qt.y,ir),Ne=[],Xe=0,kt=Pe;Xe<kt.length;Xe+=1){var rr=kt[Xe],me=Ke.points[rr];me.parentId===Te&&Ne.push(me.numPoints?at(me):this.points[me.index])}if(Ne.length===0)throw new Error(Fe);return Ne},Y.prototype.getLeaves=function(Te,Le,Ce){Le=Le||10,Ce=Ce||0;var Fe=[];return this._appendLeaves(Fe,Te,Le,Ce,0),Fe},Y.prototype.getTile=function(Te,Le,Ce){var Fe=this.trees[this._limitZoom(Te)],Ke=Math.pow(2,Te),qt=this.options,ir=qt.extent,Pe=qt.radius,Ne=Pe/ir,Xe=(Ce-Ne)/Ke,kt=(Ce+1+Ne)/Ke,rr={features:[]};return this._addTileFeatures(Fe.range((Le-Ne)/Ke,Xe,(Le+1+Ne)/Ke,kt),Fe.points,Le,Ce,Ke,rr),Le===0&&this._addTileFeatures(Fe.range(1-Ne/Ke,Xe,1,kt),Fe.points,Ke,Ce,Ke,rr),Le===Ke-1&&this._addTileFeatures(Fe.range(0,Xe,Ne/Ke,kt),Fe.points,-1,Ce,Ke,rr),rr.features.length?rr:null},Y.prototype.getClusterExpansionZoom=function(Te){for(var Le=this._getOriginZoom(Te)-1;Le<=this.options.maxZoom;){var Ce=this.getChildren(Te);if(Le++,Ce.length!==1)break;Te=Ce[0].properties.cluster_id}return Le},Y.prototype._appendLeaves=function(Te,Le,Ce,Fe,Ke){for(var qt=this.getChildren(Le),ir=0,Pe=qt;ir<Pe.length;ir+=1){var Ne=Pe[ir],Xe=Ne.properties;if(Xe&&Xe.cluster?Ke+Xe.point_count<=Fe?Ke+=Xe.point_count:Ke=this._appendLeaves(Te,Xe.cluster_id,Ce,Fe,Ke):Ke<Fe?Ke++:Te.push(Ne),Te.length===Ce)break}return Ke},Y.prototype._addTileFeatures=function(Te,Le,Ce,Fe,Ke,qt){for(var ir=0,Pe=Te;ir<Pe.length;ir+=1){var Ne=Pe[ir],Xe=Le[Ne],kt=Xe.numPoints,rr=void 0,me=void 0,et=void 0;if(kt)rr=rt(Xe),me=Xe.x,et=Xe.y;else{var or=this.points[Xe.index];rr=or.properties,me=Re(or.geometry.coordinates[0]),et=vt(or.geometry.coordinates[1])}var on={type:1,geometry:[[Math.round(this.options.extent*(me*Ke-Ce)),Math.round(this.options.extent*(et*Ke-Fe))]],tags:rr},vr=void 0;kt?vr=Xe.id:this.options.generateId?vr=Xe.index:this.points[Xe.index].id&&(vr=this.points[Xe.index].id),vr!==void 0&&(on.id=vr),qt.features.push(on)}},Y.prototype._limitZoom=function(Te){return Math.max(this.options.minZoom,Math.min(Math.floor(+Te),this.options.maxZoom+1))},Y.prototype._cluster=function(Te,Le){for(var Ce=[],Fe=this.options,Ke=Fe.radius,qt=Fe.extent,ir=Fe.reduce,Pe=Fe.minPoints,Ne=Ke/(qt*Math.pow(2,Le)),Xe=0;Xe<Te.length;Xe++){var kt=Te[Xe];if(!(kt.zoom<=Le)){kt.zoom=Le;for(var rr=this.trees[Le+1],me=rr.within(kt.x,kt.y,Ne),et=kt.numPoints||1,or=et,on=0,vr=me;on<vr.length;on+=1){var jr=vr[on],xr=rr.points[jr];xr.zoom>Le&&(or+=xr.numPoints||1)}if(or>et&&or>=Pe){for(var Ae=kt.x*et,De=kt.y*et,ke=ir&&et>1?this._map(kt,!0):null,Bt=(Xe<<5)+(Le+1)+this.points.length,mt=0,Mr=me;mt<Mr.length;mt+=1){var Cr=Mr[mt],Nr=rr.points[Cr];if(!(Nr.zoom<=Le)){Nr.zoom=Le;var nt=Nr.numPoints||1;Ae+=Nr.x*nt,De+=Nr.y*nt,Nr.parentId=Bt,ir&&(ke||(ke=this._map(kt,!0)),ir(ke,this._map(Nr)))}}kt.parentId=Bt,Ce.push(H(Ae/or,De/or,Bt,or,ke))}else if(Ce.push(kt),or>1)for(var Ye=0,M=me;Ye<M.length;Ye+=1){var W=M[Ye],ue=rr.points[W];ue.zoom<=Le||(ue.zoom=Le,Ce.push(ue))}}}return Ce},Y.prototype._getOriginId=function(Te){return Te-this.points.length>>5},Y.prototype._getOriginZoom=function(Te){return(Te-this.points.length)%32},Y.prototype._map=function(Te,Le){if(Te.numPoints)return Le?$e({},Te.properties):Te.properties;var Ce=this.points[Te.index].properties,Fe=this.options.map(Ce);return Le&&Fe===Ce?$e({},Fe):Fe};function H(Qe,Te,Le,Ce,Fe){return{x:N(Qe),y:N(Te),zoom:Infinity,id:Le,parentId:-1,numPoints:Ce,properties:Fe}}function ce(Qe,Te){var Le=Qe.geometry.coordinates,Ce=Le[0],Fe=Le[1];return{x:N(Re(Ce)),y:N(vt(Fe)),zoom:Infinity,index:Te,parentId:-1}}function at(Qe){return{type:"Feature",id:Qe.id,properties:rt(Qe),geometry:{type:"Point",coordinates:[wt(Qe.x),fe(Qe.y)]}}}function rt(Qe){var Te=Qe.numPoints,Le=Te>=1e4?Math.round(Te/1e3)+"k":Te>=1e3?Math.round(Te/100)/10+"k":Te;return $e($e({},Qe.properties),{cluster:!0,cluster_id:Qe.id,point_count:Te,point_count_abbreviated:Le})}function Re(Qe){return Qe/360+.5}function vt(Qe){var Te=Math.sin(Qe*Math.PI/180),Le=.5-.25*Math.log((1+Te)/(1-Te))/Math.PI;return Le<0?0:Le>1?1:Le}function wt(Qe){return(Qe-.5)*360}function fe(Qe){var Te=(180-Qe*360)*Math.PI/180;return 360*Math.atan(Math.exp(Te))/Math.PI-90}function $e(Qe,Te){for(var Le in Te)Qe[Le]=Te[Le];return Qe}function re(Qe){return Qe.x}function Ge(Qe){return Qe.y}return Y})},18146:function(Ft,A,y){"use strict";y.r(A),y.d(A,{bbox:function(){return a},feature:function(){return L},merge:function(){return ce},mergeArcs:function(){return at},mesh:function(){return V},meshArcs:function(){return N},neighbors:function(){return Re},quantize:function(){return wt},transform:function(){return Z},untransform:function(){return vt}});function v(fe){return fe}function Z(fe){if(fe==null)return v;var $e,re,Ge=fe.scale[0],Qe=fe.scale[1],Te=fe.translate[0],Le=fe.translate[1];return function(Ce,Fe){Fe||($e=re=0);var Ke=2,qt=Ce.length,ir=new Array(qt);for(ir[0]=($e+=Ce[0])*Ge+Te,ir[1]=(re+=Ce[1])*Qe+Le;Ke<qt;)ir[Ke]=Ce[Ke],++Ke;return ir}}function a(fe){var $e=Z(fe.transform),re,Ge=Infinity,Qe=Ge,Te=-Ge,Le=-Ge;function Ce(Ke){Ke=$e(Ke),Ke[0]<Ge&&(Ge=Ke[0]),Ke[0]>Te&&(Te=Ke[0]),Ke[1]<Qe&&(Qe=Ke[1]),Ke[1]>Le&&(Le=Ke[1])}function Fe(Ke){switch(Ke.type){case"GeometryCollection":Ke.geometries.forEach(Fe);break;case"Point":Ce(Ke.coordinates);break;case"MultiPoint":Ke.coordinates.forEach(Ce);break}}fe.arcs.forEach(function(Ke){for(var qt=-1,ir=Ke.length,Pe;++qt<ir;)Pe=$e(Ke[qt],qt),Pe[0]<Ge&&(Ge=Pe[0]),Pe[0]>Te&&(Te=Pe[0]),Pe[1]<Qe&&(Qe=Pe[1]),Pe[1]>Le&&(Le=Pe[1])});for(re in fe.objects)Fe(fe.objects[re]);return[Ge,Qe,Te,Le]}function P(fe,$e){for(var re,Ge=fe.length,Qe=Ge-$e;Qe<--Ge;)re=fe[Qe],fe[Qe++]=fe[Ge],fe[Ge]=re}function L(fe,$e){return typeof $e=="string"&&($e=fe.objects[$e]),$e.type==="GeometryCollection"?{type:"FeatureCollection",features:$e.geometries.map(function(re){return O(fe,re)})}:O(fe,$e)}function O(fe,$e){var re=$e.id,Ge=$e.bbox,Qe=$e.properties==null?{}:$e.properties,Te=D(fe,$e);return re==null&&Ge==null?{type:"Feature",properties:Qe,geometry:Te}:Ge==null?{type:"Feature",id:re,properties:Qe,geometry:Te}:{type:"Feature",id:re,bbox:Ge,properties:Qe,geometry:Te}}function D(fe,$e){var re=Z(fe.transform),Ge=fe.arcs;function Qe(qt,ir){ir.length&&ir.pop();for(var Pe=Ge[qt<0?~qt:qt],Ne=0,Xe=Pe.length;Ne<Xe;++Ne)ir.push(re(Pe[Ne],Ne));qt<0&&P(ir,Xe)}function Te(qt){return re(qt)}function Le(qt){for(var ir=[],Pe=0,Ne=qt.length;Pe<Ne;++Pe)Qe(qt[Pe],ir);return ir.length<2&&ir.push(ir[0]),ir}function Ce(qt){for(var ir=Le(qt);ir.length<4;)ir.push(ir[0]);return ir}function Fe(qt){return qt.map(Ce)}function Ke(qt){var ir=qt.type,Pe;switch(ir){case"GeometryCollection":return{type:ir,geometries:qt.geometries.map(Ke)};case"Point":Pe=Te(qt.coordinates);break;case"MultiPoint":Pe=qt.coordinates.map(Te);break;case"LineString":Pe=Le(qt.arcs);break;case"MultiLineString":Pe=qt.arcs.map(Le);break;case"Polygon":Pe=Fe(qt.arcs);break;case"MultiPolygon":Pe=qt.arcs.map(Fe);break;default:return null}return{type:ir,coordinates:Pe}}return Ke($e)}function B(fe,$e){var re={},Ge={},Qe={},Te=[],Le=-1;$e.forEach(function(Ke,qt){var ir=fe.arcs[Ke<0?~Ke:Ke],Pe;ir.length<3&&!ir[1][0]&&!ir[1][1]&&(Pe=$e[++Le],$e[Le]=Ke,$e[qt]=Pe)}),$e.forEach(function(Ke){var qt=Ce(Ke),ir=qt[0],Pe=qt[1],Ne,Xe;if(Ne=Qe[ir])if(delete Qe[Ne.end],Ne.push(Ke),Ne.end=Pe,Xe=Ge[Pe]){delete Ge[Xe.start];var kt=Xe===Ne?Ne:Ne.concat(Xe);Ge[kt.start=Ne.start]=Qe[kt.end=Xe.end]=kt}else Ge[Ne.start]=Qe[Ne.end]=Ne;else if(Ne=Ge[Pe])if(delete Ge[Ne.start],Ne.unshift(Ke),Ne.start=ir,Xe=Qe[ir]){delete Qe[Xe.end];var rr=Xe===Ne?Ne:Xe.concat(Ne);Ge[rr.start=Xe.start]=Qe[rr.end=Ne.end]=rr}else Ge[Ne.start]=Qe[Ne.end]=Ne;else Ne=[Ke],Ge[Ne.start=ir]=Qe[Ne.end=Pe]=Ne});function Ce(Ke){var qt=fe.arcs[Ke<0?~Ke:Ke],ir=qt[0],Pe;return fe.transform?(Pe=[0,0],qt.forEach(function(Ne){Pe[0]+=Ne[0],Pe[1]+=Ne[1]})):Pe=qt[qt.length-1],Ke<0?[Pe,ir]:[ir,Pe]}function Fe(Ke,qt){for(var ir in Ke){var Pe=Ke[ir];delete qt[Pe.start],delete Pe.start,delete Pe.end,Pe.forEach(function(Ne){re[Ne<0?~Ne:Ne]=1}),Te.push(Pe)}}return Fe(Qe,Ge),Fe(Ge,Qe),$e.forEach(function(Ke){re[Ke<0?~Ke:Ke]||Te.push([Ke])}),Te}function V(fe){return D(fe,N.apply(this,arguments))}function N(fe,$e,re){var Ge,Qe,Te;if(arguments.length>1)Ge=Y(fe,$e,re);else for(Qe=0,Ge=new Array(Te=fe.arcs.length);Qe<Te;++Qe)Ge[Qe]=Qe;return{type:"MultiLineString",arcs:B(fe,Ge)}}function Y(fe,$e,re){var Ge=[],Qe=[],Te;function Le(ir){var Pe=ir<0?~ir:ir;(Qe[Pe]||(Qe[Pe]=[])).push({i:ir,g:Te})}function Ce(ir){ir.forEach(Le)}function Fe(ir){ir.forEach(Ce)}function Ke(ir){ir.forEach(Fe)}function qt(ir){switch(Te=ir,ir.type){case"GeometryCollection":ir.geometries.forEach(qt);break;case"LineString":Ce(ir.arcs);break;case"MultiLineString":case"Polygon":Fe(ir.arcs);break;case"MultiPolygon":Ke(ir.arcs);break}}return qt($e),Qe.forEach(re==null?function(ir){Ge.push(ir[0].i)}:function(ir){re(ir[0].g,ir[ir.length-1].g)&&Ge.push(ir[0].i)}),Ge}function H(fe){for(var $e=-1,re=fe.length,Ge,Qe=fe[re-1],Te=0;++$e<re;)Ge=Qe,Qe=fe[$e],Te+=Ge[0]*Qe[1]-Ge[1]*Qe[0];return Math.abs(Te)}function ce(fe){return D(fe,at.apply(this,arguments))}function at(fe,$e){var re={},Ge=[],Qe=[];$e.forEach(Te);function Te(Fe){switch(Fe.type){case"GeometryCollection":Fe.geometries.forEach(Te);break;case"Polygon":Le(Fe.arcs);break;case"MultiPolygon":Fe.arcs.forEach(Le);break}}function Le(Fe){Fe.forEach(function(Ke){Ke.forEach(function(qt){(re[qt=qt<0?~qt:qt]||(re[qt]=[])).push(Fe)})}),Ge.push(Fe)}function Ce(Fe){return H(D(fe,{type:"Polygon",arcs:[Fe]}).coordinates[0])}return Ge.forEach(function(Fe){if(!Fe._){var Ke=[],qt=[Fe];for(Fe._=1,Qe.push(Ke);Fe=qt.pop();)Ke.push(Fe),Fe.forEach(function(ir){ir.forEach(function(Pe){re[Pe<0?~Pe:Pe].forEach(function(Ne){Ne._||(Ne._=1,qt.push(Ne))})})})}}),Ge.forEach(function(Fe){delete Fe._}),{type:"MultiPolygon",arcs:Qe.map(function(Fe){var Ke=[],qt;if(Fe.forEach(function(kt){kt.forEach(function(rr){rr.forEach(function(me){re[me<0?~me:me].length<2&&Ke.push(me)})})}),Ke=B(fe,Ke),(qt=Ke.length)>1)for(var ir=1,Pe=Ce(Ke[0]),Ne,Xe;ir<qt;++ir)(Ne=Ce(Ke[ir]))>Pe&&(Xe=Ke[0],Ke[0]=Ke[ir],Ke[ir]=Xe,Pe=Ne);return Ke}).filter(function(Fe){return Fe.length>0})}}function rt(fe,$e){for(var re=0,Ge=fe.length;re<Ge;){var Qe=re+Ge>>>1;fe[Qe]<$e?re=Qe+1:Ge=Qe}return re}function Re(fe){var $e={},re=fe.map(function(){return[]});function Ge(kt,rr){kt.forEach(function(me){me<0&&(me=~me);var et=$e[me];et?et.push(rr):$e[me]=[rr]})}function Qe(kt,rr){kt.forEach(function(me){Ge(me,rr)})}function Te(kt,rr){kt.type==="GeometryCollection"?kt.geometries.forEach(function(me){Te(me,rr)}):kt.type in Le&&Le[kt.type](kt.arcs,rr)}var Le={LineString:Ge,MultiLineString:Qe,Polygon:Qe,MultiPolygon:function(kt,rr){kt.forEach(function(me){Qe(me,rr)})}};fe.forEach(Te);for(var Ce in $e)for(var Fe=$e[Ce],Ke=Fe.length,qt=0;qt<Ke;++qt)for(var ir=qt+1;ir<Ke;++ir){var Pe=Fe[qt],Ne=Fe[ir],Xe;(Xe=re[Pe])[Ce=rt(Xe,Ne)]!==Ne&&Xe.splice(Ce,0,Ne),(Xe=re[Ne])[Ce=rt(Xe,Pe)]!==Pe&&Xe.splice(Ce,0,Pe)}return re}function vt(fe){if(fe==null)return v;var $e,re,Ge=fe.scale[0],Qe=fe.scale[1],Te=fe.translate[0],Le=fe.translate[1];return function(Ce,Fe){Fe||($e=re=0);var Ke=2,qt=Ce.length,ir=new Array(qt),Pe=Math.round((Ce[0]-Te)/Ge),Ne=Math.round((Ce[1]-Le)/Qe);for(ir[0]=Pe-$e,$e=Pe,ir[1]=Ne-re,re=Ne;Ke<qt;)ir[Ke]=Ce[Ke],++Ke;return ir}}function wt(fe,$e){if(fe.transform)throw new Error("already quantized");if(!$e||!$e.scale){if(!((Le=Math.floor($e))>=2))throw new Error("n must be \u22652");Fe=fe.bbox||a(fe);var re=Fe[0],Ge=Fe[1],Qe=Fe[2],Te=Fe[3],Le;$e={scale:[Qe-re?(Qe-re)/(Le-1):1,Te-Ge?(Te-Ge)/(Le-1):1],translate:[re,Ge]}}else Fe=fe.bbox;var Ce=vt($e),Fe,Ke,qt=fe.objects,ir={};function Pe(kt){return Ce(kt)}function Ne(kt){var rr;switch(kt.type){case"GeometryCollection":rr={type:"GeometryCollection",geometries:kt.geometries.map(Ne)};break;case"Point":rr={type:"Point",coordinates:Pe(kt.coordinates)};break;case"MultiPoint":rr={type:"MultiPoint",coordinates:kt.coordinates.map(Pe)};break;default:return kt}return kt.id!=null&&(rr.id=kt.id),kt.bbox!=null&&(rr.bbox=kt.bbox),kt.properties!=null&&(rr.properties=kt.properties),rr}function Xe(kt){var rr=0,me=1,et=kt.length,or,on=new Array(et);for(on[0]=Ce(kt[0],0);++rr<et;)((or=Ce(kt[rr],rr))[0]||or[1])&&(on[me++]=or);return me===1&&(on[me++]=[0,0]),on.length=me,on}for(Ke in qt)ir[Ke]=Ne(qt[Ke]);return{type:"Topology",bbox:Fe,transform:$e,objects:ir,arcs:fe.arcs.map(Xe)}}},75752:function(Ft){Ft.exports.RADIUS=6378137,Ft.exports.FLATTENING=1/298.257223563,Ft.exports.POLAR_RADIUS=63567523142e-4}}]);
